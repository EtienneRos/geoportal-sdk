/*!
 * @brief Geoportal SDK
 *
 * This software is released under the licence CeCILL-B (Free BSD compatible)
 * @see http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt
 * @see http://www.cecill.info/licences/Licence_CeCILL-B_V1-fr.txt
 * @see http://www.cecill.info/
 *
 * copyright CeCILL-B
 * copyright IGN
 * @author IGN
 * @version 1.2.0
 * @date 2018-05-14
 *
 */
/*!
 * OpenLayers. See http://openlayers.org/
 * License: https://raw.githubusercontent.com/openlayers/ol3/master/LICENSE.md
 * Version: 4.6.5
 */
/*!
 * Geoportal Extension for OpenLayers. See https://github.com/IGNF/geoportal-extensions
 * License: https://raw.githubusercontent.com/IGNF/geoportal-extensions/master/LICENCE.md
 * Version: 2.0.0
 */
 /*!
 * iTowns. See http://www.itowns-project.org/
 * License: https://github.com/iTowns/itowns/blob/master/LICENSE.md
 * Version: 2.3.0
 */
/*!
 * Geoportal Extension for iTowns. See https://github.com/IGNF/geoportal-extensions
 * License: https://raw.githubusercontent.com/IGNF/geoportal-extensions/master/LICENCE.md
 * Version: 2.0.0
 */
;(function(root, factory) {
  if (typeof define === 'function' && define.amd) {
    define([], factory);
  } else if (typeof exports === 'object') {
    module.exports = factory();
  } else {
    root.Gp = factory();
  }
}(this, function() {

/* BEGIN CODE */
var log4js, loggerCfg, UtilsLoggerByDefault, UtilsLoader, IMap, it2IT, ol3OL3, Map, AHN;
(function (rootRequire) {
    log4js = function () {
        var requirejs, require, define;
        (function (e) {
            function c(e, t) {
                return f.call(e, t);
            }
            function h(e, t) {
                var n, r, i, s, o, a, f, l, c, h, p = t && t.split('/'), d = u.map, v = d && d['*'] || {};
                if (e && e.charAt(0) === '.')
                    if (t) {
                        p = p.slice(0, p.length - 1), e = p.concat(e.split('/'));
                        for (l = 0; l < e.length; l += 1) {
                            h = e[l];
                            if (h === '.')
                                e.splice(l, 1), l -= 1;
                            else if (h === '..') {
                                if (l === 1 && (e[2] === '..' || e[0] === '..'))
                                    break;
                                l > 0 && (e.splice(l - 1, 2), l -= 2);
                            }
                        }
                        e = e.join('/');
                    } else
                        e.indexOf('./') === 0 && (e = e.substring(2));
                if ((p || v) && d) {
                    n = e.split('/');
                    for (l = n.length; l > 0; l -= 1) {
                        r = n.slice(0, l).join('/');
                        if (p)
                            for (c = p.length; c > 0; c -= 1) {
                                i = d[p.slice(0, c).join('/')];
                                if (i) {
                                    i = i[r];
                                    if (i) {
                                        s = i, o = l;
                                        break;
                                    }
                                }
                            }
                        if (s)
                            break;
                        !a && v && v[r] && (a = v[r], f = l);
                    }
                    !s && a && (s = a, o = f), s && (n.splice(0, o, s), e = n.join('/'));
                }
                return e;
            }
            function p(t, r) {
                return function () {
                    return n.apply(e, l.call(arguments, 0).concat([
                        t,
                        r
                    ]));
                };
            }
            function d(e) {
                return function (t) {
                    return h(t, e);
                };
            }
            function v(e) {
                return function (t) {
                    s[e] = t;
                };
            }
            function m(n) {
                if (c(o, n)) {
                    var r = o[n];
                    delete o[n], a[n] = !0, t.apply(e, r);
                }
                if (!c(s, n) && !c(a, n))
                    throw new Error('No ' + n);
                return s[n];
            }
            function g(e) {
                var t, n = e ? e.indexOf('!') : -1;
                return n > -1 && (t = e.substring(0, n), e = e.substring(n + 1, e.length)), [
                    t,
                    e
                ];
            }
            function y(e) {
                return function () {
                    return u && u.config && u.config[e] || {};
                };
            }
            var t, n, r, i, s = {}, o = {}, u = {}, a = {}, f = Object.prototype.hasOwnProperty, l = [].slice;
            r = function (e, t) {
                var n, r = g(e), i = r[0];
                return e = r[1], i && (i = h(i, t), n = m(i)), i ? n && n.normalize ? e = n.normalize(e, d(t)) : e = h(e, t) : (e = h(e, t), r = g(e), i = r[0], e = r[1], i && (n = m(i))), {
                    f: i ? i + '!' + e : e,
                    n: e,
                    pr: i,
                    p: n
                };
            }, i = {
                require: function (e) {
                    return p(e);
                },
                exports: function (e) {
                    var t = s[e];
                    return typeof t != 'undefined' ? t : s[e] = {};
                },
                module: function (e) {
                    return {
                        id: e,
                        uri: '',
                        exports: s[e],
                        config: y(e)
                    };
                }
            }, t = function (t, n, u, f) {
                var l, h, d, g, y, b = [], w;
                f = f || t;
                if (typeof u == 'function') {
                    n = !n.length && u.length ? [
                        'require',
                        'exports',
                        'module'
                    ] : n;
                    for (y = 0; y < n.length; y += 1) {
                        g = r(n[y], f), h = g.f;
                        if (h === 'require')
                            b[y] = i.require(t);
                        else if (h === 'exports')
                            b[y] = i.exports(t), w = !0;
                        else if (h === 'module')
                            l = b[y] = i.module(t);
                        else if (c(s, h) || c(o, h) || c(a, h))
                            b[y] = m(h);
                        else {
                            if (!g.p)
                                throw new Error(t + ' missing ' + h);
                            g.p.load(g.n, p(f, !0), v(h), {}), b[y] = s[h];
                        }
                    }
                    d = u.apply(s[t], b);
                    if (t)
                        if (l && l.exports !== e && l.exports !== s[t])
                            s[t] = l.exports;
                        else if (d !== e || !w)
                            s[t] = d;
                } else
                    t && (s[t] = u);
            }, requirejs = require = n = function (s, o, a, f, l) {
                return typeof s == 'string' ? i[s] ? i[s](o) : m(r(s, o).f) : (s.splice || (u = s, o.splice ? (s = o, o = a, a = null) : s = e), o = o || function () {
                }, typeof a == 'function' && (a = f, f = l), f ? t(e, s, o, a) : setTimeout(function () {
                    t(e, s, o, a);
                }, 15), n);
            }, n.config = function (e) {
                return u = e, n;
            }, define = function (e, t, n) {
                t.splice || (n = t, t = []), !c(s, e) && !c(o, e) && (o[e] = [
                    e,
                    t,
                    n
                ]);
            }, define.amd = { jQuery: !0 };
        }(), define('../deps/almond', function () {
        }), define('lifecycle', [], function () {
            var e = function () {
                this.started = !1;
            };
            return e.prototype.start = function (e) {
                return e = e || function () {
                }, this.started = !0, e();
            }, e.prototype.stop = function (e) {
                return e = e || function () {
                }, this.started = !1, e();
            }, e.prototype.isStarted = function () {
                return this.started;
            }, e;
        }), define('logevent', [], function () {
            var e = function (e, t, n) {
                this.time = new Date(), this.loggerName = e, this.level = t, this.message = n;
            };
            return e.prototype.getLoggerName = function () {
                return this.loggerName;
            }, e.prototype.getLevel = function () {
                return this.level;
            }, e.prototype.getMessage = function () {
                return this.message;
            }, e.prototype.getMillis = function () {
                return this.time.getTime();
            }, e;
        }), define('error', [], function () {
            var e = function (e) {
                this.message = e, Error.call(this), Error.captureStackTrace && Error.captureStackTrace(this, arguments.callee);
            };
            return e.prototype = new Error(), e;
        }), define('loglevel', [
            'require',
            './error'
        ], function (e) {
            var t = e('./error'), n = function () {
                    this.levels = [];
                };
            return n.prototype.level2index = function (e) {
                var t = 0, n = this.levels.length;
                for (t = 0; t < n; t++)
                    if (this.levels[t] === e)
                        return t;
                return -1;
            }, n.prototype.registerLevel = function (e, n) {
                var r = 0;
                if (this.level2index(e) !== -1)
                    throw new t('Log level "' + e + '" ' + 'cannot be registered as it already exists');
                if (n) {
                    r = this.level2index(n);
                    if (r === -1)
                        throw new t('The log level "' + n + '" ' + 'cannot be used as reference level as it does not exist');
                }
                this.levels.splice(r, 0, e);
            }, n.prototype.registerStandardLevels = function () {
                this.registerLevel('trace'), this.registerLevel('log'), this.registerLevel('info'), this.registerLevel('warn'), this.registerLevel('error');
            }, n.prototype.isBelow = function (e, t) {
                return e === 'off' ? !0 : e === 'all' ? t === 'all' : t === 'off' ? !1 : t === 'all' ? !0 : this.level2index(e) <= this.level2index(t);
            }, n.prototype.getLevels = function () {
                return this.levels;
            }, n;
        }), define('utils', [], function () {
            var e = Object.prototype.toString, t = Array.isArray || function (t) {
                    return e.call(t) === '[object Array]';
                }, n = function (t) {
                    return e.call(t) === '[object String]';
                }, r = function (e) {
                    return e === Object(e);
                }, i = function (t) {
                    return e.call(t) === '[object Function]';
                }, s = function (t) {
                    return e.call(t) === '[object Date]';
                }, o = {}, u = function (e, t, n) {
                    if (!e)
                        return;
                    if (Array.prototype.forEach && e.forEach === Array.prototype.forEach)
                        e.forEach(t, n);
                    else if (e.length === +e.length) {
                        for (var r = 0, i = e.length; r < i; r++)
                            if (r in e && t.call(n, e[r], r, e) === o)
                                return;
                    } else
                        for (var s in e)
                            if (e.hasOwnProperty(s) && t.call(n, e[s], s, e) === o)
                                return;
                }, a = function (e, t, n) {
                    var r = [];
                    return e ? Array.prototype.map && e.map === Array.prototype.map ? e.map(t, n) : (u(e, function (e, i, s) {
                        r[r.length] = t.call(n, e, i, s);
                    }), e.length === +e.length && (r.length = e.length), r) : r;
                };
            return {
                isArray: t,
                isString: n,
                isObject: r,
                isFunction: i,
                isDate: s,
                each: u,
                map: a
            };
        }), define('layouts/simpleobjectserializer', [
            'require',
            '../utils'
        ], function (e) {
            function n(e) {
                var t = String(e);
                return t.length === 1 && (t = '0' + t), t;
            }
            var t = e('../utils'), r = function (e, i) {
                    var s = null;
                    return i = typeof i != 'undefined' ? i : 1, typeof e == 'undefined' ? undefined : t.isString(e) ? e : t.isDate(e) ? e.getUTCFullYear() + '-' + n(e.getUTCMonth() + 1) + '-' + n(e.getUTCDate()) + 'T' + n(e.getUTCHours()) + ':' + n(e.getUTCMinutes()) + ':' + n(e.getUTCSeconds()) + '.' + String((e.getUTCMilliseconds() / 1000).toFixed(3)).slice(2, 5) + 'Z' : i <= 0 ? '\u2026' : (t.isArray(e) ? (s = [], t.each(e, function (e) {
                        s.push(r(e, i - 1));
                    })) : t.isObject(e) ? (s = {}, t.each(e, function (e, t) {
                        s[t] = r(e, i - 1);
                    })) : t.isFunction(e) ? s = '[func]' : s = e, s);
                };
            return function (e, t, n) {
                var i = r(e, t), s = '';
                return n ? s = JSON.stringify(i) : s = JSON.stringify(i, null, 2), typeof s == 'undefined' ? 'undefined' : s;
            };
        }), define('message', [
            'require',
            './utils',
            './layouts/simpleobjectserializer'
        ], function (e) {
            var t = e('./utils'), n = e('./layouts/simpleobjectserializer'), r = function (e) {
                    this.formatString = '', this.params = [];
                    if (!e)
                        return;
                    e = t.isArray(e) ? e : [e], e.length > 0 && t.isString(e[0]) && e[0].indexOf('{}') !== -1 ? (this.formatString = e[0], this.params = e.slice(1)) : this.params = e;
                };
            return r.prototype.getFormattedMessage = function (e) {
                e = e || {}, e.separator = t.isString(e.separator) ? e.separator : ' ';
                var n = this.getFormattedParams(e);
                return n.join(e.separator);
            }, r.prototype.getFormattedParams = function (e) {
                e = e || {}, e.separator = t.isString(e.separator) ? e.separator : ' ', e.compactObjects = e.compactObjects || !1, e.objectDepth = e.objectDepth || 2;
                var n = 0, r = 0, i = this.params.length, s = '', o = [], u = {
                        compactObjects: e.compactObjects,
                        objectDepth: e.objectDepth
                    }, a = 0, f = this.formatString.indexOf('{}');
                while (f !== -1)
                    s += this.formatString.substring(a, f), n < i && (r = this.params[n], s += this.getFormattedParam(r, u)), n += 1, a = f + 2, f = this.formatString.indexOf('{}', a);
                s += this.formatString.substring(a), s && o.push(s);
                for (!0; n < i; n++)
                    r = this.params[n], o.push(this.getFormattedParam(r, e));
                return o;
            }, r.prototype.getFormattedParam = function (e, r) {
                return r = r || {}, r.objectDepth = r.objectDepth || 2, t.isString(e) ? e : r.preserveObjects && t.isObject(e) ? e : e && e.toString && e.toString !== Object.prototype.toString ? e.toString() : n(e, r.objectDepth, r.compactObjects);
            }, r.prototype.getParameters = function () {
                return this.params;
            }, r.prototype.getFormat = function () {
                return this.formatString;
            }, r;
        }), define('logger', [
            'require',
            './logevent',
            './message',
            './utils'
        ], function (e) {
            var t = e('./logevent'), n = e('./message'), r = e('./utils'), i = function (e, t) {
                    this.name = e, this.loggerContext = t, this.parent = null, this.children = [], this.appenders = [], this.filter = null, this.level = 'inherit', this.additive = !0, this.loggerContext ? (this.isBelow = function (e, t) {
                        return this.loggerContext.logLevel.isBelow(e, t);
                    }, r.each(this.loggerContext.logLevel.getLevels(), function (e) {
                        var t = this;
                        this[e] || (this[e] = function () {
                            t.traceAtLevel(e, arguments);
                        });
                    }, this)) : this.isBelow = function () {
                        return !0;
                    };
                };
            return i.prototype.traceAtLevel = function (e, r) {
                var i = 0, s = [], o = null, u = r.length;
                for (i = 0; i < r.length; i++)
                    s[i] = r[i];
                u === 1 && s[0] instanceof n ? o = s[0] : o = new n(s);
                var a = new t(this.name, e, o);
                return this.loggerContext ? this.loggerContext.traceLogEvent(a, this) : this.traceLogEvent(a);
            }, i.prototype.traceLogEvent = function (e, t) {
                t = t || 'neutral', t === 'neutral' && (this.isBelow(e.getLevel(), this.level) ? t = 'accept' : t = 'deny');
                if (t !== 'accept')
                    return;
                if (this.filter) {
                    t = this.filter.filter(e);
                    if (t === 'deny')
                        return;
                }
                return this.append(e);
            }, i.prototype.append = function (e) {
                var t = 0, n = 0;
                for (t = 0, n = this.appenders.length; t < n; t += 1)
                    this.appenders[t].append(e);
                this.additive && this.parent && this.parent.append(e);
            }, i.prototype.reset = function () {
                this.appenders = [], this.level = 'inherit', this.filter = null, this.additive = !0;
            }, i.prototype.initialize = function (e) {
                e = e || {}, this.level = typeof e.level != 'undefined' ? e.level : 'inherit', this.additive = typeof e.additivity != 'undefined' ? e.additivity : !0, this.appenders = e.appenders || [], this.filter = e.filter || null;
            }, i;
        }), define('filter', [], function () {
            var e = function () {
            };
            return e.prototype.filter = function (e) {
                return e ? 'accept' : 'deny';
            }, e;
        }), define('filters/compositefilter', [
            'require',
            '../filter'
        ], function (e) {
            var t = e('../filter'), n = function (e) {
                    t.call(this), this.filters = e || [];
                };
            return n.prototype = new t(), n.prototype.filter = function (e) {
                var t = 0, n = this.filters.length, r = 'neutral';
                for (t = 0; t < n; t++) {
                    r = this.filters[t].filter(e);
                    if (r !== 'neutral')
                        break;
                }
                return r;
            }, n;
        }), define('loggercontext', [
            'require',
            './lifecycle',
            './logevent',
            './loglevel',
            './message',
            './logger',
            './utils',
            './filters/compositefilter',
            './error'
        ], function (e) {
            var t = e('./lifecycle'), n = e('./logevent'), r = e('./loglevel'), i = e('./message'), s = e('./logger'), o = e('./utils'), u = e('./filters/compositefilter'), a = e('./error'), f = function () {
                    t.call(this), this.startTime = new Date(), this.logLevel = new r(), this.rootLogger = new s('[root]', this), this.loggers = {}, this.appenders = {}, this.filters = {}, this.layouts = {}, this.createdAppenders = [], this.filter = null, this.started = !1, this.pendingEvents = [], this.maxPendingEvents = 1000, this.discardedPendingEvents = 0;
                };
            return f.prototype = new t(), f.prototype.registerAppender = function (e, t) {
                this.appenders[e] = t;
            }, f.prototype.registerFilter = function (e, t) {
                this.filters[e] = t;
            }, f.prototype.registerLayout = function (e, t) {
                this.layouts[e] = t;
            }, f.prototype.registerLevel = function (e, t) {
                this.logLevel.registerLevel(e, t), this.propagateTraceFunctions();
            }, f.prototype.registerStandardLevels = function () {
                this.logLevel.registerStandardLevels();
            }, f.prototype.getFilter = function () {
                return this.filter;
            }, f.prototype.traceLogEvent = function (e, t) {
                if (!this.started)
                    return this.saveLogEvent(e, t);
                var n = 'neutral', r = this.getFilter();
                return r && (n = r.filter(e)), t.traceLogEvent(e, n);
            }, f.prototype.saveLogEvent = function (e, t) {
                var n = 0;
                this.pendingEvents.length >= this.maxPendingEvents && (n = Math.floor(this.maxPendingEvents / 10), this.discardedPendingEvents += n, this.pendingEvents.splice(0, n)), this.pendingEvents.push({
                    evt: e,
                    logger: t
                });
            }, f.prototype.tracePendingEvents = function () {
                var e = 0, t = null, r = null;
                this.discardedPendingEvents > 0 && this.rootLogger.traceLogEvent(new n(this.rootLogger.name, 'warn', new i('Too many messages received before loading was over. ' + this.discardedPendingEvents + ' messages were discarded.' + ' To avoid losing messages, consider waiting for Woodman to load' + ' before you start logging messages.')), 'accept');
                for (e = 0; e < this.pendingEvents.length; e++)
                    t = this.pendingEvents[e].evt, r = this.pendingEvents[e].logger, this.traceLogEvent(t, r);
                this.pendingEvents = [];
            }, f.prototype.createFilter = function (e) {
                var t = [], n = [], r = null;
                return e ? (o.isArray(e) ? t = e : o.each(e, function (e, n) {
                    o.isArray(e) ? (o.each(e, function (e) {
                        e.type || (e.type = n);
                    }), t = t.concat(e)) : (e.type || (e.type = n), t.push(e));
                }), o.each(t, function (e) {
                    if (o.isFunction(e.filter)) {
                        n.push(e);
                        return;
                    }
                    var t = this.filters[e.type];
                    if (!t)
                        throw new a('Unknown filter type "' + e.type + '"');
                    n.push(new t(e));
                }, this), n.length > 1 ? r = new u(n) : n.length === 1 && (r = n[0]), r) : null;
            }, f.prototype.initialize = function (e, t) {
                t = t || function (e) {
                    if (e)
                        throw e;
                };
                var n = !1, r = null;
                e && o.isString(e) && e.match(/^console(\s|$)/i) ? (n = !!(typeof global != 'undefined' && global.process && global.process.versions && global.process.versions.node), e = {
                    loggers: [{
                            level: 'all',
                            appenders: [{
                                    type: 'Console',
                                    name: 'console',
                                    layout: {
                                        type: 'pattern',
                                        pattern: e.substring('console '.length) || (n ? '%d{yyyy-MM-dd HH:mm:ss} [%logger] %level - %m%n' : '%d{yyyy-MM-dd HH:mm:ss} [%logger] %m%n')
                                    },
                                    appendStrings: n
                                }]
                        }]
                }) : e = JSON.parse(JSON.stringify(e || {}));
                var i = [], s = [], u = {};
                return this.reset(), o.isArray(e) ? i = e : (e.configuration && (e = e.configuration), e.properties && (e.properties.property ? o.isArray(e.properties.property) ? o.each(e.properties.property, function (e) {
                    e.name === 'maxPendingEvents' && (this.maxPendingEvents = e.value);
                }) : e.properties.property.name === 'maxPendingEvents' && (this.maxPendingEvents = e.properties.property.value) : e.properties.maxPendingEvents && (this.maxPendingEvents = e.properties.maxPendingEvents)), o.isArray(e.loggers) ? i = e.loggers : (i = [], i = o.each(e.loggers, function (e, t) {
                    t === 'root' && (e.root = !0), o.isArray(e) ? o.each(e, function (e) {
                        i.push(e);
                    }) : i.push(e);
                })), o.isArray(e.appenders) ? s = e.appenders : o.each(e.appenders, function (e, t) {
                    o.isArray(e) ? (o.each(e, function (e) {
                        e.type || (e.type = t);
                    }), s = s.concat(e)) : (e.type || (e.type = t), s.push(e));
                })), o.each(i, function (e) {
                    var t = [];
                    e['appender-ref'] && (o.isArray(e['appender-ref']) ? t = o.map(e['appender-ref'], function (e) {
                        return e.ref;
                    }) : t.push(e['appender-ref'].ref), delete e['appender-ref']), o.isArray(e.appenders) && o.each(e.appenders, function (e) {
                        o.isObject(e) ? (s.push(e), t.push(e.name)) : t.push(e);
                    }), e.appenders = t;
                }), this.filter = this.createFilter(e.filters), o.each(s, function (e) {
                    var t = this.appenders[e.type], n = null, i = null, s = null;
                    if (r)
                        return;
                    if (!t) {
                        r = new a('Unknown appender type for "' + e.name + '": ' + e.type);
                        return;
                    }
                    if (u[e.name]) {
                        r = new a('Appender "' + e.name + '" referenced twice in the configuration');
                        return;
                    }
                    e.layout ? (n = e.layout, i = this.layouts[n.type]) : o.each(this.layouts, function (t, r) {
                        e[r] && (n = e[r], i = t);
                    });
                    if (!i) {
                        r = new a('No proper layout defined for appender "' + e.name + '"');
                        return;
                    }
                    e.layout = new i(n, this), e.filters ? e.filter = this.createFilter(e.filters) : e.filter && (e.filter = this.createFilter([e.filter]));
                    var f = this;
                    e.isLogLevelBelow = function (e, t) {
                        return f.logLevel.isBelow(e, t);
                    }, s = new t(e), this.createdAppenders.push(s), u[e.name] = s;
                }, this), r ? t(r) : (o.each(i, function (e) {
                    var t = null;
                    if (r)
                        return;
                    e.appenders = o.map(e.appenders, function (t) {
                        var n = u[t];
                        if (!n) {
                            r = new a('Logger "' + e.name + '" references undefined appender "' + t + '"');
                            return;
                        }
                        return u[t];
                    }), e.filters ? e.filter = this.createFilter(e.filters) : e.filter && (e.filter = this.createFilter(e.filter)), e.root || !e.name ? t = this.getLogger() : t = this.getLogger(e.name), t.initialize(e);
                }, this), r ? t(r) : (this.propagateLevels(), this.propagateTraceFunctions(), t()));
            }, f.prototype.getLogger = function (e) {
                var t = null, n = '', r = 0;
                return e ? (t = this.loggers[e], t ? t : (t = new s(e, this), r = e.lastIndexOf('.'), r !== -1 ? n = this.getLogger(e.substring(0, r)) : n = this.rootLogger, t.parent = n, t.level = n.level, t.filter = n.filter, n.children = n.children || [], n.children.push(t), this.loggers[e] = t, t)) : this.rootLogger;
            }, f.prototype.getStartTime = function () {
                return this.startTime.getTime();
            }, f.prototype.reset = function () {
                var e = '';
                for (e in this.loggers)
                    this.loggers[e].reset();
                this.rootLogger.reset(), this.rootLogger.level = 'all', this.createdAppenders = [], this.started = !1;
            }, f.prototype.propagateLevels = function () {
                this.rootLogger.level === 'inherit' && (this.rootLogger.level = 'all'), o.each(this.loggers, function (e) {
                    var t = e;
                    while (t.level === 'inherit')
                        t = t.parent;
                    e.level = t.level, e.filter || (e.filter = t.filter);
                });
            }, f.prototype.propagateTraceFunctions = function () {
                o.each(this.logLevel.getLevels(), function (e) {
                    var t = this.rootLogger;
                    t[e] || (t[e] = function () {
                        t.traceAtLevel(e, arguments);
                    });
                }, this), o.each(this.loggers, function (e) {
                    o.each(this.logLevel.getLevels(), function (t) {
                        e[t] || (e[t] = function () {
                            e.traceAtLevel(t, arguments);
                        });
                    });
                }, this);
            }, f.prototype.start = function (e) {
                e = e || function (e) {
                    if (e)
                        throw e;
                };
                var t = this, n = this.createdAppenders.length, r = !1, i = function (i) {
                        if (r)
                            return;
                        if (i)
                            return r = !0, e(i);
                        n -= 1;
                        if (n === 0)
                            return t.started = !0, t.tracePendingEvents(), e();
                    };
                if (!(n > 0))
                    return this.started = !0, this.pendingEvents = [], e();
                o.each(this.createdAppenders, function (e) {
                    e.start(function (e) {
                        return i(e);
                    });
                });
            }, f.prototype.stop = function (e) {
                e = e || function (e) {
                    if (e)
                        throw e;
                };
                var t = this, n = this.createdAppenders.length, r = !1, i = function (i) {
                        if (r)
                            return;
                        if (i)
                            return r = !0, e(i);
                        n -= 1;
                        if (n === 0)
                            return t.started = !1, e();
                    };
                if (!(n > 0))
                    return this.started = !1, e();
                o.each(this.createdAppenders, function (e) {
                    e.stop(function (e) {
                        return i(e);
                    });
                });
            }, f.prototype.load = function (e, t) {
                var n = this;
                t = t || function (e) {
                    if (e)
                        throw e;
                }, this.initialize(e, function (e) {
                    if (e)
                        return t(e);
                    n.start(t);
                });
            }, f;
        }), define('logmanager', [
            'require',
            './loggercontext',
            './error'
        ], function (e) {
            var t = e('./loggercontext'), n = e('./error'), r = new t();
            return {
                registerAppender: function (e, t) {
                    return r.registerAppender(e, t);
                },
                registerFilter: function (e, t) {
                    return r.registerFilter(e, t);
                },
                registerLayout: function (e, t) {
                    return r.registerLayout(e, t);
                },
                registerLevel: function (e, t) {
                    return r.registerLevel(e, t);
                },
                registerStandardLevels: function (e, t) {
                    return r.registerStandardLevels(e, t);
                },
                load: function (e, t) {
                    return r.load(e, t);
                },
                unload: function (e) {
                    return r.stop(e);
                },
                initialize: function (e) {
                    return r.initialize(e);
                },
                start: function (e) {
                    return r.start(e);
                },
                stop: function (e) {
                    return r.stop(e);
                },
                getLogger: function (e) {
                    return r.getLogger(e);
                },
                Error: n
            };
        }), define('appender', [
            'require',
            './lifecycle',
            './error'
        ], function (e) {
            var t = e('./lifecycle'), n = e('./error'), r = function (e) {
                    e = e || {}, t.call(this), this.name = e.name, this.layout = e.layout, this.filter = e.filter, this.level = e.level || 'all', this.isBelow = e.isLogLevelBelow || function () {
                        return !0;
                    };
                };
            return r.prototype = new t(), r.prototype.getName = function () {
                return this.name;
            }, r.prototype.append = function (e) {
                if (!this.isStarted())
                    throw new n('Appender "' + this.name + '" ' + 'must be started before it may be used');
                var t = 'neutral';
                this.filter && (t = this.filter.filter(e)), t === 'neutral' && (this.isBelow(e.getLevel(), this.level) ? t = 'accept' : t = 'deny');
                if (t !== 'accept')
                    return;
                this.doAppend(e);
            }, r.prototype.doAppend = function () {
            }, r.prototype.getLayout = function () {
                return this.layout;
            }, r;
        }), define('appenders/consoleappender', [
            'require',
            '../appender'
        ], function (e) {
            var t = e('../appender'), n = function (e) {
                    e = e || {}, t.call(this, e), this.appendStrings = typeof e.appendStrings != 'undefined' ? e.appendStrings : !0;
                };
            return n.prototype = new t(), n.prototype.doAppend = function (e) {
                var t = this.getLayout(), n = e.getLevel(), r = null, i = null;
                this.appendStrings ? (r = t.toMessageString(e), r && r.lastIndexOf('\n') === r.length - 1 && (r = r.substring(0, r.length - 1)), this.doAppendMessages(n, [r])) : (r = t.toMessageBits(e, { preserveObjects: !0 }), r && (i = r[r.length - 1], i && i.lastIndexOf('\n') === i.length - 1 && (r[r.length - 1] = i.substring(0, i.length - 1))), this.doAppendMessages(n, r));
            }, n.prototype.doAppendMessages = function (e, t) {
                if (typeof console == 'undefined')
                    return;
                e === 'info' ? console.info.apply(console, t) : e === 'warn' ? console.warn.apply(console, t) : e === 'error' ? console.error.apply(console, t) : console.log.apply(console, t);
            }, n;
        }));
        var io = 'undefined' == typeof module ? {} : module.exports;
        (function () {
            (function (e, t) {
                var n = e;
                n.version = '0.9.11', n.protocol = 1, n.transports = [], n.j = [], n.sockets = {}, n.connect = function (e, r) {
                    var i = n.util.parseUri(e), s, o;
                    t && t.location && (i.protocol = i.protocol || t.location.protocol.slice(0, -1), i.host = i.host || (t.document ? t.document.domain : t.location.hostname), i.port = i.port || t.location.port), s = n.util.uniqueUri(i);
                    var u = {
                        host: i.host,
                        secure: 'https' == i.protocol,
                        port: i.port || ('https' == i.protocol ? 443 : 80),
                        query: i.query || ''
                    };
                    n.util.merge(u, r);
                    if (u['force new connection'] || !n.sockets[s])
                        o = new n.Socket(u);
                    return !u['force new connection'] && o && (n.sockets[s] = o), o = o || n.sockets[s], o.of(i.path.length > 1 ? i.path : '');
                };
            }('object' == typeof module ? module.exports : io = {}, this), function (e, t) {
                var n = e.util = {}, r = /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/, i = [
                        'source',
                        'protocol',
                        'authority',
                        'userInfo',
                        'user',
                        'password',
                        'host',
                        'port',
                        'relative',
                        'path',
                        'directory',
                        'file',
                        'query',
                        'anchor'
                    ];
                n.parseUri = function (e) {
                    var t = r.exec(e || ''), n = {}, s = 14;
                    while (s--)
                        n[i[s]] = t[s] || '';
                    return n;
                }, n.uniqueUri = function (e) {
                    var n = e.protocol, r = e.host, i = e.port;
                    return 'document' in t ? (r = r || document.domain, i = i || (n == 'https' && document.location.protocol !== 'https:' ? 443 : document.location.port)) : (r = r || 'localhost', !i && n == 'https' && (i = 443)), (n || 'http') + '://' + r + ':' + (i || 80);
                }, n.query = function (e, t) {
                    var r = n.chunkQuery(e || ''), i = [];
                    n.merge(r, n.chunkQuery(t || ''));
                    for (var s in r)
                        r.hasOwnProperty(s) && i.push(s + '=' + r[s]);
                    return i.length ? '?' + i.join('&') : '';
                }, n.chunkQuery = function (e) {
                    var t = {}, n = e.split('&'), r = 0, i = n.length, s;
                    for (; r < i; ++r)
                        s = n[r].split('='), s[0] && (t[s[0]] = s[1]);
                    return t;
                };
                var s = !1;
                n.load = function (e) {
                    if ('document' in t && document.readyState === 'complete' || s)
                        return e();
                    n.on(t, 'load', e, !1);
                }, n.on = function (e, t, n, r) {
                    e.attachEvent ? e.attachEvent('on' + t, n) : e.addEventListener && e.addEventListener(t, n, r);
                }, n.request = function (e) {
                    if (e && 'undefined' != typeof XDomainRequest && !n.ua.hasCORS)
                        return new XDomainRequest();
                    if ('undefined' != typeof XMLHttpRequest && (!e || n.ua.hasCORS))
                        return new XMLHttpRequest();
                    if (!e)
                        try {
                            return new window[(['Active'].concat('Object').join('X'))]('Microsoft.XMLHTTP');
                        } catch (t) {
                        }
                    return null;
                }, 'undefined' != typeof window && n.load(function () {
                    s = !0;
                }), n.defer = function (e) {
                    if (!n.ua.webkit || 'undefined' != typeof importScripts)
                        return e();
                    n.load(function () {
                        setTimeout(e, 100);
                    });
                }, n.merge = function (t, r, i, s) {
                    var o = s || [], u = typeof i == 'undefined' ? 2 : i, a;
                    for (a in r)
                        r.hasOwnProperty(a) && n.indexOf(o, a) < 0 && (typeof t[a] != 'object' || !u ? (t[a] = r[a], o.push(r[a])) : n.merge(t[a], r[a], u - 1, o));
                    return t;
                }, n.mixin = function (e, t) {
                    n.merge(e.prototype, t.prototype);
                }, n.inherit = function (e, t) {
                    function n() {
                    }
                    n.prototype = t.prototype, e.prototype = new n();
                }, n.isArray = Array.isArray || function (e) {
                    return Object.prototype.toString.call(e) === '[object Array]';
                }, n.intersect = function (e, t) {
                    var r = [], i = e.length > t.length ? e : t, s = e.length > t.length ? t : e;
                    for (var o = 0, u = s.length; o < u; o++)
                        ~n.indexOf(i, s[o]) && r.push(s[o]);
                    return r;
                }, n.indexOf = function (e, t, n) {
                    for (var r = e.length, n = n < 0 ? n + r < 0 ? 0 : n + r : n || 0; n < r && e[n] !== t; n++);
                    return r <= n ? -1 : n;
                }, n.toArray = function (e) {
                    var t = [];
                    for (var n = 0, r = e.length; n < r; n++)
                        t.push(e[n]);
                    return t;
                }, n.ua = {}, n.ua.hasCORS = 'undefined' != typeof XMLHttpRequest && function () {
                    try {
                        var e = new XMLHttpRequest();
                    } catch (t) {
                        return !1;
                    }
                    return e.withCredentials != undefined;
                }(), n.ua.webkit = 'undefined' != typeof navigator && /webkit/i.test(navigator.userAgent), n.ua.iDevice = 'undefined' != typeof navigator && /iPad|iPhone|iPod/i.test(navigator.userAgent);
            }('undefined' != typeof io ? io : module.exports, this), function (e, t) {
                function n() {
                }
                e.EventEmitter = n, n.prototype.on = function (e, n) {
                    return this.$events || (this.$events = {}), this.$events[e] ? t.util.isArray(this.$events[e]) ? this.$events[e].push(n) : this.$events[e] = [
                        this.$events[e],
                        n
                    ] : this.$events[e] = n, this;
                }, n.prototype.addListener = n.prototype.on, n.prototype.once = function (e, t) {
                    function r() {
                        n.removeListener(e, r), t.apply(this, arguments);
                    }
                    var n = this;
                    return r.listener = t, this.on(e, r), this;
                }, n.prototype.removeListener = function (e, n) {
                    if (this.$events && this.$events[e]) {
                        var r = this.$events[e];
                        if (t.util.isArray(r)) {
                            var i = -1;
                            for (var s = 0, o = r.length; s < o; s++)
                                if (r[s] === n || r[s].listener && r[s].listener === n) {
                                    i = s;
                                    break;
                                }
                            if (i < 0)
                                return this;
                            r.splice(i, 1), r.length || delete this.$events[e];
                        } else
                            (r === n || r.listener && r.listener === n) && delete this.$events[e];
                    }
                    return this;
                }, n.prototype.removeAllListeners = function (e) {
                    return e === undefined ? (this.$events = {}, this) : (this.$events && this.$events[e] && (this.$events[e] = null), this);
                }, n.prototype.listeners = function (e) {
                    return this.$events || (this.$events = {}), this.$events[e] || (this.$events[e] = []), t.util.isArray(this.$events[e]) || (this.$events[e] = [this.$events[e]]), this.$events[e];
                }, n.prototype.emit = function (e) {
                    if (!this.$events)
                        return !1;
                    var n = this.$events[e];
                    if (!n)
                        return !1;
                    var r = Array.prototype.slice.call(arguments, 1);
                    if ('function' == typeof n)
                        n.apply(this, r);
                    else {
                        if (!t.util.isArray(n))
                            return !1;
                        var i = n.slice();
                        for (var s = 0, o = i.length; s < o; s++)
                            i[s].apply(this, r);
                    }
                    return !0;
                };
            }('undefined' != typeof io ? io : module.exports, 'undefined' != typeof io ? io : module.parent.exports), function (exports, nativeJSON) {
                function f(e) {
                    return e < 10 ? '0' + e : e;
                }
                function date(e, t) {
                    return isFinite(e.valueOf()) ? e.getUTCFullYear() + '-' + f(e.getUTCMonth() + 1) + '-' + f(e.getUTCDate()) + 'T' + f(e.getUTCHours()) + ':' + f(e.getUTCMinutes()) + ':' + f(e.getUTCSeconds()) + 'Z' : null;
                }
                function quote(e) {
                    return escapable.lastIndex = 0, escapable.test(e) ? '"' + e.replace(escapable, function (e) {
                        var t = meta[e];
                        return typeof t == 'string' ? t : '\\u' + ('0000' + e.charCodeAt(0).toString(16)).slice(-4);
                    }) + '"' : '"' + e + '"';
                }
                function str(e, t) {
                    var n, r, i, s, o = gap, u, a = t[e];
                    a instanceof Date && (a = date(e)), typeof rep == 'function' && (a = rep.call(t, e, a));
                    switch (typeof a) {
                    case 'string':
                        return quote(a);
                    case 'number':
                        return isFinite(a) ? String(a) : 'null';
                    case 'boolean':
                    case 'null':
                        return String(a);
                    case 'object':
                        if (!a)
                            return 'null';
                        gap += indent, u = [];
                        if (Object.prototype.toString.apply(a) === '[object Array]') {
                            s = a.length;
                            for (n = 0; n < s; n += 1)
                                u[n] = str(n, a) || 'null';
                            return i = u.length === 0 ? '[]' : gap ? '[\n' + gap + u.join(',\n' + gap) + '\n' + o + ']' : '[' + u.join(',') + ']', gap = o, i;
                        }
                        if (rep && typeof rep == 'object') {
                            s = rep.length;
                            for (n = 0; n < s; n += 1)
                                typeof rep[n] == 'string' && (r = rep[n], i = str(r, a), i && u.push(quote(r) + (gap ? ': ' : ':') + i));
                        } else
                            for (r in a)
                                Object.prototype.hasOwnProperty.call(a, r) && (i = str(r, a), i && u.push(quote(r) + (gap ? ': ' : ':') + i));
                        return i = u.length === 0 ? '{}' : gap ? '{\n' + gap + u.join(',\n' + gap) + '\n' + o + '}' : '{' + u.join(',') + '}', gap = o, i;
                    }
                }
                if (nativeJSON && nativeJSON.parse)
                    return exports.JSON = {
                        parse: nativeJSON.parse,
                        stringify: nativeJSON.stringify
                    };
                var JSON = exports.JSON = {}, cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = {
                        '\b': '\\b',
                        '\t': '\\t',
                        '\n': '\\n',
                        '\f': '\\f',
                        '\r': '\\r',
                        '"': '\\"',
                        '\\': '\\\\'
                    }, rep;
                JSON.stringify = function (e, t, n) {
                    var r;
                    gap = '', indent = '';
                    if (typeof n == 'number')
                        for (r = 0; r < n; r += 1)
                            indent += ' ';
                    else
                        typeof n == 'string' && (indent = n);
                    rep = t;
                    if (!t || typeof t == 'function' || typeof t == 'object' && typeof t.length == 'number')
                        return str('', { '': e });
                    throw new Error('JSON.stringify');
                }, JSON.parse = function (text, reviver) {
                    function walk(e, t) {
                        var n, r, i = e[t];
                        if (i && typeof i == 'object')
                            for (n in i)
                                Object.prototype.hasOwnProperty.call(i, n) && (r = walk(i, n), r !== undefined ? i[n] = r : delete i[n]);
                        return reviver.call(e, t, i);
                    }
                    var j;
                    text = String(text), cx.lastIndex = 0, cx.test(text) && (text = text.replace(cx, function (e) {
                        return '\\u' + ('0000' + e.charCodeAt(0).toString(16)).slice(-4);
                    }));
                    if (/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']').replace(/(?:^|:|,)(?:\s*\[)+/g, '')))
                        return j = eval('(' + text + ')'), typeof reviver == 'function' ? walk({ '': j }, '') : j;
                    throw new SyntaxError('JSON.parse');
                };
                return exports;
            }('undefined' != typeof io ? io : module.exports, typeof JSON != 'undefined' ? JSON : undefined), function (e, t) {
                var n = e.parser = {}, r = n.packets = [
                        'disconnect',
                        'connect',
                        'heartbeat',
                        'message',
                        'json',
                        'event',
                        'ack',
                        'error',
                        'noop'
                    ], i = n.reasons = [
                        'transport not supported',
                        'client not handshaken',
                        'unauthorized'
                    ], s = n.advice = ['reconnect'], o = t.JSON, u = t.util.indexOf;
                n.encodePacket = function (e) {
                    var t = u(r, e.type), n = e.id || '', a = e.endpoint || '', f = e.ack, l = null;
                    switch (e.type) {
                    case 'error':
                        var c = e.reason ? u(i, e.reason) : '', h = e.advice ? u(s, e.advice) : '';
                        if (c !== '' || h !== '')
                            l = c + (h !== '' ? '+' + h : '');
                        break;
                    case 'message':
                        e.data !== '' && (l = e.data);
                        break;
                    case 'event':
                        var p = { name: e.name };
                        e.args && e.args.length && (p.args = e.args), l = o.stringify(p);
                        break;
                    case 'json':
                        l = o.stringify(e.data);
                        break;
                    case 'connect':
                        e.qs && (l = e.qs);
                        break;
                    case 'ack':
                        l = e.ackId + (e.args && e.args.length ? '+' + o.stringify(e.args) : '');
                    }
                    var d = [
                        t,
                        n + (f == 'data' ? '+' : ''),
                        a
                    ];
                    return l !== null && l !== undefined && d.push(l), d.join(':');
                }, n.encodePayload = function (e) {
                    var t = '';
                    if (e.length == 1)
                        return e[0];
                    for (var n = 0, r = e.length; n < r; n++) {
                        var i = e[n];
                        t += '\uFFFD' + i.length + '\uFFFD' + e[n];
                    }
                    return t;
                };
                var a = /([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;
                n.decodePacket = function (e) {
                    var t = e.match(a);
                    if (!t)
                        return {};
                    var n = t[2] || '', e = t[5] || '', u = {
                            type: r[t[1]],
                            endpoint: t[4] || ''
                        };
                    n && (u.id = n, t[3] ? u.ack = 'data' : u.ack = !0);
                    switch (u.type) {
                    case 'error':
                        var t = e.split('+');
                        u.reason = i[t[0]] || '', u.advice = s[t[1]] || '';
                        break;
                    case 'message':
                        u.data = e || '';
                        break;
                    case 'event':
                        try {
                            var f = o.parse(e);
                            u.name = f.name, u.args = f.args;
                        } catch (l) {
                        }
                        u.args = u.args || [];
                        break;
                    case 'json':
                        try {
                            u.data = o.parse(e);
                        } catch (l) {
                        }
                        break;
                    case 'connect':
                        u.qs = e || '';
                        break;
                    case 'ack':
                        var t = e.match(/^([0-9]+)(\+)?(.*)/);
                        if (t) {
                            u.ackId = t[1], u.args = [];
                            if (t[3])
                                try {
                                    u.args = t[3] ? o.parse(t[3]) : [];
                                } catch (l) {
                                }
                        }
                        break;
                    case 'disconnect':
                    case 'heartbeat':
                    }
                    return u;
                }, n.decodePayload = function (e) {
                    if (e.charAt(0) == '\uFFFD') {
                        var t = [];
                        for (var r = 1, i = ''; r < e.length; r++)
                            e.charAt(r) == '\uFFFD' ? (t.push(n.decodePacket(e.substr(r + 1).substr(0, i))), r += Number(i) + 1, i = '') : i += e.charAt(r);
                        return t;
                    }
                    return [n.decodePacket(e)];
                };
            }('undefined' != typeof io ? io : module.exports, 'undefined' != typeof io ? io : module.parent.exports), function (e, t) {
                function n(e, t) {
                    this.socket = e, this.sessid = t;
                }
                e.Transport = n, t.util.mixin(n, t.EventEmitter), n.prototype.heartbeats = function () {
                    return !0;
                }, n.prototype.onData = function (e) {
                    this.clearCloseTimeout(), (this.socket.connected || this.socket.connecting || this.socket.reconnecting) && this.setCloseTimeout();
                    if (e !== '') {
                        var n = t.parser.decodePayload(e);
                        if (n && n.length)
                            for (var r = 0, i = n.length; r < i; r++)
                                this.onPacket(n[r]);
                    }
                    return this;
                }, n.prototype.onPacket = function (e) {
                    return this.socket.setHeartbeatTimeout(), e.type == 'heartbeat' ? this.onHeartbeat() : (e.type == 'connect' && e.endpoint == '' && this.onConnect(), e.type == 'error' && e.advice == 'reconnect' && (this.isOpen = !1), this.socket.onPacket(e), this);
                }, n.prototype.setCloseTimeout = function () {
                    if (!this.closeTimeout) {
                        var e = this;
                        this.closeTimeout = setTimeout(function () {
                            e.onDisconnect();
                        }, this.socket.closeTimeout);
                    }
                }, n.prototype.onDisconnect = function () {
                    return this.isOpen && this.close(), this.clearTimeouts(), this.socket.onDisconnect(), this;
                }, n.prototype.onConnect = function () {
                    return this.socket.onConnect(), this;
                }, n.prototype.clearCloseTimeout = function () {
                    this.closeTimeout && (clearTimeout(this.closeTimeout), this.closeTimeout = null);
                }, n.prototype.clearTimeouts = function () {
                    this.clearCloseTimeout(), this.reopenTimeout && clearTimeout(this.reopenTimeout);
                }, n.prototype.packet = function (e) {
                    this.send(t.parser.encodePacket(e));
                }, n.prototype.onHeartbeat = function (e) {
                    this.packet({ type: 'heartbeat' });
                }, n.prototype.onOpen = function () {
                    this.isOpen = !0, this.clearCloseTimeout(), this.socket.onOpen();
                }, n.prototype.onClose = function () {
                    var e = this;
                    this.isOpen = !1, this.socket.onClose(), this.onDisconnect();
                }, n.prototype.prepareUrl = function () {
                    var e = this.socket.options;
                    return this.scheme() + '://' + e.host + ':' + e.port + '/' + e.resource + '/' + t.protocol + '/' + this.name + '/' + this.sessid;
                }, n.prototype.ready = function (e, t) {
                    t.call(this);
                };
            }('undefined' != typeof io ? io : module.exports, 'undefined' != typeof io ? io : module.parent.exports), function (e, t, n) {
                function r(e) {
                    this.options = {
                        port: 80,
                        secure: !1,
                        document: 'document' in n ? document : !1,
                        resource: 'socket.io',
                        transports: t.transports,
                        'connect timeout': 10000,
                        'try multiple transports': !0,
                        reconnect: !0,
                        'reconnection delay': 500,
                        'reconnection limit': Infinity,
                        'reopen delay': 3000,
                        'max reconnection attempts': 10,
                        'sync disconnect on unload': !1,
                        'auto connect': !0,
                        'flash policy port': 10843,
                        manualFlush: !1
                    }, t.util.merge(this.options, e), this.connected = !1, this.open = !1, this.connecting = !1, this.reconnecting = !1, this.namespaces = {}, this.buffer = [], this.doBuffer = !1;
                    if (this.options['sync disconnect on unload'] && (!this.isXDomain() || t.util.ua.hasCORS)) {
                        var r = this;
                        t.util.on(n, 'beforeunload', function () {
                            r.disconnectSync();
                        }, !1);
                    }
                    this.options['auto connect'] && this.connect();
                }
                function i() {
                }
                e.Socket = r, t.util.mixin(r, t.EventEmitter), r.prototype.of = function (e) {
                    return this.namespaces[e] || (this.namespaces[e] = new t.SocketNamespace(this, e), e !== '' && this.namespaces[e].packet({ type: 'connect' })), this.namespaces[e];
                }, r.prototype.publish = function () {
                    this.emit.apply(this, arguments);
                    var e;
                    for (var t in this.namespaces)
                        this.namespaces.hasOwnProperty(t) && (e = this.of(t), e.$emit.apply(e, arguments));
                }, r.prototype.handshake = function (e) {
                    function s(t) {
                        t instanceof Error ? (n.connecting = !1, n.onError(t.message)) : e.apply(null, t.split(':'));
                    }
                    var n = this, r = this.options, o = [
                            'http' + (r.secure ? 's' : '') + ':/',
                            r.host + ':' + r.port,
                            r.resource,
                            t.protocol,
                            t.util.query(this.options.query, 't=' + +new Date())
                        ].join('/');
                    if (this.isXDomain() && !t.util.ua.hasCORS) {
                        var u = document.getElementsByTagName('script')[0], a = document.createElement('script');
                        a.src = o + '&jsonp=' + t.j.length, u.parentNode.insertBefore(a, u), t.j.push(function (e) {
                            s(e), a.parentNode.removeChild(a);
                        });
                    } else {
                        var f = t.util.request();
                        f.open('GET', o, !0), this.isXDomain() && (f.withCredentials = !0), f.onreadystatechange = function () {
                            f.readyState == 4 && (f.onreadystatechange = i, f.status == 200 ? s(f.responseText) : f.status == 403 ? n.onError(f.responseText) : (n.connecting = !1, !n.reconnecting && n.onError(f.responseText)));
                        }, f.send(null);
                    }
                }, r.prototype.getTransport = function (e) {
                    var n = e || this.transports, r;
                    for (var i = 0, s; s = n[i]; i++)
                        if (t.Transport[s] && t.Transport[s].check(this) && (!this.isXDomain() || t.Transport[s].xdomainCheck(this)))
                            return new t.Transport[s](this, this.sessionid);
                    return null;
                }, r.prototype.connect = function (e) {
                    if (this.connecting)
                        return this;
                    var n = this;
                    return n.connecting = !0, this.handshake(function (r, i, s, o) {
                        function u(e) {
                            n.transport && n.transport.clearTimeouts(), n.transport = n.getTransport(e);
                            if (!n.transport)
                                return n.publish('connect_failed');
                            n.transport.ready(n, function () {
                                n.connecting = !0, n.publish('connecting', n.transport.name), n.transport.open(), n.options['connect timeout'] && (n.connectTimeoutTimer = setTimeout(function () {
                                    if (!n.connected) {
                                        n.connecting = !1;
                                        if (n.options['try multiple transports']) {
                                            var e = n.transports;
                                            while (e.length > 0 && e.splice(0, 1)[0] != n.transport.name);
                                            e.length ? u(e) : n.publish('connect_failed');
                                        }
                                    }
                                }, n.options['connect timeout']));
                            });
                        }
                        n.sessionid = r, n.closeTimeout = s * 1000, n.heartbeatTimeout = i * 1000, n.transports || (n.transports = n.origTransports = o ? t.util.intersect(o.split(','), n.options.transports) : n.options.transports), n.setHeartbeatTimeout(), u(n.transports), n.once('connect', function () {
                            clearTimeout(n.connectTimeoutTimer), e && typeof e == 'function' && e();
                        });
                    }), this;
                }, r.prototype.setHeartbeatTimeout = function () {
                    clearTimeout(this.heartbeatTimeoutTimer);
                    if (this.transport && !this.transport.heartbeats())
                        return;
                    var e = this;
                    this.heartbeatTimeoutTimer = setTimeout(function () {
                        e.transport.onClose();
                    }, this.heartbeatTimeout);
                }, r.prototype.packet = function (e) {
                    return this.connected && !this.doBuffer ? this.transport.packet(e) : this.buffer.push(e), this;
                }, r.prototype.setBuffer = function (e) {
                    this.doBuffer = e, !e && this.connected && this.buffer.length && (this.options.manualFlush || this.flushBuffer());
                }, r.prototype.flushBuffer = function () {
                    this.transport.payload(this.buffer), this.buffer = [];
                }, r.prototype.disconnect = function () {
                    if (this.connected || this.connecting)
                        this.open && this.of('').packet({ type: 'disconnect' }), this.onDisconnect('booted');
                    return this;
                }, r.prototype.disconnectSync = function () {
                    var e = t.util.request(), n = [
                            'http' + (this.options.secure ? 's' : '') + ':/',
                            this.options.host + ':' + this.options.port,
                            this.options.resource,
                            t.protocol,
                            '',
                            this.sessionid
                        ].join('/') + '/?disconnect=1';
                    e.open('GET', n, !1), e.send(null), this.onDisconnect('booted');
                }, r.prototype.isXDomain = function () {
                    var e = n.location.port || ('https:' == n.location.protocol ? 443 : 80);
                    return this.options.host !== n.location.hostname || this.options.port != e;
                }, r.prototype.onConnect = function () {
                    this.connected || (this.connected = !0, this.connecting = !1, this.doBuffer || this.setBuffer(!1), this.emit('connect'));
                }, r.prototype.onOpen = function () {
                    this.open = !0;
                }, r.prototype.onClose = function () {
                    this.open = !1, clearTimeout(this.heartbeatTimeoutTimer);
                }, r.prototype.onPacket = function (e) {
                    this.of(e.endpoint).onPacket(e);
                }, r.prototype.onError = function (e) {
                    e && e.advice && e.advice === 'reconnect' && (this.connected || this.connecting) && (this.disconnect(), this.options.reconnect && this.reconnect()), this.publish('error', e && e.reason ? e.reason : e);
                }, r.prototype.onDisconnect = function (e) {
                    var t = this.connected, n = this.connecting;
                    this.connected = !1, this.connecting = !1, this.open = !1;
                    if (t || n)
                        this.transport.close(), this.transport.clearTimeouts(), t && (this.publish('disconnect', e), 'booted' != e && this.options.reconnect && !this.reconnecting && this.reconnect());
                }, r.prototype.reconnect = function () {
                    function i() {
                        if (e.connected) {
                            for (var t in e.namespaces)
                                e.namespaces.hasOwnProperty(t) && '' !== t && e.namespaces[t].packet({ type: 'connect' });
                            e.publish('reconnect', e.transport.name, e.reconnectionAttempts);
                        }
                        clearTimeout(e.reconnectionTimer), e.removeListener('connect_failed', s), e.removeListener('connect', s), e.reconnecting = !1, delete e.reconnectionAttempts, delete e.reconnectionDelay, delete e.reconnectionTimer, delete e.redoTransports, e.options['try multiple transports'] = n;
                    }
                    function s() {
                        if (!e.reconnecting)
                            return;
                        if (e.connected)
                            return i();
                        if (e.connecting && e.reconnecting)
                            return e.reconnectionTimer = setTimeout(s, 1000);
                        e.reconnectionAttempts++ >= t ? e.redoTransports ? (e.publish('reconnect_failed'), i()) : (e.on('connect_failed', s), e.options['try multiple transports'] = !0, e.transports = e.origTransports, e.transport = e.getTransport(), e.redoTransports = !0, e.connect()) : (e.reconnectionDelay < r && (e.reconnectionDelay *= 2), e.connect(), e.publish('reconnecting', e.reconnectionDelay, e.reconnectionAttempts), e.reconnectionTimer = setTimeout(s, e.reconnectionDelay));
                    }
                    this.reconnecting = !0, this.reconnectionAttempts = 0, this.reconnectionDelay = this.options['reconnection delay'];
                    var e = this, t = this.options['max reconnection attempts'], n = this.options['try multiple transports'], r = this.options['reconnection limit'];
                    this.options['try multiple transports'] = !1, this.reconnectionTimer = setTimeout(s, this.reconnectionDelay), this.on('connect', s);
                };
            }('undefined' != typeof io ? io : module.exports, 'undefined' != typeof io ? io : module.parent.exports, this), function (e, t) {
                function n(e, t) {
                    this.socket = e, this.name = t || '', this.flags = {}, this.json = new r(this, 'json'), this.ackPackets = 0, this.acks = {};
                }
                function r(e, t) {
                    this.namespace = e, this.name = t;
                }
                e.SocketNamespace = n, t.util.mixin(n, t.EventEmitter), n.prototype.$emit = t.EventEmitter.prototype.emit, n.prototype.of = function () {
                    return this.socket.of.apply(this.socket, arguments);
                }, n.prototype.packet = function (e) {
                    return e.endpoint = this.name, this.socket.packet(e), this.flags = {}, this;
                }, n.prototype.send = function (e, t) {
                    var n = {
                        type: this.flags.json ? 'json' : 'message',
                        data: e
                    };
                    return 'function' == typeof t && (n.id = ++this.ackPackets, n.ack = !0, this.acks[n.id] = t), this.packet(n);
                }, n.prototype.emit = function (e) {
                    var t = Array.prototype.slice.call(arguments, 1), n = t[t.length - 1], r = {
                            type: 'event',
                            name: e
                        };
                    return 'function' == typeof n && (r.id = ++this.ackPackets, r.ack = 'data', this.acks[r.id] = n, t = t.slice(0, t.length - 1)), r.args = t, this.packet(r);
                }, n.prototype.disconnect = function () {
                    return this.name === '' ? this.socket.disconnect() : (this.packet({ type: 'disconnect' }), this.$emit('disconnect')), this;
                }, n.prototype.onPacket = function (e) {
                    function r() {
                        n.packet({
                            type: 'ack',
                            args: t.util.toArray(arguments),
                            ackId: e.id
                        });
                    }
                    var n = this;
                    switch (e.type) {
                    case 'connect':
                        this.$emit('connect');
                        break;
                    case 'disconnect':
                        this.name === '' ? this.socket.onDisconnect(e.reason || 'booted') : this.$emit('disconnect', e.reason);
                        break;
                    case 'message':
                    case 'json':
                        var i = [
                            'message',
                            e.data
                        ];
                        e.ack == 'data' ? i.push(r) : e.ack && this.packet({
                            type: 'ack',
                            ackId: e.id
                        }), this.$emit.apply(this, i);
                        break;
                    case 'event':
                        var i = [e.name].concat(e.args);
                        e.ack == 'data' && i.push(r), this.$emit.apply(this, i);
                        break;
                    case 'ack':
                        this.acks[e.ackId] && (this.acks[e.ackId].apply(this, e.args), delete this.acks[e.ackId]);
                        break;
                    case 'error':
                        e.advice ? this.socket.onError(e) : e.reason == 'unauthorized' ? this.$emit('connect_failed', e.reason) : this.$emit('error', e.reason);
                    }
                }, r.prototype.send = function () {
                    this.namespace.flags[this.name] = !0, this.namespace.send.apply(this.namespace, arguments);
                }, r.prototype.emit = function () {
                    this.namespace.flags[this.name] = !0, this.namespace.emit.apply(this.namespace, arguments);
                };
            }('undefined' != typeof io ? io : module.exports, 'undefined' != typeof io ? io : module.parent.exports), function (e, t, n) {
                function r(e) {
                    t.Transport.apply(this, arguments);
                }
                e.websocket = r, t.util.inherit(r, t.Transport), r.prototype.name = 'websocket', r.prototype.open = function () {
                    var e = t.util.query(this.socket.options.query), r = this, i;
                    return i || (i = n.MozWebSocket || n.WebSocket), this.websocket = new i(this.prepareUrl() + e), this.websocket.onopen = function () {
                        r.onOpen(), r.socket.setBuffer(!1);
                    }, this.websocket.onmessage = function (e) {
                        r.onData(e.data);
                    }, this.websocket.onclose = function () {
                        r.onClose(), r.socket.setBuffer(!0);
                    }, this.websocket.onerror = function (e) {
                        r.onError(e);
                    }, this;
                }, t.util.ua.iDevice ? r.prototype.send = function (e) {
                    var t = this;
                    return setTimeout(function () {
                        t.websocket.send(e);
                    }, 0), this;
                } : r.prototype.send = function (e) {
                    return this.websocket.send(e), this;
                }, r.prototype.payload = function (e) {
                    for (var t = 0, n = e.length; t < n; t++)
                        this.packet(e[t]);
                    return this;
                }, r.prototype.close = function () {
                    return this.websocket.close(), this;
                }, r.prototype.onError = function (e) {
                    this.socket.onError(e);
                }, r.prototype.scheme = function () {
                    return this.socket.options.secure ? 'wss' : 'ws';
                }, r.check = function () {
                    return 'WebSocket' in n && !('__addTask' in WebSocket) || 'MozWebSocket' in n;
                }, r.xdomainCheck = function () {
                    return !0;
                }, t.transports.push('websocket');
            }('undefined' != typeof io ? io.Transport : module.exports, 'undefined' != typeof io ? io : module.parent.exports, this), function (e, t) {
                function n() {
                    t.Transport.websocket.apply(this, arguments);
                }
                e.flashsocket = n, t.util.inherit(n, t.Transport.websocket), n.prototype.name = 'flashsocket', n.prototype.open = function () {
                    var e = this, n = arguments;
                    return WebSocket.__addTask(function () {
                        t.Transport.websocket.prototype.open.apply(e, n);
                    }), this;
                }, n.prototype.send = function () {
                    var e = this, n = arguments;
                    return WebSocket.__addTask(function () {
                        t.Transport.websocket.prototype.send.apply(e, n);
                    }), this;
                }, n.prototype.close = function () {
                    return WebSocket.__tasks.length = 0, t.Transport.websocket.prototype.close.call(this), this;
                }, n.prototype.ready = function (e, r) {
                    function i() {
                        var t = e.options, i = t['flash policy port'], o = [
                                'http' + (t.secure ? 's' : '') + ':/',
                                t.host + ':' + t.port,
                                t.resource,
                                'static/flashsocket',
                                'WebSocketMain' + (e.isXDomain() ? 'Insecure' : '') + '.swf'
                            ];
                        n.loaded || (typeof WEB_SOCKET_SWF_LOCATION == 'undefined' && (WEB_SOCKET_SWF_LOCATION = o.join('/')), i !== 843 && WebSocket.loadFlashPolicyFile('xmlsocket://' + t.host + ':' + i), WebSocket.__initialize(), n.loaded = !0), r.call(s);
                    }
                    var s = this;
                    if (document.body)
                        return i();
                    t.util.load(i);
                }, n.check = function () {
                    return typeof WebSocket != 'undefined' && '__initialize' in WebSocket && !!swfobject ? swfobject.getFlashPlayerVersion().major >= 10 : !1;
                }, n.xdomainCheck = function () {
                    return !0;
                }, typeof window != 'undefined' && (WEB_SOCKET_DISABLE_AUTO_INITIALIZATION = !0), t.transports.push('flashsocket');
            }('undefined' != typeof io ? io.Transport : module.exports, 'undefined' != typeof io ? io : module.parent.exports));
            if ('undefined' != typeof window)
                var swfobject = function () {
                    function C() {
                        if (b)
                            return;
                        try {
                            var e = a.getElementsByTagName('body')[0].appendChild(U('span'));
                            e.parentNode.removeChild(e);
                        } catch (t) {
                            return;
                        }
                        b = !0;
                        var n = c.length;
                        for (var r = 0; r < n; r++)
                            c[r]();
                    }
                    function k(e) {
                        b ? e() : c[c.length] = e;
                    }
                    function L(t) {
                        if (typeof u.addEventListener != e)
                            u.addEventListener('load', t, !1);
                        else if (typeof a.addEventListener != e)
                            a.addEventListener('load', t, !1);
                        else if (typeof u.attachEvent != e)
                            z(u, 'onload', t);
                        else if (typeof u.onload == 'function') {
                            var n = u.onload;
                            u.onload = function () {
                                n(), t();
                            };
                        } else
                            u.onload = t;
                    }
                    function A() {
                        l ? O() : M();
                    }
                    function O() {
                        var n = a.getElementsByTagName('body')[0], r = U(t);
                        r.setAttribute('type', i);
                        var s = n.appendChild(r);
                        if (s) {
                            var o = 0;
                            (function () {
                                if (typeof s.GetVariable != e) {
                                    var t = s.GetVariable('$version');
                                    t && (t = t.split(' ')[1].split(','), T.pv = [
                                        parseInt(t[0], 10),
                                        parseInt(t[1], 10),
                                        parseInt(t[2], 10)
                                    ]);
                                } else if (o < 10) {
                                    o++, setTimeout(arguments.callee, 10);
                                    return;
                                }
                                n.removeChild(r), s = null, M();
                            }());
                        } else
                            M();
                    }
                    function M() {
                        var t = h.length;
                        if (t > 0)
                            for (var n = 0; n < t; n++) {
                                var r = h[n].id, i = h[n].callbackFn, s = {
                                        success: !1,
                                        id: r
                                    };
                                if (T.pv[0] > 0) {
                                    var o = R(r);
                                    if (o)
                                        if (W(h[n].swfVersion) && !(T.wk && T.wk < 312))
                                            V(r, !0), i && (s.success = !0, s.ref = _(r), i(s));
                                        else if (h[n].expressInstall && D()) {
                                            var u = {};
                                            u.data = h[n].expressInstall, u.width = o.getAttribute('width') || '0', u.height = o.getAttribute('height') || '0', o.getAttribute('class') && (u.styleclass = o.getAttribute('class')), o.getAttribute('align') && (u.align = o.getAttribute('align'));
                                            var a = {}, f = o.getElementsByTagName('param'), l = f.length;
                                            for (var c = 0; c < l; c++)
                                                f[c].getAttribute('name').toLowerCase() != 'movie' && (a[f[c].getAttribute('name')] = f[c].getAttribute('value'));
                                            P(u, a, r, i);
                                        } else
                                            H(o), i && i(s);
                                } else {
                                    V(r, !0);
                                    if (i) {
                                        var p = _(r);
                                        p && typeof p.SetVariable != e && (s.success = !0, s.ref = p), i(s);
                                    }
                                }
                            }
                    }
                    function _(n) {
                        var r = null, i = R(n);
                        if (i && i.nodeName == 'OBJECT')
                            if (typeof i.SetVariable != e)
                                r = i;
                            else {
                                var s = i.getElementsByTagName(t)[0];
                                s && (r = s);
                            }
                        return r;
                    }
                    function D() {
                        return !w && W('6.0.65') && (T.win || T.mac) && !(T.wk && T.wk < 312);
                    }
                    function P(t, n, r, i) {
                        w = !0, g = i || null, y = {
                            success: !1,
                            id: r
                        };
                        var o = R(r);
                        if (o) {
                            o.nodeName == 'OBJECT' ? (v = B(o), m = null) : (v = o, m = r), t.id = s;
                            if (typeof t.width == e || !/%$/.test(t.width) && parseInt(t.width, 10) < 310)
                                t.width = '310';
                            if (typeof t.height == e || !/%$/.test(t.height) && parseInt(t.height, 10) < 137)
                                t.height = '137';
                            a.title = a.title.slice(0, 47) + ' - Flash Player Installation';
                            var f = T.ie && T.win ? ['Active'].concat('').join('X') : 'PlugIn', l = 'MMredirectURL=' + u.location.toString().replace(/&/g, '%26') + '&MMplayerType=' + f + '&MMdoctitle=' + a.title;
                            typeof n.flashvars != e ? n.flashvars += '&' + l : n.flashvars = l;
                            if (T.ie && T.win && o.readyState != 4) {
                                var c = U('div');
                                r += 'SWFObjectNew', c.setAttribute('id', r), o.parentNode.insertBefore(c, o), o.style.display = 'none', function () {
                                    o.readyState == 4 ? o.parentNode.removeChild(o) : setTimeout(arguments.callee, 10);
                                }();
                            }
                            j(t, n, r);
                        }
                    }
                    function H(e) {
                        if (T.ie && T.win && e.readyState != 4) {
                            var t = U('div');
                            e.parentNode.insertBefore(t, e), t.parentNode.replaceChild(B(e), t), e.style.display = 'none', function () {
                                e.readyState == 4 ? e.parentNode.removeChild(e) : setTimeout(arguments.callee, 10);
                            }();
                        } else
                            e.parentNode.replaceChild(B(e), e);
                    }
                    function B(e) {
                        var n = U('div');
                        if (T.win && T.ie)
                            n.innerHTML = e.innerHTML;
                        else {
                            var r = e.getElementsByTagName(t)[0];
                            if (r) {
                                var i = r.childNodes;
                                if (i) {
                                    var s = i.length;
                                    for (var o = 0; o < s; o++)
                                        (i[o].nodeType != 1 || i[o].nodeName != 'PARAM') && i[o].nodeType != 8 && n.appendChild(i[o].cloneNode(!0));
                                }
                            }
                        }
                        return n;
                    }
                    function j(n, r, s) {
                        var o, u = R(s);
                        if (T.wk && T.wk < 312)
                            return o;
                        if (u) {
                            typeof n.id == e && (n.id = s);
                            if (T.ie && T.win) {
                                var a = '';
                                for (var f in n)
                                    n[f] != Object.prototype[f] && (f.toLowerCase() == 'data' ? r.movie = n[f] : f.toLowerCase() == 'styleclass' ? a += ' class="' + n[f] + '"' : f.toLowerCase() != 'classid' && (a += ' ' + f + '="' + n[f] + '"'));
                                var l = '';
                                for (var c in r)
                                    r[c] != Object.prototype[c] && (l += '<param name="' + c + '" value="' + r[c] + '" />');
                                u.outerHTML = '<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"' + a + '>' + l + '</object>', p[p.length] = n.id, o = R(n.id);
                            } else {
                                var h = U(t);
                                h.setAttribute('type', i);
                                for (var d in n)
                                    n[d] != Object.prototype[d] && (d.toLowerCase() == 'styleclass' ? h.setAttribute('class', n[d]) : d.toLowerCase() != 'classid' && h.setAttribute(d, n[d]));
                                for (var v in r)
                                    r[v] != Object.prototype[v] && v.toLowerCase() != 'movie' && F(h, v, r[v]);
                                u.parentNode.replaceChild(h, u), o = h;
                            }
                        }
                        return o;
                    }
                    function F(e, t, n) {
                        var r = U('param');
                        r.setAttribute('name', t), r.setAttribute('value', n), e.appendChild(r);
                    }
                    function I(e) {
                        var t = R(e);
                        t && t.nodeName == 'OBJECT' && (T.ie && T.win ? (t.style.display = 'none', function () {
                            t.readyState == 4 ? q(e) : setTimeout(arguments.callee, 10);
                        }()) : t.parentNode.removeChild(t));
                    }
                    function q(e) {
                        var t = R(e);
                        if (t) {
                            for (var n in t)
                                typeof t[n] == 'function' && (t[n] = null);
                            t.parentNode.removeChild(t);
                        }
                    }
                    function R(e) {
                        var t = null;
                        try {
                            t = a.getElementById(e);
                        } catch (n) {
                        }
                        return t;
                    }
                    function U(e) {
                        return a.createElement(e);
                    }
                    function z(e, t, n) {
                        e.attachEvent(t, n), d[d.length] = [
                            e,
                            t,
                            n
                        ];
                    }
                    function W(e) {
                        var t = T.pv, n = e.split('.');
                        return n[0] = parseInt(n[0], 10), n[1] = parseInt(n[1], 10) || 0, n[2] = parseInt(n[2], 10) || 0, t[0] > n[0] || t[0] == n[0] && t[1] > n[1] || t[0] == n[0] && t[1] == n[1] && t[2] >= n[2] ? !0 : !1;
                    }
                    function X(n, r, i, s) {
                        if (T.ie && T.mac)
                            return;
                        var o = a.getElementsByTagName('head')[0];
                        if (!o)
                            return;
                        var u = i && typeof i == 'string' ? i : 'screen';
                        s && (E = null, S = null);
                        if (!E || S != u) {
                            var f = U('style');
                            f.setAttribute('type', 'text/css'), f.setAttribute('media', u), E = o.appendChild(f), T.ie && T.win && typeof a.styleSheets != e && a.styleSheets.length > 0 && (E = a.styleSheets[a.styleSheets.length - 1]), S = u;
                        }
                        T.ie && T.win ? E && typeof E.addRule == t && E.addRule(n, r) : E && typeof a.createTextNode != e && E.appendChild(a.createTextNode(n + ' {' + r + '}'));
                    }
                    function V(e, t) {
                        if (!x)
                            return;
                        var n = t ? 'visible' : 'hidden';
                        b && R(e) ? R(e).style.visibility = n : X('#' + e, 'visibility:' + n);
                    }
                    function $(t) {
                        var n = /[\\\"<>\.;]/, r = n.exec(t) != null;
                        return r && typeof encodeURIComponent != e ? encodeURIComponent(t) : t;
                    }
                    var e = 'undefined', t = 'object', n = 'Shockwave Flash', r = 'ShockwaveFlash.ShockwaveFlash', i = 'application/x-shockwave-flash', s = 'SWFObjectExprInst', o = 'onreadystatechange', u = window, a = document, f = navigator, l = !1, c = [A], h = [], p = [], d = [], v, m, g, y, b = !1, w = !1, E, S, x = !0, T = function () {
                            var s = typeof a.getElementById != e && typeof a.getElementsByTagName != e && typeof a.createElement != e, o = f.userAgent.toLowerCase(), c = f.platform.toLowerCase(), h = c ? /win/.test(c) : /win/.test(o), p = c ? /mac/.test(c) : /mac/.test(o), d = /webkit/.test(o) ? parseFloat(o.replace(/^.*webkit\/(\d+(\.\d+)?).*$/, '$1')) : !1, v = !1, m = [
                                    0,
                                    0,
                                    0
                                ], g = null;
                            if (typeof f.plugins != e && typeof f.plugins[n] == t)
                                g = f.plugins[n].description, g && (typeof f.mimeTypes == e || !f.mimeTypes[i] || !!f.mimeTypes[i].enabledPlugin) && (l = !0, v = !1, g = g.replace(/^.*\s+(\S+\s+\S+$)/, '$1'), m[0] = parseInt(g.replace(/^(.*)\..*$/, '$1'), 10), m[1] = parseInt(g.replace(/^.*\.(.*)\s.*$/, '$1'), 10), m[2] = /[a-zA-Z]/.test(g) ? parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/, '$1'), 10) : 0);
                            else if (typeof u[['Active'].concat('Object').join('X')] != e)
                                try {
                                    var y = new window[(['Active'].concat('Object').join('X'))](r);
                                    y && (g = y.GetVariable('$version'), g && (v = !0, g = g.split(' ')[1].split(','), m = [
                                        parseInt(g[0], 10),
                                        parseInt(g[1], 10),
                                        parseInt(g[2], 10)
                                    ]));
                                } catch (b) {
                                }
                            return {
                                w3: s,
                                pv: m,
                                wk: d,
                                ie: v,
                                win: h,
                                mac: p
                            };
                        }(), N = function () {
                            if (!T.w3)
                                return;
                            (typeof a.readyState != e && a.readyState == 'complete' || typeof a.readyState == e && (a.getElementsByTagName('body')[0] || a.body)) && C(), b || (typeof a.addEventListener != e && a.addEventListener('DOMContentLoaded', C, !1), T.ie && T.win && (a.attachEvent(o, function () {
                                a.readyState == 'complete' && (a.detachEvent(o, arguments.callee), C());
                            }), u == top && function () {
                                if (b)
                                    return;
                                try {
                                    a.documentElement.doScroll('left');
                                } catch (e) {
                                    setTimeout(arguments.callee, 0);
                                    return;
                                }
                                C();
                            }()), T.wk && function () {
                                if (b)
                                    return;
                                if (!/loaded|complete/.test(a.readyState)) {
                                    setTimeout(arguments.callee, 0);
                                    return;
                                }
                                C();
                            }(), L(C));
                        }(), J = function () {
                            T.ie && T.win && window.attachEvent('onunload', function () {
                                var e = d.length;
                                for (var t = 0; t < e; t++)
                                    d[t][0].detachEvent(d[t][1], d[t][2]);
                                var n = p.length;
                                for (var r = 0; r < n; r++)
                                    I(p[r]);
                                for (var i in T)
                                    T[i] = null;
                                T = null;
                                for (var s in swfobject)
                                    swfobject[s] = null;
                                swfobject = null;
                            });
                        }();
                    return {
                        registerObject: function (e, t, n, r) {
                            if (T.w3 && e && t) {
                                var i = {};
                                i.id = e, i.swfVersion = t, i.expressInstall = n, i.callbackFn = r, h[h.length] = i, V(e, !1);
                            } else
                                r && r({
                                    success: !1,
                                    id: e
                                });
                        },
                        getObjectById: function (e) {
                            if (T.w3)
                                return _(e);
                        },
                        embedSWF: function (n, r, i, s, o, u, a, f, l, c) {
                            var h = {
                                success: !1,
                                id: r
                            };
                            T.w3 && !(T.wk && T.wk < 312) && n && r && i && s && o ? (V(r, !1), k(function () {
                                i += '', s += '';
                                var p = {};
                                if (l && typeof l === t)
                                    for (var d in l)
                                        p[d] = l[d];
                                p.data = n, p.width = i, p.height = s;
                                var v = {};
                                if (f && typeof f === t)
                                    for (var m in f)
                                        v[m] = f[m];
                                if (a && typeof a === t)
                                    for (var g in a)
                                        typeof v.flashvars != e ? v.flashvars += '&' + g + '=' + a[g] : v.flashvars = g + '=' + a[g];
                                if (W(o)) {
                                    var y = j(p, v, r);
                                    p.id == r && V(r, !0), h.success = !0, h.ref = y;
                                } else {
                                    if (u && D()) {
                                        p.data = u, P(p, v, r, c);
                                        return;
                                    }
                                    V(r, !0);
                                }
                                c && c(h);
                            })) : c && c(h);
                        },
                        switchOffAutoHideShow: function () {
                            x = !1;
                        },
                        ua: T,
                        getFlashPlayerVersion: function () {
                            return {
                                major: T.pv[0],
                                minor: T.pv[1],
                                release: T.pv[2]
                            };
                        },
                        hasFlashPlayerVersion: W,
                        createSWF: function (e, t, n) {
                            return T.w3 ? j(e, t, n) : undefined;
                        },
                        showExpressInstall: function (e, t, n, r) {
                            T.w3 && D() && P(e, t, n, r);
                        },
                        removeSWF: function (e) {
                            T.w3 && I(e);
                        },
                        createCSS: function (e, t, n, r) {
                            T.w3 && X(e, t, n, r);
                        },
                        addDomLoadEvent: k,
                        addLoadEvent: L,
                        getQueryParamValue: function (e) {
                            var t = a.location.search || a.location.hash;
                            if (t) {
                                /\?/.test(t) && (t = t.split('?')[1]);
                                if (e == null)
                                    return $(t);
                                var n = t.split('&');
                                for (var r = 0; r < n.length; r++)
                                    if (n[r].substring(0, n[r].indexOf('=')) == e)
                                        return $(n[r].substring(n[r].indexOf('=') + 1));
                            }
                            return '';
                        },
                        expressInstallCallback: function () {
                            if (w) {
                                var e = R(s);
                                e && v && (e.parentNode.replaceChild(v, e), m && (V(m, !0), T.ie && T.win && (v.style.display = 'block')), g && g(y)), w = !1;
                            }
                        }
                    };
                }();
            (function () {
                if ('undefined' == typeof window || window.WebSocket)
                    return;
                var e = window.console;
                if (!e || !e.log || !e.error)
                    e = {
                        log: function () {
                        },
                        error: function () {
                        }
                    };
                if (!swfobject.hasFlashPlayerVersion('10.0.0')) {
                    e.error('Flash Player >= 10.0.0 is required.');
                    return;
                }
                location.protocol == 'file:' && e.error('WARNING: web-socket-js doesn\'t work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://...'), WebSocket = function (e, t, n, r, i) {
                    var s = this;
                    s.__id = WebSocket.__nextId++, WebSocket.__instances[s.__id] = s, s.readyState = WebSocket.CONNECTING, s.bufferedAmount = 0, s.__events = {}, t ? typeof t == 'string' && (t = [t]) : t = [], setTimeout(function () {
                        WebSocket.__addTask(function () {
                            WebSocket.__flash.create(s.__id, e, t, n || null, r || 0, i || null);
                        });
                    }, 0);
                }, WebSocket.prototype.send = function (e) {
                    if (this.readyState == WebSocket.CONNECTING)
                        throw 'INVALID_STATE_ERR: Web Socket connection has not been established';
                    var t = WebSocket.__flash.send(this.__id, encodeURIComponent(e));
                    return t < 0 ? !0 : (this.bufferedAmount += t, !1);
                }, WebSocket.prototype.close = function () {
                    if (this.readyState == WebSocket.CLOSED || this.readyState == WebSocket.CLOSING)
                        return;
                    this.readyState = WebSocket.CLOSING, WebSocket.__flash.close(this.__id);
                }, WebSocket.prototype.addEventListener = function (e, t, n) {
                    e in this.__events || (this.__events[e] = []), this.__events[e].push(t);
                }, WebSocket.prototype.removeEventListener = function (e, t, n) {
                    if (!(e in this.__events))
                        return;
                    var r = this.__events[e];
                    for (var i = r.length - 1; i >= 0; --i)
                        if (r[i] === t) {
                            r.splice(i, 1);
                            break;
                        }
                }, WebSocket.prototype.dispatchEvent = function (e) {
                    var t = this.__events[e.type] || [];
                    for (var n = 0; n < t.length; ++n)
                        t[n](e);
                    var r = this['on' + e.type];
                    r && r(e);
                }, WebSocket.prototype.__handleEvent = function (e) {
                    'readyState' in e && (this.readyState = e.readyState), 'protocol' in e && (this.protocol = e.protocol);
                    var t;
                    if (e.type == 'open' || e.type == 'error')
                        t = this.__createSimpleEvent(e.type);
                    else if (e.type == 'close')
                        t = this.__createSimpleEvent('close');
                    else {
                        if (e.type != 'message')
                            throw 'unknown event type: ' + e.type;
                        var n = decodeURIComponent(e.message);
                        t = this.__createMessageEvent('message', n);
                    }
                    this.dispatchEvent(t);
                }, WebSocket.prototype.__createSimpleEvent = function (e) {
                    if (document.createEvent && window.Event) {
                        var t = document.createEvent('Event');
                        return t.initEvent(e, !1, !1), t;
                    }
                    return {
                        type: e,
                        bubbles: !1,
                        cancelable: !1
                    };
                }, WebSocket.prototype.__createMessageEvent = function (e, t) {
                    if (document.createEvent && window.MessageEvent && !window.opera) {
                        var n = document.createEvent('MessageEvent');
                        return n.initMessageEvent('message', !1, !1, t, null, null, window, null), n;
                    }
                    return {
                        type: e,
                        data: t,
                        bubbles: !1,
                        cancelable: !1
                    };
                }, WebSocket.CONNECTING = 0, WebSocket.OPEN = 1, WebSocket.CLOSING = 2, WebSocket.CLOSED = 3, WebSocket.__flash = null, WebSocket.__instances = {}, WebSocket.__tasks = [], WebSocket.__nextId = 0, WebSocket.loadFlashPolicyFile = function (e) {
                    WebSocket.__addTask(function () {
                        WebSocket.__flash.loadManualPolicyFile(e);
                    });
                }, WebSocket.__initialize = function () {
                    if (WebSocket.__flash)
                        return;
                    WebSocket.__swfLocation && (window.WEB_SOCKET_SWF_LOCATION = WebSocket.__swfLocation);
                    if (!window.WEB_SOCKET_SWF_LOCATION) {
                        e.error('[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf');
                        return;
                    }
                    var t = document.createElement('div');
                    t.id = 'webSocketContainer', t.style.position = 'absolute', WebSocket.__isFlashLite() ? (t.style.left = '0px', t.style.top = '0px') : (t.style.left = '-100px', t.style.top = '-100px');
                    var n = document.createElement('div');
                    n.id = 'webSocketFlash', t.appendChild(n), document.body.appendChild(t), swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION, 'webSocketFlash', '1', '1', '10.0.0', null, null, {
                        hasPriority: !0,
                        swliveconnect: !0,
                        allowScriptAccess: 'always'
                    }, null, function (t) {
                        t.success || e.error('[WebSocket] swfobject.embedSWF failed');
                    });
                }, WebSocket.__onFlashInitialized = function () {
                    setTimeout(function () {
                        WebSocket.__flash = document.getElementById('webSocketFlash'), WebSocket.__flash.setCallerUrl(location.href), WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);
                        for (var e = 0; e < WebSocket.__tasks.length; ++e)
                            WebSocket.__tasks[e]();
                        WebSocket.__tasks = [];
                    }, 0);
                }, WebSocket.__onFlashEvent = function () {
                    return setTimeout(function () {
                        try {
                            var t = WebSocket.__flash.receiveEvents();
                            for (var n = 0; n < t.length; ++n)
                                WebSocket.__instances[t[n].webSocketId].__handleEvent(t[n]);
                        } catch (r) {
                            e.error(r);
                        }
                    }, 0), !0;
                }, WebSocket.__log = function (t) {
                    e.log(decodeURIComponent(t));
                }, WebSocket.__error = function (t) {
                    e.error(decodeURIComponent(t));
                }, WebSocket.__addTask = function (e) {
                    WebSocket.__flash ? e() : WebSocket.__tasks.push(e);
                }, WebSocket.__isFlashLite = function () {
                    if (!window.navigator || !window.navigator.mimeTypes)
                        return !1;
                    var e = window.navigator.mimeTypes['application/x-shockwave-flash'];
                    return !e || !e.enabledPlugin || !e.enabledPlugin.filename ? !1 : e.enabledPlugin.filename.match(/flashlite/i) ? !0 : !1;
                }, window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION || (window.addEventListener ? window.addEventListener('load', function () {
                    WebSocket.__initialize();
                }, !1) : window.attachEvent('onload', function () {
                    WebSocket.__initialize();
                }));
            }(), function (e, t, n) {
                function r(e) {
                    if (!e)
                        return;
                    t.Transport.apply(this, arguments), this.sendBuffer = [];
                }
                function i() {
                }
                e.XHR = r, t.util.inherit(r, t.Transport), r.prototype.open = function () {
                    return this.socket.setBuffer(!1), this.onOpen(), this.get(), this.setCloseTimeout(), this;
                }, r.prototype.payload = function (e) {
                    var n = [];
                    for (var r = 0, i = e.length; r < i; r++)
                        n.push(t.parser.encodePacket(e[r]));
                    this.send(t.parser.encodePayload(n));
                }, r.prototype.send = function (e) {
                    return this.post(e), this;
                }, r.prototype.post = function (e) {
                    function r() {
                        this.readyState == 4 && (this.onreadystatechange = i, t.posting = !1, this.status == 200 ? t.socket.setBuffer(!1) : t.onClose());
                    }
                    function s() {
                        this.onload = i, t.socket.setBuffer(!1);
                    }
                    var t = this;
                    this.socket.setBuffer(!0), this.sendXHR = this.request('POST'), n.XDomainRequest && this.sendXHR instanceof XDomainRequest ? this.sendXHR.onload = this.sendXHR.onerror = s : this.sendXHR.onreadystatechange = r, this.sendXHR.send(e);
                }, r.prototype.close = function () {
                    return this.onClose(), this;
                }, r.prototype.request = function (e) {
                    var n = t.util.request(this.socket.isXDomain()), r = t.util.query(this.socket.options.query, 't=' + +new Date());
                    n.open(e || 'GET', this.prepareUrl() + r, !0);
                    if (e == 'POST')
                        try {
                            n.setRequestHeader ? n.setRequestHeader('Content-type', 'text/plain;charset=UTF-8') : n.contentType = 'text/plain';
                        } catch (i) {
                        }
                    return n;
                }, r.prototype.scheme = function () {
                    return this.socket.options.secure ? 'https' : 'http';
                }, r.check = function (e, r) {
                    try {
                        var i = t.util.request(r), s = n.XDomainRequest && i instanceof XDomainRequest, o = e && e.options && e.options.secure ? 'https:' : 'http:', u = n.location && o != n.location.protocol;
                        if (i && (!s || !u))
                            return !0;
                    } catch (a) {
                    }
                    return !1;
                }, r.xdomainCheck = function (e) {
                    return r.check(e, !0);
                };
            }('undefined' != typeof io ? io.Transport : module.exports, 'undefined' != typeof io ? io : module.parent.exports, this), function (e, t) {
                function n(e) {
                    t.Transport.XHR.apply(this, arguments);
                }
                e.htmlfile = n, t.util.inherit(n, t.Transport.XHR), n.prototype.name = 'htmlfile', n.prototype.get = function () {
                    this.doc = new window[(['Active'].concat('Object').join('X'))]('htmlfile'), this.doc.open(), this.doc.write('<html></html>'), this.doc.close(), this.doc.parentWindow.s = this;
                    var e = this.doc.createElement('div');
                    e.className = 'socketio', this.doc.body.appendChild(e), this.iframe = this.doc.createElement('iframe'), e.appendChild(this.iframe);
                    var n = this, r = t.util.query(this.socket.options.query, 't=' + +new Date());
                    this.iframe.src = this.prepareUrl() + r, t.util.on(window, 'unload', function () {
                        n.destroy();
                    });
                }, n.prototype._ = function (e, t) {
                    this.onData(e);
                    try {
                        var n = t.getElementsByTagName('script')[0];
                        n.parentNode.removeChild(n);
                    } catch (r) {
                    }
                }, n.prototype.destroy = function () {
                    if (this.iframe) {
                        try {
                            this.iframe.src = 'about:blank';
                        } catch (e) {
                        }
                        this.doc = null, this.iframe.parentNode.removeChild(this.iframe), this.iframe = null, CollectGarbage();
                    }
                }, n.prototype.close = function () {
                    return this.destroy(), t.Transport.XHR.prototype.close.call(this);
                }, n.check = function (e) {
                    if (typeof window != 'undefined' && ['Active'].concat('Object').join('X') in window)
                        try {
                            var n = new window[(['Active'].concat('Object').join('X'))]('htmlfile');
                            return n && t.Transport.XHR.check(e);
                        } catch (r) {
                        }
                    return !1;
                }, n.xdomainCheck = function () {
                    return !1;
                }, t.transports.push('htmlfile');
            }('undefined' != typeof io ? io.Transport : module.exports, 'undefined' != typeof io ? io : module.parent.exports), function (e, t, n) {
                function r() {
                    t.Transport.XHR.apply(this, arguments);
                }
                function i() {
                }
                e['xhr-polling'] = r, t.util.inherit(r, t.Transport.XHR), t.util.merge(r, t.Transport.XHR), r.prototype.name = 'xhr-polling', r.prototype.heartbeats = function () {
                    return !1;
                }, r.prototype.open = function () {
                    var e = this;
                    return t.Transport.XHR.prototype.open.call(e), !1;
                }, r.prototype.get = function () {
                    function t() {
                        this.readyState == 4 && (this.onreadystatechange = i, this.status == 200 ? (e.onData(this.responseText), e.get()) : e.onClose());
                    }
                    function r() {
                        this.onload = i, this.onerror = i, e.retryCounter = 1, e.onData(this.responseText), e.get();
                    }
                    function s() {
                        e.retryCounter++, !e.retryCounter || e.retryCounter > 3 ? e.onClose() : e.get();
                    }
                    if (!this.isOpen)
                        return;
                    var e = this;
                    this.xhr = this.request(), n.XDomainRequest && this.xhr instanceof XDomainRequest ? (this.xhr.onload = r, this.xhr.onerror = s) : this.xhr.onreadystatechange = t, this.xhr.send(null);
                }, r.prototype.onClose = function () {
                    t.Transport.XHR.prototype.onClose.call(this);
                    if (this.xhr) {
                        this.xhr.onreadystatechange = this.xhr.onload = this.xhr.onerror = i;
                        try {
                            this.xhr.abort();
                        } catch (e) {
                        }
                        this.xhr = null;
                    }
                }, r.prototype.ready = function (e, n) {
                    var r = this;
                    t.util.defer(function () {
                        n.call(r);
                    });
                }, t.transports.push('xhr-polling');
            }('undefined' != typeof io ? io.Transport : module.exports, 'undefined' != typeof io ? io : module.parent.exports, this), function (e, t, n) {
                function i(e) {
                    t.Transport['xhr-polling'].apply(this, arguments), this.index = t.j.length;
                    var n = this;
                    t.j.push(function (e) {
                        n._(e);
                    });
                }
                var r = n.document && 'MozAppearance' in n.document.documentElement.style;
                e['jsonp-polling'] = i, t.util.inherit(i, t.Transport['xhr-polling']), i.prototype.name = 'jsonp-polling', i.prototype.post = function (e) {
                    function a() {
                        f(), n.socket.setBuffer(!1);
                    }
                    function f() {
                        n.iframe && n.form.removeChild(n.iframe);
                        try {
                            u = document.createElement('<iframe name="' + n.iframeId + '">');
                        } catch (e) {
                            u = document.createElement('iframe'), u.name = n.iframeId;
                        }
                        u.id = n.iframeId, n.form.appendChild(u), n.iframe = u;
                    }
                    var n = this, r = t.util.query(this.socket.options.query, 't=' + +new Date() + '&i=' + this.index);
                    if (!this.form) {
                        var i = document.createElement('form'), s = document.createElement('textarea'), o = this.iframeId = 'socketio_iframe_' + this.index, u;
                        i.className = 'socketio', i.style.position = 'absolute', i.style.top = '0px', i.style.left = '0px', i.style.display = 'none', i.target = o, i.method = 'POST', i.setAttribute('accept-charset', 'utf-8'), s.name = 'd', i.appendChild(s), document.body.appendChild(i), this.form = i, this.area = s;
                    }
                    this.form.action = this.prepareUrl() + r, f(), this.area.value = t.JSON.stringify(e);
                    try {
                        this.form.submit();
                    } catch (l) {
                    }
                    this.iframe.attachEvent ? u.onreadystatechange = function () {
                        n.iframe.readyState == 'complete' && a();
                    } : this.iframe.onload = a, this.socket.setBuffer(!0);
                }, i.prototype.get = function () {
                    var e = this, n = document.createElement('script'), i = t.util.query(this.socket.options.query, 't=' + +new Date() + '&i=' + this.index);
                    this.script && (this.script.parentNode.removeChild(this.script), this.script = null), n.async = !0, n.src = this.prepareUrl() + i, n.onerror = function () {
                        e.onClose();
                    };
                    var s = document.getElementsByTagName('script')[0];
                    s.parentNode.insertBefore(n, s), this.script = n, r && setTimeout(function () {
                        var e = document.createElement('iframe');
                        document.body.appendChild(e), document.body.removeChild(e);
                    }, 100);
                }, i.prototype._ = function (e) {
                    return this.onData(e), this.isOpen && this.get(), this;
                }, i.prototype.ready = function (e, n) {
                    var i = this;
                    if (!r)
                        return n.call(this);
                    t.util.load(function () {
                        n.call(i);
                    });
                }, i.check = function () {
                    return 'document' in n;
                }, i.xdomainCheck = function () {
                    return !0;
                }, t.transports.push('jsonp-polling');
            }('undefined' != typeof io ? io.Transport : module.exports, 'undefined' != typeof io ? io : module.parent.exports, this), typeof define == 'function' && define.amd && define('appenders/../../deps/socket.io.client.js', [], function () {
                return io;
            }));
        }(), define('appenders/socketappender', [
            'require',
            '../appender',
            '../../deps/socket.io.client.js'
        ], function (e) {
            var t = e('../appender'), n = e('../../deps/socket.io.client.js'), r = function (e) {
                    e = e || {}, t.call(this, e), this.appendStrings = typeof e.appendStrings != 'undefined' ? e.appendStrings : !0, this.url = e.url || 'http://localhost', this.socket = null;
                };
            return r.prototype = new t(), r.prototype.start = function (e) {
                e = e || function () {
                };
                var t = this;
                if (this.isStarted())
                    return e();
                this.socket = n.connect(this.url, {
                    'connect timeout': 5000,
                    'max reconnection attempts': 5,
                    'try multiple transports': !0,
                    reconnect: !0
                }), this.socket.on('connect', function () {
                    return t.started = !0, e();
                }), this.socket.once('connect_failed', function () {
                    return e('No way to establish a socket connection to "' + t.url + '". Ensure the socket server is up and running.');
                });
            }, r.prototype.stop = function (e) {
                e = e || function () {
                };
                var t = this;
                if (!this.isStarted())
                    return e();
                if (!this.socket || !this.socket.connected)
                    return this.started = !1, e();
                this.socket.once('disconnect', function () {
                    return t.started = !1, t.socket = null, e();
                }), this.socket.disconnect();
            }, r.prototype.doAppend = function (e) {
                var t = this.getLayout(), n = e.getLevel(), r = null;
                this.appendStrings ? (r = t.toMessageString(e), this.doAppendMessage(n, r)) : (e = t.toLogEvent(e), this.doAppendMessage(n, e));
            }, r.prototype.doAppendMessage = function (e, t) {
                if (typeof console == 'undefined')
                    return;
                this.socket.emit('log', {
                    level: e,
                    message: t
                });
            }, r;
        }), define('appenders/nodejs/fileappender', [
            'require',
            '../../appender'
        ], function (e) {
            var t = e('../../appender'), n = e, r = null;
            try {
                typeof global != 'undefined' && global.process && global.process.versions && global.process.versions.node && typeof rootRequire == 'function' ? r = rootRequire('fs') : r = n('fs');
            } catch (i) {
            }
            var s = function (e) {
                e = e || {}, t.call(this, e), this.fileName = e.fileName, this.appendToFile = typeof e.append != 'undefined' ? !!e.append : !0, this.appendStrings = typeof e.appendStrings != 'undefined' ? e.appendStrings : !0, this.stream = null;
            };
            return s.prototype = new t(), s.prototype.doAppend = function (e) {
                var t = this.getLayout(), n = null;
                this.appendStrings ? n = t.toMessageString(e) : (e = t.toLogEvent(e), t.compactObjects || t.compact ? n = JSON.stringify(e) : n = JSON.stringify(e, null, 2)), process.platform === 'win32' && (n = n.replace(/\n/g, '\r\n')), this.stream.write(n);
            }, s.prototype.start = function (e) {
                return e = e || function () {
                }, this.isStarted() ? e() : r ? (this.stream = r.createWriteStream(this.fileName, {
                    flags: this.appendToFile ? 'a' : 'w',
                    encoding: 'utf8'
                }), this.started = !0, e()) : e('The File Appender only runs in a Node.js runtime environment');
            }, s.prototype.stop = function (e) {
                e = e || function () {
                };
                var t = this;
                if (!this.isStarted())
                    return e();
                if (!this.stream)
                    return this.started = !1, e();
                this.stream.end(function () {
                    return t.started = !1, t.stream = null, e();
                });
            }, s;
        }), define('appenders/nodejs/rollingfileappender', [
            'require',
            '../../appender'
        ], function (e) {
            var t = e('../../appender'), n = e, r = null;
            try {
                typeof global != 'undefined' && global.process && global.process.versions && global.process.versions.node && typeof rootRequire == 'function' ? r = rootRequire('fs') : r = n('fs');
            } catch (i) {
            }
            var s = function (e) {
                e = e || {}, t.call(this, e), this.fileName = e.fileName, this.triggeringPolicy = e.triggeringPolicy, this.appendStrings = typeof e.appendStrings != 'undefined' ? e.appendStrings : !0, this.stream = null;
            };
            return s.prototype = new t(), s.prototype.needsRolling = function () {
                if (this.triggeringPolicy) {
                    if (this.triggeringPolicy.size && this.currentLogSize > this.triggeringPolicy.size)
                        return !0;
                    if (this.triggeringPolicy.time && this.currentLogDate && Date.now() - this.currentLogDate > 1000 * this.triggeringPolicy.time)
                        return !0;
                }
                return !1;
            }, s.prototype.genFileName = function () {
                var e = function (e, t, n) {
                        return n = n || '0', e += '', e.length >= t ? e : new Array(t - e.length + 1).join(n) + e;
                    }, t = function (t) {
                        return e(t, 2);
                    }, n = new Date(), r = '' + n.getFullYear() + '-' + t(n.getMonth() + 1) + '-' + t(n.getDate()) + '-' + t(n.getHours()) + 'h' + t(n.getMinutes());
                !this.currentTimestamp || r !== this.currentTimestamp ? (this.currentTimeStampIdx = 0, this.currentTimestamp = r) : this.currentTimeStampIdx++;
                var i = this.currentTimestamp + '_' + t(this.currentTimeStampIdx) + '_' + this.fileName;
                return i;
            }, s.prototype.createNewlog = function () {
                this.stream && this.stream.end(), this.stream = r.createWriteStream(this.genFileName(), {
                    flags: 'w',
                    encoding: 'utf8'
                }), this.currentLogSize = 0, this.currentLogDate = new Date();
            }, s.prototype.doAppend = function (e) {
                var t = this.getLayout(), n = null;
                this.needsRolling() && this.createNewlog(), this.appendStrings ? n = t.toMessageString(e) : (e = t.toLogEvent(e), t.compactObjects || t.compact ? n = JSON.stringify(e) : n = JSON.stringify(e, null, 2)), process.platform === 'win32' && (n = n.replace(/\n/g, '\r\n')), this.currentLogSize += Buffer.byteLength(n, 'utf8'), this.stream.write(n);
            }, s.prototype.start = function (e) {
                return e = e || function () {
                }, this.isStarted() ? e() : r ? (this.createNewlog(), this.started = !0, e()) : e('The File Appender only runs in a Node.js runtime environment');
            }, s.prototype.stop = function (e) {
                e = e || function () {
                };
                var t = this;
                if (!this.isStarted())
                    return e();
                if (!this.stream)
                    return this.started = !1, e();
                this.stream.end(function () {
                    return t.started = !1, t.stream = null, e();
                });
            }, s;
        }), define('filters/regexfilter', [
            'require',
            '../filter',
            '../utils'
        ], function (e) {
            var t = e('../filter'), n = e('../utils'), r = function (e) {
                    t.call(this), e = e || {}, this.regex = e.regex || '', n.isString(this.regex) && (this.regex = new RegExp(this.regex)), this.useRawMsg = !!e.useRawMsg, this.onMatch = e.match || e.onMatch || 'neutral', this.onMismatch = e.mismatch || e.onMismatch || 'deny';
                };
            return r.prototype = new t(), r.prototype.filter = function (e) {
                var t = '';
                return this.useRawMsg ? t = e.getMessage().getFormat() : t = e.getMessage().getFormattedMessage(), this.regex.test(t) ? this.onMatch : this.onMismatch;
            }, r;
        }), define('filters/regexloggernamefilter', [
            'require',
            '../filter',
            '../utils'
        ], function (e) {
            var t = e('../filter'), n = e('../utils'), r = function (e) {
                    t.call(this), e = e || {}, this.regex = e.regex || '', n.isString(this.regex) && (this.regex = new RegExp(this.regex)), this.onMatch = e.match || e.onMatch || 'neutral', this.onMismatch = e.mismatch || e.onMismatch || 'deny';
                };
            return r.prototype = new t(), r.prototype.filter = function (e) {
                var t = e.getLoggerName();
                return this.regex.test(t) ? this.onMatch : this.onMismatch;
            }, r;
        }), define('layout', [], function () {
            var e = function (e, t) {
                this.config = e || {}, this.loggerContext = t;
            };
            return e.prototype.toLogEvent = function (e) {
                return e;
            }, e.prototype.toMessageString = function (e) {
                return this.toMessageBits(e).join(' ');
            }, e.prototype.toMessageBits = function (e, t) {
                var n = e.getMessage();
                return [
                    e.getMillis(),
                    e.getLevel(),
                    e.getLoggerName()
                ].concat(n.getFormattedParams(t));
            }, e;
        }), define('layouts/jsonlayout', [
            'require',
            '../layout',
            './simpleobjectserializer'
        ], function (e) {
            var t = e('../layout'), n = e('./simpleobjectserializer'), r = function (e, n) {
                    e = e || {}, t.call(this, e, n), this.compact = e.compact || !1, this.depth = e.depth || 2, this.messageAsObject = e.messageAsObject || !1;
                };
            return r.prototype = new t(), r.prototype.toMessageBits = function (e) {
                var t = e.getMessage(), r = this.messageAsObject ? this.depth + 1 : 2;
                t ? this.messageAsObject ? t = JSON.parse(n(t, this.depth, !0)) : t = t.getFormattedMessage() : t = '';
                var i = {
                    time: e.getMillis(),
                    loggerName: e.getLoggerName(),
                    level: e.getLevel(),
                    message: t
                };
                return [n(i, r, this.compact)];
            }, r;
        }), define('layouts/simpledateformat', [], function () {
            var e = /('[^']*')|(G+|y+|M+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/g, t = [
                    'January',
                    'February',
                    'March',
                    'April',
                    'May',
                    'June',
                    'July',
                    'August',
                    'September',
                    'October',
                    'November',
                    'December'
                ], n = [
                    'Sunday',
                    'Monday',
                    'Tuesday',
                    'Wednesday',
                    'Thursday',
                    'Friday',
                    'Saturday'
                ], r = 0, i = 1, s = 2, o = 3, u = 4, a = 5, f = {
                    G: r,
                    y: o,
                    M: u,
                    w: s,
                    W: s,
                    D: s,
                    d: s,
                    F: s,
                    E: i,
                    a: r,
                    H: s,
                    k: s,
                    K: s,
                    h: s,
                    m: s,
                    s: s,
                    S: s,
                    Z: a
                }, l = function (e, t) {
                    while (e.length < t)
                        e = '0' + e;
                    return e;
                }, c = function (e, t, n) {
                    return t >= 4 ? e : e.substr(0, Math.max(n, t));
                }, h = function (e, t) {
                    var n = '' + e;
                    return l(n, t);
                }, p = function (e) {
                    this.formatString = e;
                };
            return p.prototype.format = function (p) {
                var d = '', v, m = this.formatString;
                while (v = e.exec(m)) {
                    var g = v[1], y = v[2], b = v[3], w = v[4];
                    if (g)
                        g === '\'\'' ? d += '\'' : d += g.substring(1, g.length - 1);
                    else if (!b)
                        if (w)
                            d += w;
                        else if (y) {
                            var E = y.charAt(0), S = y.length, x = '';
                            switch (E) {
                            case 'G':
                                x = 'AD';
                                break;
                            case 'y':
                                x = p.getFullYear();
                                break;
                            case 'M':
                                x = p.getMonth();
                                break;
                            case 'd':
                                x = p.getDate();
                                break;
                            case 'F':
                                x = 1 + Math.floor((p.getDate() - 1) / 7);
                                break;
                            case 'E':
                                x = n[p.getDay()];
                                break;
                            case 'a':
                                x = p.getHours() >= 12 ? 'PM' : 'AM';
                                break;
                            case 'H':
                                x = p.getHours();
                                break;
                            case 'k':
                                x = p.getHours() || 24;
                                break;
                            case 'K':
                                x = p.getHours() % 12;
                                break;
                            case 'h':
                                x = p.getHours() % 12 || 12;
                                break;
                            case 'm':
                                x = p.getMinutes();
                                break;
                            case 's':
                                x = p.getSeconds();
                                break;
                            case 'S':
                                x = p.getMilliseconds();
                                break;
                            case 'Z':
                                x = p.getTimezoneOffset();
                            }
                            switch (f[E]) {
                            case r:
                                d += c(x, S, 2);
                                break;
                            case i:
                                d += c(x, S, 3);
                                break;
                            case s:
                                d += h(x, S);
                                break;
                            case o:
                                if (S <= 3) {
                                    var T = '' + x;
                                    d += T.substr(2, 2);
                                } else
                                    d += h(x, S);
                                break;
                            case u:
                                S >= 3 ? d += c(t[x], S, S) : d += h(x + 1, S);
                                break;
                            case a:
                                var N = x > 0, C = N ? '-' : '+', k = Math.abs(x), L = '' + Math.floor(k / 60);
                                L = l(L, 2);
                                var A = '' + k % 60;
                                A = l(A, 2), d += C + L + A;
                            }
                        }
                }
                return d;
            }, p;
        }), define('layouts/patternlayout', [
            'require',
            '../utils',
            '../layout',
            './simpledateformat'
        ], function (e) {
            var t = e('../utils'), n = e('../layout'), r = e('./simpledateformat'), i = {
                    absolute: 'HH:mm:ss,SSS',
                    compact: 'yyyyMMddHHmmssSSS',
                    date: 'dd MMM yyyy HH:mm:ss,SSS',
                    iso8601: 'yyyy-MM-dd HH:mm:ss,SSS',
                    iso8601_basic: 'yyyy-MM-DD HHmmss,SSS'
                }, s = {
                    trace: 37,
                    log: 30,
                    info: 36,
                    warn: 33,
                    error: 31
                }, o = function (e, t) {
                    n.call(this, e, t), this.pattern = this.config.pattern || o.DEFAULT_CONVERSION_PATTERN, this.compactObjects = this.config.compactObjects || !1;
                };
            return o.prototype = new n(), o.DEFAULT_CONVERSION_PATTERN = '%m%n', o.TTCC_CONVERSION_PATTERN = '%r %p %c - %m%n', o.SIMPLE_CONVERSION_PATTERN = '%d %p %c - %m%n', o.prototype.toMessageBits = function (e, t) {
                return this.formatLogEvent(e, this.pattern, t);
            }, o.prototype.formatLogEvent = function (e, n, o) {
                var u = [], a = '', f = [], l = {
                        matched: '',
                        padding: '',
                        truncation: '',
                        pattern: '',
                        params: '',
                        text: ''
                    }, c = '', h = 0, p = [], d = '', v = 0, m = 0, g = '', y = null;
                o = o || {};
                var b = /%(-?[0-9]+)?(\.?[0-9]+)?(logger|date|domain|highlight|message|level|relative|[cdhmnpr%])(?:\{([^\}]+)\})?|([^%]+)/g;
                while (f = b.exec(n)) {
                    l.matched = f[0], l.padding = f[1], l.truncation = f[2], l.pattern = f[3], l.params = f[4], l.text = f[5], d = '';
                    if (l.text) {
                        a += l.text;
                        continue;
                    }
                    switch (l.pattern) {
                    case 'logger':
                    case 'c':
                        c = e.getLoggerName(), l.params ? (h = parseInt(l.params, 10), p = c.split('.'), h >= p.length ? d = c : d = p.slice(p.length - h).join('.')) : d = c;
                        break;
                    case 'date':
                    case 'd':
                        g = l.params || 'ISO8601', g === 'ISO8601' ? g = i.iso8601 : g === 'ABSOLUTE' ? g = i.absolute : g === 'COMPACT' ? g = i.compact : g === 'DATE' ? g = i.date : g === 'ISO8601_BASIC' && (g = i.iso8601_basic), y = new Date(e.getMillis()), d = new r(g).format(y);
                        break;
                    case 'domain':
                        c = l.params || 'id';
                        if (typeof process != 'undefined')
                            if (process.domain) {
                                c = c.split('.'), d = process.domain;
                                while (d && c.length > 0)
                                    d = d[c.shift()];
                                d = d || 'anonymous';
                            } else
                                d = 'global';
                        else
                            d = 'unknown';
                        t.isFunction(d) && (d = d());
                        break;
                    case 'highlight':
                    case 'h':
                        c = l.params || '', d = '\x1B[' + (s[e.getLevel()] || 0) + 'm' + this.formatLogEvent(e, c) + '\x1B[0m';
                        break;
                    case 'message':
                    case 'm':
                        o.preserveObjects ? d = e.getMessage().getFormattedParams({
                            separator: l.params,
                            compactObjects: this.compactObjects,
                            preserveObjects: !0
                        }) : d = e.getMessage().getFormattedMessage({
                            separator: l.params,
                            compactObjects: this.compactObjects
                        });
                        break;
                    case 'n':
                        d = '\n';
                        break;
                    case 'level':
                    case 'p':
                        d = e.getLevel();
                        break;
                    case 'relative':
                    case 'r':
                        h = e.getMillis() - this.loggerContext.getStartTime(), d = '' + h;
                        break;
                    case '%':
                        d = '%';
                        break;
                    default:
                        d = l.matched;
                    }
                    if (t.isArray(d))
                        a && (t.isString(d[0]) && (a += d[0], d = d.slice(1)), u.push(a), a = ''), d.length > 0 && (u = u.concat(d));
                    else {
                        l.truncation && (h = parseInt(l.truncation.substr(1), 10), m = d.length, h < m && (d = d.substring(m - h, m)));
                        if (l.padding)
                            if (l.padding.charAt(0) === '-') {
                                m = parseInt(l.padding.substr(1), 10);
                                for (v = d.length; v < m; v++)
                                    d += ' ';
                            } else {
                                m = parseInt(l.padding, 10), c = '';
                                for (v = d.length; v < m; v++)
                                    c += ' ';
                                d = c + d;
                            }
                        a += d;
                    }
                }
                return a && u.push(a), u;
            }, o;
        }), define('woodman', [
            'require',
            './logmanager',
            './appenders/consoleappender',
            './appenders/socketappender',
            './appenders/nodejs/fileappender',
            './appenders/nodejs/rollingfileappender',
            './filters/regexfilter',
            './filters/regexloggernamefilter',
            './layout',
            './layouts/jsonlayout',
            './layouts/patternlayout'
        ], function (e) {
            var t = e('./logmanager'), n = e('./appenders/consoleappender'), r = e('./appenders/socketappender'), i = e('./appenders/nodejs/fileappender'), s = e('./appenders/nodejs/rollingfileappender'), o = e('./filters/regexfilter'), u = e('./filters/regexloggernamefilter'), a = e('./layout'), f = e('./layouts/jsonlayout'), l = e('./layouts/patternlayout');
            return t.registerAppender('console', n), t.registerAppender('Console', n), t.registerAppender('ConsoleAppender', n), t.registerAppender('file', i), t.registerAppender('File', i), t.registerAppender('FileAppender', i), t.registerAppender('rollingfile', s), t.registerAppender('RollingFile', s), t.registerAppender('RollingFileAppender', s), t.registerAppender('socket', r), t.registerAppender('Socket', r), t.registerAppender('SocketAppender', r), t.registerFilter('regex', o), t.registerFilter('RegexFilter', o), t.registerFilter('regexloggername', u), t.registerFilter('RegexLoggerNameFilter', u), t.registerLayout('default', a), t.registerLayout('json', f), t.registerLayout('JSONLayout', f), t.registerLayout('pattern', l), t.registerLayout('PatternLayout', l), t.registerStandardLevels(), t;
        }));
        var woodman = null;
        return require(['./woodman'], function (e) {
            woodman = e;
        }, null, !0), woodman;
    }();
}(typeof require == 'function' ? require : null));
loggerCfg = {
    loggers: [{
            root: true,
            level: 'all',
            appenders: [{
                    type: 'Console',
                    layout: {
                        type: 'PatternLayout',
                        pattern: '%d{yyyy-MM-dd HH:mm:ss} [%p] %c - %m%n'
                    }
                }]
        }]
};
UtilsLoggerByDefault = function (Log4js, Config) {
    var LoggerByDefault = {
        getLogger: function (name) {
            Log4js.load(Config, function (error) {
                if (error) {
                    throw error;
                }
            });
            return Log4js.getLogger(name || 'default');
        }
    };
    return LoggerByDefault;
}(log4js, loggerCfg);
UtilsLoader = function () {
    var Loader = {
        loadEngine: function (src, callbackSuccess, callbackError, scope) {
            if (!scope) {
                scope = this;
            }
            var env = typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : this;
            if (document.getElementById('engine-itowns')) {
                callbackSuccess.call(scope, env.itowns || {});
                return;
            }
            var scriptEngine = document.createElement('script');
            scriptEngine.id = 'engine-itowns';
            scriptEngine.src = src;
            scriptEngine.async = 'async';
            if (callbackSuccess !== null) {
                if (scriptEngine.readyState) {
                    scriptEngine.onreadystatechange = function () {
                        if (scriptEngine.readyState == 'loaded' || scriptEngine.readyState == 'complete') {
                            scriptEngine.onreadystatechange = null;
                            callbackSuccess.call(scope, env.itowns || {});
                        }
                    };
                } else {
                    scriptEngine.onload = function () {
                        callbackSuccess.call(scope, env.itowns || {});
                    };
                    if (callbackError !== null) {
                        scriptEngine.onerror = function (e) {
                            callbackError.call(scope, e);
                        };
                    }
                }
            }
            var script = document.getElementsByTagName('script')[0];
            script.parentNode.insertBefore(scriptEngine, script);
        },
        getCurrentPath: function () {
            var path = document.currentScript ? document.currentScript.src : function () {
                var e = document.getElementsByTagName('script');
                return e[e.length - 1].src;
            }();
            path = path.substr(0, path.lastIndexOf('/') + 1);
            return path;
        },
        getPath: function (scriptName) {
            var path = '';
            var scripts = document.getElementsByTagName('script');
            for (var i = 0; i < scripts.length; ++i) {
                var src = scripts[i].getAttribute('src');
                if (src.indexOf(scriptName) !== -1) {
                    var url = document.createElement('a');
                    url.href = src;
                    path = url.origin + url.pathname.substring(0, url.pathname.lastIndexOf('/') + 1);
                    break;
                }
            }
            return path;
        },
        getEnginePath: function (path) {
            var _path = '';
            if (path) {
                var sep = '';
                if (path.lastIndexOf('/') === path.length - 1) {
                    sep = '/';
                }
                _path = path + sep + 'itowns.js';
            } else {
                _path = this.getCurrentPath() + 'itowns.js';
            }
            return _path;
        }
    };
    return Loader;
}();
(function (root, factory) {
    if (typeof exports === 'object') {
        module.exports = factory();
    } else if (typeof define === 'function' && define.amd) {
        define('ol', [], factory);
    } else {
        root.ol = factory();
    }
}(this, function () {
    var OPENLAYERS = {};
    var k, aa = this;
    function t(a, b) {
        var c = OPENLAYERS;
        a = a.split('.');
        c = c || aa;
        a[0] in c || !c.execScript || c.execScript('var ' + a[0]);
        for (var d; a.length && (d = a.shift());)
            a.length || void 0 === b ? c[d] && c[d] !== Object.prototype[d] ? c = c[d] : c = c[d] = {} : c[d] = b;
    }
    var ba, da;
    function w(a, b) {
        a.prototype = Object.create(b.prototype);
        a.prototype.constructor = a;
    }
    function ea() {
    }
    function x(a) {
        return a.xp || (a.xp = ++fa);
    }
    var fa = 0;
    function ha(a) {
        this.message = 'Assertion failed. See https://openlayers.org/en/v4.6.5/doc/errors/#' + a + ' for details.';
        this.code = a;
        this.name = 'AssertionError';
    }
    w(ha, Error);
    function ja(a, b, c, d) {
        this.fa = a;
        this.la = b;
        this.ea = c;
        this.ka = d;
    }
    function ka(a, b, c, d, e) {
        return void 0 !== e ? (e.fa = a, e.la = b, e.ea = c, e.ka = d, e) : new ja(a, b, c, d);
    }
    function ma(a, b, c) {
        return a.fa <= b && b <= a.la && a.ea <= c && c <= a.ka;
    }
    function na(a, b) {
        return a.fa == b.fa && a.ea == b.ea && a.la == b.la && a.ka == b.ka;
    }
    function oa(a, b) {
        if (!a)
            throw new ha(b);
    }
    function pa(a, b, c) {
        return Math.min(Math.max(a, b), c);
    }
    var qa = function () {
        var a;
        'cosh' in Math ? a = Math.cosh : a = function (a) {
            a = Math.exp(a);
            return (a + 1 / a) / 2;
        };
        return a;
    }();
    function ra(a) {
        oa(0 < a, 29);
        return Math.pow(2, Math.ceil(Math.log(a) / Math.LN2));
    }
    function sa(a, b, c, d, e, f) {
        var g = e - c, h = f - d;
        if (0 !== g || 0 !== h) {
            var l = ((a - c) * g + (b - d) * h) / (g * g + h * h);
            1 < l ? (c = e, d = f) : 0 < l && (c += g * l, d += h * l);
        }
        return ua(a, b, c, d);
    }
    function ua(a, b, c, d) {
        a = c - a;
        b = d - b;
        return a * a + b * b;
    }
    function va(a) {
        return a * Math.PI / 180;
    }
    function wa(a, b) {
        a %= b;
        return 0 > a * b ? a + b : a;
    }
    function ya(a, b, c) {
        return a + c * (b - a);
    }
    function za(a, b, c) {
        void 0 === c && (c = [
            0,
            0
        ]);
        c[0] = a[0] + 2 * b;
        c[1] = a[1] + 2 * b;
        return c;
    }
    function Aa(a, b, c) {
        void 0 === c && (c = [
            0,
            0
        ]);
        c[0] = a[0] * b + 0.5 | 0;
        c[1] = a[1] * b + 0.5 | 0;
        return c;
    }
    function Ba(a, b) {
        if (Array.isArray(a))
            return a;
        void 0 === b ? b = [
            a,
            a
        ] : b[0] = b[1] = a;
        return b;
    }
    function Ca(a) {
        for (var b = Da(), c = 0, d = a.length; c < d; ++c)
            Ea(b, a[c]);
        return b;
    }
    function Fa(a, b, c) {
        return c ? (c[0] = a[0] - b, c[1] = a[1] - b, c[2] = a[2] + b, c[3] = a[3] + b, c) : [
            a[0] - b,
            a[1] - b,
            a[2] + b,
            a[3] + b
        ];
    }
    function Ga(a, b) {
        return b ? (b[0] = a[0], b[1] = a[1], b[2] = a[2], b[3] = a[3], b) : a.slice();
    }
    function Ha(a, b, c) {
        b = b < a[0] ? a[0] - b : a[2] < b ? b - a[2] : 0;
        a = c < a[1] ? a[1] - c : a[3] < c ? c - a[3] : 0;
        return b * b + a * a;
    }
    function Ja(a, b) {
        return Ka(a, b[0], b[1]);
    }
    function La(a, b) {
        return a[0] <= b[0] && b[2] <= a[2] && a[1] <= b[1] && b[3] <= a[3];
    }
    function Ka(a, b, c) {
        return a[0] <= b && b <= a[2] && a[1] <= c && c <= a[3];
    }
    function Ma(a, b) {
        var c = a[1], d = a[2], e = a[3], f = b[0];
        b = b[1];
        var g = 0;
        f < a[0] ? g |= 16 : f > d && (g |= 4);
        b < c ? g |= 8 : b > e && (g |= 2);
        0 === g && (g = 1);
        return g;
    }
    function Da() {
        return [
            Infinity,
            Infinity,
            -Infinity,
            -Infinity
        ];
    }
    function Na(a, b, c, d, e) {
        return e ? (e[0] = a, e[1] = b, e[2] = c, e[3] = d, e) : [
            a,
            b,
            c,
            d
        ];
    }
    function Oa(a) {
        return Na(Infinity, Infinity, -Infinity, -Infinity, a);
    }
    function Pa(a, b) {
        var c = a[0];
        a = a[1];
        return Na(c, a, c, a, b);
    }
    function Qa(a, b, c, d, e) {
        e = Oa(e);
        return Ra(e, a, b, c, d);
    }
    function Sa(a, b) {
        return a[0] == b[0] && a[2] == b[2] && a[1] == b[1] && a[3] == b[3];
    }
    function Ta(a, b) {
        b[0] < a[0] && (a[0] = b[0]);
        b[2] > a[2] && (a[2] = b[2]);
        b[1] < a[1] && (a[1] = b[1]);
        b[3] > a[3] && (a[3] = b[3]);
        return a;
    }
    function Ea(a, b) {
        b[0] < a[0] && (a[0] = b[0]);
        b[0] > a[2] && (a[2] = b[0]);
        b[1] < a[1] && (a[1] = b[1]);
        b[1] > a[3] && (a[3] = b[1]);
    }
    function Ra(a, b, c, d, e) {
        for (; c < d; c += e) {
            var f = a, g = b[c], h = b[c + 1];
            f[0] = Math.min(f[0], g);
            f[1] = Math.min(f[1], h);
            f[2] = Math.max(f[2], g);
            f[3] = Math.max(f[3], h);
        }
        return a;
    }
    function Ua(a, b, c) {
        var d;
        return (d = b.call(c, Wa(a))) || (d = b.call(c, Ya(a))) || (d = b.call(c, Za(a))) ? d : (d = b.call(c, $a(a))) ? d : !1;
    }
    function ab(a) {
        var b = 0;
        bb(a) || (b = cb(a) * db(a));
        return b;
    }
    function Wa(a) {
        return [
            a[0],
            a[1]
        ];
    }
    function Ya(a) {
        return [
            a[2],
            a[1]
        ];
    }
    function eb(a) {
        return [
            (a[0] + a[2]) / 2,
            (a[1] + a[3]) / 2
        ];
    }
    function fb(a, b, c, d, e) {
        var f = b * d[0] / 2;
        d = b * d[1] / 2;
        b = Math.cos(c);
        var g = Math.sin(c);
        c = f * b;
        f *= g;
        b *= d;
        var h = d * g, l = a[0], m = a[1];
        a = l - c + h;
        d = l - c - h;
        g = l + c - h;
        c = l + c + h;
        h = m - f - b;
        l = m - f + b;
        var n = m + f + b;
        f = m + f - b;
        return Na(Math.min(a, d, g, c), Math.min(h, l, n, f), Math.max(a, d, g, c), Math.max(h, l, n, f), e);
    }
    function db(a) {
        return a[3] - a[1];
    }
    function gb(a, b, c) {
        c = c ? c : Da();
        hb(a, b) && (c[0] = a[0] > b[0] ? a[0] : b[0], c[1] = a[1] > b[1] ? a[1] : b[1], c[2] = a[2] < b[2] ? a[2] : b[2], c[3] = a[3] < b[3] ? a[3] : b[3]);
        return c;
    }
    function $a(a) {
        return [
            a[0],
            a[3]
        ];
    }
    function Za(a) {
        return [
            a[2],
            a[3]
        ];
    }
    function cb(a) {
        return a[2] - a[0];
    }
    function hb(a, b) {
        return a[0] <= b[2] && a[2] >= b[0] && a[1] <= b[3] && a[3] >= b[1];
    }
    function bb(a) {
        return a[2] < a[0] || a[3] < a[1];
    }
    function ib(a, b) {
        var c = (a[2] - a[0]) / 2 * (b - 1);
        b = (a[3] - a[1]) / 2 * (b - 1);
        a[0] -= c;
        a[2] += c;
        a[1] -= b;
        a[3] += b;
    }
    function jb(a, b, c) {
        a = [
            a[0],
            a[1],
            a[0],
            a[3],
            a[2],
            a[1],
            a[2],
            a[3]
        ];
        b(a, a, 2);
        var d = [
                a[0],
                a[2],
                a[4],
                a[6]
            ], e = [
                a[1],
                a[3],
                a[5],
                a[7]
            ];
        b = Math.min.apply(null, d);
        a = Math.min.apply(null, e);
        d = Math.max.apply(null, d);
        e = Math.max.apply(null, e);
        return Na(b, a, d, e, c);
    }
    var kb = 'function' === typeof Object.assign ? Object.assign : function (a, b) {
        if (void 0 === a || null === a)
            throw new TypeError('Cannot convert undefined or null to object');
        for (var c = Object(a), d = 1, e = arguments.length; d < e; ++d) {
            var f = arguments[d];
            if (void 0 !== f && null !== f)
                for (var g in f)
                    f.hasOwnProperty(g) && (c[g] = f[g]);
        }
        return c;
    };
    function lb(a) {
        for (var b in a)
            delete a[b];
    }
    function mb(a) {
        var b = [], c;
        for (c in a)
            b.push(a[c]);
        return b;
    }
    function nb(a) {
        for (var b in a)
            return !1;
        return !b;
    }
    function ob(a) {
        this.radius = a;
    }
    ob.prototype.a = function (a) {
        return pb(a, this.radius);
    };
    ob.prototype.b = function (a, b) {
        return qb(a, b, this.radius);
    };
    ob.prototype.offset = function (a, b, c) {
        var d = va(a[1]);
        b /= this.radius;
        var e = Math.asin(Math.sin(d) * Math.cos(b) + Math.cos(d) * Math.sin(b) * Math.cos(c));
        return [
            180 * (va(a[0]) + Math.atan2(Math.sin(c) * Math.sin(b) * Math.cos(d), Math.cos(b) - Math.sin(d) * Math.sin(e))) / Math.PI,
            180 * e / Math.PI
        ];
    };
    function rb(a, b) {
        var c = b || {}, d = c.radius || 6371008.8;
        c = c.projection || 'EPSG:3857';
        a = a.clone().mb(c, 'EPSG:4326');
        var e = a.S();
        c = 0;
        var f;
        switch (e) {
        case 'Point':
        case 'MultiPoint':
            break;
        case 'LineString':
        case 'LinearRing':
            b = a.W();
            c = sb(b, d);
            break;
        case 'MultiLineString':
        case 'Polygon':
            b = a.W();
            a = 0;
            for (e = b.length; a < e; ++a)
                c += sb(b[a], d);
            break;
        case 'MultiPolygon':
            b = a.W();
            a = 0;
            for (e = b.length; a < e; ++a) {
                var g = b[a];
                var h = 0;
                for (f = g.length; h < f; ++h)
                    c += sb(g[h], d);
            }
            break;
        case 'GeometryCollection':
            d = a.vd();
            a = 0;
            for (e = d.length; a < e; ++a)
                c += rb(d[a], b);
            break;
        default:
            throw Error('Unsupported geometry type: ' + e);
        }
        return c;
    }
    function sb(a, b) {
        for (var c = 0, d = 0, e = a.length; d < e - 1; ++d)
            c += qb(a[d], a[d + 1], b);
        return c;
    }
    function qb(a, b, c) {
        var d = va(a[1]), e = va(b[1]), f = (e - d) / 2;
        a = va(b[0] - a[0]) / 2;
        d = Math.sin(f) * Math.sin(f) + Math.sin(a) * Math.sin(a) * Math.cos(d) * Math.cos(e);
        return 2 * c * Math.atan2(Math.sqrt(d), Math.sqrt(1 - d));
    }
    function tb(a, b) {
        var c = b || {}, d = c.radius || 6371008.8;
        c = c.projection || 'EPSG:3857';
        a = a.clone().mb(c, 'EPSG:4326');
        var e = a.S();
        c = 0;
        var f;
        switch (e) {
        case 'Point':
        case 'MultiPoint':
        case 'LineString':
        case 'MultiLineString':
        case 'LinearRing':
            break;
        case 'Polygon':
            b = a.W();
            c = Math.abs(pb(b[0], d));
            a = 1;
            for (e = b.length; a < e; ++a)
                c -= Math.abs(pb(b[a], d));
            break;
        case 'MultiPolygon':
            b = a.W();
            a = 0;
            for (e = b.length; a < e; ++a) {
                var g = b[a];
                c += Math.abs(pb(g[0], d));
                var h = 1;
                for (f = g.length; h < f; ++h)
                    c -= Math.abs(pb(g[h], d));
            }
            break;
        case 'GeometryCollection':
            d = a.vd();
            a = 0;
            for (e = d.length; a < e; ++a)
                c += tb(d[a], b);
            break;
        default:
            throw Error('Unsupported geometry type: ' + e);
        }
        return c;
    }
    function pb(a, b) {
        for (var c = 0, d = a.length, e = a[d - 1][0], f = a[d - 1][1], g = 0; g < d; g++) {
            var h = a[g][0], l = a[g][1];
            c += va(h - e) * (2 + Math.sin(va(f)) + Math.sin(va(l)));
            e = h;
            f = l;
        }
        return c * b * b / 2;
    }
    var ub = {};
    ub.degrees = 12741994 * Math.PI / 360;
    ub.ft = 0.3048;
    ub.m = 1;
    ub['us-ft'] = 1200 / 3937;
    var vb = null;
    function wb(a) {
        this.wb = a.code;
        this.a = a.units;
        this.i = void 0 !== a.extent ? a.extent : null;
        this.oe = void 0 !== a.worldExtent ? a.worldExtent : null;
        this.b = void 0 !== a.axisOrientation ? a.axisOrientation : 'enu';
        this.c = void 0 !== a.global ? a.global : !1;
        this.g = !(!this.c || !this.i);
        this.j = a.getPointResolution;
        this.f = null;
        this.l = a.metersPerUnit;
        var b = a.code, c = vb || window.proj4;
        'function' == typeof c && (b = c.defs(b), void 0 !== b && (void 0 !== b.axis && void 0 === a.axisOrientation && (this.b = b.axis), void 0 === a.metersPerUnit && (this.l = b.to_meter), void 0 === a.units && (this.a = b.units)));
    }
    k = wb.prototype;
    k.ml = function () {
        return this.wb;
    };
    k.G = function () {
        return this.i;
    };
    k.zo = function () {
        return this.a;
    };
    k.Bc = function () {
        return this.l || ub[this.a];
    };
    k.Vl = function () {
        return this.oe;
    };
    k.il = function () {
        return this.b;
    };
    k.Gm = function () {
        return this.c;
    };
    k.xq = function (a) {
        this.c = a;
        this.g = !(!a || !this.i);
    };
    k.Si = function (a) {
        this.i = a;
        this.g = !(!this.c || !a);
    };
    k.Sj = function (a) {
        this.oe = a;
    };
    k.wq = function (a) {
        this.j = a;
    };
    function xb(a) {
        wb.call(this, {
            code: a,
            units: 'm',
            extent: yb,
            global: !0,
            worldExtent: zb,
            getPointResolution: function (a, c) {
                return a / qa(c[1] / 6378137);
            }
        });
    }
    w(xb, wb);
    var Ab = 6378137 * Math.PI, yb = [
            -Ab,
            -Ab,
            Ab,
            Ab
        ], zb = [
            -180,
            -85,
            180,
            85
        ], Bb = [
            new xb('EPSG:3857'),
            new xb('EPSG:102100'),
            new xb('EPSG:102113'),
            new xb('EPSG:900913'),
            new xb('urn:ogc:def:crs:EPSG:6.18:3:3857'),
            new xb('urn:ogc:def:crs:EPSG::3857'),
            new xb('http://www.opengis.net/gml/srs/epsg.xml#3857')
        ];
    function Cb(a, b, c) {
        var d = a.length;
        c = 1 < c ? c : 2;
        void 0 === b && (2 < c ? b = a.slice() : b = Array(d));
        for (var e = 0; e < d; e += c) {
            b[e] = Ab * a[e] / 180;
            var f = 6378137 * Math.log(Math.tan(Math.PI * (a[e + 1] + 90) / 360));
            f > Ab ? f = Ab : f < -Ab && (f = -Ab);
            b[e + 1] = f;
        }
        return b;
    }
    function Db(a, b, c) {
        var d = a.length;
        c = 1 < c ? c : 2;
        void 0 === b && (2 < c ? b = a.slice() : b = Array(d));
        for (var e = 0; e < d; e += c)
            b[e] = 180 * a[e] / Ab, b[e + 1] = 360 * Math.atan(Math.exp(a[e + 1] / 6378137)) / Math.PI - 90;
        return b;
    }
    function Eb(a, b) {
        wb.call(this, {
            code: a,
            units: 'degrees',
            extent: Fb,
            axisOrientation: b,
            global: !0,
            metersPerUnit: Gb,
            worldExtent: Fb
        });
    }
    w(Eb, wb);
    var Fb = [
            -180,
            -90,
            180,
            90
        ], Gb = 6378137 * Math.PI / 180, Hb = [
            new Eb('CRS:84'),
            new Eb('EPSG:4326', 'neu'),
            new Eb('urn:ogc:def:crs:EPSG::4326', 'neu'),
            new Eb('urn:ogc:def:crs:EPSG:6.6:4326', 'neu'),
            new Eb('urn:ogc:def:crs:OGC:1.3:CRS84'),
            new Eb('urn:ogc:def:crs:OGC:2:84'),
            new Eb('http://www.opengis.net/gml/srs/epsg.xml#4326', 'neu'),
            new Eb('urn:x-ogc:def:crs:EPSG:4326', 'neu')
        ];
    var Ib = {};
    var Jb = {};
    function Kb(a, b, c) {
        a = a.wb;
        b = b.wb;
        a in Jb || (Jb[a] = {});
        Jb[a][b] = c;
    }
    function Lb(a, b) {
        var c;
        a in Jb && b in Jb[a] && (c = Jb[a][b]);
        return c;
    }
    var Mb = new ob(6371008.8);
    function Nb(a, b, c, d) {
        a = Ob(a);
        var e = a.j;
        e ? b = e(b, c) : 'degrees' == a.a && !d || 'degrees' == d || (e = Pb(a, Ob('EPSG:4326')), b = [
            c[0] - b / 2,
            c[1],
            c[0] + b / 2,
            c[1],
            c[0],
            c[1] - b / 2,
            c[0],
            c[1] + b / 2
        ], b = e(b, b, 2), b = (Mb.b(b.slice(0, 2), b.slice(2, 4)) + Mb.b(b.slice(4, 6), b.slice(6, 8))) / 2, a = d ? ub[d] : a.Bc(), void 0 !== a && (b /= a));
        return b;
    }
    function Qb(a) {
        a.forEach(Rb);
        a.forEach(function (b) {
            a.forEach(function (a) {
                b !== a && Kb(b, a, Sb);
            });
        });
    }
    function Tb() {
        Hb.forEach(function (a) {
            Bb.forEach(function (b) {
                Kb(a, b, Cb);
                Kb(b, a, Db);
            });
        });
    }
    function Rb(a) {
        Ib[a.wb] = a;
        Kb(a, a, Sb);
    }
    function Ub(a) {
        return a ? 'string' === typeof a ? Ob(a) : a : Ob('EPSG:3857');
    }
    function Vb(a, b, c, d) {
        a = Ob(a);
        b = Ob(b);
        Kb(a, b, Wb(c));
        Kb(b, a, Wb(d));
    }
    function Wb(a) {
        return function (b, c, d) {
            var e = b.length;
            d = void 0 !== d ? d : 2;
            c = void 0 !== c ? c : Array(e);
            var f;
            for (f = 0; f < e; f += d) {
                var g = a([
                    b[f],
                    b[f + 1]
                ]);
                c[f] = g[0];
                c[f + 1] = g[1];
                for (g = d - 1; 2 <= g; --g)
                    c[f + g] = b[f + g];
            }
            return c;
        };
    }
    function Ob(a) {
        var b = null;
        if (a instanceof wb)
            b = a;
        else if ('string' === typeof a && (b = Ib[a] || null, !b)) {
            var c = vb || window.proj4;
            'function' == typeof c && void 0 !== c.defs(a) && (b = new wb({ code: a }), Rb(b));
        }
        return b;
    }
    function Xb(a, b) {
        if (a === b)
            return !0;
        var c = a.a === b.a;
        return a.wb === b.wb ? c : Pb(a, b) === Sb && c;
    }
    function Yb(a, b) {
        a = Ob(a);
        b = Ob(b);
        return Pb(a, b);
    }
    function Pb(a, b) {
        var c = a.wb, d = b.wb, e = Lb(c, d);
        if (!e) {
            var f = vb || window.proj4;
            if ('function' == typeof f) {
                var g = f.defs(c), h = f.defs(d);
                void 0 !== g && void 0 !== h && (g === h ? Qb([
                    b,
                    a
                ]) : (e = f(d, c), Vb(b, a, e.forward, e.inverse)), e = Lb(c, d));
            }
        }
        e || (e = $b);
        return e;
    }
    function $b(a, b) {
        if (void 0 !== b && a !== b) {
            for (var c = 0, d = a.length; c < d; ++c)
                b[c] = a[c];
            a = b;
        }
        return a;
    }
    function Sb(a, b) {
        if (void 0 !== b) {
            for (var c = 0, d = a.length; c < d; ++c)
                b[c] = a[c];
            a = b;
        } else
            a = a.slice();
        return a;
    }
    function ac(a, b, c) {
        return Yb(b, c)(a, void 0, a.length);
    }
    function bc(a, b, c) {
        b = Yb(b, c);
        return jb(a, b);
    }
    function cc() {
        Qb(Bb);
        Qb(Hb);
        Tb();
    }
    cc();
    function dc(a, b) {
        return a > b ? 1 : a < b ? -1 : 0;
    }
    function ec(a, b) {
        return 0 <= a.indexOf(b);
    }
    function fc(a, b, c) {
        var d = a.length;
        if (a[0] <= b)
            return 0;
        if (!(b <= a[d - 1]))
            if (0 < c)
                for (c = 1; c < d; ++c) {
                    if (a[c] < b)
                        return c - 1;
                }
            else if (0 > c)
                for (c = 1; c < d; ++c) {
                    if (a[c] <= b)
                        return c;
                }
            else
                for (c = 1; c < d; ++c) {
                    if (a[c] == b)
                        return c;
                    if (a[c] < b)
                        return a[c - 1] - b < b - a[c] ? c - 1 : c;
                }
        return d - 1;
    }
    function gc(a, b) {
        var c = Array.isArray(b) ? b : [b], d = c.length;
        for (b = 0; b < d; b++)
            a[a.length] = c[b];
    }
    function hc(a, b) {
        for (var c = a.length >>> 0, d, e = 0; e < c; e++)
            if (d = a[e], b(d, e, a))
                return d;
        return null;
    }
    function jc(a, b) {
        var c = a.length;
        if (c !== b.length)
            return !1;
        for (var d = 0; d < c; d++)
            if (a[d] !== b[d])
                return !1;
        return !0;
    }
    function kc(a) {
        var b = lc, c = a.length, d = Array(a.length), e;
        for (e = 0; e < c; e++)
            d[e] = {
                index: e,
                value: a[e]
            };
        d.sort(function (a, c) {
            return b(a.value, c.value) || a.index - c.index;
        });
        for (e = 0; e < a.length; e++)
            a[e] = d[e].value;
    }
    function mc(a, b) {
        var c;
        return a.every(function (d, e) {
            c = e;
            return !b(d, e, a);
        }) ? -1 : c;
    }
    function nc(a, b) {
        var c = b || dc;
        return a.every(function (b, e) {
            if (0 === e)
                return !0;
            b = c(a[e - 1], b);
            return !(0 < b || 0 === b);
        });
    }
    function oc(a, b, c, d) {
        return void 0 !== d ? (d[0] = a, d[1] = b, d[2] = c, d) : [
            a,
            b,
            c
        ];
    }
    function pc(a) {
        var b = a[0], c = Array(b), d = 1 << b - 1, e;
        for (e = 0; e < b; ++e) {
            var f = 48;
            a[1] & d && (f += 1);
            a[2] & d && (f += 2);
            c[e] = String.fromCharCode(f);
            d >>= 1;
        }
        return c.join('');
    }
    function qc(a) {
        this.minZoom = void 0 !== a.minZoom ? a.minZoom : 0;
        this.b = a.resolutions;
        oa(nc(this.b, function (a, b) {
            return b - a;
        }), 17);
        if (!a.origins)
            for (var b = 0, c = this.b.length - 1; b < c; ++b)
                if (!d)
                    var d = this.b[b] / this.b[b + 1];
                else if (this.b[b] / this.b[b + 1] !== d) {
                    d = void 0;
                    break;
                }
        this.l = d;
        this.maxZoom = this.b.length - 1;
        this.g = void 0 !== a.origin ? a.origin : null;
        this.c = null;
        void 0 !== a.origins && (this.c = a.origins, oa(this.c.length == this.b.length, 20));
        d = a.extent;
        void 0 === d || this.g || this.c || (this.g = $a(d));
        oa(!this.g && this.c || this.g && !this.c, 18);
        this.i = null;
        void 0 !== a.tileSizes && (this.i = a.tileSizes, oa(this.i.length == this.b.length, 19));
        this.j = void 0 !== a.tileSize ? a.tileSize : this.i ? null : 256;
        oa(!this.j && this.i || this.j && !this.i, 22);
        this.o = void 0 !== d ? d : null;
        this.a = null;
        this.f = [
            0,
            0
        ];
        void 0 !== a.sizes ? this.a = a.sizes.map(function (a) {
            return new ja(Math.min(0, a[0]), Math.max(a[0] - 1, -1), Math.min(0, a[1]), Math.max(a[1] - 1, -1));
        }, this) : d && rc(this, d);
    }
    var sc = [
        0,
        0,
        0
    ];
    k = qc.prototype;
    k.Vf = function (a, b, c) {
        a = tc(this, a, b);
        for (var d = a.fa, e = a.la; d <= e; ++d)
            for (var f = a.ea, g = a.ka; f <= g; ++f)
                c([
                    b,
                    d,
                    f
                ]);
    };
    function uc(a, b, c, d, e) {
        var f = null, g = b[0] - 1;
        if (2 === a.l) {
            var h = b[1];
            var l = b[2];
        } else
            f = a.Ma(b, e);
        for (; g >= a.minZoom;) {
            2 === a.l ? (h = Math.floor(h / 2), l = Math.floor(l / 2), b = ka(h, h, l, l, d)) : b = tc(a, f, g, d);
            if (c.call(null, g, b))
                return !0;
            --g;
        }
        return !1;
    }
    k.G = function () {
        return this.o;
    };
    k.mj = function () {
        return this.maxZoom;
    };
    k.nj = function () {
        return this.minZoom;
    };
    k.Ic = function (a) {
        return this.g ? this.g : this.c[a];
    };
    k.Ta = function (a) {
        return this.b[a];
    };
    k.oj = function () {
        return this.b;
    };
    function vc(a, b, c, d) {
        if (b[0] < a.maxZoom) {
            if (2 === a.l)
                return a = 2 * b[1], b = 2 * b[2], ka(a, a + 1, b, b + 1, c);
            d = a.Ma(b, d);
            return tc(a, d, b[0] + 1, c);
        }
        return null;
    }
    function wc(a, b, c) {
        var d = a.Ic(b), e = a.Ta(b);
        a = Ba(a.Za(b), a.f);
        return Na(d[0] + c.fa * a[0] * e, d[1] + c.ea * a[1] * e, d[0] + (c.la + 1) * a[0] * e, d[1] + (c.ka + 1) * a[1] * e, void 0);
    }
    function tc(a, b, c, d) {
        xc(a, b[0], b[1], c, !1, sc);
        var e = sc[1], f = sc[2];
        xc(a, b[2], b[3], c, !0, sc);
        return ka(e, sc[1], f, sc[2], d);
    }
    function yc(a, b) {
        var c = a.Ic(b[0]), d = a.Ta(b[0]);
        a = Ba(a.Za(b[0]), a.f);
        return [
            c[0] + (b[1] + 0.5) * a[0] * d,
            c[1] + (b[2] + 0.5) * a[1] * d
        ];
    }
    k.Ma = function (a, b) {
        var c = this.Ic(a[0]), d = this.Ta(a[0]), e = Ba(this.Za(a[0]), this.f), f = c[0] + a[1] * e[0] * d;
        a = c[1] + a[2] * e[1] * d;
        return Na(f, a, f + e[0] * d, a + e[1] * d, b);
    };
    k.Le = function (a, b, c) {
        var d = a[0], e = a[1];
        a = this.Dc(b);
        var f = b / this.Ta(a), g = this.Ic(a), h = Ba(this.Za(a), this.f);
        d = f * Math.floor((d - g[0]) / b + 0) / h[0];
        b = f * Math.floor((e - g[1]) / b + 0.5) / h[1];
        d = Math.floor(d);
        b = Math.floor(b);
        return oc(a, d, b, c);
    };
    function xc(a, b, c, d, e, f) {
        var g = a.Ic(d), h = a.Ta(d);
        a = Ba(a.Za(d), a.f);
        b = Math.floor((b - g[0]) / h + (e ? 0.5 : 0)) / a[0];
        c = Math.floor((c - g[1]) / h + (e ? 0 : 0.5)) / a[1];
        e ? (b = Math.ceil(b) - 1, c = Math.ceil(c) - 1) : (b = Math.floor(b), c = Math.floor(c));
        return oc(d, b, c, f);
    }
    k.jg = function (a, b, c) {
        return xc(this, a[0], a[1], b, !1, c);
    };
    k.Za = function (a) {
        return this.j ? this.j : this.i[a];
    };
    k.Dc = function (a, b) {
        return pa(fc(this.b, a, b || 0), this.minZoom, this.maxZoom);
    };
    function rc(a, b) {
        for (var c = a.b.length, d = Array(c), e = a.minZoom; e < c; ++e)
            d[e] = tc(a, b, e);
        a.a = d;
    }
    function zc(a) {
        var b = a.f;
        b || (b = Ac(a), a.f = b);
        return b;
    }
    function Bc(a) {
        var b = {};
        kb(b, void 0 !== a ? a : {});
        void 0 === b.extent && (b.extent = Ob('EPSG:3857').G());
        b.resolutions = Cc(b.extent, b.maxZoom, b.tileSize);
        delete b.maxZoom;
        return new qc(b);
    }
    function Cc(a, b, c) {
        b = void 0 !== b ? b : 42;
        var d = db(a);
        a = cb(a);
        c = Ba(void 0 !== c ? c : 256);
        c = Math.max(a / c[0], d / c[1]);
        b += 1;
        d = Array(b);
        for (a = 0; a < b; ++a)
            d[a] = c / Math.pow(2, a);
        return d;
    }
    function Ac(a, b, c) {
        a = Dc(a);
        b = Cc(a, b, c);
        return new qc({
            extent: a,
            origin: $a(a),
            resolutions: b,
            tileSize: c
        });
    }
    function Dc(a) {
        a = Ob(a);
        var b = a.G();
        b || (a = 180 * ub.degrees / a.Bc(), b = Na(-a, -a, a, a));
        return b;
    }
    function Ec(a) {
        this.og = a.html;
    }
    Ec.prototype.b = function () {
        return this.og;
    };
    function Fc(a) {
        function b(b) {
            var c = a.listener, e = a.Ch || a.target;
            a.Eh && Gc(a);
            return c.call(e, b);
        }
        return a.Dh = b;
    }
    function Hc(a, b, c, d) {
        for (var e, f = 0, g = a.length; f < g; ++f)
            if (e = a[f], e.listener === b && e.Ch === c)
                return d && (e.deleteIndex = f), e;
    }
    function Ic(a, b) {
        return (a = a.ab) ? a[b] : void 0;
    }
    function Jc(a) {
        var b = a.ab;
        b || (b = a.ab = {});
        return b;
    }
    function Kc(a, b) {
        var c = Ic(a, b);
        if (c) {
            for (var d = 0, e = c.length; d < e; ++d)
                a.removeEventListener(b, c[d].Dh), lb(c[d]);
            c.length = 0;
            if (c = a.ab)
                delete c[b], 0 === Object.keys(c).length && delete a.ab;
        }
    }
    function y(a, b, c, d, e) {
        var f = Jc(a), g = f[b];
        g || (g = f[b] = []);
        (f = Hc(g, c, d, !1)) ? e || (f.Eh = !1) : (f = {
            Ch: d,
            Eh: !!e,
            listener: c,
            target: a,
            type: b
        }, a.addEventListener(b, Fc(f)), g.push(f));
        return f;
    }
    function Lc(a, b, c, d) {
        return y(a, b, c, d, !0);
    }
    function Mc(a, b, c, d) {
        (a = Ic(a, b)) && (c = Hc(a, c, d, !0)) && Gc(c);
    }
    function Gc(a) {
        if (a && a.target) {
            a.target.removeEventListener(a.type, a.Dh);
            var b = Ic(a.target, a.type);
            if (b) {
                var c = 'deleteIndex' in a ? a.deleteIndex : b.indexOf(a);
                -1 !== c && b.splice(c, 1);
                0 === b.length && Kc(a.target, a.type);
            }
            lb(a);
        }
    }
    function Nc(a) {
        var b = Jc(a), c;
        for (c in b)
            Kc(a, c);
    }
    function Oc() {
    }
    Oc.prototype.Ub = !1;
    function Pc(a) {
        a.Ub || (a.Ub = !0, a.ia());
    }
    Oc.prototype.ia = ea;
    function Qc(a) {
        this.type = a;
        this.target = null;
    }
    Qc.prototype.preventDefault = Qc.prototype.stopPropagation = function () {
        this.sj = !0;
    };
    function Rc(a) {
        a.stopPropagation();
    }
    function Sc() {
        this.Wa = {};
        this.qa = {};
        this.oa = {};
    }
    w(Sc, Oc);
    Sc.prototype.addEventListener = function (a, b) {
        var c = this.oa[a];
        c || (c = this.oa[a] = []);
        -1 === c.indexOf(b) && c.push(b);
    };
    Sc.prototype.b = function (a) {
        var b = 'string' === typeof a ? new Qc(a) : a;
        a = b.type;
        b.target = this;
        var c = this.oa[a];
        if (c) {
            a in this.qa || (this.qa[a] = 0, this.Wa[a] = 0);
            ++this.qa[a];
            for (var d = 0, e = c.length; d < e; ++d)
                if (!1 === c[d].call(this, b) || b.sj) {
                    var f = !1;
                    break;
                }
            --this.qa[a];
            if (0 === this.qa[a]) {
                b = this.Wa[a];
                for (delete this.Wa[a]; b--;)
                    this.removeEventListener(a, ea);
                delete this.qa[a];
            }
            return f;
        }
    };
    Sc.prototype.ia = function () {
        Nc(this);
    };
    function Tc(a, b) {
        return b ? b in a.oa : 0 < Object.keys(a.oa).length;
    }
    Sc.prototype.removeEventListener = function (a, b) {
        var c = this.oa[a];
        c && (b = c.indexOf(b), a in this.Wa ? (c[b] = ea, ++this.Wa[a]) : (c.splice(b, 1), 0 === c.length && delete this.oa[a]));
    };
    function Uc() {
        Sc.call(this);
        this.g = 0;
    }
    w(Uc, Sc);
    k = Uc.prototype;
    k.u = function () {
        ++this.g;
        this.b('change');
    };
    k.K = function () {
        return this.g;
    };
    k.I = function (a, b, c) {
        if (Array.isArray(a)) {
            for (var d = a.length, e = Array(d), f = 0; f < d; ++f)
                e[f] = y(this, a[f], b, c);
            return e;
        }
        return y(this, a, b, c);
    };
    k.once = function (a, b, c) {
        if (Array.isArray(a)) {
            for (var d = a.length, e = Array(d), f = 0; f < d; ++f)
                e[f] = Lc(this, a[f], b, c);
            return e;
        }
        return Lc(this, a, b, c);
    };
    k.J = function (a, b, c) {
        if (Array.isArray(a))
            for (var d = 0, e = a.length; d < e; ++d)
                Mc(this, a[d], b, c);
        else
            Mc(this, a, b, c);
    };
    function Vc(a) {
        Uc.call(this);
        x(this);
        this.N = {};
        void 0 !== a && this.H(a);
    }
    w(Vc, Uc);
    var Wc = {};
    function Xc(a) {
        return Wc.hasOwnProperty(a) ? Wc[a] : Wc[a] = 'change:' + a;
    }
    k = Vc.prototype;
    k.get = function (a) {
        var b;
        this.N.hasOwnProperty(a) && (b = this.N[a]);
        return b;
    };
    k.P = function () {
        return Object.keys(this.N);
    };
    k.L = function () {
        return kb({}, this.N);
    };
    function Yc(a, b, c) {
        var d = Xc(b);
        a.b(new Zc(d, b, c));
        a.b(new Zc('propertychange', b, c));
    }
    k.set = function (a, b, c) {
        c ? this.N[a] = b : (c = this.N[a], this.N[a] = b, c !== b && Yc(this, a, c));
    };
    k.H = function (a, b) {
        for (var c in a)
            this.set(c, a[c], b);
    };
    k.R = function (a, b) {
        if (a in this.N) {
            var c = this.N[a];
            delete this.N[a];
            b || Yc(this, a, c);
        }
    };
    function Zc(a, b, c) {
        Qc.call(this, a);
        this.key = b;
        this.oldValue = c;
    }
    w(Zc, Qc);
    function B(a, b) {
        Vc.call(this);
        this.c = !!(b || {}).unique;
        this.a = a ? a : [];
        if (this.c)
            for (a = 0, b = this.a.length; a < b; ++a)
                $c(this, this.a[a], a);
        ad(this);
    }
    w(B, Vc);
    k = B.prototype;
    k.clear = function () {
        for (; 0 < this.kc();)
            this.pop();
    };
    k.qg = function (a) {
        var b;
        var c = 0;
        for (b = a.length; c < b; ++c)
            this.push(a[c]);
        return this;
    };
    k.forEach = function (a, b) {
        a = b ? a.bind(b) : a;
        b = this.a;
        for (var c = 0, d = b.length; c < d; ++c)
            a(b[c], c, b);
    };
    k.Xm = function () {
        return this.a;
    };
    k.item = function (a) {
        return this.a[a];
    };
    k.kc = function () {
        return this.get(bd);
    };
    k.Re = function (a, b) {
        this.c && $c(this, b);
        this.a.splice(a, 0, b);
        ad(this);
        this.b(new cd('add', b));
    };
    k.pop = function () {
        return this.Wg(this.kc() - 1);
    };
    k.push = function (a) {
        this.c && $c(this, a);
        var b = this.kc();
        this.Re(b, a);
        return this.kc();
    };
    k.remove = function (a) {
        var b = this.a, c;
        var d = 0;
        for (c = b.length; d < c; ++d)
            if (b[d] === a)
                return this.Wg(d);
    };
    k.Wg = function (a) {
        var b = this.a[a];
        this.a.splice(a, 1);
        ad(this);
        this.b(new cd('remove', b));
        return b;
    };
    k.rq = function (a, b) {
        var c = this.kc();
        if (a < c)
            this.c && $c(this, b, a), c = this.a[a], this.a[a] = b, this.b(new cd('remove', c)), this.b(new cd('add', b));
        else {
            for (; c < a; ++c)
                this.Re(c, void 0);
            this.Re(a, b);
        }
    };
    function ad(a) {
        a.set(bd, a.a.length);
    }
    function $c(a, b, c) {
        for (var d = 0, e = a.a.length; d < e; ++d)
            if (a.a[d] === b && d !== c)
                throw new ha(58);
    }
    var bd = 'length';
    function cd(a, b) {
        Qc.call(this, a);
        this.element = b;
    }
    w(cd, Qc);
    function dd(a, b, c) {
        Qc.call(this, a);
        this.map = b;
        this.frameState = void 0 !== c ? c : null;
    }
    w(dd, Qc);
    function ed(a, b, c, d, e) {
        dd.call(this, a, b, e);
        this.originalEvent = c;
        this.pixel = b.ud(c);
        this.coordinate = b.Ra(this.pixel);
        this.dragging = void 0 !== d ? d : !1;
    }
    w(ed, dd);
    ed.prototype.preventDefault = function () {
        dd.prototype.preventDefault.call(this);
        this.originalEvent.preventDefault();
    };
    ed.prototype.stopPropagation = function () {
        dd.prototype.stopPropagation.call(this);
        this.originalEvent.stopPropagation();
    };
    var fd = [
        'experimental-webgl',
        'webgl',
        'webkit-3d',
        'moz-webgl'
    ];
    function gd(a, b) {
        var c, d, e = fd.length;
        for (d = 0; d < e; ++d)
            try {
                if (c = a.getContext(fd[d], b))
                    return c;
            } catch (f) {
            }
        return null;
    }
    var hd, id = 'undefined' !== typeof navigator ? navigator.userAgent.toLowerCase() : '', jd = -1 !== id.indexOf('firefox'), kd = -1 !== id.indexOf('safari') && -1 == id.indexOf('chrom'), ld = -1 !== id.indexOf('webkit') && -1 == id.indexOf('edge'), md = -1 !== id.indexOf('macintosh'), nd = window.devicePixelRatio || 1, od = !1, pd = function () {
            if (!('HTMLCanvasElement' in window))
                return !1;
            try {
                var a = document.createElement('CANVAS').getContext('2d');
                return a ? (void 0 !== a.setLineDash && (od = !0), !0) : !1;
            } catch (b) {
                return !1;
            }
        }(), qd = 'DeviceOrientationEvent' in window, rd = 'geolocation' in navigator, sd = 'ontouchstart' in window, td = 'PointerEvent' in window, ud = !!navigator.msPointerEnabled, vd = !1, wd, xd = [];
    if ('WebGLRenderingContext' in window)
        try {
            var yd = gd(document.createElement('CANVAS'), { failIfMajorPerformanceCaveat: !0 });
            yd && (vd = !0, wd = yd.getParameter(yd.MAX_TEXTURE_SIZE), xd = yd.getSupportedExtensions());
        } catch (a) {
        }
    hd = vd;
    da = xd;
    ba = wd;
    var zd = {
        gr: 'singleclick',
        Wq: 'click',
        Xq: 'dblclick',
        $q: 'pointerdrag',
        cr: 'pointermove',
        Zq: 'pointerdown',
        fr: 'pointerup',
        er: 'pointerover',
        dr: 'pointerout',
        ar: 'pointerenter',
        br: 'pointerleave',
        Yq: 'pointercancel'
    };
    function Ad(a, b, c, d, e) {
        ed.call(this, a, b, c.b, d, e);
        this.b = c;
    }
    w(Ad, ed);
    function Bd(a, b) {
        this.b = a;
        this.i = b;
    }
    function Cd(a) {
        Bd.call(this, a, {
            mousedown: this.Jm,
            mousemove: this.Km,
            mouseup: this.Nm,
            mouseover: this.Mm,
            mouseout: this.Lm
        });
        this.a = a.g;
        this.g = [];
    }
    w(Cd, Bd);
    function Dd(a, b) {
        a = a.g;
        var c = b.clientX;
        b = b.clientY;
        for (var d = 0, e = a.length, f; d < e && (f = a[d]); d++) {
            var g = Math.abs(b - f[1]);
            if (25 >= Math.abs(c - f[0]) && 25 >= g)
                return !0;
        }
        return !1;
    }
    function Ed(a) {
        var b = Fd(a, a), c = b.preventDefault;
        b.preventDefault = function () {
            a.preventDefault();
            c();
        };
        b.pointerId = 1;
        b.isPrimary = !0;
        b.pointerType = 'mouse';
        return b;
    }
    k = Cd.prototype;
    k.Jm = function (a) {
        if (!Dd(this, a)) {
            1 .toString() in this.a && this.cancel(a);
            var b = Ed(a);
            this.a[1 .toString()] = a;
            Gd(this.b, 'pointerdown', b, a);
        }
    };
    k.Km = function (a) {
        if (!Dd(this, a)) {
            var b = Ed(a);
            Gd(this.b, 'pointermove', b, a);
        }
    };
    k.Nm = function (a) {
        if (!Dd(this, a)) {
            var b = this.a[1 .toString()];
            b && b.button === a.button && (b = Ed(a), Gd(this.b, 'pointerup', b, a), delete this.a[1 .toString()]);
        }
    };
    k.Mm = function (a) {
        if (!Dd(this, a)) {
            var b = Ed(a);
            Hd(this.b, b, a);
        }
    };
    k.Lm = function (a) {
        if (!Dd(this, a)) {
            var b = Ed(a);
            Jd(this.b, b, a);
        }
    };
    k.cancel = function (a) {
        var b = Ed(a);
        this.b.cancel(b, a);
        delete this.a[1 .toString()];
    };
    function Kd(a) {
        Bd.call(this, a, {
            MSPointerDown: this.Sm,
            MSPointerMove: this.Tm,
            MSPointerUp: this.Wm,
            MSPointerOut: this.Um,
            MSPointerOver: this.Vm,
            MSPointerCancel: this.Rm,
            MSGotPointerCapture: this.Pm,
            MSLostPointerCapture: this.Qm
        });
        this.a = a.g;
        this.g = [
            '',
            'unavailable',
            'touch',
            'pen',
            'mouse'
        ];
    }
    w(Kd, Bd);
    function Ld(a, b) {
        var c = b;
        'number' === typeof b.pointerType && (c = Fd(b, b), c.pointerType = a.g[b.pointerType]);
        return c;
    }
    k = Kd.prototype;
    k.Sm = function (a) {
        this.a[a.pointerId.toString()] = a;
        var b = Ld(this, a);
        Gd(this.b, 'pointerdown', b, a);
    };
    k.Tm = function (a) {
        var b = Ld(this, a);
        Gd(this.b, 'pointermove', b, a);
    };
    k.Wm = function (a) {
        var b = Ld(this, a);
        Gd(this.b, 'pointerup', b, a);
        delete this.a[a.pointerId.toString()];
    };
    k.Um = function (a) {
        var b = Ld(this, a);
        Jd(this.b, b, a);
    };
    k.Vm = function (a) {
        var b = Ld(this, a);
        Hd(this.b, b, a);
    };
    k.Rm = function (a) {
        var b = Ld(this, a);
        this.b.cancel(b, a);
        delete this.a[a.pointerId.toString()];
    };
    k.Qm = function (a) {
        this.b.b(new Md('lostpointercapture', a, a));
    };
    k.Pm = function (a) {
        this.b.b(new Md('gotpointercapture', a, a));
    };
    function Nd(a) {
        Bd.call(this, a, {
            pointerdown: this.Kp,
            pointermove: this.Lp,
            pointerup: this.Op,
            pointerout: this.Mp,
            pointerover: this.Np,
            pointercancel: this.Jp,
            gotpointercapture: this.Wl,
            lostpointercapture: this.Hm
        });
    }
    w(Nd, Bd);
    k = Nd.prototype;
    k.Kp = function (a) {
        Od(this.b, a);
    };
    k.Lp = function (a) {
        Od(this.b, a);
    };
    k.Op = function (a) {
        Od(this.b, a);
    };
    k.Mp = function (a) {
        Od(this.b, a);
    };
    k.Np = function (a) {
        Od(this.b, a);
    };
    k.Jp = function (a) {
        Od(this.b, a);
    };
    k.Hm = function (a) {
        Od(this.b, a);
    };
    k.Wl = function (a) {
        Od(this.b, a);
    };
    function Md(a, b, c) {
        Qc.call(this, a);
        this.b = b;
        a = c ? c : {};
        this.buttons = Pd(a);
        this.pressure = Qd(a, this.buttons);
        this.bubbles = 'bubbles' in a ? a.bubbles : !1;
        this.cancelable = 'cancelable' in a ? a.cancelable : !1;
        this.view = 'view' in a ? a.view : null;
        this.detail = 'detail' in a ? a.detail : null;
        this.screenX = 'screenX' in a ? a.screenX : 0;
        this.screenY = 'screenY' in a ? a.screenY : 0;
        this.clientX = 'clientX' in a ? a.clientX : 0;
        this.clientY = 'clientY' in a ? a.clientY : 0;
        this.ctrlKey = 'ctrlKey' in a ? a.ctrlKey : !1;
        this.altKey = 'altKey' in a ? a.altKey : !1;
        this.shiftKey = 'shiftKey' in a ? a.shiftKey : !1;
        this.metaKey = 'metaKey' in a ? a.metaKey : !1;
        this.button = 'button' in a ? a.button : 0;
        this.relatedTarget = 'relatedTarget' in a ? a.relatedTarget : null;
        this.pointerId = 'pointerId' in a ? a.pointerId : 0;
        this.width = 'width' in a ? a.width : 0;
        this.height = 'height' in a ? a.height : 0;
        this.tiltX = 'tiltX' in a ? a.tiltX : 0;
        this.tiltY = 'tiltY' in a ? a.tiltY : 0;
        this.pointerType = 'pointerType' in a ? a.pointerType : '';
        this.isPrimary = 'isPrimary' in a ? a.isPrimary : !1;
        b.preventDefault && (this.preventDefault = function () {
            b.preventDefault();
        });
    }
    w(Md, Qc);
    function Pd(a) {
        if (a.buttons || Rd)
            a = a.buttons;
        else
            switch (a.which) {
            case 1:
                a = 1;
                break;
            case 2:
                a = 4;
                break;
            case 3:
                a = 2;
                break;
            default:
                a = 0;
            }
        return a;
    }
    function Qd(a, b) {
        var c = 0;
        a.pressure ? c = a.pressure : c = b ? 0.5 : 0;
        return c;
    }
    var Rd = !1;
    try {
        Rd = 1 === new MouseEvent('click', { buttons: 1 }).buttons;
    } catch (a) {
    }
    function Sd(a, b) {
        Bd.call(this, a, {
            touchstart: this.Qq,
            touchmove: this.Pq,
            touchend: this.Oq,
            touchcancel: this.Nq
        });
        this.a = a.g;
        this.j = b;
        this.g = void 0;
        this.f = 0;
        this.c = void 0;
    }
    w(Sd, Bd);
    k = Sd.prototype;
    k.Ej = function () {
        this.f = 0;
        this.c = void 0;
    };
    function Td(a, b, c) {
        b = Fd(b, c);
        b.pointerId = c.identifier + 2;
        b.bubbles = !0;
        b.cancelable = !0;
        b.detail = a.f;
        b.button = 0;
        b.buttons = 1;
        b.width = c.webkitRadiusX || c.radiusX || 0;
        b.height = c.webkitRadiusY || c.radiusY || 0;
        b.pressure = c.webkitForce || c.force || 0.5;
        b.isPrimary = a.g === c.identifier;
        b.pointerType = 'touch';
        b.clientX = c.clientX;
        b.clientY = c.clientY;
        b.screenX = c.screenX;
        b.screenY = c.screenY;
        return b;
    }
    function Ud(a, b, c) {
        function d() {
            b.preventDefault();
        }
        var e = Array.prototype.slice.call(b.changedTouches), f = e.length, g;
        for (g = 0; g < f; ++g) {
            var h = Td(a, b, e[g]);
            h.preventDefault = d;
            c.call(a, b, h);
        }
    }
    k.Qq = function (a) {
        var b = a.touches, c = Object.keys(this.a), d = c.length;
        if (d >= b.length) {
            var e = [], f;
            for (f = 0; f < d; ++f) {
                var g = c[f];
                var h = this.a[g];
                var l;
                if (!(l = 1 == g))
                    a: {
                        for (var m = b.length, n = 0; n < m; n++)
                            if (l = b[n], l.identifier === g - 2) {
                                l = !0;
                                break a;
                            }
                        l = !1;
                    }
                l || e.push(h.out);
            }
            for (f = 0; f < e.length; ++f)
                this.Of(a, e[f]);
        }
        b = a.changedTouches[0];
        c = Object.keys(this.a).length;
        if (0 === c || 1 === c && 1 .toString() in this.a)
            this.g = b.identifier, void 0 !== this.c && clearTimeout(this.c);
        Vd(this, a);
        this.f++;
        Ud(this, a, this.Fp);
    };
    k.Fp = function (a, b) {
        this.a[b.pointerId] = {
            target: b.target,
            out: b,
            pj: b.target
        };
        var c = this.b;
        b.bubbles = !0;
        Gd(c, 'pointerover', b, a);
        c = this.b;
        b.bubbles = !1;
        Gd(c, 'pointerenter', b, a);
        Gd(this.b, 'pointerdown', b, a);
    };
    k.Pq = function (a) {
        a.preventDefault();
        Ud(this, a, this.Om);
    };
    k.Om = function (a, b) {
        var c = this.a[b.pointerId];
        if (c) {
            var d = c.out, e = c.pj;
            Gd(this.b, 'pointermove', b, a);
            d && e !== b.target && (d.relatedTarget = b.target, b.relatedTarget = e, d.target = e, b.target ? (Jd(this.b, d, a), Hd(this.b, b, a)) : (b.target = e, b.relatedTarget = null, this.Of(a, b)));
            c.out = b;
            c.pj = b.target;
        }
    };
    k.Oq = function (a) {
        Vd(this, a);
        Ud(this, a, this.Rq);
    };
    k.Rq = function (a, b) {
        Gd(this.b, 'pointerup', b, a);
        this.b.out(b, a);
        Wd(this.b, b, a);
        delete this.a[b.pointerId];
        b.isPrimary && (this.g = void 0, this.c = setTimeout(this.Ej.bind(this), 200));
    };
    k.Nq = function (a) {
        Ud(this, a, this.Of);
    };
    k.Of = function (a, b) {
        this.b.cancel(b, a);
        this.b.out(b, a);
        Wd(this.b, b, a);
        delete this.a[b.pointerId];
        b.isPrimary && (this.g = void 0, this.c = setTimeout(this.Ej.bind(this), 200));
    };
    function Vd(a, b) {
        var c = a.j.g;
        b = b.changedTouches[0];
        if (a.g === b.identifier) {
            var d = [
                b.clientX,
                b.clientY
            ];
            c.push(d);
            setTimeout(function () {
                var a = c.indexOf(d);
                -1 < a && c.splice(a, 1);
            }, 2500);
        }
    }
    function Xd(a) {
        Sc.call(this);
        this.f = a;
        this.g = {};
        this.i = {};
        this.a = [];
        td ? Yd(this, new Nd(this)) : ud ? Yd(this, new Kd(this)) : (a = new Cd(this), Yd(this, a), sd && Yd(this, new Sd(this, a)));
        a = this.a.length;
        for (var b, c = 0; c < a; c++)
            b = this.a[c], Zd(this, Object.keys(b.i));
    }
    w(Xd, Sc);
    function Yd(a, b) {
        var c = Object.keys(b.i);
        c && (c.forEach(function (a) {
            var c = b.i[a];
            c && (this.i[a] = c.bind(b));
        }, a), a.a.push(b));
    }
    Xd.prototype.c = function (a) {
        var b = this.i[a.type];
        b && b(a);
    };
    function Zd(a, b) {
        b.forEach(function (a) {
            y(this.f, a, this.c, this);
        }, a);
    }
    function $d(a, b) {
        b.forEach(function (a) {
            Mc(this.f, a, this.c, this);
        }, a);
    }
    function Fd(a, b) {
        for (var c = {}, d, e = 0, f = ae.length; e < f; e++)
            d = ae[e][0], c[d] = a[d] || b[d] || ae[e][1];
        return c;
    }
    function Wd(a, b, c) {
        b.bubbles = !1;
        Gd(a, 'pointerleave', b, c);
    }
    Xd.prototype.out = function (a, b) {
        a.bubbles = !0;
        Gd(this, 'pointerout', a, b);
    };
    Xd.prototype.cancel = function (a, b) {
        Gd(this, 'pointercancel', a, b);
    };
    function Jd(a, b, c) {
        a.out(b, c);
        var d = b.target, e = b.relatedTarget;
        d && e && d.contains(e) || Wd(a, b, c);
    }
    function Hd(a, b, c) {
        b.bubbles = !0;
        Gd(a, 'pointerover', b, c);
        var d = b.target, e = b.relatedTarget;
        d && e && d.contains(e) || (b.bubbles = !1, Gd(a, 'pointerenter', b, c));
    }
    function Gd(a, b, c, d) {
        a.b(new Md(b, d, c));
    }
    function Od(a, b) {
        a.b(new Md(b.type, b, b));
    }
    Xd.prototype.ia = function () {
        for (var a = this.a.length, b, c = 0; c < a; c++)
            b = this.a[c], $d(this, Object.keys(b.i));
        Sc.prototype.ia.call(this);
    };
    var ae = [
        [
            'bubbles',
            !1
        ],
        [
            'cancelable',
            !1
        ],
        [
            'view',
            null
        ],
        [
            'detail',
            null
        ],
        [
            'screenX',
            0
        ],
        [
            'screenY',
            0
        ],
        [
            'clientX',
            0
        ],
        [
            'clientY',
            0
        ],
        [
            'ctrlKey',
            !1
        ],
        [
            'altKey',
            !1
        ],
        [
            'shiftKey',
            !1
        ],
        [
            'metaKey',
            !1
        ],
        [
            'button',
            0
        ],
        [
            'relatedTarget',
            null
        ],
        [
            'buttons',
            0
        ],
        [
            'pointerId',
            0
        ],
        [
            'width',
            0
        ],
        [
            'height',
            0
        ],
        [
            'pressure',
            0
        ],
        [
            'tiltX',
            0
        ],
        [
            'tiltY',
            0
        ],
        [
            'pointerType',
            ''
        ],
        [
            'hwTimestamp',
            0
        ],
        [
            'isPrimary',
            !1
        ],
        [
            'type',
            ''
        ],
        [
            'target',
            null
        ],
        [
            'currentTarget',
            null
        ],
        [
            'which',
            0
        ]
    ];
    function be(a, b) {
        Sc.call(this);
        this.g = a;
        this.j = 0;
        this.l = !1;
        this.i = [];
        this.D = b ? b * nd : nd;
        this.c = null;
        a = this.g.a;
        this.N = 0;
        this.o = {};
        this.f = new Xd(a);
        this.a = null;
        this.s = y(this.f, 'pointerdown', this.pm, this);
        this.v = y(this.f, 'pointermove', this.mq, this);
    }
    w(be, Sc);
    function ce(a, b) {
        var c = new Ad('click', a.g, b);
        a.b(c);
        0 !== a.j ? (clearTimeout(a.j), a.j = 0, c = new Ad('dblclick', a.g, b), a.b(c)) : a.j = setTimeout(function () {
            this.j = 0;
            var a = new Ad('singleclick', this.g, b);
            this.b(a);
        }.bind(a), 250);
    }
    function de(a, b) {
        'pointerup' == b.type || 'pointercancel' == b.type ? delete a.o[b.pointerId] : 'pointerdown' == b.type && (a.o[b.pointerId] = !0);
        a.N = Object.keys(a.o).length;
    }
    k = be.prototype;
    k.ci = function (a) {
        de(this, a);
        var b = new Ad('pointerup', this.g, a);
        this.b(b);
        b.sj || this.l || 0 !== a.button || ce(this, this.c);
        0 === this.N && (this.i.forEach(Gc), this.i.length = 0, this.l = !1, this.c = null, Pc(this.a), this.a = null);
    };
    k.pm = function (a) {
        de(this, a);
        var b = new Ad('pointerdown', this.g, a);
        this.b(b);
        this.c = a;
        0 === this.i.length && (this.a = new Xd(document), this.i.push(y(this.a, 'pointermove', this.mn, this), y(this.a, 'pointerup', this.ci, this), y(this.f, 'pointercancel', this.ci, this)));
    };
    k.mn = function (a) {
        if (fe(this, a)) {
            this.l = !0;
            var b = new Ad('pointerdrag', this.g, a, this.l);
            this.b(b);
        }
        a.preventDefault();
    };
    k.mq = function (a) {
        this.b(new Ad(a.type, this.g, a, !(!this.c || !fe(this, a))));
    };
    function fe(a, b) {
        return Math.abs(b.clientX - a.c.clientX) > a.D || Math.abs(b.clientY - a.c.clientY) > a.D;
    }
    k.ia = function () {
        this.v && (Gc(this.v), this.v = null);
        this.s && (Gc(this.s), this.s = null);
        this.i.forEach(Gc);
        this.i.length = 0;
        this.a && (Pc(this.a), this.a = null);
        this.f && (Pc(this.f), this.f = null);
        Sc.prototype.ia.call(this);
    };
    function ge(a, b) {
        this.s = a;
        this.c = b;
        this.b = [];
        this.g = [];
        this.a = {};
    }
    ge.prototype.clear = function () {
        this.b.length = 0;
        this.g.length = 0;
        lb(this.a);
    };
    function he(a) {
        var b = a.b, c = a.g, d = b[0];
        1 == b.length ? (b.length = 0, c.length = 0) : (b[0] = b.pop(), c[0] = c.pop(), ie(a, 0));
        b = a.c(d);
        delete a.a[b];
        return d;
    }
    ge.prototype.i = function (a) {
        oa(!(this.c(a) in this.a), 31);
        var b = this.s(a);
        return Infinity != b ? (this.b.push(a), this.g.push(b), this.a[this.c(a)] = !0, je(this, 0, this.b.length - 1), !0) : !1;
    };
    function ie(a, b) {
        for (var c = a.b, d = a.g, e = c.length, f = c[b], g = d[b], h = b; b < e >> 1;) {
            var l = 2 * b + 1, m = 2 * b + 2;
            l = m < e && d[m] < d[l] ? m : l;
            c[b] = c[l];
            d[b] = d[l];
            b = l;
        }
        c[b] = f;
        d[b] = g;
        je(a, h, b);
    }
    function je(a, b, c) {
        var d = a.b;
        a = a.g;
        for (var e = d[c], f = a[c]; c > b;) {
            var g = c - 1 >> 1;
            if (a[g] > f)
                d[c] = d[g], a[c] = a[g], c = g;
            else
                break;
        }
        d[c] = e;
        a[c] = f;
    }
    function ke(a) {
        var b = a.s, c = a.b, d = a.g, e = 0, f = c.length, g;
        for (g = 0; g < f; ++g) {
            var h = c[g];
            var l = b(h);
            Infinity == l ? delete a.a[a.c(h)] : (d[e] = l, c[e++] = h);
        }
        c.length = e;
        d.length = e;
        for (b = (a.b.length >> 1) - 1; 0 <= b; b--)
            ie(a, b);
    }
    function le(a, b) {
        ge.call(this, function (b) {
            return a.apply(null, b);
        }, function (a) {
            return a[0].lb();
        });
        this.v = b;
        this.j = 0;
        this.f = {};
    }
    w(le, ge);
    le.prototype.i = function (a) {
        var b = ge.prototype.i.call(this, a);
        b && y(a[0], 'change', this.l, this);
        return b;
    };
    le.prototype.l = function (a) {
        a = a.target;
        var b = a.getState();
        if (2 === b || 3 === b || 4 === b || 5 === b)
            Mc(a, 'change', this.l, this), a = a.lb(), a in this.f && (delete this.f[a], --this.j), this.v();
    };
    function me(a, b, c) {
        for (var d = 0, e = !1, f, g, h; a.j < b && d < c && 0 < a.b.length;)
            g = he(a)[0], h = g.lb(), f = g.getState(), 5 === f ? e = !0 : 0 !== f || h in a.f || (a.f[h] = !0, ++a.j, ++d, g.load());
        0 === d && e && a.v();
    }
    function ne(a) {
        return function (b) {
            if (b)
                return [
                    pa(b[0], a[0], a[2]),
                    pa(b[1], a[1], a[3])
                ];
        };
    }
    function oe(a) {
        return a;
    }
    function pe(a) {
        return function (b, c, d) {
            if (void 0 !== b)
                return b = fc(a, b, d), b = pa(b + c, 0, a.length - 1), c = Math.floor(b), b != c && c < a.length - 1 ? a[c] / Math.pow(a[c] / a[c + 1], b - c) : a[c];
        };
    }
    function qe(a, b, c) {
        return function (d, e, f) {
            if (void 0 !== d)
                return d = Math.max(Math.floor(Math.log(b / d) / Math.log(a) + (-f / 2 + 0.5)) + e, 0), void 0 !== c && (d = Math.min(d, c)), b / Math.pow(a, d);
        };
    }
    function re(a) {
        if (void 0 !== a)
            return 0;
    }
    function se(a, b) {
        if (void 0 !== a)
            return a + b;
    }
    function ue(a) {
        var b = 2 * Math.PI / a;
        return function (a, d) {
            if (void 0 !== a)
                return a = Math.floor((a + d) / b + 0.5) * b;
        };
    }
    function we() {
        var a = va(5);
        return function (b, c) {
            if (void 0 !== b)
                return Math.abs(b + c) <= a ? 0 : b + c;
        };
    }
    function xe(a, b) {
        a = void 0 !== b ? a.toFixed(b) : '' + a;
        b = a.indexOf('.');
        b = -1 === b ? a.length : b;
        return 2 < b ? a : Array(3 - b).join('0') + a;
    }
    function ye(a) {
        a = ('' + a).split('.');
        for (var b = [
                    '1',
                    '3'
                ], c = 0; c < Math.max(a.length, b.length); c++) {
            var d = parseInt(a[c] || '0', 10), e = parseInt(b[c] || '0', 10);
            if (d > e)
                return 1;
            if (e > d)
                return -1;
        }
        return 0;
    }
    function ze(a, b) {
        a[0] += b[0];
        a[1] += b[1];
        return a;
    }
    function Ae(a, b) {
        var c = b.Bd(), d = b.xa();
        b = d[0];
        d = d[1];
        var e = a[0] - b;
        a = a[1] - d;
        0 === e && 0 === a && (e = 1);
        var f = Math.sqrt(e * e + a * a);
        return [
            b + c * e / f,
            d + c * a / f
        ];
    }
    function Be(a, b) {
        var c = a[0];
        a = a[1];
        var d = b[0], e = b[1];
        b = d[0];
        d = d[1];
        var f = e[0];
        e = e[1];
        var g = f - b, h = e - d;
        c = 0 === g && 0 === h ? 0 : (g * (c - b) + h * (a - d)) / (g * g + h * h || 0);
        0 >= c ? (a = b, c = d) : 1 <= c ? (a = f, c = e) : (a = b + c * g, c = d + c * h);
        return [
            a,
            c
        ];
    }
    function Ce(a, b, c) {
        b = wa(b + 180, 360) - 180;
        var d = Math.abs(3600 * b);
        c = c || 0;
        var e = Math.pow(10, c), f = Math.floor(d / 3600), g = Math.floor((d - 3600 * f) / 60);
        d = Math.ceil((d - 3600 * f - 60 * g) * e) / e;
        60 <= d && (d = 0, g += 1);
        60 <= g && (g = 0, f += 1);
        return f + '\xB0 ' + xe(g) + '\u2032 ' + xe(d, c) + '\u2033' + (0 == b ? '' : ' ' + a.charAt(0 > b ? 1 : 0));
    }
    function De(a, b, c) {
        return a ? b.replace('{x}', a[0].toFixed(c)).replace('{y}', a[1].toFixed(c)) : '';
    }
    function Ee(a, b) {
        for (var c = !0, d = a.length - 1; 0 <= d; --d)
            if (a[d] != b[d]) {
                c = !1;
                break;
            }
        return c;
    }
    function Fe(a, b) {
        var c = Math.cos(b);
        b = Math.sin(b);
        var d = a[1] * c + a[0] * b;
        a[0] = a[0] * c - a[1] * b;
        a[1] = d;
        return a;
    }
    function Ge(a, b) {
        a[0] *= b;
        a[1] *= b;
    }
    function He(a, b) {
        var c = a[0] - b[0];
        a = a[1] - b[1];
        return c * c + a * a;
    }
    function Ie(a, b) {
        return Math.sqrt(He(a, b));
    }
    function Je(a, b) {
        return He(a, Be(a, b));
    }
    function Ke(a, b) {
        return De(a, '{x}, {y}', b);
    }
    function Me(a) {
        return Math.pow(a, 3);
    }
    function Oe(a) {
        return 1 - Me(1 - a);
    }
    function Pe(a) {
        return 3 * a * a - 2 * a * a * a;
    }
    function Qe(a) {
        return a;
    }
    function Re() {
        return !0;
    }
    function Se() {
        return !1;
    }
    function Te(a, b, c, d, e, f) {
        for (var g = f ? f : [], h = 0; b < c; b += d) {
            var l = a[b], m = a[b + 1];
            g[h++] = e[0] * l + e[2] * m + e[4];
            g[h++] = e[1] * l + e[3] * m + e[5];
        }
        f && g.length != h && (g.length = h);
        return g;
    }
    function Ue(a, b, c, d, e, f, g) {
        for (var h = g ? g : [], l = 0, m; b < c; b += d)
            for (h[l++] = a[b] + e, h[l++] = a[b + 1] + f, m = b + 2; m < b + d; ++m)
                h[l++] = a[m];
        g && h.length != l && (h.length = l);
        return h;
    }
    var Ve = Array(6);
    function We() {
        return [
            1,
            0,
            0,
            1,
            0,
            0
        ];
    }
    function Xe(a) {
        return Ye(a, 1, 0, 0, 1, 0, 0);
    }
    function Ze(a, b) {
        var c = a[0], d = a[1], e = a[2], f = a[3], g = a[4], h = a[5], l = b[0], m = b[1], n = b[2], p = b[3], q = b[4];
        b = b[5];
        a[0] = c * l + e * m;
        a[1] = d * l + f * m;
        a[2] = c * n + e * p;
        a[3] = d * n + f * p;
        a[4] = c * q + e * b + g;
        a[5] = d * q + f * b + h;
        return a;
    }
    function Ye(a, b, c, d, e, f, g) {
        a[0] = b;
        a[1] = c;
        a[2] = d;
        a[3] = e;
        a[4] = f;
        a[5] = g;
        return a;
    }
    function $e(a, b) {
        a[0] = b[0];
        a[1] = b[1];
        a[2] = b[2];
        a[3] = b[3];
        a[4] = b[4];
        a[5] = b[5];
        return a;
    }
    function af(a, b) {
        var c = b[0], d = b[1];
        b[0] = a[0] * c + a[2] * d + a[4];
        b[1] = a[1] * c + a[3] * d + a[5];
        return b;
    }
    function bf(a, b) {
        var c = Math.cos(b);
        b = Math.sin(b);
        Ze(a, Ye(Ve, c, b, -b, c, 0, 0));
    }
    function cf(a, b, c) {
        return Ze(a, Ye(Ve, b, 0, 0, c, 0, 0));
    }
    function df(a, b, c) {
        Ze(a, Ye(Ve, 1, 0, 0, 1, b, c));
    }
    function ef(a, b, c, d, e, f, g, h) {
        var l = Math.sin(f);
        f = Math.cos(f);
        a[0] = d * f;
        a[1] = e * l;
        a[2] = -d * l;
        a[3] = e * f;
        a[4] = g * d * f - h * d * l + b;
        a[5] = g * e * l + h * e * f + c;
        return a;
    }
    function ff(a) {
        var b = a[0] * a[3] - a[1] * a[2];
        oa(0 !== b, 32);
        var c = a[0], d = a[1], e = a[2], f = a[3], g = a[4], h = a[5];
        a[0] = f / b;
        a[1] = -d / b;
        a[2] = -e / b;
        a[3] = c / b;
        a[4] = (e * h - f * g) / b;
        a[5] = -(c * h - d * g) / b;
        return a;
    }
    function gf() {
        Vc.call(this);
        this.s = Da();
        this.v = -1;
        this.i = {};
        this.l = this.f = 0;
        this.O = We();
    }
    w(gf, Vc);
    k = gf.prototype;
    k.Ib = function (a, b) {
        b = b ? b : [
            NaN,
            NaN
        ];
        this.Nb(a[0], a[1], b, Infinity);
        return b;
    };
    k.Bb = function (a) {
        return this.Zc(a[0], a[1]);
    };
    k.Zc = Se;
    k.G = function (a) {
        this.v != this.g && (this.s = this.Ae(this.s), this.v = this.g);
        var b = this.s;
        a ? (a[0] = b[0], a[1] = b[1], a[2] = b[2], a[3] = b[3]) : a = b;
        return a;
    };
    k.Sb = function (a) {
        return this.Wd(a * a);
    };
    k.mb = function (a, b) {
        var c = this.O;
        a = Ob(a);
        var d = 'tile-pixels' == a.a ? function (d, f, g) {
            var e = a.G(), l = a.oe;
            e = db(l) / db(e);
            ef(c, l[0], l[3], e, -e, 0, 0, 0);
            Te(d, 0, d.length, g, c, f);
            return Yb(a, b)(d, f, g);
        } : Yb(a, b);
        this.Rc(d);
        return this;
    };
    function hf() {
        gf.call(this);
        this.ja = 'XY';
        this.a = 2;
        this.A = null;
    }
    w(hf, gf);
    function jf(a) {
        var b;
        'XY' == a ? b = 2 : 'XYZ' == a || 'XYM' == a ? b = 3 : 'XYZM' == a && (b = 4);
        return b;
    }
    k = hf.prototype;
    k.Zc = Se;
    k.Ae = function (a) {
        return Qa(this.A, 0, this.A.length, this.a, a);
    };
    k.fc = function () {
        return this.A.slice(0, this.a);
    };
    k.da = function () {
        return this.A;
    };
    k.gc = function () {
        return this.A.slice(this.A.length - this.a);
    };
    k.ic = function () {
        return this.ja;
    };
    k.Wd = function (a) {
        this.l != this.g && (lb(this.i), this.f = 0, this.l = this.g);
        if (0 > a || 0 !== this.f && a <= this.f)
            return this;
        var b = a.toString();
        if (this.i.hasOwnProperty(b))
            return this.i[b];
        var c = this.xd(a);
        if (c.da().length < this.A.length)
            return this.i[b] = c;
        this.f = a;
        return this;
    };
    k.xd = function () {
        return this;
    };
    k.pa = function () {
        return this.a;
    };
    function kf(a, b, c) {
        a.a = jf(b);
        a.ja = b;
        a.A = c;
    }
    function lf(a, b, c, d) {
        if (b)
            c = jf(b);
        else {
            for (b = 0; b < d; ++b) {
                if (0 === c.length) {
                    a.ja = 'XY';
                    a.a = 2;
                    return;
                }
                c = c[0];
            }
            c = c.length;
            var e;
            2 == c ? e = 'XY' : 3 == c ? e = 'XYZ' : 4 == c && (e = 'XYZM');
            b = e;
        }
        a.ja = b;
        a.a = c;
    }
    k.Rc = function (a) {
        this.A && (a(this.A, this.A, this.a), this.u());
    };
    k.rotate = function (a, b) {
        var c = this.da();
        if (c) {
            var d = c.length, e = this.pa(), f = c ? c : [], g = Math.cos(a);
            a = Math.sin(a);
            var h = b[0];
            b = b[1];
            for (var l = 0, m = 0; m < d; m += e) {
                var n = c[m] - h, p = c[m + 1] - b;
                f[l++] = h + n * g - p * a;
                f[l++] = b + n * a + p * g;
                for (n = m + 2; n < m + e; ++n)
                    f[l++] = c[n];
            }
            c && f.length != l && (f.length = l);
            this.u();
        }
    };
    k.scale = function (a, b, c) {
        var d = b;
        void 0 === d && (d = a);
        var e = c;
        e || (e = eb(this.G()));
        if (c = this.da()) {
            b = c.length;
            var f = this.pa(), g = c ? c : [], h = e[0];
            e = e[1];
            for (var l = 0, m = 0; m < b; m += f) {
                var n = c[m] - h, p = c[m + 1] - e;
                g[l++] = h + a * n;
                g[l++] = e + d * p;
                for (n = m + 2; n < m + f; ++n)
                    g[l++] = c[n];
            }
            c && g.length != l && (g.length = l);
            this.u();
        }
    };
    k.translate = function (a, b) {
        var c = this.da();
        c && (Ue(c, 0, c.length, this.pa(), a, b, c), this.u());
    };
    function mf(a, b, c, d) {
        for (var e = 0, f = a[c - d], g = a[c - d + 1]; b < c; b += d) {
            var h = a[b], l = a[b + 1];
            e += g * h - f * l;
            f = h;
            g = l;
        }
        return e / 2;
    }
    function nf(a, b, c, d) {
        var e = 0, f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var h = c[g];
            e += mf(a, b, h, d);
            b = h;
        }
        return e;
    }
    function of(a, b, c, d, e, f, g) {
        var h = a[b], l = a[b + 1], m = a[c] - h, n = a[c + 1] - l;
        if (0 !== m || 0 !== n)
            if (f = ((e - h) * m + (f - l) * n) / (m * m + n * n), 1 < f)
                b = c;
            else if (0 < f) {
                for (e = 0; e < d; ++e)
                    g[e] = ya(a[b + e], a[c + e], f);
                g.length = d;
                return;
            }
        for (e = 0; e < d; ++e)
            g[e] = a[b + e];
        g.length = d;
    }
    function pf(a, b, c, d, e) {
        var f = a[b], g = a[b + 1];
        for (b += d; b < c; b += d) {
            var h = a[b], l = a[b + 1];
            f = ua(f, g, h, l);
            f > e && (e = f);
            f = h;
            g = l;
        }
        return e;
    }
    function qf(a, b, c, d, e) {
        var f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var h = c[g];
            e = pf(a, b, h, d, e);
            b = h;
        }
        return e;
    }
    function tf(a, b, c, d, e, f, g, h, l, m, n) {
        if (b == c)
            return m;
        if (0 === e) {
            var p = ua(g, h, a[b], a[b + 1]);
            if (p < m) {
                for (n = 0; n < d; ++n)
                    l[n] = a[b + n];
                l.length = d;
                return p;
            }
            return m;
        }
        for (var q = n ? n : [
                    NaN,
                    NaN
                ], r = b + d; r < c;)
            if (of(a, r - d, r, d, g, h, q), p = ua(g, h, q[0], q[1]), p < m) {
                m = p;
                for (n = 0; n < d; ++n)
                    l[n] = q[n];
                l.length = d;
                r += d;
            } else
                r += d * Math.max((Math.sqrt(p) - Math.sqrt(m)) / e | 0, 1);
        if (f && (of(a, c - d, b, d, g, h, q), p = ua(g, h, q[0], q[1]), p < m)) {
            m = p;
            for (n = 0; n < d; ++n)
                l[n] = q[n];
            l.length = d;
        }
        return m;
    }
    function uf(a, b, c, d, e, f, g, h, l, m, n) {
        n = n ? n : [
            NaN,
            NaN
        ];
        var p;
        var q = 0;
        for (p = c.length; q < p; ++q) {
            var r = c[q];
            m = tf(a, b, r, d, e, f, g, h, l, m, n);
            b = r;
        }
        return m;
    }
    function vf(a, b) {
        var c = 0, d;
        var e = 0;
        for (d = b.length; e < d; ++e)
            a[c++] = b[e];
        return c;
    }
    function wf(a, b, c, d) {
        var e;
        var f = 0;
        for (e = c.length; f < e; ++f) {
            var g = c[f], h;
            for (h = 0; h < d; ++h)
                a[b++] = g[h];
        }
        return b;
    }
    function xf(a, b, c, d, e) {
        e = e ? e : [];
        var f = 0, g;
        var h = 0;
        for (g = c.length; h < g; ++h)
            b = wf(a, b, c[h], d), e[f++] = b;
        e.length = f;
        return e;
    }
    function yf(a, b, c, d, e) {
        e = void 0 !== e ? e : [];
        for (var f = 0; b < c; b += d)
            e[f++] = a.slice(b, b + d);
        e.length = f;
        return e;
    }
    function zf(a, b, c, d, e) {
        e = void 0 !== e ? e : [];
        var f = 0, g;
        var h = 0;
        for (g = c.length; h < g; ++h) {
            var l = c[h];
            e[f++] = yf(a, b, l, d, e[f]);
            b = l;
        }
        e.length = f;
        return e;
    }
    function Af(a, b, c, d, e) {
        e = void 0 !== e ? e : [];
        var f = 0, g;
        var h = 0;
        for (g = c.length; h < g; ++h) {
            var l = c[h];
            e[f++] = zf(a, b, l, d, e[f]);
            b = l[l.length - 1];
        }
        e.length = f;
        return e;
    }
    function Bf(a, b, c, d, e, f, g) {
        var h = (c - b) / d;
        if (3 > h) {
            for (; b < c; b += d)
                f[g++] = a[b], f[g++] = a[b + 1];
            return g;
        }
        var l = Array(h);
        l[0] = 1;
        l[h - 1] = 1;
        c = [
            b,
            c - d
        ];
        for (var m = 0, n; 0 < c.length;) {
            var p = c.pop(), q = c.pop(), r = 0, u = a[q], v = a[q + 1], z = a[p], A = a[p + 1];
            for (n = q + d; n < p; n += d) {
                var E = sa(a[n], a[n + 1], u, v, z, A);
                E > r && (m = n, r = E);
            }
            r > e && (l[(m - b) / d] = 1, q + d < m && c.push(q, m), m + d < p && c.push(m, p));
        }
        for (n = 0; n < h; ++n)
            l[n] && (f[g++] = a[b + n * d], f[g++] = a[b + n * d + 1]);
        return g;
    }
    function Cf(a, b, c, d, e, f, g, h) {
        var l;
        var m = 0;
        for (l = c.length; m < l; ++m) {
            var n = c[m];
            a: {
                var p = a, q = n, r = d, u = e, v = f, z = g;
                if (b != q) {
                    var A = u * Math.round(p[b] / u), E = u * Math.round(p[b + 1] / u);
                    b += r;
                    v[z++] = A;
                    v[z++] = E;
                    do {
                        var S = u * Math.round(p[b] / u);
                        g = u * Math.round(p[b + 1] / u);
                        b += r;
                        if (b == q) {
                            v[z++] = S;
                            v[z++] = g;
                            g = z;
                            break a;
                        }
                    } while (S == A && g == E);
                    for (; b < q;) {
                        var Ia = u * Math.round(p[b] / u);
                        var ta = u * Math.round(p[b + 1] / u);
                        b += r;
                        if (Ia != S || ta != g) {
                            var la = S - A, ca = g - E, ia = Ia - A, xa = ta - E;
                            la * xa == ca * ia && (0 > la && ia < la || la == ia || 0 < la && ia > la) && (0 > ca && xa < ca || ca == xa || 0 < ca && xa > ca) || (v[z++] = S, v[z++] = g, A = S, E = g);
                            S = Ia;
                            g = ta;
                        }
                    }
                    v[z++] = S;
                    v[z++] = g;
                }
                g = z;
            }
            h.push(g);
            b = n;
        }
        return g;
    }
    function Df(a, b) {
        hf.call(this);
        this.c = this.j = -1;
        this.na(a, b);
    }
    w(Df, hf);
    k = Df.prototype;
    k.clone = function () {
        var a = new Df(null);
        Ef(a, this.ja, this.A.slice());
        return a;
    };
    k.Nb = function (a, b, c, d) {
        if (d < Ha(this.G(), a, b))
            return d;
        this.c != this.g && (this.j = Math.sqrt(pf(this.A, 0, this.A.length, this.a, 0)), this.c = this.g);
        return tf(this.A, 0, this.A.length, this.a, this.j, !0, a, b, c, d);
    };
    k.Vn = function () {
        return mf(this.A, 0, this.A.length, this.a);
    };
    k.W = function () {
        return yf(this.A, 0, this.A.length, this.a);
    };
    k.xd = function (a) {
        var b = [];
        b.length = Bf(this.A, 0, this.A.length, this.a, a, b, 0);
        a = new Df(null);
        Ef(a, 'XY', b);
        return a;
    };
    k.S = function () {
        return 'LinearRing';
    };
    k.$a = function () {
    };
    k.na = function (a, b) {
        a ? (lf(this, b, a, 1), this.A || (this.A = []), this.A.length = wf(this.A, 0, a, this.a), this.u()) : Ef(this, 'XY', null);
    };
    function Ef(a, b, c) {
        kf(a, b, c);
        a.u();
    }
    function C(a, b) {
        hf.call(this);
        this.na(a, b);
    }
    w(C, hf);
    k = C.prototype;
    k.clone = function () {
        var a = new C(null);
        a.ba(this.ja, this.A.slice());
        return a;
    };
    k.Nb = function (a, b, c, d) {
        var e = this.A;
        a = ua(a, b, e[0], e[1]);
        if (a < d) {
            d = this.a;
            for (b = 0; b < d; ++b)
                c[b] = e[b];
            c.length = d;
            return a;
        }
        return d;
    };
    k.W = function () {
        return this.A ? this.A.slice() : [];
    };
    k.Ae = function (a) {
        return Pa(this.A, a);
    };
    k.S = function () {
        return 'Point';
    };
    k.$a = function (a) {
        return Ka(a, this.A[0], this.A[1]);
    };
    k.na = function (a, b) {
        a ? (lf(this, b, a, 0), this.A || (this.A = []), this.A.length = vf(this.A, a), this.u()) : this.ba('XY', null);
    };
    k.ba = function (a, b) {
        kf(this, a, b);
        this.u();
    };
    function Ff(a, b, c, d, e) {
        return !Ua(e, function (e) {
            return !Gf(a, b, c, d, e[0], e[1]);
        });
    }
    function Gf(a, b, c, d, e, f) {
        for (var g = 0, h = a[c - d], l = a[c - d + 1]; b < c; b += d) {
            var m = a[b], n = a[b + 1];
            l <= f ? n > f && 0 < (m - h) * (f - l) - (e - h) * (n - l) && g++ : n <= f && 0 > (m - h) * (f - l) - (e - h) * (n - l) && g--;
            h = m;
            l = n;
        }
        return 0 !== g;
    }
    function Hf(a, b, c, d, e, f) {
        if (0 === c.length || !Gf(a, b, c[0], d, e, f))
            return !1;
        var g;
        b = 1;
        for (g = c.length; b < g; ++b)
            if (Gf(a, c[b - 1], c[b], d, e, f))
                return !1;
        return !0;
    }
    function If(a, b, c, d, e, f, g) {
        for (var h, l, m, n, p, q = e[f + 1], r = [], u = 0, v = c.length; u < v; ++u) {
            var z = c[u];
            m = a[z - d];
            p = a[z - d + 1];
            for (h = b; h < z; h += d) {
                n = a[h];
                l = a[h + 1];
                if (q <= p && l <= q || p <= q && q <= l)
                    m = (q - p) / (l - p) * (n - m) + m, r.push(m);
                m = n;
                p = l;
            }
        }
        u = NaN;
        v = -Infinity;
        r.sort(dc);
        m = r[0];
        h = 1;
        for (l = r.length; h < l; ++h)
            n = r[h], z = Math.abs(n - m), z > v && (m = (m + n) / 2, Hf(a, b, c, d, m, q) && (u = m, v = z)), m = n;
        isNaN(u) && (u = e[f]);
        return g ? (g.push(u, q, v), g) : [
            u,
            q,
            v
        ];
    }
    function Jf(a, b, c, d, e, f) {
        for (var g = [
                    a[b],
                    a[b + 1]
                ], h = [], l; b + d < c; b += d) {
            h[0] = a[b + d];
            h[1] = a[b + d + 1];
            if (l = e.call(f, g, h))
                return l;
            g[0] = h[0];
            g[1] = h[1];
        }
        return !1;
    }
    function Kf(a, b, c, d, e) {
        var f = Ra(Da(), a, b, c, d);
        return hb(e, f) ? La(e, f) || f[0] >= e[0] && f[2] <= e[2] || f[1] >= e[1] && f[3] <= e[3] ? !0 : Jf(a, b, c, d, function (a, b) {
            var c = !1, d = Ma(e, a), f = Ma(e, b);
            if (1 === d || 1 === f)
                c = !0;
            else {
                var g = e[0], h = e[1], r = e[2], u = e[3], v = b[0];
                b = b[1];
                a = (b - a[1]) / (v - a[0]);
                f & 2 && !(d & 2) && (c = v - (b - u) / a, c = c >= g && c <= r);
                c || !(f & 4) || d & 4 || (c = b - (v - r) * a, c = c >= h && c <= u);
                c || !(f & 8) || d & 8 || (c = v - (b - h) / a, c = c >= g && c <= r);
                c || !(f & 16) || d & 16 || (c = b - (v - g) * a, c = c >= h && c <= u);
            }
            return c;
        }) : !1;
    }
    function Lf(a, b, c, d, e) {
        var f = c[0];
        if (!(Kf(a, b, f, d, e) || Gf(a, b, f, d, e[0], e[1]) || Gf(a, b, f, d, e[0], e[3]) || Gf(a, b, f, d, e[2], e[1]) || Gf(a, b, f, d, e[2], e[3])))
            return !1;
        if (1 === c.length)
            return !0;
        b = 1;
        for (f = c.length; b < f; ++b)
            if (Ff(a, c[b - 1], c[b], d, e))
                return !1;
        return !0;
    }
    function Mf(a, b, c, d) {
        for (var e = 0, f = a[c - d], g = a[c - d + 1]; b < c; b += d) {
            var h = a[b], l = a[b + 1];
            e += (h - f) * (l + g);
            f = h;
            g = l;
        }
        return 0 < e;
    }
    function Nf(a, b, c, d) {
        var e = 0;
        d = void 0 !== d ? d : !1;
        var f;
        var g = 0;
        for (f = b.length; g < f; ++g) {
            var h = b[g];
            e = Mf(a, e, h, c);
            if (0 === g) {
                if (d && e || !d && !e)
                    return !1;
            } else if (d && !e || !d && e)
                return !1;
            e = h;
        }
        return !0;
    }
    function Of(a, b, c, d, e) {
        e = void 0 !== e ? e : !1;
        var f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var h = c[g], l = Mf(a, b, h, d);
            if (0 === g ? e && l || !e && !l : e && !l || !e && l) {
                l = a;
                for (var m = h, n = d; b < m - n;) {
                    var p;
                    for (p = 0; p < n; ++p) {
                        var q = l[b + p];
                        l[b + p] = l[m - n + p];
                        l[m - n + p] = q;
                    }
                    b += n;
                    m -= n;
                }
            }
            b = h;
        }
        return b;
    }
    function Pf(a, b, c, d) {
        var e = 0, f;
        var g = 0;
        for (f = b.length; g < f; ++g)
            e = Of(a, e, b[g], c, d);
        return e;
    }
    function D(a, b) {
        hf.call(this);
        this.c = [];
        this.o = -1;
        this.D = null;
        this.T = this.C = this.B = -1;
        this.j = null;
        this.na(a, b);
    }
    w(D, hf);
    k = D.prototype;
    k.Hk = function (a) {
        this.A ? gc(this.A, a.da()) : this.A = a.da().slice();
        this.c.push(this.A.length);
        this.u();
    };
    k.clone = function () {
        var a = new D(null);
        a.ba(this.ja, this.A.slice(), this.c.slice());
        return a;
    };
    k.Nb = function (a, b, c, d) {
        if (d < Ha(this.G(), a, b))
            return d;
        this.C != this.g && (this.B = Math.sqrt(qf(this.A, 0, this.c, this.a, 0)), this.C = this.g);
        return uf(this.A, 0, this.c, this.a, this.B, !0, a, b, c, d);
    };
    k.Zc = function (a, b) {
        return Hf(this.Xb(), 0, this.c, this.a, a, b);
    };
    k.Yn = function () {
        return nf(this.Xb(), 0, this.c, this.a);
    };
    k.W = function (a) {
        if (void 0 !== a) {
            var b = this.Xb().slice();
            Of(b, 0, this.c, this.a, a);
        } else
            b = this.A;
        return zf(b, 0, this.c, this.a);
    };
    k.pb = function () {
        return this.c;
    };
    k.Td = function () {
        if (this.o != this.g) {
            var a = eb(this.G());
            this.D = If(this.Xb(), 0, this.c, this.a, a, 0);
            this.o = this.g;
        }
        return this.D;
    };
    k.tl = function () {
        return new C(this.Td(), 'XYM');
    };
    k.zl = function () {
        return this.c.length;
    };
    k.Wh = function (a) {
        if (0 > a || this.c.length <= a)
            return null;
        var b = new Df(null);
        Ef(b, this.ja, this.A.slice(0 === a ? 0 : this.c[a - 1], this.c[a]));
        return b;
    };
    k.Ud = function () {
        var a = this.ja, b = this.A, c = this.c, d = [], e = 0, f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var h = c[g], l = new Df(null);
            Ef(l, a, b.slice(e, h));
            d.push(l);
            e = h;
        }
        return d;
    };
    k.Xb = function () {
        if (this.T != this.g) {
            var a = this.A;
            Nf(a, this.c, this.a) ? this.j = a : (this.j = a.slice(), this.j.length = Of(this.j, 0, this.c, this.a));
            this.T = this.g;
        }
        return this.j;
    };
    k.xd = function (a) {
        var b = [], c = [];
        b.length = Cf(this.A, 0, this.c, this.a, Math.sqrt(a), b, 0, c);
        a = new D(null);
        a.ba('XY', b, c);
        return a;
    };
    k.S = function () {
        return 'Polygon';
    };
    k.$a = function (a) {
        return Lf(this.Xb(), 0, this.c, this.a, a);
    };
    k.na = function (a, b) {
        a ? (lf(this, b, a, 2), this.A || (this.A = []), a = xf(this.A, 0, a, this.a, this.c), this.A.length = 0 === a.length ? 0 : a[a.length - 1], this.u()) : this.ba('XY', null, this.c);
    };
    k.ba = function (a, b, c) {
        kf(this, a, b);
        this.c = c;
        this.u();
    };
    function Qf(a, b, c, d) {
        var e = d ? d : 32;
        d = [];
        var f;
        for (f = 0; f < e; ++f)
            gc(d, a.offset(b, c, 2 * Math.PI * f / e));
        d.push(d[0], d[1]);
        a = new D(null);
        a.ba('XY', d, [d.length]);
        return a;
    }
    function Rf(a) {
        var b = a[0], c = a[1], d = a[2];
        a = a[3];
        b = [
            b,
            c,
            b,
            a,
            d,
            a,
            d,
            c,
            b,
            c
        ];
        c = new D(null);
        c.ba('XY', b, [b.length]);
        return c;
    }
    function Sf(a, b, c) {
        var d = b ? b : 32, e = a.pa();
        b = a.ja;
        var f = new D(null, b);
        d = e * (d + 1);
        e = Array(d);
        for (var g = 0; g < d; g++)
            e[g] = 0;
        f.ba(b, e, [e.length]);
        Tf(f, a.xa(), a.Bd(), c);
        return f;
    }
    function Tf(a, b, c, d) {
        var e = a.da(), f = a.ja, g = a.pa(), h = a.pb(), l = e.length / g - 1;
        d = d ? d : 0;
        for (var m, n, p = 0; p <= l; ++p)
            n = p * g, m = d + 2 * wa(p, l) * Math.PI / l, e[n] = b[0] + c * Math.cos(m), e[n + 1] = b[1] + c * Math.sin(m);
        a.ba(f, e, h);
    }
    function F(a) {
        Vc.call(this);
        a = kb({}, a);
        this.f = [
            0,
            0
        ];
        this.c = [];
        this.Ff = this.Ff.bind(this);
        this.v = Ub(a.projection);
        Vf(this, a);
    }
    w(F, Vc);
    function Vf(a, b) {
        var c = {};
        c.center = void 0 !== b.center ? b.center : null;
        var d = void 0 !== b.minZoom ? b.minZoom : 0;
        var e = void 0 !== b.maxZoom ? b.maxZoom : 28;
        var f = void 0 !== b.zoomFactor ? b.zoomFactor : 2;
        if (void 0 !== b.resolutions) {
            var g = b.resolutions;
            var h = g[d];
            var l = void 0 !== g[e] ? g[e] : g[g.length - 1];
            e = pe(g);
        } else {
            h = Ub(b.projection);
            l = h.G();
            g = (l ? Math.max(cb(l), db(l)) : 360 * ub.degrees / h.Bc()) / 256 / Math.pow(2, 0);
            var m = g / Math.pow(2, 28);
            h = b.maxResolution;
            void 0 !== h ? d = 0 : h = g / Math.pow(f, d);
            l = b.minResolution;
            void 0 === l && (l = void 0 !== b.maxZoom ? void 0 !== b.maxResolution ? h / Math.pow(f, e) : g / Math.pow(f, e) : m);
            e = d + Math.floor(Math.log(h / l) / Math.log(f));
            l = h / Math.pow(f, e - d);
            e = qe(f, h, e - d);
        }
        a.a = h;
        a.i = l;
        a.D = f;
        a.j = b.resolutions;
        a.s = d;
        (void 0 !== b.enableRotation ? b.enableRotation : 1) ? (d = b.constrainRotation, d = void 0 === d || !0 === d ? we() : !1 === d ? se : 'number' === typeof d ? ue(d) : se) : d = re;
        a.l = {
            center: void 0 !== b.extent ? ne(b.extent) : oe,
            resolution: e,
            rotation: d
        };
        void 0 !== b.resolution ? c.resolution = b.resolution : void 0 !== b.zoom && (c.resolution = a.constrainResolution(a.a, b.zoom - a.s), a.j && (c.resolution = pa(Number(a.Pa() || c.resolution), a.i, a.a)));
        c.rotation = void 0 !== b.rotation ? b.rotation : 0;
        a.H(c);
        a.C = b;
    }
    function $f(a, b) {
        var c = kb({}, a.C);
        void 0 !== c.resolution ? c.resolution = a.Pa() : c.zoom = a.lg();
        c.center = a.xa();
        c.rotation = a.Sa();
        return kb({}, c, b);
    }
    k = F.prototype;
    k.animate = function (a) {
        var b = arguments.length;
        if (1 < b && 'function' === typeof arguments[b - 1]) {
            var c = arguments[b - 1];
            --b;
        }
        if (ag(this)) {
            for (var d = Date.now(), e = this.xa().slice(), f = this.Pa(), g = this.Sa(), h = [], l = 0; l < b; ++l) {
                var m = arguments[l], n = {
                        start: d,
                        complete: !1,
                        anchor: m.anchor,
                        duration: void 0 !== m.duration ? m.duration : 1000,
                        easing: m.easing || Pe
                    };
                m.center && (n.ie = e, n.me = m.center, e = n.me);
                void 0 !== m.zoom ? (n.ke = f, n.kd = this.constrainResolution(this.a, m.zoom - this.s, 0), f = n.kd) : m.resolution && (n.ke = f, n.kd = m.resolution, f = n.kd);
                void 0 !== m.rotation && (n.Df = g, n.ne = g + (wa(m.rotation - g + Math.PI, 2 * Math.PI) - Math.PI), g = n.ne);
                n.callback = c;
                n.ie && n.me && !Ee(n.ie, n.me) || n.ke !== n.kd || n.Df !== n.ne ? d += n.duration : n.complete = !0;
                h.push(n);
            }
            this.c.push(h);
            bg(this, 0, 1);
            this.Ff();
        } else
            b = arguments[b - 1], b.center && this.ub(b.center), void 0 !== b.zoom && this.Tj(b.zoom), void 0 !== b.rotation && this.ce(b.rotation), c && c(!0);
    };
    k.Ac = function () {
        return 0 < this.f[0];
    };
    k.Vh = function () {
        return 0 < this.f[1];
    };
    k.rd = function () {
        bg(this, 0, -this.f[0]);
        for (var a = 0, b = this.c.length; a < b; ++a) {
            var c = this.c[a];
            c[0].callback && c[0].callback(!1);
        }
        this.c.length = 0;
    };
    k.Ff = function () {
        void 0 !== this.o && (cancelAnimationFrame(this.o), this.o = void 0);
        if (this.Ac()) {
            for (var a = Date.now(), b = !1, c = this.c.length - 1; 0 <= c; --c) {
                for (var d = this.c[c], e = !0, f = 0, g = d.length; f < g; ++f) {
                    var h = d[f];
                    if (!h.complete) {
                        b = a - h.start;
                        b = 0 < h.duration ? b / h.duration : 1;
                        1 <= b ? (h.complete = !0, b = 1) : e = !1;
                        b = h.easing(b);
                        if (h.ie) {
                            var l = h.ie[0], m = h.ie[1];
                            this.set('center', [
                                l + b * (h.me[0] - l),
                                m + b * (h.me[1] - m)
                            ]);
                        }
                        h.ke && h.kd && (l = 1 === b ? h.kd : h.ke + b * (h.kd - h.ke), h.anchor && this.set('center', cg(this, l, h.anchor)), this.set('resolution', l));
                        void 0 !== h.Df && void 0 !== h.ne && (b = 1 === b ? wa(h.ne + Math.PI, 2 * Math.PI) - Math.PI : h.Df + b * (h.ne - h.Df), h.anchor && this.set('center', dg(this, b, h.anchor)), this.set('rotation', b));
                        b = !0;
                        if (!h.complete)
                            break;
                    }
                }
                e && (this.c[c] = null, bg(this, 0, -1), (d = d[0].callback) && d(!0));
            }
            this.c = this.c.filter(Boolean);
            b && void 0 === this.o && (this.o = requestAnimationFrame(this.Ff));
        }
    };
    function dg(a, b, c) {
        var d = a.xa();
        if (void 0 !== d) {
            var e = [
                d[0] - c[0],
                d[1] - c[1]
            ];
            Fe(e, b - a.Sa());
            ze(e, c);
        }
        return e;
    }
    function cg(a, b, c) {
        var d, e = a.xa();
        a = a.Pa();
        void 0 !== e && void 0 !== a && (d = [
            c[0] - b * (c[0] - e[0]) / a,
            c[1] - b * (c[1] - e[1]) / a
        ]);
        return d;
    }
    function eg(a) {
        var b = [
            100,
            100
        ];
        a = '.ol-viewport[data-view="' + x(a) + '"]';
        if (a = document.querySelector(a))
            a = getComputedStyle(a), b[0] = parseInt(a.width, 10), b[1] = parseInt(a.height, 10);
        return b;
    }
    k.Sc = function (a) {
        return this.l.center(a);
    };
    k.constrainResolution = function (a, b, c) {
        return this.l.resolution(a, b || 0, c || 0);
    };
    k.constrainRotation = function (a, b) {
        return this.l.rotation(a, b || 0);
    };
    k.xa = function () {
        return this.get('center');
    };
    k.qd = function (a) {
        a = a || eg(this);
        var b = this.xa();
        oa(b, 1);
        var c = this.Pa();
        oa(void 0 !== c, 2);
        var d = this.Sa();
        oa(void 0 !== d, 3);
        return fb(b, c, d, a);
    };
    k.sn = function () {
        return this.a;
    };
    k.vn = function () {
        return this.i;
    };
    k.tn = function () {
        return this.Me(this.i);
    };
    k.Cq = function (a) {
        Vf(this, $f(this, { maxZoom: a }));
    };
    k.wn = function () {
        return this.Me(this.a);
    };
    k.Dq = function (a) {
        Vf(this, $f(this, { minZoom: a }));
    };
    k.xn = function () {
        return this.v;
    };
    k.Pa = function () {
        return this.get('resolution');
    };
    k.yn = function () {
        return this.j;
    };
    k.Je = function (a, b) {
        b = b || eg(this);
        return Math.max(cb(a) / b[0], db(a) / b[1]);
    };
    function fg(a) {
        var b = a.a, c = Math.log(b / a.i) / Math.log(2);
        return function (a) {
            return b / Math.pow(2, a * c);
        };
    }
    k.Sa = function () {
        return this.get('rotation');
    };
    function gg(a) {
        var b = a.a, c = Math.log(b / a.i) / Math.log(2);
        return function (a) {
            return Math.log(b / a) / Math.log(2) / c;
        };
    }
    k.getState = function () {
        var a = this.xa(), b = this.v, c = this.Pa(), d = this.Sa();
        return {
            center: a.slice(),
            projection: void 0 !== b ? b : null,
            resolution: c,
            rotation: d,
            zoom: this.lg()
        };
    };
    k.lg = function () {
        var a, b = this.Pa();
        void 0 !== b && (a = this.Me(b));
        return a;
    };
    k.Me = function (a) {
        var b = this.s || 0, c;
        if (this.j) {
            b = c = fc(this.j, a, 1);
            var d = this.j[c];
            c = c == this.j.length - 1 ? 2 : d / this.j[c + 1];
        } else
            d = this.a, c = this.D;
        return b + Math.log(d / a) / Math.log(c);
    };
    k.$h = function (a) {
        return this.constrainResolution(this.a, a - this.s, 0);
    };
    k.Uf = function (a, b) {
        b = b || {};
        var c = b.size;
        c || (c = eg(this));
        if (a instanceof hf)
            if ('Circle' === a.S()) {
                a = a.G();
                var d = Rf(a);
                d.rotate(this.Sa(), eb(a));
            } else
                d = a;
        else
            oa(Array.isArray(a), 24), oa(!bb(a), 25), d = Rf(a);
        var e = void 0 !== b.padding ? b.padding : [
                0,
                0,
                0,
                0
            ], f = void 0 !== b.constrainResolution ? b.constrainResolution : !0, g = void 0 !== b.nearest ? b.nearest : !1, h;
        void 0 !== b.minResolution ? h = b.minResolution : void 0 !== b.maxZoom ? h = this.constrainResolution(this.a, b.maxZoom - this.s, 0) : h = 0;
        var l = d.da(), m = this.Sa();
        a = Math.cos(-m);
        m = Math.sin(-m);
        var n = Infinity, p = Infinity, q = -Infinity, r = -Infinity;
        d = d.pa();
        for (var u = 0, v = l.length; u < v; u += d) {
            var z = l[u] * a - l[u + 1] * m, A = l[u] * m + l[u + 1] * a;
            n = Math.min(n, z);
            p = Math.min(p, A);
            q = Math.max(q, z);
            r = Math.max(r, A);
        }
        c = this.Je([
            n,
            p,
            q,
            r
        ], [
            c[0] - e[1] - e[3],
            c[1] - e[0] - e[2]
        ]);
        c = isNaN(c) ? h : Math.max(c, h);
        f && (h = this.constrainResolution(c, 0, 0), !g && h < c && (h = this.constrainResolution(h, -1, 0)), c = h);
        m = -m;
        h = (n + q) / 2 + (e[1] - e[3]) / 2 * c;
        e = (p + r) / 2 + (e[0] - e[2]) / 2 * c;
        a = [
            h * a - e * m,
            e * a + h * m
        ];
        e = b.callback ? b.callback : ea;
        void 0 !== b.duration ? this.animate({
            resolution: c,
            center: a,
            duration: b.duration,
            easing: b.easing
        }, e) : (this.gd(c), this.ub(a), setTimeout(e.bind(void 0, !0), 0));
    };
    k.Nk = function (a, b, c) {
        var d = this.Sa(), e = Math.cos(-d);
        d = Math.sin(-d);
        var f = a[0] * e - a[1] * d;
        a = a[1] * e + a[0] * d;
        var g = this.Pa();
        f += (b[0] / 2 - c[0]) * g;
        a += (c[1] - b[1] / 2) * g;
        d = -d;
        this.ub([
            f * e - a * d,
            a * e + f * d
        ]);
    };
    function ag(a) {
        return !!a.xa() && void 0 !== a.Pa();
    }
    k.rotate = function (a, b) {
        void 0 !== b && (b = dg(this, a, b), this.ub(b));
        this.ce(a);
    };
    k.ub = function (a) {
        this.set('center', a);
        this.Ac() && this.rd();
    };
    function bg(a, b, c) {
        a.f[b] += c;
        a.u();
    }
    k.gd = function (a) {
        this.set('resolution', a);
        this.Ac() && this.rd();
    };
    k.ce = function (a) {
        this.set('rotation', a);
        this.Ac() && this.rd();
    };
    k.Tj = function (a) {
        this.gd(this.$h(a));
    };
    function hg(a, b) {
        var c = document.createElement('CANVAS');
        a && (c.width = a);
        b && (c.height = b);
        return c.getContext('2d');
    }
    function ig(a, b) {
        var c = b.parentNode;
        c && c.replaceChild(a, b);
    }
    function jg(a) {
        a && a.parentNode && a.parentNode.removeChild(a);
    }
    function kg(a) {
        Vc.call(this);
        var b = kb({}, a);
        b.opacity = void 0 !== a.opacity ? a.opacity : 1;
        b.visible = void 0 !== a.visible ? a.visible : !0;
        b.zIndex = void 0 !== a.zIndex ? a.zIndex : 0;
        b.maxResolution = void 0 !== a.maxResolution ? a.maxResolution : Infinity;
        b.minResolution = void 0 !== a.minResolution ? a.minResolution : 0;
        this.H(b);
        this.a = {
            layer: this,
            Te: !0
        };
    }
    w(kg, Vc);
    k = kg.prototype;
    k.S = function () {
        return this.type;
    };
    function lg(a) {
        a.a.opacity = pa(a.nc(), 0, 1);
        a.a.Vj = a.hg();
        a.a.visible = a.Jb();
        a.a.extent = a.G();
        a.a.zIndex = a.Ba();
        a.a.maxResolution = a.lc();
        a.a.minResolution = Math.max(a.mc(), 0);
        return a.a;
    }
    k.G = function () {
        return this.get('extent');
    };
    k.lc = function () {
        return this.get('maxResolution');
    };
    k.mc = function () {
        return this.get('minResolution');
    };
    k.nc = function () {
        return this.get('opacity');
    };
    k.Jb = function () {
        return this.get('visible');
    };
    k.Ba = function () {
        return this.get('zIndex');
    };
    k.Fc = function (a) {
        this.set('extent', a);
    };
    k.Mc = function (a) {
        this.set('maxResolution', a);
    };
    k.Nc = function (a) {
        this.set('minResolution', a);
    };
    k.Gc = function (a) {
        this.set('opacity', a);
    };
    k.Hc = function (a) {
        this.set('visible', a);
    };
    k.$b = function (a) {
        this.set('zIndex', a);
    };
    function mg(a) {
        var b = a || {};
        a = kb({}, b);
        delete a.layers;
        b = b.layers;
        kg.call(this, a);
        this.i = [];
        this.c = {};
        y(this, Xc(ng), this.im, this);
        b ? Array.isArray(b) ? b = new B(b.slice(), { unique: !0 }) : oa(b instanceof B, 43) : b = new B(void 0, { unique: !0 });
        this.Qi(b);
    }
    w(mg, kg);
    k = mg.prototype;
    k.Pe = function () {
        this.u();
    };
    k.im = function () {
        this.i.forEach(Gc);
        this.i.length = 0;
        var a = this.Cd();
        this.i.push(y(a, 'add', this.hm, this), y(a, 'remove', this.jm, this));
        for (var b in this.c)
            this.c[b].forEach(Gc);
        lb(this.c);
        a = a.a;
        var c;
        b = 0;
        for (c = a.length; b < c; b++) {
            var d = a[b];
            this.c[x(d).toString()] = [
                y(d, 'propertychange', this.Pe, this),
                y(d, 'change', this.Pe, this)
            ];
        }
        this.u();
    };
    k.hm = function (a) {
        a = a.element;
        var b = x(a).toString();
        this.c[b] = [
            y(a, 'propertychange', this.Pe, this),
            y(a, 'change', this.Pe, this)
        ];
        this.u();
    };
    k.jm = function (a) {
        a = x(a.element).toString();
        this.c[a].forEach(Gc);
        delete this.c[a];
        this.u();
    };
    k.Cd = function () {
        return this.get(ng);
    };
    k.Qi = function (a) {
        this.set(ng, a);
    };
    k.dg = function (a) {
        var b = void 0 !== a ? a : [], c = b.length;
        this.Cd().forEach(function (a) {
            a.dg(b);
        });
        a = lg(this);
        var d;
        for (d = b.length; c < d; c++) {
            var e = b[c];
            e.opacity *= a.opacity;
            e.visible = e.visible && a.visible;
            e.maxResolution = Math.min(e.maxResolution, a.maxResolution);
            e.minResolution = Math.max(e.minResolution, a.minResolution);
            void 0 !== a.extent && (e.extent = void 0 !== e.extent ? gb(e.extent, a.extent) : a.extent);
        }
        return b;
    };
    k.hg = function () {
        return 'ready';
    };
    var ng = 'layers';
    var og = [], pg = [];
    function qg(a, b) {
        switch (a) {
        case 'MAP_RENDERER':
            a = og;
            a.push(b);
            break;
        case 'LAYER_RENDERER':
            a = pg;
            a.push(b);
            break;
        default:
            throw Error('Unsupported plugin type: ' + a);
        }
    }
    function rg(a) {
        for (var b = 0, c = a.length; b < c; ++b)
            qg('LAYER_RENDERER', a[b]);
    }
    function G(a) {
        Vc.call(this);
        var b = sg(a);
        this.ob = void 0 !== a.loadTilesWhileAnimating ? a.loadTilesWhileAnimating : !1;
        this.sc = void 0 !== a.loadTilesWhileInteracting ? a.loadTilesWhileInteracting : !1;
        this.ra = void 0 !== a.pixelRatio ? a.pixelRatio : nd;
        this.Md = b.logos;
        this.V = function () {
            this.j = void 0;
            this.pq.call(this);
        }.bind(this);
        this.La = We();
        this.If = We();
        this.bb = 0;
        this.D = this.C = this.B = this.f = this.c = null;
        this.a = document.createElement('DIV');
        this.a.className = 'ol-viewport' + (sd ? ' ol-touch' : '');
        this.a.style.position = 'relative';
        this.a.style.overflow = 'hidden';
        this.a.style.width = '100%';
        this.a.style.height = '100%';
        this.a.style.msTouchAction = 'none';
        this.a.style.touchAction = 'none';
        this.o = document.createElement('DIV');
        this.o.className = 'ol-overlaycontainer';
        this.a.appendChild(this.o);
        this.v = document.createElement('DIV');
        this.v.className = 'ol-overlaycontainer-stopevent';
        for (var c = 'click dblclick mousedown touchstart MSPointerDown pointerdown mousewheel wheel'.split(' '), d = 0, e = c.length; d < e; ++d)
            y(this.v, c[d], Rc);
        this.a.appendChild(this.v);
        this.ca = new be(this, a.moveTolerance);
        for (var f in zd)
            y(this.ca, zd[f], this.bi, this);
        this.$ = b.keyboardEventTarget;
        this.s = null;
        y(this.a, 'wheel', this.yd, this);
        y(this.a, 'mousewheel', this.yd, this);
        this.controls = b.controls || new B();
        this.interactions = b.interactions || new B();
        this.l = b.overlays;
        this.Fg = {};
        this.pc = b.Im.create(this.a, this);
        this.T = null;
        this.Ea = [];
        this.ua = new le(this.Tl.bind(this), this.zm.bind(this));
        this.O = {};
        y(this, Xc('layergroup'), this.fm, this);
        y(this, Xc('view'), this.Am, this);
        y(this, Xc('size'), this.um, this);
        y(this, Xc('target'), this.ym, this);
        this.H(b.values);
        this.controls.forEach(function (a) {
            a.setMap(this);
        }, this);
        y(this.controls, 'add', function (a) {
            a.element.setMap(this);
        }, this);
        y(this.controls, 'remove', function (a) {
            a.element.setMap(null);
        }, this);
        this.interactions.forEach(function (a) {
            a.setMap(this);
        }, this);
        y(this.interactions, 'add', function (a) {
            a.element.setMap(this);
        }, this);
        y(this.interactions, 'remove', function (a) {
            a.element.setMap(null);
        }, this);
        this.l.forEach(this.zh, this);
        y(this.l, 'add', function (a) {
            this.zh(a.element);
        }, this);
        y(this.l, 'remove', function (a) {
            var b = a.element.id;
            void 0 !== b && delete this.Fg[b.toString()];
            a.element.setMap(null);
        }, this);
    }
    w(G, Vc);
    k = G.prototype;
    k.Mf = function (a) {
        this.controls.push(a);
    };
    k.Nf = function (a) {
        this.interactions.push(a);
    };
    k.xe = function (a) {
        this.hc().Cd().push(a);
    };
    k.ye = function (a) {
        this.l.push(a);
    };
    k.zh = function (a) {
        var b = a.id;
        void 0 !== b && (this.Fg[b.toString()] = a);
        a.setMap(this);
    };
    k.ia = function () {
        Pc(this.ca);
        Mc(this.a, 'wheel', this.yd, this);
        Mc(this.a, 'mousewheel', this.yd, this);
        void 0 !== this.i && (window.removeEventListener('resize', this.i, !1), this.i = void 0);
        this.j && (cancelAnimationFrame(this.j), this.j = void 0);
        this.Ad(null);
        Vc.prototype.ia.call(this);
    };
    k.Tc = function (a, b, c) {
        if (this.c)
            return a = this.Ra(a), c = void 0 !== c ? c : {}, this.pc.wa(a, this.c, void 0 !== c.hitTolerance ? c.hitTolerance * this.c.pixelRatio : 0, b, null, void 0 !== c.layerFilter ? c.layerFilter : Re, null);
    };
    k.Xf = function (a, b) {
        var c = null;
        this.Tc(a, function (a) {
            c || (c = []);
            c.push(a);
        }, b);
        return c;
    };
    k.tg = function (a, b, c, d, e) {
        if (this.c)
            return this.pc.Ti(a, this.c, b, void 0 !== c ? c : null, void 0 !== d ? d : Re, void 0 !== e ? e : null);
    };
    k.ng = function (a, b) {
        if (!this.c)
            return !1;
        a = this.Ra(a);
        b = void 0 !== b ? b : {};
        return this.pc.Ui(a, this.c, void 0 !== b.hitTolerance ? b.hitTolerance * this.c.pixelRatio : 0, void 0 !== b.layerFilter ? b.layerFilter : Re, null);
    };
    k.Sd = function (a) {
        return this.Ra(this.ud(a));
    };
    k.ud = function (a) {
        var b = this.a.getBoundingClientRect();
        a = a.changedTouches ? a.changedTouches[0] : a;
        return [
            a.clientX - b.left,
            a.clientY - b.top
        ];
    };
    k.Xd = function () {
        return this.get('target');
    };
    k.Cc = function () {
        var a = this.Xd();
        return void 0 !== a ? 'string' === typeof a ? document.getElementById(a) : a : null;
    };
    k.Ra = function (a) {
        var b = this.c;
        return b ? af(b.pixelToCoordinateTransform, a.slice()) : null;
    };
    k.Wf = function () {
        return this.controls;
    };
    k.gg = function () {
        return this.l;
    };
    k.fg = function (a) {
        a = this.Fg[a.toString()];
        return void 0 !== a ? a : null;
    };
    k.bg = function () {
        return this.interactions;
    };
    k.hc = function () {
        return this.get('layergroup');
    };
    k.Xe = function () {
        return this.hc().Cd();
    };
    k.Ia = function (a) {
        var b = this.c;
        return b ? af(b.coordinateToPixelTransform, a.slice(0, 2)) : null;
    };
    k.Ie = function () {
        return this.pc;
    };
    k.Cb = function () {
        return this.get('size');
    };
    k.aa = function () {
        return this.get('view');
    };
    k.kg = function () {
        return this.a;
    };
    k.Tl = function (a, b, c, d) {
        var e = this.c;
        if (!(e && b in e.wantedTiles && e.wantedTiles[b][a.lb()]))
            return Infinity;
        a = c[0] - e.focus[0];
        c = c[1] - e.focus[1];
        return 65536 * Math.log(d) + Math.sqrt(a * a + c * c) / d;
    };
    k.yd = function (a, b) {
        a = new ed(b || a.type, this, a);
        this.bi(a);
    };
    k.bi = function (a) {
        if (this.c) {
            this.T = a.coordinate;
            a.frameState = this.c;
            var b = this.interactions.a, c;
            if (!1 !== this.b(a))
                for (c = b.length - 1; 0 <= c; c--) {
                    var d = b[c];
                    if (d.c() && !d.handleEvent(a))
                        break;
                }
        }
    };
    k.sm = function () {
        var a = this.c, b = this.ua;
        if (0 !== b.b.length) {
            var c = 16, d = c;
            if (a) {
                var e = a.viewHints;
                e[0] && (c = this.ob ? 8 : 0, d = 2);
                e[1] && (c = this.sc ? 8 : 0, d = 2);
            }
            b.j < c && (ke(b), me(b, c, d));
        }
        b = this.Ea;
        c = 0;
        for (d = b.length; c < d; ++c)
            b[c](this, a);
        b.length = 0;
    };
    k.um = function () {
        this.render();
    };
    k.ym = function () {
        var a;
        this.Xd() && (a = this.Cc());
        if (this.s) {
            for (var b = 0, c = this.s.length; b < c; ++b)
                Gc(this.s[b]);
            this.s = null;
        }
        if (a) {
            a.appendChild(this.a);
            var d = this.$ ? this.$ : a;
            this.s = [
                y(d, 'keydown', this.yd, this),
                y(d, 'keypress', this.yd, this)
            ];
            this.i || (this.i = this.Oc.bind(this), window.addEventListener('resize', this.i, !1));
        } else {
            a = this.pc;
            for (d in a.c)
                Pc(tg(a, d));
            jg(this.a);
            void 0 !== this.i && (window.removeEventListener('resize', this.i, !1), this.i = void 0);
        }
        this.Oc();
    };
    k.zm = function () {
        this.render();
    };
    k.ei = function () {
        this.render();
    };
    k.Am = function () {
        this.B && (Gc(this.B), this.B = null);
        this.C && (Gc(this.C), this.C = null);
        var a = this.aa();
        a && (this.a.setAttribute('data-view', x(a)), this.B = y(a, 'propertychange', this.ei, this), this.C = y(a, 'change', this.ei, this));
        this.render();
    };
    k.fm = function () {
        this.D && (this.D.forEach(Gc), this.D = null);
        var a = this.hc();
        a && (this.D = [
            y(a, 'propertychange', this.render, this),
            y(a, 'change', this.render, this)
        ]);
        this.render();
    };
    k.dh = function () {
        this.j && cancelAnimationFrame(this.j);
        this.V();
    };
    k.render = function () {
        void 0 === this.j && (this.j = requestAnimationFrame(this.V));
    };
    k.Xg = function (a) {
        return this.controls.remove(a);
    };
    k.Zg = function (a) {
        return this.interactions.remove(a);
    };
    k.$g = function (a) {
        return this.hc().Cd().remove(a);
    };
    k.ah = function (a) {
        return this.l.remove(a);
    };
    k.pq = function () {
        var a = Date.now(), b, c = this.Cb(), d = this.aa(), e = Da(), f = this.c, g = null;
        if (void 0 !== c && 0 < c[0] && 0 < c[1] && d && ag(d)) {
            g = this.c ? this.c.viewHints : void 0;
            void 0 !== g ? (g[0] = d.f[0], g[1] = d.f[1]) : g = d.f.slice();
            var h = this.hc().dg(), l = {};
            var m = 0;
            for (b = h.length; m < b; ++m)
                l[x(h[m].layer)] = h[m];
            m = d.getState();
            d = m.center;
            b = m.resolution / this.ra;
            d[0] = Math.round(d[0] / b) * b;
            d[1] = Math.round(d[1] / b) * b;
            g = {
                animate: !1,
                coordinateToPixelTransform: this.La,
                extent: e,
                focus: this.T ? this.T : d,
                index: this.bb++,
                layerStates: l,
                layerStatesArray: h,
                logos: kb({}, this.Md),
                pixelRatio: this.ra,
                pixelToCoordinateTransform: this.If,
                postRenderFunctions: [],
                size: c,
                skippedFeatureUids: this.O,
                tileQueue: this.ua,
                time: a,
                usedTiles: {},
                viewState: m,
                viewHints: g,
                wantedTiles: {}
            };
        }
        g && (g.extent = fb(m.center, m.resolution, m.rotation, g.size, e));
        this.c = g;
        this.pc.bh(g);
        g && (g.animate && this.render(), Array.prototype.push.apply(this.Ea, g.postRenderFunctions), !f || this.f && (bb(this.f) || Sa(g.extent, this.f)) || (this.b(new dd('movestart', this, f)), this.f = Oa(this.f)), !this.f || g.viewHints[0] || g.viewHints[1] || Sa(g.extent, this.f) || (this.b(new dd('moveend', this, g)), Ga(g.extent, this.f)));
        this.b(new dd('postrender', this, g));
        setTimeout(this.sm.bind(this), 0);
    };
    k.zf = function (a) {
        this.set('layergroup', a);
    };
    k.be = function (a) {
        this.set('size', a);
    };
    k.Ad = function (a) {
        this.set('target', a);
    };
    k.jh = function (a) {
        this.set('view', a);
    };
    k.Uj = function (a) {
        a = x(a).toString();
        this.O[a] = !0;
        this.render();
    };
    k.Oc = function () {
        var a = this.Cc();
        if (a) {
            var b = getComputedStyle(a);
            this.be([
                a.offsetWidth - parseFloat(b.borderLeftWidth) - parseFloat(b.paddingLeft) - parseFloat(b.paddingRight) - parseFloat(b.borderRightWidth),
                a.offsetHeight - parseFloat(b.borderTopWidth) - parseFloat(b.paddingTop) - parseFloat(b.paddingBottom) - parseFloat(b.borderBottomWidth)
            ]);
        } else
            this.be(void 0);
    };
    k.Zj = function (a) {
        a = x(a).toString();
        delete this.O[a];
        this.render();
    };
    var ug = [
        'canvas',
        'webgl'
    ];
    function sg(a) {
        var b = null;
        void 0 !== a.keyboardEventTarget && (b = 'string' === typeof a.keyboardEventTarget ? document.getElementById(a.keyboardEventTarget) : a.keyboardEventTarget);
        var c = {}, d = {};
        if (void 0 === a.logo || 'boolean' === typeof a.logo && a.logo)
            d['data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC'] = 'https://openlayers.org/';
        else {
            var e = a.logo;
            'string' === typeof e ? d[e] = '' : e instanceof HTMLElement ? d[x(e).toString()] = e : e && (oa('string' == typeof e.href, 44), oa('string' == typeof e.src, 45), d[e.src] = e.href);
        }
        e = a.layers instanceof mg ? a.layers : new mg({ layers: a.layers });
        c.layergroup = e;
        c.target = a.target;
        c.view = void 0 !== a.view ? a.view : new F();
        var f;
        void 0 !== a.renderer ? (Array.isArray(a.renderer) ? f = a.renderer : 'string' === typeof a.renderer ? f = [a.renderer] : oa(!1, 46), 0 <= f.indexOf('dom') && (f = f.concat(ug))) : f = ug;
        e = 0;
        var g = f.length;
        a:
            for (; e < g; ++e)
                for (var h = f[e], l = 0, m = og.length; l < m; ++l) {
                    var n = og[l];
                    if (n.handles(h)) {
                        var p = n;
                        break a;
                    }
                }
        if (!p)
            throw Error('Unable to create a map renderer for types: ' + f.join(', '));
        if (void 0 !== a.controls)
            if (Array.isArray(a.controls))
                var q = new B(a.controls.slice());
            else
                oa(a.controls instanceof B, 47), q = a.controls;
        if (void 0 !== a.interactions)
            if (Array.isArray(a.interactions))
                var r = new B(a.interactions.slice());
            else
                oa(a.interactions instanceof B, 48), r = a.interactions;
        void 0 !== a.overlays ? Array.isArray(a.overlays) ? a = new B(a.overlays.slice()) : (oa(a.overlays instanceof B, 49), a = a.overlays) : a = new B();
        return {
            controls: q,
            interactions: r,
            keyboardEventTarget: b,
            logos: d,
            overlays: a,
            Im: p,
            values: c
        };
    }
    function vg(a) {
        Vc.call(this);
        this.element = a.element ? a.element : null;
        this.a = this.T = null;
        this.s = [];
        this.render = a.render ? a.render : ea;
        a.target && this.i(a.target);
    }
    w(vg, Vc);
    vg.prototype.ia = function () {
        jg(this.element);
        Vc.prototype.ia.call(this);
    };
    vg.prototype.f = function () {
        return this.a;
    };
    vg.prototype.setMap = function (a) {
        this.a && jg(this.element);
        for (var b = 0, c = this.s.length; b < c; ++b)
            Gc(this.s[b]);
        this.s.length = 0;
        if (this.a = a)
            (this.T ? this.T : a.v).appendChild(this.element), this.render !== ea && this.s.push(y(a, 'postrender', this.render, this)), a.render();
    };
    vg.prototype.i = function (a) {
        this.T = 'string' === typeof a ? document.getElementById(a) : a;
    };
    var wg = function () {
        var a, b = {};
        return function (c) {
            a || (a = document.createElement('div').style);
            if (!(c in b)) {
                a.font = c;
                var d = a.fontFamily;
                a.font = '';
                if (!d)
                    return null;
                b[c] = d.split(/,\s?/);
            }
            return b[c];
        };
    }();
    function xg(a) {
        var b = kb({}, a);
        delete b.source;
        kg.call(this, b);
        this.o = this.v = this.s = null;
        a.map && this.setMap(a.map);
        y(this, Xc('source'), this.wm, this);
        this.hd(a.source ? a.source : null);
    }
    w(xg, kg);
    function yg(a, b) {
        return a.visible && b >= a.minResolution && b < a.maxResolution;
    }
    k = xg.prototype;
    k.dg = function (a) {
        a = a ? a : [];
        a.push(lg(this));
        return a;
    };
    k.ha = function () {
        return this.get('source') || null;
    };
    k.hg = function () {
        var a = this.ha();
        return a ? a.getState() : 'undefined';
    };
    k.yo = function () {
        this.u();
    };
    k.wm = function () {
        this.o && (Gc(this.o), this.o = null);
        var a = this.ha();
        a && (this.o = y(a, 'change', this.yo, this));
        this.u();
    };
    k.setMap = function (a) {
        this.s && (Gc(this.s), this.s = null);
        a || this.u();
        this.v && (Gc(this.v), this.v = null);
        a && (this.s = y(a, 'precompose', function (a) {
            var b = lg(this);
            b.Te = !1;
            b.zIndex = Infinity;
            a.frameState.layerStatesArray.push(b);
            a.frameState.layerStates[x(this)] = b;
        }, this), this.v = y(this, 'change', a.render, a), this.u());
    };
    k.hd = function (a) {
        this.set('source', a);
    };
    function zg(a) {
        a = a ? a : {};
        this.v = document.createElement('UL');
        this.l = document.createElement('LI');
        this.v.appendChild(this.l);
        this.l.style.display = 'none';
        this.c = void 0 !== a.collapsed ? a.collapsed : !0;
        this.j = void 0 !== a.collapsible ? a.collapsible : !0;
        this.j || (this.c = !1);
        var b = void 0 !== a.className ? a.className : 'ol-attribution', c = void 0 !== a.tipLabel ? a.tipLabel : 'Attributions', d = void 0 !== a.collapseLabel ? a.collapseLabel : '\xBB';
        'string' === typeof d ? (this.o = document.createElement('span'), this.o.textContent = d) : this.o = d;
        d = void 0 !== a.label ? a.label : 'i';
        'string' === typeof d ? (this.D = document.createElement('span'), this.D.textContent = d) : this.D = d;
        var e = this.j && !this.c ? this.o : this.D;
        d = document.createElement('button');
        d.setAttribute('type', 'button');
        d.title = c;
        d.appendChild(e);
        y(d, 'click', this.Bn, this);
        c = document.createElement('div');
        c.className = b + ' ol-unselectable ol-control' + (this.c && this.j ? ' ol-collapsed' : '') + (this.j ? '' : ' ol-uncollapsible');
        c.appendChild(this.v);
        c.appendChild(d);
        vg.call(this, {
            element: c,
            render: a.render ? a.render : Ag,
            target: a.target
        });
        this.B = [];
        this.C = !0;
        this.O = {};
    }
    w(zg, vg);
    function Ag(a) {
        if (a = a.frameState) {
            for (var b = {}, c = [], d = a.layerStatesArray, e = a.viewState.resolution, f = 0, g = d.length; f < g; ++f) {
                var h = d[f];
                if (yg(h, e) && (h = h.layer.ha()) && (h = h.C) && (h = h(a)))
                    if (Array.isArray(h))
                        for (var l = 0, m = h.length; l < m; ++l)
                            h[l] in b || (c.push(h[l]), b[h[l]] = !0);
                    else
                        h in b || (c.push(h), b[h] = !0);
            }
            if (!jc(c, this.B)) {
                for (; this.v.lastChild !== this.l;)
                    this.v.removeChild(this.v.lastChild);
                b = 0;
                for (d = c.length; b < d; ++b)
                    e = document.createElement('LI'), e.innerHTML = c[b], this.v.appendChild(e);
                0 === c.length && 0 < this.B.length ? this.element.classList.add('ol-logo-only') : 0 === this.B.length && 0 < c.length && this.element.classList.remove('ol-logo-only');
                b = 0 < c.length || !nb(a.logos);
                this.C != b && (this.element.style.display = b ? '' : 'none', this.C = b);
                this.B = c;
                a = a.logos;
                c = this.O;
                for (p in c)
                    p in a || (jg(c[p]), delete c[p]);
                for (var n in a)
                    if (d = a[n], d instanceof HTMLElement && (this.l.appendChild(d), c[n] = d), !(n in c)) {
                        var p = new Image();
                        p.src = n;
                        '' === d ? b = p : (b = document.createElement('a'), b.href = d, b.appendChild(p));
                        this.l.appendChild(b);
                        c[n] = b;
                    }
                this.l.style.display = nb(a) ? 'none' : '';
            }
        } else
            this.C && (this.element.style.display = 'none', this.C = !1);
    }
    k = zg.prototype;
    k.Bn = function (a) {
        a.preventDefault();
        Bg(this);
    };
    function Bg(a) {
        a.element.classList.toggle('ol-collapsed');
        a.c ? ig(a.o, a.D) : ig(a.D, a.o);
        a.c = !a.c;
    }
    k.An = function () {
        return this.j;
    };
    k.Dn = function (a) {
        this.j !== a && (this.j = a, this.element.classList.toggle('ol-uncollapsible'), !a && this.c && Bg(this));
    };
    k.Cn = function (a) {
        this.j && this.c !== a && Bg(this);
    };
    k.zn = function () {
        return this.c;
    };
    function Cg(a) {
        a = a ? a : {};
        var b = void 0 !== a.className ? a.className : 'ol-rotate', c = void 0 !== a.label ? a.label : '\u21E7';
        this.c = null;
        'string' === typeof c ? (this.c = document.createElement('span'), this.c.className = 'ol-compass', this.c.textContent = c) : (this.c = c, this.c.classList.add('ol-compass'));
        var d = a.tipLabel ? a.tipLabel : 'Reset rotation';
        c = document.createElement('button');
        c.className = b + '-reset';
        c.setAttribute('type', 'button');
        c.title = d;
        c.appendChild(this.c);
        y(c, 'click', Cg.prototype.D, this);
        d = document.createElement('div');
        d.className = b + ' ol-unselectable ol-control';
        d.appendChild(c);
        b = a.render ? a.render : Dg;
        this.l = a.resetNorth ? a.resetNorth : void 0;
        vg.call(this, {
            element: d,
            render: b,
            target: a.target
        });
        this.v = void 0 !== a.duration ? a.duration : 250;
        this.j = void 0 !== a.autoHide ? a.autoHide : !0;
        this.o = void 0;
        this.j && this.element.classList.add('ol-hidden');
    }
    w(Cg, vg);
    Cg.prototype.D = function (a) {
        a.preventDefault();
        void 0 !== this.l ? this.l() : (a = this.a.aa()) && void 0 !== a.Sa() && (0 < this.v ? a.animate({
            rotation: 0,
            duration: this.v,
            easing: Oe
        }) : a.ce(0));
    };
    function Dg(a) {
        if (a = a.frameState) {
            a = a.viewState.rotation;
            if (a != this.o) {
                var b = 'rotate(' + a + 'rad)';
                if (this.j) {
                    var c = this.element.classList.contains('ol-hidden');
                    c || 0 !== a ? c && 0 !== a && this.element.classList.remove('ol-hidden') : this.element.classList.add('ol-hidden');
                }
                this.c.style.msTransform = b;
                this.c.style.webkitTransform = b;
                this.c.style.transform = b;
            }
            this.o = a;
        }
    }
    function Eg(a) {
        a = a ? a : {};
        var b = void 0 !== a.className ? a.className : 'ol-zoom', c = void 0 !== a.delta ? a.delta : 1, d = void 0 !== a.zoomInLabel ? a.zoomInLabel : '+', e = void 0 !== a.zoomOutLabel ? a.zoomOutLabel : '\u2212', f = void 0 !== a.zoomInTipLabel ? a.zoomInTipLabel : 'Zoom in', g = void 0 !== a.zoomOutTipLabel ? a.zoomOutTipLabel : 'Zoom out', h = document.createElement('button');
        h.className = b + '-in';
        h.setAttribute('type', 'button');
        h.title = f;
        h.appendChild('string' === typeof d ? document.createTextNode(d) : d);
        y(h, 'click', Eg.prototype.j.bind(this, c));
        d = document.createElement('button');
        d.className = b + '-out';
        d.setAttribute('type', 'button');
        d.title = g;
        d.appendChild('string' === typeof e ? document.createTextNode(e) : e);
        y(d, 'click', Eg.prototype.j.bind(this, -c));
        c = document.createElement('div');
        c.className = b + ' ol-unselectable ol-control';
        c.appendChild(h);
        c.appendChild(d);
        vg.call(this, {
            element: c,
            target: a.target
        });
        this.c = void 0 !== a.duration ? a.duration : 250;
    }
    w(Eg, vg);
    Eg.prototype.j = function (a, b) {
        b.preventDefault();
        if (b = this.a.aa()) {
            var c = b.Pa();
            c && (a = b.constrainResolution(c, a), 0 < this.c ? (b.Ac() && b.rd(), b.animate({
                resolution: a,
                duration: this.c,
                easing: Oe
            })) : b.gd(a));
        }
    };
    function Fg(a) {
        a = a ? a : {};
        var b = new B();
        (void 0 !== a.zoom ? a.zoom : 1) && b.push(new Eg(a.zoomOptions));
        (void 0 !== a.rotate ? a.rotate : 1) && b.push(new Cg(a.rotateOptions));
        (void 0 !== a.attribution ? a.attribution : 1) && b.push(new zg(a.attributionOptions));
        return b;
    }
    function Gg(a, b, c) {
        this.i = a;
        this.c = b;
        this.f = c;
        this.b = [];
        this.a = this.g = 0;
    }
    function Hg(a) {
        a.b.length = 0;
        a.g = 0;
        a.a = 0;
    }
    function Ig(a) {
        if (6 > a.b.length)
            return !1;
        var b = Date.now() - a.f, c = a.b.length - 3;
        if (a.b[c + 2] < b)
            return !1;
        for (var d = c - 3; 0 < d && a.b[d + 2] > b;)
            d -= 3;
        b = a.b[c + 2] - a.b[d + 2];
        if (b < 1000 / 60)
            return !1;
        var e = a.b[c] - a.b[d];
        c = a.b[c + 1] - a.b[d + 1];
        a.g = Math.atan2(c, e);
        a.a = Math.sqrt(e * e + c * c) / b;
        return a.a > a.c;
    }
    function Jg(a) {
        Vc.call(this);
        this.v = null;
        this.Ha(!0);
        this.handleEvent = a.handleEvent;
    }
    w(Jg, Vc);
    Jg.prototype.c = function () {
        return this.get('active');
    };
    Jg.prototype.i = function () {
        return this.v;
    };
    Jg.prototype.Ha = function (a) {
        this.set('active', a);
    };
    Jg.prototype.setMap = function (a) {
        this.v = a;
    };
    function Kg(a, b, c, d) {
        if (void 0 !== b) {
            var e = a.Sa(), f = a.xa();
            void 0 !== e && f && 0 < d ? a.animate({
                rotation: b,
                anchor: c,
                duration: d,
                easing: Oe
            }) : a.rotate(b, c);
        }
    }
    function Lg(a, b, c, d) {
        var e = a.Pa();
        b = a.constrainResolution(e, b, 0);
        if (void 0 !== b) {
            var f = a.j;
            b = pa(b, a.i || f[f.length - 1], a.a || f[0]);
        }
        c && void 0 !== b && b !== e && (f = a.xa(), c = cg(a, b, c), c = a.Sc(c), c = [
            (b * f[0] - e * c[0]) / (b - e),
            (b * f[1] - e * c[1]) / (b - e)
        ]);
        Tg(a, b, c, d);
    }
    function Tg(a, b, c, d) {
        if (b) {
            var e = a.Pa(), f = a.xa();
            void 0 !== e && f && b !== e && d ? a.animate({
                resolution: b,
                anchor: c,
                duration: d,
                easing: Oe
            }) : (c && (c = cg(a, b, c), a.ub(c)), a.gd(b));
        }
    }
    function Ug(a) {
        a = a ? a : {};
        this.a = a.delta ? a.delta : 1;
        Jg.call(this, { handleEvent: Vg });
        this.f = void 0 !== a.duration ? a.duration : 250;
    }
    w(Ug, Jg);
    function Vg(a) {
        var b = !1, c = a.originalEvent;
        if ('dblclick' == a.type) {
            b = a.coordinate;
            c = c.shiftKey ? -this.a : this.a;
            var d = a.map.aa();
            Lg(d, c, b, this.f);
            a.preventDefault();
            b = !0;
        }
        return !b;
    }
    function Wg(a) {
        a = a.originalEvent;
        return a.altKey && !(a.metaKey || a.ctrlKey) && !a.shiftKey;
    }
    function Xg(a) {
        a = a.originalEvent;
        return a.altKey && !(a.metaKey || a.ctrlKey) && a.shiftKey;
    }
    function Yg(a) {
        a = a.originalEvent;
        return 0 == a.button && !(ld && md && a.ctrlKey);
    }
    function Zg(a) {
        return 'pointermove' == a.type;
    }
    function $g(a) {
        return 'singleclick' == a.type;
    }
    function ah(a) {
        a = a.originalEvent;
        return !a.altKey && !(a.metaKey || a.ctrlKey) && !a.shiftKey;
    }
    function bh(a) {
        a = a.originalEvent;
        return !a.altKey && !(a.metaKey || a.ctrlKey) && a.shiftKey;
    }
    function ch(a) {
        a = a.originalEvent.target.tagName;
        return 'INPUT' !== a && 'SELECT' !== a && 'TEXTAREA' !== a;
    }
    function dh(a) {
        oa(a.b, 56);
        return 'mouse' == a.b.pointerType;
    }
    function eh(a) {
        a = a.b;
        return a.isPrimary && 0 === a.button;
    }
    function fh(a) {
        a = a ? a : {};
        Jg.call(this, { handleEvent: a.handleEvent ? a.handleEvent : gh });
        this.ck = a.handleDownEvent ? a.handleDownEvent : Se;
        this.Ek = a.handleDragEvent ? a.handleDragEvent : ea;
        this.Kk = a.handleMoveEvent ? a.handleMoveEvent : ea;
        this.Lk = a.handleUpEvent ? a.handleUpEvent : Se;
        this.D = !1;
        this.$ = {};
        this.l = [];
    }
    w(fh, Jg);
    function hh(a) {
        for (var b = a.length, c = 0, d = 0, e = 0; e < b; e++)
            c += a[e].clientX, d += a[e].clientY;
        return [
            c / b,
            d / b
        ];
    }
    function gh(a) {
        if (!(a instanceof Ad))
            return !0;
        var b = !1, c = a.type;
        if ('pointerdown' === c || 'pointerdrag' === c || 'pointerup' === c) {
            c = a.b;
            var d = c.pointerId.toString();
            'pointerup' == a.type ? delete this.$[d] : 'pointerdown' == a.type ? this.$[d] = c : d in this.$ && (this.$[d] = c);
            this.l = mb(this.$);
        }
        this.D ? 'pointerdrag' == a.type ? this.Ek(a) : 'pointerup' == a.type && (this.D = this.Lk(a) && 0 < this.l.length) : 'pointerdown' == a.type ? (this.D = a = this.ck(a), b = this.jd(a)) : 'pointermove' == a.type && this.Kk(a);
        return !b;
    }
    fh.prototype.jd = function (a) {
        return a;
    };
    function ih(a) {
        fh.call(this, {
            handleDownEvent: jh,
            handleDragEvent: kh,
            handleUpEvent: lh
        });
        a = a ? a : {};
        this.a = a.kinetic;
        this.f = null;
        this.o = a.condition ? a.condition : ah;
        this.j = !1;
    }
    w(ih, fh);
    function kh(a) {
        var b = this.l, c = hh(b);
        if (b.length == this.s) {
            if (this.a && this.a.b.push(c[0], c[1], Date.now()), this.f) {
                var d = this.f[0] - c[0], e = c[1] - this.f[1];
                a = a.map.aa();
                var f = a.getState();
                d = [
                    d,
                    e
                ];
                Ge(d, f.resolution);
                Fe(d, f.rotation);
                ze(d, f.center);
                d = a.Sc(d);
                a.ub(d);
            }
        } else
            this.a && Hg(this.a);
        this.f = c;
        this.s = b.length;
    }
    function lh(a) {
        var b = a.map;
        a = b.aa();
        if (0 === this.l.length) {
            if (!this.j && this.a && Ig(this.a)) {
                var c = this.a;
                c = (c.c - c.a) / c.i;
                var d = this.a.g, e = a.xa();
                e = b.Ia(e);
                b = b.Ra([
                    e[0] - c * Math.cos(d),
                    e[1] - c * Math.sin(d)
                ]);
                a.animate({
                    center: a.Sc(b),
                    duration: 500,
                    easing: Oe
                });
            }
            bg(a, 1, -1);
            return !1;
        }
        this.a && Hg(this.a);
        this.f = null;
        return !0;
    }
    function jh(a) {
        if (0 < this.l.length && this.o(a)) {
            var b = a.map.aa();
            this.f = null;
            this.D || bg(b, 1, 1);
            b.Ac() && b.ub(a.frameState.viewState.center);
            this.a && Hg(this.a);
            this.j = 1 < this.l.length;
            return !0;
        }
        return !1;
    }
    ih.prototype.jd = Se;
    function mh(a) {
        a = a ? a : {};
        fh.call(this, {
            handleDownEvent: nh,
            handleDragEvent: oh,
            handleUpEvent: ph
        });
        this.f = a.condition ? a.condition : Xg;
        this.a = void 0;
        this.j = void 0 !== a.duration ? a.duration : 250;
    }
    w(mh, fh);
    function oh(a) {
        if (dh(a)) {
            var b = a.map, c = b.aa();
            if (c.l.rotation !== re) {
                b = b.Cb();
                a = a.pixel;
                a = Math.atan2(b[1] / 2 - a[1], a[0] - b[0] / 2);
                if (void 0 !== this.a) {
                    b = a - this.a;
                    var d = c.Sa();
                    Kg(c, d - b);
                }
                this.a = a;
            }
        }
    }
    function ph(a) {
        if (!dh(a))
            return !0;
        a = a.map.aa();
        bg(a, 1, -1);
        var b = a.Sa(), c = this.j;
        b = a.constrainRotation(b, 0);
        Kg(a, b, void 0, c);
        return !1;
    }
    function nh(a) {
        return dh(a) && Yg(a) && this.f(a) ? (bg(a.map.aa(), 1, 1), this.a = void 0, !0) : !1;
    }
    mh.prototype.jd = Se;
    function qh(a) {
        this.Uc = null;
        this.a = document.createElement('div');
        this.a.style.position = 'absolute';
        this.a.className = 'ol-box ' + a;
        this.g = this.c = this.b = null;
    }
    w(qh, Oc);
    qh.prototype.ia = function () {
        this.setMap(null);
    };
    function rh(a) {
        var b = a.c, c = a.g;
        a = a.a.style;
        a.left = Math.min(b[0], c[0]) + 'px';
        a.top = Math.min(b[1], c[1]) + 'px';
        a.width = Math.abs(c[0] - b[0]) + 'px';
        a.height = Math.abs(c[1] - b[1]) + 'px';
    }
    qh.prototype.setMap = function (a) {
        if (this.b) {
            this.b.o.removeChild(this.a);
            var b = this.a.style;
            b.left = b.top = b.width = b.height = 'inherit';
        }
        (this.b = a) && this.b.o.appendChild(this.a);
    };
    function sh(a) {
        var b = a.c, c = a.g;
        b = [
            b,
            [
                b[0],
                c[1]
            ],
            c,
            [
                c[0],
                b[1]
            ]
        ].map(a.b.Ra, a.b);
        b[4] = b[0].slice();
        a.Uc ? a.Uc.na([b]) : a.Uc = new D([b]);
    }
    qh.prototype.U = function () {
        return this.Uc;
    };
    function th(a) {
        fh.call(this, {
            handleDownEvent: uh,
            handleDragEvent: vh,
            handleUpEvent: wh
        });
        a = a ? a : {};
        this.a = new qh(a.className || 'ol-dragbox');
        this.o = void 0 !== a.minArea ? a.minArea : 64;
        this.f = null;
        this.C = a.condition ? a.condition : Re;
        this.s = a.boxEndCondition ? a.boxEndCondition : xh;
    }
    w(th, fh);
    function xh(a, b, c) {
        a = c[0] - b[0];
        b = c[1] - b[1];
        return a * a + b * b >= this.o;
    }
    function vh(a) {
        if (dh(a)) {
            var b = this.a, c = a.pixel;
            b.c = this.f;
            b.g = c;
            sh(b);
            rh(b);
            this.b(new yh(zh, a.coordinate, a));
        }
    }
    th.prototype.U = function () {
        return this.a.U();
    };
    th.prototype.j = ea;
    function wh(a) {
        if (!dh(a))
            return !0;
        this.a.setMap(null);
        this.s(a, this.f, a.pixel) && (this.j(a), this.b(new yh(Ah, a.coordinate, a)));
        return !1;
    }
    function uh(a) {
        if (dh(a) && Yg(a) && this.C(a)) {
            this.f = a.pixel;
            this.a.setMap(a.map);
            var b = this.a, c = this.f;
            b.c = this.f;
            b.g = c;
            sh(b);
            rh(b);
            this.b(new yh(Bh, a.coordinate, a));
            return !0;
        }
        return !1;
    }
    var Bh = 'boxstart', zh = 'boxdrag', Ah = 'boxend';
    function yh(a, b, c) {
        Qc.call(this, a);
        this.coordinate = b;
        this.mapBrowserEvent = c;
    }
    w(yh, Qc);
    function Ch(a) {
        a = a ? a : {};
        var b = a.condition ? a.condition : bh;
        this.B = void 0 !== a.duration ? a.duration : 200;
        this.T = void 0 !== a.out ? a.out : !1;
        th.call(this, {
            condition: b,
            className: a.className || 'ol-dragzoom'
        });
    }
    w(Ch, th);
    Ch.prototype.j = function () {
        var a = this.v, b = a.aa(), c = a.Cb(), d = this.U().G();
        if (this.T) {
            var e = b.qd(c);
            d = [
                a.Ia(Wa(d)),
                a.Ia(Za(d))
            ];
            a = Oa(void 0);
            var f;
            var g = 0;
            for (f = d.length; g < f; ++g)
                Ea(a, d[g]);
            d = b.Je(a, c);
            ib(e, 1 / d);
            d = e;
        }
        c = b.constrainResolution(b.Je(d, c));
        e = eb(d);
        e = b.Sc(e);
        b.animate({
            resolution: c,
            center: e,
            duration: this.B,
            easing: Oe
        });
    };
    function Dh(a) {
        Jg.call(this, { handleEvent: Eh });
        a = a || {};
        this.a = function (a) {
            return ah(a) && ch(a);
        };
        this.f = void 0 !== a.condition ? a.condition : this.a;
        this.j = void 0 !== a.duration ? a.duration : 100;
        this.l = void 0 !== a.pixelDelta ? a.pixelDelta : 128;
    }
    w(Dh, Jg);
    function Eh(a) {
        var b = !1;
        if ('keydown' == a.type) {
            var c = a.originalEvent.keyCode;
            if (this.f(a) && (40 == c || 37 == c || 39 == c || 38 == c)) {
                b = a.map.aa();
                var d = b.Pa() * this.l, e = 0, f = 0;
                40 == c ? f = -d : 37 == c ? e = -d : 39 == c ? e = d : f = d;
                d = [
                    e,
                    f
                ];
                Fe(d, b.Sa());
                c = this.j;
                if (e = b.xa())
                    d = b.Sc([
                        e[0] + d[0],
                        e[1] + d[1]
                    ]), c ? b.animate({
                        duration: c,
                        easing: Qe,
                        center: d
                    }) : b.ub(d);
                a.preventDefault();
                b = !0;
            }
        }
        return !b;
    }
    function Fh(a) {
        Jg.call(this, { handleEvent: Gh });
        a = a ? a : {};
        this.f = a.condition ? a.condition : ch;
        this.a = a.delta ? a.delta : 1;
        this.j = void 0 !== a.duration ? a.duration : 100;
    }
    w(Fh, Jg);
    function Gh(a) {
        var b = !1;
        if ('keydown' == a.type || 'keypress' == a.type) {
            var c = a.originalEvent.charCode;
            !this.f(a) || 43 != c && 45 != c || (b = 43 == c ? this.a : -this.a, c = a.map.aa(), Lg(c, b, void 0, this.j), a.preventDefault(), b = !0);
        }
        return !b;
    }
    function Hh(a) {
        Jg.call(this, { handleEvent: Ih });
        a = a || {};
        this.j = 0;
        this.D = void 0 !== a.duration ? a.duration : 250;
        this.$ = void 0 !== a.timeout ? a.timeout : 80;
        this.C = void 0 !== a.useAnchor ? a.useAnchor : !0;
        this.O = a.constrainResolution || !1;
        this.a = null;
        this.s = this.l = this.o = this.f = void 0;
    }
    w(Hh, Jg);
    function Ih(a) {
        var b = a.type;
        if ('wheel' !== b && 'mousewheel' !== b)
            return !0;
        a.preventDefault();
        b = a.map;
        var c = a.originalEvent;
        this.C && (this.a = a.coordinate);
        if ('wheel' == a.type) {
            var d = c.deltaY;
            jd && c.deltaMode === WheelEvent.DOM_DELTA_PIXEL && (d /= nd);
            c.deltaMode === WheelEvent.DOM_DELTA_LINE && (d *= 40);
        } else
            'mousewheel' == a.type && (d = -c.wheelDeltaY, kd && (d /= 3));
        if (0 === d)
            return !1;
        a = Date.now();
        void 0 === this.f && (this.f = a);
        if (!this.l || 400 < a - this.f)
            this.l = 4 > Math.abs(d) ? Ph : Qh;
        if (this.l === Ph) {
            b = b.aa();
            this.s ? clearTimeout(this.s) : bg(b, 1, 1);
            this.s = setTimeout(this.B.bind(this), 400);
            c = b.Pa() * Math.pow(2, d / 300);
            var e = b.i, f = b.a, g = 0;
            c < e ? (c = Math.max(c, e / 1.5), g = 1) : c > f && (c = Math.min(c, 1.5 * f), g = -1);
            if (this.a) {
                var h = cg(b, c, this.a);
                b.ub(b.Sc(h));
            }
            b.gd(c);
            0 === g && this.O && b.animate({
                resolution: b.constrainResolution(c, 0 < d ? -1 : 1),
                easing: Oe,
                anchor: this.a,
                duration: this.D
            });
            0 < g ? b.animate({
                resolution: e,
                easing: Oe,
                anchor: this.a,
                duration: 500
            }) : 0 > g && b.animate({
                resolution: f,
                easing: Oe,
                anchor: this.a,
                duration: 500
            });
            this.f = a;
            return !1;
        }
        this.j += d;
        d = Math.max(this.$ - (a - this.f), 0);
        clearTimeout(this.o);
        this.o = setTimeout(this.T.bind(this, b), d);
        return !1;
    }
    Hh.prototype.B = function () {
        this.s = void 0;
        bg(this.v.aa(), 1, -1);
    };
    Hh.prototype.T = function (a) {
        a = a.aa();
        a.Ac() && a.rd();
        Lg(a, -pa(this.j, -1, 1), this.a, this.D);
        this.l = void 0;
        this.j = 0;
        this.a = null;
        this.o = this.f = void 0;
    };
    Hh.prototype.V = function (a) {
        this.C = a;
        a || (this.a = null);
    };
    var Ph = 'trackpad', Qh = 'wheel';
    function Rh(a) {
        fh.call(this, {
            handleDownEvent: Sh,
            handleDragEvent: Th,
            handleUpEvent: Uh
        });
        a = a || {};
        this.f = null;
        this.j = void 0;
        this.a = !1;
        this.s = 0;
        this.C = void 0 !== a.threshold ? a.threshold : 0.3;
        this.o = void 0 !== a.duration ? a.duration : 250;
    }
    w(Rh, fh);
    function Th(a) {
        var b = 0, c = this.l[0], d = this.l[1];
        c = Math.atan2(d.clientY - c.clientY, d.clientX - c.clientX);
        void 0 !== this.j && (b = c - this.j, this.s += b, !this.a && Math.abs(this.s) > this.C && (this.a = !0));
        this.j = c;
        a = a.map;
        c = a.aa();
        if (c.l.rotation !== re) {
            d = a.a.getBoundingClientRect();
            var e = hh(this.l);
            e[0] -= d.left;
            e[1] -= d.top;
            this.f = a.Ra(e);
            this.a && (d = c.Sa(), a.render(), Kg(c, d + b, this.f));
        }
    }
    function Uh(a) {
        if (2 > this.l.length) {
            a = a.map.aa();
            bg(a, 1, -1);
            if (this.a) {
                var b = a.Sa(), c = this.f, d = this.o;
                b = a.constrainRotation(b, 0);
                Kg(a, b, c, d);
            }
            return !1;
        }
        return !0;
    }
    function Sh(a) {
        return 2 <= this.l.length ? (a = a.map, this.f = null, this.j = void 0, this.a = !1, this.s = 0, this.D || bg(a.aa(), 1, 1), !0) : !1;
    }
    Rh.prototype.jd = Se;
    function Vh(a) {
        fh.call(this, {
            handleDownEvent: Wh,
            handleDragEvent: Xh,
            handleUpEvent: Yh
        });
        a = a ? a : {};
        this.s = a.constrainResolution || !1;
        this.f = null;
        this.o = void 0 !== a.duration ? a.duration : 400;
        this.a = void 0;
        this.j = 1;
    }
    w(Vh, fh);
    function Xh(a) {
        var b = 1, c = this.l[0], d = this.l[1], e = c.clientX - d.clientX;
        c = c.clientY - d.clientY;
        e = Math.sqrt(e * e + c * c);
        void 0 !== this.a && (b = this.a / e);
        this.a = e;
        a = a.map;
        e = a.aa();
        d = e.Pa();
        var f = e.a, g = e.i;
        c = d * b;
        c > f ? (b = f / d, c = f) : c < g && (b = g / d, c = g);
        1 != b && (this.j = b);
        b = a.a.getBoundingClientRect();
        d = hh(this.l);
        d[0] -= b.left;
        d[1] -= b.top;
        this.f = a.Ra(d);
        a.render();
        Tg(e, c, this.f);
    }
    function Yh(a) {
        if (2 > this.l.length) {
            a = a.map.aa();
            bg(a, 1, -1);
            var b = a.Pa();
            if (this.s || b < a.i || b > a.a) {
                var c = this.f, d = this.o;
                b = a.constrainResolution(b, 0, this.j - 1);
                Tg(a, b, c, d);
            }
            return !1;
        }
        return !0;
    }
    function Wh(a) {
        return 2 <= this.l.length ? (a = a.map, this.f = null, this.a = void 0, this.j = 1, this.D || bg(a.aa(), 1, 1), !0) : !1;
    }
    Vh.prototype.jd = Se;
    function Zh(a) {
        a = a ? a : {};
        var b = new B(), c = new Gg(-0.005, 0.05, 100);
        (void 0 !== a.altShiftDragRotate ? a.altShiftDragRotate : 1) && b.push(new mh());
        (void 0 !== a.doubleClickZoom ? a.doubleClickZoom : 1) && b.push(new Ug({
            delta: a.zoomDelta,
            duration: a.zoomDuration
        }));
        (void 0 !== a.dragPan ? a.dragPan : 1) && b.push(new ih({ kinetic: c }));
        (void 0 !== a.pinchRotate ? a.pinchRotate : 1) && b.push(new Rh());
        (void 0 !== a.pinchZoom ? a.pinchZoom : 1) && b.push(new Vh({
            constrainResolution: a.constrainResolution,
            duration: a.zoomDuration
        }));
        if (void 0 !== a.keyboard ? a.keyboard : 1)
            b.push(new Dh()), b.push(new Fh({
                delta: a.zoomDelta,
                duration: a.zoomDuration
            }));
        (void 0 !== a.mouseWheelZoom ? a.mouseWheelZoom : 1) && b.push(new Hh({
            constrainResolution: a.constrainResolution,
            duration: a.zoomDuration
        }));
        (void 0 !== a.shiftDragZoom ? a.shiftDragZoom : 1) && b.push(new Ch({ duration: a.zoomDuration }));
        return b;
    }
    function $h(a, b, c, d) {
        Sc.call(this);
        this.extent = a;
        this.a = c;
        this.resolution = b;
        this.state = d;
    }
    w($h, Sc);
    $h.prototype.u = function () {
        this.b('change');
    };
    $h.prototype.G = function () {
        return this.extent;
    };
    $h.prototype.getState = function () {
        return this.state;
    };
    function ai(a, b, c, d, e) {
        this.c = void 0 !== e ? e : null;
        $h.call(this, a, b, c, void 0 !== e ? 0 : 2);
        this.g = d;
    }
    w(ai, $h);
    ai.prototype.i = function (a) {
        this.state = a ? 3 : 2;
        this.u();
    };
    ai.prototype.load = function () {
        0 == this.state && (this.state = 1, this.u(), this.c(this.i.bind(this)));
    };
    ai.prototype.Y = function () {
        return this.g;
    };
    function bi(a, b, c, d, e) {
        Qc.call(this, a);
        this.vectorContext = b;
        this.frameState = c;
        this.context = d;
        this.glContext = e;
    }
    w(bi, Qc);
    function ci(a) {
        Sc.call(this);
        this.highWaterMark = void 0 !== a ? a : 2048;
        this.i = 0;
        this.a = {};
        this.c = this.g = null;
    }
    w(ci, Sc);
    function di(a) {
        return a.i > a.highWaterMark;
    }
    k = ci.prototype;
    k.clear = function () {
        this.i = 0;
        this.a = {};
        this.c = this.g = null;
        this.b('clear');
    };
    k.forEach = function (a, b) {
        for (var c = this.g; c;)
            a.call(b, c.Pc, c.jc, this), c = c.kb;
    };
    k.get = function (a) {
        a = this.a[a];
        oa(void 0 !== a, 15);
        if (a === this.c)
            return a.Pc;
        a === this.g ? (this.g = this.g.kb, this.g.Pb = null) : (a.kb.Pb = a.Pb, a.Pb.kb = a.kb);
        a.kb = null;
        a.Pb = this.c;
        this.c = this.c.kb = a;
        return a.Pc;
    };
    k.remove = function (a) {
        var b = this.a[a];
        oa(void 0 !== b, 15);
        if (b === this.c) {
            if (this.c = b.Pb)
                this.c.kb = null;
        } else if (b === this.g) {
            if (this.g = b.kb)
                this.g.Pb = null;
        } else
            b.kb.Pb = b.Pb, b.Pb.kb = b.kb;
        delete this.a[a];
        --this.i;
        return b.Pc;
    };
    k.pop = function () {
        var a = this.g;
        delete this.a[a.jc];
        a.kb && (a.kb.Pb = null);
        this.g = a.kb;
        this.g || (this.c = null);
        --this.i;
        return a.Pc;
    };
    k.replace = function (a, b) {
        this.get(a);
        this.a[a].Pc = b;
    };
    k.set = function (a, b) {
        oa(!(a in this.a), 16);
        b = {
            jc: a,
            kb: null,
            Pb: this.c,
            Pc: b
        };
        this.c ? this.c.kb = b : this.g = b;
        this.c = b;
        this.a[a] = b;
        ++this.i;
    };
    var ei = [
            0,
            0,
            0,
            1
        ], fi = [], gi = [
            0,
            0,
            0,
            1
        ], hi = [
            0,
            0,
            0,
            0
        ], ii = new ci(), ji = {}, ki = null, li = {}, ni = function () {
            function a(a) {
                var b = mi();
                b.font = '32px monospace';
                f = b.measureText('wmytzilWMYTZIL@#/&?$%10').width;
                var c = !0;
                'monospace' != a && (b.font = '32px ' + a + ',monospace', c = b.measureText('wmytzilWMYTZIL@#/&?$%10').width != f);
                return c;
            }
            function b() {
                var b = !0, f;
                for (f in c)
                    60 > c[f] && (a(f) ? (c[f] = 60, lb(li), ki = null, d.clear()) : (++c[f], b = !1));
                b && (window.clearInterval(e), e = void 0);
            }
            var c = ji, d = ii, e, f;
            return function (d) {
                if (d = wg(d))
                    for (var f = 0, g = d.length; f < g; ++f) {
                        var m = d[f];
                        m in c || (c[m] = 60, a(m) || (c[m] = 0, void 0 === e && (e = window.setInterval(b, 32))));
                    }
            };
        }();
    function mi() {
        var a = ki;
        a || (a = ki = hg(1, 1));
        return a;
    }
    var oi = function () {
        var a;
        return function (b) {
            var c = li[b];
            void 0 == c && (a || (a = document.createElement('span'), a.textContent = 'M', a.style.margin = a.style.padding = '0 !important', a.style.position = 'absolute !important', a.style.left = '-99999px !important'), a.style.font = b, document.body.appendChild(a), c = li[b] = a.offsetHeight, document.body.removeChild(a));
            return c;
        };
    }();
    function pi(a, b) {
        var c = mi();
        a != c.font && (c.font = a);
        return c.measureText(b).width;
    }
    function qi(a, b, c, d) {
        0 !== b && (a.translate(c, d), a.rotate(b), a.translate(-c, -d));
    }
    var ri = We();
    function si(a, b, c, d, e, f, g, h, l, m, n) {
        if (1 != c) {
            var p = a.globalAlpha;
            a.globalAlpha = p * c;
        }
        b && a.setTransform.apply(a, b);
        a.drawImage(d, e, f, g, h, l, m, g * n, h * n);
        p && (a.globalAlpha = p);
        b && a.setTransform.apply(a, ri);
    }
    var ti = /^#(?:[0-9a-f]{3,4}){1,2}$/i, ui = /^([a-z]*)$/i;
    function vi(a) {
        return Array.isArray(a) ? a : wi(a);
    }
    function xi(a) {
        if ('string' !== typeof a) {
            var b = a[0];
            b != (b | 0) && (b = b + 0.5 | 0);
            var c = a[1];
            c != (c | 0) && (c = c + 0.5 | 0);
            var d = a[2];
            d != (d | 0) && (d = d + 0.5 | 0);
            a = 'rgba(' + b + ',' + c + ',' + d + ',' + (void 0 === a[3] ? 1 : a[3]) + ')';
        }
        return a;
    }
    var wi = function () {
        var a = {}, b = 0;
        return function (c) {
            if (a.hasOwnProperty(c))
                var d = a[c];
            else {
                if (1024 <= b) {
                    d = 0;
                    for (var e in a)
                        0 === (d++ & 3) && (delete a[e], --b);
                }
                d = c;
                ui.exec(d) && (e = document.createElement('div'), e.style.color = d, document.body.appendChild(e), d = getComputedStyle(e).color, document.body.removeChild(e));
                if (ti.exec(d)) {
                    e = d.length - 1;
                    var f = 4 >= e ? 1 : 2;
                    var g = 4 === e || 8 === e;
                    e = parseInt(d.substr(1 + 0 * f, f), 16);
                    var h = parseInt(d.substr(1 + 1 * f, f), 16);
                    var l = parseInt(d.substr(1 + 2 * f, f), 16);
                    d = g ? parseInt(d.substr(1 + 3 * f, f), 16) : 255;
                    1 == f && (e = (e << 4) + e, h = (h << 4) + h, l = (l << 4) + l, g && (d = (d << 4) + d));
                    f = [
                        e,
                        h,
                        l,
                        d / 255
                    ];
                } else
                    0 == d.indexOf('rgba(') ? (d = d.slice(5, -1).split(',').map(Number), f = yi(d)) : 0 == d.indexOf('rgb(') ? (d = d.slice(4, -1).split(',').map(Number), d.push(1), f = yi(d)) : oa(!1, 14);
                d = f;
                a[c] = d;
                ++b;
            }
            return d;
        };
    }();
    function yi(a) {
        var b = [];
        b[0] = pa(a[0] + 0.5 | 0, 0, 255);
        b[1] = pa(a[1] + 0.5 | 0, 0, 255);
        b[2] = pa(a[2] + 0.5 | 0, 0, 255);
        b[3] = pa(a[3], 0, 1);
        return b;
    }
    function zi(a) {
        return 'string' === typeof a || a instanceof CanvasPattern || a instanceof CanvasGradient ? a : xi(a);
    }
    function Ai() {
    }
    k = Ai.prototype;
    k.Hh = function () {
    };
    k.Hb = function () {
    };
    k.Dd = function () {
    };
    k.cc = function () {
    };
    k.Ce = function () {
    };
    k.De = function () {
    };
    k.uc = function () {
    };
    k.vc = function () {
    };
    k.wc = function () {
    };
    k.xc = function () {
    };
    k.yc = function () {
    };
    k.zc = function () {
    };
    k.Wb = function () {
    };
    k.Oa = function () {
    };
    k.Zb = function () {
    };
    k.nb = function () {
    };
    function Bi(a, b, c, d, e) {
        this.g = a;
        this.f = b;
        this.c = c;
        this.N = d;
        this.ob = e;
        this.M = this.b = this.a = this.Wa = this.O = this.T = null;
        this.$ = this.V = this.v = this.B = this.C = this.D = 0;
        this.ca = !1;
        this.i = this.ab = 0;
        this.ra = !1;
        this.oa = 0;
        this.ta = '';
        this.Ub = this.ua = 0;
        this.Ea = !1;
        this.s = this.La = 0;
        this.qa = this.l = this.j = null;
        this.o = [];
        this.bb = We();
    }
    w(Bi, Ai);
    function Ci(a, b, c) {
        if (a.M) {
            b = Te(b, 0, c, 2, a.N, a.o);
            c = a.g;
            var d = a.bb, e = c.globalAlpha;
            1 != a.v && (c.globalAlpha = e * a.v);
            var f = a.ab;
            a.ca && (f += a.ob);
            var g;
            var h = 0;
            for (g = b.length; h < g; h += 2) {
                var l = b[h] - a.D, m = b[h + 1] - a.C;
                a.ra && (l = Math.round(l), m = Math.round(m));
                if (0 !== f || 1 != a.i) {
                    var n = l + a.D, p = m + a.C;
                    ef(d, n, p, a.i, a.i, f, -n, -p);
                    c.setTransform.apply(c, d);
                }
                c.drawImage(a.M, a.V, a.$, a.oa, a.B, l, m, a.oa, a.B);
            }
            0 === f && 1 == a.i || c.setTransform(1, 0, 0, 1, 0, 0);
            1 != a.v && (c.globalAlpha = e);
        }
    }
    function Di(a, b, c, d) {
        var e = 0;
        if (a.qa && '' !== a.ta) {
            a.j && Ei(a, a.j);
            a.l && Fi(a, a.l);
            var f = a.qa, g = a.g, h = a.Wa, l = f.textAlign ? f.textAlign : 'center';
            h ? (h.font != f.font && (h.font = g.font = f.font), h.textAlign != l && (h.textAlign = l), h.textBaseline != f.textBaseline && (h.textBaseline = g.textBaseline = f.textBaseline)) : (g.font = f.font, g.textAlign = l, g.textBaseline = f.textBaseline, a.Wa = {
                font: f.font,
                textAlign: l,
                textBaseline: f.textBaseline
            });
            b = Te(b, e, c, d, a.N, a.o);
            f = a.g;
            g = a.La;
            for (a.Ea && (g += a.ob); e < c; e += d) {
                h = b[e] + a.ua;
                l = b[e + 1] + a.Ub;
                if (0 !== g || 1 != a.s) {
                    var m = ef(a.bb, h, l, a.s, a.s, g, -h, -l);
                    f.setTransform.apply(f, m);
                }
                a.l && f.strokeText(a.ta, h, l);
                a.j && f.fillText(a.ta, h, l);
            }
            0 === g && 1 == a.s || f.setTransform(1, 0, 0, 1, 0, 0);
        }
    }
    function Gi(a, b, c, d, e, f) {
        var g = a.g;
        a = Te(b, c, d, e, a.N, a.o);
        g.moveTo(a[0], a[1]);
        b = a.length;
        f && (b -= 2);
        for (c = 2; c < b; c += 2)
            g.lineTo(a[c], a[c + 1]);
        f && g.closePath();
        return d;
    }
    function Hi(a, b, c, d, e) {
        var f;
        var g = 0;
        for (f = d.length; g < f; ++g)
            c = Gi(a, b, c, d[g], e, !0);
        return c;
    }
    k = Bi.prototype;
    k.cc = function (a) {
        if (hb(this.c, a.G())) {
            if (this.a || this.b) {
                this.a && Ei(this, this.a);
                this.b && Fi(this, this.b);
                var b = this.N;
                var c = this.o, d = a.da();
                b = d ? Te(d, 0, d.length, a.pa(), b, c) : null;
                c = b[2] - b[0];
                d = b[3] - b[1];
                c = Math.sqrt(c * c + d * d);
                d = this.g;
                d.beginPath();
                d.arc(b[0], b[1], c, 0, 2 * Math.PI);
                this.a && d.fill();
                this.b && d.stroke();
            }
            '' !== this.ta && Di(this, a.xa(), 2, 2);
        }
    };
    k.Dd = function (a) {
        this.Oa(a.Fa(), a.Ga());
        this.Zb(a.Y());
        this.nb(a.Ka());
    };
    k.Hb = function (a) {
        switch (a.S()) {
        case 'Point':
            this.yc(a);
            break;
        case 'LineString':
            this.uc(a);
            break;
        case 'Polygon':
            this.zc(a);
            break;
        case 'MultiPoint':
            this.wc(a);
            break;
        case 'MultiLineString':
            this.vc(a);
            break;
        case 'MultiPolygon':
            this.xc(a);
            break;
        case 'GeometryCollection':
            this.De(a);
            break;
        case 'Circle':
            this.cc(a);
        }
    };
    k.Ce = function (a, b) {
        (a = (0, b.cb)(a)) && hb(this.c, a.G()) && (this.Dd(b), this.Hb(a));
    };
    k.De = function (a) {
        a = a.a;
        var b;
        var c = 0;
        for (b = a.length; c < b; ++c)
            this.Hb(a[c]);
    };
    k.yc = function (a) {
        var b = a.da();
        a = a.pa();
        this.M && Ci(this, b, b.length);
        '' !== this.ta && Di(this, b, b.length, a);
    };
    k.wc = function (a) {
        var b = a.da();
        a = a.pa();
        this.M && Ci(this, b, b.length);
        '' !== this.ta && Di(this, b, b.length, a);
    };
    k.uc = function (a) {
        if (hb(this.c, a.G())) {
            if (this.b) {
                Fi(this, this.b);
                var b = this.g, c = a.da();
                b.beginPath();
                Gi(this, c, 0, c.length, a.pa(), !1);
                b.stroke();
            }
            '' !== this.ta && (a = a.Fe(), Di(this, a, 2, 2));
        }
    };
    k.vc = function (a) {
        var b = a.G();
        if (hb(this.c, b)) {
            if (this.b) {
                Fi(this, this.b);
                b = this.g;
                var c = a.da(), d = 0, e = a.pb(), f = a.pa();
                b.beginPath();
                var g;
                var h = 0;
                for (g = e.length; h < g; ++h)
                    d = Gi(this, c, d, e[h], f, !1);
                b.stroke();
            }
            '' !== this.ta && (a = a.Ge(), Di(this, a, a.length, 2));
        }
    };
    k.zc = function (a) {
        if (hb(this.c, a.G())) {
            if (this.b || this.a) {
                this.a && Ei(this, this.a);
                this.b && Fi(this, this.b);
                var b = this.g;
                b.beginPath();
                Hi(this, a.Xb(), 0, a.pb(), a.pa());
                this.a && b.fill();
                this.b && b.stroke();
            }
            '' !== this.ta && (a = a.Td(), Di(this, a, 2, 2));
        }
    };
    k.xc = function (a) {
        if (hb(this.c, a.G())) {
            if (this.b || this.a) {
                this.a && Ei(this, this.a);
                this.b && Fi(this, this.b);
                var b = this.g, c = Ii(a), d = 0, e = a.td(), f = a.pa(), g;
                b.beginPath();
                var h = 0;
                for (g = e.length; h < g; ++h)
                    d = Hi(this, c, d, e[h], f);
                this.a && b.fill();
                this.b && b.stroke();
            }
            '' !== this.ta && (a = Ji(a), Di(this, a, a.length, 2));
        }
    };
    function Ei(a, b) {
        var c = a.g, d = a.T;
        d ? d.fillStyle != b.fillStyle && (d.fillStyle = c.fillStyle = b.fillStyle) : (c.fillStyle = b.fillStyle, a.T = { fillStyle: b.fillStyle });
    }
    function Fi(a, b) {
        var c = a.g, d = a.O;
        d ? (d.lineCap != b.lineCap && (d.lineCap = c.lineCap = b.lineCap), od && (jc(d.lineDash, b.lineDash) || c.setLineDash(d.lineDash = b.lineDash), d.lineDashOffset != b.lineDashOffset && (d.lineDashOffset = c.lineDashOffset = b.lineDashOffset)), d.lineJoin != b.lineJoin && (d.lineJoin = c.lineJoin = b.lineJoin), d.lineWidth != b.lineWidth && (d.lineWidth = c.lineWidth = b.lineWidth), d.miterLimit != b.miterLimit && (d.miterLimit = c.miterLimit = b.miterLimit), d.strokeStyle != b.strokeStyle && (d.strokeStyle = c.strokeStyle = b.strokeStyle)) : (c.lineCap = b.lineCap, od && (c.setLineDash(b.lineDash), c.lineDashOffset = b.lineDashOffset), c.lineJoin = b.lineJoin, c.lineWidth = b.lineWidth, c.miterLimit = b.miterLimit, c.strokeStyle = b.strokeStyle, a.O = {
            lineCap: b.lineCap,
            lineDash: b.lineDash,
            lineDashOffset: b.lineDashOffset,
            lineJoin: b.lineJoin,
            lineWidth: b.lineWidth,
            miterLimit: b.miterLimit,
            strokeStyle: b.strokeStyle
        });
    }
    k.Oa = function (a, b) {
        a ? (a = a.b, this.a = { fillStyle: zi(a ? a : ei) }) : this.a = null;
        if (b) {
            a = b.a;
            var c = b.f, d = b.g, e = b.i, f = b.j, g = b.c;
            b = b.l;
            this.b = {
                lineCap: void 0 !== c ? c : 'round',
                lineDash: d ? d : fi,
                lineDashOffset: e ? e : 0,
                lineJoin: void 0 !== f ? f : 'round',
                lineWidth: this.f * (void 0 !== g ? g : 1),
                miterLimit: void 0 !== b ? b : 10,
                strokeStyle: zi(a ? a : gi)
            };
        } else
            this.b = null;
    };
    k.Zb = function (a) {
        if (a) {
            var b = a.Vc(), c = a.Y(1), d = a.bd(), e = a.oc();
            this.D = b[0];
            this.C = b[1];
            this.B = e[1];
            this.M = c;
            this.v = a.i;
            this.V = d[0];
            this.$ = d[1];
            this.ca = a.s;
            this.ab = a.f;
            this.i = a.a * this.f;
            this.ra = a.v;
            this.oa = e[0];
        } else
            this.M = null;
    };
    k.nb = function (a) {
        if (a) {
            var b = a.Fa();
            b ? (b = b.b, this.j = { fillStyle: zi(b ? b : ei) }) : this.j = null;
            var c = a.Ga();
            if (c) {
                b = c.a;
                var d = c.f, e = c.g, f = c.i, g = c.j, h = c.c;
                c = c.l;
                this.l = {
                    lineCap: void 0 !== d ? d : 'round',
                    lineDash: e ? e : fi,
                    lineDashOffset: f ? f : 0,
                    lineJoin: void 0 !== g ? g : 'round',
                    lineWidth: void 0 !== h ? h : 1,
                    miterLimit: void 0 !== c ? c : 10,
                    strokeStyle: zi(b ? b : gi)
                };
            } else
                this.l = null;
            b = a.a;
            d = a.g;
            e = a.c;
            f = a.l;
            g = a.i;
            h = a.b;
            c = a.Ka();
            var l = a.f;
            a = a.j;
            this.qa = {
                font: void 0 !== b ? b : '10px sans-serif',
                textAlign: void 0 !== l ? l : 'center',
                textBaseline: void 0 !== a ? a : 'middle'
            };
            this.ta = void 0 !== c ? c : '';
            this.ua = void 0 !== d ? this.f * d : 0;
            this.Ub = void 0 !== e ? this.f * e : 0;
            this.Ea = void 0 !== f ? f : !1;
            this.La = void 0 !== g ? g : 0;
            this.s = this.f * (void 0 !== h ? h : 1);
        } else
            this.ta = '';
    };
    function Ki(a) {
        Uc.call(this);
        this.a = a;
    }
    w(Ki, Uc);
    Ki.prototype.wa = ea;
    Ki.prototype.cf = Se;
    Ki.prototype.Rf = function (a, b, c) {
        return function (d, e) {
            return Li(a, b, d, e, function (a) {
                c[d] || (c[d] = {});
                c[d][a.ya.toString()] = a;
            });
        };
    };
    Ki.prototype.$ = function (a) {
        2 === a.target.getState() && Mi(this);
    };
    function Si(a, b) {
        var c = b.getState();
        2 != c && 3 != c && y(b, 'change', a.$, a);
        0 == c && (b.load(), c = b.getState());
        return 2 == c;
    }
    function Mi(a) {
        var b = a.a;
        b.Jb() && 'ready' == b.hg() && a.u();
    }
    function Ti(a, b) {
        b.cj() && a.postRenderFunctions.push(function (a, b, e) {
            b = x(a).toString();
            b in e.usedTiles && a.sd(e.viewState.projection, e.usedTiles[b]);
        }.bind(null, b));
    }
    function Ui(a, b) {
        b = b.T;
        void 0 !== b && ('string' === typeof b ? a.logos[b] = '' : b && (oa('string' == typeof b.href, 44), oa('string' == typeof b.src, 45), a.logos[b.src] = b.href));
    }
    function Vi(a, b, c, d) {
        b = x(b).toString();
        c = c.toString();
        b in a ? c in a[b] ? (a = a[b][c], d.fa < a.fa && (a.fa = d.fa), d.la > a.la && (a.la = d.la), d.ea < a.ea && (a.ea = d.ea), d.ka > a.ka && (a.ka = d.ka)) : a[b][c] = d : (a[b] = {}, a[b][c] = d);
    }
    function Wi(a, b, c, d, e, f, g, h, l, m) {
        var n = x(b).toString();
        n in a.wantedTiles || (a.wantedTiles[n] = {});
        var p = a.wantedTiles[n];
        a = a.tileQueue;
        var q, r, u;
        for (u = c.minZoom; u <= g; ++u) {
            var v = tc(c, f, u, v);
            var z = c.Ta(u);
            for (q = v.fa; q <= v.la; ++q)
                for (r = v.ea; r <= v.ka; ++r)
                    if (g - u <= h) {
                        var A = b.ad(u, q, r, d, e);
                        0 == A.getState() && (p[A.lb()] = !0, A.lb() in a.a || a.i([
                            A,
                            n,
                            yc(c, A.ya),
                            z
                        ]));
                        void 0 !== l && l.call(m, A);
                    } else
                        b.kh(u, q, r, e);
        }
    }
    function Xi(a) {
        Ki.call(this, a);
        this.V = We();
    }
    w(Xi, Ki);
    function Yi(a, b, c) {
        var d = b.pixelRatio, e = b.size[0] * d, f = b.size[1] * d, g = b.viewState.rotation, h = $a(c), l = Za(c), m = Ya(c);
        c = Wa(c);
        af(b.coordinateToPixelTransform, h);
        af(b.coordinateToPixelTransform, l);
        af(b.coordinateToPixelTransform, m);
        af(b.coordinateToPixelTransform, c);
        a.save();
        qi(a, -g, e / 2, f / 2);
        a.beginPath();
        a.moveTo(h[0] * d, h[1] * d);
        a.lineTo(l[0] * d, l[1] * d);
        a.lineTo(m[0] * d, m[1] * d);
        a.lineTo(c[0] * d, c[1] * d);
        a.clip();
        qi(a, g, e / 2, f / 2);
    }
    function Zi(a, b, c, d, e) {
        var f = a.a;
        if (Tc(f, b)) {
            var g = d.size[0] * d.pixelRatio, h = d.size[1] * d.pixelRatio, l = d.viewState.rotation;
            qi(c, -l, g / 2, h / 2);
            a = void 0 !== e ? e : $i(a, d, 0);
            f.b(new bi(b, new Bi(c, d.pixelRatio, d.extent, a, d.viewState.rotation), d, c, null));
            qi(c, l, g / 2, h / 2);
        }
    }
    Xi.prototype.s = function (a, b, c, d) {
        if (this.wa(a, b, 0, Re, this))
            return c.call(d, this.a, null);
    };
    Xi.prototype.pf = function (a, b, c, d) {
        Zi(this, 'postcompose', a, b, d);
    };
    function $i(a, b, c) {
        var d = b.viewState, e = b.pixelRatio, f = e / d.resolution;
        return ef(a.V, e * b.size[0] / 2, e * b.size[1] / 2, f, -f, -d.rotation, -d.center[0] + c, -d.center[1]);
    }
    function aj(a) {
        Xi.call(this, a);
        this.l = We();
        this.j = null;
    }
    w(aj, Xi);
    aj.prototype.df = function (a, b, c) {
        Zi(this, 'precompose', c, a, void 0);
        var d = this.Y();
        if (d) {
            var e = b.extent, f = void 0 !== e && !La(e, a.extent) && hb(e, a.extent);
            f && Yi(c, a, e);
            e = this.v();
            var g = c.globalAlpha;
            c.globalAlpha = b.opacity;
            c.drawImage(d, 0, 0, +d.width, +d.height, Math.round(e[4]), Math.round(e[5]), Math.round(d.width * e[0]), Math.round(d.height * e[3]));
            c.globalAlpha = g;
            f && c.restore();
        }
        this.pf(c, a, b);
    };
    aj.prototype.wa = function (a, b, c, d, e) {
        var f = this.a;
        return f.ha().wa(a, b.viewState.resolution, b.viewState.rotation, c, b.skippedFeatureUids, function (a) {
            return d.call(e, a, f);
        });
    };
    aj.prototype.s = function (a, b, c, d) {
        if (this.Y()) {
            if (this.a.ha().wa !== ea)
                return Xi.prototype.s.apply(this, arguments);
            var e = af(this.l, a.slice());
            Ge(e, b.viewState.resolution / this.i);
            this.j || (this.j = hg(1, 1));
            this.j.clearRect(0, 0, 1, 1);
            this.j.drawImage(this.Y(), e[0], e[1], 1, 1, 0, 0, 1, 1);
            e = this.j.getImageData(0, 0, 1, 1).data;
            if (0 < e[3])
                return c.call(d, this.a, e);
        }
    };
    function bj(a) {
        aj.call(this, a);
        this.M = null;
        this.f = We();
        this.o = [];
        this.c = null;
    }
    w(bj, aj);
    bj.handles = function (a, b) {
        return 'canvas' === a && ('IMAGE' === b.S() || 'VECTOR' === b.S() && 'image' === b.l);
    };
    bj.create = function (a, b) {
        var c = new bj(b);
        if ('VECTOR' === b.S())
            for (var d = 0, e = pg.length; d < e; ++d) {
                var f = pg[d];
                f !== bj && f.handles('canvas', b) && (f = f.create(a, b), c.c = f);
            }
        return c;
    };
    bj.prototype.Y = function () {
        return this.M ? this.M.Y() : null;
    };
    bj.prototype.v = function () {
        return this.f;
    };
    bj.prototype.$c = function (a, b) {
        var c = a.pixelRatio, d = a.size, e = a.viewState, f = e.center, g = e.resolution, h = this.a.ha(), l = a.viewHints, m = a.extent;
        void 0 !== b.extent && (m = gb(m, b.extent));
        if (!l[0] && !l[1] && !bb(m))
            if (l = e.projection, e = this.c) {
                l = e.context;
                var n = kb({}, a, {
                        size: [
                            cb(m) / g,
                            db(m) / g
                        ],
                        viewState: kb({}, a.viewState, { rotation: 0 })
                    }), p = Object.keys(n.skippedFeatureUids).sort();
                !e.$c(n, b) || !e.j && jc(p, this.o) || (l.canvas.width = n.size[0] * c, l.canvas.height = n.size[1] * c, e.df(n, b, l), this.M = new ai(m, g, c, l.canvas), this.o = p);
            } else
                (e = h.Y(m, g, c, l)) && Si(this, e) && (this.M = e);
        this.M && (e = this.M, m = e.G(), b = e.resolution, e = e.a, l = c * b / (g * e), m = ef(this.f, c * d[0] / 2, c * d[1] / 2, l, l, 0, e * (m[0] - f[0]) / b, e * (f[1] - m[3]) / b), ef(this.l, c * d[0] / 2 - m[4], c * d[1] / 2 - m[5], c / g, -c / g, 0, -f[0], -f[1]), Ui(a, h), this.i = b * c / e);
        return !!this.M;
    };
    bj.prototype.wa = function (a, b, c, d, e) {
        return this.c ? this.c.wa(a, b, c, d, e) : aj.prototype.wa.call(this, a, b, c, d, e);
    };
    function cj() {
        this.b = {};
        this.a = 0;
        this.g = 32;
    }
    cj.prototype.clear = function () {
        this.b = {};
        this.a = 0;
    };
    function dj(a) {
        if (a.a > a.g) {
            var b = 0, c;
            for (c in a.b) {
                var d = a.b[c];
                0 !== (b++ & 3) || Tc(d) || (delete a.b[c], --a.a);
            }
        }
    }
    cj.prototype.get = function (a, b, c) {
        a = b + ':' + a + ':' + (c ? xi(c) : 'null');
        return a in this.b ? this.b[a] : null;
    };
    cj.prototype.set = function (a, b, c, d) {
        this.b[b + ':' + a + ':' + (c ? xi(c) : 'null')] = d;
        ++this.a;
    };
    cj.prototype.c = function (a) {
        this.g = a;
        dj(this);
    };
    var ej = new cj();
    function fj(a, b) {
        this.l = b;
        this.c = {};
        this.v = {};
    }
    w(fj, Oc);
    function gj(a) {
        var b = a.viewState, c = a.coordinateToPixelTransform, d = a.pixelToCoordinateTransform;
        ef(c, a.size[0] / 2, a.size[1] / 2, 1 / b.resolution, -1 / b.resolution, -b.rotation, -b.center[0], -b.center[1]);
        ff($e(d, c));
    }
    function hj() {
        dj(ej);
    }
    k = fj.prototype;
    k.wa = function (a, b, c, d, e, f, g) {
        function h(a, c) {
            var f = x(a).toString(), g = b.layerStates[x(c)].Te;
            if (!(f in b.skippedFeatureUids) || g)
                return d.call(e, a, g ? c : null);
        }
        var l, m = b.viewState, n = m.resolution, p = m.projection;
        m = a;
        if (p.g) {
            p = p.G();
            var q = cb(p), r = a[0];
            if (r < p[0] || r > p[2])
                m = [
                    r + q * Math.ceil((p[0] - r) / q),
                    a[1]
                ];
        }
        p = b.layerStatesArray;
        for (q = p.length - 1; 0 <= q; --q) {
            var u = p[q];
            r = u.layer;
            if (yg(u, n) && f.call(g, r) && (u = ij(this, r), r.ha() && (l = u.wa(r.ha().D ? m : a, b, c, h, e)), l))
                return l;
        }
    };
    k.Ui = function (a, b, c, d, e) {
        return void 0 !== this.wa(a, b, c, Re, this, d, e);
    };
    function ij(a, b) {
        var c = x(b).toString();
        if (c in a.c)
            return a.c[c];
        for (var d, e = a.S(), f = 0, g = pg.length; f < g; ++f) {
            var h = pg[f];
            if (h.handles(e, b)) {
                d = h.create(a, b);
                break;
            }
        }
        if (d)
            a.c[c] = d, a.v[c] = y(d, 'change', a.gm, a);
        else
            throw Error('Unable to create renderer for layer: ' + b.S());
        return d;
    }
    k.gm = function () {
        this.l.render();
    };
    function tg(a, b) {
        var c = a.c[b];
        delete a.c[b];
        Gc(a.v[b]);
        delete a.v[b];
        return c;
    }
    k.bh = ea;
    k.oq = function (a, b) {
        for (var c in this.c)
            b && c in b.layerStates || Pc(tg(this, c));
    };
    function jj(a, b) {
        for (var c in a.c)
            if (!(c in b.layerStates)) {
                b.postRenderFunctions.push(a.oq.bind(a));
                break;
            }
    }
    function lc(a, b) {
        return a.zIndex - b.zIndex;
    }
    function kj(a, b) {
        fj.call(this, a, b);
        this.g = hg();
        this.b = this.g.canvas;
        this.b.style.width = '100%';
        this.b.style.height = '100%';
        this.b.style.display = 'block';
        this.b.className = 'ol-unselectable';
        a.insertBefore(this.b, a.childNodes[0] || null);
        this.a = !0;
        this.i = We();
    }
    w(kj, fj);
    kj.handles = function (a) {
        return 'canvas' === a;
    };
    kj.create = function (a, b) {
        return new kj(a, b);
    };
    function lj(a, b, c) {
        var d = a.l, e = a.g;
        if (Tc(d, b)) {
            var f = c.extent, g = c.pixelRatio, h = c.viewState.rotation, l = c.viewState, m = c.pixelRatio / l.resolution;
            a = ef(a.i, a.b.width / 2, a.b.height / 2, m, -m, -l.rotation, -l.center[0], -l.center[1]);
            d.b(new bi(b, new Bi(e, g, f, a, h), c, e, null));
        }
    }
    kj.prototype.S = function () {
        return 'canvas';
    };
    kj.prototype.bh = function (a) {
        if (a) {
            var b = this.g, c = a.pixelRatio, d = Math.round(a.size[0] * c), e = Math.round(a.size[1] * c);
            this.b.width != d || this.b.height != e ? (this.b.width = d, this.b.height = e) : b.clearRect(0, 0, d, e);
            c = a.viewState.rotation;
            gj(a);
            lj(this, 'precompose', a);
            var f = a.layerStatesArray;
            kc(f);
            c && (b.save(), qi(b, c, d / 2, e / 2));
            d = a.viewState.resolution;
            var g;
            e = 0;
            for (g = f.length; e < g; ++e) {
                var h = f[e];
                var l = h.layer;
                l = ij(this, l);
                yg(h, d) && 'ready' == h.Vj && l.$c(a, h) && l.df(a, h, b);
            }
            c && b.restore();
            lj(this, 'postcompose', a);
            this.a || (this.b.style.display = '', this.a = !0);
            jj(this, a);
            a.postRenderFunctions.push(hj);
        } else
            this.a && (this.b.style.display = 'none', this.a = !1);
    };
    kj.prototype.Ti = function (a, b, c, d, e, f) {
        var g = b.viewState.resolution, h = b.layerStatesArray, l = h.length;
        a = af(b.pixelToCoordinateTransform, a.slice());
        for (--l; 0 <= l; --l) {
            var m = h[l];
            var n = m.layer;
            if (yg(m, g) && e.call(f, n) && (m = ij(this, n).s(a, b, c, d)))
                return m;
        }
    };
    function mj(a) {
        aj.call(this, a);
        this.context = null === this.context ? null : hg();
        this.c = null;
        this.f = [];
        this.T = Da();
        this.ra = new ja(0, 0, 0, 0);
        this.o = We();
        this.O = 0;
    }
    w(mj, aj);
    mj.handles = function (a, b) {
        return 'canvas' === a && 'TILE' === b.S();
    };
    mj.create = function (a, b) {
        return new mj(b);
    };
    function nj(a, b) {
        b = b.getState();
        a = a.a.i();
        return 2 == b || 4 == b || 3 == b && !a;
    }
    mj.prototype.$c = function (a, b) {
        var c = a.pixelRatio, d = a.size, e = a.viewState, f = e.projection, g = e.resolution;
        e = e.center;
        var h = this.a, l = h.ha(), m = l.g, n = l.eb(f), p = n.Dc(g, this.O), q = n.Ta(p), r = Math.round(g / q) || 1, u = a.extent;
        void 0 !== b.extent && (u = gb(u, b.extent));
        if (bb(u))
            return !1;
        var v = tc(n, u, p), z = wc(n, p, v), A = l.Xc(c), E = {};
        E[p] = {};
        var S = this.Rf(l, f, E), Ia = this.T, ta = this.ra, la = !1, ca, ia;
        for (ca = v.fa; ca <= v.la; ++ca)
            for (ia = v.ea; ia <= v.ka; ++ia) {
                var xa = l.ad(p, ca, ia, c, f);
                3 == xa.getState() && (h.i() ? 0 < h.c() && (la = !0) : oj(xa, 2));
                nj(this, xa) || (xa = pj(xa));
                if (nj(this, xa)) {
                    var Va = x(this);
                    if (2 == xa.getState()) {
                        E[p][xa.ya.toString()] = xa;
                        var ic = xa.j ? -1 !== xa.s[Va] : !1;
                        la || !ic && -1 !== this.f.indexOf(xa) || (la = !0);
                    }
                    if (1 === qj(xa, Va, a.time))
                        continue;
                }
                Va = vc(n, xa.ya, ta, Ia);
                ic = !1;
                Va && (ic = S(p + 1, Va));
                ic || uc(n, xa.ya, S, ta, Ia);
            }
        xa = a.viewHints;
        xa = xa[0] || xa[1];
        if (!(this.i && 16 < Date.now() - a.time && xa || !la && this.c && La(this.c, u) && this.wf == m && r == this.C && (xa || q * c / A * r == this.i))) {
            if (xa = this.context)
                ia = l.Zd(p, c, f), ca = Math.round((v.la - v.fa + 1) * ia[0] / r), ia = Math.round((v.ka - v.ea + 1) * ia[1] / r), la = xa.canvas, la.width != ca || la.height != ia ? (this.C = r, la.width = ca, la.height = ia) : (this.c && !Sa(z, this.c) && xa.clearRect(0, 0, ca, ia), r = this.C);
            this.f.length = 0;
            la = Object.keys(E).map(Number);
            la.sort(function (a, b) {
                return a === p ? 1 : b === p ? -1 : a > b ? 1 : a < b ? -1 : 0;
            });
            Va = 0;
            for (ic = la.length; Va < ic; ++Va) {
                ta = la[Va];
                S = l.Zd(ta, c, f);
                xa = n.Ta(ta);
                var Xa = xa / q;
                var Z = A * l.Zf(f);
                var Zb = E[ta];
                for (var Le in Zb) {
                    xa = Zb[Le];
                    ia = n.Ma(xa.ya, Ia);
                    ca = (ia[0] - z[0]) / q * A / r;
                    ia = (z[3] - ia[3]) / q * A / r;
                    var Uf = S[0] * Xa / r;
                    var Id = S[1] * Xa / r;
                    this.Sf(xa, a, b, ca, ia, Uf, Id, Z, p === ta);
                    this.f.push(xa);
                }
            }
            this.wf = m;
            this.i = q * c / A * r;
            this.c = z;
        }
        b = this.i / g;
        b = ef(this.o, c * d[0] / 2, c * d[1] / 2, b, b, 0, (this.c[0] - e[0]) / this.i * c, (e[1] - this.c[3]) / this.i * c);
        ef(this.l, c * d[0] / 2 - b[4], c * d[1] / 2 - b[5], c / g, -c / g, 0, -e[0], -e[1]);
        Vi(a.usedTiles, l, p, v);
        Wi(a, l, n, c, f, u, p, h.c());
        Ti(a, l);
        Ui(a, l);
        return 0 < this.f.length;
    };
    mj.prototype.Sf = function (a, b, c, d, e, f, g, h, l) {
        if (c = a.Y(this.a)) {
            var m = x(this), n = l ? qj(a, m, b.time) : 1;
            1 !== n || this.a.ha().eg(b.viewState.projection) || this.context.clearRect(d, e, f, g);
            var p = n !== this.context.globalAlpha;
            p && (this.context.save(), this.context.globalAlpha = n);
            this.context.drawImage(c, h, h, c.width - 2 * h, c.height - 2 * h, d, e, f, g);
            p && this.context.restore();
            1 !== n ? b.animate = !0 : l && a.j && (a.s[m] = -1);
        }
    };
    mj.prototype.Y = function () {
        var a = this.context;
        return a ? a.canvas : null;
    };
    mj.prototype.v = function () {
        return this.o;
    };
    var rj = {
        Jc: function () {
        }
    };
    (function (a) {
        function b(a, b, d, f, g) {
            c(a, b, d || 0, f || a.length - 1, g || e);
        }
        function c(a, b, e, f, g) {
            for (; f > e;) {
                if (600 < f - e) {
                    var h = f - e + 1, l = b - e + 1, m = Math.log(h), n = 0.5 * Math.exp(2 * m / 3);
                    m = 0.5 * Math.sqrt(m * n * (h - n) / h) * (0 > l - h / 2 ? -1 : 1);
                    c(a, b, Math.max(e, Math.floor(b - l * n / h + m)), Math.min(f, Math.floor(b + (h - l) * n / h + m)), g);
                }
                h = a[b];
                l = e;
                n = f;
                d(a, e, b);
                for (0 < g(a[f], h) && d(a, e, f); l < n;) {
                    d(a, l, n);
                    l++;
                    for (n--; 0 > g(a[l], h);)
                        l++;
                    for (; 0 < g(a[n], h);)
                        n--;
                }
                0 === g(a[e], h) ? d(a, e, n) : (n++, d(a, n, f));
                n <= b && (e = n + 1);
                b <= n && (f = n - 1);
            }
        }
        function d(a, b, c) {
            var d = a[b];
            a[b] = a[c];
            a[c] = d;
        }
        function e(a, b) {
            return a < b ? -1 : a > b ? 1 : 0;
        }
        function f(a, b) {
            if (!(this instanceof f))
                return new f(a, b);
            this.Lf = Math.max(4, a || 9);
            this.wh = Math.max(2, Math.ceil(0.4 * this.Lf));
            b && this.Ak(b);
            this.clear();
        }
        function g(a, b) {
            h(a, 0, a.children.length, b, a);
        }
        function h(a, b, c, d, e) {
            e || (e = v(null));
            e.fa = Infinity;
            e.ea = Infinity;
            e.la = -Infinity;
            e.ka = -Infinity;
            for (var f; b < c; b++)
                f = a.children[b], l(e, a.fb ? d(f) : f);
            return e;
        }
        function l(a, b) {
            a.fa = Math.min(a.fa, b.fa);
            a.ea = Math.min(a.ea, b.ea);
            a.la = Math.max(a.la, b.la);
            a.ka = Math.max(a.ka, b.ka);
            return a;
        }
        function m(a, b) {
            return a.fa - b.fa;
        }
        function n(a, b) {
            return a.ea - b.ea;
        }
        function p(a) {
            return (a.la - a.fa) * (a.ka - a.ea);
        }
        function q(a) {
            return a.la - a.fa + (a.ka - a.ea);
        }
        function r(a, b) {
            return a.fa <= b.fa && a.ea <= b.ea && b.la <= a.la && b.ka <= a.ka;
        }
        function u(a, b) {
            return b.fa <= a.la && b.ea <= a.ka && b.la >= a.fa && b.ka >= a.ea;
        }
        function v(a) {
            return {
                children: a,
                height: 1,
                fb: !0,
                fa: Infinity,
                ea: Infinity,
                la: -Infinity,
                ka: -Infinity
            };
        }
        function z(a, b, c, d, e) {
            for (var f = [
                        b,
                        c
                    ], g; f.length;)
                c = f.pop(), b = f.pop(), c - b <= d || (g = b + Math.ceil((c - b) / d / 2) * d, A(a, g, b, c, e), f.push(b, g, g, c));
        }
        var A = b;
        A.default = b;
        f.prototype = {
            all: function () {
                return this.rh(this.data, []);
            },
            search: function (a) {
                var b = this.data, c = [], d = this.xb;
                if (!u(a, b))
                    return c;
                for (var e = [], f, g, h, l; b;) {
                    f = 0;
                    for (g = b.children.length; f < g; f++)
                        h = b.children[f], l = b.fb ? d(h) : h, u(a, l) && (b.fb ? c.push(h) : r(a, l) ? this.rh(h, c) : e.push(h));
                    b = e.pop();
                }
                return c;
            },
            Ok: function (a) {
                var b = this.data, c = this.xb;
                if (!u(a, b))
                    return !1;
                for (var d = [], e, f, g, h; b;) {
                    e = 0;
                    for (f = b.children.length; e < f; e++)
                        if (g = b.children[e], h = b.fb ? c(g) : g, u(a, h)) {
                            if (b.fb || r(a, h))
                                return !0;
                            d.push(g);
                        }
                    b = d.pop();
                }
                return !1;
            },
            load: function (a) {
                if (!a || !a.length)
                    return this;
                if (a.length < this.wh) {
                    for (var b = 0, c = a.length; b < c; b++)
                        this.Ca(a[b]);
                    return this;
                }
                a = this.th(a.slice(), 0, a.length - 1, 0);
                this.data.children.length ? this.data.height === a.height ? this.yh(this.data, a) : (this.data.height < a.height && (b = this.data, this.data = a, a = b), this.vh(a, this.data.height - a.height - 1, !0)) : this.data = a;
                return this;
            },
            Ca: function (a) {
                a && this.vh(a, this.data.height - 1);
                return this;
            },
            clear: function () {
                this.data = v([]);
                return this;
            },
            remove: function (a, b) {
                if (!a)
                    return this;
                for (var c = this.data, d = this.xb(a), e = [], f = [], g, h, l, m; c || e.length;) {
                    c || (c = e.pop(), h = e[e.length - 1], g = f.pop(), m = !0);
                    if (c.fb) {
                        a: {
                            l = a;
                            var n = c.children, p = b;
                            if (p) {
                                for (var q = 0; q < n.length; q++)
                                    if (p(l, n[q])) {
                                        l = q;
                                        break a;
                                    }
                                l = -1;
                            } else
                                l = n.indexOf(l);
                        }
                        if (-1 !== l) {
                            c.children.splice(l, 1);
                            e.push(c);
                            this.yk(e);
                            break;
                        }
                    }
                    m || c.fb || !r(c, d) ? h ? (g++, c = h.children[g], m = !1) : c = null : (e.push(c), f.push(g), g = 0, h = c, c = c.children[0]);
                }
                return this;
            },
            xb: function (a) {
                return a;
            },
            Pf: m,
            Qf: n,
            toJSON: function () {
                return this.data;
            },
            rh: function (a, b) {
                for (var c = []; a;)
                    a.fb ? b.push.apply(b, a.children) : c.push.apply(c, a.children), a = c.pop();
                return b;
            },
            th: function (a, b, c, d) {
                var e = c - b + 1, f = this.Lf;
                if (e <= f) {
                    var h = v(a.slice(b, c + 1));
                    g(h, this.xb);
                    return h;
                }
                d || (d = Math.ceil(Math.log(e) / Math.log(f)), f = Math.ceil(e / Math.pow(f, d - 1)));
                h = v([]);
                h.fb = !1;
                h.height = d;
                e = Math.ceil(e / f);
                f = e * Math.ceil(Math.sqrt(f));
                var l;
                for (z(a, b, c, f, this.Pf); b <= c; b += f) {
                    var m = Math.min(b + f - 1, c);
                    z(a, b, m, e, this.Qf);
                    for (l = b; l <= m; l += e) {
                        var n = Math.min(l + e - 1, m);
                        h.children.push(this.th(a, l, n, d - 1));
                    }
                }
                g(h, this.xb);
                return h;
            },
            xk: function (a, b, c, d) {
                for (var e, f, g, h, l, m, n, q;;) {
                    d.push(b);
                    if (b.fb || d.length - 1 === c)
                        break;
                    n = q = Infinity;
                    e = 0;
                    for (f = b.children.length; e < f; e++)
                        g = b.children[e], l = p(g), m = (Math.max(g.la, a.la) - Math.min(g.fa, a.fa)) * (Math.max(g.ka, a.ka) - Math.min(g.ea, a.ea)) - l, m < q ? (q = m, n = l < n ? l : n, h = g) : m === q && l < n && (n = l, h = g);
                    b = h || b.children[0];
                }
                return b;
            },
            vh: function (a, b, c) {
                var d = this.xb;
                c = c ? a : d(a);
                d = [];
                var e = this.xk(c, this.data, b, d);
                e.children.push(a);
                for (l(e, c); 0 <= b;)
                    if (d[b].children.length > this.Lf)
                        this.Dk(d, b), b--;
                    else
                        break;
                this.uk(c, d, b);
            },
            Dk: function (a, b) {
                var c = a[b], d = c.children.length, e = this.wh;
                this.vk(c, e, d);
                d = this.wk(c, e, d);
                d = v(c.children.splice(d, c.children.length - d));
                d.height = c.height;
                d.fb = c.fb;
                g(c, this.xb);
                g(d, this.xb);
                b ? a[b - 1].children.push(d) : this.yh(c, d);
            },
            yh: function (a, b) {
                this.data = v([
                    a,
                    b
                ]);
                this.data.height = a.height + 1;
                this.data.fb = !1;
                g(this.data, this.xb);
            },
            wk: function (a, b, c) {
                var d, e;
                var f = e = Infinity;
                for (d = b; d <= c - b; d++) {
                    var g = h(a, 0, d, this.xb);
                    var l = h(a, d, c, this.xb);
                    var m = Math.max(0, Math.min(g.la, l.la) - Math.max(g.fa, l.fa)) * Math.max(0, Math.min(g.ka, l.ka) - Math.max(g.ea, l.ea));
                    g = p(g) + p(l);
                    if (m < f) {
                        f = m;
                        var n = d;
                        e = g < e ? g : e;
                    } else
                        m === f && g < e && (e = g, n = d);
                }
                return n;
            },
            vk: function (a, b, c) {
                var d = a.fb ? this.Pf : m, e = a.fb ? this.Qf : n, f = this.sh(a, b, c, d);
                b = this.sh(a, b, c, e);
                f < b && a.children.sort(d);
            },
            sh: function (a, b, c, d) {
                a.children.sort(d);
                d = this.xb;
                var e = h(a, 0, b, d), f = h(a, c - b, c, d), g = q(e) + q(f), m;
                for (m = b; m < c - b; m++) {
                    var n = a.children[m];
                    l(e, a.fb ? d(n) : n);
                    g += q(e);
                }
                for (m = c - b - 1; m >= b; m--)
                    n = a.children[m], l(f, a.fb ? d(n) : n), g += q(f);
                return g;
            },
            uk: function (a, b, c) {
                for (; 0 <= c; c--)
                    l(b[c], a);
            },
            yk: function (a) {
                for (var b = a.length - 1, c; 0 <= b; b--)
                    0 === a[b].children.length ? 0 < b ? (c = a[b - 1].children, c.splice(c.indexOf(a[b]), 1)) : this.clear() : g(a[b], this.xb);
            },
            Ak: function (a) {
                var b = [
                    'return a',
                    ' - b',
                    ';'
                ];
                this.Pf = new Function('a', 'b', b.join(a[0]));
                this.Qf = new Function('a', 'b', b.join(a[1]));
                this.xb = new Function('a', 'return {minX: a' + a[0] + ', minY: a' + a[1] + ', maxX: a' + a[2] + ', maxY: a' + a[3] + '};');
            }
        };
        a['default'] = f;
    }(rj.Jc = rj.Jc || {}));
    rj.Jc = rj.Jc.default;
    function sj() {
    }
    function tj(a, b, c, d) {
        var e = a[b], f = a[b + 1], g = 0;
        for (b += d; b < c; b += d) {
            var h = a[b], l = a[b + 1];
            g += Math.sqrt((h - e) * (h - e) + (l - f) * (l - f));
            e = h;
            f = l;
        }
        return g;
    }
    var uj = 'Polygon Circle LineString Image Text Default'.split(' '), vj = {
            left: 0,
            end: 0,
            center: 0.5,
            right: 1,
            start: 1,
            top: 0,
            middle: 0.5,
            hanging: 0.2,
            alphabetic: 0.8,
            ideographic: 0.8,
            bottom: 1
        };
    function wj(a, b, c, d, e, f) {
        this.ra = f;
        this.La = Da();
        this.ob = a;
        this.Ea = b;
        this.overlaps = e;
        this.pixelRatio = d;
        this.Wa = 0;
        this.resolution = c;
        this.i = this.T = this.qa = null;
        this.a = [];
        this.coordinates = [];
        this.Ub = {};
        this.ca = We();
        this.b = [];
        this.oa = null;
        this.state = {};
        this.$ = 0;
        this.bb = We();
    }
    w(wj, Ai);
    function xj(a, b, c, d, e, f, g, h) {
        b.beginPath();
        b.moveTo.apply(b, c);
        b.lineTo.apply(b, d);
        b.lineTo.apply(b, e);
        b.lineTo.apply(b, f);
        b.lineTo.apply(b, c);
        g && (a.O = g[2], a.Xa(b));
        h && (yj(b, h), b.stroke());
    }
    function zj(a, b, c, d, e, f, g, h, l, m, n, p, q, r, u, v, z, A, E) {
        var S = A || E, Ia = a.bb;
        f *= r;
        g *= r;
        c -= f;
        d -= g;
        u && (c = Math.round(c), d = Math.round(d));
        u = v + n > e.width ? e.width - n : v;
        l = l + p > e.height ? e.height - p : l;
        v = a.La;
        var ta = z[3] + u * r + z[1], la = z[0] + l * r + z[2], ca = c - z[3], ia = d - z[0];
        if (S || 0 !== q) {
            var xa = [
                ca,
                ia
            ];
            var Va = [
                ca + ta,
                ia
            ];
            var ic = [
                ca + ta,
                ia + la
            ];
            var Xa = [
                ca,
                ia + la
            ];
        }
        z = null;
        0 !== q ? (f = c + f, g = d + g, z = ef(Ia, f, g, 1, 1, q, -f, -g), Oa(v), Ea(v, af(Ia, xa)), Ea(v, af(Ia, Va)), Ea(v, af(Ia, ic)), Ea(v, af(Ia, Xa))) : Na(ca, ia, ca + ta, ia + la, v);
        q = b.canvas;
        q = v[0] <= q.width && 0 <= v[2] && v[1] <= q.height && 0 <= v[3];
        if (h) {
            if (q || 1 != h[4])
                Ta(h, v), (a = q ? [
                    b,
                    z ? z.slice(0) : null,
                    m,
                    e,
                    n,
                    p,
                    u,
                    l,
                    c,
                    d,
                    r
                ] : null) && S && a.push(A, E, xa, Va, ic, Xa), h.push(a);
        } else
            q && (S && xj(a, b, xa, Va, ic, Xa, A, E), si(b, z, m, e, n, p, u, l, c, d, r));
    }
    function Aj(a, b) {
        var c = a.pixelRatio;
        return 1 == c ? b : b.map(function (a) {
            return a * c;
        });
    }
    function Bj(a, b, c, d, e, f, g) {
        var h = a.coordinates.length, l = Cj(a);
        g && (c += e);
        g = [
            b[c],
            b[c + 1]
        ];
        var m = [
                NaN,
                NaN
            ], n = !0, p;
        for (p = c + e; p < d; p += e) {
            m[0] = b[p];
            m[1] = b[p + 1];
            var q = Ma(l, m);
            q !== r ? (n && (a.coordinates[h++] = g[0], a.coordinates[h++] = g[1]), a.coordinates[h++] = m[0], a.coordinates[h++] = m[1], n = !1) : 1 === q ? (a.coordinates[h++] = m[0], a.coordinates[h++] = m[1], n = !1) : n = !0;
            g[0] = m[0];
            g[1] = m[1];
            var r = q;
        }
        if (f && n || p === c + e)
            a.coordinates[h++] = g[0], a.coordinates[h++] = g[1];
        return h;
    }
    function Dj(a, b, c, d, e, f) {
        for (var g = 0, h = d.length; g < h; ++g) {
            var l = d[g];
            c = Bj(a, b, c, l, e, !1, !1);
            f.push(c);
            c = l;
        }
        return c;
    }
    k = wj.prototype;
    k.Hh = function (a, b, c) {
        Ej(this, b);
        var d = a.S(), e = a.pa(), f = this.coordinates.length, g;
        if ('MultiPolygon' == d) {
            d = Ii(a);
            var h = [];
            for (var l = a.td(), m = g = 0, n = l.length; m < n; ++m) {
                var p = [];
                g = Dj(this, d, g, l[m], e, p);
                h.push(p);
            }
            this.a.push([
                4,
                f,
                h,
                a,
                c,
                Af
            ]);
        } else
            'Polygon' == d || 'MultiLineString' == d ? (h = [], d = 'Polygon' == d ? a.Xb() : a.da(), Dj(this, d, 0, a.pb(), e, h), this.a.push([
                4,
                f,
                h,
                a,
                c,
                zf
            ])) : 'LineString' == d || 'MultiPoint' == d ? (d = a.da(), e = Bj(this, d, 0, d.length, e, !1, !1), this.a.push([
                4,
                f,
                e,
                a,
                c,
                yf
            ])) : 'Point' == d && (d = a.da(), this.coordinates.push(d[0], d[1]), e = this.coordinates.length, this.a.push([
                4,
                f,
                e,
                a,
                c
            ]));
        Fj(this, b);
    };
    function Ej(a, b) {
        a.qa = [
            0,
            b,
            0
        ];
        a.a.push(a.qa);
        a.T = [
            0,
            b,
            0
        ];
        a.b.push(a.T);
    }
    k.Xa = function (a) {
        if (this.O) {
            var b = af(this.ca, this.O.slice());
            a.translate(b[0], b[1]);
            a.rotate(this.$);
        }
        a.fill();
        this.O && a.setTransform.apply(a, ri);
    };
    function yj(a, b) {
        a.strokeStyle = b[1];
        a.lineWidth = b[2];
        a.lineCap = b[3];
        a.lineJoin = b[4];
        a.miterLimit = b[5];
        od && (a.lineDashOffset = b[7], a.setLineDash(b[6]));
    }
    function Gj(a, b, c) {
        if (b && 5 < b.length) {
            var d = b[4];
            if (1 == d || d == b.length - 5) {
                c = {
                    fa: b[0],
                    ea: b[1],
                    la: b[2],
                    ka: b[3],
                    value: c
                };
                if (!a.ra.Ok(c))
                    for (a.ra.Ca(c), c = 5, d = b.length; c < d; ++c) {
                        var e = b[c];
                        e && (11 < e.length && xj(a, e[0], e[13], e[14], e[15], e[16], e[11], e[12]), si.apply(void 0, e));
                    }
                b.length = 5;
                Oa(b);
            }
        }
    }
    function Hj(a, b, c, d, e, f, g) {
        if (a.oa && jc(c, a.ca))
            var h = a.oa;
        else
            a.oa || (a.oa = []), h = Te(a.coordinates, 0, a.coordinates.length, 2, c, a.oa), $e(a.ca, c);
        for (var l = !nb(d), m = 0, n = e.length, p = 0, q, r, u, v, z, A, E, S, Ia, ta = 0, la = 0, ca = null, ia = null, xa = a.Ub, Va = a.$, ic = {
                    context: b,
                    pixelRatio: a.pixelRatio,
                    resolution: a.resolution,
                    rotation: Va
                }, Xa = a.a != e || a.overlaps ? 0 : 200; m < n;) {
            var Z = e[m];
            switch (Z[0]) {
            case 0:
                var Zb = Z[1];
                l && d[x(Zb).toString()] || !Zb.U() ? m = Z[2] : void 0 === g || hb(g, Zb.U().G()) ? ++m : m = Z[2] + 1;
                break;
            case 1:
                ta > Xa && (a.Xa(b), ta = 0);
                la > Xa && (b.stroke(), la = 0);
                ta || la || (b.beginPath(), v = z = NaN);
                ++m;
                break;
            case 2:
                p = Z[1];
                var Le = h[p], Uf = h[p + 1], Id = h[p + 2] - Le, te = h[p + 3] - Uf, Jh = Math.sqrt(Id * Id + te * te);
                b.moveTo(Le + Jh, Uf);
                b.arc(Le, Uf, Jh, 0, 2 * Math.PI, !0);
                ++m;
                break;
            case 3:
                b.closePath();
                ++m;
                break;
            case 4:
                p = Z[1];
                q = Z[2];
                var Mg = Z[4], Ng = 6 == Z.length ? Z[5] : void 0;
                ic.geometry = Z[3];
                ic.feature = Zb;
                m in xa || (xa[m] = []);
                var Wf = xa[m];
                Ng ? Ng(h, p, q, 2, Wf) : (Wf[0] = h[p], Wf[1] = h[p + 1], Wf.length = 2);
                Mg(Wf, ic);
                ++m;
                break;
            case 6:
                p = Z[1];
                q = Z[2];
                Ia = Z[3];
                r = Z[4];
                u = Z[5];
                S = f ? null : Z[6];
                var rf = Z[7], yu = Z[8], zu = Z[9], Au = Z[10], Bu = Z[11], jp = Z[12], Cu = Z[13], Du = Z[14], Eu = Z[15];
                if (16 < Z.length) {
                    var kp = Z[16];
                    var lp = Z[17];
                    var mp = Z[18];
                } else
                    kp = hi, lp = mp = !1;
                for (Bu && (jp += Va); p < q; p += 2)
                    zj(a, b, h[p], h[p + 1], Ia, r, u, S, rf, yu, zu, Au, jp, Cu, Du, Eu, kp, lp ? ca : null, mp ? ia : null);
                Gj(a, S, Zb);
                ++m;
                break;
            case 5:
                var np = Z[1], op = Z[2], Lk = Z[3];
                S = f ? null : Z[4];
                var Fu = Z[5], pp = Z[6], Gu = Z[7], qp = Z[8], rp = Z[9], sp = Z[10], tp = Z[11], up = Z[12], Mk = Z[13], vp = Z[14], wp = tj(h, np, op, 2), xp = qp(up);
                if (Fu || xp <= wp) {
                    a: {
                        var Ni = void 0, yp = void 0, Xf = void 0, sf = h, ve = np, zp = op, Ap = up, Hu = qp, Bp = (wp - xp) * vj[a.s[Mk].textAlign], Iu = Gu, Nk = [], Kh = sf[ve] > sf[zp - 2], Cp = Ap.length, Lh = sf[ve], Mh = sf[ve + 1];
                        ve += 2;
                        for (var Og = sf[ve], Pg = sf[ve + 1], Ok = 0, Oi = Math.sqrt(Math.pow(Og - Lh, 2) + Math.pow(Pg - Mh, 2)), Yf = '', Pk = 0, Pi = 0; Pi < Cp; ++Pi) {
                            yp = Kh ? Cp - Pi - 1 : Pi;
                            var Qk = Ap.charAt(yp);
                            Yf = Kh ? Qk + Yf : Yf + Qk;
                            var Qg = Hu(Yf) - Pk;
                            Pk += Qg;
                            for (var Dp = Bp + Qg / 2; ve < zp - 2 && Ok + Oi < Dp;)
                                Lh = Og, Mh = Pg, ve += 2, Og = sf[ve], Pg = sf[ve + 1], Ok += Oi, Oi = Math.sqrt(Math.pow(Og - Lh, 2) + Math.pow(Pg - Mh, 2));
                            var Ju = Dp - Ok, Rg = Math.atan2(Pg - Mh, Og - Lh);
                            Kh && (Rg += 0 < Rg ? -Math.PI : Math.PI);
                            if (void 0 !== Ni) {
                                var Qi = Rg - Ni;
                                Qi += Qi > Math.PI ? -2 * Math.PI : Qi < -Math.PI ? 2 * Math.PI : 0;
                                if (Math.abs(Qi) > Iu) {
                                    var Sg = null;
                                    break a;
                                }
                            }
                            var Ep = Ju / Oi, Fp = ya(Lh, Og, Ep), Gp = ya(Mh, Pg, Ep);
                            Ni == Rg ? (Kh && (Xf[0] = Fp, Xf[1] = Gp, Xf[2] = Qg / 2), Xf[4] = Yf) : (Yf = Qk, Pk = Qg, Xf = [
                                Fp,
                                Gp,
                                Qg / 2,
                                Rg,
                                Yf
                            ], Kh ? Nk.unshift(Xf) : Nk.push(Xf), Ni = Rg);
                            Bp += Qg;
                        }
                        Sg = Nk;
                    }
                    if (Sg) {
                        var Ri;
                        if (sp) {
                            var Zf = 0;
                            for (Ri = Sg.length; Zf < Ri; ++Zf) {
                                var ee = Sg[Zf];
                                var Rk = ee[4];
                                var Ne = a.Y(Rk, Mk, '', sp);
                                r = ee[2] + tp;
                                u = Lk * Ne.height + 2 * (0.5 - Lk) * tp - rp;
                                zj(a, b, ee[0], ee[1], Ne, r, u, S, Ne.height, 1, 0, 0, ee[3], vp, !1, Ne.width, hi, null, null);
                            }
                        }
                        if (pp)
                            for (Zf = 0, Ri = Sg.length; Zf < Ri; ++Zf)
                                ee = Sg[Zf], Rk = ee[4], Ne = a.Y(Rk, Mk, pp, ''), r = ee[2], u = Lk * Ne.height - rp, zj(a, b, ee[0], ee[1], Ne, r, u, S, Ne.height, 1, 0, 0, ee[3], vp, !1, Ne.width, hi, null, null);
                    }
                }
                Gj(a, S, Zb);
                ++m;
                break;
            case 7:
                if (void 0 !== f) {
                    Zb = Z[1];
                    var Hp = f(Zb);
                    if (Hp)
                        return Hp;
                }
                ++m;
                break;
            case 8:
                Xa ? ta++ : a.Xa(b);
                ++m;
                break;
            case 9:
                p = Z[1];
                q = Z[2];
                var Nh = h[p];
                var Oh = h[p + 1];
                A = Nh + 0.5 | 0;
                E = Oh + 0.5 | 0;
                if (A !== v || E !== z)
                    b.moveTo(Nh, Oh), v = A, z = E;
                for (p += 2; p < q; p += 2)
                    if (Nh = h[p], Oh = h[p + 1], A = Nh + 0.5 | 0, E = Oh + 0.5 | 0, p == q - 2 || A !== v || E !== z)
                        b.lineTo(Nh, Oh), v = A, z = E;
                ++m;
                break;
            case 10:
                ca = Z;
                a.O = Z[2];
                ta && (a.Xa(b), ta = 0, la && (b.stroke(), la = 0));
                b.fillStyle = Z[1];
                ++m;
                break;
            case 11:
                ia = Z;
                la && (b.stroke(), la = 0);
                yj(b, Z);
                ++m;
                break;
            case 12:
                Xa ? la++ : b.stroke();
                ++m;
                break;
            default:
                ++m;
            }
        }
        ta && a.Xa(b);
        la && b.stroke();
    }
    k.Na = function (a, b, c, d) {
        this.$ = c;
        Hj(this, a, b, d, this.a, void 0, void 0);
    };
    function Ij(a, b, c, d, e, f, g) {
        a.$ = d;
        return Hj(a, b, c, e, a.b, f, g);
    }
    function Jj(a) {
        var b = a.b;
        b.reverse();
        var c, d = b.length, e = -1;
        for (c = 0; c < d; ++c) {
            var f = b[c];
            var g = f[0];
            if (7 == g)
                e = c;
            else if (0 == g) {
                f[2] = c;
                f = a.b;
                for (g = c; e < g;) {
                    var h = f[e];
                    f[e] = f[g];
                    f[g] = h;
                    ++e;
                    --g;
                }
                e = -1;
            }
        }
    }
    k.Oa = function (a, b) {
        var c = this.state;
        a ? (a = a.b, c.fillStyle = zi(a ? a : ei)) : c.fillStyle = void 0;
        b ? (a = b.a, c.strokeStyle = zi(a ? a : gi), a = b.f, c.lineCap = void 0 !== a ? a : 'round', a = b.g, c.lineDash = a ? a.slice() : fi, a = b.i, c.lineDashOffset = a ? a : 0, a = b.j, c.lineJoin = void 0 !== a ? a : 'round', a = b.c, c.lineWidth = void 0 !== a ? a : 1, b = b.l, c.miterLimit = void 0 !== b ? b : 10, c.lineWidth > this.Wa && (this.Wa = c.lineWidth, this.i = null)) : (c.strokeStyle = void 0, c.lineCap = void 0, c.lineDash = null, c.lineDashOffset = void 0, c.lineJoin = void 0, c.lineWidth = void 0, c.miterLimit = void 0);
    };
    k.Ah = function (a, b) {
        var c = a.fillStyle;
        a = [
            10,
            c
        ];
        'string' !== typeof c && (b = b.G(), a.push([
            b[0],
            b[3]
        ]));
        this.a.push(a);
    };
    k.pd = function (a) {
        this.a.push([
            11,
            a.strokeStyle,
            a.lineWidth * this.pixelRatio,
            a.lineCap,
            a.lineJoin,
            a.miterLimit,
            Aj(this, a.lineDash),
            a.lineDashOffset * this.pixelRatio
        ]);
    };
    function Kj(a, b, c, d) {
        var e = b.fillStyle;
        if ('string' !== typeof e || b.Pk != e)
            c.call(a, b, d), b.Pk = e;
    }
    function Lj(a, b, c) {
        var d = b.strokeStyle, e = b.lineCap, f = b.lineDash, g = b.lineDashOffset, h = b.lineJoin, l = b.lineWidth, m = b.miterLimit;
        if (b.Vk != d || b.Qk != e || f != b.Fh && !jc(b.Fh, f) || b.Rk != g || b.Sk != h || b.Tk != l || b.Uk != m)
            c.call(a, b), b.Vk = d, b.Qk = e, b.Fh = f, b.Rk = g, b.Sk = h, b.Tk = l, b.Uk = m;
    }
    function Fj(a, b) {
        a.qa[2] = a.a.length;
        a.qa = null;
        a.T[2] = a.b.length;
        a.T = null;
        b = [
            7,
            b
        ];
        a.a.push(b);
        a.b.push(b);
    }
    k.bf = ea;
    function Cj(a) {
        a.i || (a.i = Ga(a.Ea), 0 < a.Wa && Fa(a.i, a.resolution * (a.Wa + 1) / 2, a.i));
        return a.i;
    }
    function Mj(a, b, c, d, e, f) {
        wj.call(this, a, b, c, d, e, f);
        this.M = this.V = this.B = null;
        this.N = this.o = this.v = this.s = this.l = this.C = this.D = this.j = this.f = this.c = this.g = void 0;
    }
    w(Mj, wj);
    Mj.prototype.yc = function (a, b) {
        if (this.M) {
            Ej(this, b);
            var c = a.da(), d = this.coordinates.length;
            a = Bj(this, c, 0, c.length, a.pa(), !1, !1);
            this.a.push([
                6,
                d,
                a,
                this.M,
                this.g,
                this.c,
                this.B,
                this.f,
                this.j,
                this.D,
                this.C,
                this.l,
                this.s,
                this.v * this.pixelRatio,
                this.o,
                this.N
            ]);
            this.b.push([
                6,
                d,
                a,
                this.V,
                this.g,
                this.c,
                this.B,
                this.f,
                this.j,
                this.D,
                this.C,
                this.l,
                this.s,
                this.v,
                this.o,
                this.N
            ]);
            Fj(this, b);
        }
    };
    Mj.prototype.wc = function (a, b) {
        if (this.M) {
            Ej(this, b);
            var c = a.da(), d = this.coordinates.length;
            a = Bj(this, c, 0, c.length, a.pa(), !1, !1);
            this.a.push([
                6,
                d,
                a,
                this.M,
                this.g,
                this.c,
                this.B,
                this.f,
                this.j,
                this.D,
                this.C,
                this.l,
                this.s,
                this.v * this.pixelRatio,
                this.o,
                this.N
            ]);
            this.b.push([
                6,
                d,
                a,
                this.V,
                this.g,
                this.c,
                this.B,
                this.f,
                this.j,
                this.D,
                this.C,
                this.l,
                this.s,
                this.v,
                this.o,
                this.N
            ]);
            Fj(this, b);
        }
    };
    Mj.prototype.bf = function () {
        Jj(this);
        this.c = this.g = void 0;
        this.M = this.V = null;
        this.N = this.o = this.s = this.l = this.C = this.D = this.j = this.v = this.f = void 0;
    };
    Mj.prototype.Zb = function (a, b) {
        var c = a.Vc(), d = a.oc(), e = a.Eg(), f = a.Y(1), g = a.bd();
        this.g = c[0];
        this.c = c[1];
        this.B = b;
        this.V = e;
        this.M = f;
        this.f = d[1];
        this.j = a.i;
        this.D = g[0];
        this.C = g[1];
        this.l = a.s;
        this.s = a.f;
        this.v = a.a;
        this.o = a.v;
        this.N = d[0];
    };
    function Nj(a, b, c, d, e, f) {
        wj.call(this, a, b, c, d, e, f);
    }
    w(Nj, wj);
    function Oj(a, b, c, d, e) {
        var f = a.coordinates.length;
        b = Bj(a, b, c, d, e, !1, !1);
        f = [
            9,
            f,
            b
        ];
        a.a.push(f);
        a.b.push(f);
        return d;
    }
    Nj.prototype.uc = function (a, b) {
        var c = this.state, d = c.lineWidth;
        void 0 !== c.strokeStyle && void 0 !== d && (Lj(this, c, this.pd), Ej(this, b), this.b.push([
            11,
            c.strokeStyle,
            c.lineWidth,
            c.lineCap,
            c.lineJoin,
            c.miterLimit,
            c.lineDash,
            c.lineDashOffset
        ], [1]), c = a.da(), Oj(this, c, 0, c.length, a.pa()), this.b.push([12]), Fj(this, b));
    };
    Nj.prototype.vc = function (a, b) {
        var c = this.state, d = c.lineWidth;
        if (void 0 !== c.strokeStyle && void 0 !== d) {
            Lj(this, c, this.pd);
            Ej(this, b);
            this.b.push([
                11,
                c.strokeStyle,
                c.lineWidth,
                c.lineCap,
                c.lineJoin,
                c.miterLimit,
                c.lineDash,
                c.lineDashOffset
            ], [1]);
            c = a.pb();
            d = a.da();
            a = a.pa();
            var e = 0, f;
            var g = 0;
            for (f = c.length; g < f; ++g)
                e = Oj(this, d, e, c[g], a);
            this.b.push([12]);
            Fj(this, b);
        }
    };
    Nj.prototype.bf = function () {
        var a = this.state;
        void 0 != a.$d && a.$d != this.coordinates.length && this.a.push([12]);
        Jj(this);
        this.state = null;
    };
    Nj.prototype.pd = function (a) {
        void 0 != a.$d && a.$d != this.coordinates.length && (this.a.push([12]), a.$d = this.coordinates.length);
        a.$d = 0;
        wj.prototype.pd.call(this, a);
        this.a.push([1]);
    };
    function Pj(a, b, c, d, e, f) {
        wj.call(this, a, b, c, d, e, f);
    }
    w(Pj, wj);
    function Qj(a, b, c, d, e) {
        var f = a.state, g = void 0 !== f.fillStyle;
        f = void 0 != f.strokeStyle;
        var h = d.length, l = [1];
        a.a.push(l);
        a.b.push(l);
        for (l = 0; l < h; ++l) {
            var m = d[l], n = a.coordinates.length;
            c = Bj(a, b, c, m, e, !0, !f);
            c = [
                9,
                n,
                c
            ];
            a.a.push(c);
            a.b.push(c);
            f && (c = [3], a.a.push(c), a.b.push(c));
            c = m;
        }
        b = [8];
        a.b.push(b);
        g && a.a.push(b);
        f && (g = [12], a.a.push(g), a.b.push(g));
        return c;
    }
    Pj.prototype.cc = function (a, b) {
        var c = this.state, d = c.strokeStyle;
        if (void 0 !== c.fillStyle || void 0 !== d) {
            Rj(this, a);
            Ej(this, b);
            this.b.push([
                10,
                xi(ei)
            ]);
            void 0 !== c.strokeStyle && this.b.push([
                11,
                c.strokeStyle,
                c.lineWidth,
                c.lineCap,
                c.lineJoin,
                c.miterLimit,
                c.lineDash,
                c.lineDashOffset
            ]);
            var e = a.da();
            d = this.coordinates.length;
            Bj(this, e, 0, e.length, a.pa(), !1, !1);
            a = [1];
            d = [
                2,
                d
            ];
            this.a.push(a, d);
            this.b.push(a, d);
            a = [8];
            this.b.push(a);
            void 0 !== c.fillStyle && this.a.push(a);
            void 0 !== c.strokeStyle && (c = [12], this.a.push(c), this.b.push(c));
            Fj(this, b);
        }
    };
    Pj.prototype.zc = function (a, b) {
        var c = this.state;
        Rj(this, a);
        Ej(this, b);
        this.b.push([
            10,
            xi(ei)
        ]);
        void 0 !== c.strokeStyle && this.b.push([
            11,
            c.strokeStyle,
            c.lineWidth,
            c.lineCap,
            c.lineJoin,
            c.miterLimit,
            c.lineDash,
            c.lineDashOffset
        ]);
        c = a.pb();
        var d = a.Xb();
        Qj(this, d, 0, c, a.pa());
        Fj(this, b);
    };
    Pj.prototype.xc = function (a, b) {
        var c = this.state, d = c.strokeStyle;
        if (void 0 !== c.fillStyle || void 0 !== d) {
            Rj(this, a);
            Ej(this, b);
            this.b.push([
                10,
                xi(ei)
            ]);
            void 0 !== c.strokeStyle && this.b.push([
                11,
                c.strokeStyle,
                c.lineWidth,
                c.lineCap,
                c.lineJoin,
                c.miterLimit,
                c.lineDash,
                c.lineDashOffset
            ]);
            c = a.td();
            d = Ii(a);
            a = a.pa();
            var e = 0, f;
            var g = 0;
            for (f = c.length; g < f; ++g)
                e = Qj(this, d, e, c[g], a);
            Fj(this, b);
        }
    };
    Pj.prototype.bf = function () {
        Jj(this);
        this.state = null;
        var a = this.ob;
        if (0 !== a) {
            var b = this.coordinates, c;
            var d = 0;
            for (c = b.length; d < c; ++d)
                b[d] = a * Math.round(b[d] / a);
        }
    };
    function Rj(a, b) {
        var c = a.state;
        void 0 !== c.fillStyle && Kj(a, c, a.Ah, b);
        void 0 !== c.strokeStyle && Lj(a, c, a.pd);
    }
    function Sj(a, b, c, d, e, f) {
        wj.call(this, a, b, c, d, e, f);
        this.ta = '';
        this.l = this.D = 0;
        this.C = void 0;
        this.B = 0;
        this.c = null;
        this.o = {};
        this.g = null;
        this.ab = {};
        this.f = {};
        this.s = {};
        this.V = this.v = this.j = '';
        for (this.ua = {}; di(ii);)
            ii.pop();
    }
    w(Sj, wj);
    Sj.prototype.Wb = function (a, b) {
        var c = this.c, d = this.g, e = this.f;
        if ('' !== this.ta && e && (c || d)) {
            c = this.coordinates.length;
            var f = a.S();
            d = null;
            var g = 2, h = 2;
            if ('line' === e.placement) {
                if (!hb(Cj(this), a.G()))
                    return;
                d = a.da();
                h = a.pa();
                if ('LineString' == f)
                    var l = [d.length];
                else if ('MultiLineString' == f)
                    l = a.pb();
                else if ('Polygon' == f)
                    l = a.pb().slice(0, 1);
                else if ('MultiPolygon' == f)
                    for (a = a.td(), l = [], g = 0, f = a.length; g < f; ++g)
                        l.push(a[g][0]);
                Ej(this, b);
                a = e.textAlign;
                var m = 0, n;
                f = 0;
                for (var p = l.length; f < p; ++f) {
                    if (void 0 == a) {
                        for (var q, r, u = void 0, v = void 0, z = g = r = q = void 0, A = n = m, E = 0, S = 0, Ia = m; m < l[f]; m += h) {
                            var ta = d[m], la = d[m + 1];
                            void 0 !== r && (r = ta - r, q = la - q, g = Math.sqrt(r * r + q * q), void 0 !== v && (S += z, u = Math.acos((v * r + u * q) / (z * g)), u > e.maxAngle && (S > E && (E = S, n = Ia, A = m), S = 0, Ia = m - h)), z = g, v = r, u = q);
                            r = ta;
                            q = la;
                        }
                        g = S + g > E ? [
                            Ia,
                            m
                        ] : [
                            n,
                            A
                        ];
                        m = g[0];
                        n = g[1];
                    } else
                        n = l[f];
                    for (g = m; g < n; g += h)
                        this.coordinates.push(d[g], d[g + 1]);
                    g = this.coordinates.length;
                    m = l[f];
                    Tj(this, c, g, this.N);
                    c = g;
                }
            } else {
                l = this.Y(this.ta, this.j, this.v, this.V);
                p = l.width / this.pixelRatio;
                switch (f) {
                case 'Point':
                case 'MultiPoint':
                    d = a.da();
                    g = d.length;
                    break;
                case 'LineString':
                    d = a.Fe();
                    break;
                case 'Circle':
                    d = a.xa();
                    break;
                case 'MultiLineString':
                    d = a.Ge();
                    g = d.length;
                    break;
                case 'Polygon':
                    d = a.Td();
                    if (!e.overflow && d[2] / this.resolution < p)
                        return;
                    h = 3;
                    break;
                case 'MultiPolygon':
                    n = Ji(a);
                    d = [];
                    g = 0;
                    for (f = n.length; g < f; g += 3)
                        (e.overflow || n[g + 2] / this.resolution >= p) && d.push(n[g], n[g + 1]);
                    g = d.length;
                    if (0 == g)
                        return;
                }
                g = Bj(this, d, 0, g, h, !1, !1);
                Ej(this, b);
                if (e.backgroundFill || e.backgroundStroke)
                    this.Oa(e.backgroundFill, e.backgroundStroke), Kj(this, this.state, this.Ah, a), Lj(this, this.state, this.pd);
                Uj(this, l, c, g);
            }
            Fj(this, b);
        }
    };
    Sj.prototype.Y = function (a, b, c, d) {
        var e = d + b + a + c + this.pixelRatio;
        if (!ii.a.hasOwnProperty(e)) {
            var f = d ? this.ab[d] || this.g : null, g = c ? this.o[c] || this.c : null, h = this.s[b] || this.f, l = h.scale * this.pixelRatio, m = vj[h.textAlign || 'center'];
            b = d && f.lineWidth ? f.lineWidth : 0;
            a = a.split('\n');
            var n = a.length, p = [], q = h.font;
            var r = a.length;
            var u = 0;
            var v;
            for (v = 0; v < r; ++v) {
                var z = pi(q, a[v]);
                u = Math.max(u, z);
                p.push(z);
            }
            r = u;
            q = oi(h.font);
            r = hg(Math.ceil((r + b) * l), Math.ceil((q * n + b) * l));
            u = r.canvas;
            ii.set(e, u);
            1 != l && r.scale(l, l);
            r.font = h.font;
            d && (r.strokeStyle = f.strokeStyle, r.lineWidth = b * (kd ? l : 1), r.lineCap = f.lineCap, r.lineJoin = f.lineJoin, r.miterLimit = f.miterLimit, od && f.lineDash.length && (r.setLineDash(f.lineDash), r.lineDashOffset = f.lineDashOffset));
            c && (r.fillStyle = g.fillStyle);
            r.textBaseline = 'middle';
            r.textAlign = 'center';
            f = 0.5 - m;
            g = m * u.width / l + f * b;
            if (d)
                for (d = 0; d < n; ++d)
                    r.strokeText(a[d], g + f * p[d], 0.5 * (b + q) + d * q);
            if (c)
                for (d = 0; d < n; ++d)
                    r.fillText(a[d], g + f * p[d], 0.5 * (b + q) + d * q);
        }
        return ii.get(e);
    };
    function Uj(a, b, c, d) {
        var e = a.f, f = a.g, g = a.pixelRatio, h = vj[e.textAlign || 'center'], l = vj[e.textBaseline];
        f = f && f.lineWidth ? f.lineWidth : 0;
        h = h * b.width / g + 2 * (0.5 - h) * f;
        l = l * b.height / g + 2 * (0.5 - l) * f;
        a.a.push([
            6,
            c,
            d,
            b,
            (h - a.D) * g,
            (l - a.l) * g,
            a.N,
            b.height,
            1,
            0,
            0,
            a.C,
            a.B,
            1,
            !0,
            b.width,
            e.padding == hi ? hi : e.padding.map(function (a) {
                return a * g;
            }),
            !!e.backgroundFill,
            !!e.backgroundStroke
        ]);
        a.b.push([
            6,
            c,
            d,
            b,
            (h - a.D) * g,
            (l - a.l) * g,
            a.N,
            b.height,
            1,
            0,
            0,
            a.C,
            a.B,
            1 / g,
            !0,
            b.width,
            e.padding,
            !!e.backgroundFill,
            !!e.backgroundStroke
        ]);
    }
    function Tj(a, b, c, d) {
        var e = a.g, f = a.f, g = a.c, h = a.V;
        e && (h in a.ab || (a.ab[h] = {
            strokeStyle: e.strokeStyle,
            lineCap: e.lineCap,
            lineDashOffset: e.lineDashOffset,
            lineWidth: e.lineWidth,
            lineJoin: e.lineJoin,
            miterLimit: e.miterLimit,
            lineDash: e.lineDash
        }));
        var l = a.j;
        a.j in a.s || (a.s[a.j] = {
            font: f.font,
            textAlign: f.textAlign || 'center',
            scale: f.scale
        });
        var m = a.v;
        g && (m in a.o || (a.o[m] = { fillStyle: g.fillStyle }));
        var n = a.pixelRatio;
        g = vj[f.textBaseline];
        var p = a.l * n, q = a.ta, r = f.font, u = f.scale;
        e = e ? e.lineWidth * u / 2 : 0;
        var v = a.ua[r];
        v || (a.ua[r] = v = {});
        a.a.push([
            5,
            b,
            c,
            g,
            d,
            f.overflow,
            m,
            f.maxAngle,
            function (a) {
                var b = v[a];
                b || (b = v[a] = pi(r, a));
                return b * u * n;
            },
            p,
            h,
            e * n,
            q,
            l,
            1
        ]);
        a.b.push([
            5,
            b,
            c,
            g,
            d,
            f.overflow,
            m,
            f.maxAngle,
            function (a) {
                var b = v[a];
                b || (b = v[a] = pi(r, a));
                return b * u;
            },
            p,
            h,
            e,
            q,
            l,
            1 / n
        ]);
    }
    Sj.prototype.nb = function (a, b) {
        var c, d;
        if (a) {
            this.N = b;
            (d = a.Fa()) ? (b = this.c, b || (b = this.c = {}), b.fillStyle = zi(d.b || ei)) : b = this.c = null;
            if (c = a.Ga()) {
                d = this.g;
                d || (d = this.g = {});
                var e = c.g, f = c.i, g = c.c, h = c.l;
                d.lineCap = c.f || 'round';
                d.lineDash = e ? e.slice() : fi;
                d.lineDashOffset = void 0 === f ? 0 : f;
                d.lineJoin = c.j || 'round';
                d.lineWidth = void 0 === g ? 1 : g;
                d.miterLimit = void 0 === h ? 10 : h;
                d.strokeStyle = zi(c.a || gi);
            } else
                d = this.g = null;
            c = this.f;
            e = a.a || '10px sans-serif';
            ni(e);
            f = a.b;
            c.overflow = a.v;
            c.font = e;
            c.maxAngle = a.s;
            c.placement = a.o;
            c.textAlign = a.f;
            c.textBaseline = a.j || 'middle';
            c.backgroundFill = a.N;
            c.backgroundStroke = a.D;
            c.padding = a.C || hi;
            c.scale = void 0 === f ? 1 : f;
            e = a.g;
            f = a.c;
            g = a.l;
            h = a.i;
            this.ta = a.Ka() || '';
            this.D = void 0 === e ? 0 : e;
            this.l = void 0 === f ? 0 : f;
            this.C = void 0 === g ? !1 : g;
            this.B = void 0 === h ? 0 : h;
            this.V = d ? ('string' == typeof d.strokeStyle ? d.strokeStyle : x(d.strokeStyle)) + d.lineCap + d.lineDashOffset + '|' + d.lineWidth + d.lineJoin + d.miterLimit + '[' + d.lineDash.join() + ']' : '';
            this.j = c.font + c.scale + (c.textAlign || '?');
            this.v = b ? 'string' == typeof b.fillStyle ? b.fillStyle : '|' + x(b.fillStyle) : '';
        } else
            this.ta = '';
    };
    function Vj(a, b, c, d, e, f, g) {
        this.a = f;
        this.g = null;
        this.o = a;
        this.c = b;
        this.l = e;
        this.s = d;
        this.v = c;
        this.i = g;
        this.b = {};
        this.f = hg(1, 1);
        this.j = We();
    }
    w(Vj, sj);
    var Wj = { 0: [[!0]] };
    function Xj(a, b, c) {
        var d, e = Math.floor(a.length / 2);
        if (b >= e)
            for (d = e; d < b; d++)
                a[d][c] = !0;
        else if (b < e)
            for (d = b + 1; d < e; d++)
                a[d][c] = !0;
    }
    function Yj(a) {
        if (void 0 !== Wj[a])
            return Wj[a];
        for (var b = 2 * a + 1, c = Array(b), d = 0; d < b; d++)
            c[d] = Array(b);
        b = a;
        for (var e = d = 0; b >= d;)
            Xj(c, a + b, a + d), Xj(c, a + d, a + b), Xj(c, a - d, a + b), Xj(c, a - b, a + d), Xj(c, a - b, a - d), Xj(c, a - d, a - b), Xj(c, a + d, a - b), Xj(c, a + b, a - d), d++, e += 1 + 2 * d, 0 < 2 * (e - b) + 1 && (--b, e += 1 - 2 * b);
        return Wj[a] = c;
    }
    k = Vj.prototype;
    k.Vb = function (a) {
        var b = null;
        this.a && (a ? (b = this.g, b[4]++) : (b = this.g = Da(), b.push(1)));
        return b;
    };
    function Zj(a) {
        for (var b in a.b) {
            var c = a.b[b], d;
            for (d in c)
                c[d].bf();
        }
    }
    k.wa = function (a, b, c, d, e, f, g) {
        function h(a) {
            for (var b = n.getImageData(0, 0, l, l).data, c = 0; c < l; c++)
                for (var d = 0; d < l; d++)
                    if (q[c][d] && 0 < b[4 * (d * l + c) + 3]) {
                        if (!r || 'Image' != z && 'Text' != z || -1 !== r.indexOf(a))
                            var e = f(a);
                        if (e)
                            return e;
                        n.clearRect(0, 0, l, l);
                        return;
                    }
        }
        d = Math.round(d);
        var l = 2 * d + 1, m = ef(this.j, d + 0.5, d + 0.5, 1 / b, -1 / b, -c, -a[0], -a[1]), n = this.f;
        n.canvas.width !== l || n.canvas.height !== l ? (n.canvas.width = l, n.canvas.height = l) : n.clearRect(0, 0, l, l);
        if (void 0 !== this.i) {
            var p = Da();
            Ea(p, a);
            Fa(p, b * (this.i + d), p);
        }
        var q = Yj(d), r;
        this.a && (r = this.a.all().map(function (a) {
            return a.value;
        }));
        a = Object.keys(this.b).map(Number);
        a.sort(dc);
        for (b = a.length - 1; 0 <= b; --b) {
            var u = a[b].toString();
            var v = this.b[u];
            for (d = uj.length - 1; 0 <= d; --d) {
                var z = uj[d];
                var A = v[z];
                if (void 0 !== A)
                    if (!g || 'Image' != z && 'Text' != z) {
                        if (A = Ij(A, n, m, c, e, h, p))
                            return A;
                    } else {
                        var E = g[u];
                        E ? E.push(A, m.slice(0)) : g[u] = [
                            A,
                            m.slice(0)
                        ];
                    }
            }
        }
    };
    function ak(a, b) {
        var c = a.c;
        a = c[0];
        var d = c[1], e = c[2];
        c = c[3];
        a = [
            a,
            d,
            a,
            c,
            e,
            c,
            e,
            d
        ];
        Te(a, 0, 8, 2, b, a);
        return a;
    }
    k.Ja = function (a, b) {
        var c = void 0 !== a ? a.toString() : '0';
        a = this.b[c];
        void 0 === a && (a = {}, this.b[c] = a);
        c = a[b];
        void 0 === c && (c = new bk[b](this.o, this.c, this.v, this.s, this.l, this.a), a[b] = c);
        return c;
    };
    k.yg = function () {
        return nb(this.b);
    };
    k.Na = function (a, b, c, d, e, f) {
        var g = Object.keys(this.b).map(Number);
        g.sort(dc);
        a.save();
        var h = ak(this, b);
        a.beginPath();
        a.moveTo(h[0], h[1]);
        a.lineTo(h[2], h[3]);
        a.lineTo(h[4], h[5]);
        a.lineTo(h[6], h[7]);
        a.clip();
        e = e ? e : uj;
        var l, m;
        h = 0;
        for (l = g.length; h < l; ++h) {
            var n = g[h].toString();
            var p = this.b[n];
            var q = 0;
            for (m = e.length; q < m; ++q) {
                var r = e[q];
                var u = p[r];
                void 0 !== u && (!f || 'Image' != r && 'Text' != r ? u.Na(a, b, c, d) : (r = f[n]) ? r.push(u, b.slice(0)) : f[n] = [
                    u,
                    b.slice(0)
                ]);
            }
        }
        a.restore();
    };
    var bk = {
        Circle: Pj,
        Default: wj,
        Image: Mj,
        LineString: Nj,
        Polygon: Pj,
        Text: Sj
    };
    function ck(a, b) {
        return x(a) - x(b);
    }
    function dk(a, b) {
        a = 0.5 * a / b;
        return a * a;
    }
    function ek(a, b, c, d, e, f) {
        var g = !1, h;
        if (h = c.Y()) {
            var l = h.gf();
            2 == l || 3 == l ? h.Yj(e, f) : (0 == l && h.load(), h.gi(e, f), g = !0);
        }
        if (e = (0, c.cb)(b))
            if (d = e.Wd(d), c.Ie())
                fk(a, d, c, b);
            else
                (0, gk[d.S()])(a, d, c, b);
        return g;
    }
    function fk(a, b, c, d) {
        if ('GeometryCollection' == b.S()) {
            b = b.vd();
            for (var e = 0, f = b.length; e < f; ++e)
                fk(a, b[e], c, d);
        } else
            a.Ja(c.Ba(), 'Default').Hh(b, d, c.Ie());
    }
    var gk = {
        Point: function (a, b, c, d) {
            var e = c.Y();
            if (e) {
                if (2 != e.gf())
                    return;
                var f = a.Ja(c.Ba(), 'Image');
                f.Zb(e, a.Vb(!1));
                f.yc(b, d);
            }
            if (f = c.Ka())
                c = a.Ja(c.Ba(), 'Text'), c.nb(f, a.Vb(!!e)), c.Wb(b, d);
        },
        LineString: function (a, b, c, d) {
            var e = c.Ga();
            if (e) {
                var f = a.Ja(c.Ba(), 'LineString');
                f.Oa(null, e);
                f.uc(b, d);
            }
            if (e = c.Ka())
                c = a.Ja(c.Ba(), 'Text'), c.nb(e, a.Vb(!1)), c.Wb(b, d);
        },
        Polygon: function (a, b, c, d) {
            var e = c.Fa(), f = c.Ga();
            if (e || f) {
                var g = a.Ja(c.Ba(), 'Polygon');
                g.Oa(e, f);
                g.zc(b, d);
            }
            if (e = c.Ka())
                c = a.Ja(c.Ba(), 'Text'), c.nb(e, a.Vb(!1)), c.Wb(b, d);
        },
        MultiPoint: function (a, b, c, d) {
            var e = c.Y();
            if (e) {
                if (2 != e.gf())
                    return;
                var f = a.Ja(c.Ba(), 'Image');
                f.Zb(e, a.Vb(!1));
                f.wc(b, d);
            }
            if (f = c.Ka())
                c = a.Ja(c.Ba(), 'Text'), c.nb(f, a.Vb(!!e)), c.Wb(b, d);
        },
        MultiLineString: function (a, b, c, d) {
            var e = c.Ga();
            if (e) {
                var f = a.Ja(c.Ba(), 'LineString');
                f.Oa(null, e);
                f.vc(b, d);
            }
            if (e = c.Ka())
                c = a.Ja(c.Ba(), 'Text'), c.nb(e, a.Vb(!1)), c.Wb(b, d);
        },
        MultiPolygon: function (a, b, c, d) {
            var e = c.Fa(), f = c.Ga();
            if (f || e) {
                var g = a.Ja(c.Ba(), 'Polygon');
                g.Oa(e, f);
                g.xc(b, d);
            }
            if (e = c.Ka())
                c = a.Ja(c.Ba(), 'Text'), c.nb(e, a.Vb(!1)), c.Wb(b, d);
        },
        GeometryCollection: function (a, b, c, d) {
            b = b.a;
            var e;
            var f = 0;
            for (e = b.length; f < e; ++f)
                (0, gk[b[f].S()])(a, b[f], c, d);
        },
        Circle: function (a, b, c, d) {
            var e = c.Fa(), f = c.Ga();
            if (e || f) {
                var g = a.Ja(c.Ba(), 'Circle');
                g.Oa(e, f);
                g.cc(b, d);
            }
            if (e = c.Ka())
                c = a.Ja(c.Ba(), 'Text'), c.nb(e, a.Vb(!1)), c.Wb(b, d);
        }
    };
    function hk(a) {
        Xi.call(this, a);
        this.f = a.D ? rj.Jc(9) : null;
        this.i = !1;
        this.N = -1;
        this.o = NaN;
        this.l = Da();
        this.c = this.v = null;
        this.j = !0;
        this.context = hg();
        y(ii, 'clear', this.Vi, this);
    }
    w(hk, Xi);
    hk.handles = function (a, b) {
        return 'canvas' === a && 'VECTOR' === b.S();
    };
    hk.create = function (a, b) {
        return new hk(b);
    };
    k = hk.prototype;
    k.ia = function () {
        Mc(ii, 'clear', this.Vi, this);
        Xi.prototype.ia.call(this);
    };
    k.df = function (a, b, c) {
        var d = a.extent, e = a.pixelRatio, f = b.Te ? a.skippedFeatureUids : {}, g = a.viewState, h = g.projection, l = g.rotation, m = h.G(), n = this.a.ha(), p = $i(this, a, 0);
        Zi(this, 'precompose', c, a, p);
        var q = b.extent;
        (g = void 0 !== q) && Yi(c, a, q);
        var r = this.c;
        if (r && !r.yg()) {
            this.f && this.f.clear();
            var u = q = 0, v = 1 !== b.opacity, z = Tc(this.a, 'render');
            if (v || z) {
                var A = c.canvas.width;
                var E = c.canvas.height;
                if (l) {
                    var S = Math.round(Math.sqrt(A * A + E * E));
                    q = (S - A) / 2;
                    u = (S - E) / 2;
                    A = E = S;
                }
                this.context.canvas.width = A;
                this.context.canvas.height = E;
                A = this.context;
            } else
                A = c;
            E = A.globalAlpha;
            v || (A.globalAlpha = b.opacity);
            A != c && A.translate(q, u);
            S = a.size[0] * e;
            e *= a.size[1];
            qi(A, -l, S / 2, e / 2);
            r.Na(A, p, l, f);
            if (n.D && h.g && !La(m, d)) {
                h = d[0];
                n = cb(m);
                for (var Ia = 0; h < m[0];)
                    --Ia, p = n * Ia, p = $i(this, a, p), r.Na(A, p, l, f), h += n;
                Ia = 0;
                for (h = d[2]; h > m[2];)
                    ++Ia, p = n * Ia, p = $i(this, a, p), r.Na(A, p, l, f), h -= n;
                p = $i(this, a, 0);
            }
            qi(A, l, S / 2, e / 2);
            A != c && (z && Zi(this, 'render', A, a, p), v ? (d = c.globalAlpha, c.globalAlpha = b.opacity, c.drawImage(A.canvas, -q, -u), c.globalAlpha = d) : c.drawImage(A.canvas, -q, -u), A.translate(-q, -u));
            v || (A.globalAlpha = E);
        }
        g && c.restore();
        this.pf(c, a, b, p);
    };
    k.wa = function (a, b, c, d, e) {
        if (this.c) {
            var f = this.a, g = {};
            return this.c.wa(a, b.viewState.resolution, b.viewState.rotation, c, {}, function (a) {
                var b = x(a).toString();
                if (!(b in g))
                    return g[b] = !0, d.call(e, a, f);
            }, null);
        }
    };
    k.Vi = function () {
        var a = this.a;
        a.Jb() && this.c && a.u();
    };
    k.Wi = function () {
        Mi(this);
    };
    k.$c = function (a) {
        var b = this.a, c = b.ha();
        Ui(a, c);
        var d = a.viewHints[0], e = a.viewHints[1], f = b.ca, g = b.ra;
        if (!this.i && !f && d || !g && e)
            return !0;
        f = a.extent;
        var h = a.viewState;
        g = h.projection;
        var l = h.resolution, m = a.pixelRatio;
        d = b.g;
        var n = b.f;
        e = b.get(ik);
        void 0 === e && (e = ck);
        f = Fa(f, n * l);
        n = h.projection.G();
        c.D && h.projection.g && !La(n, a.extent) && (a = Math.max(cb(f) / 2, cb(n)), f[0] = n[0] - a, f[2] = n[2] + a);
        if (!this.i && this.o == l && this.N == d && this.v == e && La(this.l, f))
            return this.j = !1, !0;
        this.c = null;
        this.i = !1;
        var p = new Vj(0.5 * l / m, f, l, m, c.$, this.f, b.f);
        c.ae(f, l, g);
        a = function (a) {
            var c = a.ib();
            if (c)
                var d = c.call(a, l);
            else
                (c = b.ib()) && (d = c(a, l));
            if (d) {
                if (d) {
                    c = !1;
                    if (Array.isArray(d))
                        for (var e = 0, f = d.length; e < f; ++e)
                            c = ek(p, a, d[e], dk(l, m), this.Wi, this) || c;
                    else
                        c = ek(p, a, d, dk(l, m), this.Wi, this);
                    a = c;
                } else
                    a = !1;
                this.i = this.i || a;
            }
        }.bind(this);
        if (e) {
            var q = [];
            c.ec(f, function (a) {
                q.push(a);
            }, this);
            q.sort(e);
            c = 0;
            for (g = q.length; c < g; ++c)
                a(q[c]);
        } else
            c.ec(f, a, this);
        Zj(p);
        this.o = l;
        this.N = d;
        this.v = e;
        this.l = f;
        this.c = p;
        return this.j = !0;
    };
    function jk(a) {
        this.context = null;
        mj.call(this, a);
        this.N = a.D ? rj.Jc(9) : null;
        this.D = !1;
        this.ca = We();
        this.O = 'vector' == a.l ? 1 : 0;
        y(ii, 'clear', this.Xi, this);
    }
    w(jk, mj);
    jk.handles = function (a, b) {
        return 'canvas' === a && 'VECTOR_TILE' === b.S();
    };
    jk.create = function (a, b) {
        return new jk(b);
    };
    var kk = {
            image: [
                'Polygon',
                'Circle',
                'LineString',
                'Image',
                'Text'
            ],
            hybrid: [
                'Polygon',
                'LineString'
            ]
        }, lk = {
            image: ['Default'],
            hybrid: [
                'Image',
                'Text',
                'Default'
            ],
            vector: uj
        };
    k = jk.prototype;
    k.ia = function () {
        Mc(ii, 'clear', this.Xi, this);
        mj.prototype.ia.call(this);
    };
    k.$c = function (a, b) {
        var c = this.a, d = c.g;
        this.B != d && (this.f.length = 0, c = c.l, this.context || 'vector' == c || (this.context = hg()), this.context && 'vector' == c && (this.context = null));
        this.B = d;
        return mj.prototype.$c.apply(this, arguments);
    };
    k.Sf = function (a, b, c, d, e, f, g, h, l) {
        var m = a, n = this.a, p = b.pixelRatio, q = b.viewState.projection, r = n.g, u = n.get(ik) || null, v = mk(m, n);
        if (v.Be || v.wf != r || v.eh != u) {
            var z = n.ha(), A = z.tileGrid, E = z.eb(q), S = E.Ta(m.ya[0]);
            E = E.Ma(m.l);
            for (var Ia = 0, ta = m.a.length; Ia < ta; ++Ia) {
                var la = m.c[m.a[Ia]];
                if (3 != la.getState()) {
                    var ca = A.Ma(la.ya), ia = gb(E, ca), xa = Sa(ca, ia) ? null : Fa(ia, n.f * S), Va = la.o, ic = !1;
                    Xb(q, Va) || (ic = !0, la.vg(q));
                    v.Be = !1;
                    ia = new Vj(0, ia, S, p, z.s, this.N, n.f);
                    var Xa = dk(S, p), Z = la.a;
                    u && u !== v.eh && Z.sort(u);
                    for (var Zb, Le = 0, Uf = Z.length; Le < Uf; ++Le)
                        if (Zb = Z[Le], ic && ('tile-pixels' == Va.a && (Va.Sj(ca), Va.Si(la.G())), Zb.U().mb(Va, q)), !xa || hb(xa, Zb.U().G())) {
                            var Id = void 0, te = Zb.ib();
                            te ? Id = te.call(Zb, S) : (te = n.ib()) && (Id = te(Zb, S));
                            if (Id) {
                                te = Xa;
                                var Jh = ia;
                                if (Id) {
                                    var Mg = !1;
                                    if (Array.isArray(Id))
                                        for (var Ng = 0, Wf = Id.length; Ng < Wf; ++Ng)
                                            Mg = ek(Jh, Zb, Id[Ng], te, this.Yi, this) || Mg;
                                    else
                                        Mg = ek(Jh, Zb, Id, te, this.Yi, this);
                                    Zb = Mg;
                                } else
                                    Zb = !1;
                                this.D = this.D || Zb;
                                v.Be = v.Be || Zb;
                            }
                        }
                    Zj(ia);
                    for (var rf in ia.b);
                    ca = m.ya.toString();
                    xa = ia;
                    la.f[x(n) + ',' + ca] = xa;
                }
            }
            v.wf = r;
            v.eh = u;
        }
        if (this.context) {
            v = b;
            n = this.a;
            q = mk(m, n);
            r = n.g;
            if ((p = kk[n.l]) && q.fh !== r)
                for (q.fh = r, z = m.l, S = z[0], q = v.pixelRatio, rf = n.ha(), A = rf.eb(v.viewState.projection), r = A.Ta(S), u = nk(m, n), v = rf.Zd(S, q, v.viewState.projection), u.canvas.width = v[0], u.canvas.height = v[1], v = A.Ma(z), z = 0, A = m.a.length; z < A; ++z)
                    S = m.c[m.a[z]], 3 != S.getState() && (rf = q / r, E = Xe(this.ca), cf(E, rf, -rf), df(E, -v[0], -v[3]), ok(S, n, m.ya.toString()).Na(u, E, 0, {}, p));
            mj.prototype.Sf.apply(this, arguments);
        }
    };
    k.wa = function (a, b, c, d, e) {
        var f = b.viewState.resolution, g = b.viewState.rotation;
        c = void 0 == c ? 0 : c;
        var h = this.a, l = {}, m = this.f;
        b = h.ha().eb(b.viewState.projection);
        var n;
        var p = 0;
        for (n = m.length; p < n; ++p) {
            var q = m[p];
            var r = q.l;
            r = b.Ma(r, this.T);
            var u = Fa(r, c * f, u);
            if (Ja(u, a)) {
                r = 0;
                for (var v = q.a.length; r < v; ++r) {
                    var z = q.c[q.a[r]];
                    if (3 != z.getState()) {
                        z = ok(z, h, q.ya.toString());
                        var A = A || z.wa(a, f, g, c, {}, function (a) {
                            var b = x(a).toString();
                            if (!(b in l))
                                return l[b] = !0, d.call(e, a, h);
                        }, null);
                    }
                }
            }
        }
        return A;
    };
    k.Xi = function () {
        var a = this.a;
        a.Jb() && void 0 !== this.B && a.u();
    };
    k.Yi = function () {
        Mi(this);
    };
    k.pf = function (a, b, c) {
        var d = this.a, e = d.D ? {} : null, f = d.ha(), g = d.l, h = lk[g], l = b.pixelRatio, m = b.viewState.rotation, n = b.size;
        if (m) {
            var p = Math.round(l * n[0] / 2);
            var q = Math.round(l * n[1] / 2);
            qi(a, -m, p, q);
        }
        e && this.N.clear();
        l = this.f;
        f = f.eb(b.viewState.projection);
        n = [];
        for (var r = [], u = l.length - 1; 0 <= u; --u) {
            var v = l[u];
            if (5 != v.getState())
                for (var z = v.ya, A = f.Ma(z)[0] - f.Ma(v.l)[0], E = void 0, S = 0, Ia = v.a.length; S < Ia; ++S) {
                    var ta = v.c[v.a[S]];
                    if (3 != ta.getState()) {
                        var la = ok(ta, d, z.toString()), ca;
                        if (!(ca = 'vector' == g))
                            a: {
                                ca = void 0;
                                for (ca in la.b)
                                    for (var ia = la.b[ca], xa = 0, Va = h.length; xa < Va; ++xa)
                                        if (h[xa] in ia) {
                                            ca = !0;
                                            break a;
                                        }
                                ca = !1;
                            }
                        if (ca) {
                            E || (E = $i(this, b, A));
                            ta = ta.ya[0];
                            ca = ak(la, E);
                            a.save();
                            a.globalAlpha = c.opacity;
                            ia = 0;
                            for (xa = n.length; ia < xa; ++ia)
                                Va = n[ia], ta < r[ia] && (a.beginPath(), a.moveTo(ca[0], ca[1]), a.lineTo(ca[2], ca[3]), a.lineTo(ca[4], ca[5]), a.lineTo(ca[6], ca[7]), a.moveTo(Va[6], Va[7]), a.lineTo(Va[4], Va[5]), a.lineTo(Va[2], Va[3]), a.lineTo(Va[0], Va[1]), a.clip());
                            la.Na(a, E, m, {}, h, e);
                            a.restore();
                            n.push(ca);
                            r.push(ta);
                        }
                    }
                }
        }
        if (e)
            for (d = a, g = Object.keys(e).map(Number).sort(dc), h = {}, l = 0, f = g.length; l < f; ++l)
                for (n = e[g[l].toString()], r = 0, u = n.length; r < u;)
                    v = n[r++], z = n[r++], v.Na(d, z, m, h);
        m && qi(a, m, p, q);
        mj.prototype.pf.apply(this, arguments);
    };
    qg('MAP_RENDERER', kj);
    rg([
        bj,
        mj,
        hk,
        jk
    ]);
    function H(a) {
        a = kb({}, a);
        delete a.renderer;
        a.controls || (a.controls = Fg());
        a.interactions || (a.interactions = Zh());
        G.call(this, a);
    }
    w(H, G);
    function pk(a) {
        Vc.call(this);
        a = a ? a : {};
        this.a = null;
        y(this, Xc(qk), this.$m, this);
        this.rg(void 0 !== a.tracking ? a.tracking : !1);
    }
    w(pk, Vc);
    k = pk.prototype;
    k.ia = function () {
        this.rg(!1);
        Vc.prototype.ia.call(this);
    };
    k.Dp = function (a) {
        if (null !== a.alpha) {
            var b = va(a.alpha);
            this.set(rk, b);
            'boolean' === typeof a.absolute && a.absolute ? this.set(sk, b) : 'number' === typeof a.webkitCompassHeading && -1 != a.webkitCompassAccuracy && this.set(sk, va(a.webkitCompassHeading));
        }
        null !== a.beta && this.set(tk, va(a.beta));
        null !== a.gamma && this.set(uk, va(a.gamma));
        this.u();
    };
    k.Ym = function () {
        return this.get(rk);
    };
    k.ll = function () {
        return this.get(tk);
    };
    k.ql = function () {
        return this.get(uk);
    };
    k.Zm = function () {
        return this.get(sk);
    };
    k.li = function () {
        return this.get(qk);
    };
    k.$m = function () {
        if (qd) {
            var a = this.li();
            a && !this.a ? this.a = y(window, 'deviceorientation', this.Dp, this) : a || null === this.a || (Gc(this.a), this.a = null);
        }
    };
    k.rg = function (a) {
        this.set(qk, a);
    };
    var rk = 'alpha', tk = 'beta', uk = 'gamma', sk = 'heading', qk = 'tracking';
    function vk(a) {
        this.i = a.opacity;
        this.s = a.rotateWithView;
        this.f = a.rotation;
        this.a = a.scale;
        this.v = a.snapToPixel;
    }
    k = vk.prototype;
    k.hf = function () {
        return this.i;
    };
    k.jf = function () {
        return this.s;
    };
    k.kf = function () {
        return this.f;
    };
    k.lf = function () {
        return this.a;
    };
    k.Ke = function () {
        return this.v;
    };
    k.Ed = function (a) {
        this.i = a;
    };
    k.mf = function (a) {
        this.f = a;
    };
    k.Fd = function (a) {
        this.a = a;
    };
    function wk(a) {
        this.D = this.o = this.c = null;
        this.Xa = void 0 !== a.fill ? a.fill : null;
        this.oa = [
            0,
            0
        ];
        this.l = a.points;
        this.b = void 0 !== a.radius ? a.radius : a.radius1;
        this.g = a.radius2;
        this.j = void 0 !== a.angle ? a.angle : 0;
        this.Ya = void 0 !== a.stroke ? a.stroke : null;
        this.B = this.qa = this.C = null;
        this.N = a.atlasManager;
        xk(this, this.N);
        vk.call(this, {
            opacity: 1,
            rotateWithView: void 0 !== a.rotateWithView ? a.rotateWithView : !1,
            rotation: void 0 !== a.rotation ? a.rotation : 0,
            scale: 1,
            snapToPixel: void 0 !== a.snapToPixel ? a.snapToPixel : !0
        });
    }
    w(wk, vk);
    k = wk.prototype;
    k.clone = function () {
        var a = new wk({
            fill: this.Fa() ? this.Fa().clone() : void 0,
            points: this.l,
            radius: this.b,
            radius2: this.g,
            angle: this.j,
            snapToPixel: this.v,
            stroke: this.Ga() ? this.Ga().clone() : void 0,
            rotation: this.f,
            rotateWithView: this.s,
            atlasManager: this.N
        });
        a.Ed(this.i);
        a.Fd(this.a);
        return a;
    };
    k.Vc = function () {
        return this.C;
    };
    k.ij = function () {
        return this.j;
    };
    k.Fa = function () {
        return this.Xa;
    };
    k.Eg = function () {
        return this.D;
    };
    k.Y = function () {
        return this.o;
    };
    k.He = function () {
        return this.B;
    };
    k.gf = function () {
        return 2;
    };
    k.bd = function () {
        return this.oa;
    };
    k.jj = function () {
        return this.l;
    };
    k.kj = function () {
        return this.b;
    };
    k.Zh = function () {
        return this.g;
    };
    k.oc = function () {
        return this.qa;
    };
    k.Ga = function () {
        return this.Ya;
    };
    k.gi = function () {
    };
    k.load = function () {
    };
    k.Yj = function () {
    };
    function xk(a, b) {
        var c = '', d = '', e = 0, f = null, g = 0, h = 0;
        if (a.Ya) {
            var l = a.Ya.a;
            null === l && (l = gi);
            l = zi(l);
            h = a.Ya.c;
            void 0 === h && (h = 1);
            f = a.Ya.g;
            g = a.Ya.i;
            od || (f = null, g = 0);
            d = a.Ya.j;
            void 0 === d && (d = 'round');
            c = a.Ya.f;
            void 0 === c && (c = 'round');
            e = a.Ya.l;
            void 0 === e && (e = 10);
        }
        var m = 2 * (a.b + h) + 1;
        c = {
            strokeStyle: l,
            Wj: h,
            size: m,
            lineCap: c,
            lineDash: f,
            lineDashOffset: g,
            lineJoin: d,
            miterLimit: e
        };
        if (void 0 === b) {
            var n = hg(m, m);
            a.o = n.canvas;
            b = m = a.o.width;
            a.Jh(c, n, 0, 0);
            a.Xa ? a.D = a.o : (n = hg(c.size, c.size), a.D = n.canvas, a.Ih(c, n, 0, 0));
        } else
            m = Math.round(m), (d = !a.Xa) && (n = a.Ih.bind(a, c)), a.Ya ? (e = a.Ya, void 0 === e.b && (e.b = 's', e.b = e.a ? 'string' === typeof e.a ? e.b + e.a : e.b + x(e.a).toString() : e.b + '-', e.b += ',' + (void 0 !== e.f ? e.f.toString() : '-') + ',' + (e.g ? e.g.toString() : '-') + ',' + (void 0 !== e.i ? e.i : '-') + ',' + (void 0 !== e.j ? e.j : '-') + ',' + (void 0 !== e.l ? e.l.toString() : '-') + ',' + (void 0 !== e.c ? e.c.toString() : '-')), e = e.b) : e = '-', a.Xa ? (f = a.Xa, void 0 === f.a && (f.a = f.b instanceof CanvasPattern || f.b instanceof CanvasGradient ? x(f.b).toString() : 'f' + (f.b ? xi(f.b) : '-')), f = f.a) : f = '-', a.c && e == a.c[1] && f == a.c[2] && a.b == a.c[3] && a.g == a.c[4] && a.j == a.c[5] && a.l == a.c[6] || (a.c = [
                'r' + e + f + (void 0 !== a.b ? a.b.toString() : '-') + (void 0 !== a.g ? a.g.toString() : '-') + (void 0 !== a.j ? a.j.toString() : '-') + (void 0 !== a.l ? a.l.toString() : '-'),
                e,
                f,
                a.b,
                a.g,
                a.j,
                a.l
            ]), n = b.add(a.c[0], m, m, a.Jh.bind(a, c), n), a.o = n.image, a.oa = [
                n.offsetX,
                n.offsetY
            ], b = n.image.width, a.D = d ? n.Bm : a.o;
        a.C = [
            m / 2,
            m / 2
        ];
        a.qa = [
            m,
            m
        ];
        a.B = [
            b,
            b
        ];
    }
    k.Jh = function (a, b, c, d) {
        b.setTransform(1, 0, 0, 1, 0, 0);
        b.translate(c, d);
        b.beginPath();
        var e = this.l;
        if (Infinity === e)
            b.arc(a.size / 2, a.size / 2, this.b, 0, 2 * Math.PI, !0);
        else {
            var f = void 0 !== this.g ? this.g : this.b;
            f !== this.b && (e *= 2);
            for (c = 0; c <= e; c++) {
                d = 2 * c * Math.PI / e - Math.PI / 2 + this.j;
                var g = 0 === c % 2 ? this.b : f;
                b.lineTo(a.size / 2 + g * Math.cos(d), a.size / 2 + g * Math.sin(d));
            }
        }
        this.Xa && (c = this.Xa.b, null === c && (c = ei), b.fillStyle = zi(c), b.fill());
        this.Ya && (b.strokeStyle = a.strokeStyle, b.lineWidth = a.Wj, a.lineDash && (b.setLineDash(a.lineDash), b.lineDashOffset = a.lineDashOffset), b.lineCap = a.lineCap, b.lineJoin = a.lineJoin, b.miterLimit = a.miterLimit, b.stroke());
        b.closePath();
    };
    k.Ih = function (a, b, c, d) {
        b.setTransform(1, 0, 0, 1, 0, 0);
        b.translate(c, d);
        b.beginPath();
        c = this.l;
        if (Infinity === c)
            b.arc(a.size / 2, a.size / 2, this.b, 0, 2 * Math.PI, !0);
        else {
            d = void 0 !== this.g ? this.g : this.b;
            d !== this.b && (c *= 2);
            var e;
            for (e = 0; e <= c; e++) {
                var f = 2 * e * Math.PI / c - Math.PI / 2 + this.j;
                var g = 0 === e % 2 ? this.b : d;
                b.lineTo(a.size / 2 + g * Math.cos(f), a.size / 2 + g * Math.sin(f));
            }
        }
        b.fillStyle = ei;
        b.fill();
        this.Ya && (b.strokeStyle = a.strokeStyle, b.lineWidth = a.Wj, a.lineDash && (b.setLineDash(a.lineDash), b.lineDashOffset = a.lineDashOffset), b.stroke());
        b.closePath();
    };
    function yk(a) {
        a = a || {};
        wk.call(this, {
            points: Infinity,
            fill: a.fill,
            radius: a.radius,
            snapToPixel: a.snapToPixel,
            stroke: a.stroke,
            atlasManager: a.atlasManager
        });
    }
    w(yk, wk);
    yk.prototype.clone = function () {
        var a = new yk({
            fill: this.Fa() ? this.Fa().clone() : void 0,
            stroke: this.Ga() ? this.Ga().clone() : void 0,
            radius: this.b,
            snapToPixel: this.v,
            atlasManager: this.N
        });
        a.Ed(this.i);
        a.Fd(this.a);
        return a;
    };
    yk.prototype.fd = function (a) {
        this.b = a;
        xk(this, this.N);
    };
    function zk(a) {
        a = a || {};
        this.b = void 0 !== a.color ? a.color : null;
        this.a = void 0;
    }
    zk.prototype.clone = function () {
        var a = this.b;
        return new zk({ color: a && a.slice ? a.slice() : a || void 0 });
    };
    zk.prototype.g = function () {
        return this.b;
    };
    zk.prototype.c = function (a) {
        this.b = a;
        this.a = void 0;
    };
    function Ak(a) {
        a = a || {};
        this.a = void 0 !== a.color ? a.color : null;
        this.f = a.lineCap;
        this.g = void 0 !== a.lineDash ? a.lineDash : null;
        this.i = a.lineDashOffset;
        this.j = a.lineJoin;
        this.l = a.miterLimit;
        this.c = a.width;
        this.b = void 0;
    }
    k = Ak.prototype;
    k.clone = function () {
        var a = this.a;
        return new Ak({
            color: a && a.slice ? a.slice() : a || void 0,
            lineCap: this.f,
            lineDash: this.g ? this.g.slice() : void 0,
            lineDashOffset: this.i,
            lineJoin: this.j,
            miterLimit: this.l,
            width: this.c
        });
    };
    k.pp = function () {
        return this.a;
    };
    k.vl = function () {
        return this.f;
    };
    k.qp = function () {
        return this.g;
    };
    k.wl = function () {
        return this.i;
    };
    k.xl = function () {
        return this.j;
    };
    k.Dl = function () {
        return this.l;
    };
    k.rp = function () {
        return this.c;
    };
    k.sp = function (a) {
        this.a = a;
        this.b = void 0;
    };
    k.yq = function (a) {
        this.f = a;
        this.b = void 0;
    };
    k.setLineDash = function (a) {
        this.g = a;
        this.b = void 0;
    };
    k.zq = function (a) {
        this.i = a;
        this.b = void 0;
    };
    k.Aq = function (a) {
        this.j = a;
        this.b = void 0;
    };
    k.Eq = function (a) {
        this.l = a;
        this.b = void 0;
    };
    k.Kq = function (a) {
        this.c = a;
        this.b = void 0;
    };
    function Bk(a) {
        a = a || {};
        this.Uc = null;
        this.cb = Ck;
        void 0 !== a.geometry && this.Va(a.geometry);
        this.Xa = void 0 !== a.fill ? a.fill : null;
        this.M = void 0 !== a.image ? a.image : null;
        this.pc = void 0 !== a.renderer ? a.renderer : null;
        this.Ya = void 0 !== a.stroke ? a.stroke : null;
        this.ta = void 0 !== a.text ? a.text : null;
        this.bk = a.zIndex;
    }
    k = Bk.prototype;
    k.clone = function () {
        var a = this.U();
        a && a.clone && (a = a.clone());
        return new Bk({
            geometry: a,
            fill: this.Fa() ? this.Fa().clone() : void 0,
            image: this.Y() ? this.Y().clone() : void 0,
            stroke: this.Ga() ? this.Ga().clone() : void 0,
            text: this.Ka() ? this.Ka().clone() : void 0,
            zIndex: this.Ba()
        });
    };
    k.Ie = function () {
        return this.pc;
    };
    k.Iq = function (a) {
        this.pc = a;
    };
    k.U = function () {
        return this.Uc;
    };
    k.rl = function () {
        return this.cb;
    };
    k.Fa = function () {
        return this.Xa;
    };
    k.yf = function (a) {
        this.Xa = a;
    };
    k.Y = function () {
        return this.M;
    };
    k.ih = function (a) {
        this.M = a;
    };
    k.Ga = function () {
        return this.Ya;
    };
    k.Af = function (a) {
        this.Ya = a;
    };
    k.Ka = function () {
        return this.ta;
    };
    k.Hd = function (a) {
        this.ta = a;
    };
    k.Ba = function () {
        return this.bk;
    };
    k.Va = function (a) {
        'function' === typeof a ? this.cb = a : 'string' === typeof a ? this.cb = function (b) {
            return b.get(a);
        } : a ? void 0 !== a && (this.cb = function () {
            return a;
        }) : this.cb = Ck;
        this.Uc = a;
    };
    k.$b = function (a) {
        this.bk = a;
    };
    function Dk(a) {
        if ('function' !== typeof a) {
            if (Array.isArray(a))
                var b = a;
            else
                oa(a instanceof Bk, 41), b = [a];
            a = function () {
                return b;
            };
        }
        return a;
    }
    var Ek = null;
    function Fk() {
        if (!Ek) {
            var a = new zk({ color: 'rgba(255,255,255,0.4)' }), b = new Ak({
                    color: '#3399CC',
                    width: 1.25
                });
            Ek = [new Bk({
                    image: new yk({
                        fill: a,
                        stroke: b,
                        radius: 5
                    }),
                    fill: a,
                    stroke: b
                })];
        }
        return Ek;
    }
    function Gk() {
        var a = {}, b = [
                255,
                255,
                255,
                1
            ], c = [
                0,
                153,
                255,
                1
            ];
        a.Polygon = [new Bk({
                fill: new zk({
                    color: [
                        255,
                        255,
                        255,
                        0.5
                    ]
                })
            })];
        a.MultiPolygon = a.Polygon;
        a.LineString = [
            new Bk({
                stroke: new Ak({
                    color: b,
                    width: 5
                })
            }),
            new Bk({
                stroke: new Ak({
                    color: c,
                    width: 3
                })
            })
        ];
        a.MultiLineString = a.LineString;
        a.Circle = a.Polygon.concat(a.LineString);
        a.Point = [new Bk({
                image: new yk({
                    radius: 6,
                    fill: new zk({ color: c }),
                    stroke: new Ak({
                        color: b,
                        width: 1.5
                    })
                }),
                zIndex: Infinity
            })];
        a.MultiPoint = a.Point;
        a.GeometryCollection = a.Polygon.concat(a.LineString, a.Point);
        return a;
    }
    function Ck(a) {
        return a.U();
    }
    function Hk(a) {
        Vc.call(this);
        this.c = void 0;
        this.a = 'geometry';
        this.f = null;
        this.j = void 0;
        this.i = null;
        y(this, Xc(this.a), this.Oe, this);
        void 0 !== a && (a instanceof gf || !a ? this.Va(a) : this.H(a));
    }
    w(Hk, Vc);
    k = Hk.prototype;
    k.clone = function () {
        var a = new Hk(this.L());
        a.Lc(this.a);
        var b = this.U();
        b && a.Va(b.clone());
        (b = this.f) && a.sg(b);
        return a;
    };
    k.U = function () {
        return this.get(this.a);
    };
    k.an = function () {
        return this.c;
    };
    k.sl = function () {
        return this.a;
    };
    k.bn = function () {
        return this.f;
    };
    k.ib = function () {
        return this.j;
    };
    k.bm = function () {
        this.u();
    };
    k.Oe = function () {
        this.i && (Gc(this.i), this.i = null);
        var a = this.U();
        a && (this.i = y(a, 'change', this.bm, this));
        this.u();
    };
    k.Va = function (a) {
        this.set(this.a, a);
    };
    k.sg = function (a) {
        this.j = (this.f = a) ? Ik(a) : void 0;
        this.u();
    };
    k.qc = function (a) {
        this.c = a;
        this.u();
    };
    k.Lc = function (a) {
        Mc(this, Xc(this.a), this.Oe, this);
        this.a = a;
        y(this, Xc(this.a), this.Oe, this);
        this.Oe();
    };
    function Ik(a) {
        var b;
        if ('function' === typeof a)
            2 == a.length ? b = function (b) {
                return a(this, b);
            } : b = a;
        else {
            if (Array.isArray(a))
                var c = a;
            else
                oa(a instanceof Bk, 41), c = [a];
            b = function () {
                return c;
            };
        }
        return b;
    }
    function Jk(a) {
        Vc.call(this);
        a = a || {};
        this.a = null;
        this.i = $b;
        this.f = new ob(6378137);
        this.c = void 0;
        y(this, Xc('projection'), this.en, this);
        y(this, Xc('tracking'), this.fn, this);
        void 0 !== a.projection && this.oi(a.projection);
        void 0 !== a.trackingOptions && this.Rj(a.trackingOptions);
        this.Ue(void 0 !== a.tracking ? a.tracking : !1);
    }
    w(Jk, Vc);
    k = Jk.prototype;
    k.ia = function () {
        this.Ue(!1);
        Vc.prototype.ia.call(this);
    };
    k.en = function () {
        var a = this.mi();
        a && (this.i = Pb(Ob('EPSG:4326'), a), this.a && this.set('position', this.i(this.a)));
    };
    k.fn = function () {
        if (rd) {
            var a = this.ni();
            a && void 0 === this.c ? this.c = navigator.geolocation.watchPosition(this.Pp.bind(this), this.Qp.bind(this), this.ai()) : a || void 0 === this.c || (navigator.geolocation.clearWatch(this.c), this.c = void 0);
        }
    };
    k.Pp = function (a) {
        a = a.coords;
        this.set('accuracy', a.accuracy);
        this.set('altitude', null === a.altitude ? void 0 : a.altitude);
        this.set('altitudeAccuracy', null === a.altitudeAccuracy ? void 0 : a.altitudeAccuracy);
        this.set('heading', null === a.heading ? void 0 : va(a.heading));
        this.a ? (this.a[0] = a.longitude, this.a[1] = a.latitude) : this.a = [
            a.longitude,
            a.latitude
        ];
        var b = this.i(this.a);
        this.set('position', b);
        this.set('speed', null === a.speed ? void 0 : a.speed);
        a = Qf(this.f, this.a, a.accuracy);
        a.Rc(this.i);
        this.set('accuracyGeometry', a);
        this.u();
    };
    k.Qp = function (a) {
        a.type = 'error';
        this.Ue(!1);
        this.b(a);
    };
    k.el = function () {
        return this.get('accuracy');
    };
    k.fl = function () {
        return this.get('accuracyGeometry') || null;
    };
    k.gl = function () {
        return this.get('altitude');
    };
    k.hl = function () {
        return this.get('altitudeAccuracy');
    };
    k.cn = function () {
        return this.get('heading');
    };
    k.dn = function () {
        return this.get('position');
    };
    k.mi = function () {
        return this.get('projection');
    };
    k.Ol = function () {
        return this.get('speed');
    };
    k.ni = function () {
        return this.get('tracking');
    };
    k.ai = function () {
        return this.get('trackingOptions');
    };
    k.oi = function (a) {
        this.set('projection', Ob(a));
    };
    k.Ue = function (a) {
        this.set('tracking', a);
    };
    k.Rj = function (a) {
        this.set('trackingOptions', a);
    };
    function Kk(a, b, c, d, e, f) {
        var g = NaN, h = NaN, l = (c - b) / d;
        if (1 === l)
            g = a[b], h = a[b + 1];
        else if (2 == l)
            g = (1 - e) * a[b] + e * a[b + d], h = (1 - e) * a[b + 1] + e * a[b + d + 1];
        else if (0 !== l) {
            h = a[b];
            l = a[b + 1];
            var m = 0;
            g = [0];
            var n;
            for (n = b + d; n < c; n += d) {
                var p = a[n], q = a[n + 1];
                m += Math.sqrt((p - h) * (p - h) + (q - l) * (q - l));
                g.push(m);
                h = p;
                l = q;
            }
            c = e * m;
            l = 0;
            m = g.length;
            for (n = !1; l < m;)
                e = l + (m - l >> 1), h = +dc(g[e], c), 0 > h ? l = e + 1 : (m = e, n = !h);
            e = n ? l : ~l;
            0 > e ? (c = (c - g[-e - 2]) / (g[-e - 1] - g[-e - 2]), b += (-e - 2) * d, g = ya(a[b], a[b + d], c), h = ya(a[b + 1], a[b + d + 1], c)) : (g = a[b + e * d], h = a[b + e * d + 1]);
        }
        return f ? (f[0] = g, f[1] = h, f) : [
            g,
            h
        ];
    }
    function Sk(a, b, c, d, e, f) {
        if (c == b)
            return null;
        if (e < a[b + d - 1])
            return f ? (c = a.slice(b, b + d), c[d - 1] = e, c) : null;
        if (a[c - 1] < e)
            return f ? (c = a.slice(c - d, c), c[d - 1] = e, c) : null;
        if (e == a[b + d - 1])
            return a.slice(b, b + d);
        b /= d;
        for (c /= d; b < c;)
            f = b + c >> 1, e < a[(f + 1) * d - 1] ? c = f : b = f + 1;
        c = a[b * d - 1];
        if (e == c)
            return a.slice((b - 1) * d, (b - 1) * d + d);
        f = (e - c) / (a[(b + 1) * d - 1] - c);
        c = [];
        var g;
        for (g = 0; g < d - 1; ++g)
            c.push(ya(a[(b - 1) * d + g], a[b * d + g], f));
        c.push(e);
        return c;
    }
    function Tk(a, b, c, d, e, f) {
        var g = 0;
        if (f)
            return Sk(a, g, b[b.length - 1], c, d, e);
        if (d < a[c - 1])
            return e ? (a = a.slice(0, c), a[c - 1] = d, a) : null;
        if (a[a.length - 1] < d)
            return e ? (a = a.slice(a.length - c), a[c - 1] = d, a) : null;
        e = 0;
        for (f = b.length; e < f; ++e) {
            var h = b[e];
            if (g != h) {
                if (d < a[g + c - 1])
                    break;
                else if (d <= a[h - 1])
                    return Sk(a, g, h, c, d, !1);
                g = h;
            }
        }
        return null;
    }
    function I(a, b) {
        hf.call(this);
        this.c = null;
        this.o = this.D = this.j = -1;
        this.na(a, b);
    }
    w(I, hf);
    k = I.prototype;
    k.Fk = function (a) {
        this.A ? gc(this.A, a) : this.A = a.slice();
        this.u();
    };
    k.clone = function () {
        var a = new I(null);
        a.ba(this.ja, this.A.slice());
        return a;
    };
    k.Nb = function (a, b, c, d) {
        if (d < Ha(this.G(), a, b))
            return d;
        this.o != this.g && (this.D = Math.sqrt(pf(this.A, 0, this.A.length, this.a, 0)), this.o = this.g);
        return tf(this.A, 0, this.A.length, this.a, this.D, !1, a, b, c, d);
    };
    k.dl = function (a, b) {
        return Jf(this.A, 0, this.A.length, this.a, a, b);
    };
    k.Tn = function (a, b) {
        return 'XYM' != this.ja && 'XYZM' != this.ja ? null : Sk(this.A, 0, this.A.length, this.a, a, void 0 !== b ? b : !1);
    };
    k.W = function () {
        return yf(this.A, 0, this.A.length, this.a);
    };
    k.Ph = function (a, b) {
        return Kk(this.A, 0, this.A.length, this.a, a, b);
    };
    k.Un = function () {
        return tj(this.A, 0, this.A.length, this.a);
    };
    k.Fe = function () {
        this.j != this.g && (this.c = this.Ph(0.5, this.c), this.j = this.g);
        return this.c;
    };
    k.xd = function (a) {
        var b = [];
        b.length = Bf(this.A, 0, this.A.length, this.a, a, b, 0);
        a = new I(null);
        a.ba('XY', b);
        return a;
    };
    k.S = function () {
        return 'LineString';
    };
    k.$a = function (a) {
        return Kf(this.A, 0, this.A.length, this.a, a);
    };
    k.na = function (a, b) {
        a ? (lf(this, b, a, 1), this.A || (this.A = []), this.A.length = wf(this.A, 0, a, this.a), this.u()) : this.ba('XY', null);
    };
    k.ba = function (a, b) {
        kf(this, a, b);
        this.u();
    };
    function Uk(a, b, c) {
        for (var d = [], e = a(0), f = a(1), g = b(e), h = b(f), l = [
                    f,
                    e
                ], m = [
                    h,
                    g
                ], n = [
                    1,
                    0
                ], p = {}, q = 100000, r, u, v, z, A; 0 < --q && 0 < n.length;)
            v = n.pop(), e = l.pop(), g = m.pop(), f = v.toString(), f in p || (d.push(g[0], g[1]), p[f] = !0), z = n.pop(), f = l.pop(), h = m.pop(), A = (v + z) / 2, r = a(A), u = b(r), sa(u[0], u[1], g[0], g[1], h[0], h[1]) < c ? (d.push(h[0], h[1]), f = z.toString(), p[f] = !0) : (n.push(z, A, A, v), m.push(h, u, u, g), l.push(f, r, r, e));
        return d;
    }
    function Vk(a, b, c, d, e) {
        var f = Ob('EPSG:4326');
        return Uk(function (d) {
            return [
                a,
                b + (c - b) * d
            ];
        }, Yb(f, d), e);
    }
    function Wk(a, b, c, d, e) {
        var f = Ob('EPSG:4326');
        return Uk(function (d) {
            return [
                b + (c - b) * d,
                a
            ];
        }, Yb(f, d), e);
    }
    function J(a) {
        a = a || {};
        this.a = a.font;
        this.i = a.rotation;
        this.l = a.rotateWithView;
        this.b = a.scale;
        this.ta = a.text;
        this.f = a.textAlign;
        this.j = a.textBaseline;
        this.Xa = void 0 !== a.fill ? a.fill : new zk({ color: '#333' });
        this.s = void 0 !== a.maxAngle ? a.maxAngle : Math.PI / 4;
        this.o = void 0 !== a.placement ? a.placement : 'point';
        var b = void 0 === a.overflow ? a.exceedLength : a.overflow;
        this.v = void 0 !== b ? b : !1;
        this.Ya = void 0 !== a.stroke ? a.stroke : null;
        this.g = void 0 !== a.offsetX ? a.offsetX : 0;
        this.c = void 0 !== a.offsetY ? a.offsetY : 0;
        this.N = a.backgroundFill ? a.backgroundFill : null;
        this.D = a.backgroundStroke ? a.backgroundStroke : null;
        this.C = void 0 === a.padding ? null : a.padding;
    }
    k = J.prototype;
    k.clone = function () {
        return new J({
            font: this.a,
            placement: this.o,
            maxAngle: this.s,
            overflow: this.v,
            rotation: this.i,
            rotateWithView: this.l,
            scale: this.b,
            text: this.Ka(),
            textAlign: this.f,
            textBaseline: this.j,
            fill: this.Fa() ? this.Fa().clone() : void 0,
            stroke: this.Ga() ? this.Ga().clone() : void 0,
            offsetX: this.g,
            offsetY: this.c
        });
    };
    k.Gl = function () {
        return this.v;
    };
    k.pl = function () {
        return this.a;
    };
    k.Bl = function () {
        return this.s;
    };
    k.Kl = function () {
        return this.o;
    };
    k.El = function () {
        return this.g;
    };
    k.Fl = function () {
        return this.c;
    };
    k.Fa = function () {
        return this.Xa;
    };
    k.tp = function () {
        return this.l;
    };
    k.up = function () {
        return this.i;
    };
    k.vp = function () {
        return this.b;
    };
    k.Ga = function () {
        return this.Ya;
    };
    k.Ka = function () {
        return this.ta;
    };
    k.Ql = function () {
        return this.f;
    };
    k.Rl = function () {
        return this.j;
    };
    k.jl = function () {
        return this.N;
    };
    k.kl = function () {
        return this.D;
    };
    k.Il = function () {
        return this.C;
    };
    k.Fq = function (a) {
        this.v = a;
    };
    k.Jj = function (a) {
        this.a = a;
    };
    k.Bq = function (a) {
        this.s = a;
    };
    k.Nj = function (a) {
        this.g = a;
    };
    k.Oj = function (a) {
        this.c = a;
    };
    k.Hq = function (a) {
        this.o = a;
    };
    k.yf = function (a) {
        this.Xa = a;
    };
    k.wp = function (a) {
        this.i = a;
    };
    k.lj = function (a) {
        this.b = a;
    };
    k.Af = function (a) {
        this.Ya = a;
    };
    k.Hd = function (a) {
        this.ta = a;
    };
    k.Qj = function (a) {
        this.f = a;
    };
    k.Jq = function (a) {
        this.j = a;
    };
    k.sq = function (a) {
        this.N = a;
    };
    k.tq = function (a) {
        this.D = a;
    };
    k.Gq = function (a) {
        this.C = a;
    };
    function Xk(a) {
        a = a || {};
        this.i = this.v = null;
        this.j = this.f = Infinity;
        this.s = this.l = -Infinity;
        this.qa = this.oa = Infinity;
        this.O = this.T = -Infinity;
        this.ua = void 0 !== a.targetSize ? a.targetSize : 100;
        this.ab = void 0 !== a.maxLines ? a.maxLines : 100;
        this.g = [];
        this.c = [];
        this.ra = void 0 !== a.strokeStyle ? a.strokeStyle : Yk;
        this.D = this.o = void 0;
        this.a = this.b = this.N = null;
        1 == a.showLabels && (this.$ = void 0 == a.lonLabelFormatter ? Ce.bind(this, 'EW') : a.lonLabelFormatter, this.Wa = void 0 == a.latLabelFormatter ? Ce.bind(this, 'NS') : a.latLabelFormatter, this.ca = void 0 == a.lonLabelPosition ? 0 : a.lonLabelPosition, this.V = void 0 == a.latLabelPosition ? 1 : a.latLabelPosition, this.B = void 0 !== a.lonLabelStyle ? a.lonLabelStyle : new J({
            font: '12px Calibri,sans-serif',
            textBaseline: 'bottom',
            fill: new zk({ color: 'rgba(0,0,0,1)' }),
            stroke: new Ak({
                color: 'rgba(255,255,255,1)',
                width: 3
            })
        }), this.C = void 0 !== a.latLabelStyle ? a.latLabelStyle : new J({
            font: '12px Calibri,sans-serif',
            textAlign: 'end',
            fill: new zk({ color: 'rgba(0,0,0,1)' }),
            stroke: new Ak({
                color: 'rgba(255,255,255,1)',
                width: 3
            })
        }), this.b = [], this.a = []);
        this.setMap(void 0 !== a.map ? a.map : null);
    }
    var Yk = new Ak({ color: 'rgba(0,0,0,0.2)' }), Zk = [
            90,
            45,
            30,
            20,
            10,
            5,
            2,
            1,
            0.5,
            0.2,
            0.1,
            0.05,
            0.01,
            0.005,
            0.002,
            0.001
        ];
    function $k(a, b, c, d, e, f, g) {
        var h = g;
        c = Vk(b, c, d, a.i, e);
        h = void 0 !== a.g[h] ? a.g[h] : new I(null);
        h.ba('XY', c);
        hb(h.G(), f) && (a.b && (c = g, d = h.da(), f = [
            d[0],
            pa(f[1] + Math.abs(f[1] - f[3]) * a.ca, Math.max(f[1], d[1]), Math.min(f[3], d[d.length - 1]))
        ], c = void 0 !== a.b[c] ? a.b[c].Qd : new C(null), c.na(f), a.b[g] = {
            Qd: c,
            text: a.$(b)
        }), a.g[g++] = h);
        return g;
    }
    function al(a, b, c, d, e, f, g) {
        var h = g;
        c = Wk(b, c, d, a.i, e);
        h = void 0 !== a.c[h] ? a.c[h] : new I(null);
        h.ba('XY', c);
        hb(h.G(), f) && (a.a && (c = g, d = h.da(), f = [
            pa(f[0] + Math.abs(f[0] - f[2]) * a.V, Math.max(f[0], d[0]), Math.min(f[2], d[d.length - 2])),
            d[1]
        ], c = void 0 !== a.a[c] ? a.a[c].Qd : new C(null), c.na(f), a.a[g] = {
            Qd: c,
            text: a.Wa(b)
        }), a.c[g++] = h);
        return g;
    }
    k = Xk.prototype;
    k.gn = function () {
        return this.v;
    };
    k.Cl = function () {
        return this.g;
    };
    k.Jl = function () {
        return this.c;
    };
    k.di = function (a) {
        var b = a.vectorContext, c = a.frameState;
        a = c.extent;
        var d = c.viewState, e = d.center, f = d.projection;
        d = d.resolution;
        c = c.pixelRatio;
        c = d * d / (4 * c * c);
        if (!this.i || !Xb(this.i, f)) {
            var g = Ob('EPSG:4326'), h = f.G(), l = f.oe, m = bc(l, g, f), n = l[2], p = l[1], q = l[0], r = m[3], u = m[2], v = m[1];
            m = m[0];
            this.f = l[3];
            this.j = n;
            this.l = p;
            this.s = q;
            this.oa = r;
            this.qa = u;
            this.T = v;
            this.O = m;
            this.o = Yb(g, f);
            this.D = Yb(f, g);
            this.N = this.D(eb(h));
            this.i = f;
        }
        f = this.N[0];
        g = this.N[1];
        h = -1;
        n = Math.pow(this.ua * d, 2);
        p = [];
        q = [];
        d = 0;
        for (l = Zk.length; d < l; ++d) {
            r = Zk[d] / 2;
            p[0] = f - r;
            p[1] = g - r;
            q[0] = f + r;
            q[1] = g + r;
            this.o(p, p);
            this.o(q, q);
            r = Math.pow(q[0] - p[0], 2) + Math.pow(q[1] - p[1], 2);
            if (r <= n)
                break;
            h = Zk[d];
        }
        d = h;
        if (-1 == d)
            this.g.length = this.c.length = 0, this.b && (this.b.length = 0), this.a && (this.a.length = 0);
        else {
            f = this.D(e);
            e = f[0];
            f = f[1];
            g = this.ab;
            l = [
                Math.max(a[0], this.O),
                Math.max(a[1], this.T),
                Math.min(a[2], this.qa),
                Math.min(a[3], this.oa)
            ];
            l = bc(l, this.i, 'EPSG:4326');
            p = l[3];
            h = l[2];
            q = l[1];
            r = l[0];
            e = Math.floor(e / d) * d;
            u = pa(e, this.s, this.j);
            n = $k(this, u, q, p, c, a, 0);
            for (l = 0; u != this.s && l++ < g;)
                u = Math.max(u - d, this.s), n = $k(this, u, q, p, c, a, n);
            u = pa(e, this.s, this.j);
            for (l = 0; u != this.j && l++ < g;)
                u = Math.min(u + d, this.j), n = $k(this, u, q, p, c, a, n);
            this.g.length = n;
            this.b && (this.b.length = n);
            f = Math.floor(f / d) * d;
            e = pa(f, this.l, this.f);
            n = al(this, e, r, h, c, a, 0);
            for (l = 0; e != this.l && l++ < g;)
                e = Math.max(e - d, this.l), n = al(this, e, r, h, c, a, n);
            e = pa(f, this.l, this.f);
            for (l = 0; e != this.f && l++ < g;)
                e = Math.min(e + d, this.f), n = al(this, e, r, h, c, a, n);
            this.c.length = n;
            this.a && (this.a.length = n);
        }
        b.Oa(null, this.ra);
        a = 0;
        for (c = this.g.length; a < c; ++a)
            e = this.g[a], b.Hb(e);
        a = 0;
        for (c = this.c.length; a < c; ++a)
            e = this.c[a], b.Hb(e);
        if (this.b)
            for (a = 0, c = this.b.length; a < c; ++a)
                e = this.b[a], this.B.Hd(e.text), b.nb(this.B), b.Hb(e.Qd);
        if (this.a)
            for (a = 0, c = this.a.length; a < c; ++a)
                e = this.a[a], this.C.Hd(e.text), b.nb(this.C), b.Hb(e.Qd);
    };
    k.setMap = function (a) {
        this.v && (this.v.J('postcompose', this.di, this), this.v.render());
        a && (a.I('postcompose', this.di, this), a.render());
        this.v = a;
    };
    function bl(a, b, c, d, e, f) {
        $h.call(this, a, b, c, 0);
        this.i = d;
        this.M = new Image();
        null !== e && (this.M.crossOrigin = e);
        this.g = null;
        this.state = 0;
        this.c = f;
    }
    w(bl, $h);
    k = bl.prototype;
    k.Y = function () {
        return this.M;
    };
    k.kn = function () {
        this.state = 3;
        this.g.forEach(Gc);
        this.g = null;
        this.u();
    };
    k.ln = function () {
        void 0 === this.resolution && (this.resolution = db(this.extent) / this.M.height);
        this.state = 2;
        this.g.forEach(Gc);
        this.g = null;
        this.u();
    };
    k.load = function () {
        if (0 == this.state || 3 == this.state)
            this.state = 1, this.u(), this.g = [
                Lc(this.M, 'error', this.kn, this),
                Lc(this.M, 'load', this.ln, this)
            ], this.c(this, this.i);
    };
    k.ih = function (a) {
        this.M = a;
    };
    function cl(a, b, c) {
        Sc.call(this);
        c = c ? c : {};
        this.ya = a;
        this.state = b;
        this.g = null;
        this.key = '';
        this.j = void 0 === c.transition ? 250 : c.transition;
        this.s = {};
    }
    w(cl, Sc);
    cl.prototype.u = function () {
        this.b('change');
    };
    cl.prototype.lb = function () {
        return this.key + '/' + this.ya;
    };
    function pj(a) {
        if (!a.g)
            return a;
        var b = a.g;
        do {
            if (2 == b.getState())
                return b;
            b = b.g;
        } while (b);
        return a;
    }
    function dl(a) {
        if (a.g) {
            var b = a.g;
            do {
                if (2 == b.getState()) {
                    b.g = null;
                    break;
                } else
                    1 == b.getState() ? a = b : 0 == b.getState() ? a.g = b.g : a = b;
                b = a.g;
            } while (b);
        }
    }
    cl.prototype.i = function () {
        return this.ya;
    };
    cl.prototype.getState = function () {
        return this.state;
    };
    function oj(a, b) {
        a.state = b;
        a.u();
    }
    function qj(a, b, c) {
        if (!a.j)
            return 1;
        var d = a.s[b];
        if (!d)
            d = c, a.s[b] = d;
        else if (-1 === d)
            return 1;
        b = c - d + 1000 / 60;
        return b >= a.j ? 1 : Me(b / a.j);
    }
    function el(a, b, c, d, e, f) {
        cl.call(this, a, b, f);
        this.f = d;
        this.l = c;
        this.M = new Image();
        null !== d && (this.M.crossOrigin = d);
        this.c = null;
        this.v = e;
    }
    w(el, cl);
    k = el.prototype;
    k.ia = function () {
        1 == this.state && (fl(this), this.M = gl());
        this.g && Pc(this.g);
        this.state = 5;
        this.u();
        cl.prototype.ia.call(this);
    };
    k.Y = function () {
        return this.M;
    };
    k.lb = function () {
        return this.l;
    };
    k.hn = function () {
        this.state = 3;
        fl(this);
        this.M = gl();
        this.u();
    };
    k.jn = function () {
        this.state = this.M.naturalWidth && this.M.naturalHeight ? 2 : 4;
        fl(this);
        this.u();
    };
    k.load = function () {
        3 == this.state && (this.state = 0, this.M = new Image(), null !== this.f && (this.M.crossOrigin = this.f));
        0 == this.state && (this.state = 1, this.u(), this.c = [
            Lc(this.M, 'error', this.hn, this),
            Lc(this.M, 'load', this.jn, this)
        ], this.v(this, this.l));
    };
    function fl(a) {
        a.c.forEach(Gc);
        a.c = null;
    }
    function gl() {
        var a = hg(1, 1);
        a.fillStyle = 'rgba(0,0,0,0)';
        a.fillRect(0, 0, 1, 1);
        return a.canvas;
    }
    function hl(a) {
        this.b = a;
    }
    function il(a) {
        this.b = a;
    }
    w(il, hl);
    il.prototype.S = function () {
        return 35632;
    };
    function jl(a) {
        this.b = a;
    }
    w(jl, hl);
    jl.prototype.S = function () {
        return 35633;
    };
    var kl = new il('precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}'), ll = new jl('varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;//Until we get gl_VertexID in WebGL,we store an instruction.if(f==0.0){//Offsetting the edges of the triangle by lineWidth/2 is necessary,however//we should also leave some space for the antialiasing,thus we offset by lineWidth.offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}');
    function ml(a, b) {
        this.g = a.getUniformLocation(b, 'h');
        this.i = a.getUniformLocation(b, 'i');
        this.c = a.getUniformLocation(b, 'j');
        this.oa = a.getUniformLocation(b, 'k');
        this.qa = a.getUniformLocation(b, 'l');
        this.a = a.getUniformLocation(b, 'm');
        this.C = a.getUniformLocation(b, 'n');
        this.O = a.getUniformLocation(b, 'o');
        this.T = a.getUniformLocation(b, 'p');
        this.b = a.getAttribLocation(b, 'e');
        this.j = a.getAttribLocation(b, 'f');
        this.N = a.getAttribLocation(b, 'g');
    }
    function nl() {
        return [
            1,
            0,
            0,
            0,
            0,
            1,
            0,
            0,
            0,
            0,
            1,
            0,
            0,
            0,
            0,
            1
        ];
    }
    function pl(a, b) {
        a[0] = b[0];
        a[1] = b[1];
        a[4] = b[2];
        a[5] = b[3];
        a[12] = b[4];
        a[13] = b[5];
        return a;
    }
    function ql(a, b) {
        this.origin = eb(b);
        this.bb = We();
        this.Ea = We();
        this.La = We();
        this.V = nl();
        this.b = [];
        this.j = null;
        this.g = [];
        this.i = [];
        this.a = [];
        this.s = null;
        this.f = void 0;
    }
    w(ql, Ai);
    ql.prototype.Na = function (a, b, c, d, e, f, g, h, l, m, n) {
        var p = a.b;
        if (this.f) {
            var q = p.isEnabled(p.STENCIL_TEST);
            var r = p.getParameter(p.STENCIL_FUNC);
            var u = p.getParameter(p.STENCIL_VALUE_MASK);
            var v = p.getParameter(p.STENCIL_REF);
            var z = p.getParameter(p.STENCIL_WRITEMASK);
            var A = p.getParameter(p.STENCIL_FAIL);
            var E = p.getParameter(p.STENCIL_PASS_DEPTH_PASS);
            var S = p.getParameter(p.STENCIL_PASS_DEPTH_FAIL);
            p.enable(p.STENCIL_TEST);
            p.clear(p.STENCIL_BUFFER_BIT);
            p.stencilMask(255);
            p.stencilFunc(p.ALWAYS, 1, 255);
            p.stencilOp(p.KEEP, p.KEEP, p.REPLACE);
            this.f.Na(a, b, c, d, e, f, g, h, l, m, n);
            p.stencilMask(0);
            p.stencilFunc(p.NOTEQUAL, 1, 255);
        }
        rl(a, 34962, this.s);
        rl(a, 34963, this.j);
        f = this.Bf(p, a, e, f);
        var Ia = Xe(this.bb);
        cf(Ia, 2 / (c * e[0]), 2 / (c * e[1]));
        bf(Ia, -d);
        df(Ia, -(b[0] - this.origin[0]), -(b[1] - this.origin[1]));
        b = Xe(this.La);
        cf(b, 2 / e[0], 2 / e[1]);
        e = Xe(this.Ea);
        0 !== d && bf(e, -d);
        p.uniformMatrix4fv(f.g, !1, pl(this.V, Ia));
        p.uniformMatrix4fv(f.i, !1, pl(this.V, b));
        p.uniformMatrix4fv(f.c, !1, pl(this.V, e));
        p.uniform1f(f.a, g);
        if (void 0 === l)
            this.Od(p, a, h, !1);
        else {
            m ? a = this.Ee(p, a, h, l, n) : (p.clear(p.COLOR_BUFFER_BIT | p.DEPTH_BUFFER_BIT), this.Od(p, a, h, !0), a = (a = l(null)) ? a : void 0);
            var ta = a;
        }
        this.Cf(p, f);
        this.f && (q || p.disable(p.STENCIL_TEST), p.clear(p.STENCIL_BUFFER_BIT), p.stencilFunc(r, v, u), p.stencilMask(z), p.stencilOp(A, S, E));
        return ta;
    };
    function sl(a, b, c, d) {
        a.drawElements(4, d - c, b.f ? 5125 : 5123, c * (b.f ? 4 : 2));
    }
    var tl = [
            0,
            0,
            0,
            1
        ], ul = [], vl = [
            0,
            0,
            0,
            1
        ];
    function wl(a, b, c, d, e, f) {
        a = (c - a) * (f - b) - (e - a) * (d - b);
        return a <= xl && a >= -xl ? void 0 : 0 < a;
    }
    var xl = Number.EPSILON || 2.220446049250313e-16;
    function yl(a) {
        this.b = void 0 !== a ? a : [];
        this.a = zl;
    }
    var zl = 35044;
    function Al(a, b) {
        ql.call(this, a, b);
        this.v = null;
        this.l = [];
        this.o = [];
        this.N = 0;
        this.c = {
            fillColor: null,
            strokeColor: null,
            lineDash: null,
            lineDashOffset: void 0,
            lineWidth: void 0,
            u: !1
        };
    }
    w(Al, ql);
    k = Al.prototype;
    k.cc = function (a, b) {
        var c = a.Bd(), d = a.pa();
        if (c) {
            this.g.push(this.b.length);
            this.i.push(b);
            this.c.u && (this.o.push(this.b.length), this.c.u = !1);
            this.N = c;
            a = a.da();
            a = Ue(a, 0, 2, d, -this.origin[0], -this.origin[1]);
            b = this.a.length;
            c = this.b.length;
            var e = b / 4, f;
            for (f = 0; 2 > f; f += d)
                this.a[b++] = a[f], this.a[b++] = a[f + 1], this.a[b++] = 0, this.a[b++] = this.N, this.a[b++] = a[f], this.a[b++] = a[f + 1], this.a[b++] = 1, this.a[b++] = this.N, this.a[b++] = a[f], this.a[b++] = a[f + 1], this.a[b++] = 2, this.a[b++] = this.N, this.a[b++] = a[f], this.a[b++] = a[f + 1], this.a[b++] = 3, this.a[b++] = this.N, this.b[c++] = e, this.b[c++] = e + 1, this.b[c++] = e + 2, this.b[c++] = e + 2, this.b[c++] = e + 3, this.b[c++] = e, e += 4;
        } else
            this.c.u && (this.l.pop(), this.l.length && (d = this.l[this.l.length - 1], this.c.fillColor = d[0], this.c.strokeColor = d[1], this.c.lineWidth = d[2], this.c.u = !1));
    };
    k.gb = function () {
        this.s = new yl(this.a);
        this.j = new yl(this.b);
        this.g.push(this.b.length);
        0 === this.o.length && 0 < this.l.length && (this.l = []);
        this.b = this.a = null;
    };
    k.Db = function (a) {
        var b = this.s, c = this.j;
        return function () {
            Bl(a, b);
            Bl(a, c);
        };
    };
    k.Bf = function (a, b, c, d) {
        var e = Cl(b, kl, ll);
        if (this.v)
            var f = this.v;
        else
            this.v = f = new ml(a, e);
        b.cd(e);
        a.enableVertexAttribArray(f.b);
        a.vertexAttribPointer(f.b, 2, 5126, !1, 16, 0);
        a.enableVertexAttribArray(f.j);
        a.vertexAttribPointer(f.j, 1, 5126, !1, 16, 8);
        a.enableVertexAttribArray(f.N);
        a.vertexAttribPointer(f.N, 1, 5126, !1, 16, 12);
        a.uniform2fv(f.T, c);
        a.uniform1f(f.qa, d);
        return f;
    };
    k.Cf = function (a, b) {
        a.disableVertexAttribArray(b.b);
        a.disableVertexAttribArray(b.j);
        a.disableVertexAttribArray(b.N);
    };
    k.Od = function (a, b, c) {
        if (nb(c)) {
            var d = this.g[this.g.length - 1];
            for (c = this.o.length - 1; 0 <= c; --c) {
                var e = this.o[c];
                var f = this.l[c];
                a.uniform4fv(this.v.C, f[0]);
                Dl(this, a, f[1], f[2]);
                sl(a, b, e, d);
                d = e;
            }
        } else {
            var g = this.g.length - 2;
            f = d = this.g[g + 1];
            for (e = this.o.length - 1; 0 <= e; --e) {
                var h = this.l[e];
                a.uniform4fv(this.v.C, h[0]);
                Dl(this, a, h[1], h[2]);
                for (h = this.o[e]; 0 <= g && this.g[g] >= h;) {
                    var l = this.g[g];
                    var m = this.i[g];
                    m = x(m).toString();
                    c[m] && (d !== f && sl(a, b, d, f), f = l);
                    g--;
                    d = l;
                }
                d !== f && sl(a, b, d, f);
                d = f = h;
            }
        }
    };
    k.Ee = function (a, b, c, d, e) {
        var f, g;
        var h = this.g.length - 2;
        var l = this.g[h + 1];
        for (f = this.o.length - 1; 0 <= f; --f) {
            var m = this.l[f];
            a.uniform4fv(this.v.C, m[0]);
            Dl(this, a, m[1], m[2]);
            for (g = this.o[f]; 0 <= h && this.g[h] >= g;) {
                m = this.g[h];
                var n = this.i[h];
                var p = x(n).toString();
                if (void 0 === c[p] && n.U() && (void 0 === e || hb(e, n.U().G())) && (a.clear(a.COLOR_BUFFER_BIT | a.DEPTH_BUFFER_BIT), sl(a, b, m, l), l = d(n)))
                    return l;
                h--;
                l = m;
            }
        }
    };
    function Dl(a, b, c, d) {
        b.uniform4fv(a.v.O, c);
        b.uniform1f(a.v.oa, d);
    }
    k.Oa = function (a, b) {
        if (b) {
            var c = b.g;
            this.c.lineDash = c ? c : ul;
            c = b.i;
            this.c.lineDashOffset = c ? c : 0;
            c = b.a;
            c instanceof CanvasGradient || c instanceof CanvasPattern ? c = vl : c = vi(c).map(function (a, b) {
                return 3 != b ? a / 255 : a;
            }) || vl;
            b = b.c;
            b = void 0 !== b ? b : 1;
        } else
            c = [
                0,
                0,
                0,
                0
            ], b = 0;
        a = a ? a.b : [
            0,
            0,
            0,
            0
        ];
        a instanceof CanvasGradient || a instanceof CanvasPattern ? a = tl : a = vi(a).map(function (a, b) {
            return 3 != b ? a / 255 : a;
        }) || tl;
        this.c.strokeColor && jc(this.c.strokeColor, c) && this.c.fillColor && jc(this.c.fillColor, a) && this.c.lineWidth === b || (this.c.u = !0, this.c.fillColor = a, this.c.strokeColor = c, this.c.lineWidth = b, this.l.push([
            a,
            c,
            b
        ]));
    };
    var El = new il('precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}'), Fl = new jl('varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}');
    function Gl(a, b) {
        this.g = a.getUniformLocation(b, 'h');
        this.i = a.getUniformLocation(b, 'i');
        this.c = a.getUniformLocation(b, 'j');
        this.a = a.getUniformLocation(b, 'k');
        this.b = a.getAttribLocation(b, 'c');
        this.B = a.getAttribLocation(b, 'd');
        this.v = a.getAttribLocation(b, 'e');
        this.o = a.getAttribLocation(b, 'f');
        this.D = a.getAttribLocation(b, 'g');
    }
    function Hl(a, b) {
        this.j = a;
        this.b = b;
        this.a = {};
        this.c = {};
        this.g = {};
        this.s = this.v = this.i = this.l = null;
        (this.f = ec(da, 'OES_element_index_uint')) && b.getExtension('OES_element_index_uint');
        y(this.j, 'webglcontextlost', this.zp, this);
        y(this.j, 'webglcontextrestored', this.Ap, this);
    }
    w(Hl, Oc);
    function rl(a, b, c) {
        var d = a.b, e = c.b, f = String(x(c));
        if (f in a.a)
            d.bindBuffer(b, a.a[f].buffer);
        else {
            var g = d.createBuffer();
            d.bindBuffer(b, g);
            var h;
            34962 == b ? h = new Float32Array(e) : 34963 == b && (h = a.f ? new Uint32Array(e) : new Uint16Array(e));
            d.bufferData(b, h, c.a);
            a.a[f] = {
                tc: c,
                buffer: g
            };
        }
    }
    function Bl(a, b) {
        var c = a.b;
        b = String(x(b));
        var d = a.a[b];
        c.isContextLost() || c.deleteBuffer(d.buffer);
        delete a.a[b];
    }
    k = Hl.prototype;
    k.ia = function () {
        Nc(this.j);
        var a = this.b;
        if (!a.isContextLost()) {
            for (var b in this.a)
                a.deleteBuffer(this.a[b].buffer);
            for (b in this.g)
                a.deleteProgram(this.g[b]);
            for (b in this.c)
                a.deleteShader(this.c[b]);
            a.deleteFramebuffer(this.i);
            a.deleteRenderbuffer(this.s);
            a.deleteTexture(this.v);
        }
    };
    k.yp = function () {
        return this.b;
    };
    function Il(a) {
        if (!a.i) {
            var b = a.b, c = b.createFramebuffer();
            b.bindFramebuffer(b.FRAMEBUFFER, c);
            var d = Jl(b, 1, 1), e = b.createRenderbuffer();
            b.bindRenderbuffer(b.RENDERBUFFER, e);
            b.renderbufferStorage(b.RENDERBUFFER, b.DEPTH_COMPONENT16, 1, 1);
            b.framebufferTexture2D(b.FRAMEBUFFER, b.COLOR_ATTACHMENT0, b.TEXTURE_2D, d, 0);
            b.framebufferRenderbuffer(b.FRAMEBUFFER, b.DEPTH_ATTACHMENT, b.RENDERBUFFER, e);
            b.bindTexture(b.TEXTURE_2D, null);
            b.bindRenderbuffer(b.RENDERBUFFER, null);
            b.bindFramebuffer(b.FRAMEBUFFER, null);
            a.i = c;
            a.v = d;
            a.s = e;
        }
        return a.i;
    }
    function Kl(a, b) {
        var c = String(x(b));
        if (c in a.c)
            return a.c[c];
        var d = a.b, e = d.createShader(b.S());
        d.shaderSource(e, b.b);
        d.compileShader(e);
        return a.c[c] = e;
    }
    function Cl(a, b, c) {
        var d = x(b) + '/' + x(c);
        if (d in a.g)
            return a.g[d];
        var e = a.b, f = e.createProgram();
        e.attachShader(f, Kl(a, b));
        e.attachShader(f, Kl(a, c));
        e.linkProgram(f);
        return a.g[d] = f;
    }
    k.zp = function () {
        lb(this.a);
        lb(this.c);
        lb(this.g);
        this.s = this.v = this.i = this.l = null;
    };
    k.Ap = function () {
    };
    k.cd = function (a) {
        if (a == this.l)
            return !1;
        this.b.useProgram(a);
        this.l = a;
        return !0;
    };
    function Ll(a, b, c) {
        var d = a.createTexture();
        a.bindTexture(a.TEXTURE_2D, d);
        a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MAG_FILTER, a.LINEAR);
        a.texParameteri(a.TEXTURE_2D, a.TEXTURE_MIN_FILTER, a.LINEAR);
        void 0 !== b && a.texParameteri(3553, 10242, b);
        void 0 !== c && a.texParameteri(3553, 10243, c);
        return d;
    }
    function Jl(a, b, c) {
        var d = Ll(a, void 0, void 0);
        a.texImage2D(a.TEXTURE_2D, 0, a.RGBA, b, c, 0, a.RGBA, a.UNSIGNED_BYTE, null);
        return d;
    }
    function Ml(a, b) {
        var c = Ll(a, 33071, 33071);
        a.texImage2D(a.TEXTURE_2D, 0, a.RGBA, a.RGBA, a.UNSIGNED_BYTE, b);
        return c;
    }
    function Nl(a, b) {
        ql.call(this, a, b);
        this.C = this.D = void 0;
        this.v = [];
        this.o = [];
        this.qa = this.oa = this.height = void 0;
        this.Wa = null;
        this.width = this.scale = this.rotation = this.rotateWithView = this.O = this.T = this.opacity = void 0;
    }
    w(Nl, ql);
    k = Nl.prototype;
    k.Db = function (a) {
        var b = this.s, c = this.j, d = this.ig(!0), e = a.b;
        return function () {
            if (!e.isContextLost()) {
                var f;
                var g = 0;
                for (f = d.length; g < f; ++g)
                    e.deleteTexture(d[g]);
            }
            Bl(a, b);
            Bl(a, c);
        };
    };
    function Ol(a, b, c, d) {
        var e = a.D, f = a.C, g = a.height, h = a.oa, l = a.qa, m = a.opacity, n = a.T, p = a.O, q = a.rotateWithView ? 1 : 0, r = -a.rotation, u = a.scale, v = a.width, z = Math.cos(r);
        r = Math.sin(r);
        var A = a.b.length, E = a.a.length, S;
        for (S = 0; S < c; S += d) {
            var Ia = b[S] - a.origin[0];
            var ta = b[S + 1] - a.origin[1];
            var la = E / 8;
            var ca = -u * e;
            var ia = -u * (g - f);
            a.a[E++] = Ia;
            a.a[E++] = ta;
            a.a[E++] = ca * z - ia * r;
            a.a[E++] = ca * r + ia * z;
            a.a[E++] = n / l;
            a.a[E++] = (p + g) / h;
            a.a[E++] = m;
            a.a[E++] = q;
            ca = u * (v - e);
            ia = -u * (g - f);
            a.a[E++] = Ia;
            a.a[E++] = ta;
            a.a[E++] = ca * z - ia * r;
            a.a[E++] = ca * r + ia * z;
            a.a[E++] = (n + v) / l;
            a.a[E++] = (p + g) / h;
            a.a[E++] = m;
            a.a[E++] = q;
            ca = u * (v - e);
            ia = u * f;
            a.a[E++] = Ia;
            a.a[E++] = ta;
            a.a[E++] = ca * z - ia * r;
            a.a[E++] = ca * r + ia * z;
            a.a[E++] = (n + v) / l;
            a.a[E++] = p / h;
            a.a[E++] = m;
            a.a[E++] = q;
            ca = -u * e;
            ia = u * f;
            a.a[E++] = Ia;
            a.a[E++] = ta;
            a.a[E++] = ca * z - ia * r;
            a.a[E++] = ca * r + ia * z;
            a.a[E++] = n / l;
            a.a[E++] = p / h;
            a.a[E++] = m;
            a.a[E++] = q;
            a.b[A++] = la;
            a.b[A++] = la + 1;
            a.b[A++] = la + 2;
            a.b[A++] = la;
            a.b[A++] = la + 2;
            a.b[A++] = la + 3;
        }
    }
    function Pl(a, b, c, d) {
        var e, f = b.length;
        for (e = 0; e < f; ++e) {
            var g = b[e];
            var h = x(g).toString();
            h in c ? g = c[h] : (g = Ml(d, g), c[h] = g);
            a[e] = g;
        }
    }
    k.Bf = function (a, b) {
        var c = Cl(b, El, Fl);
        if (this.Wa)
            var d = this.Wa;
        else
            this.Wa = d = new Gl(a, c);
        b.cd(c);
        a.enableVertexAttribArray(d.b);
        a.vertexAttribPointer(d.b, 2, 5126, !1, 32, 0);
        a.enableVertexAttribArray(d.v);
        a.vertexAttribPointer(d.v, 2, 5126, !1, 32, 8);
        a.enableVertexAttribArray(d.B);
        a.vertexAttribPointer(d.B, 2, 5126, !1, 32, 16);
        a.enableVertexAttribArray(d.o);
        a.vertexAttribPointer(d.o, 1, 5126, !1, 32, 24);
        a.enableVertexAttribArray(d.D);
        a.vertexAttribPointer(d.D, 1, 5126, !1, 32, 28);
        return d;
    };
    k.Cf = function (a, b) {
        a.disableVertexAttribArray(b.b);
        a.disableVertexAttribArray(b.v);
        a.disableVertexAttribArray(b.B);
        a.disableVertexAttribArray(b.o);
        a.disableVertexAttribArray(b.D);
    };
    k.Od = function (a, b, c, d) {
        var e = d ? this.ag() : this.ig();
        d = d ? this.o : this.v;
        if (nb(c)) {
            var f;
            c = 0;
            var g = e.length;
            for (f = 0; c < g; ++c) {
                a.bindTexture(3553, e[c]);
                var h = d[c];
                sl(a, b, f, h);
                f = h;
            }
        } else
            for (f = g = 0, h = e.length; f < h; ++f) {
                a.bindTexture(3553, e[f]);
                for (var l = 0 < f ? d[f - 1] : 0, m = d[f], n = l; g < this.g.length && this.g[g] <= m;) {
                    var p = x(this.i[g]).toString();
                    void 0 !== c[p] ? (n !== l && sl(a, b, n, l), l = n = g === this.g.length - 1 ? m : this.g[g + 1]) : l = g === this.g.length - 1 ? m : this.g[g + 1];
                    g++;
                }
                n !== l && sl(a, b, n, l);
            }
    };
    k.Ee = function (a, b, c, d, e) {
        var f, g, h = this.g.length - 1, l = this.ag();
        for (f = l.length - 1; 0 <= f; --f) {
            a.bindTexture(3553, l[f]);
            var m = 0 < f ? this.o[f - 1] : 0;
            for (g = this.o[f]; 0 <= h && this.g[h] >= m;) {
                var n = this.g[h];
                var p = this.i[h];
                var q = x(p).toString();
                if (void 0 === c[q] && p.U() && (void 0 === e || hb(e, p.U().G())) && (a.clear(a.COLOR_BUFFER_BIT | a.DEPTH_BUFFER_BIT), sl(a, b, n, g), g = d(p)))
                    return g;
                g = n;
                h--;
            }
        }
    };
    k.gb = function () {
        this.qa = this.oa = this.height = this.C = this.D = void 0;
        this.b = null;
        this.scale = this.rotation = this.rotateWithView = this.O = this.T = this.opacity = void 0;
        this.a = null;
        this.width = void 0;
    };
    function Ql(a, b) {
        Nl.call(this, a, b);
        this.l = [];
        this.c = [];
        this.B = [];
        this.N = [];
    }
    w(Ql, Nl);
    k = Ql.prototype;
    k.wc = function (a, b) {
        this.g.push(this.b.length);
        this.i.push(b);
        b = a.da();
        Ol(this, b, b.length, a.pa());
    };
    k.yc = function (a, b) {
        this.g.push(this.b.length);
        this.i.push(b);
        b = a.da();
        Ol(this, b, b.length, a.pa());
    };
    k.gb = function (a) {
        var b = a.b;
        this.v.push(this.b.length);
        this.o.push(this.b.length);
        this.s = new yl(this.a);
        this.j = new yl(this.b);
        var c = {};
        Pl(this.B, this.l, c, b);
        Pl(this.N, this.c, c, b);
        this.c = this.l = null;
        Nl.prototype.gb.call(this, a);
    };
    k.Zb = function (a) {
        var b = a.Vc(), c = a.Y(1), d = a.He(), e = a.Eg(), f = a.i, g = a.bd(), h = a.s, l = a.f, m = a.oc();
        a = a.a;
        if (0 === this.l.length)
            this.l.push(c);
        else {
            var n = this.l[this.l.length - 1];
            x(n) != x(c) && (this.v.push(this.b.length), this.l.push(c));
        }
        0 === this.c.length ? this.c.push(e) : (n = this.c[this.c.length - 1], x(n) != x(e) && (this.o.push(this.b.length), this.c.push(e)));
        this.D = b[0];
        this.C = b[1];
        this.height = m[1];
        this.oa = d[1];
        this.qa = d[0];
        this.opacity = f;
        this.T = g[0];
        this.O = g[1];
        this.rotation = l;
        this.rotateWithView = h;
        this.scale = a;
        this.width = m[0];
    };
    k.ig = function (a) {
        return a ? this.B.concat(this.N) : this.B;
    };
    k.ag = function () {
        return this.N;
    };
    function Rl(a, b, c) {
        var d = b - c;
        return a[0] === a[d] && a[1] === a[d + 1] && 3 < (b - 0) / c ? !!mf(a, 0, b, c) : !1;
    }
    var Sl = new il('precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}'), Tl = new jl('varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}');
    function Ul(a, b) {
        this.g = a.getUniformLocation(b, 'h');
        this.i = a.getUniformLocation(b, 'i');
        this.c = a.getUniformLocation(b, 'j');
        this.oa = a.getUniformLocation(b, 'k');
        this.O = a.getUniformLocation(b, 'l');
        this.a = a.getUniformLocation(b, 'm');
        this.C = a.getUniformLocation(b, 'n');
        this.T = a.getUniformLocation(b, 'o');
        this.qa = a.getUniformLocation(b, 'p');
        this.l = a.getAttribLocation(b, 'd');
        this.b = a.getAttribLocation(b, 'e');
        this.s = a.getAttribLocation(b, 'f');
        this.f = a.getAttribLocation(b, 'g');
    }
    function Vl(a, b) {
        ql.call(this, a, b);
        this.v = null;
        this.o = [];
        this.l = [];
        this.c = {
            strokeColor: null,
            lineCap: void 0,
            lineDash: null,
            lineDashOffset: void 0,
            lineJoin: void 0,
            lineWidth: void 0,
            miterLimit: void 0,
            u: !1
        };
    }
    w(Vl, ql);
    function Wl(a, b, c, d) {
        var e, f = a.a.length, g = a.b.length, h = 'bevel' === a.c.lineJoin ? 0 : 'miter' === a.c.lineJoin ? 1 : 2, l = 'butt' === a.c.lineCap ? 0 : 'square' === a.c.lineCap ? 1 : 2, m = Rl(b, c, d), n = g, p = 1;
        for (e = 0; e < c; e += d) {
            var q = f / 7;
            var r = u;
            var u = v || [
                b[e],
                b[e + 1]
            ];
            if (0 === e) {
                var v = [
                    b[e + d],
                    b[e + d + 1]
                ];
                if (c - 0 === 2 * d && jc(u, v))
                    break;
                if (m) {
                    r = [
                        b[c - 2 * d],
                        b[c - 2 * d + 1]
                    ];
                    var z = v;
                } else {
                    l && (f = Xl(a, [
                        0,
                        0
                    ], u, v, p * Yl * l, f), f = Xl(a, [
                        0,
                        0
                    ], u, v, -p * Yl * l, f), a.b[g++] = q + 2, a.b[g++] = q, a.b[g++] = q + 1, a.b[g++] = q + 1, a.b[g++] = q + 3, a.b[g++] = q + 2);
                    f = Xl(a, [
                        0,
                        0
                    ], u, v, p * Zl * (l || 1), f);
                    f = Xl(a, [
                        0,
                        0
                    ], u, v, -p * Zl * (l || 1), f);
                    n = f / 7 - 1;
                    continue;
                }
            } else if (e === c - d) {
                m ? v = z : (r = r || [
                    0,
                    0
                ], f = Xl(a, r, u, [
                    0,
                    0
                ], p * $l * (l || 1), f), f = Xl(a, r, u, [
                    0,
                    0
                ], -p * $l * (l || 1), f), a.b[g++] = q, a.b[g++] = n - 1, a.b[g++] = n, a.b[g++] = n, a.b[g++] = q + 1, a.b[g++] = q, l && (f = Xl(a, r, u, [
                    0,
                    0
                ], p * am * l, f), f = Xl(a, r, u, [
                    0,
                    0
                ], -p * am * l, f), a.b[g++] = q + 2, a.b[g++] = q, a.b[g++] = q + 1, a.b[g++] = q + 1, a.b[g++] = q + 3, a.b[g++] = q + 2));
                break;
            } else
                v = [
                    b[e + d],
                    b[e + d + 1]
                ];
            var A = wl(r[0], r[1], u[0], u[1], v[0], v[1]) ? -1 : 1;
            f = Xl(a, r, u, v, A * bm * (h || 1), f);
            f = Xl(a, r, u, v, A * cm * (h || 1), f);
            f = Xl(a, r, u, v, -A * dm * (h || 1), f);
            0 < e && (a.b[g++] = q, a.b[g++] = n - 1, a.b[g++] = n, a.b[g++] = q + 2, a.b[g++] = q, a.b[g++] = 0 < p * A ? n : n - 1);
            a.b[g++] = q;
            a.b[g++] = q + 2;
            a.b[g++] = q + 1;
            n = q + 2;
            p = A;
            h && (f = Xl(a, r, u, v, A * em * h, f), a.b[g++] = q + 1, a.b[g++] = q + 3, a.b[g++] = q);
        }
        m && (q = q || f / 7, A = Mf([
            r[0],
            r[1],
            u[0],
            u[1],
            v[0],
            v[1]
        ], 0, 6, 2) ? 1 : -1, f = Xl(a, r, u, v, A * bm * (h || 1), f), Xl(a, r, u, v, -A * dm * (h || 1), f), a.b[g++] = q, a.b[g++] = n - 1, a.b[g++] = n, a.b[g++] = q + 1, a.b[g++] = q, a.b[g++] = 0 < p * A ? n : n - 1);
    }
    function Xl(a, b, c, d, e, f) {
        a.a[f++] = b[0];
        a.a[f++] = b[1];
        a.a[f++] = c[0];
        a.a[f++] = c[1];
        a.a[f++] = d[0];
        a.a[f++] = d[1];
        a.a[f++] = e;
        return f;
    }
    function fm(a, b, c, d) {
        c -= b;
        return c < 2 * d ? !1 : c === 2 * d ? !jc([
            a[b],
            a[b + 1]
        ], [
            a[b + d],
            a[b + d + 1]
        ]) : !0;
    }
    k = Vl.prototype;
    k.uc = function (a, b) {
        var c = a.da();
        a = a.pa();
        fm(c, 0, c.length, a) && (c = Ue(c, 0, c.length, a, -this.origin[0], -this.origin[1]), this.c.u && (this.l.push(this.b.length), this.c.u = !1), this.g.push(this.b.length), this.i.push(b), Wl(this, c, c.length, a));
    };
    k.vc = function (a, b) {
        var c = this.b.length, d = a.pb();
        d.unshift(0);
        var e = a.da();
        a = a.pa();
        var f;
        if (1 < d.length) {
            var g = 1;
            for (f = d.length; g < f; ++g)
                if (fm(e, d[g - 1], d[g], a)) {
                    var h = Ue(e, d[g - 1], d[g], a, -this.origin[0], -this.origin[1]);
                    Wl(this, h, h.length, a);
                }
        }
        this.b.length > c && (this.g.push(c), this.i.push(b), this.c.u && (this.l.push(c), this.c.u = !1));
    };
    function gm(a, b, c, d) {
        Rl(b, b.length, d) || (b.push(b[0]), b.push(b[1]));
        Wl(a, b, b.length, d);
        if (c.length) {
            var e;
            b = 0;
            for (e = c.length; b < e; ++b)
                Rl(c[b], c[b].length, d) || (c[b].push(c[b][0]), c[b].push(c[b][1])), Wl(a, c[b], c[b].length, d);
        }
    }
    function hm(a, b, c) {
        c = void 0 === c ? a.b.length : c;
        a.g.push(c);
        a.i.push(b);
        a.c.u && (a.l.push(c), a.c.u = !1);
    }
    k.gb = function () {
        this.s = new yl(this.a);
        this.j = new yl(this.b);
        this.g.push(this.b.length);
        0 === this.l.length && 0 < this.o.length && (this.o = []);
        this.b = this.a = null;
    };
    k.Db = function (a) {
        var b = this.s, c = this.j;
        return function () {
            Bl(a, b);
            Bl(a, c);
        };
    };
    k.Bf = function (a, b, c, d) {
        var e = Cl(b, Sl, Tl);
        if (this.v)
            var f = this.v;
        else
            this.v = f = new Ul(a, e);
        b.cd(e);
        a.enableVertexAttribArray(f.l);
        a.vertexAttribPointer(f.l, 2, 5126, !1, 28, 0);
        a.enableVertexAttribArray(f.b);
        a.vertexAttribPointer(f.b, 2, 5126, !1, 28, 8);
        a.enableVertexAttribArray(f.s);
        a.vertexAttribPointer(f.s, 2, 5126, !1, 28, 16);
        a.enableVertexAttribArray(f.f);
        a.vertexAttribPointer(f.f, 1, 5126, !1, 28, 24);
        a.uniform2fv(f.T, c);
        a.uniform1f(f.qa, d);
        return f;
    };
    k.Cf = function (a, b) {
        a.disableVertexAttribArray(b.l);
        a.disableVertexAttribArray(b.b);
        a.disableVertexAttribArray(b.s);
        a.disableVertexAttribArray(b.f);
    };
    k.Od = function (a, b, c, d) {
        var e = a.getParameter(a.DEPTH_FUNC), f = a.getParameter(a.DEPTH_WRITEMASK);
        d || (a.enable(a.DEPTH_TEST), a.depthMask(!0), a.depthFunc(a.NOTEQUAL));
        if (nb(c)) {
            var g = this.g[this.g.length - 1];
            for (c = this.l.length - 1; 0 <= c; --c) {
                var h = this.l[c];
                var l = this.o[c];
                im(this, a, l[0], l[1], l[2]);
                sl(a, b, h, g);
                a.clear(a.DEPTH_BUFFER_BIT);
                g = h;
            }
        } else {
            var m = this.g.length - 2;
            l = g = this.g[m + 1];
            for (h = this.l.length - 1; 0 <= h; --h) {
                var n = this.o[h];
                im(this, a, n[0], n[1], n[2]);
                for (n = this.l[h]; 0 <= m && this.g[m] >= n;) {
                    var p = this.g[m];
                    var q = this.i[m];
                    q = x(q).toString();
                    c[q] && (g !== l && (sl(a, b, g, l), a.clear(a.DEPTH_BUFFER_BIT)), l = p);
                    m--;
                    g = p;
                }
                g !== l && (sl(a, b, g, l), a.clear(a.DEPTH_BUFFER_BIT));
                g = l = n;
            }
        }
        d || (a.disable(a.DEPTH_TEST), a.clear(a.DEPTH_BUFFER_BIT), a.depthMask(f), a.depthFunc(e));
    };
    k.Ee = function (a, b, c, d, e) {
        var f, g;
        var h = this.g.length - 2;
        var l = this.g[h + 1];
        for (f = this.l.length - 1; 0 <= f; --f) {
            var m = this.o[f];
            im(this, a, m[0], m[1], m[2]);
            for (g = this.l[f]; 0 <= h && this.g[h] >= g;) {
                m = this.g[h];
                var n = this.i[h];
                var p = x(n).toString();
                if (void 0 === c[p] && n.U() && (void 0 === e || hb(e, n.U().G())) && (a.clear(a.COLOR_BUFFER_BIT | a.DEPTH_BUFFER_BIT), sl(a, b, m, l), l = d(n)))
                    return l;
                h--;
                l = m;
            }
        }
    };
    function im(a, b, c, d, e) {
        b.uniform4fv(a.v.C, c);
        b.uniform1f(a.v.oa, d);
        b.uniform1f(a.v.O, e);
    }
    k.Oa = function (a, b) {
        a = b.f;
        this.c.lineCap = void 0 !== a ? a : 'round';
        a = b.g;
        this.c.lineDash = a ? a : ul;
        a = b.i;
        this.c.lineDashOffset = a ? a : 0;
        a = b.j;
        this.c.lineJoin = void 0 !== a ? a : 'round';
        a = b.a;
        a instanceof CanvasGradient || a instanceof CanvasPattern ? a = vl : a = vi(a).map(function (a, b) {
            return 3 != b ? a / 255 : a;
        }) || vl;
        var c = b.c;
        c = void 0 !== c ? c : 1;
        b = b.l;
        b = void 0 !== b ? b : 10;
        this.c.strokeColor && jc(this.c.strokeColor, a) && this.c.lineWidth === c && this.c.miterLimit === b || (this.c.u = !0, this.c.strokeColor = a, this.c.lineWidth = c, this.c.miterLimit = b, this.o.push([
            a,
            c,
            b
        ]));
    };
    var Zl = 3, $l = 5, Yl = 7, am = 11, bm = 13, cm = 17, dm = 19, em = 23;
    var jm = new il('precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}'), km = new jl('attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}');
    function lm(a, b) {
        this.g = a.getUniformLocation(b, 'b');
        this.i = a.getUniformLocation(b, 'c');
        this.c = a.getUniformLocation(b, 'd');
        this.C = a.getUniformLocation(b, 'e');
        this.a = a.getUniformLocation(b, 'f');
        this.b = a.getAttribLocation(b, 'a');
    }
    function mm() {
        this.b = this.a = this.g = void 0;
        this.c = 0;
    }
    function nm(a) {
        var b = a.b;
        if (b) {
            var c = b.next, d = b.Eb;
            c && (c.Eb = d);
            d && (d.next = c);
            a.b = c || d;
            a.g === a.a ? (a.b = void 0, a.g = void 0, a.a = void 0) : a.g === b ? a.g = a.b : a.a === b && (a.a = d ? a.b.Eb : a.b);
            a.c--;
        }
    }
    function om(a) {
        a.b = a.g;
        if (a.b)
            return a.b.data;
    }
    function pm(a) {
        if (a.b && a.b.next)
            return a.b = a.b.next, a.b.data;
    }
    function qm(a) {
        if (a.b && a.b.next)
            return a.b.next.data;
    }
    function rm(a) {
        if (a.b && a.b.Eb)
            return a.b = a.b.Eb, a.b.data;
    }
    function sm(a) {
        if (a.b && a.b.Eb)
            return a.b.Eb.data;
    }
    function tm(a) {
        if (a.b)
            return a.b.data;
    }
    mm.prototype.concat = function (a) {
        if (a.b) {
            if (this.b) {
                var b = this.b.next;
                this.b.next = a.g;
                a.g.Eb = this.b;
                b.Eb = a.a;
                a.a.next = b;
                this.c += a.c;
            } else
                this.b = a.b, this.g = a.g, this.a = a.a, this.c = a.c;
            a.b = void 0;
            a.g = void 0;
            a.a = void 0;
            a.c = 0;
        }
    };
    function um() {
        this.a = rj.Jc(void 0);
        this.b = {};
    }
    k = um.prototype;
    k.Ca = function (a, b) {
        a = {
            fa: a[0],
            ea: a[1],
            la: a[2],
            ka: a[3],
            value: b
        };
        this.a.Ca(a);
        this.b[x(b)] = a;
    };
    k.load = function (a, b) {
        for (var c = Array(b.length), d = 0, e = b.length; d < e; d++) {
            var f = a[d], g = b[d];
            f = {
                fa: f[0],
                ea: f[1],
                la: f[2],
                ka: f[3],
                value: g
            };
            c[d] = f;
            this.b[x(g)] = f;
        }
        this.a.load(c);
    };
    k.remove = function (a) {
        a = x(a);
        var b = this.b[a];
        delete this.b[a];
        return null !== this.a.remove(b);
    };
    function vm(a, b, c) {
        var d = a.b[x(c)];
        Sa([
            d.fa,
            d.ea,
            d.la,
            d.ka
        ], b) || (a.remove(c), a.Ca(b, c));
    }
    function wm(a) {
        return a.a.all().map(function (a) {
            return a.value;
        });
    }
    function xm(a, b) {
        return a.a.search({
            fa: b[0],
            ea: b[1],
            la: b[2],
            ka: b[3]
        }).map(function (a) {
            return a.value;
        });
    }
    k.forEach = function (a, b) {
        return ym(wm(this), a, b);
    };
    function zm(a, b, c, d) {
        return ym(xm(a, b), c, d);
    }
    function ym(a, b, c) {
        for (var d, e = 0, f = a.length; e < f && !(d = b.call(c, a[e])); e++);
        return d;
    }
    k.clear = function () {
        this.a.clear();
        this.b = {};
    };
    k.G = function (a) {
        var b = this.a.data;
        return Na(b.fa, b.ea, b.la, b.ka, a);
    };
    k.concat = function (a) {
        this.a.load(a.a.all());
        for (var b in a.b)
            this.b[b | 0] = a.b[b | 0];
    };
    function Am(a, b) {
        ql.call(this, a, b);
        this.f = new Vl(a, b);
        this.v = null;
        this.o = [];
        this.c = [];
        this.l = {
            fillColor: null,
            u: !1
        };
    }
    w(Am, ql);
    function Bm(a, b, c, d) {
        var e = new mm(), f = new um();
        Cm(a, b, d, e, f, !0);
        b = Dm(e);
        if (c.length) {
            var g, h = [];
            var l = 0;
            for (g = c.length; l < g; ++l) {
                var m = {
                    list: new mm(),
                    Ec: void 0,
                    gh: new um()
                };
                h.push(m);
                Cm(a, c[l], d, m.list, m.gh, !1);
                Em(m.list, m.gh, !0);
                m.Ec = Dm(m.list);
            }
            h.sort(function (a, b) {
                return b.Ec[0] === a.Ec[0] ? a.Ec[1] - b.Ec[1] : b.Ec[0] - a.Ec[0];
            });
            for (l = 0; l < h.length; ++l) {
                c = h[l].list;
                g = d = om(c);
                do {
                    if (Fm(g, f).length) {
                        var n = !0;
                        break;
                    }
                    g = pm(c);
                } while (d !== g);
                !n && Gm(c, h[l].Ec[0], e, b[0], f) && (f.concat(h[l].gh), Em(e, f, !1));
            }
        } else
            Em(e, f, !1);
        Hm(a, e, f);
    }
    function Cm(a, b, c, d, e, f) {
        var g, h = a.a.length / 2, l = [], m = [];
        if (f === Mf(b, 0, b.length, c)) {
            var n = f = Im(a, b[0], b[1], h++);
            var p = c;
            for (g = b.length; p < g; p += c) {
                var q = Im(a, b[p], b[p + 1], h++);
                m.push(Jm(n, q, d));
                l.push([
                    Math.min(n.x, q.x),
                    Math.min(n.y, q.y),
                    Math.max(n.x, q.x),
                    Math.max(n.y, q.y)
                ]);
                n = q;
            }
        } else
            for (p = b.length - c, n = f = Im(a, b[p], b[p + 1], h++), p -= c, g = 0; p >= g; p -= c)
                q = Im(a, b[p], b[p + 1], h++), m.push(Jm(n, q, d)), l.push([
                    Math.min(n.x, q.x),
                    Math.min(n.y, q.y),
                    Math.max(n.x, q.x),
                    Math.max(n.y, q.y)
                ]), n = q;
        m.push(Jm(q, f, d));
        l.push([
            Math.min(n.x, q.x),
            Math.min(n.y, q.y),
            Math.max(n.x, q.x),
            Math.max(n.y, q.y)
        ]);
        e.load(l, m);
    }
    function Dm(a) {
        var b = om(a), c = b, d = [
                c.Z.x,
                c.Z.y
            ];
        do
            c = pm(a), c.Z.x > d[0] && (d = [
                c.Z.x,
                c.Z.y
            ]);
        while (c !== b);
        return d;
    }
    function Em(a, b, c) {
        var d = om(a), e = d, f = pm(a), g = !1;
        do {
            var h = c ? wl(f.X.x, f.X.y, e.X.x, e.X.y, e.Z.x, e.Z.y) : wl(e.Z.x, e.Z.y, e.X.x, e.X.y, f.X.x, f.X.y);
            void 0 === h ? (Km(e, f, a, b), g = !0, f === d && (d = qm(a)), f = e, rm(a)) : e.X.Kb !== h && (e.X.Kb = h, g = !0);
            e = f;
            f = pm(a);
        } while (e !== d);
        return g;
    }
    function Gm(a, b, c, d, e) {
        for (var f = om(a); f.X.x !== b;)
            f = pm(a);
        b = f.X;
        d = {
            x: d,
            y: b.y,
            qb: -1
        };
        var g = Infinity, h;
        var l = Fm({
            Z: b,
            X: d
        }, e, !0);
        var m = 0;
        for (h = l.length; m < h; ++m) {
            var n = l[m], p = Lm(b, d, n.Z, n.X, !0), q = Math.abs(b.x - p[0]);
            if (q < g && void 0 !== wl(b.x, b.y, n.Z.x, n.Z.y, n.X.x, n.X.y)) {
                g = q;
                var r = {
                    x: p[0],
                    y: p[1],
                    qb: -1
                };
                f = n;
            }
        }
        if (Infinity === g)
            return !1;
        l = f.X;
        if (0 < g && (f = Mm(b, r, f.X, e), f.length))
            for (r = Infinity, m = 0, h = f.length; m < h; ++m)
                if (g = f[m], n = Math.atan2(b.y - g.y, d.x - g.x), n < r || n === r && g.x < l.x)
                    r = n, l = g;
        for (f = om(c); f.X.x !== l.x || f.X.y !== l.y;)
            f = pm(c);
        d = {
            x: b.x,
            y: b.y,
            qb: b.qb,
            Kb: void 0
        };
        m = {
            x: f.X.x,
            y: f.X.y,
            qb: f.X.qb,
            Kb: void 0
        };
        qm(a).Z = d;
        Jm(b, f.X, a, e);
        Jm(m, d, a, e);
        f.X = m;
        a.b && (a.g = a.b, a.a = a.b.Eb);
        c.concat(a);
        return !0;
    }
    function Hm(a, b, c) {
        for (var d = !1, e = Nm(b, c); 3 < b.c;)
            if (e) {
                if (!Om(a, b, c, e, d) && !Em(b, c, d) && !Pm(a, b, c, !0))
                    break;
            } else if (!Om(a, b, c, e, d) && !Em(b, c, d) && !Pm(a, b, c))
                if (e = Nm(b, c)) {
                    d = b;
                    var f = 2 * d.c, g = Array(f), h = om(d), l = h, m = 0;
                    do
                        g[m++] = l.Z.x, g[m++] = l.Z.y, l = pm(d);
                    while (l !== h);
                    d = !Mf(g, 0, f, 2);
                    Em(b, c, d);
                } else {
                    e = a;
                    d = b;
                    f = g = om(d);
                    do {
                        h = Fm(f, c);
                        if (h.length) {
                            g = h[0];
                            h = Lm(f.Z, f.X, g.Z, g.X);
                            h = Im(e, h[0], h[1], e.a.length / 2);
                            l = new mm();
                            m = new um();
                            Jm(h, f.X, l, m);
                            f.X = h;
                            vm(c, [
                                Math.min(f.Z.x, h.x),
                                Math.min(f.Z.y, h.y),
                                Math.max(f.Z.x, h.x),
                                Math.max(f.Z.y, h.y)
                            ], f);
                            for (f = pm(d); f !== g;)
                                Jm(f.Z, f.X, l, m), c.remove(f), nm(d), f = tm(d);
                            Jm(g.Z, h, l, m);
                            g.Z = h;
                            vm(c, [
                                Math.min(g.X.x, h.x),
                                Math.min(g.X.y, h.y),
                                Math.max(g.X.x, h.x),
                                Math.max(g.X.y, h.y)
                            ], g);
                            Em(d, c, !1);
                            Hm(e, d, c);
                            Em(l, m, !1);
                            Hm(e, l, m);
                            break;
                        }
                        f = pm(d);
                    } while (f !== g);
                    break;
                }
        3 === b.c && (e = a.b.length, a.b[e++] = sm(b).Z.qb, a.b[e++] = tm(b).Z.qb, a.b[e++] = qm(b).Z.qb);
    }
    function Om(a, b, c, d, e) {
        var f = a.b.length, g = om(b), h = sm(b), l = g, m = pm(b), n = qm(b), p = !1;
        do {
            var q = l.Z;
            var r = l.X;
            var u = m.X;
            if (!1 === r.Kb) {
                var v = d ? 0 === Mm(q, r, u, c, !0).length : e ? Qm(n.X, u, r, q, h.Z) : Qm(h.Z, q, r, u, n.X);
                !d && 0 !== Fm({
                    Z: q,
                    X: u
                }, c).length || !v || !d && !1 !== q.Kb && !1 !== u.Kb && Mf([
                    h.Z.x,
                    h.Z.y,
                    q.x,
                    q.y,
                    r.x,
                    r.y,
                    u.x,
                    u.y,
                    n.X.x,
                    n.X.y
                ], 0, 10, 2) !== !e || (a.b[f++] = q.qb, a.b[f++] = r.qb, a.b[f++] = u.qb, Km(l, m, b, c), m === g && (g = n), p = !0);
            }
            h = sm(b);
            l = tm(b);
            m = pm(b);
            n = qm(b);
        } while (l !== g && 3 < b.c);
        return p;
    }
    function Pm(a, b, c, d) {
        var e = om(b);
        pm(b);
        var f = e, g = pm(b), h = !1;
        do {
            var l = Lm(f.Z, f.X, g.Z, g.X, d);
            if (l) {
                h = a.b.length;
                var m = a.a.length / 2, n = rm(b);
                nm(b);
                c.remove(n);
                var p = n === e;
                d ? (l[0] === f.Z.x && l[1] === f.Z.y ? (rm(b), l = f.Z, g.Z = l, c.remove(f), p = p || f === e) : (l = g.X, f.X = l, c.remove(g), p = p || g === e), nm(b)) : (l = Im(a, l[0], l[1], m), f.X = l, g.Z = l, vm(c, [
                    Math.min(f.Z.x, f.X.x),
                    Math.min(f.Z.y, f.X.y),
                    Math.max(f.Z.x, f.X.x),
                    Math.max(f.Z.y, f.X.y)
                ], f), vm(c, [
                    Math.min(g.Z.x, g.X.x),
                    Math.min(g.Z.y, g.X.y),
                    Math.max(g.Z.x, g.X.x),
                    Math.max(g.Z.y, g.X.y)
                ], g));
                a.b[h++] = n.Z.qb;
                a.b[h++] = n.X.qb;
                a.b[h++] = l.qb;
                h = !0;
                if (p)
                    break;
            }
            f = sm(b);
            g = pm(b);
        } while (f !== e);
        return h;
    }
    function Nm(a, b) {
        var c = om(a), d = c;
        do {
            if (Fm(d, b).length)
                return !1;
            d = pm(a);
        } while (d !== c);
        return !0;
    }
    function Im(a, b, c, d) {
        var e = a.a.length;
        a.a[e++] = b;
        a.a[e++] = c;
        return {
            x: b,
            y: c,
            qb: d,
            Kb: void 0
        };
    }
    function Jm(a, b, c, d) {
        var e = {
                Z: a,
                X: b
            }, f = {
                Eb: void 0,
                next: void 0,
                data: e
            }, g = c.b;
        if (g) {
            var h = g.next;
            f.Eb = g;
            f.next = h;
            g.next = f;
            h && (h.Eb = f);
            g === c.a && (c.a = f);
        } else
            c.g = f, c.a = f, f.next = f, f.Eb = f;
        c.b = f;
        c.c++;
        d && d.Ca([
            Math.min(a.x, b.x),
            Math.min(a.y, b.y),
            Math.max(a.x, b.x),
            Math.max(a.y, b.y)
        ], e);
        return e;
    }
    function Km(a, b, c, d) {
        tm(c) === b && (nm(c), a.X = b.X, d.remove(b), vm(d, [
            Math.min(a.Z.x, a.X.x),
            Math.min(a.Z.y, a.X.y),
            Math.max(a.Z.x, a.X.x),
            Math.max(a.Z.y, a.X.y)
        ], a));
    }
    function Mm(a, b, c, d, e) {
        var f, g, h = [], l = xm(d, [
                Math.min(a.x, b.x, c.x),
                Math.min(a.y, b.y, c.y),
                Math.max(a.x, b.x, c.x),
                Math.max(a.y, b.y, c.y)
            ]);
        d = 0;
        for (f = l.length; d < f; ++d)
            for (g in l[d]) {
                var m = l[d][g];
                'object' !== typeof m || e && !m.Kb || m.x === a.x && m.y === a.y || m.x === b.x && m.y === b.y || m.x === c.x && m.y === c.y || -1 !== h.indexOf(m) || !Gf([
                    a.x,
                    a.y,
                    b.x,
                    b.y,
                    c.x,
                    c.y
                ], 0, 6, 2, m.x, m.y) || h.push(m);
            }
        return h;
    }
    function Fm(a, b, c) {
        var d = a.Z, e = a.X;
        b = xm(b, [
            Math.min(d.x, e.x),
            Math.min(d.y, e.y),
            Math.max(d.x, e.x),
            Math.max(d.y, e.y)
        ]);
        var f = [], g;
        var h = 0;
        for (g = b.length; h < g; ++h) {
            var l = b[h];
            a !== l && (c || l.Z !== e || l.X !== d) && Lm(d, e, l.Z, l.X, c) && f.push(l);
        }
        return f;
    }
    function Lm(a, b, c, d, e) {
        var f = (d.y - c.y) * (b.x - a.x) - (d.x - c.x) * (b.y - a.y);
        if (0 !== f && (d = ((d.x - c.x) * (a.y - c.y) - (d.y - c.y) * (a.x - c.x)) / f, c = ((b.x - a.x) * (a.y - c.y) - (b.y - a.y) * (a.x - c.x)) / f, !e && d > xl && d < 1 - xl && c > xl && c < 1 - xl || e && 0 <= d && 1 >= d && 0 <= c && 1 >= c))
            return [
                a.x + d * (b.x - a.x),
                a.y + d * (b.y - a.y)
            ];
    }
    function Qm(a, b, c, d, e) {
        if (void 0 === b.Kb || void 0 === d.Kb)
            return !1;
        var f = (c.x - d.x) * (b.y - d.y) > (c.y - d.y) * (b.x - d.x);
        e = (e.x - d.x) * (b.y - d.y) < (e.y - d.y) * (b.x - d.x);
        a = (a.x - b.x) * (d.y - b.y) > (a.y - b.y) * (d.x - b.x);
        c = (c.x - b.x) * (d.y - b.y) < (c.y - b.y) * (d.x - b.x);
        b = b.Kb ? c || a : c && a;
        return (d.Kb ? e || f : e && f) && b;
    }
    k = Am.prototype;
    k.xc = function (a, b) {
        var c = a.td(), d = a.pa(), e = this.b.length, f = this.f.b.length;
        a = a.da();
        var g, h, l;
        var m = h = 0;
        for (g = c.length; m < g; ++m) {
            var n = c[m];
            if (0 < n.length) {
                var p = Ue(a, h, n[0], d, -this.origin[0], -this.origin[1]);
                if (p.length) {
                    var q = [];
                    h = 1;
                    for (l = n.length; h < l; ++h)
                        if (n[h] !== n[h - 1]) {
                            var r = Ue(a, n[h - 1], n[h], d, -this.origin[0], -this.origin[1]);
                            q.push(r);
                        }
                    gm(this.f, p, q, d);
                    Bm(this, p, q, d);
                }
            }
            h = n[n.length - 1];
        }
        this.b.length > e && (this.g.push(e), this.i.push(b), this.l.u && (this.c.push(e), this.l.u = !1));
        this.f.b.length > f && hm(this.f, b, f);
    };
    k.zc = function (a, b) {
        var c = a.pb(), d = a.pa();
        if (0 < c.length) {
            a = a.da().map(Number);
            var e = Ue(a, 0, c[0], d, -this.origin[0], -this.origin[1]);
            if (e.length) {
                var f = [], g;
                var h = 1;
                for (g = c.length; h < g; ++h)
                    if (c[h] !== c[h - 1]) {
                        var l = Ue(a, c[h - 1], c[h], d, -this.origin[0], -this.origin[1]);
                        f.push(l);
                    }
                this.g.push(this.b.length);
                this.i.push(b);
                this.l.u && (this.c.push(this.b.length), this.l.u = !1);
                hm(this.f, b);
                gm(this.f, e, f, d);
                Bm(this, e, f, d);
            }
        }
    };
    k.gb = function (a) {
        this.s = new yl(this.a);
        this.j = new yl(this.b);
        this.g.push(this.b.length);
        this.f.gb(a);
        0 === this.c.length && 0 < this.o.length && (this.o = []);
        this.b = this.a = null;
    };
    k.Db = function (a) {
        var b = this.s, c = this.j, d = this.f.Db(a);
        return function () {
            Bl(a, b);
            Bl(a, c);
            d();
        };
    };
    k.Bf = function (a, b) {
        var c = Cl(b, jm, km);
        if (this.v)
            var d = this.v;
        else
            this.v = d = new lm(a, c);
        b.cd(c);
        a.enableVertexAttribArray(d.b);
        a.vertexAttribPointer(d.b, 2, 5126, !1, 8, 0);
        return d;
    };
    k.Cf = function (a, b) {
        a.disableVertexAttribArray(b.b);
    };
    k.Od = function (a, b, c, d) {
        var e = a.getParameter(a.DEPTH_FUNC), f = a.getParameter(a.DEPTH_WRITEMASK);
        d || (a.enable(a.DEPTH_TEST), a.depthMask(!0), a.depthFunc(a.NOTEQUAL));
        if (nb(c)) {
            var g = this.g[this.g.length - 1];
            for (c = this.c.length - 1; 0 <= c; --c) {
                var h = this.c[c];
                var l = this.o[c];
                a.uniform4fv(this.v.C, l);
                sl(a, b, h, g);
                g = h;
            }
        } else {
            var m = this.g.length - 2;
            l = g = this.g[m + 1];
            for (h = this.c.length - 1; 0 <= h; --h) {
                var n = this.o[h];
                a.uniform4fv(this.v.C, n);
                for (n = this.c[h]; 0 <= m && this.g[m] >= n;) {
                    var p = this.g[m];
                    var q = this.i[m];
                    q = x(q).toString();
                    c[q] && (g !== l && (sl(a, b, g, l), a.clear(a.DEPTH_BUFFER_BIT)), l = p);
                    m--;
                    g = p;
                }
                g !== l && (sl(a, b, g, l), a.clear(a.DEPTH_BUFFER_BIT));
                g = l = n;
            }
        }
        d || (a.disable(a.DEPTH_TEST), a.clear(a.DEPTH_BUFFER_BIT), a.depthMask(f), a.depthFunc(e));
    };
    k.Ee = function (a, b, c, d, e) {
        var f, g;
        var h = this.g.length - 2;
        var l = this.g[h + 1];
        for (f = this.c.length - 1; 0 <= f; --f) {
            var m = this.o[f];
            a.uniform4fv(this.v.C, m);
            for (g = this.c[f]; 0 <= h && this.g[h] >= g;) {
                m = this.g[h];
                var n = this.i[h];
                var p = x(n).toString();
                if (void 0 === c[p] && n.U() && (void 0 === e || hb(e, n.U().G())) && (a.clear(a.COLOR_BUFFER_BIT | a.DEPTH_BUFFER_BIT), sl(a, b, m, l), l = d(n)))
                    return l;
                h--;
                l = m;
            }
        }
    };
    k.Oa = function (a, b) {
        a = a ? a.b : [
            0,
            0,
            0,
            0
        ];
        a instanceof CanvasGradient || a instanceof CanvasPattern ? a = tl : a = vi(a).map(function (a, b) {
            return 3 != b ? a / 255 : a;
        }) || tl;
        this.l.fillColor && jc(a, this.l.fillColor) || (this.l.fillColor = a, this.l.u = !0, this.o.push(a));
        b ? this.f.Oa(null, b) : this.f.Oa(null, new Ak({
            color: [
                0,
                0,
                0,
                0
            ],
            lineWidth: 0
        }));
    };
    function Rm(a, b) {
        this.b = b;
        this.a = [{
                x: 0,
                y: 0,
                width: a,
                height: a
            }];
        this.c = {};
        this.g = hg(a, a);
        this.i = this.g.canvas;
    }
    Rm.prototype.get = function (a) {
        return this.c[a] || null;
    };
    Rm.prototype.add = function (a, b, c, d, e) {
        var f;
        var g = 0;
        for (f = this.a.length; g < f; ++g) {
            var h = this.a[g];
            if (h.width >= b + this.b && h.height >= c + this.b)
                return f = {
                    offsetX: h.x + this.b,
                    offsetY: h.y + this.b,
                    image: this.i
                }, this.c[a] = f, d.call(e, this.g, h.x + this.b, h.y + this.b), a = g, b += this.b, d = c + this.b, h.width - b > h.height - d ? (c = {
                    x: h.x + b,
                    y: h.y,
                    width: h.width - b,
                    height: h.height
                }, b = {
                    x: h.x,
                    y: h.y + d,
                    width: b,
                    height: h.height - d
                }, Sm(this, a, c, b)) : (c = {
                    x: h.x + b,
                    y: h.y,
                    width: h.width - b,
                    height: d
                }, b = {
                    x: h.x,
                    y: h.y + d,
                    width: h.width,
                    height: h.height - d
                }, Sm(this, a, c, b)), f;
        }
        return null;
    };
    function Sm(a, b, c, d) {
        b = [
            b,
            1
        ];
        0 < c.width && 0 < c.height && b.push(c);
        0 < d.width && 0 < d.height && b.push(d);
        a.a.splice.apply(a.a, b);
    }
    function Tm(a) {
        a = a || {};
        this.a = void 0 !== a.initialSize ? a.initialSize : 256;
        this.g = void 0 !== a.maxSize ? a.maxSize : void 0 !== ba ? ba : 2048;
        this.b = void 0 !== a.space ? a.space : 1;
        this.f = [new Rm(this.a, this.b)];
        this.c = this.a;
        this.i = [new Rm(this.c, this.b)];
    }
    function Um(a, b) {
        var c;
        var d = 0;
        for (c = a.length; d < c; ++d) {
            var e = a[d];
            if (e = e.get(b))
                return e;
        }
        return null;
    }
    function Vm(a, b) {
        return {
            offsetX: a.offsetX,
            offsetY: a.offsetY,
            image: a.image,
            Bm: b.image
        };
    }
    Tm.prototype.add = function (a, b, c, d, e, f) {
        if (b + this.b > this.g || c + this.b > this.g)
            return null;
        d = Wm(this, !1, a, b, c, d, f);
        if (!d)
            return null;
        a = Wm(this, !0, a, b, c, void 0 !== e ? e : ea, f);
        return Vm(d, a);
    };
    function Wm(a, b, c, d, e, f, g) {
        var h = b ? a.i : a.f, l;
        var m = 0;
        for (l = h.length; m < l; ++m) {
            var n = h[m];
            if (n = n.add(c, d, e, f, g))
                return n;
            n || m !== l - 1 || (b ? (n = Math.min(2 * a.c, a.g), a.c = n) : (n = Math.min(2 * a.a, a.g), a.a = n), n = new Rm(n, a.b), h.push(n), ++l);
        }
        return null;
    }
    function Xm(a, b) {
        Nl.call(this, a, b);
        this.c = [];
        this.ua = [];
        this.Ub = hg(0, 0).canvas;
        this.N = {
            strokeColor: null,
            lineCap: void 0,
            lineDash: null,
            lineDashOffset: void 0,
            lineJoin: void 0,
            lineWidth: 0,
            miterLimit: void 0,
            fillColor: null,
            font: void 0,
            scale: void 0
        };
        this.ta = '';
        this.ca = this.$ = this.ra = this.ab = void 0;
        this.B = {};
        this.l = void 0;
        this.opacity = this.scale = 1;
    }
    w(Xm, Nl);
    k = Xm.prototype;
    k.Wb = function (a, b) {
        if (this.ta) {
            var c = null, d = 2, e = 2;
            switch (a.S()) {
            case 'Point':
            case 'MultiPoint':
                c = a.da();
                d = c.length;
                e = a.pa();
                break;
            case 'Circle':
                c = a.xa();
                break;
            case 'LineString':
                c = a.Fe();
                break;
            case 'MultiLineString':
                c = a.Ge();
                d = c.length;
                break;
            case 'Polygon':
                c = a.Td();
                break;
            case 'MultiPolygon':
                c = Ji(a), d = c.length;
            }
            this.g.push(this.b.length);
            this.i.push(b);
            a = this.l;
            b = this.ta.split('\n');
            var f = Ym(this, b), g, h, l = Math.round(f[0] * this.ab - this.$), m = Math.round(f[1] * this.ra - this.ca), n = this.N.lineWidth / 2 * this.N.scale;
            f = 0;
            for (g = b.length; f < g; ++f) {
                var p = 0;
                var q = a.height * f;
                var r = b[f].split('');
                var u = 0;
                for (h = r.length; u < h; ++u) {
                    var v = a.Bh;
                    var z = r[u], A = Um(v.f, z);
                    A ? (v = Um(v.i, z), v = Vm(A, v)) : v = null;
                    if (v) {
                        A = v.image;
                        this.D = l - p;
                        this.C = m - q;
                        this.T = 0 === u ? v.offsetX - n : v.offsetX;
                        this.O = v.offsetY;
                        this.height = a.height;
                        this.width = 0 === u || u === r.length - 1 ? a.width[r[u]] + n : a.width[r[u]];
                        this.oa = A.height;
                        this.qa = A.width;
                        0 === this.c.length ? this.c.push(A) : (v = this.c[this.c.length - 1], x(v) != x(A) && (this.v.push(this.b.length), this.c.push(A)));
                        v = c;
                        z = d;
                        var E = e;
                        for (A = 0; A < z; A += E)
                            Ol(this, v, z, E);
                    }
                    p += this.width;
                }
            }
        }
    };
    function Ym(a, b) {
        var c = a.l, d = b.length * c.height;
        return [
            b.map(function (b) {
                var d = 0, e;
                var h = 0;
                for (e = b.length; h < e; ++h) {
                    var l = b[h];
                    c.width[l] || Zm(a, l);
                    d += c.width[l] ? c.width[l] : 0;
                }
                return d;
            }).reduce(function (a, b) {
                return Math.max(a, b);
            }),
            d
        ];
    }
    function Zm(a, b) {
        if (1 === b.length) {
            var c = a.l, d = a.N;
            a = a.Ub.getContext('2d');
            a.font = d.font;
            a = Math.ceil(a.measureText(b).width * d.scale);
            c.Bh.add(b, a, c.height, function (a, c, g) {
                a.font = d.font;
                a.fillStyle = d.fillColor;
                a.strokeStyle = d.strokeColor;
                a.lineWidth = d.lineWidth;
                a.lineCap = d.lineCap;
                a.lineJoin = d.lineJoin;
                a.miterLimit = d.miterLimit;
                a.textAlign = 'left';
                a.textBaseline = 'top';
                od && d.lineDash && (a.setLineDash(d.lineDash), a.lineDashOffset = d.lineDashOffset);
                1 !== d.scale && a.setTransform(d.scale, 0, 0, d.scale, 0, 0);
                d.strokeColor && a.strokeText(b, c, g);
                d.fillColor && a.fillText(b, c, g);
            }) && (c.width[b] = a);
        }
    }
    k.gb = function (a) {
        var b = a.b;
        this.v.push(this.b.length);
        this.o = this.v;
        this.s = new yl(this.a);
        this.j = new yl(this.b);
        Pl(this.ua, this.c, {}, b);
        this.N = {
            strokeColor: null,
            lineCap: void 0,
            lineDash: null,
            lineDashOffset: void 0,
            lineJoin: void 0,
            lineWidth: 0,
            miterLimit: void 0,
            fillColor: null,
            font: void 0,
            scale: void 0
        };
        this.ta = '';
        this.ca = this.$ = this.ra = this.ab = void 0;
        this.c = null;
        this.B = {};
        this.l = void 0;
        Nl.prototype.gb.call(this, a);
    };
    k.nb = function (a) {
        var b = this.N, c = a.Fa(), d = a.Ga();
        if (a && a.Ka() && (c || d)) {
            c ? (c = c.b, b.fillColor = zi(c ? c : tl)) : b.fillColor = null;
            d ? (c = d.a, b.strokeColor = zi(c ? c : vl), b.lineWidth = d.c || 1, b.lineCap = d.f || 'round', b.lineDashOffset = d.i || 0, b.lineJoin = d.j || 'round', b.miterLimit = d.l || 10, d = d.g, b.lineDash = d ? d.slice() : ul) : (b.strokeColor = null, b.lineWidth = 0);
            b.font = a.a || '10px sans-serif';
            b.scale = a.b || 1;
            this.ta = a.Ka();
            d = vj[a.f];
            c = vj[a.j];
            this.ab = void 0 === d ? 0.5 : d;
            this.ra = void 0 === c ? 0.5 : c;
            this.$ = a.g || 0;
            this.ca = a.c || 0;
            this.rotateWithView = !!a.l;
            this.rotation = a.i || 0;
            a = [];
            for (var e in b)
                if (b[e] || 0 === b[e])
                    Array.isArray(b[e]) ? a = a.concat(b[e]) : a.push(b[e]);
            c = '';
            e = 0;
            for (d = a.length; e < d; ++e)
                c += a[e];
            e = c;
            this.B[e] || (a = this.Ub.getContext('2d'), a.font = b.font, a = Math.ceil((1.5 * a.measureText('M').width + b.lineWidth / 2) * b.scale), this.B[e] = {
                Bh: new Tm({ space: b.lineWidth + 1 }),
                width: {},
                height: a
            });
            this.l = this.B[e];
        } else
            this.ta = '';
    };
    k.ig = function () {
        return this.ua;
    };
    k.ag = function () {
        return this.ua;
    };
    function $m(a, b, c) {
        this.c = b;
        this.i = a;
        this.g = c;
        this.a = {};
    }
    w($m, sj);
    k = $m.prototype;
    k.Vb = function () {
    };
    function an(a, b) {
        var c = [], d;
        for (d in a.a) {
            var e = a.a[d], f;
            for (f in e)
                c.push(e[f].Db(b));
        }
        return function () {
            for (var a = c.length, b, d = 0; d < a; d++)
                b = c[d].apply(this, arguments);
            return b;
        };
    }
    function bn(a, b) {
        for (var c in a.a) {
            var d = a.a[c], e;
            for (e in d)
                d[e].gb(b);
        }
    }
    k.Ja = function (a, b) {
        var c = void 0 !== a ? a.toString() : '0';
        a = this.a[c];
        void 0 === a && (a = {}, this.a[c] = a);
        c = a[b];
        void 0 === c && (c = new cn[b](this.i, this.c), a[b] = c);
        return c;
    };
    k.yg = function () {
        return nb(this.a);
    };
    k.Na = function (a, b, c, d, e, f, g, h) {
        var l = Object.keys(this.a).map(Number);
        l.sort(dc);
        var m, n;
        var p = 0;
        for (m = l.length; p < m; ++p) {
            var q = this.a[l[p].toString()];
            var r = 0;
            for (n = uj.length; r < n; ++r) {
                var u = q[uj[r]];
                void 0 !== u && u.Na(a, b, c, d, e, f, g, h, void 0, !1);
            }
        }
    };
    function dn(a, b, c, d, e, f, g, h, l, m, n) {
        var p = en, q = Object.keys(a.a).map(Number);
        q.sort(function (a, b) {
            return b - a;
        });
        var r, u;
        var v = 0;
        for (r = q.length; v < r; ++v) {
            var z = a.a[q[v].toString()];
            for (u = uj.length - 1; 0 <= u; --u) {
                var A = z[uj[u]];
                if (void 0 !== A && (A = A.Na(b, c, d, e, p, f, g, h, l, m, n)))
                    return A;
            }
        }
    }
    k.wa = function (a, b, c, d, e, f, g, h, l, m) {
        var n = b.b;
        n.bindFramebuffer(n.FRAMEBUFFER, Il(b));
        var p;
        void 0 !== this.g && (p = Fa(Pa(a), d * this.g));
        return dn(this, b, a, d, e, g, h, l, function (a) {
            var b = new Uint8Array(4);
            n.readPixels(0, 0, 1, 1, n.RGBA, n.UNSIGNED_BYTE, b);
            if (0 < b[3] && (a = m(a)))
                return a;
        }, !0, p);
    };
    function fn(a, b, c, d, e, f, g, h) {
        var l = c.b;
        l.bindFramebuffer(l.FRAMEBUFFER, Il(c));
        return void 0 !== dn(a, c, b, d, e, f, g, h, function () {
            var a = new Uint8Array(4);
            l.readPixels(0, 0, 1, 1, l.RGBA, l.UNSIGNED_BYTE, a);
            return 0 < a[3];
        }, !1);
    }
    var en = [
            1,
            1
        ], cn = {
            Circle: Al,
            Image: Ql,
            LineString: Vl,
            Polygon: Am,
            Text: Xm
        };
    function gn(a, b, c, d, e, f, g) {
        this.b = a;
        this.g = b;
        this.c = f;
        this.i = g;
        this.l = e;
        this.j = d;
        this.f = c;
        this.a = this.s = this.v = this.o = null;
    }
    w(gn, Ai);
    function hn(a, b, c) {
        var d = a.b;
        b = b.Ja(0, 'Text');
        b.nb(a.a);
        b.Wb(c, null);
        b.gb(d);
        b.Na(a.b, a.g, a.f, a.j, a.l, a.i, 1, {}, void 0, !1);
        b.Db(d)();
    }
    k = gn.prototype;
    k.Dd = function (a) {
        this.Oa(a.Fa(), a.Ga());
        this.Zb(a.Y());
        this.nb(a.Ka());
    };
    k.Hb = function (a) {
        switch (a.S()) {
        case 'Point':
            this.yc(a, null);
            break;
        case 'LineString':
            this.uc(a, null);
            break;
        case 'Polygon':
            this.zc(a, null);
            break;
        case 'MultiPoint':
            this.wc(a, null);
            break;
        case 'MultiLineString':
            this.vc(a, null);
            break;
        case 'MultiPolygon':
            this.xc(a, null);
            break;
        case 'GeometryCollection':
            this.De(a);
            break;
        case 'Circle':
            this.cc(a, null);
        }
    };
    k.Ce = function (a, b) {
        (a = (0, b.cb)(a)) && hb(this.c, a.G()) && (this.Dd(b), this.Hb(a));
    };
    k.De = function (a) {
        a = a.a;
        var b;
        var c = 0;
        for (b = a.length; c < b; ++c)
            this.Hb(a[c]);
    };
    k.yc = function (a, b) {
        var c = this.b, d = new $m(1, this.c), e = d.Ja(0, 'Image');
        e.Zb(this.o);
        e.yc(a, b);
        e.gb(c);
        e.Na(this.b, this.g, this.f, this.j, this.l, this.i, 1, {}, void 0, !1);
        e.Db(c)();
        this.a && hn(this, d, a);
    };
    k.wc = function (a, b) {
        var c = this.b, d = new $m(1, this.c), e = d.Ja(0, 'Image');
        e.Zb(this.o);
        e.wc(a, b);
        e.gb(c);
        e.Na(this.b, this.g, this.f, this.j, this.l, this.i, 1, {}, void 0, !1);
        e.Db(c)();
        this.a && hn(this, d, a);
    };
    k.uc = function (a, b) {
        var c = this.b, d = new $m(1, this.c), e = d.Ja(0, 'LineString');
        e.Oa(null, this.s);
        e.uc(a, b);
        e.gb(c);
        e.Na(this.b, this.g, this.f, this.j, this.l, this.i, 1, {}, void 0, !1);
        e.Db(c)();
        this.a && hn(this, d, a);
    };
    k.vc = function (a, b) {
        var c = this.b, d = new $m(1, this.c), e = d.Ja(0, 'LineString');
        e.Oa(null, this.s);
        e.vc(a, b);
        e.gb(c);
        e.Na(this.b, this.g, this.f, this.j, this.l, this.i, 1, {}, void 0, !1);
        e.Db(c)();
        this.a && hn(this, d, a);
    };
    k.zc = function (a, b) {
        var c = this.b, d = new $m(1, this.c), e = d.Ja(0, 'Polygon');
        e.Oa(this.v, this.s);
        e.zc(a, b);
        e.gb(c);
        e.Na(this.b, this.g, this.f, this.j, this.l, this.i, 1, {}, void 0, !1);
        e.Db(c)();
        this.a && hn(this, d, a);
    };
    k.xc = function (a, b) {
        var c = this.b, d = new $m(1, this.c), e = d.Ja(0, 'Polygon');
        e.Oa(this.v, this.s);
        e.xc(a, b);
        e.gb(c);
        e.Na(this.b, this.g, this.f, this.j, this.l, this.i, 1, {}, void 0, !1);
        e.Db(c)();
        this.a && hn(this, d, a);
    };
    k.cc = function (a, b) {
        var c = this.b, d = new $m(1, this.c), e = d.Ja(0, 'Circle');
        e.Oa(this.v, this.s);
        e.cc(a, b);
        e.gb(c);
        e.Na(this.b, this.g, this.f, this.j, this.l, this.i, 1, {}, void 0, !1);
        e.Db(c)();
        this.a && hn(this, d, a);
    };
    k.Zb = function (a) {
        this.o = a;
    };
    k.Oa = function (a, b) {
        this.v = a;
        this.s = b;
    };
    k.nb = function (a) {
        this.a = a;
    };
    var jn = new il('precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}'), kn = new jl('varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}');
    function ln(a, b) {
        this.f = a.getUniformLocation(b, 'd');
        this.c = a.getUniformLocation(b, 'e');
        this.g = a.getUniformLocation(b, 'f');
        this.i = a.getUniformLocation(b, 'g');
        this.b = a.getAttribLocation(b, 'b');
        this.a = a.getAttribLocation(b, 'c');
    }
    function mn(a, b) {
        Ki.call(this, b);
        this.c = a;
        this.V = new yl([
            -1,
            -1,
            0,
            0,
            1,
            -1,
            1,
            0,
            -1,
            1,
            0,
            1,
            1,
            1,
            1,
            1
        ]);
        this.f = this.Mb = null;
        this.j = void 0;
        this.v = We();
        this.N = We();
        this.C = nl();
        this.o = null;
    }
    w(mn, Ki);
    function nn(a, b, c) {
        var d = a.c.g;
        if (void 0 === a.j || a.j != c) {
            b.postRenderFunctions.push(function (a, b, c) {
                a.isContextLost() || (a.deleteFramebuffer(b), a.deleteTexture(c));
            }.bind(null, d, a.f, a.Mb));
            b = Jl(d, c, c);
            var e = d.createFramebuffer();
            d.bindFramebuffer(36160, e);
            d.framebufferTexture2D(36160, 36064, 3553, b, 0);
            a.Mb = b;
            a.f = e;
            a.j = c;
        } else
            d.bindFramebuffer(36160, a.f);
    }
    mn.prototype.Zi = function (a, b, c) {
        on(this, 'precompose', c, a);
        rl(c, 34962, this.V);
        var d = c.b, e = Cl(c, jn, kn);
        if (this.o)
            var f = this.o;
        else
            this.o = f = new ln(d, e);
        c.cd(e) && (d.enableVertexAttribArray(f.b), d.vertexAttribPointer(f.b, 2, 5126, !1, 16, 0), d.enableVertexAttribArray(f.a), d.vertexAttribPointer(f.a, 2, 5126, !1, 16, 8), d.uniform1i(f.i, 0));
        d.uniformMatrix4fv(f.f, !1, pl(this.C, this.v));
        d.uniformMatrix4fv(f.c, !1, pl(this.C, this.N));
        d.uniform1f(f.g, b.opacity);
        d.bindTexture(3553, this.Mb);
        d.drawArrays(5, 0, 4);
        on(this, 'postcompose', c, a);
    };
    function on(a, b, c, d) {
        a = a.a;
        if (Tc(a, b)) {
            var e = d.viewState;
            a.b(new bi(b, new gn(c, e.center, e.resolution, e.rotation, d.size, d.extent, d.pixelRatio), d, null, c));
        }
    }
    mn.prototype.Ag = function () {
        this.f = this.Mb = null;
        this.j = void 0;
    };
    function pn(a, b) {
        mn.call(this, a, b);
        this.l = this.i = this.M = null;
    }
    w(pn, mn);
    pn.handles = function (a, b) {
        return 'webgl' === a && 'IMAGE' === b.S();
    };
    pn.create = function (a, b) {
        return new pn(a, b);
    };
    function qn(a, b) {
        b = b.Y();
        return Ml(a.c.g, b);
    }
    pn.prototype.wa = function (a, b, c, d, e) {
        var f = this.a;
        return f.ha().wa(a, b.viewState.resolution, b.viewState.rotation, c, b.skippedFeatureUids, function (a) {
            return d.call(e, a, f);
        });
    };
    pn.prototype.Bg = function (a, b) {
        var c = this.c.g, d = a.pixelRatio, e = a.viewState, f = e.center, g = e.resolution, h = e.rotation, l = this.M, m = this.Mb, n = this.a.ha(), p = a.viewHints, q = a.extent;
        void 0 !== b.extent && (q = gb(q, b.extent));
        p[0] || p[1] || bb(q) || (b = n.Y(q, g, d, e.projection)) && Si(this, b) && (l = b, m = qn(this, b), this.Mb && a.postRenderFunctions.push(function (a, b) {
            a.isContextLost() || a.deleteTexture(b);
        }.bind(null, c, this.Mb)));
        l && (c = this.c.i.j, rn(this, c.width, c.height, d, f, g, h, l.G()), this.l = null, d = this.v, Xe(d), cf(d, 1, -1), df(d, 0, -1), this.M = l, this.Mb = m, Ui(a, n));
        return !!l;
    };
    function rn(a, b, c, d, e, f, g, h) {
        b *= f;
        c *= f;
        a = a.N;
        Xe(a);
        cf(a, 2 * d / b, 2 * d / c);
        bf(a, -g);
        df(a, h[0] - e[0], h[1] - e[1]);
        cf(a, (h[2] - h[0]) / 2, (h[3] - h[1]) / 2);
        df(a, 1, 1);
    }
    pn.prototype.cf = function (a, b) {
        return void 0 !== this.wa(a, b, 0, Re, this);
    };
    pn.prototype.zg = function (a, b, c, d) {
        if (this.M && this.M.Y())
            if (this.a.ha().wa !== ea) {
                var e = af(b.pixelToCoordinateTransform, a.slice());
                if (this.wa(e, b, 0, Re, this))
                    return c.call(d, this.a, null);
            } else {
                e = [
                    this.M.Y().width,
                    this.M.Y().height
                ];
                if (!this.l) {
                    var f = b.size;
                    b = We();
                    df(b, -1, -1);
                    cf(b, 2 / f[0], 2 / f[1]);
                    df(b, 0, f[1]);
                    cf(b, 1, -1);
                    f = ff(this.N.slice());
                    var g = We();
                    df(g, 0, e[1]);
                    cf(g, 1, -1);
                    cf(g, e[0] / 2, e[1] / 2);
                    df(g, 1, 1);
                    Ze(g, f);
                    Ze(g, b);
                    this.l = g;
                }
                a = af(this.l, a.slice());
                if (!(0 > a[0] || a[0] > e[0] || 0 > a[1] || a[1] > e[1]) && (this.i || (this.i = hg(1, 1)), this.i.clearRect(0, 0, 1, 1), this.i.drawImage(this.M.Y(), a[0], a[1], 1, 1, 0, 0, 1, 1), e = this.i.getImageData(0, 0, 1, 1).data, 0 < e[3]))
                    return c.call(d, this.a, e);
            }
    };
    function sn(a, b) {
        fj.call(this, a, b);
        this.b = document.createElement('CANVAS');
        this.b.style.width = '100%';
        this.b.style.height = '100%';
        this.b.style.display = 'block';
        this.b.className = 'ol-unselectable';
        a.insertBefore(this.b, a.childNodes[0] || null);
        this.N = this.D = 0;
        this.C = hg();
        this.s = !0;
        this.g = gd(this.b, {
            antialias: !0,
            depth: !0,
            failIfMajorPerformanceCaveat: !0,
            preserveDrawingBuffer: !1,
            stencil: !0
        });
        this.i = new Hl(this.b, this.g);
        y(this.b, 'webglcontextlost', this.Co, this);
        y(this.b, 'webglcontextrestored', this.Do, this);
        this.a = new ci();
        this.o = null;
        this.j = new ge(function (a) {
            var b = a[1];
            a = a[2];
            var c = b[0] - this.o[0];
            b = b[1] - this.o[1];
            return 65536 * Math.log(a) + Math.sqrt(c * c + b * b) / a;
        }.bind(this), function (a) {
            return a[0].lb();
        });
        this.B = function () {
            if (0 !== this.j.b.length) {
                ke(this.j);
                var a = he(this.j);
                tn(this, a[0], a[3], a[4]);
            }
            return !1;
        }.bind(this);
        this.f = 0;
        un(this);
    }
    w(sn, fj);
    sn.handles = function (a) {
        return hd && 'webgl' === a;
    };
    sn.create = function (a, b) {
        return new sn(a, b);
    };
    function tn(a, b, c, d) {
        var e = a.g, f = b.lb();
        if (a.a.a.hasOwnProperty(f))
            a = a.a.get(f), e.bindTexture(3553, a.Mb), 9729 != a.hi && (e.texParameteri(3553, 10240, 9729), a.hi = 9729), 9729 != a.ji && (e.texParameteri(3553, 10241, 9729), a.ji = 9729);
        else {
            var g = e.createTexture();
            e.bindTexture(3553, g);
            if (0 < d) {
                var h = a.C.canvas, l = a.C;
                a.D !== c[0] || a.N !== c[1] ? (h.width = c[0], h.height = c[1], a.D = c[0], a.N = c[1]) : l.clearRect(0, 0, c[0], c[1]);
                l.drawImage(b.Y(), d, d, c[0], c[1], 0, 0, c[0], c[1]);
                e.texImage2D(3553, 0, 6408, 6408, 5121, h);
            } else
                e.texImage2D(3553, 0, 6408, 6408, 5121, b.Y());
            e.texParameteri(3553, 10240, 9729);
            e.texParameteri(3553, 10241, 9729);
            e.texParameteri(3553, 10242, 33071);
            e.texParameteri(3553, 10243, 33071);
            a.a.set(f, {
                Mb: g,
                hi: 9729,
                ji: 9729
            });
        }
    }
    function vn(a, b, c) {
        var d = a.l;
        if (Tc(d, b)) {
            a = a.i;
            var e = c.viewState;
            d.b(new bi(b, new gn(a, e.center, e.resolution, e.rotation, c.size, c.extent, c.pixelRatio), c, null, a));
        }
    }
    k = sn.prototype;
    k.ia = function () {
        var a = this.g;
        a.isContextLost() || this.a.forEach(function (b) {
            b && a.deleteTexture(b.Mb);
        });
        Pc(this.i);
        fj.prototype.ia.call(this);
    };
    k.Yk = function (a, b) {
        a = this.g;
        for (var c; 1024 < this.a.i - this.f;) {
            if (c = this.a.g.Pc)
                a.deleteTexture(c.Mb);
            else if (+this.a.g.jc == b.index)
                break;
            else
                --this.f;
            this.a.pop();
        }
    };
    k.S = function () {
        return 'webgl';
    };
    k.Co = function (a) {
        a.preventDefault();
        this.a.clear();
        this.f = 0;
        a = this.c;
        for (var b in a)
            a[b].Ag();
    };
    k.Do = function () {
        un(this);
        this.l.render();
    };
    function un(a) {
        a = a.g;
        a.activeTexture(33984);
        a.blendFuncSeparate(770, 771, 1, 771);
        a.disable(2884);
        a.disable(2929);
        a.disable(3089);
        a.disable(2960);
    }
    k.bh = function (a) {
        var b = this.i, c = this.g;
        if (c.isContextLost())
            return !1;
        if (!a)
            return this.s && (this.b.style.display = 'none', this.s = !1), !1;
        this.o = a.focus;
        this.a.set((-a.index).toString(), null);
        ++this.f;
        vn(this, 'precompose', a);
        var d = [], e = a.layerStatesArray;
        kc(e);
        var f = a.viewState.resolution, g;
        var h = 0;
        for (g = e.length; h < g; ++h) {
            var l = e[h];
            if (yg(l, f) && 'ready' == l.Vj) {
                var m = ij(this, l.layer);
                m.Bg(a, l, b) && d.push(l);
            }
        }
        e = a.size[0] * a.pixelRatio;
        f = a.size[1] * a.pixelRatio;
        if (this.b.width != e || this.b.height != f)
            this.b.width = e, this.b.height = f;
        c.bindFramebuffer(36160, null);
        c.clearColor(0, 0, 0, 0);
        c.clear(16384);
        c.enable(3042);
        c.viewport(0, 0, this.b.width, this.b.height);
        h = 0;
        for (g = d.length; h < g; ++h)
            l = d[h], m = ij(this, l.layer), m.Zi(a, l, b);
        this.s || (this.b.style.display = '', this.s = !0);
        gj(a);
        1024 < this.a.i - this.f && a.postRenderFunctions.push(this.Yk.bind(this));
        0 !== this.j.b.length && (a.postRenderFunctions.push(this.B), a.animate = !0);
        vn(this, 'postcompose', a);
        jj(this, a);
        a.postRenderFunctions.push(hj);
    };
    k.wa = function (a, b, c, d, e, f, g) {
        if (this.g.isContextLost())
            return !1;
        var h = b.viewState, l = b.layerStatesArray, m;
        for (m = l.length - 1; 0 <= m; --m) {
            var n = l[m];
            var p = n.layer;
            if (yg(n, h.resolution) && f.call(g, p) && (n = ij(this, p).wa(a, b, c, d, e)))
                return n;
        }
    };
    k.Ui = function (a, b, c, d, e) {
        c = !1;
        if (this.g.isContextLost())
            return !1;
        var f = b.viewState, g = b.layerStatesArray, h;
        for (h = g.length - 1; 0 <= h; --h) {
            var l = g[h], m = l.layer;
            if (yg(l, f.resolution) && d.call(e, m) && (c = ij(this, m).cf(a, b)))
                return !0;
        }
        return c;
    };
    k.Ti = function (a, b, c, d, e) {
        if (this.g.isContextLost())
            return !1;
        var f = b.viewState, g = b.layerStatesArray, h;
        for (h = g.length - 1; 0 <= h; --h) {
            var l = g[h];
            var m = l.layer;
            if (yg(l, f.resolution) && e.call(d, m) && (l = ij(this, m).zg(a, b, c, d)))
                return l;
        }
    };
    var wn = new il('precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}'), xn = new jl('varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}');
    function yn(a, b) {
        this.c = a.getUniformLocation(b, 'd');
        this.g = a.getUniformLocation(b, 'e');
        this.b = a.getAttribLocation(b, 'b');
        this.a = a.getAttribLocation(b, 'c');
    }
    function zn(a, b) {
        mn.call(this, a, b);
        this.T = wn;
        this.ca = xn;
        this.i = null;
        this.B = new yl([
            0,
            0,
            0,
            1,
            1,
            0,
            1,
            1,
            0,
            1,
            0,
            0,
            1,
            1,
            1,
            0
        ]);
        this.D = this.l = null;
        this.s = -1;
        this.O = [
            0,
            0
        ];
    }
    w(zn, mn);
    zn.handles = function (a, b) {
        return 'webgl' === a && 'TILE' === b.S();
    };
    zn.create = function (a, b) {
        return new zn(a, b);
    };
    k = zn.prototype;
    k.ia = function () {
        Bl(this.c.i, this.B);
        mn.prototype.ia.call(this);
    };
    k.Rf = function (a, b, c) {
        var d = this.c;
        return function (e, f) {
            return Li(a, b, e, f, function (a) {
                var b = d.a.a.hasOwnProperty(a.lb());
                b && (c[e] || (c[e] = {}), c[e][a.ya.toString()] = a);
                return b;
            });
        };
    };
    k.Ag = function () {
        mn.prototype.Ag.call(this);
        this.i = null;
    };
    k.Bg = function (a, b, c) {
        var d = this.c, e = c.b, f = a.viewState, g = f.projection, h = this.a, l = h.ha(), m = l.eb(g), n = m.Dc(f.resolution), p = m.Ta(n), q = l.Zd(n, a.pixelRatio, g), r = q[0] / Ba(m.Za(n), this.O)[0], u = p / r, v = l.Xc(r) * l.Zf(g), z = f.center, A = a.extent, E = tc(m, A, n);
        if (this.l && na(this.l, E) && this.s == l.g)
            u = this.D;
        else {
            var S = [
                    E.la - E.fa + 1,
                    E.ka - E.ea + 1
                ], Ia = ra(Math.max(S[0] * q[0], S[1] * q[1]));
            S = u * Ia;
            var ta = m.Ic(n), la = ta[0] + E.fa * q[0] * u;
            u = ta[1] + E.ea * q[1] * u;
            u = [
                la,
                u,
                la + S,
                u + S
            ];
            nn(this, a, Ia);
            e.viewport(0, 0, Ia, Ia);
            e.clearColor(0, 0, 0, 0);
            e.clear(16384);
            e.disable(3042);
            Ia = Cl(c, this.T, this.ca);
            c.cd(Ia);
            this.i || (this.i = new yn(e, Ia));
            rl(c, 34962, this.B);
            e.enableVertexAttribArray(this.i.b);
            e.vertexAttribPointer(this.i.b, 2, 5126, !1, 16, 0);
            e.enableVertexAttribArray(this.i.a);
            e.vertexAttribPointer(this.i.a, 2, 5126, !1, 16, 8);
            e.uniform1i(this.i.g, 0);
            c = {};
            c[n] = {};
            var ca = this.Rf(l, g, c), ia = h.i();
            Ia = !0;
            la = Da();
            var xa = new ja(0, 0, 0, 0), Va, ic;
            for (Va = E.fa; Va <= E.la; ++Va)
                for (ic = E.ea; ic <= E.ka; ++ic) {
                    ta = l.ad(n, Va, ic, r, g);
                    if (void 0 !== b.extent) {
                        var Xa = m.Ma(ta.ya, la);
                        if (!hb(Xa, b.extent))
                            continue;
                    }
                    Xa = ta.getState();
                    (Xa = 2 == Xa || 4 == Xa || 3 == Xa && !ia) || (ta = pj(ta));
                    Xa = ta.getState();
                    if (2 == Xa) {
                        if (d.a.a.hasOwnProperty(ta.lb())) {
                            c[n][ta.ya.toString()] = ta;
                            continue;
                        }
                    } else if (4 == Xa || 3 == Xa && !ia)
                        continue;
                    Ia = !1;
                    Xa = uc(m, ta.ya, ca, xa, la);
                    Xa || (ta = vc(m, ta.ya, xa, la)) && ca(n + 1, ta);
                }
            b = Object.keys(c).map(Number);
            b.sort(dc);
            ca = new Float32Array(4);
            var Z;
            ia = 0;
            for (xa = b.length; ia < xa; ++ia)
                for (Z in Va = c[b[ia]], Va)
                    ta = Va[Z], Xa = m.Ma(ta.ya, la), ca[0] = 2 * (Xa[2] - Xa[0]) / S, ca[1] = 2 * (Xa[3] - Xa[1]) / S, ca[2] = 2 * (Xa[0] - u[0]) / S - 1, ca[3] = 2 * (Xa[1] - u[1]) / S - 1, e.uniform4fv(this.i.c, ca), tn(d, ta, q, v * r), e.drawArrays(5, 0, 4);
            Ia ? (this.l = E, this.D = u, this.s = l.g) : (this.D = this.l = null, this.s = -1, a.animate = !0);
        }
        Vi(a.usedTiles, l, n, E);
        var Zb = d.j;
        Wi(a, l, m, r, g, A, n, h.c(), function (a) {
            2 != a.getState() || d.a.a.hasOwnProperty(a.lb()) || a.lb() in Zb.a || Zb.i([
                a,
                yc(m, a.ya),
                m.Ta(a.ya[0]),
                q,
                v * r
            ]);
        }, this);
        Ti(a, l);
        Ui(a, l);
        e = this.v;
        Xe(e);
        df(e, (Math.round(z[0] / p) * p - u[0]) / (u[2] - u[0]), (Math.round(z[1] / p) * p - u[1]) / (u[3] - u[1]));
        0 !== f.rotation && bf(e, f.rotation);
        cf(e, a.size[0] * f.resolution / (u[2] - u[0]), a.size[1] * f.resolution / (u[3] - u[1]));
        df(e, -0.5, -0.5);
        return !0;
    };
    k.zg = function (a, b, c, d) {
        if (this.f) {
            a = af(this.v, [
                a[0] / b.size[0],
                (b.size[1] - a[1]) / b.size[1]
            ].slice());
            a = [
                a[0] * this.j,
                a[1] * this.j
            ];
            b = this.c.i.b;
            b.bindFramebuffer(b.FRAMEBUFFER, this.f);
            var e = new Uint8Array(4);
            b.readPixels(a[0], a[1], 1, 1, b.RGBA, b.UNSIGNED_BYTE, e);
            if (0 < e[3])
                return c.call(d, this.a, e);
        }
    };
    function An(a, b) {
        mn.call(this, a, b);
        this.s = !1;
        this.O = -1;
        this.T = NaN;
        this.D = Da();
        this.l = this.i = this.B = null;
    }
    w(An, mn);
    An.handles = function (a, b) {
        return 'webgl' === a && 'VECTOR' === b.S();
    };
    An.create = function (a, b) {
        return new An(a, b);
    };
    k = An.prototype;
    k.Zi = function (a, b, c) {
        this.l = b;
        var d = a.viewState, e = this.i, f = a.size, g = a.pixelRatio, h = this.c.g;
        e && !e.yg() && (h.enable(h.SCISSOR_TEST), h.scissor(0, 0, f[0] * g, f[1] * g), e.Na(c, d.center, d.resolution, d.rotation, f, g, b.opacity, b.Te ? a.skippedFeatureUids : {}), h.disable(h.SCISSOR_TEST));
    };
    k.ia = function () {
        var a = this.i;
        a && (an(a, this.c.i)(), this.i = null);
        mn.prototype.ia.call(this);
    };
    k.wa = function (a, b, c, d, e) {
        if (this.i && this.l) {
            c = b.viewState;
            var f = this.a, g = {};
            return this.i.wa(a, this.c.i, c.center, c.resolution, c.rotation, b.size, b.pixelRatio, this.l.opacity, {}, function (a) {
                var b = x(a).toString();
                if (!(b in g))
                    return g[b] = !0, d.call(e, a, f);
            });
        }
    };
    k.cf = function (a, b) {
        if (this.i && this.l) {
            var c = b.viewState;
            return fn(this.i, a, this.c.i, c.resolution, c.rotation, b.pixelRatio, this.l.opacity, b.skippedFeatureUids);
        }
        return !1;
    };
    k.zg = function (a, b, c, d) {
        a = af(b.pixelToCoordinateTransform, a.slice());
        if (this.cf(a, b))
            return c.call(d, this.a, null);
    };
    k.$i = function () {
        Mi(this);
    };
    k.Bg = function (a, b, c) {
        function d(a) {
            var b = a.ib();
            if (b)
                var c = b.call(a, m);
            else
                (b = e.ib()) && (c = b(a, m));
            if (c) {
                if (c) {
                    b = !1;
                    if (Array.isArray(c))
                        for (var d = c.length - 1; 0 <= d; --d)
                            b = ek(q, a, c[d], dk(m, n), this.$i, this) || b;
                    else
                        b = ek(q, a, c, dk(m, n), this.$i, this) || b;
                    a = b;
                } else
                    a = !1;
                this.s = this.s || a;
            }
        }
        var e = this.a;
        b = e.ha();
        Ui(a, b);
        var f = a.viewHints[0], g = a.viewHints[1], h = e.ca, l = e.ra;
        if (!this.s && !h && f || !l && g)
            return !0;
        g = a.extent;
        h = a.viewState;
        f = h.projection;
        var m = h.resolution, n = a.pixelRatio;
        h = e.g;
        var p = e.f;
        l = e.get(ik);
        void 0 === l && (l = ck);
        g = Fa(g, p * m);
        if (!this.s && this.T == m && this.O == h && this.B == l && La(this.D, g))
            return !0;
        this.i && a.postRenderFunctions.push(an(this.i, c));
        this.s = !1;
        var q = new $m(0.5 * m / n, g, e.f);
        b.ae(g, m, f);
        if (l) {
            var r = [];
            b.ec(g, function (a) {
                r.push(a);
            }, this);
            r.sort(l);
            r.forEach(d, this);
        } else
            b.ec(g, d, this);
        bn(q, c);
        this.T = m;
        this.O = h;
        this.B = l;
        this.D = g;
        this.i = q;
        return !0;
    };
    qg('MAP_RENDERER', kj);
    rg([
        bj,
        mj,
        hk,
        jk
    ]);
    qg('MAP_RENDERER', sn);
    rg([
        pn,
        zn,
        An
    ]);
    function K(a) {
        a = kb({}, a);
        a.controls || (a.controls = Fg());
        a.interactions || (a.interactions = Zh());
        G.call(this, a);
    }
    w(K, G);
    function Bn(a) {
        Vc.call(this);
        this.id = a.id;
        this.insertFirst = void 0 !== a.insertFirst ? a.insertFirst : !0;
        this.stopEvent = void 0 !== a.stopEvent ? a.stopEvent : !0;
        this.element = document.createElement('DIV');
        this.element.className = void 0 !== a.className ? a.className : 'ol-overlay-container ol-selectable';
        this.element.style.position = 'absolute';
        this.autoPan = void 0 !== a.autoPan ? a.autoPan : !1;
        this.autoPanAnimation = a.autoPanAnimation || {};
        this.autoPanMargin = void 0 !== a.autoPanMargin ? a.autoPanMargin : 20;
        this.a = {
            ze: '',
            Se: '',
            xf: '',
            Ef: '',
            visible: !0
        };
        this.c = null;
        y(this, Xc(Cn), this.am, this);
        y(this, Xc(Dn), this.km, this);
        y(this, Xc(En), this.om, this);
        y(this, Xc(Fn), this.qm, this);
        y(this, Xc(Gn), this.rm, this);
        void 0 !== a.element && this.Hj(a.element);
        this.Mj(void 0 !== a.offset ? a.offset : [
            0,
            0
        ]);
        this.Pj(void 0 !== a.positioning ? a.positioning : 'top-left');
        void 0 !== a.position && this.We(a.position);
    }
    w(Bn, Vc);
    k = Bn.prototype;
    k.Rd = function () {
        return this.get(Cn);
    };
    k.nn = function () {
        return this.id;
    };
    k.Ve = function () {
        return this.get(Dn);
    };
    k.Xh = function () {
        return this.get(En);
    };
    k.pi = function () {
        return this.get(Fn);
    };
    k.Yh = function () {
        return this.get(Gn);
    };
    k.am = function () {
        for (var a = this.element; a.lastChild;)
            a.removeChild(a.lastChild);
        (a = this.Rd()) && this.element.appendChild(a);
    };
    k.km = function () {
        this.c && (jg(this.element), Gc(this.c), this.c = null);
        var a = this.Ve();
        a && (this.c = y(a, 'postrender', this.render, this), Hn(this), a = this.stopEvent ? a.v : a.o, this.insertFirst ? a.insertBefore(this.element, a.childNodes[0] || null) : a.appendChild(this.element));
    };
    k.render = function () {
        Hn(this);
    };
    k.om = function () {
        Hn(this);
    };
    k.qm = function () {
        Hn(this);
        if (this.get(Fn) && this.autoPan) {
            var a = this.Ve();
            if (a && a.Cc()) {
                var b = In(a.Cc(), a.Cb()), c = this.Rd(), d = c.offsetWidth, e = getComputedStyle(c);
                d += parseInt(e.marginLeft, 10) + parseInt(e.marginRight, 10);
                e = c.offsetHeight;
                var f = getComputedStyle(c);
                e += parseInt(f.marginTop, 10) + parseInt(f.marginBottom, 10);
                var g = In(c, [
                    d,
                    e
                ]);
                c = this.autoPanMargin;
                La(b, g) || (d = g[0] - b[0], e = b[2] - g[2], f = g[1] - b[1], g = b[3] - g[3], b = [
                    0,
                    0
                ], 0 > d ? b[0] = d - c : 0 > e && (b[0] = Math.abs(e) + c), 0 > f ? b[1] = f - c : 0 > g && (b[1] = Math.abs(g) + c), 0 === b[0] && 0 === b[1]) || (c = a.aa().xa(), c = a.Ia(c), b = [
                    c[0] + b[0],
                    c[1] + b[1]
                ], a.aa().animate({
                    center: a.Ra(b),
                    duration: this.autoPanAnimation.duration,
                    easing: this.autoPanAnimation.easing
                }));
            }
        }
    };
    k.rm = function () {
        Hn(this);
    };
    k.Hj = function (a) {
        this.set(Cn, a);
    };
    k.setMap = function (a) {
        this.set(Dn, a);
    };
    k.Mj = function (a) {
        this.set(En, a);
    };
    k.We = function (a) {
        this.set(Fn, a);
    };
    function In(a, b) {
        var c = a.getBoundingClientRect();
        a = c.left + window.pageXOffset;
        c = c.top + window.pageYOffset;
        return [
            a,
            c,
            a + b[0],
            c + b[1]
        ];
    }
    k.Pj = function (a) {
        this.set(Gn, a);
    };
    function Jn(a, b) {
        a.a.visible !== b && (a.element.style.display = b ? '' : 'none', a.a.visible = b);
    }
    function Hn(a) {
        var b = a.Ve(), c = a.pi();
        if (b && b.c && c) {
            c = b.Ia(c);
            var d = b.Cb();
            b = a.element.style;
            var e = a.Xh(), f = a.Yh();
            Jn(a, !0);
            var g = e[0];
            e = e[1];
            if ('bottom-right' == f || 'center-right' == f || 'top-right' == f)
                '' !== a.a.Se && (a.a.Se = b.left = ''), g = Math.round(d[0] - c[0] - g) + 'px', a.a.xf != g && (a.a.xf = b.right = g);
            else {
                '' !== a.a.xf && (a.a.xf = b.right = '');
                if ('bottom-center' == f || 'center-center' == f || 'top-center' == f)
                    g -= a.element.offsetWidth / 2;
                g = Math.round(c[0] + g) + 'px';
                a.a.Se != g && (a.a.Se = b.left = g);
            }
            if ('bottom-left' == f || 'bottom-center' == f || 'bottom-right' == f)
                '' !== a.a.Ef && (a.a.Ef = b.top = ''), c = Math.round(d[1] - c[1] - e) + 'px', a.a.ze != c && (a.a.ze = b.bottom = c);
            else {
                '' !== a.a.ze && (a.a.ze = b.bottom = '');
                if ('center-left' == f || 'center-center' == f || 'center-right' == f)
                    e -= a.element.offsetHeight / 2;
                c = Math.round(c[1] + e) + 'px';
                a.a.Ef != c && (a.a.Ef = b.top = c);
            }
        } else
            Jn(a, !1);
    }
    var Cn = 'element', Dn = 'map', En = 'offset', Fn = 'position', Gn = 'positioning';
    function Kn(a, b, c, d, e, f) {
        cl.call(this, a, b, f);
        this.c = 0;
        this.l = null;
        this.v = d;
        this.a = null;
        this.f = {};
        this.C = e;
        this.N = c;
    }
    w(Kn, cl);
    k = Kn.prototype;
    k.ia = function () {
        this.a = null;
        this.f = {};
        this.state = 5;
        this.u();
        cl.prototype.ia.call(this);
    };
    k.G = function () {
        return this.l || Ln;
    };
    k.qn = function () {
        return this.v;
    };
    k.pn = function () {
        return this.a;
    };
    k.lb = function () {
        return this.N;
    };
    k.rn = function () {
        return this.o;
    };
    function ok(a, b, c) {
        return a.f[x(b) + ',' + c];
    }
    k.load = function () {
        0 == this.state && (oj(this, 1), this.C(this, this.N), this.D(null, NaN, null));
    };
    k.Cp = function (a, b, c) {
        this.vg(b);
        this.Ij(a);
        this.ri(c);
    };
    k.Bp = function () {
        oj(this, 3);
    };
    k.ri = function (a) {
        this.l = a;
    };
    k.Ij = function (a) {
        this.a = a;
        oj(this, 2);
    };
    k.vg = function (a) {
        this.o = a;
    };
    k.ug = function (a) {
        this.D = a;
    };
    var Ln = [
        0,
        0,
        4096,
        4096
    ];
    function Mn(a) {
        a = a ? a : {};
        this.c = void 0 !== a.className ? a.className : 'ol-full-screen';
        var b = void 0 !== a.label ? a.label : '\u2922';
        this.l = 'string' === typeof b ? document.createTextNode(b) : b;
        b = void 0 !== a.labelActive ? a.labelActive : '\xD7';
        this.v = 'string' === typeof b ? document.createTextNode(b) : b;
        var c = a.tipLabel ? a.tipLabel : 'Toggle full-screen';
        b = document.createElement('button');
        b.className = this.c + '-' + Nn();
        b.setAttribute('type', 'button');
        b.title = c;
        b.appendChild(this.l);
        y(b, 'click', this.C, this);
        c = document.createElement('div');
        c.className = this.c + ' ol-unselectable ol-control ' + (On() ? '' : 'ol-unsupported');
        c.appendChild(b);
        vg.call(this, {
            element: c,
            target: a.target
        });
        this.D = void 0 !== a.keys ? a.keys : !1;
        this.j = a.source;
    }
    w(Mn, vg);
    Mn.prototype.C = function (a) {
        a.preventDefault();
        On() && (a = this.a) && (Nn() ? document.exitFullscreen ? document.exitFullscreen() : document.msExitFullscreen ? document.msExitFullscreen() : document.mozCancelFullScreen ? document.mozCancelFullScreen() : document.webkitExitFullscreen && document.webkitExitFullscreen() : (a = this.j ? 'string' === typeof this.j ? document.getElementById(this.j) : this.j : a.Cc(), this.D ? a.mozRequestFullScreenWithKeys ? a.mozRequestFullScreenWithKeys() : a.webkitRequestFullscreen ? a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT) : Pn(a) : Pn(a)));
    };
    Mn.prototype.o = function () {
        var a = this.element.firstElementChild, b = this.a;
        Nn() ? (a.className = this.c + '-true', ig(this.v, this.l)) : (a.className = this.c + '-false', ig(this.l, this.v));
        b && b.Oc();
    };
    Mn.prototype.setMap = function (a) {
        vg.prototype.setMap.call(this, a);
        a && this.s.push(y(document, Qn(), this.o, this));
    };
    function On() {
        var a = document.body;
        return !!(a.webkitRequestFullscreen || a.mozRequestFullScreen && document.mozFullScreenEnabled || a.msRequestFullscreen && document.msFullscreenEnabled || a.requestFullscreen && document.fullscreenEnabled);
    }
    function Nn() {
        return !!(document.webkitIsFullScreen || document.mozFullScreen || document.msFullscreenElement || document.fullscreenElement);
    }
    function Pn(a) {
        a.requestFullscreen ? a.requestFullscreen() : a.msRequestFullscreen ? a.msRequestFullscreen() : a.mozRequestFullScreen ? a.mozRequestFullScreen() : a.webkitRequestFullscreen && a.webkitRequestFullscreen();
    }
    var Qn = function () {
        var a;
        return function () {
            if (!a) {
                var b = document.body;
                b.webkitRequestFullscreen ? a = 'webkitfullscreenchange' : b.mozRequestFullScreen ? a = 'mozfullscreenchange' : b.msRequestFullscreen ? a = 'MSFullscreenChange' : b.requestFullscreen && (a = 'fullscreenchange');
            }
            return a;
        };
    }();
    function Rn(a) {
        a = a ? a : {};
        var b = document.createElement('DIV');
        b.className = void 0 !== a.className ? a.className : 'ol-mouse-position';
        vg.call(this, {
            element: b,
            render: a.render ? a.render : Sn,
            target: a.target
        });
        y(this, Xc(Tn), this.En, this);
        a.coordinateFormat && this.Gj(a.coordinateFormat);
        a.projection && this.ti(a.projection);
        this.o = void 0 !== a.undefinedHTML ? a.undefinedHTML : '';
        this.v = b.innerHTML;
        this.l = this.j = this.c = null;
    }
    w(Rn, vg);
    function Sn(a) {
        a = a.frameState;
        a ? this.c != a.viewState.projection && (this.c = a.viewState.projection, this.j = null) : this.c = null;
        Un(this, this.l);
    }
    k = Rn.prototype;
    k.En = function () {
        this.j = null;
    };
    k.Qh = function () {
        return this.get(Vn);
    };
    k.si = function () {
        return this.get(Tn);
    };
    k.mm = function (a) {
        this.l = this.a.ud(a);
        Un(this, this.l);
    };
    k.nm = function () {
        Un(this, null);
        this.l = null;
    };
    k.setMap = function (a) {
        vg.prototype.setMap.call(this, a);
        a && (a = a.a, this.s.push(y(a, 'mousemove', this.mm, this), y(a, 'mouseout', this.nm, this)));
    };
    k.Gj = function (a) {
        this.set(Vn, a);
    };
    k.ti = function (a) {
        this.set(Tn, Ob(a));
    };
    function Un(a, b) {
        var c = a.o;
        if (b && a.c) {
            if (!a.j) {
                var d = a.si();
                a.j = d ? Pb(a.c, d) : $b;
            }
            if (b = a.a.Ra(b))
                a.j(b, b), c = (c = a.Qh()) ? c(b) : b.toString();
        }
        a.v && c == a.v || (a.element.innerHTML = c, a.v = c);
    }
    var Tn = 'projection', Vn = 'coordinateFormat';
    function Wn(a) {
        function b(a) {
            a = h.Sd(a);
            l.a.aa().ub(a);
            window.removeEventListener('mousemove', c);
            window.removeEventListener('mouseup', b);
        }
        function c(a) {
            a = h.Sd({
                clientX: a.clientX - n.offsetWidth / 2,
                clientY: a.clientY + n.offsetHeight / 2
            });
            m.We(a);
        }
        a = a ? a : {};
        this.j = void 0 !== a.collapsed ? a.collapsed : !0;
        this.l = void 0 !== a.collapsible ? a.collapsible : !0;
        this.l || (this.j = !1);
        var d = void 0 !== a.className ? a.className : 'ol-overviewmap', e = void 0 !== a.tipLabel ? a.tipLabel : 'Overview map', f = void 0 !== a.collapseLabel ? a.collapseLabel : '\xAB';
        'string' === typeof f ? (this.o = document.createElement('span'), this.o.textContent = f) : this.o = f;
        f = void 0 !== a.label ? a.label : '\xBB';
        'string' === typeof f ? (this.D = document.createElement('span'), this.D.textContent = f) : this.D = f;
        var g = this.l && !this.j ? this.o : this.D;
        f = document.createElement('button');
        f.setAttribute('type', 'button');
        f.title = e;
        f.appendChild(g);
        y(f, 'click', this.Hn, this);
        this.C = document.createElement('DIV');
        this.C.className = 'ol-overviewmap-map';
        var h = this.c = new G({
            controls: new B(),
            interactions: new B(),
            view: a.view
        });
        a.layers && a.layers.forEach(function (a) {
            h.xe(a);
        }, this);
        e = document.createElement('DIV');
        e.className = 'ol-overviewmap-box';
        e.style.boxSizing = 'border-box';
        this.v = new Bn({
            position: [
                0,
                0
            ],
            positioning: 'bottom-left',
            element: e
        });
        this.c.ye(this.v);
        e = document.createElement('div');
        e.className = d + ' ol-unselectable ol-control' + (this.j && this.l ? ' ol-collapsed' : '') + (this.l ? '' : ' ol-uncollapsible');
        e.appendChild(this.C);
        e.appendChild(f);
        vg.call(this, {
            element: e,
            render: a.render ? a.render : Xn,
            target: a.target
        });
        var l = this, m = this.v, n = this.v.Rd();
        n.addEventListener('mousedown', function () {
            window.addEventListener('mousemove', c);
            window.addEventListener('mouseup', b);
        });
    }
    w(Wn, vg);
    k = Wn.prototype;
    k.setMap = function (a) {
        var b = this.a;
        a !== b && (b && ((b = b.aa()) && Mc(b, Xc('rotation'), this.Qe, this), this.c.Ad(null)), vg.prototype.setMap.call(this, a), a && (this.c.Ad(this.C), this.s.push(y(a, 'propertychange', this.lm, this)), 0 === this.c.Xe().kc() && this.c.zf(a.hc()), a = a.aa())) && (y(a, Xc('rotation'), this.Qe, this), ag(a) && (this.c.Oc(), Yn(this)));
    };
    k.lm = function (a) {
        'view' === a.key && ((a = a.oldValue) && Mc(a, Xc('rotation'), this.Qe, this), a = this.a.aa(), y(a, Xc('rotation'), this.Qe, this));
    };
    k.Qe = function () {
        this.c.aa().ce(this.a.aa().Sa());
    };
    function Xn() {
        var a = this.a, b = this.c;
        if (a.c && b.c) {
            var c = a.Cb();
            a = a.aa().qd(c);
            var d = b.Cb();
            c = b.aa().qd(d);
            var e = b.Ia($a(a)), f = b.Ia(Ya(a));
            b = Math.abs(e[0] - f[0]);
            e = Math.abs(e[1] - f[1]);
            f = d[0];
            d = d[1];
            b < 0.1 * f || e < 0.1 * d || b > 0.75 * f || e > 0.75 * d ? Yn(this) : La(c, a) || (a = this.c, c = this.a.aa(), a.aa().ub(c.xa()));
        }
        Zn(this);
    }
    function Yn(a) {
        var b = a.a;
        a = a.c;
        var c = b.Cb();
        b = b.aa().qd(c);
        a = a.aa();
        ib(b, 1 / (0.1 * Math.pow(2, Math.log(7.5) / Math.LN2 / 2)));
        a.Uf(b);
    }
    function Zn(a) {
        var b = a.a, c = a.c;
        if (b.c && c.c) {
            var d = b.Cb(), e = b.aa(), f = c.aa();
            c = e.Sa();
            b = a.v;
            var g = a.v.Rd(), h = e.qd(d);
            d = f.Pa();
            e = Wa(h);
            f = Za(h);
            if (a = a.a.aa().xa()) {
                var l = [
                    e[0] - a[0],
                    e[1] - a[1]
                ];
                Fe(l, c);
                ze(l, a);
            }
            b.We(l);
            g && (g.style.width = Math.abs((e[0] - f[0]) / d) + 'px', g.style.height = Math.abs((f[1] - e[1]) / d) + 'px');
        }
    }
    k.Hn = function (a) {
        a.preventDefault();
        $n(this);
    };
    function $n(a) {
        a.element.classList.toggle('ol-collapsed');
        a.j ? ig(a.o, a.D) : ig(a.D, a.o);
        a.j = !a.j;
        var b = a.c;
        a.j || b.c || (b.Oc(), Yn(a), Lc(b, 'postrender', function () {
            Zn(this);
        }, a));
    }
    k.Gn = function () {
        return this.l;
    };
    k.Jn = function (a) {
        this.l !== a && (this.l = a, this.element.classList.toggle('ol-uncollapsible'), !a && this.j && $n(this));
    };
    k.In = function (a) {
        this.l && this.j !== a && $n(this);
    };
    k.Fn = function () {
        return this.j;
    };
    k.Hl = function () {
        return this.c;
    };
    function ao(a) {
        a = a ? a : {};
        var b = void 0 !== a.className ? a.className : 'ol-scale-line';
        this.l = document.createElement('DIV');
        this.l.className = b + '-inner';
        this.c = document.createElement('DIV');
        this.c.className = b + ' ol-unselectable';
        this.c.appendChild(this.l);
        this.o = null;
        this.v = void 0 !== a.minWidth ? a.minWidth : 64;
        this.j = !1;
        this.B = void 0;
        this.D = '';
        vg.call(this, {
            element: this.c,
            render: a.render ? a.render : bo,
            target: a.target
        });
        y(this, Xc(co), this.V, this);
        this.O(a.units || 'metric');
    }
    w(ao, vg);
    var eo = [
        1,
        2,
        5
    ];
    ao.prototype.C = function () {
        return this.get(co);
    };
    function bo(a) {
        (a = a.frameState) ? this.o = a.viewState : this.o = null;
        fo(this);
    }
    ao.prototype.V = function () {
        fo(this);
    };
    ao.prototype.O = function (a) {
        this.set(co, a);
    };
    function fo(a) {
        var b = a.o;
        if (b) {
            var c = b.center, d = b.projection, e = a.C();
            b = Nb(d, b.resolution, c, 'degrees' == e ? 'degrees' : 'm');
            'degrees' != e && (b *= d.Bc());
            var f = a.v * b;
            c = '';
            'degrees' == e ? (c = ub.degrees, 'degrees' == d.a ? f *= c : b /= c, f < c / 60 ? (c = '\u2033', b *= 3600) : f < c ? (c = '\u2032', b *= 60) : c = '\xB0') : 'imperial' == e ? 0.9144 > f ? (c = 'in', b /= 0.0254) : 1609.344 > f ? (c = 'ft', b /= 0.3048) : (c = 'mi', b /= 1609.344) : 'nautical' == e ? (b /= 1852, c = 'nm') : 'metric' == e ? 0.001 > f ? (c = 'μm', b *= 1000000) : 1 > f ? (c = 'mm', b *= 1000) : 1000 > f ? c = 'm' : (c = 'km', b /= 1000) : 'us' == e ? 0.9144 > f ? (c = 'in', b *= 39.37) : 1609.344 > f ? (c = 'ft', b /= 0.30480061) : (c = 'mi', b /= 1609.3472) : oa(!1, 33);
            for (e = 3 * Math.floor(Math.log(a.v * b) / Math.log(10));;) {
                f = eo[(e % 3 + 3) % 3] * Math.pow(10, Math.floor(e / 3));
                d = Math.round(f / b);
                if (isNaN(d)) {
                    a.c.style.display = 'none';
                    a.j = !1;
                    return;
                }
                if (d >= a.v)
                    break;
                ++e;
            }
            b = f + ' ' + c;
            a.D != b && (a.l.innerHTML = b, a.D = b);
            a.B != d && (a.l.style.width = d + 'px', a.B = d);
            a.j || (a.c.style.display = '', a.j = !0);
        } else
            a.j && (a.c.style.display = 'none', a.j = !1);
    }
    var co = 'units';
    function go(a) {
        a = a ? a : {};
        this.c = void 0;
        this.j = ho;
        this.D = this.v = 0;
        this.O = null;
        this.$ = !1;
        this.V = void 0 !== a.duration ? a.duration : 200;
        var b = void 0 !== a.className ? a.className : 'ol-zoomslider', c = document.createElement('button');
        c.setAttribute('type', 'button');
        c.className = b + '-thumb ol-unselectable';
        var d = document.createElement('div');
        d.className = b + ' ol-unselectable ol-control';
        d.appendChild(c);
        this.l = new Xd(d);
        y(this.l, 'pointerdown', this.$l, this);
        y(this.l, 'pointermove', this.Yl, this);
        y(this.l, 'pointerup', this.Zl, this);
        y(d, 'click', this.Xl, this);
        y(c, 'click', Rc);
        vg.call(this, {
            element: d,
            render: a.render ? a.render : io
        });
    }
    w(go, vg);
    go.prototype.ia = function () {
        Pc(this.l);
        vg.prototype.ia.call(this);
    };
    var ho = 0;
    k = go.prototype;
    k.setMap = function (a) {
        vg.prototype.setMap.call(this, a);
        a && a.render();
    };
    function io(a) {
        if (a.frameState) {
            if (!this.$) {
                var b = this.element, c = b.offsetWidth, d = b.offsetHeight, e = b.firstElementChild, f = getComputedStyle(e);
                b = e.offsetWidth + parseFloat(f.marginRight) + parseFloat(f.marginLeft);
                e = e.offsetHeight + parseFloat(f.marginTop) + parseFloat(f.marginBottom);
                this.O = [
                    b,
                    e
                ];
                c > d ? (this.j = 1, this.D = c - b) : (this.j = ho, this.v = d - e);
                this.$ = !0;
            }
            a = a.frameState.viewState.resolution;
            a !== this.c && (this.c = a, jo(this, a));
        }
    }
    k.Xl = function (a) {
        var b = this.a.aa();
        a = ko(this, pa(1 === this.j ? (a.offsetX - this.O[0] / 2) / this.D : (a.offsetY - this.O[1] / 2) / this.v, 0, 1));
        b.animate({
            resolution: b.constrainResolution(a),
            duration: this.V,
            easing: Oe
        });
    };
    k.$l = function (a) {
        this.o || a.b.target !== this.element.firstElementChild || (bg(this.a.aa(), 1, 1), this.C = a.clientX, this.B = a.clientY, this.o = !0);
    };
    k.Yl = function (a) {
        if (this.o) {
            var b = this.element.firstElementChild;
            this.c = ko(this, pa(1 === this.j ? (a.clientX - this.C + parseInt(b.style.left, 10)) / this.D : (a.clientY - this.B + parseInt(b.style.top, 10)) / this.v, 0, 1));
            this.a.aa().gd(this.c);
            jo(this, this.c);
            this.C = a.clientX;
            this.B = a.clientY;
        }
    };
    k.Zl = function () {
        if (this.o) {
            var a = this.a.aa();
            bg(a, 1, -1);
            a.animate({
                resolution: a.constrainResolution(this.c),
                duration: this.V,
                easing: Oe
            });
            this.o = !1;
            this.B = this.C = void 0;
        }
    };
    function jo(a, b) {
        b = 1 - gg(a.a.aa())(b);
        var c = a.element.firstElementChild;
        1 == a.j ? c.style.left = a.D * b + 'px' : c.style.top = a.v * b + 'px';
    }
    function ko(a, b) {
        return fg(a.a.aa())(1 - b);
    }
    function lo(a) {
        a = a ? a : {};
        this.extent = a.extent ? a.extent : null;
        var b = void 0 !== a.className ? a.className : 'ol-zoom-extent', c = void 0 !== a.label ? a.label : 'E', d = void 0 !== a.tipLabel ? a.tipLabel : 'Fit to extent', e = document.createElement('button');
        e.setAttribute('type', 'button');
        e.title = d;
        e.appendChild('string' === typeof c ? document.createTextNode(c) : c);
        y(e, 'click', this.c, this);
        c = document.createElement('div');
        c.className = b + ' ol-unselectable ol-control';
        c.appendChild(e);
        vg.call(this, {
            element: c,
            target: a.target
        });
    }
    w(lo, vg);
    lo.prototype.c = function (a) {
        a.preventDefault();
        a = this.a.aa();
        var b = this.extent ? this.extent : a.v.G();
        a.Uf(b);
    };
    var mo = document.implementation.createDocument('', '', null);
    function no(a, b) {
        return mo.createElementNS(a, b);
    }
    function oo(a, b) {
        return po(a, b, []).join('');
    }
    function po(a, b, c) {
        if (a.nodeType == Node.CDATA_SECTION_NODE || a.nodeType == Node.TEXT_NODE)
            b ? c.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g, '')) : c.push(a.nodeValue);
        else
            for (a = a.firstChild; a; a = a.nextSibling)
                po(a, b, c);
        return c;
    }
    function qo(a) {
        return a instanceof Document;
    }
    function ro(a) {
        return a instanceof Node;
    }
    function so(a) {
        return new DOMParser().parseFromString(a, 'application/xml');
    }
    function to(a, b) {
        return function (c, d) {
            c = a.call(b, c, d);
            void 0 !== c && gc(d[d.length - 1], c);
        };
    }
    function uo(a, b) {
        return function (c, d) {
            c = a.call(void 0 !== b ? b : this, c, d);
            void 0 !== c && d[d.length - 1].push(c);
        };
    }
    function vo(a, b) {
        return function (c, d) {
            c = a.call(void 0 !== b ? b : this, c, d);
            void 0 !== c && (d[d.length - 1] = c);
        };
    }
    function wo(a) {
        return function (b, c) {
            var d = a.call(this, b, c);
            if (void 0 !== d) {
                c = c[c.length - 1];
                b = b.localName;
                var e;
                b in c ? e = c[b] : e = c[b] = [];
                e.push(d);
            }
        };
    }
    function L(a, b) {
        return function (c, d) {
            var e = a.call(this, c, d);
            void 0 !== e && (d[d.length - 1][void 0 !== b ? b : c.localName] = e);
        };
    }
    function M(a, b) {
        return function (c, d, e) {
            a.call(void 0 !== b ? b : this, c, d, e);
            e[e.length - 1].node.appendChild(c);
        };
    }
    function xo(a) {
        var b, c;
        return function (d, e, f) {
            if (void 0 === b) {
                b = {};
                var g = {};
                g[d.localName] = a;
                b[d.namespaceURI] = g;
                c = yo(d.localName);
            }
            zo(b, c, e, f);
        };
    }
    function yo(a, b) {
        return function (c, d, e) {
            c = d[d.length - 1].node;
            d = a;
            void 0 === d && (d = e);
            e = b;
            void 0 === b && (e = c.namespaceURI);
            return no(e, d);
        };
    }
    var Ao = yo();
    function Bo(a, b) {
        for (var c = b.length, d = Array(c), e = 0; e < c; ++e)
            d[e] = a[b[e]];
        return d;
    }
    function N(a, b, c) {
        c = void 0 !== c ? c : {};
        var d;
        var e = 0;
        for (d = a.length; e < d; ++e)
            c[a[e]] = b;
        return c;
    }
    function Co(a, b, c, d) {
        for (b = b.firstElementChild; b; b = b.nextElementSibling) {
            var e = a[b.namespaceURI];
            void 0 !== e && (e = e[b.localName], void 0 !== e && e.call(d, b, c));
        }
    }
    function O(a, b, c, d, e) {
        d.push(a);
        Co(b, c, d, e);
        return d.pop();
    }
    function zo(a, b, c, d, e, f) {
        for (var g = (void 0 !== e ? e : c).length, h, l, m = 0; m < g; ++m)
            h = c[m], void 0 !== h && (l = b.call(f, h, d, void 0 !== e ? e[m] : void 0), void 0 !== l && a[l.namespaceURI][l.localName].call(f, l, h, d));
    }
    function Do(a, b, c, d, e, f, g) {
        e.push(a);
        zo(b, c, d, e, f, g);
        e.pop();
    }
    function Eo(a, b, c, d) {
        return function (e, f, g) {
            var h = new XMLHttpRequest();
            h.open('GET', 'function' === typeof a ? a(e, f, g) : a, !0);
            'arraybuffer' == b.S() && (h.responseType = 'arraybuffer');
            h.onload = function () {
                if (!h.status || 200 <= h.status && 300 > h.status) {
                    var a = b.S();
                    if ('json' == a || 'text' == a)
                        var e = h.responseText;
                    else
                        'xml' == a ? (e = h.responseXML) || (e = so(h.responseText)) : 'arraybuffer' == a && (e = h.response);
                    e ? c.call(this, b.Qa(e, { featureProjection: g }), b.sb(e), b.cg()) : d.call(this);
                } else
                    d.call(this);
            }.bind(this);
            h.onerror = function () {
                d.call(this);
            }.bind(this);
            h.send();
        };
    }
    function Fo(a, b) {
        return Eo(a, b, function (a) {
            this.Qc(a);
        }, ea);
    }
    function Go() {
        this.i = this.defaultDataProjection = null;
    }
    function Ho(a, b, c) {
        var d;
        c && (d = {
            dataProjection: c.dataProjection ? c.dataProjection : a.sb(b),
            featureProjection: c.featureProjection
        });
        return Io(a, d);
    }
    function Io(a, b) {
        return kb({
            dataProjection: a.defaultDataProjection,
            featureProjection: a.i
        }, b);
    }
    Go.prototype.cg = function () {
        return null;
    };
    function Jo(a, b, c) {
        var d = c ? Ob(c.featureProjection) : null, e = c ? Ob(c.dataProjection) : null, f;
        d && e && !Xb(d, e) ? a instanceof gf ? f = (b ? a.clone() : a).mb(b ? d : e, b ? e : d) : f = bc(a, e, d) : f = a;
        if (b && c && void 0 !== c.decimals) {
            var g = Math.pow(10, c.decimals);
            f === a && (f = f.clone());
            f.Rc(function (a) {
                for (var b = 0, c = a.length; b < c; ++b)
                    a[b] = Math.round(a[b] * g) / g;
                return a;
            });
        }
        return f;
    }
    function Ko() {
        Go.call(this);
    }
    w(Ko, Go);
    function Lo(a) {
        return 'string' === typeof a ? (a = JSON.parse(a)) ? a : null : null !== a ? a : null;
    }
    k = Ko.prototype;
    k.S = function () {
        return 'json';
    };
    k.Yb = function (a, b) {
        return this.dd(Lo(a), Ho(this, a, b));
    };
    k.Qa = function (a, b) {
        return this.Mg(Lo(a), Ho(this, a, b));
    };
    k.ed = function (a, b) {
        return this.Qg(Lo(a), Ho(this, a, b));
    };
    k.sb = function (a) {
        return this.Tg(Lo(a));
    };
    k.Jd = function (a, b) {
        return JSON.stringify(this.ld(a, b));
    };
    k.ac = function (a, b) {
        return JSON.stringify(this.qe(a, b));
    };
    k.md = function (a, b) {
        return JSON.stringify(this.se(a, b));
    };
    function P(a, b) {
        hf.call(this);
        this.c = [];
        this.j = this.o = -1;
        this.na(a, b);
    }
    w(P, hf);
    k = P.prototype;
    k.Gk = function (a) {
        this.A ? gc(this.A, a.da().slice()) : this.A = a.da().slice();
        this.c.push(this.A.length);
        this.u();
    };
    k.clone = function () {
        var a = new P(null);
        a.ba(this.ja, this.A.slice(), this.c.slice());
        return a;
    };
    k.Nb = function (a, b, c, d) {
        if (d < Ha(this.G(), a, b))
            return d;
        this.j != this.g && (this.o = Math.sqrt(qf(this.A, 0, this.c, this.a, 0)), this.j = this.g);
        return uf(this.A, 0, this.c, this.a, this.o, !1, a, b, c, d);
    };
    k.Wn = function (a, b, c) {
        return 'XYM' != this.ja && 'XYZM' != this.ja || 0 === this.A.length ? null : Tk(this.A, this.c, this.a, a, void 0 !== b ? b : !1, void 0 !== c ? c : !1);
    };
    k.W = function () {
        return zf(this.A, 0, this.c, this.a);
    };
    k.pb = function () {
        return this.c;
    };
    k.yl = function (a) {
        if (0 > a || this.c.length <= a)
            return null;
        var b = new I(null);
        b.ba(this.ja, this.A.slice(0 === a ? 0 : this.c[a - 1], this.c[a]));
        return b;
    };
    k.wd = function () {
        var a = this.A, b = this.c, c = this.ja, d = [], e = 0, f;
        var g = 0;
        for (f = b.length; g < f; ++g) {
            var h = b[g], l = new I(null);
            l.ba(c, a.slice(e, h));
            d.push(l);
            e = h;
        }
        return d;
    };
    k.Ge = function () {
        var a = [], b = this.A, c = 0, d = this.c, e = this.a, f;
        var g = 0;
        for (f = d.length; g < f; ++g) {
            var h = d[g];
            c = Kk(b, c, h, e, 0.5);
            gc(a, c);
            c = h;
        }
        return a;
    };
    k.xd = function (a) {
        var b = [], c = [], d = this.A, e = this.c, f = this.a, g = 0, h = 0, l;
        var m = 0;
        for (l = e.length; m < l; ++m) {
            var n = e[m];
            h = Bf(d, g, n, f, a, b, h);
            c.push(h);
            g = n;
        }
        b.length = h;
        a = new P(null);
        a.ba('XY', b, c);
        return a;
    };
    k.S = function () {
        return 'MultiLineString';
    };
    k.$a = function (a) {
        a: {
            var b = this.A, c = this.c, d = this.a, e = 0, f;
            var g = 0;
            for (f = c.length; g < f; ++g) {
                if (Kf(b, e, c[g], d, a)) {
                    a = !0;
                    break a;
                }
                e = c[g];
            }
            a = !1;
        }
        return a;
    };
    k.na = function (a, b) {
        a ? (lf(this, b, a, 2), this.A || (this.A = []), a = xf(this.A, 0, a, this.a, this.c), this.A.length = 0 === a.length ? 0 : a[a.length - 1], this.u()) : this.ba('XY', null, this.c);
    };
    k.ba = function (a, b, c) {
        kf(this, a, b);
        this.c = c;
        this.u();
    };
    function Mo(a, b) {
        var c = a.ja, d = [], e = [], f;
        var g = 0;
        for (f = b.length; g < f; ++g) {
            var h = b[g];
            0 === g && (c = h.ja);
            gc(d, h.da());
            e.push(d.length);
        }
        a.ba(c, d, e);
    }
    function No(a, b) {
        hf.call(this);
        this.na(a, b);
    }
    w(No, hf);
    k = No.prototype;
    k.Ik = function (a) {
        this.A ? gc(this.A, a.da()) : this.A = a.da().slice();
        this.u();
    };
    k.clone = function () {
        var a = new No(null);
        a.ba(this.ja, this.A.slice());
        return a;
    };
    k.Nb = function (a, b, c, d) {
        if (d < Ha(this.G(), a, b))
            return d;
        var e = this.A, f = this.a, g;
        var h = 0;
        for (g = e.length; h < g; h += f) {
            var l = ua(a, b, e[h], e[h + 1]);
            if (l < d) {
                d = l;
                for (l = 0; l < f; ++l)
                    c[l] = e[h + l];
                c.length = f;
            }
        }
        return d;
    };
    k.W = function () {
        return yf(this.A, 0, this.A.length, this.a);
    };
    k.Ll = function (a) {
        var b = this.A ? this.A.length / this.a : 0;
        if (0 > a || b <= a)
            return null;
        b = new C(null);
        b.ba(this.ja, this.A.slice(a * this.a, (a + 1) * this.a));
        return b;
    };
    k.de = function () {
        var a = this.A, b = this.ja, c = this.a, d = [], e;
        var f = 0;
        for (e = a.length; f < e; f += c) {
            var g = new C(null);
            g.ba(b, a.slice(f, f + c));
            d.push(g);
        }
        return d;
    };
    k.S = function () {
        return 'MultiPoint';
    };
    k.$a = function (a) {
        var b = this.A, c = this.a, d;
        var e = 0;
        for (d = b.length; e < d; e += c) {
            var f = b[e];
            var g = b[e + 1];
            if (Ka(a, f, g))
                return !0;
        }
        return !1;
    };
    k.na = function (a, b) {
        a ? (lf(this, b, a, 1), this.A || (this.A = []), this.A.length = wf(this.A, 0, a, this.a), this.u()) : this.ba('XY', null);
    };
    k.ba = function (a, b) {
        kf(this, a, b);
        this.u();
    };
    function Q(a, b) {
        hf.call(this);
        this.c = [];
        this.o = -1;
        this.D = null;
        this.T = this.C = this.B = -1;
        this.j = null;
        this.na(a, b);
    }
    w(Q, hf);
    k = Q.prototype;
    k.Jk = function (a) {
        if (this.A) {
            var b = this.A.length;
            gc(this.A, a.da());
            a = a.pb().slice();
            var c;
            var d = 0;
            for (c = a.length; d < c; ++d)
                a[d] += b;
        } else
            this.A = a.da().slice(), a = a.pb().slice(), this.c.push();
        this.c.push(a);
        this.u();
    };
    k.clone = function () {
        for (var a = new Q(null), b = this.c.length, c = Array(b), d = 0; d < b; ++d)
            c[d] = this.c[d].slice();
        a.ba(this.ja, this.A.slice(), c);
        return a;
    };
    k.Nb = function (a, b, c, d) {
        if (d < Ha(this.G(), a, b))
            return d;
        if (this.C != this.g) {
            var e = this.c, f = 0, g = 0, h;
            var l = 0;
            for (h = e.length; l < h; ++l) {
                var m = e[l];
                g = qf(this.A, f, m, this.a, g);
                f = m[m.length - 1];
            }
            this.B = Math.sqrt(g);
            this.C = this.g;
        }
        e = Ii(this);
        f = this.c;
        g = this.a;
        l = this.B;
        h = 0;
        m = [
            NaN,
            NaN
        ];
        var n;
        var p = 0;
        for (n = f.length; p < n; ++p) {
            var q = f[p];
            d = uf(e, h, q, g, l, !0, a, b, c, d, m);
            h = q[q.length - 1];
        }
        return d;
    };
    k.Zc = function (a, b) {
        a: {
            var c = Ii(this), d = this.c, e = 0;
            if (0 !== d.length) {
                var f;
                var g = 0;
                for (f = d.length; g < f; ++g) {
                    var h = d[g];
                    if (Hf(c, e, h, this.a, a, b)) {
                        a = !0;
                        break a;
                    }
                    e = h[h.length - 1];
                }
            }
            a = !1;
        }
        return a;
    };
    k.Xn = function () {
        var a = Ii(this), b = this.c, c = 0, d = 0, e;
        var f = 0;
        for (e = b.length; f < e; ++f) {
            var g = b[f];
            d += nf(a, c, g, this.a);
            c = g[g.length - 1];
        }
        return d;
    };
    k.W = function (a) {
        if (void 0 !== a) {
            var b = Ii(this).slice();
            Pf(b, this.c, this.a, a);
        } else
            b = this.A;
        return Af(b, 0, this.c, this.a);
    };
    k.td = function () {
        return this.c;
    };
    function Ji(a) {
        if (a.o != a.g) {
            var b = a.A, c = a.c, d = a.a, e = 0, f = [], g;
            var h = 0;
            for (g = c.length; h < g; ++h) {
                var l = c[h];
                e = Qa(b, e, l[0], d);
                f.push((e[0] + e[2]) / 2, (e[1] + e[3]) / 2);
                e = l[l.length - 1];
            }
            b = Ii(a);
            c = a.c;
            d = a.a;
            h = 0;
            g = [];
            l = 0;
            for (e = c.length; l < e; ++l) {
                var m = c[l];
                g = If(b, h, m, d, f, 2 * l, g);
                h = m[m.length - 1];
            }
            a.D = g;
            a.o = a.g;
        }
        return a.D;
    }
    k.ul = function () {
        var a = new No(null);
        a.ba('XYM', Ji(this).slice());
        return a;
    };
    function Ii(a) {
        if (a.T != a.g) {
            var b = a.A;
            a: {
                var c = a.c;
                var d;
                var e = 0;
                for (d = c.length; e < d; ++e)
                    if (!Nf(b, c[e], a.a, void 0)) {
                        c = !1;
                        break a;
                    }
                c = !0;
            }
            c ? a.j = b : (a.j = b.slice(), a.j.length = Pf(a.j, a.c, a.a));
            a.T = a.g;
        }
        return a.j;
    }
    k.xd = function (a) {
        var b = [], c = [], d = this.A, e = this.c, f = this.a;
        a = Math.sqrt(a);
        var g = 0, h = 0, l;
        var m = 0;
        for (l = e.length; m < l; ++m) {
            var n = e[m], p = [];
            h = Cf(d, g, n, f, a, b, h, p);
            c.push(p);
            g = n[n.length - 1];
        }
        b.length = h;
        d = new Q(null);
        d.ba('XY', b, c);
        return d;
    };
    k.Ml = function (a) {
        if (0 > a || this.c.length <= a)
            return null;
        if (0 === a)
            var b = 0;
        else
            b = this.c[a - 1], b = b[b.length - 1];
        a = this.c[a].slice();
        var c = a[a.length - 1];
        if (0 !== b) {
            var d;
            var e = 0;
            for (d = a.length; e < d; ++e)
                a[e] -= b;
        }
        e = new D(null);
        e.ba(this.ja, this.A.slice(b, c), a);
        return e;
    };
    k.Vd = function () {
        var a = this.ja, b = this.A, c = this.c, d = [], e = 0, f, g;
        var h = 0;
        for (f = c.length; h < f; ++h) {
            var l = c[h].slice(), m = l[l.length - 1];
            if (0 !== e) {
                var n = 0;
                for (g = l.length; n < g; ++n)
                    l[n] -= e;
            }
            n = new D(null);
            n.ba(a, b.slice(e, m), l);
            d.push(n);
            e = m;
        }
        return d;
    };
    k.S = function () {
        return 'MultiPolygon';
    };
    k.$a = function (a) {
        a: {
            var b = Ii(this), c = this.c, d = this.a, e = 0, f;
            var g = 0;
            for (f = c.length; g < f; ++g) {
                var h = c[g];
                if (Lf(b, e, h, d, a)) {
                    a = !0;
                    break a;
                }
                e = h[h.length - 1];
            }
            a = !1;
        }
        return a;
    };
    k.na = function (a, b) {
        if (a) {
            lf(this, b, a, 3);
            this.A || (this.A = []);
            b = this.A;
            var c = this.a, d = this.c, e = 0;
            d = d ? d : [];
            var f = 0, g;
            var h = 0;
            for (g = a.length; h < g; ++h)
                e = xf(b, e, a[h], c, d[f]), d[f++] = e, e = e[e.length - 1];
            d.length = f;
            0 === d.length ? this.A.length = 0 : (a = d[d.length - 1], this.A.length = 0 === a.length ? 0 : a[a.length - 1]);
            this.u();
        } else
            this.ba('XY', null, this.c);
    };
    k.ba = function (a, b, c) {
        kf(this, a, b);
        this.c = c;
        this.u();
    };
    function Oo(a, b) {
        var c = a.ja, d = [], e = [], f;
        var g = 0;
        for (f = b.length; g < f; ++g) {
            var h = b[g];
            0 === g && (c = h.ja);
            var l = d.length;
            var m = h.pb();
            var n;
            var p = 0;
            for (n = m.length; p < n; ++p)
                m[p] += l;
            gc(d, h.da());
            e.push(m);
        }
        a.ba(c, d, e);
    }
    function Po(a) {
        a = a ? a : {};
        Go.call(this);
        this.b = a.geometryName;
    }
    w(Po, Ko);
    function Qo(a, b) {
        if (!a)
            return null;
        if ('number' === typeof a.x && 'number' === typeof a.y)
            var c = 'Point';
        else if (a.points)
            c = 'MultiPoint';
        else if (a.paths)
            c = 1 === a.paths.length ? 'LineString' : 'MultiLineString';
        else if (a.rings) {
            var d = a.rings, e = Ro(a), f = [], g = [];
            c = [];
            var h;
            var l = 0;
            for (h = d.length; l < h; ++l)
                f.length = 0, wf(f, 0, d[l], e.length), Mf(f, 0, f.length, e.length) ? g.push([d[l]]) : c.push(d[l]);
            for (; c.length;) {
                d = c.shift();
                e = !1;
                for (l = g.length - 1; 0 <= l; l--)
                    if (La(new Df(g[l][0]).G(), new Df(d).G())) {
                        g[l].push(d);
                        e = !0;
                        break;
                    }
                e || g.push([d.reverse()]);
            }
            a = kb({}, a);
            1 === g.length ? (c = 'Polygon', a.rings = g[0]) : (c = 'MultiPolygon', a.rings = g);
        }
        return Jo((0, So[c])(a), !1, b);
    }
    function Ro(a) {
        var b = 'XY';
        !0 === a.hasZ && !0 === a.hasM ? b = 'XYZM' : !0 === a.hasZ ? b = 'XYZ' : !0 === a.hasM && (b = 'XYM');
        return b;
    }
    function To(a) {
        a = a.ja;
        return {
            hasZ: 'XYZ' === a || 'XYZM' === a,
            hasM: 'XYM' === a || 'XYZM' === a
        };
    }
    var So = {
            Point: function (a) {
                return void 0 !== a.m && void 0 !== a.z ? new C([
                    a.x,
                    a.y,
                    a.z,
                    a.m
                ], 'XYZM') : void 0 !== a.z ? new C([
                    a.x,
                    a.y,
                    a.z
                ], 'XYZ') : void 0 !== a.m ? new C([
                    a.x,
                    a.y,
                    a.m
                ], 'XYM') : new C([
                    a.x,
                    a.y
                ]);
            },
            LineString: function (a) {
                return new I(a.paths[0], Ro(a));
            },
            Polygon: function (a) {
                return new D(a.rings, Ro(a));
            },
            MultiPoint: function (a) {
                return new No(a.points, Ro(a));
            },
            MultiLineString: function (a) {
                return new P(a.paths, Ro(a));
            },
            MultiPolygon: function (a) {
                return new Q(a.rings, Ro(a));
            }
        }, Uo = {
            Point: function (a) {
                var b = a.W(), c;
                a = a.ja;
                'XYZ' === a ? c = {
                    x: b[0],
                    y: b[1],
                    z: b[2]
                } : 'XYM' === a ? c = {
                    x: b[0],
                    y: b[1],
                    m: b[2]
                } : 'XYZM' === a ? c = {
                    x: b[0],
                    y: b[1],
                    z: b[2],
                    m: b[3]
                } : 'XY' === a ? c = {
                    x: b[0],
                    y: b[1]
                } : oa(!1, 34);
                return c;
            },
            LineString: function (a) {
                var b = To(a);
                return {
                    hasZ: b.hasZ,
                    hasM: b.hasM,
                    paths: [a.W()]
                };
            },
            Polygon: function (a) {
                var b = To(a);
                return {
                    hasZ: b.hasZ,
                    hasM: b.hasM,
                    rings: a.W(!1)
                };
            },
            MultiPoint: function (a) {
                var b = To(a);
                return {
                    hasZ: b.hasZ,
                    hasM: b.hasM,
                    points: a.W()
                };
            },
            MultiLineString: function (a) {
                var b = To(a);
                return {
                    hasZ: b.hasZ,
                    hasM: b.hasM,
                    paths: a.W()
                };
            },
            MultiPolygon: function (a) {
                var b = To(a);
                a = a.W(!1);
                for (var c = [], d = 0; d < a.length; d++)
                    for (var e = a[d].length - 1; 0 <= e; e--)
                        c.push(a[d][e]);
                return {
                    hasZ: b.hasZ,
                    hasM: b.hasM,
                    rings: c
                };
            }
        };
    k = Po.prototype;
    k.dd = function (a, b) {
        var c = Qo(a.geometry, b), d = new Hk();
        this.b && d.Lc(this.b);
        d.Va(c);
        b && b.pg && a.attributes[b.pg] && d.qc(a.attributes[b.pg]);
        a.attributes && d.H(a.attributes);
        return d;
    };
    k.Mg = function (a, b) {
        b = b ? b : {};
        if (a.features) {
            var c = [], d = a.features, e;
            b.pg = a.objectIdFieldName;
            a = 0;
            for (e = d.length; a < e; ++a)
                c.push(this.dd(d[a], b));
            return c;
        }
        return [this.dd(a, b)];
    };
    k.Qg = function (a, b) {
        return Qo(a, b);
    };
    k.Tg = function (a) {
        return a.spatialReference && a.spatialReference.wkid ? Ob('EPSG:' + a.spatialReference.wkid) : null;
    };
    function Vo(a, b) {
        return (0, Uo[a.S()])(Jo(a, !0, b), b);
    }
    k.se = function (a, b) {
        return Vo(a, Io(this, b));
    };
    k.ld = function (a, b) {
        b = Io(this, b);
        var c = {}, d = a.U();
        d && (c.geometry = Vo(d, b), b && b.featureProjection && (c.geometry.spatialReference = { wkid: Ob(b.featureProjection).wb.split(':').pop() }));
        b = a.L();
        delete b[a.a];
        c.attributes = nb(b) ? {} : b;
        return c;
    };
    k.qe = function (a, b) {
        b = Io(this, b);
        var c = [], d;
        var e = 0;
        for (d = a.length; e < d; ++e)
            c.push(this.ld(a[e], b));
        return { features: c };
    };
    function Wo() {
        this.g = new XMLSerializer();
        Go.call(this);
    }
    w(Wo, Go);
    k = Wo.prototype;
    k.S = function () {
        return 'xml';
    };
    k.Yb = function (a, b) {
        return qo(a) ? Xo(this, a, b) : ro(a) ? this.Lg(a, b) : 'string' === typeof a ? (a = so(a), Xo(this, a, b)) : null;
    };
    function Xo(a, b, c) {
        a = Yo(a, b, c);
        return 0 < a.length ? a[0] : null;
    }
    k.Lg = function () {
        return null;
    };
    k.Qa = function (a, b) {
        return qo(a) ? Yo(this, a, b) : ro(a) ? this.Kc(a, b) : 'string' === typeof a ? (a = so(a), Yo(this, a, b)) : [];
    };
    function Yo(a, b, c) {
        var d = [];
        for (b = b.firstChild; b; b = b.nextSibling)
            b.nodeType == Node.ELEMENT_NODE && gc(d, a.Kc(b, c));
        return d;
    }
    k.ed = function (a, b) {
        if (qo(a))
            return null;
        if (ro(a))
            return this.vj(a, b);
        'string' === typeof a && so(a);
        return null;
    };
    k.vj = function () {
        return null;
    };
    k.sb = function (a) {
        return qo(a) ? this.Sg(a) : ro(a) ? this.uf(a) : 'string' === typeof a ? (a = so(a), this.Sg(a)) : null;
    };
    k.Sg = function () {
        return this.defaultDataProjection;
    };
    k.uf = function () {
        return this.defaultDataProjection;
    };
    k.Jd = function () {
        return this.g.serializeToString(this.mh());
    };
    k.mh = function () {
        return null;
    };
    k.ac = function (a, b) {
        a = this.bc(a, b);
        return this.g.serializeToString(a);
    };
    k.bc = function () {
        return null;
    };
    k.md = function (a, b) {
        a = this.re(a, b);
        return this.g.serializeToString(a);
    };
    k.re = function () {
        return null;
    };
    function Zo(a) {
        a = a ? a : {};
        this.featureType = a.featureType;
        this.featureNS = a.featureNS;
        this.srsName = a.srsName;
        this.schemaLocation = '';
        this.b = {};
        this.b['http://www.opengis.net/gml'] = {
            featureMember: vo(Zo.prototype.ge),
            featureMembers: vo(Zo.prototype.ge)
        };
        Wo.call(this);
    }
    w(Zo, Wo);
    var $o = /^[\s\xa0]*$/;
    k = Zo.prototype;
    k.ge = function (a, b) {
        var c = a.localName, d = null;
        if ('FeatureCollection' == c)
            'http://www.opengis.net/wfs' === a.namespaceURI ? d = O([], this.b, a, b, this) : d = O(null, this.b, a, b, this);
        else if ('featureMembers' == c || 'featureMember' == c) {
            var e = b[0], f = e.featureType, g = e.featureNS, h;
            if (!f && a.childNodes) {
                f = [];
                g = {};
                var l = 0;
                for (h = a.childNodes.length; l < h; ++l) {
                    var m = a.childNodes[l];
                    if (1 === m.nodeType) {
                        var n = m.nodeName.split(':').pop();
                        if (-1 === f.indexOf(n)) {
                            var p = '', q = 0;
                            m = m.namespaceURI;
                            for (var r in g) {
                                if (g[r] === m) {
                                    p = r;
                                    break;
                                }
                                ++q;
                            }
                            p || (p = 'p' + q, g[p] = m);
                            f.push(p + ':' + n);
                        }
                    }
                }
                'featureMember' != c && (e.featureType = f, e.featureNS = g);
            }
            'string' === typeof g && (l = g, g = {}, g.p0 = l);
            e = {};
            f = Array.isArray(f) ? f : [f];
            for (var u in g) {
                n = {};
                l = 0;
                for (h = f.length; l < h; ++l)
                    (-1 === f[l].indexOf(':') ? 'p0' : f[l].split(':')[0]) === u && (n[f[l].split(':').pop()] = 'featureMembers' == c ? uo(this.Kg, this) : vo(this.Kg, this));
                e[g[u]] = n;
            }
            'featureMember' == c ? d = O(void 0, e, a, b) : d = O([], e, a, b);
        }
        null === d && (d = []);
        return d;
    };
    k.rf = function (a, b) {
        var c = b[0];
        c.srsName = a.firstElementChild.getAttribute('srsName');
        c.srsDimension = a.firstElementChild.getAttribute('srsDimension');
        if (a = O(null, this.qh, a, b, this))
            return Jo(a, !1, c);
    };
    k.Kg = function (a, b) {
        var c;
        (c = a.getAttribute('fid')) || (c = a.getAttributeNS('http://www.opengis.net/gml', 'id') || '');
        var d = {}, e;
        for (a = a.firstElementChild; a; a = a.nextElementSibling) {
            var f = a.localName;
            if (0 === a.childNodes.length || 1 === a.childNodes.length && (3 === a.firstChild.nodeType || 4 === a.firstChild.nodeType)) {
                var g = oo(a, !1);
                $o.test(g) && (g = void 0);
                d[f] = g;
            } else
                'boundedBy' !== f && (e = f), d[f] = this.rf(a, b);
        }
        b = new Hk(d);
        e && b.Lc(e);
        c && b.qc(c);
        return b;
    };
    k.Aj = function (a, b) {
        if (a = this.qf(a, b))
            return b = new C(null), b.ba('XYZ', a), b;
    };
    k.yj = function (a, b) {
        if (a = O([], this.kk, a, b, this))
            return new No(a);
    };
    k.xj = function (a, b) {
        if (a = O([], this.jk, a, b, this))
            return b = new P(null), Mo(b, a), b;
    };
    k.zj = function (a, b) {
        if (a = O([], this.lk, a, b, this))
            return b = new Q(null), Oo(b, a), b;
    };
    k.qj = function (a, b) {
        Co(this.pk, a, b, this);
    };
    k.fi = function (a, b) {
        Co(this.hk, a, b, this);
    };
    k.rj = function (a, b) {
        Co(this.qk, a, b, this);
    };
    k.sf = function (a, b) {
        if (a = this.qf(a, b))
            return b = new I(null), b.ba('XYZ', a), b;
    };
    k.Xp = function (a, b) {
        if (a = O(null, this.te, a, b, this))
            return a;
    };
    k.wj = function (a, b) {
        if (a = this.qf(a, b))
            return b = new Df(null), Ef(b, 'XYZ', a), b;
    };
    k.tf = function (a, b) {
        if ((a = O([null], this.Gf, a, b, this)) && a[0]) {
            b = new D(null);
            var c = a[0], d = [c.length], e;
            var f = 1;
            for (e = a.length; f < e; ++f)
                gc(c, a[f]), d.push(c.length);
            b.ba('XYZ', c, d);
            return b;
        }
    };
    k.qf = function (a, b) {
        return O(null, this.te, a, b, this);
    };
    k.kk = {
        'http://www.opengis.net/gml': {
            pointMember: uo(Zo.prototype.qj),
            pointMembers: uo(Zo.prototype.qj)
        }
    };
    k.jk = {
        'http://www.opengis.net/gml': {
            lineStringMember: uo(Zo.prototype.fi),
            lineStringMembers: uo(Zo.prototype.fi)
        }
    };
    k.lk = {
        'http://www.opengis.net/gml': {
            polygonMember: uo(Zo.prototype.rj),
            polygonMembers: uo(Zo.prototype.rj)
        }
    };
    k.pk = { 'http://www.opengis.net/gml': { Point: uo(Zo.prototype.qf) } };
    k.hk = { 'http://www.opengis.net/gml': { LineString: uo(Zo.prototype.sf) } };
    k.qk = { 'http://www.opengis.net/gml': { Polygon: uo(Zo.prototype.tf) } };
    k.ue = { 'http://www.opengis.net/gml': { LinearRing: vo(Zo.prototype.Xp) } };
    k.vj = function (a, b) {
        return (a = this.rf(a, [Ho(this, a, b ? b : {})])) ? a : null;
    };
    k.Kc = function (a, b) {
        var c = {
            featureType: this.featureType,
            featureNS: this.featureNS
        };
        b && kb(c, Ho(this, a, b));
        return this.ge(a, [c]) || [];
    };
    k.uf = function (a) {
        return Ob(this.srsName ? this.srsName : a.firstElementChild.getAttribute('srsName'));
    };
    function ap(a) {
        a = oo(a, !1);
        return bp(a);
    }
    function bp(a) {
        if (a = /^\s*(true|1)|(false|0)\s*$/.exec(a))
            return void 0 !== a[1] || !1;
    }
    function cp(a) {
        a = oo(a, !1);
        a = Date.parse(a);
        return isNaN(a) ? void 0 : a / 1000;
    }
    function dp(a) {
        a = oo(a, !1);
        return ep(a);
    }
    function ep(a) {
        if (a = /^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(a))
            return parseFloat(a[1]);
    }
    function fp(a) {
        a = oo(a, !1);
        return gp(a);
    }
    function gp(a) {
        if (a = /^\s*(\d+)\s*$/.exec(a))
            return parseInt(a[1], 10);
    }
    function R(a) {
        return oo(a, !1).trim();
    }
    function hp(a, b) {
        ip(a, b ? '1' : '0');
    }
    function Ip(a, b) {
        a.appendChild(mo.createTextNode(b.toPrecision()));
    }
    function Jp(a, b) {
        a.appendChild(mo.createTextNode(b.toString()));
    }
    function ip(a, b) {
        a.appendChild(mo.createTextNode(b));
    }
    function Kp(a) {
        a = a ? a : {};
        Zo.call(this, a);
        this.s = void 0 !== a.surface ? a.surface : !1;
        this.c = void 0 !== a.curve ? a.curve : !1;
        this.f = void 0 !== a.multiCurve ? a.multiCurve : !0;
        this.j = void 0 !== a.multiSurface ? a.multiSurface : !0;
        this.schemaLocation = a.schemaLocation ? a.schemaLocation : 'http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd';
        this.hasZ = void 0 !== a.hasZ ? a.hasZ : !1;
    }
    w(Kp, Zo);
    k = Kp.prototype;
    k.aq = function (a, b) {
        if (a = O([], this.ik, a, b, this))
            return b = new P(null), Mo(b, a), b;
    };
    k.bq = function (a, b) {
        if (a = O([], this.mk, a, b, this))
            return b = new Q(null), Oo(b, a), b;
    };
    k.Gh = function (a, b) {
        Co(this.ek, a, b, this);
    };
    k.Xj = function (a, b) {
        Co(this.sk, a, b, this);
    };
    k.fq = function (a, b) {
        return O([null], this.nk, a, b, this);
    };
    k.iq = function (a, b) {
        return O([null], this.rk, a, b, this);
    };
    k.gq = function (a, b) {
        return O([null], this.Gf, a, b, this);
    };
    k.$p = function (a, b) {
        return O([null], this.te, a, b, this);
    };
    k.Fm = function (a, b) {
        (a = O(void 0, this.ue, a, b, this)) && b[b.length - 1].push(a);
    };
    k.Zk = function (a, b) {
        (a = O(void 0, this.ue, a, b, this)) && (b[b.length - 1][0] = a);
    };
    k.Bj = function (a, b) {
        if ((a = O([null], this.tk, a, b, this)) && a[0]) {
            b = new D(null);
            var c = a[0], d = [c.length], e;
            var f = 1;
            for (e = a.length; f < e; ++f)
                gc(c, a[f]), d.push(c.length);
            b.ba('XYZ', c, d);
            return b;
        }
    };
    k.tj = function (a, b) {
        if (a = O([null], this.fk, a, b, this))
            return b = new I(null), b.ba('XYZ', a), b;
    };
    k.Wp = function (a, b) {
        a = O([null], this.gk, a, b, this);
        return Na(a[1][0], a[1][1], a[2][0], a[2][1]);
    };
    k.Yp = function (a, b) {
        var c = oo(a, !1), d = /^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/;
        a = [];
        for (var e; e = d.exec(c);)
            a.push(parseFloat(e[1])), c = c.substr(e[0].length);
        if ('' === c) {
            b = b[0].srsName;
            c = 'enu';
            b && (c = Ob(b).b);
            if ('neu' === c)
                for (b = 0, c = a.length; b < c; b += 3)
                    d = a[b], a[b] = a[b + 1], a[b + 1] = d;
            b = a.length;
            2 == b && a.push(0);
            if (0 !== b)
                return a;
        }
    };
    k.Pg = function (a, b) {
        var c = oo(a, !1).replace(/^\s*|\s*$/g, '');
        b = b[0];
        var d = b.srsName, e = b.srsDimension;
        b = 'enu';
        d && (b = Ob(d).b);
        c = c.split(/\s+/);
        d = 2;
        a.getAttribute('srsDimension') ? d = gp(a.getAttribute('srsDimension')) : a.getAttribute('dimension') ? d = gp(a.getAttribute('dimension')) : a.parentNode.getAttribute('srsDimension') ? d = gp(a.parentNode.getAttribute('srsDimension')) : e && (d = gp(e));
        for (var f, g = [], h = 0, l = c.length; h < l; h += d)
            a = parseFloat(c[h]), e = parseFloat(c[h + 1]), f = 3 === d ? parseFloat(c[h + 2]) : 0, 'en' === b.substr(0, 2) ? g.push(a, e, f) : g.push(e, a, f);
        return g;
    };
    k.te = {
        'http://www.opengis.net/gml': {
            pos: vo(Kp.prototype.Yp),
            posList: vo(Kp.prototype.Pg)
        }
    };
    k.Gf = {
        'http://www.opengis.net/gml': {
            interior: Kp.prototype.Fm,
            exterior: Kp.prototype.Zk
        }
    };
    k.qh = {
        'http://www.opengis.net/gml': {
            Point: vo(Zo.prototype.Aj),
            MultiPoint: vo(Zo.prototype.yj),
            LineString: vo(Zo.prototype.sf),
            MultiLineString: vo(Zo.prototype.xj),
            LinearRing: vo(Zo.prototype.wj),
            Polygon: vo(Zo.prototype.tf),
            MultiPolygon: vo(Zo.prototype.zj),
            Surface: vo(Kp.prototype.Bj),
            MultiSurface: vo(Kp.prototype.bq),
            Curve: vo(Kp.prototype.tj),
            MultiCurve: vo(Kp.prototype.aq),
            Envelope: vo(Kp.prototype.Wp)
        }
    };
    k.ik = {
        'http://www.opengis.net/gml': {
            curveMember: uo(Kp.prototype.Gh),
            curveMembers: uo(Kp.prototype.Gh)
        }
    };
    k.mk = {
        'http://www.opengis.net/gml': {
            surfaceMember: uo(Kp.prototype.Xj),
            surfaceMembers: uo(Kp.prototype.Xj)
        }
    };
    k.ek = {
        'http://www.opengis.net/gml': {
            LineString: uo(Zo.prototype.sf),
            Curve: uo(Kp.prototype.tj)
        }
    };
    k.sk = {
        'http://www.opengis.net/gml': {
            Polygon: uo(Zo.prototype.tf),
            Surface: uo(Kp.prototype.Bj)
        }
    };
    k.tk = { 'http://www.opengis.net/gml': { patches: vo(Kp.prototype.fq) } };
    k.fk = { 'http://www.opengis.net/gml': { segments: vo(Kp.prototype.iq) } };
    k.gk = {
        'http://www.opengis.net/gml': {
            lowerCorner: uo(Kp.prototype.Pg),
            upperCorner: uo(Kp.prototype.Pg)
        }
    };
    k.nk = { 'http://www.opengis.net/gml': { PolygonPatch: vo(Kp.prototype.gq) } };
    k.rk = { 'http://www.opengis.net/gml': { LineStringSegment: vo(Kp.prototype.$p) } };
    function Lp(a, b, c) {
        var d = c[c.length - 1];
        c = d.hasZ;
        a.setAttribute('srsDimension', c ? 3 : 2);
        d = d.srsName;
        b = b.W();
        for (var e = b.length, f = Array(e), g, h = 0; h < e; ++h) {
            g = b[h];
            var l = h, m = c, n = 'enu';
            d && (n = Ob(d).b);
            n = 'en' === n.substr(0, 2) ? g[0] + ' ' + g[1] : g[1] + ' ' + g[0];
            m && (n += ' ' + (g[2] || 0));
            f[l] = n;
        }
        ip(a, f.join(' '));
    }
    k.Hi = function (a, b, c) {
        var d = c[c.length - 1].srsName;
        d && a.setAttribute('srsName', d);
        d = no(a.namespaceURI, 'pos');
        a.appendChild(d);
        c = c[c.length - 1];
        a = c.hasZ;
        d.setAttribute('srsDimension', a ? 3 : 2);
        var e = c.srsName;
        c = 'enu';
        e && (c = Ob(e).b);
        b = b.W();
        c = 'en' === c.substr(0, 2) ? b[0] + ' ' + b[1] : b[1] + ' ' + b[0];
        a && (c += ' ' + (b[2] || 0));
        ip(d, c);
    };
    var Mp = {
        'http://www.opengis.net/gml': {
            lowerCorner: M(ip),
            upperCorner: M(ip)
        }
    };
    k = Kp.prototype;
    k.Pn = function (a, b, c) {
        var d = c[c.length - 1].srsName;
        d && a.setAttribute('srsName', d);
        Do({ node: a }, Mp, Ao, [
            b[0] + ' ' + b[1],
            b[2] + ' ' + b[3]
        ], c, [
            'lowerCorner',
            'upperCorner'
        ], this);
    };
    k.Ei = function (a, b, c) {
        var d = c[c.length - 1].srsName;
        d && a.setAttribute('srsName', d);
        d = no(a.namespaceURI, 'posList');
        a.appendChild(d);
        Lp(d, b, c);
    };
    k.On = function (a, b) {
        a = b[b.length - 1];
        b = a.node;
        var c = a.exteriorWritten;
        void 0 === c && (a.exteriorWritten = !0);
        return no(b.namespaceURI, void 0 !== c ? 'interior' : 'exterior');
    };
    k.af = function (a, b, c) {
        var d = c[c.length - 1], e = d.hasZ;
        d = d.srsName;
        'PolygonPatch' !== a.nodeName && d && a.setAttribute('srsName', d);
        'Polygon' === a.nodeName || 'PolygonPatch' === a.nodeName ? (b = b.Ud(), Do({
            node: a,
            hasZ: e,
            srsName: d
        }, Np, this.On, b, c, void 0, this)) : 'Surface' === a.nodeName && (e = no(a.namespaceURI, 'patches'), a.appendChild(e), a = no(e.namespaceURI, 'PolygonPatch'), e.appendChild(a), this.af(a, b, c));
    };
    k.$e = function (a, b, c) {
        var d = c[c.length - 1].srsName;
        'LineStringSegment' !== a.nodeName && d && a.setAttribute('srsName', d);
        'LineString' === a.nodeName || 'LineStringSegment' === a.nodeName ? (d = no(a.namespaceURI, 'posList'), a.appendChild(d), Lp(d, b, c)) : 'Curve' === a.nodeName && (d = no(a.namespaceURI, 'segments'), a.appendChild(d), a = no(d.namespaceURI, 'LineStringSegment'), d.appendChild(a), this.$e(a, b, c));
    };
    k.Gi = function (a, b, c) {
        var d = c[c.length - 1], e = d.hasZ, f = d.srsName;
        d = d.surface;
        f && a.setAttribute('srsName', f);
        b = b.Vd();
        Do({
            node: a,
            hasZ: e,
            srsName: f,
            surface: d
        }, Op, this.l, b, c, void 0, this);
    };
    k.Qn = function (a, b, c) {
        var d = c[c.length - 1], e = d.srsName;
        d = d.hasZ;
        e && a.setAttribute('srsName', e);
        b = b.de();
        Do({
            node: a,
            hasZ: d,
            srsName: e
        }, Pp, yo('pointMember'), b, c, void 0, this);
    };
    k.Fi = function (a, b, c) {
        var d = c[c.length - 1], e = d.hasZ, f = d.srsName;
        d = d.curve;
        f && a.setAttribute('srsName', f);
        b = b.wd();
        Do({
            node: a,
            hasZ: e,
            srsName: f,
            curve: d
        }, Qp, this.l, b, c, void 0, this);
    };
    k.Ii = function (a, b, c) {
        var d = no(a.namespaceURI, 'LinearRing');
        a.appendChild(d);
        this.Ei(d, b, c);
    };
    k.Ji = function (a, b, c) {
        var d = this.a(b, c);
        d && (a.appendChild(d), this.af(d, b, c));
    };
    k.Rn = function (a, b, c) {
        var d = no(a.namespaceURI, 'Point');
        a.appendChild(d);
        this.Hi(d, b, c);
    };
    k.Di = function (a, b, c) {
        var d = this.a(b, c);
        d && (a.appendChild(d), this.$e(d, b, c));
    };
    k.Yc = function (a, b, c) {
        var d = c[c.length - 1], e = kb({}, d);
        e.node = a;
        var f;
        Array.isArray(b) ? d.dataProjection ? f = bc(b, d.featureProjection, d.dataProjection) : f = b : f = Jo(b, !0, d);
        Do(e, Rp, this.a, [f], c, void 0, this);
    };
    k.Ci = function (a, b, c) {
        var d = b.c;
        d && a.setAttribute('fid', d);
        d = c[c.length - 1];
        var e = d.featureNS, f = b.a;
        d.tb || (d.tb = {}, d.tb[e] = {});
        var g = b.L();
        b = [];
        var h = [];
        for (m in g) {
            var l = g[m];
            null !== l && (b.push(m), h.push(l), m == f || l instanceof gf ? m in d.tb[e] || (d.tb[e][m] = M(this.Yc, this)) : m in d.tb[e] || (d.tb[e][m] = M(ip)));
        }
        var m = kb({}, d);
        m.node = a;
        Do(m, d.tb, yo(void 0, e), h, c, b);
    };
    var Op = {
            'http://www.opengis.net/gml': {
                surfaceMember: M(Kp.prototype.Ji),
                polygonMember: M(Kp.prototype.Ji)
            }
        }, Pp = { 'http://www.opengis.net/gml': { pointMember: M(Kp.prototype.Rn) } }, Qp = {
            'http://www.opengis.net/gml': {
                lineStringMember: M(Kp.prototype.Di),
                curveMember: M(Kp.prototype.Di)
            }
        }, Np = {
            'http://www.opengis.net/gml': {
                exterior: M(Kp.prototype.Ii),
                interior: M(Kp.prototype.Ii)
            }
        }, Rp = {
            'http://www.opengis.net/gml': {
                Curve: M(Kp.prototype.$e),
                MultiCurve: M(Kp.prototype.Fi),
                Point: M(Kp.prototype.Hi),
                MultiPoint: M(Kp.prototype.Qn),
                LineString: M(Kp.prototype.$e),
                MultiLineString: M(Kp.prototype.Fi),
                LinearRing: M(Kp.prototype.Ei),
                Polygon: M(Kp.prototype.af),
                MultiPolygon: M(Kp.prototype.Gi),
                Surface: M(Kp.prototype.af),
                MultiSurface: M(Kp.prototype.Gi),
                Envelope: M(Kp.prototype.Pn)
            }
        }, Sp = {
            MultiLineString: 'lineStringMember',
            MultiCurve: 'curveMember',
            MultiPolygon: 'polygonMember',
            MultiSurface: 'surfaceMember'
        };
    Kp.prototype.l = function (a, b) {
        return no('http://www.opengis.net/gml', Sp[b[b.length - 1].node.nodeName]);
    };
    Kp.prototype.a = function (a, b) {
        var c = b[b.length - 1];
        b = c.multiSurface;
        var d = c.surface, e = c.curve;
        c = c.multiCurve;
        Array.isArray(a) ? a = 'Envelope' : (a = a.S(), 'MultiPolygon' === a && !0 === b ? a = 'MultiSurface' : 'Polygon' === a && !0 === d ? a = 'Surface' : 'LineString' === a && !0 === e ? a = 'Curve' : 'MultiLineString' === a && !0 === c && (a = 'MultiCurve'));
        return no('http://www.opengis.net/gml', a);
    };
    Kp.prototype.re = function (a, b) {
        b = Io(this, b);
        var c = no('http://www.opengis.net/gml', 'geom'), d = {
                node: c,
                hasZ: this.hasZ,
                srsName: this.srsName,
                curve: this.c,
                surface: this.s,
                multiSurface: this.j,
                multiCurve: this.f
            };
        b && kb(d, b);
        this.Yc(c, a, [d]);
        return c;
    };
    Kp.prototype.bc = function (a, b) {
        b = Io(this, b);
        var c = no('http://www.opengis.net/gml', 'featureMembers');
        c.setAttributeNS('http://www.w3.org/2001/XMLSchema-instance', 'xsi:schemaLocation', this.schemaLocation);
        var d = {
            srsName: this.srsName,
            hasZ: this.hasZ,
            curve: this.c,
            surface: this.s,
            multiSurface: this.j,
            multiCurve: this.f,
            featureNS: this.featureNS,
            featureType: this.featureType
        };
        b && kb(d, b);
        b = [d];
        var e = b[b.length - 1];
        d = e.featureType;
        var f = e.featureNS, g = {};
        g[f] = {};
        g[f][d] = M(this.Ci, this);
        e = kb({}, e);
        e.node = c;
        Do(e, g, yo(d, f), a, b);
        return c;
    };
    function Tp(a) {
        a = a ? a : {};
        Zo.call(this, a);
        this.b['http://www.opengis.net/gml'].featureMember = uo(Zo.prototype.ge);
        this.schemaLocation = a.schemaLocation ? a.schemaLocation : 'http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd';
    }
    w(Tp, Zo);
    k = Tp.prototype;
    k.uj = function (a, b) {
        a = oo(a, !1).replace(/^\s*|\s*$/g, '');
        var c = b[0].srsName;
        b = 'enu';
        c && (c = Ob(c)) && (b = c.b);
        a = a.trim().split(/\s+/);
        for (var d, e, f = [], g = 0, h = a.length; g < h; g++)
            e = a[g].split(/,+/), c = parseFloat(e[0]), d = parseFloat(e[1]), e = 3 === e.length ? parseFloat(e[2]) : 0, 'en' === b.substr(0, 2) ? f.push(c, d, e) : f.push(d, c, e);
        return f;
    };
    k.Up = function (a, b) {
        a = O([null], this.dk, a, b, this);
        return Na(a[1][0], a[1][1], a[1][3], a[1][4]);
    };
    k.Dm = function (a, b) {
        (a = O(void 0, this.ue, a, b, this)) && b[b.length - 1].push(a);
    };
    k.Ep = function (a, b) {
        (a = O(void 0, this.ue, a, b, this)) && (b[b.length - 1][0] = a);
    };
    k.te = { 'http://www.opengis.net/gml': { coordinates: vo(Tp.prototype.uj) } };
    k.Gf = {
        'http://www.opengis.net/gml': {
            innerBoundaryIs: Tp.prototype.Dm,
            outerBoundaryIs: Tp.prototype.Ep
        }
    };
    k.dk = { 'http://www.opengis.net/gml': { coordinates: uo(Tp.prototype.uj) } };
    k.qh = {
        'http://www.opengis.net/gml': {
            Point: vo(Zo.prototype.Aj),
            MultiPoint: vo(Zo.prototype.yj),
            LineString: vo(Zo.prototype.sf),
            MultiLineString: vo(Zo.prototype.xj),
            LinearRing: vo(Zo.prototype.wj),
            Polygon: vo(Zo.prototype.tf),
            MultiPolygon: vo(Zo.prototype.zj),
            Box: vo(Tp.prototype.Up)
        }
    };
    k.wg = function (a, b) {
        var c = b[b.length - 1];
        b = c.multiSurface;
        var d = c.surface;
        c = c.multiCurve;
        Array.isArray(a) ? a = 'Envelope' : (a = a.S(), 'MultiPolygon' === a && !0 === b ? a = 'MultiSurface' : 'Polygon' === a && !0 === d ? a = 'Surface' : 'MultiLineString' === a && !0 === c && (a = 'MultiCurve'));
        return no('http://www.opengis.net/gml', a);
    };
    k.ui = function (a, b, c) {
        var d = c[c.length - 1], e = kb({}, d);
        e.node = a;
        var f;
        Array.isArray(b) ? d.dataProjection ? f = bc(b, d.featureProjection, d.dataProjection) : f = b : f = Jo(b, !0, d);
        Do(e, Up, this.wg, [f], c, void 0, this);
    };
    k.Ye = function (a, b, c) {
        var d = c[c.length - 1].srsName;
        'LineStringSegment' !== a.nodeName && d && a.setAttribute('srsName', d);
        'LineString' === a.nodeName || 'LineStringSegment' === a.nodeName ? (d = Vp(a.namespaceURI), a.appendChild(d), Wp(d, b, c)) : 'Curve' === a.nodeName && (d = no(a.namespaceURI, 'segments'), a.appendChild(d), a = no(d.namespaceURI, 'LineStringSegment'), d.appendChild(a), this.Ye(a, b, c));
    };
    function Vp(a) {
        a = no(a, 'coordinates');
        a.setAttribute('decimal', '.');
        a.setAttribute('cs', ',');
        a.setAttribute('ts', ' ');
        return a;
    }
    function Wp(a, b, c) {
        var d = c[c.length - 1];
        c = d.hasZ;
        d = d.srsName;
        b = b.W();
        for (var e = b.length, f = Array(e), g, h = 0; h < e; ++h)
            g = b[h], f[h] = Xp(g, d, c);
        ip(a, f.join(' '));
    }
    k.Ze = function (a, b, c) {
        var d = c[c.length - 1], e = d.hasZ;
        d = d.srsName;
        'PolygonPatch' !== a.nodeName && d && a.setAttribute('srsName', d);
        'Polygon' === a.nodeName || 'PolygonPatch' === a.nodeName ? (b = b.Ud(), Do({
            node: a,
            hasZ: e,
            srsName: d
        }, Yp, this.Kn, b, c, void 0, this)) : 'Surface' === a.nodeName && (e = no(a.namespaceURI, 'patches'), a.appendChild(e), a = no(e.namespaceURI, 'PolygonPatch'), e.appendChild(a), this.Ze(a, b, c));
    };
    k.Kn = function (a, b) {
        a = b[b.length - 1];
        b = a.node;
        var c = a.exteriorWritten;
        void 0 === c && (a.exteriorWritten = !0);
        return no(b.namespaceURI, void 0 !== c ? 'innerBoundaryIs' : 'outerBoundaryIs');
    };
    k.Ai = function (a, b, c) {
        var d = no(a.namespaceURI, 'LinearRing');
        a.appendChild(d);
        this.wi(d, b, c);
    };
    function Xp(a, b, c) {
        var d = 'enu';
        b && (d = Ob(b).b);
        b = 'en' === d.substr(0, 2) ? a[0] + ',' + a[1] : a[1] + ',' + a[0];
        c && (b += ',' + (a[2] || 0));
        return b;
    }
    k.xi = function (a, b, c) {
        var d = c[c.length - 1], e = d.hasZ, f = d.srsName;
        d = d.curve;
        f && a.setAttribute('srsName', f);
        b = b.wd();
        Do({
            node: a,
            hasZ: e,
            srsName: f,
            curve: d
        }, Zp, this.a, b, c, void 0, this);
    };
    k.zi = function (a, b, c) {
        var d = c[c.length - 1];
        c = d.hasZ;
        var e = d.srsName;
        e && a.setAttribute('srsName', e);
        d = Vp(a.namespaceURI);
        a.appendChild(d);
        a = b.W();
        a = Xp(a, e, c);
        ip(d, a);
    };
    k.Mn = function (a, b, c) {
        var d = c[c.length - 1], e = d.hasZ;
        (d = d.srsName) && a.setAttribute('srsName', d);
        b = b.de();
        Do({
            node: a,
            hasZ: e,
            srsName: d
        }, $p, yo('pointMember'), b, c, void 0, this);
    };
    k.Nn = function (a, b, c) {
        var d = no(a.namespaceURI, 'Point');
        a.appendChild(d);
        this.zi(d, b, c);
    };
    k.vi = function (a, b, c) {
        var d = this.wg(b, c);
        d && (a.appendChild(d), this.Ye(d, b, c));
    };
    k.wi = function (a, b, c) {
        var d = c[c.length - 1].srsName;
        d && a.setAttribute('srsName', d);
        d = Vp(a.namespaceURI);
        a.appendChild(d);
        Wp(d, b, c);
    };
    k.yi = function (a, b, c) {
        var d = c[c.length - 1], e = d.hasZ, f = d.srsName;
        d = d.surface;
        f && a.setAttribute('srsName', f);
        b = b.Vd();
        Do({
            node: a,
            hasZ: e,
            srsName: f,
            surface: d
        }, aq, this.a, b, c, void 0, this);
    };
    k.Bi = function (a, b, c) {
        var d = this.wg(b, c);
        d && (a.appendChild(d), this.Ze(d, b, c));
    };
    k.Ln = function (a, b, c) {
        var d = c[c.length - 1].srsName;
        d && a.setAttribute('srsName', d);
        Do({ node: a }, bq, Ao, [
            b[0] + ' ' + b[1],
            b[2] + ' ' + b[3]
        ], c, [
            'lowerCorner',
            'upperCorner'
        ], this);
    };
    var Up = {
            'http://www.opengis.net/gml': {
                Curve: M(Tp.prototype.Ye),
                MultiCurve: M(Tp.prototype.xi),
                Point: M(Tp.prototype.zi),
                MultiPoint: M(Tp.prototype.Mn),
                LineString: M(Tp.prototype.Ye),
                MultiLineString: M(Tp.prototype.xi),
                LinearRing: M(Tp.prototype.wi),
                Polygon: M(Tp.prototype.Ze),
                MultiPolygon: M(Tp.prototype.yi),
                Surface: M(Tp.prototype.Ze),
                MultiSurface: M(Tp.prototype.yi),
                Envelope: M(Tp.prototype.Ln)
            }
        }, Yp = {
            'http://www.opengis.net/gml': {
                outerBoundaryIs: M(Tp.prototype.Ai),
                innerBoundaryIs: M(Tp.prototype.Ai)
            }
        }, $p = { 'http://www.opengis.net/gml': { pointMember: M(Tp.prototype.Nn) } }, Zp = {
            'http://www.opengis.net/gml': {
                lineStringMember: M(Tp.prototype.vi),
                curveMember: M(Tp.prototype.vi)
            }
        };
    Tp.prototype.a = function (a, b) {
        return no('http://www.opengis.net/gml', cq[b[b.length - 1].node.nodeName]);
    };
    var cq = {
            MultiLineString: 'lineStringMember',
            MultiCurve: 'curveMember',
            MultiPolygon: 'polygonMember',
            MultiSurface: 'surfaceMember'
        }, aq = {
            'http://www.opengis.net/gml': {
                surfaceMember: M(Tp.prototype.Bi),
                polygonMember: M(Tp.prototype.Bi)
            }
        }, bq = {
            'http://www.opengis.net/gml': {
                lowerCorner: M(ip),
                upperCorner: M(ip)
            }
        };
    function dq(a) {
        a = a ? a : {};
        Wo.call(this);
        this.defaultDataProjection = Ob('EPSG:4326');
        this.b = a.readExtensions;
    }
    w(dq, Wo);
    var eq = [
        null,
        'http://www.topografix.com/GPX/1/0',
        'http://www.topografix.com/GPX/1/1'
    ];
    function fq(a, b, c, d) {
        a.push(parseFloat(c.getAttribute('lon')), parseFloat(c.getAttribute('lat')));
        'ele' in d ? (a.push(d.ele), delete d.ele, b.hasZ = !0) : a.push(0);
        'time' in d ? (a.push(d.time), delete d.time, b.hasM = !0) : a.push(0);
        return a;
    }
    function gq(a, b, c) {
        var d = 'XY', e = 2;
        a.hasZ && a.hasM ? (d = 'XYZM', e = 4) : a.hasZ ? (d = 'XYZ', e = 3) : a.hasM && (d = 'XYM', e = 3);
        if (4 !== e) {
            var f;
            var g = 0;
            for (f = b.length / 4; g < f; g++)
                b[g * e] = b[4 * g], b[g * e + 1] = b[4 * g + 1], a.hasZ && (b[g * e + 2] = b[4 * g + 2]), a.hasM && (b[g * e + 2] = b[4 * g + 3]);
            b.length = b.length / 4 * e;
            if (c)
                for (g = 0, f = c.length; g < f; g++)
                    c[g] = c[g] / 4 * e;
        }
        return d;
    }
    function hq(a, b) {
        var c = b[b.length - 1], d = a.getAttribute('href');
        null !== d && (c.link = d);
        Co(iq, a, b);
    }
    function jq(a, b) {
        b[b.length - 1].extensionsNode_ = a;
    }
    function kq(a, b) {
        var c = b[0];
        if (a = O({
                flatCoordinates: [],
                layoutOptions: {}
            }, lq, a, b)) {
            b = a.flatCoordinates;
            delete a.flatCoordinates;
            var d = a.layoutOptions;
            delete a.layoutOptions;
            d = gq(d, b);
            var e = new I(null);
            e.ba(d, b);
            Jo(e, !1, c);
            c = new Hk(e);
            c.H(a);
            return c;
        }
    }
    function mq(a, b) {
        var c = b[0];
        if (a = O({
                flatCoordinates: [],
                ends: [],
                layoutOptions: {}
            }, nq, a, b)) {
            b = a.flatCoordinates;
            delete a.flatCoordinates;
            var d = a.ends;
            delete a.ends;
            var e = a.layoutOptions;
            delete a.layoutOptions;
            e = gq(e, b, d);
            var f = new P(null);
            f.ba(e, b, d);
            Jo(f, !1, c);
            c = new Hk(f);
            c.H(a);
            return c;
        }
    }
    function oq(a, b) {
        var c = b[0];
        if (b = O({}, pq, a, b)) {
            var d = {};
            a = fq([], d, a, b);
            d = gq(d, a);
            a = new C(a, d);
            Jo(a, !1, c);
            c = new Hk(a);
            c.H(b);
            return c;
        }
    }
    var qq = {
            rte: kq,
            trk: mq,
            wpt: oq
        }, rq = N(eq, {
            rte: uo(kq),
            trk: uo(mq),
            wpt: uo(oq)
        }), iq = N(eq, {
            text: L(R, 'linkText'),
            type: L(R, 'linkType')
        }), lq = N(eq, {
            name: L(R),
            cmt: L(R),
            desc: L(R),
            src: L(R),
            link: hq,
            number: L(fp),
            extensions: jq,
            type: L(R),
            rtept: function (a, b) {
                var c = O({}, sq, a, b);
                c && (b = b[b.length - 1], fq(b.flatCoordinates, b.layoutOptions, a, c));
            }
        }), sq = N(eq, {
            ele: L(dp),
            time: L(cp)
        }), nq = N(eq, {
            name: L(R),
            cmt: L(R),
            desc: L(R),
            src: L(R),
            link: hq,
            number: L(fp),
            type: L(R),
            extensions: jq,
            trkseg: function (a, b) {
                var c = b[b.length - 1];
                Co(tq, a, b);
                c.ends.push(c.flatCoordinates.length);
            }
        }), tq = N(eq, {
            trkpt: function (a, b) {
                var c = O({}, uq, a, b);
                c && (b = b[b.length - 1], fq(b.flatCoordinates, b.layoutOptions, a, c));
            }
        }), uq = N(eq, {
            ele: L(dp),
            time: L(cp)
        }), pq = N(eq, {
            ele: L(dp),
            time: L(cp),
            magvar: L(dp),
            geoidheight: L(dp),
            name: L(R),
            cmt: L(R),
            desc: L(R),
            src: L(R),
            link: hq,
            sym: L(R),
            type: L(R),
            fix: L(R),
            sat: L(fp),
            hdop: L(dp),
            vdop: L(dp),
            pdop: L(dp),
            ageofdgpsdata: L(dp),
            dgpsid: L(fp),
            extensions: jq
        });
    function vq(a, b) {
        b || (b = []);
        for (var c = 0, d = b.length; c < d; ++c) {
            var e = b[c];
            if (a.b) {
                var f = e.get('extensionsNode_') || null;
                a.b(e, f);
            }
            e.set('extensionsNode_', void 0);
        }
    }
    dq.prototype.Lg = function (a, b) {
        if (!ec(eq, a.namespaceURI))
            return null;
        var c = qq[a.localName];
        if (!c)
            return null;
        a = c(a, [Ho(this, a, b)]);
        if (!a)
            return null;
        vq(this, [a]);
        return a;
    };
    dq.prototype.Kc = function (a, b) {
        return ec(eq, a.namespaceURI) ? 'gpx' == a.localName && (a = O([], rq, a, [Ho(this, a, b)])) ? (vq(this, a), a) : [] : [];
    };
    function wq(a, b, c) {
        a.setAttribute('href', b);
        b = c[c.length - 1].properties;
        Do({ node: a }, xq, Ao, [
            b.linkText,
            b.linkType
        ], c, yq);
    }
    function zq(a, b, c) {
        var d = c[c.length - 1], e = d.node.namespaceURI, f = d.properties;
        a.setAttributeNS(null, 'lat', b[1]);
        a.setAttributeNS(null, 'lon', b[0]);
        switch (d.geometryLayout) {
        case 'XYZM':
            0 !== b[3] && (f.time = b[3]);
        case 'XYZ':
            0 !== b[2] && (f.ele = b[2]);
            break;
        case 'XYM':
            0 !== b[2] && (f.time = b[2]);
        }
        b = 'rtept' == a.nodeName ? Aq[e] : Bq[e];
        d = Bo(f, b);
        Do({
            node: a,
            properties: f
        }, Cq, Ao, d, c, b);
    }
    var yq = [
            'text',
            'type'
        ], xq = N(eq, {
            text: M(ip),
            type: M(ip)
        }), Dq = N(eq, 'name cmt desc src link number type rtept'.split(' ')), Eq = N(eq, {
            name: M(ip),
            cmt: M(ip),
            desc: M(ip),
            src: M(ip),
            link: M(wq),
            number: M(Jp),
            type: M(ip),
            rtept: xo(M(zq))
        }), Aq = N(eq, [
            'ele',
            'time'
        ]), Fq = N(eq, 'name cmt desc src link number type trkseg'.split(' ')), Iq = N(eq, {
            name: M(ip),
            cmt: M(ip),
            desc: M(ip),
            src: M(ip),
            link: M(wq),
            number: M(Jp),
            type: M(ip),
            trkseg: xo(M(function (a, b, c) {
                Do({
                    node: a,
                    geometryLayout: b.ja,
                    properties: {}
                }, Gq, Hq, b.W(), c);
            }))
        }), Hq = yo('trkpt'), Gq = N(eq, { trkpt: M(zq) }), Bq = N(eq, 'ele time magvar geoidheight name cmt desc src link sym type fix sat hdop vdop pdop ageofdgpsdata dgpsid'.split(' ')), Cq = N(eq, {
            ele: M(Ip),
            time: M(function (a, b) {
                b = new Date(1000 * b);
                a.appendChild(mo.createTextNode(b.getUTCFullYear() + '-' + xe(b.getUTCMonth() + 1) + '-' + xe(b.getUTCDate()) + 'T' + xe(b.getUTCHours()) + ':' + xe(b.getUTCMinutes()) + ':' + xe(b.getUTCSeconds()) + 'Z'));
            }),
            magvar: M(Ip),
            geoidheight: M(Ip),
            name: M(ip),
            cmt: M(ip),
            desc: M(ip),
            src: M(ip),
            link: M(wq),
            sym: M(ip),
            type: M(ip),
            fix: M(ip),
            sat: M(Jp),
            hdop: M(Ip),
            vdop: M(Ip),
            pdop: M(Ip),
            ageofdgpsdata: M(Ip),
            dgpsid: M(Jp)
        }), Jq = {
            Point: 'wpt',
            LineString: 'rte',
            MultiLineString: 'trk'
        };
    function Kq(a, b) {
        if (a = a.U())
            if (a = Jq[a.S()])
                return no(b[b.length - 1].node.namespaceURI, a);
    }
    var Lq = N(eq, {
        rte: M(function (a, b, c) {
            var d = c[0], e = b.L();
            a = {
                node: a,
                properties: e
            };
            if (b = b.U())
                b = Jo(b, !0, d), a.geometryLayout = b.ja, e.rtept = b.W();
            d = Dq[c[c.length - 1].node.namespaceURI];
            e = Bo(e, d);
            Do(a, Eq, Ao, e, c, d);
        }),
        trk: M(function (a, b, c) {
            var d = c[0], e = b.L();
            a = {
                node: a,
                properties: e
            };
            if (b = b.U())
                b = Jo(b, !0, d), e.trkseg = b.wd();
            d = Fq[c[c.length - 1].node.namespaceURI];
            e = Bo(e, d);
            Do(a, Iq, Ao, e, c, d);
        }),
        wpt: M(function (a, b, c) {
            var d = c[0], e = c[c.length - 1];
            e.properties = b.L();
            if (b = b.U())
                b = Jo(b, !0, d), e.geometryLayout = b.ja, zq(a, b.W(), c);
        })
    });
    dq.prototype.bc = function (a, b) {
        b = Io(this, b);
        var c = no('http://www.topografix.com/GPX/1/1', 'gpx');
        c.setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns:xsi', 'http://www.w3.org/2001/XMLSchema-instance');
        c.setAttributeNS('http://www.w3.org/2001/XMLSchema-instance', 'xsi:schemaLocation', 'http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd');
        c.setAttribute('version', '1.1');
        c.setAttribute('creator', 'OpenLayers');
        Do({ node: c }, Lq, Kq, a, [b]);
        return c;
    };
    function Mq(a) {
        gf.call(this);
        this.a = a ? a : null;
        Nq(this);
    }
    w(Mq, gf);
    function Oq(a) {
        var b = [], c;
        var d = 0;
        for (c = a.length; d < c; ++d)
            b.push(a[d].clone());
        return b;
    }
    function Pq(a) {
        var b;
        if (a.a) {
            var c = 0;
            for (b = a.a.length; c < b; ++c)
                Mc(a.a[c], 'change', a.u, a);
        }
    }
    function Nq(a) {
        var b;
        if (a.a) {
            var c = 0;
            for (b = a.a.length; c < b; ++c)
                y(a.a[c], 'change', a.u, a);
        }
    }
    k = Mq.prototype;
    k.clone = function () {
        var a = new Mq(null);
        a.Kj(this.a);
        return a;
    };
    k.Nb = function (a, b, c, d) {
        if (d < Ha(this.G(), a, b))
            return d;
        var e = this.a, f;
        var g = 0;
        for (f = e.length; g < f; ++g)
            d = e[g].Nb(a, b, c, d);
        return d;
    };
    k.Zc = function (a, b) {
        var c = this.a, d;
        var e = 0;
        for (d = c.length; e < d; ++e)
            if (c[e].Zc(a, b))
                return !0;
        return !1;
    };
    k.Ae = function (a) {
        Oa(a);
        for (var b = this.a, c = 0, d = b.length; c < d; ++c)
            Ta(a, b[c].G());
        return a;
    };
    k.vd = function () {
        return Oq(this.a);
    };
    k.Wd = function (a) {
        this.l != this.g && (lb(this.i), this.f = 0, this.l = this.g);
        if (0 > a || 0 !== this.f && a < this.f)
            return this;
        var b = a.toString();
        if (this.i.hasOwnProperty(b))
            return this.i[b];
        var c = [], d = this.a, e = !1, f;
        var g = 0;
        for (f = d.length; g < f; ++g) {
            var h = d[g], l = h.Wd(a);
            c.push(l);
            l !== h && (e = !0);
        }
        if (e)
            return a = new Mq(null), Pq(a), a.a = c, Nq(a), a.u(), this.i[b] = a;
        this.f = a;
        return this;
    };
    k.S = function () {
        return 'GeometryCollection';
    };
    k.$a = function (a) {
        var b = this.a, c;
        var d = 0;
        for (c = b.length; d < c; ++d)
            if (b[d].$a(a))
                return !0;
        return !1;
    };
    k.rotate = function (a, b) {
        for (var c = this.a, d = 0, e = c.length; d < e; ++d)
            c[d].rotate(a, b);
        this.u();
    };
    k.scale = function (a, b, c) {
        c || (c = eb(this.G()));
        for (var d = this.a, e = 0, f = d.length; e < f; ++e)
            d[e].scale(a, b, c);
        this.u();
    };
    k.Kj = function (a) {
        a = Oq(a);
        Pq(this);
        this.a = a;
        Nq(this);
        this.u();
    };
    k.Rc = function (a) {
        var b = this.a, c;
        var d = 0;
        for (c = b.length; d < c; ++d)
            b[d].Rc(a);
        this.u();
    };
    k.translate = function (a, b) {
        var c = this.a, d;
        var e = 0;
        for (d = c.length; e < d; ++e)
            c[e].translate(a, b);
        this.u();
    };
    k.ia = function () {
        Pq(this);
        gf.prototype.ia.call(this);
    };
    function Qq(a) {
        a = a ? a : {};
        Go.call(this);
        this.defaultDataProjection = Ob(a.defaultDataProjection ? a.defaultDataProjection : 'EPSG:4326');
        a.featureProjection && (this.i = Ob(a.featureProjection));
        this.b = a.geometryName;
        this.a = a.extractGeometryName;
    }
    w(Qq, Ko);
    function Rq(a, b) {
        return a ? Jo((0, Sq[a.type])(a), !1, b) : null;
    }
    function Tq(a, b) {
        return (0, Uq[a.S()])(Jo(a, !0, b), b);
    }
    var Sq = {
            Point: function (a) {
                return new C(a.coordinates);
            },
            LineString: function (a) {
                return new I(a.coordinates);
            },
            Polygon: function (a) {
                return new D(a.coordinates);
            },
            MultiPoint: function (a) {
                return new No(a.coordinates);
            },
            MultiLineString: function (a) {
                return new P(a.coordinates);
            },
            MultiPolygon: function (a) {
                return new Q(a.coordinates);
            },
            GeometryCollection: function (a, b) {
                a = a.geometries.map(function (a) {
                    return Rq(a, b);
                });
                return new Mq(a);
            }
        }, Uq = {
            Point: function (a) {
                return {
                    type: 'Point',
                    coordinates: a.W()
                };
            },
            LineString: function (a) {
                return {
                    type: 'LineString',
                    coordinates: a.W()
                };
            },
            Polygon: function (a, b) {
                if (b)
                    var c = b.rightHanded;
                return {
                    type: 'Polygon',
                    coordinates: a.W(c)
                };
            },
            MultiPoint: function (a) {
                return {
                    type: 'MultiPoint',
                    coordinates: a.W()
                };
            },
            MultiLineString: function (a) {
                return {
                    type: 'MultiLineString',
                    coordinates: a.W()
                };
            },
            MultiPolygon: function (a, b) {
                if (b)
                    var c = b.rightHanded;
                return {
                    type: 'MultiPolygon',
                    coordinates: a.W(c)
                };
            },
            GeometryCollection: function (a, b) {
                return {
                    type: 'GeometryCollection',
                    geometries: a.a.map(function (a) {
                        var c = kb({}, b);
                        delete c.featureProjection;
                        return Tq(a, c);
                    })
                };
            },
            Circle: function () {
                return {
                    type: 'GeometryCollection',
                    geometries: []
                };
            }
        };
    k = Qq.prototype;
    k.dd = function (a, b) {
        a = 'Feature' === a.type ? a : {
            type: 'Feature',
            geometry: a
        };
        b = Rq(a.geometry, b);
        var c = new Hk();
        this.b ? c.Lc(this.b) : this.a && void 0 !== a.geometry_name && c.Lc(a.geometry_name);
        c.Va(b);
        void 0 !== a.id && c.qc(a.id);
        a.properties && c.H(a.properties);
        return c;
    };
    k.Mg = function (a, b) {
        if ('FeatureCollection' === a.type) {
            var c = [];
            a = a.features;
            var d;
            var e = 0;
            for (d = a.length; e < d; ++e)
                c.push(this.dd(a[e], b));
        } else
            c = [this.dd(a, b)];
        return c;
    };
    k.Qg = function (a, b) {
        return Rq(a, b);
    };
    k.Tg = function (a) {
        a = a.crs;
        var b;
        a ? 'name' == a.type ? b = Ob(a.properties.name) : oa(!1, 36) : b = this.defaultDataProjection;
        return b;
    };
    k.ld = function (a, b) {
        b = Io(this, b);
        var c = { type: 'Feature' }, d = a.c;
        void 0 !== d && (c.id = d);
        (d = a.U()) ? c.geometry = Tq(d, b) : c.geometry = null;
        b = a.L();
        delete b[a.a];
        nb(b) ? c.properties = null : c.properties = b;
        return c;
    };
    k.qe = function (a, b) {
        b = Io(this, b);
        var c = [], d;
        var e = 0;
        for (d = a.length; e < d; ++e)
            c.push(this.ld(a[e], b));
        return {
            type: 'FeatureCollection',
            features: c
        };
    };
    k.se = function (a, b) {
        return Tq(a, Io(this, b));
    };
    function Vq() {
        Go.call(this);
    }
    w(Vq, Go);
    function Wq(a) {
        return 'string' === typeof a ? a : '';
    }
    k = Vq.prototype;
    k.S = function () {
        return 'text';
    };
    k.Yb = function (a, b) {
        return this.fe(Wq(a), Io(this, b));
    };
    k.Qa = function (a, b) {
        return this.Ng(Wq(a), Io(this, b));
    };
    k.ed = function (a, b) {
        return this.Gd(Wq(a), Io(this, b));
    };
    k.sb = function () {
        return this.defaultDataProjection;
    };
    k.Jd = function (a, b) {
        return this.pe(a, Io(this, b));
    };
    k.ac = function (a, b) {
        return this.nh(a, Io(this, b));
    };
    k.md = function (a, b) {
        return this.Kd(a, Io(this, b));
    };
    function Xq(a) {
        a = a ? a : {};
        Go.call(this);
        this.defaultDataProjection = Ob('EPSG:4326');
        this.b = a.altitudeMode ? a.altitudeMode : 'none';
    }
    w(Xq, Vq);
    var Yq = /^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/, Zq = /^H.([A-Z]{3}).*?:(.*)/, $q = /^HFDTE(\d{2})(\d{2})(\d{2})/, ar = /\r\n|\r|\n/;
    k = Xq.prototype;
    k.fe = function (a, b) {
        var c = this.b, d = a.split(ar);
        a = {};
        var e = [], f = 2000, g = 0, h = 1, l = -1, m;
        var n = 0;
        for (m = d.length; n < m; ++n) {
            var p = d[n], q;
            if ('B' == p.charAt(0)) {
                if (q = Yq.exec(p)) {
                    p = parseInt(q[1], 10);
                    var r = parseInt(q[2], 10), u = parseInt(q[3], 10), v = parseInt(q[4], 10) + parseInt(q[5], 10) / 60000;
                    'S' == q[6] && (v = -v);
                    var z = parseInt(q[7], 10) + parseInt(q[8], 10) / 60000;
                    'W' == q[9] && (z = -z);
                    e.push(z, v);
                    'none' != c && e.push('gps' == c ? parseInt(q[11], 10) : 'barometric' == c ? parseInt(q[12], 10) : 0);
                    q = Date.UTC(f, g, h, p, r, u);
                    q < l && (q = Date.UTC(f, g, h + 1, p, r, u));
                    e.push(q / 1000);
                    l = q;
                }
            } else
                'H' == p.charAt(0) && ((q = $q.exec(p)) ? (h = parseInt(q[1], 10), g = parseInt(q[2], 10) - 1, f = 2000 + parseInt(q[3], 10)) : (q = Zq.exec(p)) && (a[q[1]] = q[2].trim()));
        }
        if (0 === e.length)
            return null;
        d = new I(null);
        d.ba('none' == c ? 'XYM' : 'XYZM', e);
        b = new Hk(Jo(d, !1, b));
        b.H(a);
        return b;
    };
    k.Ng = function (a, b) {
        return (a = this.fe(a, b)) ? [a] : [];
    };
    k.pe = function () {
    };
    k.nh = function () {
    };
    k.Kd = function () {
    };
    k.Gd = function () {
    };
    function br(a, b, c, d, e, f) {
        Sc.call(this);
        this.j = null;
        this.M = a ? a : new Image();
        null !== d && (this.M.crossOrigin = d);
        this.c = f ? document.createElement('CANVAS') : null;
        this.f = f;
        this.i = null;
        this.g = e;
        this.a = c;
        this.l = b;
        this.s = !1;
        2 == this.g && cr(this);
    }
    w(br, Sc);
    function cr(a) {
        var b = hg(1, 1);
        try {
            b.drawImage(a.M, 0, 0), b.getImageData(0, 0, 1, 1);
        } catch (c) {
            a.s = !0;
        }
    }
    br.prototype.v = function () {
        this.g = 3;
        this.i.forEach(Gc);
        this.i = null;
        this.b('change');
    };
    br.prototype.o = function () {
        this.g = 2;
        this.a && (this.M.width = this.a[0], this.M.height = this.a[1]);
        this.a = [
            this.M.width,
            this.M.height
        ];
        this.i.forEach(Gc);
        this.i = null;
        cr(this);
        if (!this.s && null !== this.f) {
            this.c.width = this.M.width;
            this.c.height = this.M.height;
            var a = this.c.getContext('2d');
            a.drawImage(this.M, 0, 0);
            for (var b = a.getImageData(0, 0, this.M.width, this.M.height), c = b.data, d = this.f[0] / 255, e = this.f[1] / 255, f = this.f[2] / 255, g = 0, h = c.length; g < h; g += 4)
                c[g] *= d, c[g + 1] *= e, c[g + 2] *= f;
            a.putImageData(b, 0, 0);
        }
        this.b('change');
    };
    br.prototype.Y = function () {
        return this.c ? this.c : this.M;
    };
    br.prototype.load = function () {
        if (0 == this.g) {
            this.g = 1;
            this.i = [
                Lc(this.M, 'error', this.v, this),
                Lc(this.M, 'load', this.o, this)
            ];
            try {
                this.M.src = this.l;
            } catch (a) {
                this.v();
            }
        }
    };
    function dr(a) {
        a = a || {};
        this.l = void 0 !== a.anchor ? a.anchor : [
            0.5,
            0.5
        ];
        this.o = null;
        this.g = void 0 !== a.anchorOrigin ? a.anchorOrigin : 'top-left';
        this.C = void 0 !== a.anchorXUnits ? a.anchorXUnits : 'fraction';
        this.B = void 0 !== a.anchorYUnits ? a.anchorYUnits : 'fraction';
        this.qa = void 0 !== a.crossOrigin ? a.crossOrigin : null;
        var b = void 0 !== a.img ? a.img : null, c = void 0 !== a.imgSize ? a.imgSize : null, d = a.src;
        oa(!(void 0 !== d && b), 4);
        oa(!b || b && c, 5);
        void 0 !== d && 0 !== d.length || !b || (d = b.src || x(b).toString());
        oa(void 0 !== d && 0 < d.length, 6);
        var e = void 0 !== a.src ? 0 : 2;
        this.j = void 0 !== a.color ? vi(a.color) : null;
        var f = this.qa, g = this.j, h = ej.get(d, f, g);
        h || (h = new br(b, d, c, f, e, g), ej.set(d, f, g, h));
        this.b = h;
        this.oa = void 0 !== a.offset ? a.offset : [
            0,
            0
        ];
        this.c = void 0 !== a.offsetOrigin ? a.offsetOrigin : 'top-left';
        this.N = null;
        this.D = void 0 !== a.size ? a.size : null;
        vk.call(this, {
            opacity: void 0 !== a.opacity ? a.opacity : 1,
            rotation: void 0 !== a.rotation ? a.rotation : 0,
            scale: void 0 !== a.scale ? a.scale : 1,
            snapToPixel: void 0 !== a.snapToPixel ? a.snapToPixel : !0,
            rotateWithView: void 0 !== a.rotateWithView ? a.rotateWithView : !1
        });
    }
    w(dr, vk);
    k = dr.prototype;
    k.clone = function () {
        return new dr({
            anchor: this.l.slice(),
            anchorOrigin: this.g,
            anchorXUnits: this.C,
            anchorYUnits: this.B,
            crossOrigin: this.qa,
            color: this.j && this.j.slice ? this.j.slice() : this.j || void 0,
            src: this.b.l,
            offset: this.oa.slice(),
            offsetOrigin: this.c,
            size: null !== this.D ? this.D.slice() : void 0,
            opacity: this.i,
            scale: this.a,
            snapToPixel: this.v,
            rotation: this.f,
            rotateWithView: this.s
        });
    };
    k.Vc = function () {
        if (this.o)
            return this.o;
        var a = this.l, b = this.oc();
        if ('fraction' == this.C || 'fraction' == this.B) {
            if (!b)
                return null;
            a = this.l.slice();
            'fraction' == this.C && (a[0] *= b[0]);
            'fraction' == this.B && (a[1] *= b[1]);
        }
        if ('top-left' != this.g) {
            if (!b)
                return null;
            a === this.l && (a = this.l.slice());
            if ('top-right' == this.g || 'bottom-right' == this.g)
                a[0] = -a[0] + b[0];
            if ('bottom-left' == this.g || 'bottom-right' == this.g)
                a[1] = -a[1] + b[1];
        }
        return this.o = a;
    };
    k.np = function () {
        return this.j;
    };
    k.Y = function (a) {
        return this.b.Y(a);
    };
    k.He = function () {
        return this.b.a;
    };
    k.gf = function () {
        return this.b.g;
    };
    k.Eg = function () {
        var a = this.b;
        if (!a.j)
            if (a.s) {
                var b = a.a[0], c = a.a[1], d = hg(b, c);
                d.fillRect(0, 0, b, c);
                a.j = d.canvas;
            } else
                a.j = a.M;
        return a.j;
    };
    k.bd = function () {
        if (this.N)
            return this.N;
        var a = this.oa;
        if ('top-left' != this.c) {
            var b = this.oc(), c = this.b.a;
            if (!b || !c)
                return null;
            a = a.slice();
            if ('top-right' == this.c || 'bottom-right' == this.c)
                a[0] = c[0] - b[0] - a[0];
            if ('bottom-left' == this.c || 'bottom-right' == this.c)
                a[1] = c[1] - b[1] - a[1];
        }
        return this.N = a;
    };
    k.op = function () {
        return this.b.l;
    };
    k.oc = function () {
        return this.D ? this.D : this.b.a;
    };
    k.gi = function (a, b) {
        y(this.b, 'change', a, b);
    };
    k.load = function () {
        this.b.load();
    };
    k.Yj = function (a, b) {
        Mc(this.b, 'change', a, b);
    };
    function er(a) {
        a = a ? a : {};
        Wo.call(this);
        fr || (gr = [
            255,
            255,
            255,
            1
        ], hr = new zk({ color: gr }), ir = [
            20,
            2
        ], jr = kr = 'pixels', lr = [
            64,
            64
        ], mr = 'https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png', nr = 0.5, or = new dr({
            anchor: ir,
            anchorOrigin: 'bottom-left',
            anchorXUnits: kr,
            anchorYUnits: jr,
            crossOrigin: 'anonymous',
            rotation: 0,
            scale: nr,
            size: lr,
            src: mr
        }), pr = 'NO_IMAGE', qr = new Ak({
            color: gr,
            width: 1
        }), rr = new Ak({
            color: [
                51,
                51,
                51,
                1
            ],
            width: 2
        }), sr = new J({
            font: 'bold 16px Helvetica',
            fill: hr,
            stroke: rr,
            scale: 0.8
        }), tr = new Bk({
            fill: hr,
            image: or,
            text: sr,
            stroke: qr,
            zIndex: 0
        }), fr = [tr]);
        this.defaultDataProjection = Ob('EPSG:4326');
        this.a = a.defaultStyle ? a.defaultStyle : fr;
        this.c = void 0 !== a.extractStyles ? a.extractStyles : !0;
        this.j = void 0 !== a.writeStyles ? a.writeStyles : !0;
        this.b = {};
        this.f = void 0 !== a.showPointNames ? a.showPointNames : !0;
    }
    var fr, gr, hr, ir, kr, jr, lr, mr, nr, or, pr, qr, rr, sr, tr;
    w(er, Wo);
    var ur = ['http://www.google.com/kml/ext/2.2'], vr = [
            null,
            'http://earth.google.com/kml/2.0',
            'http://earth.google.com/kml/2.1',
            'http://earth.google.com/kml/2.2',
            'http://www.opengis.net/kml/2.2'
        ], wr = {
            fraction: 'fraction',
            pixels: 'pixels',
            insetPixels: 'pixels'
        };
    function xr(a, b) {
        var c = [
                0,
                0
            ], d = 'start';
        if (a.Y()) {
            var e = a.Y().He();
            null === e && (e = lr);
            2 == e.length && (d = a.Y().a, c[0] = d * e[0] / 2, c[1] = -d * e[1] / 2, d = 'left');
        }
        null !== a.Ka() ? (e = a.Ka(), a = e.clone(), a.Jj(e.a || sr.a), a.lj(e.b || sr.b), a.yf(e.Fa() || sr.Fa()), a.Af(e.Ga() || rr)) : a = sr.clone();
        a.Hd(b);
        a.Nj(c[0]);
        a.Oj(c[1]);
        a.Qj(d);
        return new Bk({ text: a });
    }
    function yr(a, b, c, d, e) {
        return function () {
            var f = e, g = '';
            f && this.U() && (f = 'Point' === this.U().S());
            f && (g = this.get('name'), f = f && g);
            if (a)
                return f ? (f = xr(a[0], g), a.concat(f)) : a;
            if (b) {
                var h = zr(b, c, d);
                return f ? (f = xr(h[0], g), h.concat(f)) : h;
            }
            return f ? (f = xr(c[0], g), c.concat(f)) : c;
        };
    }
    function zr(a, b, c) {
        return Array.isArray(a) ? a : 'string' === typeof a ? (!(a in c) && '#' + a in c && (a = '#' + a), zr(c[a], b, c)) : b;
    }
    function Ar(a) {
        a = oo(a, !1);
        if (a = /^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec(a))
            return a = a[1], [
                parseInt(a.substr(6, 2), 16),
                parseInt(a.substr(4, 2), 16),
                parseInt(a.substr(2, 2), 16),
                parseInt(a.substr(0, 2), 16) / 255
            ];
    }
    function Br(a) {
        a = oo(a, !1);
        for (var b = [], c = /^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i, d; d = c.exec(a);)
            b.push(parseFloat(d[1]), parseFloat(d[2]), d[3] ? parseFloat(d[3]) : 0), a = a.substr(d[0].length);
        if ('' === a)
            return b;
    }
    function Cr(a) {
        var b = oo(a, !1).trim();
        a = a.baseURI;
        a && 'about:blank' != a || (a = window.location.href);
        return a ? new URL(b, a).href : b;
    }
    function Dr(a) {
        return dp(a);
    }
    function Er(a, b) {
        return O(null, Fr, a, b);
    }
    function Gr(a, b) {
        if (b = O({
                A: [],
                ak: []
            }, Hr, a, b)) {
            a = b.A;
            b = b.ak;
            var c;
            var d = 0;
            for (c = Math.min(a.length, b.length); d < c; ++d)
                a[4 * d + 3] = b[d];
            b = new I(null);
            b.ba('XYZM', a);
            return b;
        }
    }
    function Ir(a, b) {
        var c = O({}, Jr, a, b);
        if (a = O(null, Kr, a, b))
            return b = new I(null), b.ba('XYZ', a), b.H(c), b;
    }
    function Lr(a, b) {
        var c = O({}, Jr, a, b);
        if (a = O(null, Kr, a, b))
            return b = new D(null), b.ba('XYZ', a, [a.length]), b.H(c), b;
    }
    function Mr(a, b) {
        a = O([], Nr, a, b);
        if (!a)
            return null;
        if (0 === a.length)
            return new Mq(a);
        var c = !0, d = a[0].S(), e;
        var f = 1;
        for (e = a.length; f < e; ++f)
            if (b = a[f], b.S() != d) {
                c = !1;
                break;
            }
        if (c)
            if ('Point' == d) {
                var g = a[0];
                c = g.ja;
                d = g.da();
                f = 1;
                for (e = a.length; f < e; ++f)
                    b = a[f], gc(d, b.da());
                g = new No(null);
                g.ba(c, d);
                Or(g, a);
            } else
                'LineString' == d ? (g = new P(null), Mo(g, a), Or(g, a)) : 'Polygon' == d ? (g = new Q(null), Oo(g, a), Or(g, a)) : 'GeometryCollection' == d ? g = new Mq(a) : oa(!1, 37);
        else
            g = new Mq(a);
        return g;
    }
    function Pr(a, b) {
        var c = O({}, Jr, a, b);
        if (a = O(null, Kr, a, b))
            return b = new C(null), b.ba('XYZ', a), b.H(c), b;
    }
    function Qr(a, b) {
        var c = O({}, Jr, a, b);
        if ((a = O([null], Rr, a, b)) && a[0]) {
            b = new D(null);
            var d = a[0], e = [d.length], f;
            var g = 1;
            for (f = a.length; g < f; ++g)
                gc(d, a[g]), e.push(d.length);
            b.ba('XYZ', d, e);
            b.H(c);
            return b;
        }
    }
    function Sr(a, b) {
        b = O({}, Tr, a, b);
        if (!b)
            return null;
        a = 'fillStyle' in b ? b.fillStyle : hr;
        var c = b.fill;
        void 0 === c || c || (a = null);
        c = 'imageStyle' in b ? b.imageStyle : or;
        c == pr && (c = void 0);
        var d = 'textStyle' in b ? b.textStyle : sr, e = 'strokeStyle' in b ? b.strokeStyle : qr;
        b = b.outline;
        void 0 === b || b || (e = null);
        return [new Bk({
                fill: a,
                image: c,
                stroke: e,
                text: d,
                zIndex: void 0
            })];
    }
    function Or(a, b) {
        var c = b.length, d = Array(b.length), e = Array(b.length), f = Array(b.length), g, h, l;
        var m = h = l = !1;
        for (g = 0; g < c; ++g) {
            var n = b[g];
            d[g] = n.get('extrude');
            e[g] = n.get('tessellate');
            f[g] = n.get('altitudeMode');
            m = m || void 0 !== d[g];
            h = h || void 0 !== e[g];
            l = l || f[g];
        }
        m && a.set('extrude', d);
        h && a.set('tessellate', e);
        l && a.set('altitudeMode', f);
    }
    function Ur(a, b) {
        Co(Vr, a, b);
    }
    function Wr(a, b) {
        Co(Xr, a, b);
    }
    var Yr = N(vr, {
            displayName: L(R),
            value: L(R)
        }), Vr = N(vr, {
            Data: function (a, b) {
                var c = a.getAttribute('name');
                Co(Yr, a, b);
                a = b[b.length - 1];
                null !== c ? a[c] = a.value : null !== a.displayName && (a[a.displayName] = a.value);
                delete a.value;
            },
            SchemaData: function (a, b) {
                Co(Zr, a, b);
            }
        }), Xr = N(vr, {
            LatLonAltBox: function (a, b) {
                if (a = O({}, $r, a, b))
                    b = b[b.length - 1], b.extent = [
                        parseFloat(a.west),
                        parseFloat(a.south),
                        parseFloat(a.east),
                        parseFloat(a.north)
                    ], b.altitudeMode = a.altitudeMode, b.minAltitude = parseFloat(a.minAltitude), b.maxAltitude = parseFloat(a.maxAltitude);
            },
            Lod: function (a, b) {
                if (a = O({}, as, a, b))
                    b = b[b.length - 1], b.minLodPixels = parseFloat(a.minLodPixels), b.maxLodPixels = parseFloat(a.maxLodPixels), b.minFadeExtent = parseFloat(a.minFadeExtent), b.maxFadeExtent = parseFloat(a.maxFadeExtent);
            }
        }), $r = N(vr, {
            altitudeMode: L(R),
            minAltitude: L(dp),
            maxAltitude: L(dp),
            north: L(dp),
            south: L(dp),
            east: L(dp),
            west: L(dp)
        }), as = N(vr, {
            minLodPixels: L(dp),
            maxLodPixels: L(dp),
            minFadeExtent: L(dp),
            maxFadeExtent: L(dp)
        }), Jr = N(vr, {
            extrude: L(ap),
            tessellate: L(ap),
            altitudeMode: L(R)
        }), Fr = N(vr, { coordinates: vo(Br) }), Rr = N(vr, {
            innerBoundaryIs: function (a, b) {
                (a = O(void 0, bs, a, b)) && b[b.length - 1].push(a);
            },
            outerBoundaryIs: function (a, b) {
                (a = O(void 0, cs, a, b)) && (b[b.length - 1][0] = a);
            }
        }), Hr = N(vr, {
            when: function (a, b) {
                b = b[b.length - 1].ak;
                a = oo(a, !1);
                a = Date.parse(a);
                b.push(isNaN(a) ? 0 : a);
            }
        }, N(ur, {
            coord: function (a, b) {
                b = b[b.length - 1].A;
                a = oo(a, !1);
                (a = /^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(a)) ? b.push(parseFloat(a[1]), parseFloat(a[2]), parseFloat(a[3]), 0) : b.push(0, 0, 0, 0);
            }
        })), Kr = N(vr, { coordinates: vo(Br) }), ds = N(vr, { href: L(Cr) }, N(ur, {
            x: L(dp),
            y: L(dp),
            w: L(dp),
            h: L(dp)
        })), es = N(vr, {
            Icon: L(function (a, b) {
                return (a = O({}, ds, a, b)) ? a : null;
            }),
            heading: L(dp),
            hotSpot: L(function (a) {
                var b = a.getAttribute('xunits'), c = a.getAttribute('yunits');
                var d = 'insetPixels' !== b ? 'insetPixels' !== c ? 'bottom-left' : 'top-left' : 'insetPixels' !== c ? 'bottom-right' : 'top-right';
                return {
                    x: parseFloat(a.getAttribute('x')),
                    oh: wr[b],
                    y: parseFloat(a.getAttribute('y')),
                    ph: wr[c],
                    origin: d
                };
            }),
            scale: L(Dr)
        }), bs = N(vr, { LinearRing: vo(Er) }), fs = N(vr, {
            color: L(Ar),
            scale: L(Dr)
        }), gs = N(vr, {
            color: L(Ar),
            width: L(dp)
        }), Nr = N(vr, {
            LineString: uo(Ir),
            LinearRing: uo(Lr),
            MultiGeometry: uo(Mr),
            Point: uo(Pr),
            Polygon: uo(Qr)
        }), hs = N(ur, { Track: uo(Gr) }), js = N(vr, {
            ExtendedData: Ur,
            Region: Wr,
            Link: function (a, b) {
                Co(is, a, b);
            },
            address: L(R),
            description: L(R),
            name: L(R),
            open: L(ap),
            phoneNumber: L(R),
            visibility: L(ap)
        }), is = N(vr, { href: L(Cr) }), cs = N(vr, { LinearRing: vo(Er) }), ks = N(vr, {
            Style: L(Sr),
            key: L(R),
            styleUrl: L(Cr)
        }), ms = N(vr, {
            ExtendedData: Ur,
            Region: Wr,
            MultiGeometry: L(Mr, 'geometry'),
            LineString: L(Ir, 'geometry'),
            LinearRing: L(Lr, 'geometry'),
            Point: L(Pr, 'geometry'),
            Polygon: L(Qr, 'geometry'),
            Style: L(Sr),
            StyleMap: function (a, b) {
                if (a = O(void 0, ls, a, b))
                    b = b[b.length - 1], Array.isArray(a) ? b.Style = a : 'string' === typeof a ? b.styleUrl = a : oa(!1, 38);
            },
            address: L(R),
            description: L(R),
            name: L(R),
            open: L(ap),
            phoneNumber: L(R),
            styleUrl: L(Cr),
            visibility: L(ap)
        }, N(ur, {
            MultiTrack: L(function (a, b) {
                if (a = O([], hs, a, b))
                    return b = new P(null), Mo(b, a), b;
            }, 'geometry'),
            Track: L(Gr, 'geometry')
        })), ns = N(vr, {
            color: L(Ar),
            fill: L(ap),
            outline: L(ap)
        }), Zr = N(vr, {
            SimpleData: function (a, b) {
                var c = a.getAttribute('name');
                null !== c && (a = R(a), b[b.length - 1][c] = a);
            }
        }), Tr = N(vr, {
            IconStyle: function (a, b) {
                if (a = O({}, es, a, b)) {
                    b = b[b.length - 1];
                    var c = 'Icon' in a ? a.Icon : {}, d = !('Icon' in a) || 0 < Object.keys(c).length, e, f = c.href;
                    f ? e = f : d && (e = mr);
                    f = 'bottom-left';
                    var g = a.hotSpot;
                    if (g) {
                        var h = [
                            g.x,
                            g.y
                        ];
                        var l = g.oh;
                        var m = g.ph;
                        f = g.origin;
                    } else
                        e === mr ? (h = ir, l = kr, m = jr) : /^http:\/\/maps\.(?:google|gstatic)\.com\//.test(e) && (h = [
                            0.5,
                            0
                        ], m = l = 'fraction');
                    var n;
                    g = c.x;
                    var p = c.y;
                    void 0 !== g && void 0 !== p && (n = [
                        g,
                        p
                    ]);
                    var q;
                    g = c.w;
                    c = c.h;
                    void 0 !== g && void 0 !== c && (q = [
                        g,
                        c
                    ]);
                    var r;
                    c = a.heading;
                    void 0 !== c && (r = va(c));
                    a = a.scale;
                    d ? (e == mr && (q = lr, void 0 === a && (a = nr)), e = new dr({
                        anchor: h,
                        anchorOrigin: f,
                        anchorXUnits: l,
                        anchorYUnits: m,
                        crossOrigin: 'anonymous',
                        offset: n,
                        offsetOrigin: 'bottom-left',
                        rotation: r,
                        scale: a,
                        size: q,
                        src: e
                    }), b.imageStyle = e) : b.imageStyle = pr;
                }
            },
            LabelStyle: function (a, b) {
                (a = O({}, fs, a, b)) && (b[b.length - 1].textStyle = new J({
                    fill: new zk({ color: 'color' in a ? a.color : gr }),
                    scale: a.scale
                }));
            },
            LineStyle: function (a, b) {
                (a = O({}, gs, a, b)) && (b[b.length - 1].strokeStyle = new Ak({
                    color: 'color' in a ? a.color : gr,
                    width: 'width' in a ? a.width : 1
                }));
            },
            PolyStyle: function (a, b) {
                if (a = O({}, ns, a, b)) {
                    b = b[b.length - 1];
                    b.fillStyle = new zk({ color: 'color' in a ? a.color : gr });
                    var c = a.fill;
                    void 0 !== c && (b.fill = c);
                    a = a.outline;
                    void 0 !== a && (b.outline = a);
                }
            }
        }), ls = N(vr, {
            Pair: function (a, b) {
                if (a = O({}, ks, a, b)) {
                    var c = a.key;
                    c && 'normal' == c && ((c = a.styleUrl) && (b[b.length - 1] = c), (a = a.Style) && (b[b.length - 1] = a));
                }
            }
        });
    k = er.prototype;
    k.Jg = function (a, b) {
        var c = N(vr, {
            Document: to(this.Jg, this),
            Folder: to(this.Jg, this),
            Placemark: uo(this.Rg, this),
            Style: this.kq.bind(this),
            StyleMap: this.jq.bind(this)
        });
        if (a = O([], c, a, b, this))
            return a;
    };
    k.Rg = function (a, b) {
        var c = O({ geometry: null }, ms, a, b);
        if (c) {
            var d = new Hk();
            a = a.getAttribute('id');
            null !== a && d.qc(a);
            b = b[0];
            (a = c.geometry) && Jo(a, !1, b);
            d.Va(a);
            delete c.geometry;
            this.c && d.sg(yr(c.Style, c.styleUrl, this.a, this.b, this.f));
            delete c.Style;
            d.H(c);
            return d;
        }
    };
    k.kq = function (a, b) {
        var c = a.getAttribute('id');
        null !== c && (b = Sr(a, b)) && (a = a.baseURI, a && 'about:blank' != a || (a = window.location.href), c = a ? new URL('#' + c, a).href : '#' + c, this.b[c] = b);
    };
    k.jq = function (a, b) {
        var c = a.getAttribute('id');
        null !== c && (b = O(void 0, ls, a, b)) && (a = a.baseURI, a && 'about:blank' != a || (a = window.location.href), c = a ? new URL('#' + c, a).href : '#' + c, this.b[c] = b);
    };
    k.Lg = function (a, b) {
        return ec(vr, a.namespaceURI) ? (a = this.Rg(a, [Ho(this, a, b)])) ? a : null : null;
    };
    k.Kc = function (a, b) {
        if (!ec(vr, a.namespaceURI))
            return [];
        var c = a.localName;
        if ('Document' == c || 'Folder' == c)
            return (c = this.Jg(a, [Ho(this, a, b)])) ? c : [];
        if ('Placemark' == c)
            return (b = this.Rg(a, [Ho(this, a, b)])) ? [b] : [];
        if ('kml' == c) {
            c = [];
            for (a = a.firstElementChild; a; a = a.nextElementSibling) {
                var d = this.Kc(a, b);
                d && gc(c, d);
            }
            return c;
        }
        return [];
    };
    k.cq = function (a) {
        if (qo(a))
            return os(this, a);
        if (ro(a))
            return ps(this, a);
        if ('string' === typeof a)
            return a = so(a), os(this, a);
    };
    function os(a, b) {
        for (b = b.firstChild; b; b = b.nextSibling)
            if (b.nodeType == Node.ELEMENT_NODE) {
                var c = ps(a, b);
                if (c)
                    return c;
            }
    }
    function ps(a, b) {
        var c;
        for (c = b.firstElementChild; c; c = c.nextElementSibling)
            if (ec(vr, c.namespaceURI) && 'name' == c.localName)
                return R(c);
        for (c = b.firstElementChild; c; c = c.nextElementSibling)
            if (b = c.localName, ec(vr, c.namespaceURI) && ('Document' == b || 'Folder' == b || 'Placemark' == b || 'kml' == b) && (b = ps(a, c)))
                return b;
    }
    k.eq = function (a) {
        var b = [];
        qo(a) ? gc(b, qs(this, a)) : ro(a) ? gc(b, rs(this, a)) : 'string' === typeof a && (a = so(a), gc(b, qs(this, a)));
        return b;
    };
    function qs(a, b) {
        var c = [];
        for (b = b.firstChild; b; b = b.nextSibling)
            b.nodeType == Node.ELEMENT_NODE && gc(c, rs(a, b));
        return c;
    }
    function rs(a, b) {
        var c, d = [];
        for (c = b.firstElementChild; c; c = c.nextElementSibling)
            if (ec(vr, c.namespaceURI) && 'NetworkLink' == c.localName) {
                var e = O({}, js, c, []);
                d.push(e);
            }
        for (c = b.firstElementChild; c; c = c.nextElementSibling)
            b = c.localName, !ec(vr, c.namespaceURI) || 'Document' != b && 'Folder' != b && 'kml' != b || gc(d, rs(a, c));
        return d;
    }
    k.hq = function (a) {
        var b = [];
        qo(a) ? gc(b, ss(this, a)) : ro(a) ? gc(b, this.vf(a)) : 'string' === typeof a && (a = so(a), gc(b, ss(this, a)));
        return b;
    };
    function ss(a, b) {
        var c = [];
        for (b = b.firstChild; b; b = b.nextSibling)
            b.nodeType == Node.ELEMENT_NODE && gc(c, a.vf(b));
        return c;
    }
    k.vf = function (a) {
        var b, c = [];
        for (b = a.firstElementChild; b; b = b.nextElementSibling)
            if (ec(vr, b.namespaceURI) && 'Region' == b.localName) {
                var d = O({}, Xr, b, []);
                c.push(d);
            }
        for (b = a.firstElementChild; b; b = b.nextElementSibling)
            a = b.localName, !ec(vr, b.namespaceURI) || 'Document' != a && 'Folder' != a && 'kml' != a || gc(c, this.vf(b));
        return c;
    };
    function ts(a, b) {
        b = vi(b);
        b = [
            255 * (4 == b.length ? b[3] : 1),
            b[2],
            b[1],
            b[0]
        ];
        var c;
        for (c = 0; 4 > c; ++c) {
            var d = parseInt(b[c], 10).toString(16);
            b[c] = 1 == d.length ? '0' + d : d;
        }
        ip(a, b.join(''));
    }
    function us(a, b, c) {
        a = { node: a };
        var d = b.S();
        if ('GeometryCollection' == d) {
            var e = b.vd();
            var f = vs;
        } else
            'MultiPoint' == d ? (e = b.de(), f = ws) : 'MultiLineString' == d ? (e = b.wd(), f = xs) : 'MultiPolygon' == d ? (e = b.Vd(), f = ys) : oa(!1, 39);
        Do(a, zs, f, e, c);
    }
    function As(a, b, c) {
        Do({ node: a }, Bs, Cs, [b], c);
    }
    function Ds(a, b, c) {
        var d = { node: a };
        b.c && a.setAttribute('id', b.c);
        a = b.L();
        var e = {
            address: 1,
            description: 1,
            name: 1,
            open: 1,
            phoneNumber: 1,
            styleUrl: 1,
            visibility: 1
        };
        e[b.a] = 1;
        var f = Object.keys(a || {}).sort().filter(function (a) {
            return !e[a];
        });
        if (0 < f.length) {
            var g = Bo(a, f);
            Do(d, Es, Fs, [{
                    names: f,
                    values: g
                }], c);
        }
        if (f = b.ib())
            if (f = f.call(b, 0))
                f = Array.isArray(f) ? f[0] : f, this.j && (a.Style = f), (f = f.Ka()) && (a.name = f.Ka());
        f = Gs[c[c.length - 1].node.namespaceURI];
        a = Bo(a, f);
        Do(d, Es, Ao, a, c, f);
        a = c[0];
        (b = b.U()) && (b = Jo(b, !0, a));
        Do(d, Es, vs, [b], c);
    }
    function Hs(a, b, c) {
        var d = b.da();
        a = { node: a };
        a.layout = b.ja;
        a.stride = b.pa();
        b = b.L();
        b.coordinates = d;
        d = Is[c[c.length - 1].node.namespaceURI];
        b = Bo(b, d);
        Do(a, Js, Ao, b, c, d);
    }
    function Ks(a, b, c) {
        b = b.Ud();
        var d = b.shift();
        a = { node: a };
        Do(a, Ls, Ms, b, c);
        Do(a, Ls, Ns, [d], c);
    }
    function Os(a, b) {
        Ip(a, Math.round(1000000 * b) / 1000000);
    }
    var Ps = N(vr, [
            'Document',
            'Placemark'
        ]), Ss = N(vr, {
            Document: M(function (a, b, c) {
                Do({ node: a }, Qs, Rs, b, c, void 0, this);
            }),
            Placemark: M(Ds)
        }), Qs = N(vr, { Placemark: M(Ds) }), Ts = N(vr, {
            Data: M(function (a, b, c) {
                a.setAttribute('name', b.name);
                a = { node: a };
                b = b.value;
                'object' == typeof b ? (null !== b && b.displayName && Do(a, Ts, Ao, [b.displayName], c, ['displayName']), null !== b && b.value && Do(a, Ts, Ao, [b.value], c, ['value'])) : Do(a, Ts, Ao, [b], c, ['value']);
            }),
            value: M(function (a, b) {
                ip(a, b);
            }),
            displayName: M(function (a, b) {
                a.appendChild(mo.createCDATASection(b));
            })
        }), Us = {
            Point: 'Point',
            LineString: 'LineString',
            LinearRing: 'LinearRing',
            Polygon: 'Polygon',
            MultiPoint: 'MultiGeometry',
            MultiLineString: 'MultiGeometry',
            MultiPolygon: 'MultiGeometry',
            GeometryCollection: 'MultiGeometry'
        }, Vs = N(vr, ['href'], N(ur, [
            'x',
            'y',
            'w',
            'h'
        ])), Ws = N(vr, { href: M(ip) }, N(ur, {
            x: M(Ip),
            y: M(Ip),
            w: M(Ip),
            h: M(Ip)
        })), Xs = N(vr, [
            'scale',
            'heading',
            'Icon',
            'hotSpot'
        ]), Zs = N(vr, {
            Icon: M(function (a, b, c) {
                a = { node: a };
                var d = Vs[c[c.length - 1].node.namespaceURI], e = Bo(b, d);
                Do(a, Ws, Ao, e, c, d);
                d = Vs[ur[0]];
                e = Bo(b, d);
                Do(a, Ws, Ys, e, c, d);
            }),
            heading: M(Ip),
            hotSpot: M(function (a, b) {
                a.setAttribute('x', b.x);
                a.setAttribute('y', b.y);
                a.setAttribute('xunits', b.oh);
                a.setAttribute('yunits', b.ph);
            }),
            scale: M(Os)
        }), $s = N(vr, [
            'color',
            'scale'
        ]), at = N(vr, {
            color: M(ts),
            scale: M(Os)
        }), bt = N(vr, [
            'color',
            'width'
        ]), ct = N(vr, {
            color: M(ts),
            width: M(Ip)
        }), Bs = N(vr, { LinearRing: M(Hs) }), zs = N(vr, {
            LineString: M(Hs),
            Point: M(Hs),
            Polygon: M(Ks),
            GeometryCollection: M(us)
        }), Gs = N(vr, 'name open visibility address phoneNumber description styleUrl Style'.split(' ')), Es = N(vr, {
            ExtendedData: M(function (a, b, c) {
                a = { node: a };
                var d = b.names;
                b = b.values;
                for (var e = d.length, f = 0; f < e; f++)
                    Do(a, Ts, dt, [{
                            name: d[f],
                            value: b[f]
                        }], c);
            }),
            MultiGeometry: M(us),
            LineString: M(Hs),
            LinearRing: M(Hs),
            Point: M(Hs),
            Polygon: M(Ks),
            Style: M(function (a, b, c) {
                a = { node: a };
                var d = {}, e = b.Fa(), f = b.Ga(), g = b.Y();
                b = b.Ka();
                g instanceof dr && (d.IconStyle = g);
                b && (d.LabelStyle = b);
                f && (d.LineStyle = f);
                e && (d.PolyStyle = e);
                b = et[c[c.length - 1].node.namespaceURI];
                d = Bo(d, b);
                Do(a, ft, Ao, d, c, b);
            }),
            address: M(ip),
            description: M(ip),
            name: M(ip),
            open: M(hp),
            phoneNumber: M(ip),
            styleUrl: M(ip),
            visibility: M(hp)
        }), Is = N(vr, [
            'extrude',
            'tessellate',
            'altitudeMode',
            'coordinates'
        ]), Js = N(vr, {
            extrude: M(hp),
            tessellate: M(hp),
            altitudeMode: M(ip),
            coordinates: M(function (a, b, c) {
                c = c[c.length - 1];
                var d = c.layout;
                c = c.stride;
                var e;
                'XY' == d || 'XYM' == d ? e = 2 : 'XYZ' == d || 'XYZM' == d ? e = 3 : oa(!1, 34);
                var f, g = b.length, h = '';
                if (0 < g) {
                    h += b[0];
                    for (d = 1; d < e; ++d)
                        h += ',' + b[d];
                    for (f = c; f < g; f += c)
                        for (h += ' ' + b[f], d = 1; d < e; ++d)
                            h += ',' + b[f + d];
                }
                ip(a, h);
            })
        }), Ls = N(vr, {
            outerBoundaryIs: M(As),
            innerBoundaryIs: M(As)
        }), gt = N(vr, { color: M(ts) }), et = N(vr, [
            'IconStyle',
            'LabelStyle',
            'LineStyle',
            'PolyStyle'
        ]), ft = N(vr, {
            IconStyle: M(function (a, b, c) {
                a = { node: a };
                var d = {}, e = b.oc(), f = b.He(), g = { href: b.b.l };
                if (e) {
                    g.w = e[0];
                    g.h = e[1];
                    var h = b.Vc(), l = b.bd();
                    l && f && 0 !== l[0] && l[1] !== e[1] && (g.x = l[0], g.y = f[1] - (l[1] + e[1]));
                    !h || h[0] === e[0] / 2 && h[1] === e[1] / 2 || (d.hotSpot = {
                        x: h[0],
                        oh: 'pixels',
                        y: e[1] - h[1],
                        ph: 'pixels'
                    });
                }
                d.Icon = g;
                e = b.a;
                1 !== e && (d.scale = e);
                b = b.f;
                0 !== b && (d.heading = b);
                b = Xs[c[c.length - 1].node.namespaceURI];
                d = Bo(d, b);
                Do(a, Zs, Ao, d, c, b);
            }),
            LabelStyle: M(function (a, b, c) {
                a = { node: a };
                var d = {}, e = b.Fa();
                e && (d.color = e.b);
                (b = b.b) && 1 !== b && (d.scale = b);
                b = $s[c[c.length - 1].node.namespaceURI];
                d = Bo(d, b);
                Do(a, at, Ao, d, c, b);
            }),
            LineStyle: M(function (a, b, c) {
                a = { node: a };
                var d = bt[c[c.length - 1].node.namespaceURI];
                b = Bo({
                    color: b.a,
                    width: b.c
                }, d);
                Do(a, ct, Ao, b, c, d);
            }),
            PolyStyle: M(function (a, b, c) {
                Do({ node: a }, gt, ht, [b.b], c);
            })
        });
    function Ys(a, b, c) {
        return no(ur[0], 'gx:' + c);
    }
    function Rs(a, b) {
        return no(b[b.length - 1].node.namespaceURI, 'Placemark');
    }
    function vs(a, b) {
        if (a)
            return no(b[b.length - 1].node.namespaceURI, Us[a.S()]);
    }
    var ht = yo('color'), dt = yo('Data'), Fs = yo('ExtendedData'), Ms = yo('innerBoundaryIs'), ws = yo('Point'), xs = yo('LineString'), Cs = yo('LinearRing'), ys = yo('Polygon'), Ns = yo('outerBoundaryIs');
    er.prototype.bc = function (a, b) {
        b = Io(this, b);
        var c = no(vr[4], 'kml');
        c.setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns:gx', ur[0]);
        c.setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns:xsi', 'http://www.w3.org/2001/XMLSchema-instance');
        c.setAttributeNS('http://www.w3.org/2001/XMLSchema-instance', 'xsi:schemaLocation', 'http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd');
        var d = { node: c }, e = {};
        1 < a.length ? e.Document = a : 1 == a.length && (e.Placemark = a[0]);
        a = Ps[c.namespaceURI];
        e = Bo(e, a);
        Do(d, Ss, Ao, e, [b], a, this);
        return c;
    };
    rj.Ld = function () {
    };
    (function (a) {
        function b(a) {
            this.tc = ArrayBuffer.isView && ArrayBuffer.isView(a) ? a : new Uint8Array(a || 0);
            this.type = this.ga = 0;
            this.length = this.tc.length;
        }
        function c(a, b, c) {
            var e = c.tc;
            var f = e[c.ga++];
            var g = (f & 112) >> 4;
            if (128 > f)
                return d(a, g, b);
            f = e[c.ga++];
            g |= (f & 127) << 3;
            if (128 > f)
                return d(a, g, b);
            f = e[c.ga++];
            g |= (f & 127) << 10;
            if (128 > f)
                return d(a, g, b);
            f = e[c.ga++];
            g |= (f & 127) << 17;
            if (128 > f)
                return d(a, g, b);
            f = e[c.ga++];
            g |= (f & 127) << 24;
            if (128 > f)
                return d(a, g, b);
            f = e[c.ga++];
            if (128 > f)
                return d(a, g | (f & 1) << 31, b);
            throw Error('Expected varint not more than 10 bytes');
        }
        function d(a, b, c) {
            return c ? 4294967296 * b + (a >>> 0) : 4294967296 * (b >>> 0) + (a >>> 0);
        }
        var e = {
            read: function (a, b, c, d, e) {
                var f = 8 * e - d - 1;
                var g = (1 << f) - 1, h = g >> 1, l = -7;
                e = c ? e - 1 : 0;
                var m = c ? -1 : 1, v = a[b + e];
                e += m;
                c = v & (1 << -l) - 1;
                v >>= -l;
                for (l += f; 0 < l; c = 256 * c + a[b + e], e += m, l -= 8);
                f = c & (1 << -l) - 1;
                c >>= -l;
                for (l += d; 0 < l; f = 256 * f + a[b + e], e += m, l -= 8);
                if (0 === c)
                    c = 1 - h;
                else {
                    if (c === g)
                        return f ? NaN : Infinity * (v ? -1 : 1);
                    f += Math.pow(2, d);
                    c -= h;
                }
                return (v ? -1 : 1) * f * Math.pow(2, c - d);
            },
            write: function (a, b, c, d, e, n) {
                var f, g = 8 * n - e - 1, h = (1 << g) - 1, l = h >> 1, m = 23 === e ? Math.pow(2, -24) - Math.pow(2, -77) : 0;
                n = d ? 0 : n - 1;
                var z = d ? 1 : -1, A = 0 > b || 0 === b && 0 > 1 / b ? 1 : 0;
                b = Math.abs(b);
                isNaN(b) || Infinity === b ? (b = isNaN(b) ? 1 : 0, d = h) : (d = Math.floor(Math.log(b) / Math.LN2), 1 > b * (f = Math.pow(2, -d)) && (d--, f *= 2), b = 1 <= d + l ? b + m / f : b + m * Math.pow(2, 1 - l), 2 <= b * f && (d++, f /= 2), d + l >= h ? (b = 0, d = h) : 1 <= d + l ? (b = (b * f - 1) * Math.pow(2, e), d += l) : (b = b * Math.pow(2, l - 1) * Math.pow(2, e), d = 0));
                for (; 8 <= e; a[c + n] = b & 255, n += z, b /= 256, e -= 8);
                d = d << e | b;
                for (g += e; 0 < g; a[c + n] = d & 255, n += z, d /= 256, g -= 8);
                a[c + n - z] |= 128 * A;
            }
        };
        b.c = 0;
        b.g = 1;
        b.b = 2;
        b.a = 5;
        b.prototype = {
            Og: function (a, b, c) {
                for (c = c || this.length; this.ga < c;) {
                    var d = this.Ua(), e = d >> 3, f = this.ga;
                    this.type = d & 7;
                    a(e, b, this);
                    this.ga === f && this.Lq(d);
                }
                return b;
            },
            Zp: function () {
                var a = e.read(this.tc, this.ga, !0, 23, 4);
                this.ga += 4;
                return a;
            },
            Vp: function () {
                var a = e.read(this.tc, this.ga, !0, 52, 8);
                this.ga += 8;
                return a;
            },
            Ua: function (a) {
                var b = this.tc;
                var d = b[this.ga++];
                var e = d & 127;
                if (128 > d)
                    return e;
                d = b[this.ga++];
                e |= (d & 127) << 7;
                if (128 > d)
                    return e;
                d = b[this.ga++];
                e |= (d & 127) << 14;
                if (128 > d)
                    return e;
                d = b[this.ga++];
                e |= (d & 127) << 21;
                if (128 > d)
                    return e;
                d = b[this.ga];
                return c(e | (d & 15) << 28, a, this);
            },
            lq: function () {
                return this.Ua(!0);
            },
            Ug: function () {
                var a = this.Ua();
                return 1 === a % 2 ? (a + 1) / -2 : a / 2;
            },
            Tp: function () {
                return !!this.Ua();
            },
            Vg: function () {
                for (var a = this.Ua() + this.ga, b = this.tc, c = '', d = this.ga; d < a;) {
                    var e = b[d], n = null, p = 239 < e ? 4 : 223 < e ? 3 : 191 < e ? 2 : 1;
                    if (d + p > a)
                        break;
                    if (1 === p)
                        128 > e && (n = e);
                    else if (2 === p) {
                        var q = b[d + 1];
                        128 === (q & 192) && (n = (e & 31) << 6 | q & 63, 127 >= n && (n = null));
                    } else if (3 === p) {
                        q = b[d + 1];
                        var r = b[d + 2];
                        128 === (q & 192) && 128 === (r & 192) && (n = (e & 15) << 12 | (q & 63) << 6 | r & 63, 2047 >= n || 55296 <= n && 57343 >= n) && (n = null);
                    } else if (4 === p) {
                        q = b[d + 1];
                        r = b[d + 2];
                        var u = b[d + 3];
                        128 === (q & 192) && 128 === (r & 192) && 128 === (u & 192) && (n = (e & 15) << 18 | (q & 63) << 12 | (r & 63) << 6 | u & 63, 65535 >= n || 1114112 <= n) && (n = null);
                    }
                    null === n ? (n = 65533, p = 1) : 65535 < n && (n -= 65536, c += String.fromCharCode(n >>> 10 & 1023 | 55296), n = 56320 | n & 1023);
                    c += String.fromCharCode(n);
                    d += p;
                }
                this.ga = a;
                return c;
            },
            Lq: function (a) {
                a &= 7;
                if (a === b.c)
                    for (; 127 < this.tc[this.ga++];);
                else if (a === b.b)
                    this.ga = this.Ua() + this.ga;
                else if (a === b.a)
                    this.ga += 4;
                else if (a === b.g)
                    this.ga += 8;
                else
                    throw Error('Unimplemented type: ' + a);
            }
        };
        a['default'] = b;
    }(rj.Ld = rj.Ld || {}));
    rj.Ld = rj.Ld.default;
    function it(a, b, c, d, e) {
        this.l = e;
        this.f = a;
        this.b = b;
        this.a = this.c = null;
        this.g = c;
        this.j = d;
        this.s = We();
    }
    k = it.prototype;
    k.get = function (a) {
        return this.j[a];
    };
    k.pb = it.prototype.td = function () {
        return this.g;
    };
    k.G = function () {
        this.i || (this.i = 'Point' === this.f ? Pa(this.b) : Qa(this.b, 0, this.b.length, 2));
        return this.i;
    };
    k.Td = function () {
        if (!this.c) {
            var a = eb(this.G());
            this.c = If(this.b, 0, this.g, 2, a, 0);
        }
        return this.c;
    };
    k.Fe = function () {
        this.a || (this.a = Kk(this.b, 0, this.b.length, 2, 0.5));
        return this.a;
    };
    k.Ge = function () {
        if (!this.a) {
            this.a = [];
            for (var a = this.b, b = 0, c = this.g, d = 0, e = c.length; d < e; ++d) {
                var f = c[d];
                b = Kk(a, b, f, 2, 0.5);
                gc(this.a, b);
                b = f;
            }
        }
        return this.a;
    };
    k.Ao = function () {
        return this.l;
    };
    k.Xb = function () {
        return this.b;
    };
    k.da = it.prototype.Xb;
    k.U = function () {
        return this;
    };
    k.Bo = function () {
        return this.j;
    };
    k.Wd = it.prototype.U;
    k.pa = function () {
        return 2;
    };
    k.ib = ea;
    k.S = function () {
        return this.f;
    };
    k.mb = function (a) {
        var b = a.G();
        a = a.oe;
        b = db(a) / db(b);
        var c = this.s;
        ef(c, a[0], a[3], b, -b, 0, 0, 0);
        Te(this.b, 0, this.b.length, 2, c, this.b);
    };
    function jt(a) {
        Go.call(this);
        a = a ? a : {};
        this.defaultDataProjection = new wb({
            code: 'EPSG:3857',
            units: 'tile-pixels'
        });
        this.b = a.featureClass ? a.featureClass : it;
        this.g = a.geometryName;
        this.f = a.layerName ? a.layerName : 'layer';
        this.c = a.layers ? a.layers : null;
        this.a = null;
    }
    w(jt, Go);
    function kt(a, b, c) {
        if (3 === a) {
            a = {
                keys: [],
                values: [],
                features: []
            };
            var d = c.Ua() + c.ga;
            c.Og(lt, a, d);
            a.length = a.features.length;
            a.length && (b[a.name] = a);
        }
    }
    function lt(a, b, c) {
        if (15 === a)
            b.version = c.Ua();
        else if (1 === a)
            b.name = c.Vg();
        else if (5 === a)
            b.extent = c.Ua();
        else if (2 === a)
            b.features.push(c.ga);
        else if (3 === a)
            b.keys.push(c.Vg());
        else if (4 === a) {
            a = null;
            for (var d = c.Ua() + c.ga; c.ga < d;)
                a = c.Ua() >> 3, a = 1 === a ? c.Vg() : 2 === a ? c.Zp() : 3 === a ? c.Vp() : 4 === a ? c.lq() : 5 === a ? c.Ua() : 6 === a ? c.Ug() : 7 === a ? c.Tp() : null;
            b.values.push(a);
        }
    }
    function mt(a, b, c) {
        if (1 == a)
            b.id = c.Ua();
        else if (2 == a)
            for (a = c.Ua() + c.ga; c.ga < a;) {
                var d = b.layer.keys[c.Ua()], e = b.layer.values[c.Ua()];
                b.properties[d] = e;
            }
        else
            3 == a ? b.type = c.Ua() : 4 == a && (b.geometry = c.ga);
    }
    function nt(a, b, c) {
        var d = c.type;
        if (0 === d)
            return null;
        var e = c.id, f = c.properties;
        f[a.f] = c.layer.name;
        var g = [];
        var h = [], l = h;
        b.ga = c.geometry;
        c = b.Ua() + b.ga;
        for (var m = 1, n = 0, p = 0, q = 0, r = 0, u = 0; b.ga < c;)
            n || (n = b.Ua(), m = n & 7, n >>= 3), n--, 1 === m || 2 === m ? (p += b.Ug(), q += b.Ug(), 1 === m && r > u && (l.push(r), u = r), g.push(p, q), r += 2) : 7 === m ? r > u && (g.push(g[u], g[u + 1]), r += 2) : oa(!1, 59);
        r > u && l.push(r);
        b = h.length;
        var v;
        1 === d ? v = 1 === b ? 'Point' : 'MultiPoint' : 2 === d ? v = 1 === b ? 'LineString' : 'MultiLineString' : 3 === d && (v = 'Polygon');
        d = v;
        if (a.b === it)
            g = new a.b(d, g, h, f, e);
        else {
            if ('Polygon' == d) {
                d = [];
                l = b = v = 0;
                for (c = h.length; l < c; ++l)
                    m = h[l], Mf(g, v, m, 2) || (d.push(h.slice(b, l)), b = l), v = m;
                1 < d.length ? (h = d, d = new Q(null)) : d = new D(null);
            } else
                d = 'Point' === d ? new C(null) : 'LineString' === d ? new I(null) : 'Polygon' === d ? new D(null) : 'MultiPoint' === d ? new No(null) : 'MultiLineString' === d ? new P(null) : null;
            d.ba('XY', g, h);
            g = new a.b();
            a.g && g.Lc(a.g);
            a = Jo(d, !1, Io(a, void 0));
            g.Va(a);
            g.qc(e);
            g.H(f);
        }
        return g;
    }
    k = jt.prototype;
    k.cg = function () {
        return this.a;
    };
    k.S = function () {
        return 'arraybuffer';
    };
    k.Qa = function (a) {
        var b = this.c;
        a = new rj.Ld(a);
        var c = a.Og(kt, {}), d = [], e;
        for (e in c)
            if (!b || -1 != b.indexOf(e)) {
                var f = c[e];
                for (var g, h = 0, l = f.length; h < l; ++h) {
                    g = a;
                    var m = f;
                    g.ga = m.features[h];
                    var n = g.Ua() + g.ga;
                    m = {
                        layer: m,
                        type: 0,
                        properties: {}
                    };
                    g.Og(mt, m, n);
                    g = m;
                    d.push(nt(this, a, g));
                }
                this.a = f ? [
                    0,
                    0,
                    f.extent,
                    f.extent
                ] : null;
            }
        return d;
    };
    k.sb = function () {
        return this.defaultDataProjection;
    };
    k.Sn = function (a) {
        this.c = a;
    };
    k.Yb = function () {
    };
    k.ed = function () {
    };
    k.Jd = function () {
    };
    k.md = function () {
    };
    k.ac = function () {
    };
    function ot() {
        Wo.call(this);
        this.defaultDataProjection = Ob('EPSG:4326');
    }
    w(ot, Wo);
    function pt(a, b) {
        b[b.length - 1].le[a.getAttribute('k')] = a.getAttribute('v');
    }
    var qt = [null], rt = N(qt, {
            nd: function (a, b) {
                b[b.length - 1].zd.push(a.getAttribute('ref'));
            },
            tag: pt
        }), tt = N(qt, {
            node: function (a, b) {
                var c = b[0], d = b[b.length - 1], e = a.getAttribute('id'), f = [
                        parseFloat(a.getAttribute('lon')),
                        parseFloat(a.getAttribute('lat'))
                    ];
                d.ki[e] = f;
                a = O({ le: {} }, st, a, b);
                nb(a.le) || (f = new C(f), Jo(f, !1, c), c = new Hk(f), c.qc(e), c.H(a.le), d.features.push(c));
            },
            way: function (a, b) {
                var c = a.getAttribute('id');
                a = O({
                    id: c,
                    zd: [],
                    le: {}
                }, rt, a, b);
                b[b.length - 1].lh.push(a);
            }
        }), st = N(qt, { tag: pt });
    ot.prototype.Kc = function (a, b) {
        b = Ho(this, a, b);
        if ('osm' == a.localName) {
            a = O({
                ki: {},
                lh: [],
                features: []
            }, tt, a, [b]);
            for (var c = 0; c < a.lh.length; c++) {
                for (var d = a.lh[c], e = [], f = 0, g = d.zd.length; f < g; f++)
                    gc(e, a.ki[d.zd[f]]);
                d.zd[0] == d.zd[d.zd.length - 1] ? (f = new D(null), f.ba('XY', e, [e.length])) : (f = new I(null), f.ba('XY', e));
                Jo(f, !1, b);
                e = new Hk(f);
                e.qc(d.id);
                e.H(d.le);
                a.features.push(e);
            }
            if (a.features)
                return a.features;
        }
        return [];
    };
    ot.prototype.mh = function () {
    };
    ot.prototype.bc = function () {
    };
    ot.prototype.re = function () {
    };
    function ut(a, b, c, d) {
        var e;
        void 0 !== d ? e = d : e = [];
        for (var f = d = 0; f < b;) {
            var g = a[f++];
            e[d++] = a[f++];
            e[d++] = g;
            for (g = 2; g < c; ++g)
                e[d++] = a[f++];
        }
        e.length = d;
    }
    function vt(a) {
        a = a ? a : {};
        Go.call(this);
        this.defaultDataProjection = Ob('EPSG:4326');
        this.b = a.factor ? a.factor : 100000;
        this.a = a.geometryLayout ? a.geometryLayout : 'XY';
    }
    w(vt, Vq);
    function wt(a, b, c) {
        var d, e = Array(b);
        for (d = 0; d < b; ++d)
            e[d] = 0;
        var f;
        var g = 0;
        for (f = a.length; g < f;)
            for (d = 0; d < b; ++d, ++g) {
                var h = a[g], l = h - e[d];
                e[d] = h;
                a[g] = l;
            }
        return xt(a, c ? c : 100000);
    }
    function yt(a, b, c) {
        var d, e = Array(b);
        for (d = 0; d < b; ++d)
            e[d] = 0;
        a = zt(a, c ? c : 100000);
        var f;
        c = 0;
        for (f = a.length; c < f;)
            for (d = 0; d < b; ++d, ++c)
                e[d] += a[c], a[c] = e[d];
        return a;
    }
    function xt(a, b) {
        b = b ? b : 100000;
        var c;
        var d = 0;
        for (c = a.length; d < c; ++d)
            a[d] = Math.round(a[d] * b);
        b = 0;
        for (d = a.length; b < d; ++b)
            c = a[b], a[b] = 0 > c ? ~(c << 1) : c << 1;
        b = '';
        d = 0;
        for (c = a.length; d < c; ++d) {
            for (var e, f = a[d], g = ''; 32 <= f;)
                e = (32 | f & 31) + 63, g += String.fromCharCode(e), f >>= 5;
            g += String.fromCharCode(f + 63);
            b += g;
        }
        return b;
    }
    function zt(a, b) {
        b = b ? b : 100000;
        var c = [], d = 0, e = 0, f;
        var g = 0;
        for (f = a.length; g < f; ++g) {
            var h = a.charCodeAt(g) - 63;
            d |= (h & 31) << e;
            32 > h ? (c.push(d), e = d = 0) : e += 5;
        }
        a = 0;
        for (d = c.length; a < d; ++a)
            e = c[a], c[a] = e & 1 ? ~(e >> 1) : e >> 1;
        a = 0;
        for (d = c.length; a < d; ++a)
            c[a] /= b;
        return c;
    }
    k = vt.prototype;
    k.fe = function (a, b) {
        a = this.Gd(a, b);
        return new Hk(a);
    };
    k.Ng = function (a, b) {
        return [this.fe(a, b)];
    };
    k.Gd = function (a, b) {
        var c = jf(this.a);
        a = yt(a, c, this.b);
        ut(a, a.length, c, a);
        c = yf(a, 0, a.length, c);
        return Jo(new I(c, this.a), !1, Io(this, b));
    };
    k.pe = function (a, b) {
        if (a = a.U())
            return this.Kd(a, b);
        oa(!1, 40);
        return '';
    };
    k.nh = function (a, b) {
        return this.pe(a[0], b);
    };
    k.Kd = function (a, b) {
        a = Jo(a, !0, Io(this, b));
        b = a.da();
        a = a.pa();
        ut(b, b.length, a, b);
        return wt(b, a, this.b);
    };
    function At(a) {
        a = a ? a : {};
        Go.call(this);
        this.a = a.layerName;
        this.b = a.layers ? a.layers : null;
        this.defaultDataProjection = Ob(a.defaultDataProjection ? a.defaultDataProjection : 'EPSG:4326');
    }
    w(At, Ko);
    function Bt(a, b) {
        var c = [], d, e;
        var f = 0;
        for (e = a.length; f < e; ++f) {
            var g = a[f];
            0 < f && c.pop();
            0 <= g ? d = b[g] : d = b[~g].slice().reverse();
            c.push.apply(c, d);
        }
        a = 0;
        for (b = c.length; a < b; ++a)
            c[a] = c[a].slice();
        return c;
    }
    function Ct(a, b, c, d, e, f, g) {
        a = a.geometries;
        var h = [], l;
        var m = 0;
        for (l = a.length; m < l; ++m)
            h[m] = Dt(a[m], b, c, d, e, f, g);
        return h;
    }
    function Dt(a, b, c, d, e, f, g) {
        var h = a.type, l = Et[h];
        c = 'Point' === h || 'MultiPoint' === h ? l(a, c, d) : l(a, b);
        b = new Hk();
        b.Va(Jo(c, !1, g));
        void 0 !== a.id && b.qc(a.id);
        a = a.properties;
        e && (a || (a = {}), a[e] = f);
        a && b.H(a);
        return b;
    }
    At.prototype.Mg = function (a, b) {
        if ('Topology' == a.type) {
            var c = null, d = null;
            if (a.transform) {
                var e = a.transform;
                c = e.scale;
                d = e.translate;
            }
            var f = a.arcs;
            if (e) {
                e = c;
                var g = d, h;
                var l = 0;
                for (h = f.length; l < h; ++l) {
                    var m, n = f[l], p = e, q = g, r = 0, u = 0;
                    var v = 0;
                    for (m = n.length; v < m; ++v) {
                        var z = n[v];
                        r += z[0];
                        u += z[1];
                        z[0] = r;
                        z[1] = u;
                        Ft(z, p, q);
                    }
                }
            }
            e = [];
            a = a.objects;
            g = this.a;
            for (var A in a)
                this.b && -1 == this.b.indexOf(A) || ('GeometryCollection' === a[A].type ? (l = a[A], e.push.apply(e, Ct(l, f, c, d, g, A, b))) : (l = a[A], e.push(Dt(l, f, c, d, g, A, b))));
            return e;
        }
        return [];
    };
    function Ft(a, b, c) {
        a[0] = a[0] * b[0] + c[0];
        a[1] = a[1] * b[1] + c[1];
    }
    At.prototype.Tg = function () {
        return this.defaultDataProjection;
    };
    var Et = {
        Point: function (a, b, c) {
            a = a.coordinates;
            b && c && Ft(a, b, c);
            return new C(a);
        },
        LineString: function (a, b) {
            a = Bt(a.arcs, b);
            return new I(a);
        },
        Polygon: function (a, b) {
            var c = [], d;
            var e = 0;
            for (d = a.arcs.length; e < d; ++e)
                c[e] = Bt(a.arcs[e], b);
            return new D(c);
        },
        MultiPoint: function (a, b, c) {
            a = a.coordinates;
            var d;
            if (b && c) {
                var e = 0;
                for (d = a.length; e < d; ++e)
                    Ft(a[e], b, c);
            }
            return new No(a);
        },
        MultiLineString: function (a, b) {
            var c = [], d;
            var e = 0;
            for (d = a.arcs.length; e < d; ++e)
                c[e] = Bt(a.arcs[e], b);
            return new P(c);
        },
        MultiPolygon: function (a, b) {
            var c = [], d, e;
            var f = 0;
            for (e = a.arcs.length; f < e; ++f) {
                var g = a.arcs[f];
                var h = [];
                var l = 0;
                for (d = g.length; l < d; ++l)
                    h[l] = Bt(g[l], b);
                c[f] = h;
            }
            return new Q(c);
        }
    };
    k = At.prototype;
    k.ld = function () {
    };
    k.qe = function () {
    };
    k.se = function () {
    };
    k.Qg = function () {
    };
    k.dd = function () {
    };
    function Gt(a) {
        this.rc = a;
    }
    function Ht(a, b) {
        this.rc = a;
        this.b = Array.prototype.slice.call(arguments, 1);
        oa(2 <= this.b.length, 57);
    }
    w(Ht, Gt);
    function It(a) {
        var b = ['And'].concat(Array.prototype.slice.call(arguments));
        Ht.apply(this, b);
    }
    w(It, Ht);
    function Jt(a, b, c) {
        this.rc = 'BBOX';
        this.geometryName = a;
        this.extent = b;
        this.srsName = c;
    }
    w(Jt, Gt);
    function Kt(a, b, c, d) {
        this.rc = a;
        this.geometryName = b || 'the_geom';
        this.geometry = c;
        this.srsName = d;
    }
    w(Kt, Gt);
    function Lt(a, b, c) {
        Kt.call(this, 'Contains', a, b, c);
    }
    w(Lt, Kt);
    function Mt(a, b) {
        this.rc = a;
        this.b = b;
    }
    w(Mt, Gt);
    function Nt(a, b, c) {
        Mt.call(this, 'During', a);
        this.a = b;
        this.g = c;
    }
    w(Nt, Mt);
    function Ot(a, b, c, d) {
        Mt.call(this, a, b);
        this.g = c;
        this.a = d;
    }
    w(Ot, Mt);
    function Pt(a, b, c) {
        Ot.call(this, 'PropertyIsEqualTo', a, b, c);
    }
    w(Pt, Ot);
    function Qt(a, b) {
        Ot.call(this, 'PropertyIsGreaterThan', a, b);
    }
    w(Qt, Ot);
    function Rt(a, b) {
        Ot.call(this, 'PropertyIsGreaterThanOrEqualTo', a, b);
    }
    w(Rt, Ot);
    function St(a, b, c) {
        Kt.call(this, 'Intersects', a, b, c);
    }
    w(St, Kt);
    function Tt(a, b, c) {
        Mt.call(this, 'PropertyIsBetween', a);
        this.a = b;
        this.g = c;
    }
    w(Tt, Mt);
    function Ut(a, b, c, d, e, f) {
        Mt.call(this, 'PropertyIsLike', a);
        this.c = b;
        this.f = void 0 !== c ? c : '*';
        this.i = void 0 !== d ? d : '.';
        this.g = void 0 !== e ? e : '!';
        this.a = f;
    }
    w(Ut, Mt);
    function Vt(a) {
        Mt.call(this, 'PropertyIsNull', a);
    }
    w(Vt, Mt);
    function Wt(a, b) {
        Ot.call(this, 'PropertyIsLessThan', a, b);
    }
    w(Wt, Ot);
    function Xt(a, b) {
        Ot.call(this, 'PropertyIsLessThanOrEqualTo', a, b);
    }
    w(Xt, Ot);
    function Yt(a) {
        this.rc = 'Not';
        this.condition = a;
    }
    w(Yt, Gt);
    function Zt(a, b, c) {
        Ot.call(this, 'PropertyIsNotEqualTo', a, b, c);
    }
    w(Zt, Ot);
    function $t(a) {
        var b = ['Or'].concat(Array.prototype.slice.call(arguments));
        Ht.apply(this, b);
    }
    w($t, Ht);
    function au(a, b, c) {
        Kt.call(this, 'Within', a, b, c);
    }
    w(au, Kt);
    function bu(a) {
        var b = [null].concat(Array.prototype.slice.call(arguments));
        return new (Function.prototype.bind.apply(It, b))();
    }
    function cu(a, b, c) {
        return new Jt(a, b, c);
    }
    function du(a) {
        a = a ? a : {};
        this.c = a.featureType;
        this.a = a.featureNS;
        this.b = a.gmlFormat ? a.gmlFormat : new Kp();
        this.l = a.schemaLocation ? a.schemaLocation : eu['1.1.0'];
        Wo.call(this);
    }
    w(du, Wo);
    var eu = {
        '1.1.0': 'http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd',
        '1.0.0': 'http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd'
    };
    du.prototype.Kc = function (a, b) {
        var c = {
            featureType: this.c,
            featureNS: this.a
        };
        kb(c, Ho(this, a, b ? b : {}));
        b = [c];
        this.b.b['http://www.opengis.net/gml'].featureMember = uo(Zo.prototype.ge);
        (a = O([], this.b.b, a, b, this.b)) || (a = []);
        return a;
    };
    du.prototype.j = function (a) {
        if (qo(a))
            return fu(a);
        if (ro(a))
            return O({}, gu, a, []);
        if ('string' === typeof a)
            return a = so(a), fu(a);
    };
    du.prototype.f = function (a) {
        if (qo(a))
            return hu(this, a);
        if (ro(a))
            return iu(this, a);
        if ('string' === typeof a)
            return a = so(a), hu(this, a);
    };
    function hu(a, b) {
        for (b = b.firstChild; b; b = b.nextSibling)
            if (b.nodeType == Node.ELEMENT_NODE)
                return iu(a, b);
    }
    var ju = { 'http://www.opengis.net/gml': { boundedBy: L(Zo.prototype.rf, 'bounds') } };
    function iu(a, b) {
        var c = {}, d = gp(b.getAttribute('numberOfFeatures'));
        c.numberOfFeatures = d;
        return O(c, ju, b, [], a.b);
    }
    var ku = {
            'http://www.opengis.net/wfs': {
                totalInserted: L(fp),
                totalUpdated: L(fp),
                totalDeleted: L(fp)
            }
        }, lu = {
            'http://www.opengis.net/ogc': {
                FeatureId: uo(function (a) {
                    return a.getAttribute('fid');
                })
            }
        }, mu = {
            'http://www.opengis.net/wfs': {
                Feature: function (a, b) {
                    Co(lu, a, b);
                }
            }
        }, gu = {
            'http://www.opengis.net/wfs': {
                TransactionSummary: L(function (a, b) {
                    return O({}, ku, a, b);
                }, 'transactionSummary'),
                InsertResults: L(function (a, b) {
                    return O([], mu, a, b);
                }, 'insertIds')
            }
        };
    function fu(a) {
        for (a = a.firstChild; a; a = a.nextSibling)
            if (a.nodeType == Node.ELEMENT_NODE)
                return O({}, gu, a, []);
    }
    var nu = { 'http://www.opengis.net/wfs': { PropertyName: M(ip) } };
    function ou(a, b) {
        var c = no('http://www.opengis.net/ogc', 'Filter'), d = no('http://www.opengis.net/ogc', 'FeatureId');
        c.appendChild(d);
        d.setAttribute('fid', b);
        a.appendChild(c);
    }
    function pu(a, b) {
        a = (a ? a : 'feature') + ':';
        return 0 === b.indexOf(a) ? b : a + b;
    }
    var qu = {
        'http://www.opengis.net/wfs': {
            Insert: M(function (a, b, c) {
                var d = c[c.length - 1], e = d.gmlVersion;
                d = no(d.featureNS, d.featureType);
                a.appendChild(d);
                if (2 === e) {
                    a = Tp.prototype;
                    (e = b.c) && d.setAttribute('fid', e);
                    e = c[c.length - 1];
                    var f = e.featureNS, g = b.a;
                    e.tb || (e.tb = {}, e.tb[f] = {});
                    var h = b.L();
                    b = [];
                    var l = [];
                    for (n in h) {
                        var m = h[n];
                        null !== m && (b.push(n), l.push(m), n == g || m instanceof gf ? n in e.tb[f] || (e.tb[f][n] = M(a.ui, a)) : n in e.tb[f] || (e.tb[f][n] = M(ip)));
                    }
                    var n = kb({}, e);
                    n.node = d;
                    Do(n, e.tb, yo(void 0, f), l, c, b);
                } else
                    Kp.prototype.Ci(d, b, c);
            }),
            Update: M(function (a, b, c) {
                var d = c[c.length - 1];
                oa(void 0 !== b.c, 27);
                var e = d.featurePrefix, f = d.featureNS, g = b.a;
                a.setAttribute('typeName', pu(e, d.featureType));
                a.setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns:' + e, f);
                e = b.c;
                if (void 0 !== e) {
                    f = b.P();
                    for (var h = [], l = 0, m = f.length; l < m; l++) {
                        var n = b.get(f[l]);
                        if (void 0 !== n) {
                            var p = f[l];
                            n instanceof gf && (p = g);
                            h.push({
                                name: p,
                                value: n
                            });
                        }
                    }
                    Do({
                        gmlVersion: d.gmlVersion,
                        node: a,
                        hasZ: d.hasZ,
                        srsName: d.srsName
                    }, qu, yo('Property'), h, c);
                    ou(a, e);
                }
            }),
            Delete: M(function (a, b, c) {
                c = c[c.length - 1];
                oa(void 0 !== b.c, 26);
                var d = c.featurePrefix, e = c.featureNS;
                a.setAttribute('typeName', pu(d, c.featureType));
                a.setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns:' + d, e);
                b = b.c;
                void 0 !== b && ou(a, b);
            }),
            Property: M(function (a, b, c) {
                var d = no('http://www.opengis.net/wfs', 'Name'), e = c[c.length - 1].gmlVersion;
                a.appendChild(d);
                ip(d, b.name);
                void 0 !== b.value && null !== b.value && (d = no('http://www.opengis.net/wfs', 'Value'), a.appendChild(d), b.value instanceof gf ? 2 === e ? Tp.prototype.ui(d, b.value, c) : Kp.prototype.Yc(d, b.value, c) : ip(d, b.value));
            }),
            Native: M(function (a, b) {
                b.Uq && a.setAttribute('vendorId', b.Uq);
                void 0 !== b.qq && a.setAttribute('safeToIgnore', b.qq);
                void 0 !== b.value && ip(a, b.value);
            })
        }
    };
    function ru(a, b, c) {
        a = { node: a };
        b = b.b;
        for (var d = 0, e = b.length; d < e; ++d) {
            var f = b[d];
            Do(a, su, yo(f.rc), [f], c);
        }
    }
    function tu(a, b) {
        void 0 !== b.a && a.setAttribute('matchCase', b.a.toString());
        uu(a, b.b);
        vu(a, '' + b.g);
    }
    function wu(a, b, c) {
        a = no('http://www.opengis.net/ogc', a);
        ip(a, c);
        b.appendChild(a);
    }
    function uu(a, b) {
        wu('PropertyName', a, b);
    }
    function vu(a, b) {
        wu('Literal', a, b);
    }
    function xu(a, b) {
        var c = no('http://www.opengis.net/gml', 'TimeInstant');
        a.appendChild(c);
        a = no('http://www.opengis.net/gml', 'timePosition');
        c.appendChild(a);
        ip(a, b);
    }
    var su = {
        'http://www.opengis.net/wfs': {
            Query: M(function (a, b, c) {
                var d = c[c.length - 1], e = d.featurePrefix, f = d.featureNS, g = d.propertyNames, h = d.srsName;
                a.setAttribute('typeName', e ? pu(e, b) : b);
                h && a.setAttribute('srsName', h);
                f && a.setAttributeNS('http://www.w3.org/2000/xmlns/', 'xmlns:' + e, f);
                b = kb({}, d);
                b.node = a;
                Do(b, nu, yo('PropertyName'), g, c);
                if (d = d.filter)
                    g = no('http://www.opengis.net/ogc', 'Filter'), a.appendChild(g), Do({ node: g }, su, yo(d.rc), [d], c);
            })
        },
        'http://www.opengis.net/ogc': {
            During: M(function (a, b) {
                var c = no('http://www.opengis.net/fes', 'ValueReference');
                ip(c, b.b);
                a.appendChild(c);
                c = no('http://www.opengis.net/gml', 'TimePeriod');
                a.appendChild(c);
                a = no('http://www.opengis.net/gml', 'begin');
                c.appendChild(a);
                xu(a, b.a);
                a = no('http://www.opengis.net/gml', 'end');
                c.appendChild(a);
                xu(a, b.g);
            }),
            And: M(ru),
            Or: M(ru),
            Not: M(function (a, b, c) {
                b = b.condition;
                Do({ node: a }, su, yo(b.rc), [b], c);
            }),
            BBOX: M(function (a, b, c) {
                c[c.length - 1].srsName = b.srsName;
                uu(a, b.geometryName);
                Kp.prototype.Yc(a, b.extent, c);
            }),
            Contains: M(function (a, b, c) {
                c[c.length - 1].srsName = b.srsName;
                uu(a, b.geometryName);
                Kp.prototype.Yc(a, b.geometry, c);
            }),
            Intersects: M(function (a, b, c) {
                c[c.length - 1].srsName = b.srsName;
                uu(a, b.geometryName);
                Kp.prototype.Yc(a, b.geometry, c);
            }),
            Within: M(function (a, b, c) {
                c[c.length - 1].srsName = b.srsName;
                uu(a, b.geometryName);
                Kp.prototype.Yc(a, b.geometry, c);
            }),
            PropertyIsEqualTo: M(tu),
            PropertyIsNotEqualTo: M(tu),
            PropertyIsLessThan: M(tu),
            PropertyIsLessThanOrEqualTo: M(tu),
            PropertyIsGreaterThan: M(tu),
            PropertyIsGreaterThanOrEqualTo: M(tu),
            PropertyIsNull: M(function (a, b) {
                uu(a, b.b);
            }),
            PropertyIsBetween: M(function (a, b) {
                uu(a, b.b);
                var c = no('http://www.opengis.net/ogc', 'LowerBoundary');
                a.appendChild(c);
                vu(c, '' + b.a);
                c = no('http://www.opengis.net/ogc', 'UpperBoundary');
                a.appendChild(c);
                vu(c, '' + b.g);
            }),
            PropertyIsLike: M(function (a, b) {
                a.setAttribute('wildCard', b.f);
                a.setAttribute('singleChar', b.i);
                a.setAttribute('escapeChar', b.g);
                void 0 !== b.a && a.setAttribute('matchCase', b.a.toString());
                uu(a, b.b);
                vu(a, '' + b.c);
            })
        }
    };
    du.prototype.s = function (a) {
        var b = no('http://www.opengis.net/wfs', 'GetFeature');
        b.setAttribute('service', 'WFS');
        b.setAttribute('version', '1.1.0');
        if (a) {
            a.handle && b.setAttribute('handle', a.handle);
            a.outputFormat && b.setAttribute('outputFormat', a.outputFormat);
            void 0 !== a.maxFeatures && b.setAttribute('maxFeatures', a.maxFeatures);
            a.resultType && b.setAttribute('resultType', a.resultType);
            void 0 !== a.startIndex && b.setAttribute('startIndex', a.startIndex);
            void 0 !== a.count && b.setAttribute('count', a.count);
            var c = a.filter;
            if (a.bbox) {
                oa(a.geometryName, 12);
                var d = cu(a.geometryName, a.bbox, a.srsName);
                c ? c = bu(c, d) : c = d;
            }
        }
        b.setAttributeNS('http://www.w3.org/2001/XMLSchema-instance', 'xsi:schemaLocation', this.l);
        c = {
            node: b,
            srsName: a.srsName,
            featureNS: a.featureNS ? a.featureNS : this.a,
            featurePrefix: a.featurePrefix,
            geometryName: a.geometryName,
            filter: c,
            propertyNames: a.propertyNames ? a.propertyNames : []
        };
        oa(Array.isArray(a.featureTypes), 11);
        a = a.featureTypes;
        c = [c];
        d = kb({}, c[c.length - 1]);
        d.node = b;
        Do(d, su, yo('Query'), a, c);
        return b;
    };
    du.prototype.v = function (a, b, c, d) {
        var e = [], f = no('http://www.opengis.net/wfs', 'Transaction'), g = d.version ? d.version : '1.1.0', h = '1.0.0' === g ? 2 : 3;
        f.setAttribute('service', 'WFS');
        f.setAttribute('version', g);
        if (d) {
            var l = d.gmlOptions ? d.gmlOptions : {};
            d.handle && f.setAttribute('handle', d.handle);
        }
        f.setAttributeNS('http://www.w3.org/2001/XMLSchema-instance', 'xsi:schemaLocation', eu[g]);
        var m = d.featurePrefix ? d.featurePrefix : 'feature';
        a && (g = {
            node: f,
            featureNS: d.featureNS,
            featureType: d.featureType,
            featurePrefix: m,
            gmlVersion: h,
            hasZ: d.hasZ,
            srsName: d.srsName
        }, kb(g, l), Do(g, qu, yo('Insert'), a, e));
        b && (g = {
            node: f,
            featureNS: d.featureNS,
            featureType: d.featureType,
            featurePrefix: m,
            gmlVersion: h,
            hasZ: d.hasZ,
            srsName: d.srsName
        }, kb(g, l), Do(g, qu, yo('Update'), b, e));
        c && Do({
            node: f,
            featureNS: d.featureNS,
            featureType: d.featureType,
            featurePrefix: m,
            gmlVersion: h,
            srsName: d.srsName
        }, qu, yo('Delete'), c, e);
        d.nativeElements && Do({
            node: f,
            featureNS: d.featureNS,
            featureType: d.featureType,
            featurePrefix: m,
            gmlVersion: h,
            srsName: d.srsName
        }, qu, yo('Native'), d.nativeElements, e);
        return f;
    };
    du.prototype.Sg = function (a) {
        for (a = a.firstChild; a; a = a.nextSibling)
            if (a.nodeType == Node.ELEMENT_NODE)
                return this.uf(a);
        return null;
    };
    du.prototype.uf = function (a) {
        if (a.firstElementChild && a.firstElementChild.firstElementChild)
            for (a = a.firstElementChild.firstElementChild, a = a.firstElementChild; a; a = a.nextElementSibling)
                if (0 !== a.childNodes.length && (1 !== a.childNodes.length || 3 !== a.firstChild.nodeType)) {
                    var b = [{}];
                    this.b.rf(a, b);
                    return Ob(b.pop().srsName);
                }
        return null;
    };
    function Ku(a) {
        a = a ? a : {};
        Go.call(this);
        this.b = void 0 !== a.splitCollection ? a.splitCollection : !1;
    }
    w(Ku, Vq);
    function Lu(a) {
        a = a.W();
        return 0 === a.length ? '' : a.join(' ');
    }
    function Mu(a) {
        a = a.W();
        for (var b = [], c = 0, d = a.length; c < d; ++c)
            b.push(a[c].join(' '));
        return b.join(',');
    }
    function Nu(a) {
        var b = [];
        a = a.Ud();
        for (var c = 0, d = a.length; c < d; ++c)
            b.push('(' + Mu(a[c]) + ')');
        return b.join(',');
    }
    function Ou(a) {
        var b = a.S(), c = (0, Pu[b])(a);
        b = b.toUpperCase();
        if (a instanceof hf) {
            a = a.ja;
            var d = '';
            if ('XYZ' === a || 'XYZM' === a)
                d += 'Z';
            if ('XYM' === a || 'XYZM' === a)
                d += 'M';
            a = d;
            0 < a.length && (b += ' ' + a);
        }
        return 0 === c.length ? b + ' EMPTY' : b + '(' + c + ')';
    }
    var Pu = {
        Point: Lu,
        LineString: Mu,
        Polygon: Nu,
        MultiPoint: function (a) {
            var b = [];
            a = a.de();
            for (var c = 0, d = a.length; c < d; ++c)
                b.push('(' + Lu(a[c]) + ')');
            return b.join(',');
        },
        MultiLineString: function (a) {
            var b = [];
            a = a.wd();
            for (var c = 0, d = a.length; c < d; ++c)
                b.push('(' + Mu(a[c]) + ')');
            return b.join(',');
        },
        MultiPolygon: function (a) {
            var b = [];
            a = a.Vd();
            for (var c = 0, d = a.length; c < d; ++c)
                b.push('(' + Nu(a[c]) + ')');
            return b.join(',');
        },
        GeometryCollection: function (a) {
            var b = [];
            a = a.vd();
            for (var c = 0, d = a.length; c < d; ++c)
                b.push(Ou(a[c]));
            return b.join(',');
        }
    };
    k = Ku.prototype;
    k.fe = function (a, b) {
        return (a = this.Gd(a, b)) ? (b = new Hk(), b.Va(a), b) : null;
    };
    k.Ng = function (a, b) {
        var c = [];
        a = this.Gd(a, b);
        this.b && 'GeometryCollection' == a.S() ? c = a.a : c = [a];
        b = [];
        for (var d = 0, e = c.length; d < e; ++d)
            a = new Hk(), a.Va(c[d]), b.push(a);
        return b;
    };
    k.Gd = function (a, b) {
        a = new Qu(new Ru(a));
        Su(a);
        return (a = Tu(a)) ? Jo(a, !1, b) : null;
    };
    k.pe = function (a, b) {
        return (a = a.U()) ? this.Kd(a, b) : '';
    };
    k.nh = function (a, b) {
        if (1 == a.length)
            return this.pe(a[0], b);
        for (var c = [], d = 0, e = a.length; d < e; ++d)
            c.push(a[d].U());
        a = new Mq(c);
        return this.Kd(a, b);
    };
    k.Kd = function (a, b) {
        return Ou(Jo(a, !0, b));
    };
    function Ru(a) {
        this.a = a;
        this.b = -1;
    }
    function Uu(a) {
        var b = a.a.charAt(++a.b), c = {
                position: a.b,
                value: b
            };
        if ('(' == b)
            c.type = 2;
        else if (',' == b)
            c.type = 5;
        else if (')' == b)
            c.type = 3;
        else if ('0' <= b && '9' >= b || '.' == b || '-' == b) {
            c.type = 4;
            b = a.b;
            var d = !1, e = !1;
            do {
                if ('.' == f)
                    d = !0;
                else if ('e' == f || 'E' == f)
                    e = !0;
                var f = a.a.charAt(++a.b);
            } while ('0' <= f && '9' >= f || '.' == f && (void 0 === d || !d) || !e && ('e' == f || 'E' == f) || e && ('-' == f || '+' == f));
            a = parseFloat(a.a.substring(b, a.b--));
            c.value = a;
        } else if ('a' <= b && 'z' >= b || 'A' <= b && 'Z' >= b) {
            c.type = 1;
            b = a.b;
            do
                f = a.a.charAt(++a.b);
            while ('a' <= f && 'z' >= f || 'A' <= f && 'Z' >= f);
            a = a.a.substring(b, a.b--).toUpperCase();
            c.value = a;
        } else {
            if (' ' == b || '\t' == b || '\r' == b || '\n' == b)
                return Uu(a);
            if ('' === b)
                c.type = 6;
            else
                throw Error('Unexpected character: ' + b);
        }
        return c;
    }
    function Qu(a) {
        this.g = a;
        this.a = 'XY';
    }
    function Su(a) {
        a.b = Uu(a.g);
    }
    function Vu(a, b) {
        (b = a.b.type == b) && Su(a);
        return b;
    }
    function Tu(a) {
        var b = a.b;
        if (Vu(a, 1)) {
            b = b.value;
            var c = 'XY', d = a.b;
            1 == a.b.type && (d = d.value, 'Z' === d ? c = 'XYZ' : 'M' === d ? c = 'XYM' : 'ZM' === d && (c = 'XYZM'), 'XY' !== c && Su(a));
            a.a = c;
            if ('GEOMETRYCOLLECTION' == b) {
                a: {
                    if (Vu(a, 2)) {
                        b = [];
                        do
                            b.push(Tu(a));
                        while (Vu(a, 5));
                        if (Vu(a, 3)) {
                            a = b;
                            break a;
                        }
                    } else if (Wu(a)) {
                        a = [];
                        break a;
                    }
                    throw Error(Xu(a));
                }
                return new Mq(a);
            }
            d = Yu[b];
            c = Zu[b];
            if (!d || !c)
                throw Error('Invalid geometry type: ' + b);
            b = d.call(a);
            return new c(b, a.a);
        }
        throw Error(Xu(a));
    }
    k = Qu.prototype;
    k.Hg = function () {
        if (Vu(this, 2)) {
            var a = $u(this);
            if (Vu(this, 3))
                return a;
        } else if (Wu(this))
            return null;
        throw Error(Xu(this));
    };
    k.Gg = function () {
        if (Vu(this, 2)) {
            var a = av(this);
            if (Vu(this, 3))
                return a;
        } else if (Wu(this))
            return [];
        throw Error(Xu(this));
    };
    k.Ig = function () {
        if (Vu(this, 2)) {
            var a = bv(this);
            if (Vu(this, 3))
                return a;
        } else if (Wu(this))
            return [];
        throw Error(Xu(this));
    };
    k.Hp = function () {
        if (Vu(this, 2)) {
            var a;
            if (2 == this.b.type)
                for (a = [this.Hg()]; Vu(this, 5);)
                    a.push(this.Hg());
            else
                a = av(this);
            if (Vu(this, 3))
                return a;
        } else if (Wu(this))
            return [];
        throw Error(Xu(this));
    };
    k.Gp = function () {
        if (Vu(this, 2)) {
            var a = bv(this);
            if (Vu(this, 3))
                return a;
        } else if (Wu(this))
            return [];
        throw Error(Xu(this));
    };
    k.Ip = function () {
        if (Vu(this, 2)) {
            for (var a = [this.Ig()]; Vu(this, 5);)
                a.push(this.Ig());
            if (Vu(this, 3))
                return a;
        } else if (Wu(this))
            return [];
        throw Error(Xu(this));
    };
    function $u(a) {
        for (var b = [], c = a.a.length, d = 0; d < c; ++d) {
            var e = a.b;
            if (Vu(a, 4))
                b.push(e.value);
            else
                break;
        }
        if (b.length == c)
            return b;
        throw Error(Xu(a));
    }
    function av(a) {
        for (var b = [$u(a)]; Vu(a, 5);)
            b.push($u(a));
        return b;
    }
    function bv(a) {
        for (var b = [a.Gg()]; Vu(a, 5);)
            b.push(a.Gg());
        return b;
    }
    function Wu(a) {
        var b = 1 == a.b.type && 'EMPTY' == a.b.value;
        b && Su(a);
        return b;
    }
    function Xu(a) {
        return 'Unexpected `' + a.b.value + '` at position ' + a.b.position + ' in `' + a.g.a + '`';
    }
    var Zu = {
            POINT: C,
            LINESTRING: I,
            POLYGON: D,
            MULTIPOINT: No,
            MULTILINESTRING: P,
            MULTIPOLYGON: Q
        }, Yu = {
            POINT: Qu.prototype.Hg,
            LINESTRING: Qu.prototype.Gg,
            POLYGON: Qu.prototype.Ig,
            MULTIPOINT: Qu.prototype.Hp,
            MULTILINESTRING: Qu.prototype.Gp,
            MULTIPOLYGON: Qu.prototype.Ip
        };
    function cv(a) {
        return a.getAttributeNS('http://www.w3.org/1999/xlink', 'href');
    }
    function dv() {
    }
    dv.prototype.read = function (a) {
        return qo(a) ? this.a(a) : ro(a) ? this.b(a) : 'string' === typeof a ? (a = so(a), this.a(a)) : null;
    };
    function ev() {
        this.version = void 0;
    }
    w(ev, dv);
    ev.prototype.a = function (a) {
        for (a = a.firstChild; a; a = a.nextSibling)
            if (a.nodeType == Node.ELEMENT_NODE)
                return this.b(a);
        return null;
    };
    ev.prototype.b = function (a) {
        this.version = a.getAttribute('version').trim();
        return (a = O({ version: this.version }, fv, a, [])) ? a : null;
    };
    function gv(a, b) {
        return O({}, hv, a, b);
    }
    function iv(a, b) {
        return O({}, jv, a, b);
    }
    function kv(a, b) {
        if (b = gv(a, b))
            return a = [
                gp(a.getAttribute('width')),
                gp(a.getAttribute('height'))
            ], b.size = a, b;
    }
    function lv(a, b) {
        return O([], mv, a, b);
    }
    var nv = [
            null,
            'http://www.opengis.net/wms'
        ], fv = N(nv, {
            Service: L(function (a, b) {
                return O({}, ov, a, b);
            }),
            Capability: L(function (a, b) {
                return O({}, pv, a, b);
            })
        }), pv = N(nv, {
            Request: L(function (a, b) {
                return O({}, qv, a, b);
            }),
            Exception: L(function (a, b) {
                return O([], rv, a, b);
            }),
            Layer: L(function (a, b) {
                return O({}, sv, a, b);
            })
        }), ov = N(nv, {
            Name: L(R),
            Title: L(R),
            Abstract: L(R),
            KeywordList: L(lv),
            OnlineResource: L(cv),
            ContactInformation: L(function (a, b) {
                return O({}, tv, a, b);
            }),
            Fees: L(R),
            AccessConstraints: L(R),
            LayerLimit: L(fp),
            MaxWidth: L(fp),
            MaxHeight: L(fp)
        }), tv = N(nv, {
            ContactPersonPrimary: L(function (a, b) {
                return O({}, uv, a, b);
            }),
            ContactPosition: L(R),
            ContactAddress: L(function (a, b) {
                return O({}, vv, a, b);
            }),
            ContactVoiceTelephone: L(R),
            ContactFacsimileTelephone: L(R),
            ContactElectronicMailAddress: L(R)
        }), uv = N(nv, {
            ContactPerson: L(R),
            ContactOrganization: L(R)
        }), vv = N(nv, {
            AddressType: L(R),
            Address: L(R),
            City: L(R),
            StateOrProvince: L(R),
            PostCode: L(R),
            Country: L(R)
        }), rv = N(nv, { Format: uo(R) }), sv = N(nv, {
            Name: L(R),
            Title: L(R),
            Abstract: L(R),
            KeywordList: L(lv),
            CRS: wo(R),
            EX_GeographicBoundingBox: L(function (a, b) {
                var c = O({}, wv, a, b);
                if (c) {
                    a = c.westBoundLongitude;
                    b = c.southBoundLatitude;
                    var d = c.eastBoundLongitude;
                    c = c.northBoundLatitude;
                    if (void 0 !== a && void 0 !== b && void 0 !== d && void 0 !== c)
                        return [
                            a,
                            b,
                            d,
                            c
                        ];
                }
            }),
            BoundingBox: wo(function (a) {
                var b = [
                        ep(a.getAttribute('minx')),
                        ep(a.getAttribute('miny')),
                        ep(a.getAttribute('maxx')),
                        ep(a.getAttribute('maxy'))
                    ], c = [
                        ep(a.getAttribute('resx')),
                        ep(a.getAttribute('resy'))
                    ];
                return {
                    crs: a.getAttribute('CRS'),
                    extent: b,
                    res: c
                };
            }),
            Dimension: wo(function (a) {
                return {
                    name: a.getAttribute('name'),
                    units: a.getAttribute('units'),
                    unitSymbol: a.getAttribute('unitSymbol'),
                    'default': a.getAttribute('default'),
                    multipleValues: bp(a.getAttribute('multipleValues')),
                    nearestValue: bp(a.getAttribute('nearestValue')),
                    current: bp(a.getAttribute('current')),
                    values: R(a)
                };
            }),
            Attribution: L(function (a, b) {
                return O({}, xv, a, b);
            }),
            AuthorityURL: wo(function (a, b) {
                if (b = gv(a, b))
                    return b.name = a.getAttribute('name'), b;
            }),
            Identifier: wo(R),
            MetadataURL: wo(function (a, b) {
                if (b = gv(a, b))
                    return b.type = a.getAttribute('type'), b;
            }),
            DataURL: wo(gv),
            FeatureListURL: wo(gv),
            Style: wo(function (a, b) {
                return O({}, yv, a, b);
            }),
            MinScaleDenominator: L(dp),
            MaxScaleDenominator: L(dp),
            Layer: wo(function (a, b) {
                var c = b[b.length - 1], d = O({}, sv, a, b);
                if (d)
                    return b = bp(a.getAttribute('queryable')), void 0 === b && (b = c.queryable), d.queryable = void 0 !== b ? b : !1, b = gp(a.getAttribute('cascaded')), void 0 === b && (b = c.cascaded), d.cascaded = b, b = bp(a.getAttribute('opaque')), void 0 === b && (b = c.opaque), d.opaque = void 0 !== b ? b : !1, b = bp(a.getAttribute('noSubsets')), void 0 === b && (b = c.noSubsets), d.noSubsets = void 0 !== b ? b : !1, (b = ep(a.getAttribute('fixedWidth'))) || (b = c.fixedWidth), d.fixedWidth = b, (a = ep(a.getAttribute('fixedHeight'))) || (a = c.fixedHeight), d.fixedHeight = a, [
                        'Style',
                        'CRS',
                        'AuthorityURL'
                    ].forEach(function (a) {
                        a in c && (d[a] = (d[a] || []).concat(c[a]));
                    }), 'EX_GeographicBoundingBox BoundingBox Dimension Attribution MinScaleDenominator MaxScaleDenominator'.split(' ').forEach(function (a) {
                        a in d || (d[a] = c[a]);
                    }), d;
            })
        }), xv = N(nv, {
            Title: L(R),
            OnlineResource: L(cv),
            LogoURL: L(kv)
        }), wv = N(nv, {
            westBoundLongitude: L(dp),
            eastBoundLongitude: L(dp),
            southBoundLatitude: L(dp),
            northBoundLatitude: L(dp)
        }), qv = N(nv, {
            GetCapabilities: L(iv),
            GetMap: L(iv),
            GetFeatureInfo: L(iv)
        }), jv = N(nv, {
            Format: wo(R),
            DCPType: wo(function (a, b) {
                return O({}, zv, a, b);
            })
        }), zv = N(nv, {
            HTTP: L(function (a, b) {
                return O({}, Av, a, b);
            })
        }), Av = N(nv, {
            Get: L(gv),
            Post: L(gv)
        }), yv = N(nv, {
            Name: L(R),
            Title: L(R),
            Abstract: L(R),
            LegendURL: wo(kv),
            StyleSheetURL: L(gv),
            StyleURL: L(gv)
        }), hv = N(nv, {
            Format: L(R),
            OnlineResource: L(cv)
        }), mv = N(nv, { Keyword: uo(R) });
    function Bv(a) {
        a = a ? a : {};
        this.a = 'http://mapserver.gis.umn.edu/mapserver';
        this.b = new Tp();
        this.c = a.layers ? a.layers : null;
        Wo.call(this);
    }
    w(Bv, Wo);
    Bv.prototype.Kc = function (a, b) {
        var c = {};
        b && kb(c, Ho(this, a, b));
        c = [c];
        a.setAttribute('namespaceURI', this.a);
        var d = a.localName;
        b = [];
        if (0 !== a.childNodes.length) {
            if ('msGMLOutput' == d)
                for (var e = 0, f = a.childNodes.length; e < f; e++) {
                    var g = a.childNodes[e];
                    if (g.nodeType === Node.ELEMENT_NODE) {
                        var h = c[0], l = g.localName.replace('_layer', '');
                        if (!this.c || ec(this.c, l)) {
                            l += '_feature';
                            h.featureType = l;
                            h.featureNS = this.a;
                            var m = {};
                            m[l] = uo(this.b.Kg, this.b);
                            h = N([
                                h.featureNS,
                                null
                            ], m);
                            g.setAttribute('namespaceURI', this.a);
                            (g = O([], h, g, c, this.b)) && gc(b, g);
                        }
                    }
                }
            'FeatureCollection' == d && (a = O([], this.b.b, a, [{}], this.b)) && (b = a);
        }
        return b;
    };
    Bv.prototype.mh = function () {
    };
    Bv.prototype.bc = function () {
    };
    Bv.prototype.re = function () {
    };
    function Cv() {
    }
    w(Cv, dv);
    Cv.prototype.a = function (a) {
        for (a = a.firstChild; a; a = a.nextSibling)
            if (a.nodeType == Node.ELEMENT_NODE)
                return this.b(a);
        return null;
    };
    Cv.prototype.b = function (a) {
        return (a = O({}, Dv, a, [])) ? a : null;
    };
    var Ev = [
            null,
            'http://www.opengis.net/ows/1.1'
        ], Dv = N(Ev, {
            ServiceIdentification: L(function (a, b) {
                return O({}, Fv, a, b);
            }),
            ServiceProvider: L(function (a, b) {
                return O({}, Gv, a, b);
            }),
            OperationsMetadata: L(function (a, b) {
                return O({}, Hv, a, b);
            })
        }), Iv = N(Ev, {
            DeliveryPoint: L(R),
            City: L(R),
            AdministrativeArea: L(R),
            PostalCode: L(R),
            Country: L(R),
            ElectronicMailAddress: L(R)
        }), Jv = N(Ev, {
            Value: wo(function (a) {
                return R(a);
            })
        }), Kv = N(Ev, {
            AllowedValues: L(function (a, b) {
                return O({}, Jv, a, b);
            })
        }), Mv = N(Ev, {
            Phone: L(function (a, b) {
                return O({}, Lv, a, b);
            }),
            Address: L(function (a, b) {
                return O({}, Iv, a, b);
            })
        }), Ov = N(Ev, {
            HTTP: L(function (a, b) {
                return O({}, Nv, a, b);
            })
        }), Nv = N(Ev, {
            Get: wo(function (a, b) {
                var c = cv(a);
                if (c)
                    return O({ href: c }, Pv, a, b);
            }),
            Post: void 0
        }), Qv = N(Ev, {
            DCP: L(function (a, b) {
                return O({}, Ov, a, b);
            })
        }), Hv = N(Ev, {
            Operation: function (a, b) {
                var c = a.getAttribute('name');
                (a = O({}, Qv, a, b)) && (b[b.length - 1][c] = a);
            }
        }), Lv = N(Ev, {
            Voice: L(R),
            Facsimile: L(R)
        }), Pv = N(Ev, {
            Constraint: wo(function (a, b) {
                var c = a.getAttribute('name');
                if (c)
                    return O({ name: c }, Kv, a, b);
            })
        }), Rv = N(Ev, {
            IndividualName: L(R),
            PositionName: L(R),
            ContactInfo: L(function (a, b) {
                return O({}, Mv, a, b);
            })
        }), Fv = N(Ev, {
            Abstract: L(R),
            AccessConstraints: L(R),
            Fees: L(R),
            Title: L(R),
            ServiceTypeVersion: L(R),
            ServiceType: L(R)
        }), Gv = N(Ev, {
            ProviderName: L(R),
            ProviderSite: L(cv),
            ServiceContact: L(function (a, b) {
                return O({}, Rv, a, b);
            })
        });
    function Sv() {
        this.g = new Cv();
    }
    w(Sv, dv);
    Sv.prototype.a = function (a) {
        for (a = a.firstChild; a; a = a.nextSibling)
            if (a.nodeType == Node.ELEMENT_NODE)
                return this.b(a);
        return null;
    };
    Sv.prototype.b = function (a) {
        var b = a.getAttribute('version').trim(), c = this.g.b(a);
        if (!c)
            return null;
        c.version = b;
        return (c = O(c, Tv, a, [])) ? c : null;
    };
    function Uv(a) {
        var b = R(a).split(' ');
        if (b && 2 == b.length && (a = +b[0], b = +b[1], !isNaN(a) && !isNaN(b)))
            return [
                a,
                b
            ];
    }
    var Vv = [
            null,
            'http://www.opengis.net/wmts/1.0'
        ], Wv = [
            null,
            'http://www.opengis.net/ows/1.1'
        ], Tv = N(Vv, {
            Contents: L(function (a, b) {
                return O({}, Xv, a, b);
            })
        }), Xv = N(Vv, {
            Layer: wo(function (a, b) {
                return O({}, Yv, a, b);
            }),
            TileMatrixSet: wo(function (a, b) {
                return O({}, Zv, a, b);
            })
        }), Yv = N(Vv, {
            Style: wo(function (a, b) {
                if (b = O({}, $v, a, b))
                    return a = 'true' === a.getAttribute('isDefault'), b.isDefault = a, b;
            }),
            Format: wo(R),
            TileMatrixSetLink: wo(function (a, b) {
                return O({}, aw, a, b);
            }),
            Dimension: wo(function (a, b) {
                return O({}, bw, a, b);
            }),
            ResourceURL: wo(function (a) {
                var b = a.getAttribute('format'), c = a.getAttribute('template');
                a = a.getAttribute('resourceType');
                var d = {};
                b && (d.format = b);
                c && (d.template = c);
                a && (d.resourceType = a);
                return d;
            })
        }, N(Wv, {
            Title: L(R),
            Abstract: L(R),
            WGS84BoundingBox: L(function (a, b) {
                a = O([], cw, a, b);
                if (2 == a.length)
                    return Ca(a);
            }),
            Identifier: L(R)
        })), $v = N(Vv, {
            LegendURL: wo(function (a) {
                var b = {};
                b.format = a.getAttribute('format');
                b.href = cv(a);
                return b;
            })
        }, N(Wv, {
            Title: L(R),
            Identifier: L(R)
        })), aw = N(Vv, {
            TileMatrixSet: L(R),
            TileMatrixSetLimits: L(function (a, b) {
                return O([], dw, a, b);
            })
        }), dw = N(Vv, {
            TileMatrixLimits: uo(function (a, b) {
                return O({}, ew, a, b);
            })
        }), ew = N(Vv, {
            TileMatrix: L(R),
            MinTileRow: L(fp),
            MaxTileRow: L(fp),
            MinTileCol: L(fp),
            MaxTileCol: L(fp)
        }), bw = N(Vv, {
            Default: L(R),
            Value: wo(R)
        }, N(Wv, { Identifier: L(R) })), cw = N(Wv, {
            LowerCorner: uo(Uv),
            UpperCorner: uo(Uv)
        }), Zv = N(Vv, {
            WellKnownScaleSet: L(R),
            TileMatrix: wo(function (a, b) {
                return O({}, fw, a, b);
            })
        }, N(Wv, {
            SupportedCRS: L(R),
            Identifier: L(R)
        })), fw = N(Vv, {
            TopLeftCorner: L(Uv),
            ScaleDenominator: L(dp),
            TileWidth: L(fp),
            TileHeight: L(fp),
            MatrixWidth: L(fp),
            MatrixHeight: L(fp)
        }, N(Wv, { Identifier: L(R) }));
    function gw(a, b, c) {
        hf.call(this);
        this.hh(a, b ? b : 0, c);
    }
    w(gw, hf);
    k = gw.prototype;
    k.clone = function () {
        var a = new gw(null);
        kf(a, this.ja, this.A.slice());
        a.u();
        return a;
    };
    k.Nb = function (a, b, c, d) {
        var e = this.A;
        a -= e[0];
        var f = b - e[1];
        b = a * a + f * f;
        if (b < d) {
            if (0 === b)
                for (d = 0; d < this.a; ++d)
                    c[d] = e[d];
            else
                for (d = this.Bd() / Math.sqrt(b), c[0] = e[0] + d * a, c[1] = e[1] + d * f, d = 2; d < this.a; ++d)
                    c[d] = e[d];
            c.length = this.a;
            return b;
        }
        return d;
    };
    k.Zc = function (a, b) {
        var c = this.A;
        a -= c[0];
        b -= c[1];
        return a * a + b * b <= hw(this);
    };
    k.xa = function () {
        return this.A.slice(0, this.a);
    };
    k.Ae = function (a) {
        var b = this.A, c = b[this.a] - b[0];
        return Na(b[0] - c, b[1] - c, b[0] + c, b[1] + c, a);
    };
    k.Bd = function () {
        return Math.sqrt(hw(this));
    };
    function hw(a) {
        var b = a.A[a.a] - a.A[0];
        a = a.A[a.a + 1] - a.A[1];
        return b * b + a * a;
    }
    k.S = function () {
        return 'Circle';
    };
    k.$a = function (a) {
        var b = this.G();
        return hb(a, b) ? (b = this.xa(), a[0] <= b[0] && a[2] >= b[0] || a[1] <= b[1] && a[3] >= b[1] ? !0 : Ua(a, this.Bb, this)) : !1;
    };
    k.ub = function (a) {
        var b = this.a, c = a.slice();
        c[b] = c[0] + (this.A[b] - this.A[0]);
        var d;
        for (d = 1; d < b; ++d)
            c[b + d] = a[d];
        kf(this, this.ja, c);
        this.u();
    };
    k.hh = function (a, b, c) {
        if (a) {
            lf(this, c, a, 0);
            this.A || (this.A = []);
            c = this.A;
            a = vf(c, a);
            c[a++] = c[0] + b;
            var d;
            b = 1;
            for (d = this.a; b < d; ++b)
                c[a++] = c[b];
            c.length = a;
        } else
            kf(this, 'XY', null);
        this.u();
    };
    k.W = function () {
    };
    k.na = function () {
    };
    k.fd = function (a) {
        this.A[this.a] = this.A[0] + a;
        this.u();
    };
    function iw(a) {
        a = a ? a : {};
        Jg.call(this, { handleEvent: Re });
        this.j = a.formatConstructors ? a.formatConstructors : [];
        this.s = a.projection ? Ob(a.projection) : null;
        this.a = null;
        this.f = a.source || null;
        this.target = a.target ? a.target : null;
    }
    w(iw, Jg);
    function jw(a) {
        a = a.dataTransfer.files;
        var b;
        var c = 0;
        for (b = a.length; c < b; ++c) {
            var d = a.item(c);
            var e = new FileReader();
            e.addEventListener('load', this.l.bind(this, d));
            e.readAsText(d);
        }
    }
    function kw(a) {
        a.stopPropagation();
        a.preventDefault();
        a.dataTransfer.dropEffect = 'copy';
    }
    iw.prototype.l = function (a, b) {
        b = b.target.result;
        var c = this.v, d = this.s;
        d || (d = c.aa().v);
        c = this.j;
        var e = [], f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var h = new c[g]();
            var l = { featureProjection: d };
            try {
                e = h.Qa(b, l);
            } catch (m) {
                e = null;
            }
            if (e && 0 < e.length)
                break;
        }
        this.f && (this.f.clear(), this.f.Qc(e));
        this.b(new lw(mw, a, e, d));
    };
    function nw(a) {
        var b = a.v;
        b && (b = a.target ? a.target : b.a, a.a = [
            y(b, 'drop', jw, a),
            y(b, 'dragenter', kw, a),
            y(b, 'dragover', kw, a),
            y(b, 'drop', kw, a)
        ]);
    }
    iw.prototype.Ha = function (a) {
        Jg.prototype.Ha.call(this, a);
        a ? nw(this) : ow(this);
    };
    iw.prototype.setMap = function (a) {
        ow(this);
        Jg.prototype.setMap.call(this, a);
        this.c() && nw(this);
    };
    function ow(a) {
        a.a && (a.a.forEach(Gc), a.a = null);
    }
    var mw = 'addfeatures';
    function lw(a, b, c, d) {
        Qc.call(this, a);
        this.features = c;
        this.file = b;
        this.projection = d;
    }
    w(lw, Qc);
    function pw(a) {
        a = a ? a : {};
        fh.call(this, {
            handleDownEvent: qw,
            handleDragEvent: rw,
            handleUpEvent: sw
        });
        this.s = a.condition ? a.condition : bh;
        this.a = this.f = void 0;
        this.j = 0;
        this.o = void 0 !== a.duration ? a.duration : 400;
    }
    w(pw, fh);
    function rw(a) {
        if (dh(a)) {
            var b = a.map, c = b.Cb(), d = a.pixel;
            a = d[0] - c[0] / 2;
            d = c[1] / 2 - d[1];
            c = Math.atan2(d, a);
            a = Math.sqrt(a * a + d * d);
            b = b.aa();
            b.l.rotation !== re && void 0 !== this.f && (d = c - this.f, Kg(b, b.Sa() - d));
            this.f = c;
            void 0 !== this.a && (c = this.a * (b.Pa() / a), Tg(b, c));
            void 0 !== this.a && (this.j = this.a / a);
            this.a = a;
        }
    }
    function sw(a) {
        if (!dh(a))
            return !0;
        a = a.map.aa();
        bg(a, 1, -1);
        var b = this.j - 1, c = a.Sa();
        c = a.constrainRotation(c, 0);
        Kg(a, c, void 0, void 0);
        c = a.Pa();
        var d = this.o;
        c = a.constrainResolution(c, 0, b);
        Tg(a, c, void 0, d);
        this.j = 0;
        return !1;
    }
    function qw(a) {
        return dh(a) && this.s(a) ? (bg(a.map.aa(), 1, 1), this.a = this.f = void 0, !0) : !1;
    }
    function T(a) {
        a = a ? a : {};
        var b = kb({}, a);
        delete b.style;
        delete b.renderBuffer;
        delete b.updateWhileAnimating;
        delete b.updateWhileInteracting;
        xg.call(this, b);
        this.D = void 0 !== a.declutter ? a.declutter : !1;
        this.f = void 0 !== a.renderBuffer ? a.renderBuffer : 100;
        this.C = null;
        this.V = void 0;
        this.j(a.style);
        this.ca = void 0 !== a.updateWhileAnimating ? a.updateWhileAnimating : !1;
        this.ra = void 0 !== a.updateWhileInteracting ? a.updateWhileInteracting : !1;
        this.l = a.renderMode || 'vector';
        this.type = 'VECTOR';
    }
    w(T, xg);
    T.prototype.B = function () {
        return this.C;
    };
    T.prototype.ib = function () {
        return this.V;
    };
    T.prototype.j = function (a) {
        this.C = void 0 !== a ? a : Fk;
        this.V = null === a ? void 0 : Dk(this.C);
        this.u();
    };
    var ik = 'renderOrder';
    function tw() {
        return [[
                -Infinity,
                -Infinity,
                Infinity,
                Infinity
            ]];
    }
    function uw(a) {
        Vc.call(this);
        this.c = Ob(a.projection);
        this.v = null;
        this.C = vw(this, a.attributions);
        this.T = a.logo;
        this.ra = void 0 !== a.state ? a.state : 'ready';
        this.D = void 0 !== a.wrapX ? a.wrapX : !1;
    }
    w(uw, Vc);
    function vw(a, b) {
        if (!b)
            return null;
        if (b instanceof Ec)
            return a.v = [b], function () {
                return [b.og];
            };
        if (Array.isArray(b)) {
            if (b[0] instanceof Ec) {
                a.v = b;
                var c = b.map(function (a) {
                    return a.og;
                });
                return function () {
                    return c;
                };
            }
            a.v = b.map(function (a) {
                return new Ec({ html: a });
            });
            return function () {
                return b;
            };
        }
        if ('function' === typeof b)
            return b;
        a.v = [new Ec({ html: b })];
        return function () {
            return [b];
        };
    }
    k = uw.prototype;
    k.wa = ea;
    k.za = function () {
        return this.v;
    };
    k.Aa = function () {
        return this.T;
    };
    k.Da = function () {
        return this.c;
    };
    k.getState = function () {
        return this.ra;
    };
    k.sa = function () {
        this.u();
    };
    k.va = function (a) {
        this.C = vw(this, a);
        this.u();
    };
    function ww(a, b) {
        a.ra = b;
        a.u();
    }
    function U(a) {
        a = a || {};
        uw.call(this, {
            attributions: a.attributions,
            logo: a.logo,
            projection: void 0,
            state: 'ready',
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0
        });
        this.o = ea;
        this.O = a.format;
        this.$ = void 0 == a.overlaps ? !0 : a.overlaps;
        this.V = a.url;
        void 0 !== a.loader ? this.o = a.loader : void 0 !== this.V && (oa(this.O, 7), this.o = Fo(this.V, this.O));
        this.ca = void 0 !== a.strategy ? a.strategy : tw;
        var b = void 0 !== a.useSpatialIndex ? a.useSpatialIndex : !0;
        this.a = b ? new um() : null;
        this.B = new um();
        this.f = {};
        this.j = {};
        this.l = {};
        this.s = {};
        this.i = null;
        if (a.features instanceof B) {
            var c = a.features;
            var d = c.a;
        } else
            Array.isArray(a.features) && (d = a.features);
        b || void 0 !== c || (c = new B(d));
        void 0 !== d && xw(this, d);
        void 0 !== c && yw(this, c);
    }
    w(U, uw);
    k = U.prototype;
    k.Gb = function (a) {
        var b = x(a).toString();
        if (zw(this, b, a)) {
            Aw(this, b, a);
            var c = a.U();
            c ? (b = c.G(), this.a && this.a.Ca(b, a)) : this.f[b] = a;
            this.b(new Bw('addfeature', a));
        }
        this.u();
    };
    function Aw(a, b, c) {
        a.s[b] = [
            y(c, 'change', a.gj, a),
            y(c, 'propertychange', a.gj, a)
        ];
    }
    function zw(a, b, c) {
        var d = !0, e = c.c;
        void 0 !== e ? e.toString() in a.j ? d = !1 : a.j[e.toString()] = c : (oa(!(b in a.l), 30), a.l[b] = c);
        return d;
    }
    k.Qc = function (a) {
        xw(this, a);
        this.u();
    };
    function xw(a, b) {
        var c, d = [], e = [], f = [];
        var g = 0;
        for (c = b.length; g < c; g++) {
            var h = b[g];
            var l = x(h).toString();
            zw(a, l, h) && e.push(h);
        }
        g = 0;
        for (c = e.length; g < c; g++)
            h = e[g], l = x(h).toString(), Aw(a, l, h), (b = h.U()) ? (l = b.G(), d.push(l), f.push(h)) : a.f[l] = h;
        a.a && a.a.load(d, f);
        g = 0;
        for (c = e.length; g < c; g++)
            a.b(new Bw('addfeature', e[g]));
    }
    function yw(a, b) {
        var c = !1;
        y(a, 'addfeature', function (a) {
            c || (c = !0, b.push(a.feature), c = !1);
        });
        y(a, 'removefeature', function (a) {
            c || (c = !0, b.remove(a.feature), c = !1);
        });
        y(b, 'add', function (a) {
            c || (c = !0, this.Gb(a.element), c = !1);
        }, a);
        y(b, 'remove', function (a) {
            c || (c = !0, this.Lb(a.element), c = !1);
        }, a);
        a.i = b;
    }
    k.clear = function (a) {
        if (a) {
            for (var b in this.s)
                this.s[b].forEach(Gc);
            this.i || (this.s = {}, this.j = {}, this.l = {});
        } else if (this.a) {
            this.a.forEach(this.Yg, this);
            for (var c in this.f)
                this.Yg(this.f[c]);
        }
        this.i && this.i.clear();
        this.a && this.a.clear();
        this.B.clear();
        this.f = {};
        this.b(new Bw('clear'));
        this.u();
    };
    k.Lh = function (a, b) {
        if (this.a)
            return this.a.forEach(a, b);
        if (this.i)
            return this.i.forEach(a, b);
    };
    function Cw(a, b, c) {
        a.ec([
            b[0],
            b[1],
            b[0],
            b[1]
        ], function (a) {
            if (a.U().Bb(b))
                return c.call(void 0, a);
        });
    }
    k.ec = function (a, b, c) {
        if (this.a)
            return zm(this.a, a, b, c);
        if (this.i)
            return this.i.forEach(b, c);
    };
    k.Mh = function (a, b, c) {
        return this.ec(a, function (d) {
            if (d.U().$a(a) && (d = b.call(c, d)))
                return d;
        });
    };
    k.Th = function () {
        return this.i;
    };
    k.ee = function () {
        if (this.i)
            var a = this.i.a;
        else
            this.a && (a = wm(this.a), nb(this.f) || gc(a, mb(this.f)));
        return a;
    };
    k.Sh = function (a) {
        var b = [];
        Cw(this, a, function (a) {
            b.push(a);
        });
        return b;
    };
    k.Yf = function (a) {
        return xm(this.a, a);
    };
    k.Oh = function (a, b) {
        var c = a[0], d = a[1], e = null, f = [
                NaN,
                NaN
            ], g = Infinity, h = [
                -Infinity,
                -Infinity,
                Infinity,
                Infinity
            ], l = b ? b : Re;
        zm(this.a, h, function (a) {
            if (l(a)) {
                var b = a.U(), m = g;
                g = b.Nb(c, d, f, g);
                g < m && (e = a, a = Math.sqrt(g), h[0] = c - a, h[1] = d - a, h[2] = c + a, h[3] = d + a);
            }
        });
        return e;
    };
    k.G = function (a) {
        return this.a.G(a);
    };
    k.Rh = function (a) {
        a = this.j[a.toString()];
        return void 0 !== a ? a : null;
    };
    k.ej = function () {
        return this.O;
    };
    k.fj = function () {
        return this.V;
    };
    k.gj = function (a) {
        a = a.target;
        var b = x(a).toString(), c = a.U();
        c ? (c = c.G(), b in this.f ? (delete this.f[b], this.a && this.a.Ca(c, a)) : this.a && vm(this.a, c, a)) : b in this.f || (this.a && this.a.remove(a), this.f[b] = a);
        c = a.c;
        void 0 !== c ? (c = c.toString(), b in this.l ? (delete this.l[b], this.j[c] = a) : this.j[c] !== a && (Dw(this, a), this.j[c] = a)) : b in this.l || (Dw(this, a), this.l[b] = a);
        this.u();
        this.b(new Bw('changefeature', a));
    };
    k.ae = function (a, b, c) {
        var d = this.B;
        a = this.ca(a, b);
        var e;
        var f = 0;
        for (e = a.length; f < e; ++f) {
            var g = a[f];
            zm(d, g, function (a) {
                return La(a.extent, g);
            }) || (this.o.call(this, g, b, c), d.Ca(g, { extent: g.slice() }));
        }
    };
    k.Cj = function (a) {
        var b = this.B, c;
        zm(b, a, function (b) {
            if (Sa(b.extent, a))
                return c = b, !0;
        });
        c && b.remove(c);
    };
    k.Lb = function (a) {
        var b = x(a).toString();
        b in this.f ? delete this.f[b] : this.a && this.a.remove(a);
        this.Yg(a);
        this.u();
    };
    k.Yg = function (a) {
        var b = x(a).toString();
        this.s[b].forEach(Gc);
        delete this.s[b];
        var c = a.c;
        void 0 !== c ? delete this.j[c.toString()] : delete this.l[b];
        this.b(new Bw('removefeature', a));
    };
    function Dw(a, b) {
        for (var c in a.j)
            if (a.j[c] === b) {
                delete a.j[c];
                break;
            }
    }
    k.hj = function (a) {
        this.o = a;
    };
    function Bw(a, b) {
        Qc.call(this, a);
        this.feature = b;
    }
    w(Bw, Qc);
    function Ew(a) {
        fh.call(this, {
            handleDownEvent: Fw,
            handleEvent: Gw,
            handleUpEvent: Hw
        });
        this.V = !1;
        this.ca = null;
        this.o = !1;
        this.ob = a.source ? a.source : null;
        this.La = a.features ? a.features : null;
        this.Xk = a.snapTolerance ? a.snapTolerance : 12;
        this.O = a.type;
        this.f = Iw(this.O);
        this.$k = !!a.stopClick;
        this.Ea = a.minPoints ? a.minPoints : this.f === Jw ? 3 : 2;
        this.ua = a.maxPoints ? a.maxPoints : Infinity;
        this.Md = a.finishCondition ? a.finishCondition : Re;
        var b = a.geometryFunction;
        if (!b)
            if ('Circle' === this.O)
                b = function (a, b) {
                    b = b ? b : new gw([
                        NaN,
                        NaN
                    ]);
                    b.hh(a[0], Math.sqrt(He(a[0], a[1])));
                    return b;
                };
            else {
                var c, d = this.f;
                d === Kw ? c = C : d === Lw ? c = I : d === Jw && (c = D);
                b = function (a, b) {
                    b ? d === Jw ? a[0].length ? b.na([a[0].concat([a[0][0]])]) : b.na([]) : b.na(a) : b = new c(a);
                    return b;
                };
            }
        this.cb = b;
        this.T = this.C = this.a = this.B = this.j = this.s = null;
        this.sc = a.clickTolerance ? a.clickTolerance * a.clickTolerance : 36;
        this.ra = new T({
            source: new U({
                useSpatialIndex: !1,
                wrapX: a.wrapX ? a.wrapX : !1
            }),
            style: a.style ? a.style : Mw()
        });
        this.bb = a.geometryName;
        this.Wk = a.condition ? a.condition : ah;
        this.If = a.freehand ? Re : a.freehandCondition ? a.freehandCondition : bh;
        y(this, Xc('active'), this.Ki, this);
    }
    w(Ew, fh);
    function Mw() {
        var a = Gk();
        return function (b) {
            return a[b.U().S()];
        };
    }
    k = Ew.prototype;
    k.setMap = function (a) {
        fh.prototype.setMap.call(this, a);
        this.Ki();
    };
    function Gw(a) {
        this.o = this.f !== Kw && this.If(a);
        var b = !0;
        this.o && 'pointerdrag' === a.type && null !== this.j ? (Nw(this, a), b = !1) : this.o && 'pointerdown' === a.type ? b = !1 : 'pointermove' === a.type ? b = Ow(this, a) : 'dblclick' === a.type && (b = !1);
        return gh.call(this, a) && b;
    }
    function Fw(a) {
        this.V = !this.o;
        return this.o ? (this.ca = a.pixel, this.s || Pw(this, a), !0) : this.Wk(a) ? (this.ca = a.pixel, !0) : !1;
    }
    function Hw(a) {
        var b = !0;
        Ow(this, a);
        var c = this.f === Qw;
        this.V ? (this.s ? this.o || c ? this.Pd() : Rw(this, a) ? this.Md(a) && this.Pd() : Nw(this, a) : (Pw(this, a), this.f === Kw && this.Pd()), b = !1) : this.o && (this.s = null, Sw(this));
        !b && this.$k && a.stopPropagation();
        return b;
    }
    function Ow(a, b) {
        if (a.ca && (!a.o && a.V || a.o && !a.V)) {
            var c = a.ca, d = b.pixel, e = c[0] - d[0];
            c = c[1] - d[1];
            e = e * e + c * c;
            a.V = a.o ? e > a.sc : e <= a.sc;
        }
        a.s ? (e = b.coordinate, c = a.j.U(), a.f === Kw ? d = a.a : a.f === Jw ? (d = a.a[0], d = d[d.length - 1], Rw(a, b) && (e = a.s.slice())) : (d = a.a, d = d[d.length - 1]), d[0] = e[0], d[1] = e[1], a.cb(a.a, c), a.B && a.B.U().na(e), c instanceof D && a.f !== Jw ? (a.C || (a.C = new Hk(new I(null))), e = c.Wh(0), b = a.C.U(), b.ba(e.ja, e.da())) : a.T && (b = a.C.U(), b.na(a.T)), Tw(a)) : (b = b.coordinate.slice(), a.B ? a.B.U().na(b) : (a.B = new Hk(new C(b)), Tw(a)));
        return !0;
    }
    function Rw(a, b) {
        var c = !1;
        if (a.j) {
            var d = !1, e = [a.s];
            a.f === Lw ? d = a.a.length > a.Ea : a.f === Jw && (d = a.a[0].length > a.Ea, e = [
                a.a[0][0],
                a.a[0][a.a[0].length - 2]
            ]);
            if (d) {
                d = b.map;
                for (var f = 0, g = e.length; f < g; f++) {
                    var h = e[f], l = d.Ia(h), m = b.pixel;
                    c = m[0] - l[0];
                    l = m[1] - l[1];
                    if (c = Math.sqrt(c * c + l * l) <= (a.o ? 1 : a.Xk)) {
                        a.s = h;
                        break;
                    }
                }
            }
        }
        return c;
    }
    function Pw(a, b) {
        b = b.coordinate;
        a.s = b;
        a.f === Kw ? a.a = b.slice() : a.f === Jw ? (a.a = [[
                b.slice(),
                b.slice()
            ]], a.T = a.a[0]) : (a.a = [
            b.slice(),
            b.slice()
        ], a.f === Qw && (a.T = a.a));
        a.T && (a.C = new Hk(new I(a.T)));
        b = a.cb(a.a);
        a.j = new Hk();
        a.bb && a.j.Lc(a.bb);
        a.j.Va(b);
        Tw(a);
        a.b(new Uw('drawstart', a.j));
    }
    function Nw(a, b) {
        b = b.coordinate;
        var c = a.j.U(), d;
        if (a.f === Lw) {
            a.s = b.slice();
            var e = a.a;
            e.length >= a.ua && (a.o ? e.pop() : d = !0);
            e.push(b.slice());
            a.cb(e, c);
        } else
            a.f === Jw && (e = a.a[0], e.length >= a.ua && (a.o ? e.pop() : d = !0), e.push(b.slice()), d && (a.s = e[0]), a.cb(a.a, c));
        Tw(a);
        d && a.Pd();
    }
    k.nq = function () {
        if (this.j) {
            var a = this.j.U();
            if (this.f === Lw) {
                var b = this.a;
                b.splice(-2, 1);
                this.cb(b, a);
                2 <= b.length && (this.s = b[b.length - 2].slice());
            } else if (this.f === Jw) {
                b = this.a[0];
                b.splice(-2, 1);
                var c = this.C.U();
                c.na(b);
                this.cb(this.a, a);
            }
            0 === b.length && (this.s = null);
            Tw(this);
        }
    };
    k.Pd = function () {
        var a = Sw(this), b = this.a, c = a.U();
        this.f === Lw ? (b.pop(), this.cb(b, c)) : this.f === Jw && (b[0].pop(), this.cb(b, c), b = c.W());
        'MultiPoint' === this.O ? a.Va(new No([b])) : 'MultiLineString' === this.O ? a.Va(new P([b])) : 'MultiPolygon' === this.O && a.Va(new Q([b]));
        this.b(new Uw('drawend', a));
        this.La && this.La.push(a);
        this.ob && this.ob.Gb(a);
    };
    function Sw(a) {
        a.s = null;
        var b = a.j;
        b && (a.j = null, a.B = null, a.C = null, a.ra.ha().clear(!0));
        return b;
    }
    k.Zn = function (a) {
        var b = a.U();
        this.j = a;
        this.a = b.W();
        a = this.a[this.a.length - 1];
        this.s = a.slice();
        this.a.push(a.slice());
        Tw(this);
        this.b(new Uw('drawstart', this.j));
    };
    k.jd = Se;
    function Tw(a) {
        var b = [];
        a.j && b.push(a.j);
        a.C && b.push(a.C);
        a.B && b.push(a.B);
        a = a.ra.ha();
        a.clear(!0);
        a.Qc(b);
    }
    k.Ki = function () {
        var a = this.v, b = this.c();
        a && b || Sw(this);
        this.ra.setMap(b ? a : null);
    };
    function Iw(a) {
        var b;
        'Point' === a || 'MultiPoint' === a ? b = Kw : 'LineString' === a || 'MultiLineString' === a ? b = Lw : 'Polygon' === a || 'MultiPolygon' === a ? b = Jw : 'Circle' === a && (b = Qw);
        return b;
    }
    var Kw = 'Point', Lw = 'LineString', Jw = 'Polygon', Qw = 'Circle';
    function Uw(a, b) {
        Qc.call(this, a);
        this.feature = b;
    }
    w(Uw, Qc);
    function Vw(a) {
        var b = a || {};
        this.a = this.j = null;
        this.C = void 0 !== b.pixelTolerance ? b.pixelTolerance : 10;
        this.B = !1;
        this.T = this.s = null;
        a || (a = {});
        fh.call(this, {
            handleDownEvent: Ww,
            handleDragEvent: Xw,
            handleEvent: Yw,
            handleUpEvent: Zw
        });
        this.o = new T({
            source: new U({
                useSpatialIndex: !1,
                wrapX: !!a.wrapX
            }),
            style: a.boxStyle ? a.boxStyle : $w(),
            updateWhileAnimating: !0,
            updateWhileInteracting: !0
        });
        this.O = new T({
            source: new U({
                useSpatialIndex: !1,
                wrapX: !!a.wrapX
            }),
            style: a.pointerStyle ? a.pointerStyle : ax(),
            updateWhileAnimating: !0,
            updateWhileInteracting: !0
        });
        a.extent && this.f(a.extent);
    }
    w(Vw, fh);
    function Yw(a) {
        if (!(a instanceof Ad))
            return !0;
        if ('pointermove' == a.type && !this.D) {
            var b = a.pixel, c = a.map, d = bx(this, b, c);
            d || (d = c.Ra(b));
            cx(this, d);
        }
        gh.call(this, a);
        return !1;
    }
    function Ww(a) {
        function b(a) {
            var b = null, c = null;
            a[0] == e[0] ? b = e[2] : a[0] == e[2] && (b = e[0]);
            a[1] == e[1] ? c = e[3] : a[1] == e[3] && (c = e[1]);
            return null !== b && null !== c ? [
                b,
                c
            ] : null;
        }
        var c = a.pixel, d = a.map, e = this.G();
        (a = bx(this, c, d)) && e ? (c = a[0] == e[0] || a[0] == e[2] ? a[0] : null, d = a[1] == e[1] || a[1] == e[3] ? a[1] : null, null !== c && null !== d ? this.a = dx(b(a)) : null !== c ? this.a = ex(b([
            c,
            e[1]
        ]), b([
            c,
            e[3]
        ])) : null !== d && (this.a = ex(b([
            e[0],
            d
        ]), b([
            e[2],
            d
        ])))) : (a = d.Ra(c), this.f([
            a[0],
            a[1],
            a[0],
            a[1]
        ]), this.a = dx(a));
        return !0;
    }
    function Xw(a) {
        this.a && (a = a.coordinate, this.f(this.a(a)), cx(this, a));
        return !0;
    }
    function Zw() {
        this.a = null;
        var a = this.G();
        a && 0 !== ab(a) || this.f(null);
        return !1;
    }
    function $w() {
        var a = Gk();
        return function () {
            return a.Polygon;
        };
    }
    function ax() {
        var a = Gk();
        return function () {
            return a.Point;
        };
    }
    function dx(a) {
        return function (b) {
            return Ca([
                a,
                b
            ]);
        };
    }
    function ex(a, b) {
        return a[0] == b[0] ? function (c) {
            return Ca([
                a,
                [
                    c[0],
                    b[1]
                ]
            ]);
        } : a[1] == b[1] ? function (c) {
            return Ca([
                a,
                [
                    b[0],
                    c[1]
                ]
            ]);
        } : null;
    }
    function bx(a, b, c) {
        function d(a, b) {
            return Je(e, a) - Je(e, b);
        }
        var e = c.Ra(b), f = a.G();
        if (f) {
            f = [
                [
                    [
                        f[0],
                        f[1]
                    ],
                    [
                        f[0],
                        f[3]
                    ]
                ],
                [
                    [
                        f[0],
                        f[3]
                    ],
                    [
                        f[2],
                        f[3]
                    ]
                ],
                [
                    [
                        f[2],
                        f[3]
                    ],
                    [
                        f[2],
                        f[1]
                    ]
                ],
                [
                    [
                        f[2],
                        f[1]
                    ],
                    [
                        f[0],
                        f[1]
                    ]
                ]
            ];
            f.sort(d);
            f = f[0];
            var g = Be(e, f), h = c.Ia(g);
            if (Ie(b, h) <= a.C)
                return b = c.Ia(f[0]), c = c.Ia(f[1]), b = He(h, b), c = He(h, c), a.B = Math.sqrt(Math.min(b, c)) <= a.C, a.B && (g = b > c ? f[1] : f[0]), g;
        }
        return null;
    }
    function cx(a, b) {
        var c = a.T;
        c ? c.U().na(b) : (c = new Hk(new C(b)), a.T = c, a.O.ha().Gb(c));
    }
    Vw.prototype.setMap = function (a) {
        this.o.setMap(a);
        this.O.setMap(a);
        fh.prototype.setMap.call(this, a);
    };
    Vw.prototype.G = function () {
        return this.j;
    };
    Vw.prototype.f = function (a) {
        this.j = a ? a : null;
        var b = this.s;
        b ? a ? b.Va(Rf(a)) : b.Va(void 0) : (this.s = b = a ? new Hk(Rf(a)) : new Hk({}), this.o.ha().Gb(b));
        this.b(new fx(this.j));
    };
    function fx(a) {
        Qc.call(this, 'extentchanged');
        this.extent = a;
    }
    w(fx, Qc);
    function gx(a) {
        fh.call(this, {
            handleDownEvent: hx,
            handleDragEvent: ix,
            handleEvent: jx,
            handleUpEvent: kx
        });
        this.Md = a.condition ? a.condition : eh;
        this.bb = function (a) {
            return Wg(a) && $g(a);
        };
        this.ob = a.deleteCondition ? a.deleteCondition : this.bb;
        this.sc = a.insertVertexCondition ? a.insertVertexCondition : Re;
        this.La = this.f = null;
        this.Ea = [
            0,
            0
        ];
        this.C = this.T = !1;
        this.a = new um();
        this.ra = void 0 !== a.pixelTolerance ? a.pixelTolerance : 10;
        this.s = this.ua = !1;
        this.j = [];
        this.B = new T({
            source: new U({
                useSpatialIndex: !1,
                wrapX: !!a.wrapX
            }),
            style: a.style ? a.style : lx(),
            updateWhileAnimating: !0,
            updateWhileInteracting: !0
        });
        this.ca = {
            Point: this.io,
            LineString: this.Mi,
            LinearRing: this.Mi,
            Polygon: this.jo,
            MultiPoint: this.fo,
            MultiLineString: this.eo,
            MultiPolygon: this.ho,
            Circle: this.bo,
            GeometryCollection: this.co
        };
        this.V = null;
        a.source ? (this.V = a.source, a = new B(this.V.ee()), y(this.V, 'addfeature', this.vm, this), y(this.V, 'removefeature', this.xm, this)) : a = a.features;
        if (!a)
            throw Error('The modify interaction requires features or a source');
        this.o = a;
        this.o.forEach(this.xg, this);
        y(this.o, 'add', this.$n, this);
        y(this.o, 'remove', this.ao, this);
        this.O = null;
    }
    w(gx, fh);
    k = gx.prototype;
    k.xg = function (a) {
        var b = a.U();
        b && b.S() in this.ca && this.ca[b.S()].call(this, a, b);
        (b = this.v) && b.c && this.c() && mx(this, this.Ea, b);
        y(a, 'change', this.Li, this);
    };
    function nx(a, b) {
        a.C || (a.C = !0, a.b(new ox('modifystart', a.o, b)));
    }
    function px(a, b) {
        qx(a, b);
        a.f && 0 === a.o.kc() && (a.B.ha().Lb(a.f), a.f = null);
        Mc(b, 'change', a.Li, a);
    }
    function qx(a, b) {
        a = a.a;
        var c = [];
        a.forEach(function (a) {
            b === a.feature && c.push(a);
        });
        for (var d = c.length - 1; 0 <= d; --d)
            a.remove(c[d]);
    }
    k.Ha = function (a) {
        this.f && !a && (this.B.ha().Lb(this.f), this.f = null);
        fh.prototype.Ha.call(this, a);
    };
    k.setMap = function (a) {
        this.B.setMap(a);
        fh.prototype.setMap.call(this, a);
    };
    k.vm = function (a) {
        a.feature && this.o.push(a.feature);
    };
    k.xm = function (a) {
        a.feature && this.o.remove(a.feature);
    };
    k.$n = function (a) {
        this.xg(a.element);
    };
    k.Li = function (a) {
        this.s || (a = a.target, px(this, a), this.xg(a));
    };
    k.ao = function (a) {
        px(this, a.element);
    };
    k.io = function (a, b) {
        var c = b.W();
        a = {
            feature: a,
            geometry: b,
            ma: [
                c,
                c
            ]
        };
        this.a.Ca(b.G(), a);
    };
    k.fo = function (a, b) {
        var c = b.W(), d;
        var e = 0;
        for (d = c.length; e < d; ++e) {
            var f = c[e];
            f = {
                feature: a,
                geometry: b,
                depth: [e],
                index: e,
                ma: [
                    f,
                    f
                ]
            };
            this.a.Ca(b.G(), f);
        }
    };
    k.Mi = function (a, b) {
        var c = b.W(), d;
        var e = 0;
        for (d = c.length - 1; e < d; ++e) {
            var f = c.slice(e, e + 2);
            var g = {
                feature: a,
                geometry: b,
                index: e,
                ma: f
            };
            this.a.Ca(Ca(f), g);
        }
    };
    k.eo = function (a, b) {
        var c = b.W(), d, e;
        var f = 0;
        for (e = c.length; f < e; ++f) {
            var g = c[f];
            var h = 0;
            for (d = g.length - 1; h < d; ++h) {
                var l = g.slice(h, h + 2);
                var m = {
                    feature: a,
                    geometry: b,
                    depth: [f],
                    index: h,
                    ma: l
                };
                this.a.Ca(Ca(l), m);
            }
        }
    };
    k.jo = function (a, b) {
        var c = b.W(), d, e;
        var f = 0;
        for (e = c.length; f < e; ++f) {
            var g = c[f];
            var h = 0;
            for (d = g.length - 1; h < d; ++h) {
                var l = g.slice(h, h + 2);
                var m = {
                    feature: a,
                    geometry: b,
                    depth: [f],
                    index: h,
                    ma: l
                };
                this.a.Ca(Ca(l), m);
            }
        }
    };
    k.ho = function (a, b) {
        var c = b.W(), d, e, f;
        var g = 0;
        for (f = c.length; g < f; ++g) {
            var h = c[g];
            var l = 0;
            for (e = h.length; l < e; ++l) {
                var m = h[l];
                var n = 0;
                for (d = m.length - 1; n < d; ++n) {
                    var p = m.slice(n, n + 2);
                    var q = {
                        feature: a,
                        geometry: b,
                        depth: [
                            l,
                            g
                        ],
                        index: n,
                        ma: p
                    };
                    this.a.Ca(Ca(p), q);
                }
            }
        }
    };
    k.bo = function (a, b) {
        var c = b.xa(), d = {
                feature: a,
                geometry: b,
                index: 0,
                ma: [
                    c,
                    c
                ]
            };
        a = {
            feature: a,
            geometry: b,
            index: 1,
            ma: [
                c,
                c
            ]
        };
        d.Tf = a.Tf = [
            d,
            a
        ];
        this.a.Ca(Pa(c), d);
        this.a.Ca(b.G(), a);
    };
    k.co = function (a, b) {
        var c = b.a;
        for (b = 0; b < c.length; ++b)
            this.ca[c[b].S()].call(this, a, c[b]);
    };
    function rx(a, b) {
        var c = a.f;
        c ? c.U().na(b) : (c = new Hk(new C(b)), a.f = c, a.B.ha().Gb(c));
    }
    function sx(a, b) {
        return a.index - b.index;
    }
    function hx(a) {
        if (!this.Md(a))
            return !1;
        mx(this, a.pixel, a.map);
        var b = a.map.Ra(a.pixel);
        this.j.length = 0;
        this.C = !1;
        var c = this.f;
        if (c) {
            var d = [];
            c = c.U().W();
            var e = Ca([c]);
            e = xm(this.a, e);
            var f = {};
            e.sort(sx);
            for (var g = 0, h = e.length; g < h; ++g) {
                var l = e[g], m = l.ma, n = x(l.feature), p = l.depth;
                p && (n += '-' + p.join('-'));
                f[n] || (f[n] = Array(2));
                if ('Circle' === l.geometry.S() && 1 === l.index)
                    m = tx(b, l), Ee(m, c) && !f[n][0] && (this.j.push([
                        l,
                        0
                    ]), f[n][0] = l);
                else if (Ee(m[0], c) && !f[n][0])
                    this.j.push([
                        l,
                        0
                    ]), f[n][0] = l;
                else if (Ee(m[1], c) && !f[n][1]) {
                    if ('LineString' !== l.geometry.S() && 'MultiLineString' !== l.geometry.S() || !f[n][0] || 0 !== f[n][0].index)
                        this.j.push([
                            l,
                            1
                        ]), f[n][1] = l;
                } else
                    this.sc(a) && x(m) in this.La && !f[n][0] && !f[n][1] && d.push([
                        l,
                        c
                    ]);
            }
            d.length && nx(this, a);
            for (a = d.length - 1; 0 <= a; --a)
                this.Em.apply(this, d[a]);
        }
        return !!this.f;
    }
    function ix(a) {
        this.T = !1;
        nx(this, a);
        a = a.coordinate;
        for (var b = 0, c = this.j.length; b < c; ++b) {
            var d = this.j[b], e = d[0], f = e.depth, g = e.geometry, h = e.ma;
            for (d = d[1]; a.length < g.pa();)
                a.push(h[d][a.length]);
            switch (g.S()) {
            case 'Point':
                var l = a;
                h[0] = h[1] = a;
                break;
            case 'MultiPoint':
                l = g.W();
                l[e.index] = a;
                h[0] = h[1] = a;
                break;
            case 'LineString':
                l = g.W();
                l[e.index + d] = a;
                h[d] = a;
                break;
            case 'MultiLineString':
                l = g.W();
                l[f[0]][e.index + d] = a;
                h[d] = a;
                break;
            case 'Polygon':
                l = g.W();
                l[f[0]][e.index + d] = a;
                h[d] = a;
                break;
            case 'MultiPolygon':
                l = g.W();
                l[f[1]][f[0]][e.index + d] = a;
                h[d] = a;
                break;
            case 'Circle':
                h[0] = h[1] = a, 0 === e.index ? (this.s = !0, g.ub(a)) : (this.s = !0, g.fd(Ie(g.xa(), a))), this.s = !1;
            }
            l && (e = g, f = l, this.s = !0, e.na(f), this.s = !1);
        }
        rx(this, a);
    }
    function kx(a) {
        for (var b, c, d = this.j.length - 1; 0 <= d; --d)
            if (b = this.j[d][0], c = b.geometry, 'Circle' === c.S()) {
                var e = c.xa(), f = b.Tf[0];
                b = b.Tf[1];
                f.ma[0] = f.ma[1] = e;
                b.ma[0] = b.ma[1] = e;
                vm(this.a, Pa(e), f);
                vm(this.a, c.G(), b);
            } else
                vm(this.a, Ca(b.ma), b);
        this.C && (this.b(new ox('modifyend', this.o, a)), this.C = !1);
        return !1;
    }
    function jx(a) {
        if (!(a instanceof Ad))
            return !0;
        this.O = a;
        var b;
        a.map.aa().Vh() || 'pointermove' != a.type || this.D || (this.Ea = a.pixel, mx(this, a.pixel, a.map));
        this.f && this.ob(a) && (b = 'singleclick' == a.type && this.T ? !0 : this.Dj());
        'singleclick' == a.type && (this.T = !1);
        return gh.call(this, a) && !b;
    }
    function mx(a, b, c) {
        function d(a, b) {
            return ux(e, a) - ux(e, b);
        }
        var e = c.Ra(b), f = Fa(Pa(e), c.aa().Pa() * a.ra);
        f = xm(a.a, f);
        if (0 < f.length) {
            f.sort(d);
            var g = f[0], h = g.ma, l = tx(e, g), m = c.Ia(l), n = Ie(b, m);
            if (n <= a.ra) {
                b = {};
                if ('Circle' === g.geometry.S() && 1 === g.index)
                    a.ua = !0, rx(a, l);
                else
                    for (n = c.Ia(h[0]), g = c.Ia(h[1]), c = He(m, n), m = He(m, g), n = Math.sqrt(Math.min(c, m)), a.ua = n <= a.ra, a.ua && (l = c > m ? h[1] : h[0]), rx(a, l), m = 1, c = f.length; m < c; ++m)
                        if (l = f[m].ma, Ee(h[0], l[0]) && Ee(h[1], l[1]) || Ee(h[0], l[1]) && Ee(h[1], l[0]))
                            b[x(l)] = !0;
                        else
                            break;
                b[x(h)] = !0;
                a.La = b;
                return;
            }
        }
        a.f && (a.B.ha().Lb(a.f), a.f = null);
    }
    function ux(a, b) {
        var c = b.geometry;
        return 'Circle' === c.S() && 1 === b.index ? (a = He(c.xa(), a), c = Math.sqrt(a) - c.Bd(), c * c) : Je(a, b.ma);
    }
    function tx(a, b) {
        var c = b.geometry;
        return 'Circle' === c.S() && 1 === b.index ? c.Ib(a) : Be(a, b.ma);
    }
    k.Em = function (a, b) {
        for (var c = a.ma, d = a.feature, e = a.geometry, f = a.depth, g = a.index, h; b.length < e.pa();)
            b.push(0);
        switch (e.S()) {
        case 'MultiLineString':
            h = e.W();
            h[f[0]].splice(g + 1, 0, b);
            break;
        case 'Polygon':
            h = e.W();
            h[f[0]].splice(g + 1, 0, b);
            break;
        case 'MultiPolygon':
            h = e.W();
            h[f[1]][f[0]].splice(g + 1, 0, b);
            break;
        case 'LineString':
            h = e.W();
            h.splice(g + 1, 0, b);
            break;
        default:
            return;
        }
        this.s = !0;
        e.na(h);
        this.s = !1;
        h = this.a;
        h.remove(a);
        vx(this, e, g, f, 1);
        a = {
            ma: [
                c[0],
                b
            ],
            feature: d,
            geometry: e,
            depth: f,
            index: g
        };
        h.Ca(Ca(a.ma), a);
        this.j.push([
            a,
            1
        ]);
        b = {
            ma: [
                b,
                c[1]
            ],
            feature: d,
            geometry: e,
            depth: f,
            index: g + 1
        };
        h.Ca(Ca(b.ma), b);
        this.j.push([
            b,
            0
        ]);
        this.T = !0;
    };
    k.Dj = function () {
        if (this.O && 'pointerdrag' != this.O.type) {
            var a = this.O;
            nx(this, a);
            var b = this.j, c = {}, d, e;
            for (e = b.length - 1; 0 <= e; --e) {
                var f = b[e];
                var g = f[0];
                var h = x(g.feature);
                g.depth && (h += '-' + g.depth.join('-'));
                h in c || (c[h] = {});
                0 === f[1] ? (c[h].right = g, c[h].index = g.index) : 1 == f[1] && (c[h].left = g, c[h].index = g.index + 1);
            }
            for (h in c) {
                var l = c[h].right;
                var m = c[h].left;
                e = c[h].index;
                var n = e - 1;
                g = void 0 !== m ? m : l;
                0 > n && (n = 0);
                f = g.geometry;
                var p = d = f.W();
                var q = !1;
                switch (f.S()) {
                case 'MultiLineString':
                    2 < d[g.depth[0]].length && (d[g.depth[0]].splice(e, 1), q = !0);
                    break;
                case 'LineString':
                    2 < d.length && (d.splice(e, 1), q = !0);
                    break;
                case 'MultiPolygon':
                    p = p[g.depth[1]];
                case 'Polygon':
                    p = p[g.depth[0]], 4 < p.length && (e == p.length - 1 && (e = 0), p.splice(e, 1), q = !0, 0 === e && (p.pop(), p.push(p[0]), n = p.length - 1));
                }
                q && (q = f, this.s = !0, q.na(d), this.s = !1, d = [], void 0 !== m && (this.a.remove(m), d.push(m.ma[0])), void 0 !== l && (this.a.remove(l), d.push(l.ma[1])), void 0 !== m && void 0 !== l && (m = {
                    depth: g.depth,
                    feature: g.feature,
                    geometry: g.geometry,
                    index: n,
                    ma: d
                }, this.a.Ca(Ca(m.ma), m)), vx(this, f, e, g.depth, -1), this.f && (this.B.ha().Lb(this.f), this.f = null), b.length = 0);
            }
            this.b(new ox('modifyend', this.o, a));
            this.C = !1;
            return !0;
        }
        return !1;
    };
    function vx(a, b, c, d, e) {
        zm(a.a, b.G(), function (a) {
            a.geometry === b && (void 0 === d || void 0 === a.depth || jc(a.depth, d)) && a.index > c && (a.index += e);
        });
    }
    function lx() {
        var a = Gk();
        return function () {
            return a.Point;
        };
    }
    function ox(a, b, c) {
        Qc.call(this, a);
        this.features = b;
        this.mapBrowserEvent = c;
    }
    w(ox, Qc);
    function wx(a) {
        Jg.call(this, { handleEvent: xx });
        a = a ? a : {};
        this.C = a.condition ? a.condition : $g;
        this.D = a.addCondition ? a.addCondition : Se;
        this.B = a.removeCondition ? a.removeCondition : Se;
        this.T = a.toggleCondition ? a.toggleCondition : bh;
        this.s = a.multi ? a.multi : !1;
        this.l = a.filter ? a.filter : Re;
        this.j = a.hitTolerance ? a.hitTolerance : 0;
        this.f = new T({
            source: new U({
                useSpatialIndex: !1,
                features: a.features,
                wrapX: a.wrapX
            }),
            style: a.style ? a.style : yx(),
            updateWhileAnimating: !0,
            updateWhileInteracting: !0
        });
        if (a.layers)
            if ('function' === typeof a.layers)
                a = a.layers;
            else {
                var b = a.layers;
                a = function (a) {
                    return ec(b, a);
                };
            }
        else
            a = Re;
        this.o = a;
        this.a = {};
        a = this.f.ha().i;
        y(a, 'add', this.ko, this);
        y(a, 'remove', this.oo, this);
    }
    w(wx, Jg);
    k = wx.prototype;
    k.lo = function () {
        return this.f.ha().i;
    };
    k.mo = function () {
        return this.j;
    };
    k.no = function (a) {
        a = x(a);
        return this.a[a];
    };
    function xx(a) {
        if (!this.C(a))
            return !0;
        var b = this.D(a), c = this.B(a), d = this.T(a), e = !b && !c && !d, f = a.map, g = this.f.ha().i, h = [], l = [];
        if (e) {
            lb(this.a);
            f.Tc(a.pixel, function (a, b) {
                if (this.l(a, b))
                    return l.push(a), a = x(a), this.a[a] = b, !this.s;
            }.bind(this), {
                layerFilter: this.o,
                hitTolerance: this.j
            });
            for (e = g.kc() - 1; 0 <= e; --e) {
                f = g.item(e);
                var m = l.indexOf(f);
                -1 < m ? l.splice(m, 1) : (g.remove(f), h.push(f));
            }
            0 !== l.length && g.qg(l);
        } else {
            f.Tc(a.pixel, function (a, e) {
                if (this.l(a, e))
                    return !b && !d || ec(g.a, a) ? (c || d) && ec(g.a, a) && (h.push(a), e = x(a), delete this.a[e]) : (l.push(a), a = x(a), this.a[a] = e), !this.s;
            }.bind(this), {
                layerFilter: this.o,
                hitTolerance: this.j
            });
            for (e = h.length - 1; 0 <= e; --e)
                g.remove(h[e]);
            g.qg(l);
        }
        (0 < l.length || 0 < h.length) && this.b(new zx(Ax, l, h, a));
        return Zg(a);
    }
    k.po = function (a) {
        this.j = a;
    };
    k.setMap = function (a) {
        var b = this.v, c = this.f.ha().i;
        b && c.forEach(b.Zj, b);
        Jg.prototype.setMap.call(this, a);
        this.f.setMap(a);
        a && c.forEach(a.Uj, a);
    };
    function yx() {
        var a = Gk();
        gc(a.Polygon, a.LineString);
        gc(a.GeometryCollection, a.LineString);
        return function (b) {
            return b.U() ? a[b.U().S()] : null;
        };
    }
    k.ko = function (a) {
        var b = this.v;
        b && b.Uj(a.element);
    };
    k.oo = function (a) {
        var b = this.v;
        b && b.Zj(a.element);
    };
    function zx(a, b, c, d) {
        Qc.call(this, a);
        this.selected = b;
        this.deselected = c;
        this.mapBrowserEvent = d;
    }
    w(zx, Qc);
    var Ax = 'select';
    function Bx(a) {
        fh.call(this, {
            handleEvent: Cx,
            handleDownEvent: Re,
            handleUpEvent: Dx
        });
        a = a ? a : {};
        this.s = a.source ? a.source : null;
        this.O = void 0 !== a.vertex ? a.vertex : !0;
        this.C = void 0 !== a.edge ? a.edge : !0;
        this.j = a.features ? a.features : null;
        this.ra = [];
        this.B = {};
        this.V = {};
        this.o = {};
        this.T = null;
        this.f = void 0 !== a.pixelTolerance ? a.pixelTolerance : 10;
        this.ua = Ex.bind(this);
        this.a = new um();
        this.ca = {
            Point: this.wo,
            LineString: this.Pi,
            LinearRing: this.Pi,
            Polygon: this.xo,
            MultiPoint: this.uo,
            MultiLineString: this.to,
            MultiPolygon: this.vo,
            GeometryCollection: this.so,
            Circle: this.ro
        };
    }
    w(Bx, fh);
    k = Bx.prototype;
    k.Gb = function (a, b) {
        b = void 0 !== b ? b : !0;
        var c = x(a), d = a.U();
        if (d) {
            var e = this.ca[d.S()];
            e && (this.V[c] = d.G(Da()), e.call(this, a, d));
        }
        b && (this.B[c] = y(a, 'change', this.qo, this));
    };
    k.bl = function (a) {
        this.Gb(a);
    };
    k.cl = function (a) {
        this.Lb(a);
    };
    k.Ni = function (a) {
        if (a instanceof Bw)
            var b = a.feature;
        else
            a instanceof cd && (b = a.element);
        this.Gb(b);
    };
    k.Oi = function (a) {
        if (a instanceof Bw)
            var b = a.feature;
        else
            a instanceof cd && (b = a.element);
        this.Lb(b);
    };
    k.qo = function (a) {
        a = a.target;
        if (this.D) {
            var b = x(a);
            b in this.o || (this.o[b] = a);
        } else
            this.$j(a);
    };
    k.Lb = function (a, b) {
        b = void 0 !== b ? b : !0;
        var c = x(a), d = this.V[c];
        if (d) {
            var e = this.a, f = [];
            zm(e, d, function (b) {
                a === b.feature && f.push(b);
            });
            for (d = f.length - 1; 0 <= d; --d)
                e.remove(f[d]);
        }
        b && (Gc(this.B[c]), delete this.B[c]);
    };
    k.setMap = function (a) {
        var b = this.v, c = this.ra, d;
        this.j ? d = this.j : this.s && (d = this.s.ee());
        b && (c.forEach(Gc), c.length = 0, d.forEach(this.cl, this));
        fh.prototype.setMap.call(this, a);
        a && (this.j ? c.push(y(this.j, 'add', this.Ni, this), y(this.j, 'remove', this.Oi, this)) : this.s && c.push(y(this.s, 'addfeature', this.Ni, this), y(this.s, 'removefeature', this.Oi, this)), d.forEach(this.bl, this));
    };
    k.jd = Se;
    function Fx(a, b, c, d) {
        var e = d.Ra([
                b[0] - a.f,
                b[1] + a.f
            ]), f = d.Ra([
                b[0] + a.f,
                b[1] - a.f
            ]);
        e = Ca([
            e,
            f
        ]);
        var g = xm(a.a, e);
        a.O && !a.C && (g = g.filter(function (a) {
            return 'Circle' !== a.feature.U().S();
        }));
        var h = !1;
        e = !1;
        var l = f = null;
        if (0 < g.length) {
            a.T = c;
            g.sort(a.ua);
            var m = g[0].ma;
            h = 'Circle' === g[0].feature.U().S();
            if (a.O && !a.C) {
                if (c = d.Ia(m[0]), h = d.Ia(m[1]), c = He(b, c), b = He(b, h), h = Math.sqrt(Math.min(c, b)), h = h <= a.f)
                    e = !0, f = c > b ? m[1] : m[0], l = d.Ia(f);
            } else
                a.C && (f = h ? Ae(c, g[0].feature.U()) : Be(c, m), l = d.Ia(f), Ie(b, l) <= a.f && (e = !0, a.O && !h && (c = d.Ia(m[0]), h = d.Ia(m[1]), c = He(l, c), b = He(l, h), h = Math.sqrt(Math.min(c, b)), h = h <= a.f))) && (f = c > b ? m[1] : m[0], l = d.Ia(f));
            e && (l = [
                Math.round(l[0]),
                Math.round(l[1])
            ]);
        }
        return {
            Mq: e,
            vertex: f,
            Vq: l
        };
    }
    k.$j = function (a) {
        this.Lb(a, !1);
        this.Gb(a, !1);
    };
    k.ro = function (a, b) {
        b = Sf(b).W()[0];
        var c;
        var d = 0;
        for (c = b.length - 1; d < c; ++d) {
            var e = b.slice(d, d + 2);
            var f = {
                feature: a,
                ma: e
            };
            this.a.Ca(Ca(e), f);
        }
    };
    k.so = function (a, b) {
        var c = b.a;
        for (b = 0; b < c.length; ++b) {
            var d = this.ca[c[b].S()];
            d && d.call(this, a, c[b]);
        }
    };
    k.Pi = function (a, b) {
        b = b.W();
        var c;
        var d = 0;
        for (c = b.length - 1; d < c; ++d) {
            var e = b.slice(d, d + 2);
            var f = {
                feature: a,
                ma: e
            };
            this.a.Ca(Ca(e), f);
        }
    };
    k.to = function (a, b) {
        b = b.W();
        var c, d;
        var e = 0;
        for (d = b.length; e < d; ++e) {
            var f = b[e];
            var g = 0;
            for (c = f.length - 1; g < c; ++g) {
                var h = f.slice(g, g + 2);
                var l = {
                    feature: a,
                    ma: h
                };
                this.a.Ca(Ca(h), l);
            }
        }
    };
    k.uo = function (a, b) {
        var c = b.W(), d;
        var e = 0;
        for (d = c.length; e < d; ++e) {
            var f = c[e];
            f = {
                feature: a,
                ma: [
                    f,
                    f
                ]
            };
            this.a.Ca(b.G(), f);
        }
    };
    k.vo = function (a, b) {
        b = b.W();
        var c, d, e;
        var f = 0;
        for (e = b.length; f < e; ++f) {
            var g = b[f];
            var h = 0;
            for (d = g.length; h < d; ++h) {
                var l = g[h];
                var m = 0;
                for (c = l.length - 1; m < c; ++m) {
                    var n = l.slice(m, m + 2);
                    var p = {
                        feature: a,
                        ma: n
                    };
                    this.a.Ca(Ca(n), p);
                }
            }
        }
    };
    k.wo = function (a, b) {
        var c = b.W();
        a = {
            feature: a,
            ma: [
                c,
                c
            ]
        };
        this.a.Ca(b.G(), a);
    };
    k.xo = function (a, b) {
        b = b.W();
        var c, d;
        var e = 0;
        for (d = b.length; e < d; ++e) {
            var f = b[e];
            var g = 0;
            for (c = f.length - 1; g < c; ++g) {
                var h = f.slice(g, g + 2);
                var l = {
                    feature: a,
                    ma: h
                };
                this.a.Ca(Ca(h), l);
            }
        }
    };
    function Cx(a) {
        var b = Fx(this, a.pixel, a.coordinate, a.map);
        b.Mq && (a.coordinate = b.vertex.slice(0, 2), a.pixel = b.Vq);
        return gh.call(this, a);
    }
    function Dx() {
        var a = mb(this.o);
        a.length && (a.forEach(this.$j, this), this.o = {});
        return !1;
    }
    function Ex(a, b) {
        return Je(this.T, a.ma) - Je(this.T, b.ma);
    }
    function Gx(a) {
        fh.call(this, {
            handleDownEvent: Hx,
            handleDragEvent: Ix,
            handleMoveEvent: Jx,
            handleUpEvent: Kx
        });
        a = a ? a : {};
        this.a = null;
        this.j = void 0 !== a.features ? a.features : null;
        if (a.layers)
            if ('function' === typeof a.layers)
                var b = a.layers;
            else {
                var c = a.layers;
                b = function (a) {
                    return ec(c, a);
                };
            }
        else
            b = Re;
        this.C = b;
        this.s = a.hitTolerance ? a.hitTolerance : 0;
        this.f = null;
        y(this, Xc('active'), this.o, this);
    }
    w(Gx, fh);
    function Hx(a) {
        this.f = Lx(this, a.pixel, a.map);
        if (!this.a && this.f) {
            this.a = a.coordinate;
            Jx.call(this, a);
            var b = this.j || new B([this.f]);
            this.b(new Mx('translatestart', b, a.coordinate));
            return !0;
        }
        return !1;
    }
    function Kx(a) {
        if (this.a) {
            this.a = null;
            Jx.call(this, a);
            var b = this.j || new B([this.f]);
            this.b(new Mx('translateend', b, a.coordinate));
            return !0;
        }
        return !1;
    }
    function Ix(a) {
        if (this.a) {
            a = a.coordinate;
            var b = a[0] - this.a[0], c = a[1] - this.a[1], d = this.j || new B([this.f]);
            d.forEach(function (a) {
                var d = a.U();
                d.translate(b, c);
                a.Va(d);
            });
            this.a = a;
            this.b(new Mx('translating', d, a));
        }
    }
    function Jx(a) {
        var b = a.map.a;
        Lx(this, a.pixel, a.map) ? (b.classList.remove(this.a ? 'ol-grab' : 'ol-grabbing'), b.classList.add(this.a ? 'ol-grabbing' : 'ol-grab')) : b.classList.remove('ol-grab', 'ol-grabbing');
    }
    function Lx(a, b, c) {
        return c.Tc(b, function (a) {
            if (!this.j || ec(this.j.a, a))
                return a;
        }.bind(a), {
            layerFilter: a.C,
            hitTolerance: a.s
        });
    }
    Gx.prototype.B = function () {
        return this.s;
    };
    Gx.prototype.T = function (a) {
        this.s = a;
    };
    Gx.prototype.setMap = function (a) {
        var b = this.v;
        fh.prototype.setMap.call(this, a);
        Nx(this, b);
    };
    Gx.prototype.o = function () {
        Nx(this, null);
    };
    function Nx(a, b) {
        var c = a.v;
        a = a.c();
        c && a || (c = c || b) && c.a.classList.remove('ol-grab', 'ol-grabbing');
    }
    function Mx(a, b, c) {
        Qc.call(this, a);
        this.features = b;
        this.coordinate = c;
    }
    w(Mx, Qc);
    function V(a) {
        a = a ? a : {};
        var b = kb({}, a);
        delete b.gradient;
        delete b.radius;
        delete b.blur;
        delete b.shadow;
        delete b.weight;
        T.call(this, b);
        this.c = null;
        this.$ = void 0 !== a.shadow ? a.shadow : 250;
        this.O = void 0;
        this.T = null;
        y(this, Xc(Ox), this.cm, this);
        this.Lj(a.gradient ? a.gradient : Px);
        this.Fj(void 0 !== a.blur ? a.blur : 15);
        this.fd(void 0 !== a.radius ? a.radius : 8);
        y(this, Xc(Qx), this.mg, this);
        y(this, Xc(Rx), this.mg, this);
        this.mg();
        var c = a.weight ? a.weight : 'weight', d;
        'string' === typeof c ? d = function (a) {
            return a.get(c);
        } : d = c;
        this.j(function (a) {
            a = d(a);
            a = void 0 !== a ? pa(a, 0, 1) : 1;
            var b = 255 * a | 0, c = this.T[b];
            c || (c = [new Bk({
                    image: new dr({
                        opacity: a,
                        src: this.O
                    })
                })], this.T[b] = c);
            return c;
        }.bind(this));
        this.set(ik, null);
        y(this, 'render', this.tm, this);
    }
    w(V, T);
    var Px = [
        '#00f',
        '#0ff',
        '#0f0',
        '#ff0',
        '#f00'
    ];
    k = V.prototype;
    k.Nh = function () {
        return this.get(Qx);
    };
    k.Uh = function () {
        return this.get(Ox);
    };
    k.Ri = function () {
        return this.get(Rx);
    };
    k.cm = function () {
        for (var a = this.Uh(), b = hg(1, 256), c = b.createLinearGradient(0, 0, 1, 256), d = 1 / (a.length - 1), e = 0, f = a.length; e < f; ++e)
            c.addColorStop(e * d, a[e]);
        b.fillStyle = c;
        b.fillRect(0, 0, 1, 256);
        this.c = b.getImageData(0, 0, 1, 256).data;
    };
    k.mg = function () {
        var a = this.Ri(), b = this.Nh(), c = a + b + 1, d = 2 * c;
        d = hg(d, d);
        d.shadowOffsetX = d.shadowOffsetY = this.$;
        d.shadowBlur = b;
        d.shadowColor = '#000';
        d.beginPath();
        b = c - this.$;
        d.arc(b, b, a, 0, 2 * Math.PI, !0);
        d.fill();
        this.O = d.canvas.toDataURL();
        this.T = Array(256);
        this.u();
    };
    k.tm = function (a) {
        a = a.context;
        var b = a.canvas;
        b = a.getImageData(0, 0, b.width, b.height);
        var c = b.data, d, e;
        var f = 0;
        for (d = c.length; f < d; f += 4)
            if (e = 4 * c[f + 3])
                c[f] = this.c[e], c[f + 1] = this.c[e + 1], c[f + 2] = this.c[e + 2];
        a.putImageData(b, 0, 0);
    };
    k.Fj = function (a) {
        this.set(Qx, a);
    };
    k.Lj = function (a) {
        this.set(Ox, a);
    };
    k.fd = function (a) {
        this.set(Rx, a);
    };
    var Qx = 'blur', Ox = 'gradient', Rx = 'radius';
    function Sx(a) {
        xg.call(this, a ? a : {});
        this.type = 'IMAGE';
    }
    w(Sx, xg);
    function Tx(a) {
        a = a ? a : {};
        var b = kb({}, a);
        delete b.preload;
        delete b.useInterimTilesOnError;
        xg.call(this, b);
        this.j(void 0 !== a.preload ? a.preload : 0);
        this.C(void 0 !== a.useInterimTilesOnError ? a.useInterimTilesOnError : !0);
        this.type = 'TILE';
    }
    w(Tx, xg);
    Tx.prototype.c = function () {
        return this.get('preload');
    };
    Tx.prototype.j = function (a) {
        this.set('preload', a);
    };
    Tx.prototype.i = function () {
        return this.get('useInterimTilesOnError');
    };
    Tx.prototype.C = function (a) {
        this.set('useInterimTilesOnError', a);
    };
    function W(a) {
        a = a ? a : {};
        var b = a.renderMode || 'hybrid';
        oa(void 0 == b || 'image' == b || 'hybrid' == b || 'vector' == b, 28);
        a.declutter && 'image' == b && (b = 'hybrid');
        a.renderMode = b;
        b = kb({}, a);
        delete b.preload;
        delete b.useInterimTilesOnError;
        T.call(this, b);
        this.T(a.preload ? a.preload : 0);
        this.O(a.useInterimTilesOnError ? a.useInterimTilesOnError : !0);
        this.type = 'VECTOR_TILE';
    }
    w(W, T);
    W.prototype.c = function () {
        return this.get('preload');
    };
    W.prototype.i = function () {
        return this.get('useInterimTilesOnError');
    };
    W.prototype.T = function (a) {
        this.set('preload', a);
    };
    W.prototype.O = function (a) {
        this.set('useInterimTilesOnError', a);
    };
    function Ux(a, b) {
        var c = /\{z\}/g, d = /\{x\}/g, e = /\{y\}/g, f = /\{-y\}/g;
        return function (g) {
            if (g)
                return a.replace(c, g[0].toString()).replace(d, g[1].toString()).replace(e, function () {
                    return (-g[2] - 1).toString();
                }).replace(f, function () {
                    var a = b.a ? b.a[g[0]] : null;
                    oa(a, 55);
                    return (a.ka - a.ea + 1 + g[2]).toString();
                });
        };
    }
    function Vx(a, b) {
        for (var c = a.length, d = Array(c), e = 0; e < c; ++e)
            d[e] = Ux(a[e], b);
        return Wx(d);
    }
    function Wx(a) {
        return 1 === a.length ? a[0] : function (b, c, d) {
            if (b)
                return a[wa((b[1] << b[0]) + b[2], a.length)](b, c, d);
        };
    }
    function Xx() {
    }
    function Yx(a) {
        var b = [], c = /\{([a-z])-([a-z])\}/.exec(a);
        if (c) {
            var d = c[2].charCodeAt(0), e;
            for (e = c[1].charCodeAt(0); e <= d; ++e)
                b.push(a.replace(c[0], String.fromCharCode(e)));
            return b;
        }
        if (c = c = /\{(\d+)-(\d+)\}/.exec(a)) {
            d = parseInt(c[2], 10);
            for (e = parseInt(c[1], 10); e <= d; e++)
                b.push(a.replace(c[0], e.toString()));
            return b;
        }
        b.push(a);
        return b;
    }
    function Zx(a, b, c, d) {
        function e() {
            delete window[g];
            f.parentNode.removeChild(f);
        }
        var f = document.createElement('script'), g = 'olc_' + x(b);
        f.async = !0;
        f.src = a + (-1 == a.indexOf('?') ? '?' : '&') + (d || 'callback') + '=' + g;
        var h = setTimeout(function () {
            e();
            c && c();
        }, 10000);
        window[g] = function (a) {
            clearTimeout(h);
            e();
            b(a);
        };
        document.getElementsByTagName('head')[0].appendChild(f);
    }
    function $x(a) {
        ci.call(this, a);
    }
    w($x, ci);
    $x.prototype.sd = function (a) {
        for (var b, c; di(this);) {
            b = this.g.Pc;
            c = b.ya[0].toString();
            var d;
            if (d = c in a)
                b = b.ya, d = ma(a[c], b[1], b[2]);
            if (d)
                break;
            else
                Pc(this.pop());
        }
    };
    function ay(a) {
        if (0 !== a.i) {
            var b = a.c.jc.split('/').map(Number)[0];
            a.forEach(function (a) {
                if (a.ya[0] !== b) {
                    var c = a.ya;
                    this.remove(c[0] + '/' + c[1] + '/' + c[2]);
                    Pc(a);
                }
            }, a);
        }
    }
    function by(a, b, c, d) {
        var e = ac(c, b, a);
        c = Nb(b, d, c);
        b = b.Bc();
        void 0 !== b && (c *= b);
        b = a.Bc();
        void 0 !== b && (c /= b);
        b = a.G();
        if (!b || Ja(b, e))
            a = Nb(a, c, e) / c, isFinite(a) && 0 < a && (c /= a);
        return c;
    }
    function cy(a, b, c, d) {
        a = c - a;
        b = d - b;
        var e = Math.sqrt(a * a + b * b);
        return [
            Math.round(c + a / e),
            Math.round(d + b / e)
        ];
    }
    function dy(a, b, c, d, e, f, g, h, l, m, n) {
        var p = hg(Math.round(c * a), Math.round(c * b));
        if (0 === l.length)
            return p.canvas;
        p.scale(c, c);
        var q = Da();
        l.forEach(function (a) {
            Ta(q, a.extent);
        });
        var r = hg(Math.round(c * cb(q) / d), Math.round(c * db(q) / d)), u = c / d;
        l.forEach(function (a) {
            r.drawImage(a.image, m, m, a.image.width - 2 * m, a.image.height - 2 * m, (a.extent[0] - q[0]) * u, -(a.extent[3] - q[3]) * u, cb(a.extent) * u, db(a.extent) * u);
        });
        var v = $a(g);
        h.c.forEach(function (a) {
            var b = a.source, e = a.target, g = b[1][0], h = b[1][1], l = b[2][0], m = b[2][1];
            a = (e[0][0] - v[0]) / f;
            var n = -(e[0][1] - v[1]) / f, u = (e[1][0] - v[0]) / f, z = -(e[1][1] - v[1]) / f, Va = (e[2][0] - v[0]) / f, ic = -(e[2][1] - v[1]) / f;
            e = b[0][0];
            b = b[0][1];
            g -= e;
            h -= b;
            l -= e;
            m -= b;
            a: {
                g = [
                    [
                        g,
                        h,
                        0,
                        0,
                        u - a
                    ],
                    [
                        l,
                        m,
                        0,
                        0,
                        Va - a
                    ],
                    [
                        0,
                        0,
                        g,
                        h,
                        z - n
                    ],
                    [
                        0,
                        0,
                        l,
                        m,
                        ic - n
                    ]
                ];
                h = g.length;
                for (l = 0; l < h; l++) {
                    m = l;
                    for (var Xa = Math.abs(g[l][l]), Z = l + 1; Z < h; Z++) {
                        var Zb = Math.abs(g[Z][l]);
                        Zb > Xa && (Xa = Zb, m = Z);
                    }
                    if (0 === Xa) {
                        g = null;
                        break a;
                    }
                    Xa = g[m];
                    g[m] = g[l];
                    g[l] = Xa;
                    for (m = l + 1; m < h; m++)
                        for (Xa = -g[m][l] / g[l][l], Z = l; Z < h + 1; Z++)
                            g[m][Z] = l == Z ? 0 : g[m][Z] + Xa * g[l][Z];
                }
                l = Array(h);
                for (m = h - 1; 0 <= m; m--)
                    for (l[m] = g[m][h] / g[m][m], Xa = m - 1; 0 <= Xa; Xa--)
                        g[Xa][h] -= g[Xa][m] * l[m];
                g = l;
            }
            g && (p.save(), p.beginPath(), l = (a + u + Va) / 3, m = (n + z + ic) / 3, h = cy(l, m, a, n), u = cy(l, m, u, z), Va = cy(l, m, Va, ic), p.moveTo(u[0], u[1]), p.lineTo(h[0], h[1]), p.lineTo(Va[0], Va[1]), p.clip(), p.transform(g[0], g[2], g[1], g[3], a, n), p.translate(q[0] - e, q[3] - b), p.scale(d / c, -d / c), p.drawImage(r.canvas, 0, 0), p.restore());
        });
        n && (p.save(), p.strokeStyle = 'black', p.lineWidth = 1, h.c.forEach(function (a) {
            var b = a.target;
            a = (b[0][0] - v[0]) / f;
            var c = -(b[0][1] - v[1]) / f, d = (b[1][0] - v[0]) / f, e = -(b[1][1] - v[1]) / f, g = (b[2][0] - v[0]) / f;
            b = -(b[2][1] - v[1]) / f;
            p.beginPath();
            p.moveTo(d, e);
            p.lineTo(a, c);
            p.lineTo(g, b);
            p.closePath();
            p.stroke();
        }), p.restore());
        return p.canvas;
    }
    function ey(a, b, c, d, e) {
        this.g = a;
        this.i = b;
        var f = {}, g = Yb(this.i, this.g);
        this.a = function (a) {
            var b = a[0] + '/' + a[1];
            f[b] || (f[b] = g(a));
            return f[b];
        };
        this.f = d;
        this.v = e * e;
        this.c = [];
        this.l = !1;
        this.s = this.g.g && !!d && !!this.g.G() && cb(d) == cb(this.g.G());
        this.b = this.g.G() ? cb(this.g.G()) : null;
        this.j = this.i.G() ? cb(this.i.G()) : null;
        a = $a(c);
        b = Za(c);
        d = Ya(c);
        c = Wa(c);
        e = this.a(a);
        var h = this.a(b), l = this.a(d), m = this.a(c);
        fy(this, a, b, d, c, e, h, l, m, 10);
        if (this.l) {
            var n = Infinity;
            this.c.forEach(function (a) {
                n = Math.min(n, a.source[0][0], a.source[1][0], a.source[2][0]);
            });
            this.c.forEach(function (a) {
                if (Math.max(a.source[0][0], a.source[1][0], a.source[2][0]) - n > this.b / 2) {
                    var b = [
                        [
                            a.source[0][0],
                            a.source[0][1]
                        ],
                        [
                            a.source[1][0],
                            a.source[1][1]
                        ],
                        [
                            a.source[2][0],
                            a.source[2][1]
                        ]
                    ];
                    b[0][0] - n > this.b / 2 && (b[0][0] -= this.b);
                    b[1][0] - n > this.b / 2 && (b[1][0] -= this.b);
                    b[2][0] - n > this.b / 2 && (b[2][0] -= this.b);
                    Math.max(b[0][0], b[1][0], b[2][0]) - Math.min(b[0][0], b[1][0], b[2][0]) < this.b / 2 && (a.source = b);
                }
            }, this);
        }
        f = {};
    }
    function fy(a, b, c, d, e, f, g, h, l, m) {
        var n = Ca([
                f,
                g,
                h,
                l
            ]), p = a.b ? cb(n) / a.b : null, q = a.b, r = a.g.g && 0.5 < p && 1 > p, u = !1;
        if (0 < m) {
            if (a.i.c && a.j) {
                var v = Ca([
                    b,
                    c,
                    d,
                    e
                ]);
                u |= 0.25 < cb(v) / a.j;
            }
            !r && a.g.c && p && (u |= 0.25 < p);
        }
        if (u || !a.f || hb(n, a.f)) {
            if (!(u || isFinite(f[0]) && isFinite(f[1]) && isFinite(g[0]) && isFinite(g[1]) && isFinite(h[0]) && isFinite(h[1]) && isFinite(l[0]) && isFinite(l[1])))
                if (0 < m)
                    u = !0;
                else
                    return;
            if (0 < m && (u || (n = a.a([
                    (b[0] + d[0]) / 2,
                    (b[1] + d[1]) / 2
                ]), q = r ? (wa(f[0], q) + wa(h[0], q)) / 2 - wa(n[0], q) : (f[0] + h[0]) / 2 - n[0], n = (f[1] + h[1]) / 2 - n[1], u = q * q + n * n > a.v), u)) {
                Math.abs(b[0] - d[0]) <= Math.abs(b[1] - d[1]) ? (r = [
                    (c[0] + d[0]) / 2,
                    (c[1] + d[1]) / 2
                ], q = a.a(r), n = [
                    (e[0] + b[0]) / 2,
                    (e[1] + b[1]) / 2
                ], p = a.a(n), fy(a, b, c, r, n, f, g, q, p, m - 1), fy(a, n, r, d, e, p, q, h, l, m - 1)) : (r = [
                    (b[0] + c[0]) / 2,
                    (b[1] + c[1]) / 2
                ], q = a.a(r), n = [
                    (d[0] + e[0]) / 2,
                    (d[1] + e[1]) / 2
                ], p = a.a(n), fy(a, b, r, n, e, f, q, p, l, m - 1), fy(a, r, c, d, n, q, g, h, p, m - 1));
                return;
            }
            if (r) {
                if (!a.s)
                    return;
                a.l = !0;
            }
            a.c.push({
                source: [
                    f,
                    h,
                    l
                ],
                target: [
                    b,
                    d,
                    e
                ]
            });
            a.c.push({
                source: [
                    f,
                    g,
                    h
                ],
                target: [
                    b,
                    c,
                    d
                ]
            });
        }
    }
    function gy(a) {
        var b = Da();
        a.c.forEach(function (a) {
            a = a.source;
            Ea(b, a[0]);
            Ea(b, a[1]);
            Ea(b, a[2]);
        });
        return b;
    }
    function hy(a, b, c, d, e, f, g, h, l, m, n) {
        cl.call(this, e, 0);
        this.B = void 0 !== n ? n : !1;
        this.C = g;
        this.D = h;
        this.N = null;
        this.c = b;
        this.l = d;
        this.v = f ? f : e;
        this.a = [];
        this.Id = null;
        this.f = 0;
        f = d.Ma(this.v);
        h = this.l.G();
        e = this.c.G();
        f = h ? gb(f, h) : f;
        if (0 === ab(f))
            this.state = 4;
        else if ((h = a.G()) && (e ? e = gb(e, h) : e = h), d = by(a, c, eb(f), d.Ta(this.v[0])), !isFinite(d) || 0 >= d)
            this.state = 4;
        else if (this.o = new ey(a, c, f, e, d * (void 0 !== m ? m : 0.5)), 0 === this.o.c.length)
            this.state = 4;
        else if (this.f = b.Dc(d), c = gy(this.o), e && (a.g ? (c[1] = pa(c[1], e[1], e[3]), c[3] = pa(c[3], e[1], e[3])) : c = gb(c, e)), ab(c)) {
            a = tc(b, c, this.f);
            for (b = a.fa; b <= a.la; b++)
                for (c = a.ea; c <= a.ka; c++)
                    (m = l(this.f, b, c, g)) && this.a.push(m);
            0 === this.a.length && (this.state = 4);
        } else
            this.state = 4;
    }
    w(hy, cl);
    hy.prototype.ia = function () {
        1 == this.state && (this.Id.forEach(Gc), this.Id = null);
        cl.prototype.ia.call(this);
    };
    hy.prototype.Y = function () {
        return this.N;
    };
    hy.prototype.he = function () {
        var a = [];
        this.a.forEach(function (b) {
            b && 2 == b.getState() && a.push({
                extent: this.c.Ma(b.ya),
                image: b.Y()
            });
        }, this);
        this.a.length = 0;
        if (0 === a.length)
            this.state = 3;
        else {
            var b = this.v[0], c = this.l.Za(b), d = 'number' === typeof c ? c : c[0];
            c = 'number' === typeof c ? c : c[1];
            b = this.l.Ta(b);
            var e = this.c.Ta(this.f), f = this.l.Ma(this.v);
            this.N = dy(d, c, this.C, e, this.c.G(), b, f, this.o, a, this.D, this.B);
            this.state = 2;
        }
        this.u();
    };
    hy.prototype.load = function () {
        if (0 == this.state) {
            this.state = 1;
            this.u();
            var a = 0;
            this.Id = [];
            this.a.forEach(function (b) {
                var c = b.getState();
                if (0 == c || 1 == c) {
                    a++;
                    var d = y(b, 'change', function () {
                        var c = b.getState();
                        if (2 == c || 3 == c || 4 == c)
                            Gc(d), a--, 0 === a && (this.Id.forEach(Gc), this.Id = null, this.he());
                    }, this);
                    this.Id.push(d);
                }
            }, this);
            this.a.forEach(function (a) {
                0 == a.getState() && a.load();
            });
            0 === a && setTimeout(this.he.bind(this), 0);
        }
    };
    function iy(a) {
        uw.call(this, {
            attributions: a.attributions,
            extent: a.extent,
            logo: a.logo,
            projection: a.projection,
            state: a.state,
            wrapX: a.wrapX
        });
        this.bb = void 0 !== a.opaque ? a.opaque : !1;
        this.sc = void 0 !== a.tilePixelRatio ? a.tilePixelRatio : 1;
        this.tileGrid = void 0 !== a.tileGrid ? a.tileGrid : null;
        this.a = new $x(a.cacheSize);
        this.j = [
            0,
            0
        ];
        this.jc = '';
        this.Ea = { transition: a.transition };
    }
    w(iy, uw);
    k = iy.prototype;
    k.cj = function () {
        return di(this.a);
    };
    k.sd = function (a, b) {
        (a = this.Yd(a)) && a.sd(b);
    };
    function Li(a, b, c, d, e) {
        a = a.Yd(b);
        if (!a)
            return !1;
        b = !0;
        for (var f, g, h = d.fa; h <= d.la; ++h)
            for (var l = d.ea; l <= d.ka; ++l)
                f = c + '/' + h + '/' + l, g = !1, a.a.hasOwnProperty(f) && (f = a.get(f), (g = 2 === f.getState()) && (g = !1 !== e(f))), g || (b = !1);
        return b;
    }
    k.Zf = function () {
        return 0;
    };
    function jy(a, b) {
        a.jc !== b && (a.jc = b, a.u());
    }
    k.eg = function () {
        return this.bb;
    };
    k.jb = function () {
        return this.tileGrid;
    };
    k.eb = function (a) {
        return this.tileGrid ? this.tileGrid : zc(a);
    };
    k.Yd = function (a) {
        var b = this.c;
        return b && !Xb(b, a) ? null : this.a;
    };
    k.Xc = function () {
        return this.sc;
    };
    k.Zd = function (a, b, c) {
        c = this.eb(c);
        b = this.Xc(b);
        a = Ba(c.Za(a), this.j);
        return 1 == b ? a : Aa(a, b, this.j);
    };
    function ky(a, b, c) {
        var d = void 0 !== c ? c : a.c;
        c = a.eb(d);
        if (a.D && d.c) {
            var e = b;
            b = e[0];
            a = yc(c, e);
            d = Dc(d);
            Ja(d, a) ? b = e : (e = cb(d), a[0] += e * Math.ceil((d[0] - a[0]) / e), b = c.jg(a, b));
        }
        e = b[0];
        d = b[1];
        a = b[2];
        if (c.minZoom > e || e > c.maxZoom)
            c = !1;
        else {
            var f = c.G();
            c = (c = f ? tc(c, f, e) : c.a ? c.a[e] : null) ? ma(c, d, a) : !0;
        }
        return c ? b : null;
    }
    k.sa = function () {
        this.a.clear();
        this.u();
    };
    k.kh = ea;
    function ly(a, b) {
        Qc.call(this, a);
        this.tile = b;
    }
    w(ly, Qc);
    function my(a) {
        iy.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            extent: a.extent,
            logo: a.logo,
            opaque: a.opaque,
            projection: a.projection,
            state: a.state,
            tileGrid: a.tileGrid,
            tilePixelRatio: a.tilePixelRatio,
            wrapX: a.wrapX,
            transition: a.transition
        });
        this.tileLoadFunction = a.tileLoadFunction;
        this.tileUrlFunction = this.dc ? this.dc.bind(this) : Xx;
        this.urls = null;
        a.urls ? this.vb(a.urls) : a.url && this.rb(a.url);
        a.tileUrlFunction && this.hb(a.tileUrlFunction);
        this.V = {};
    }
    w(my, iy);
    k = my.prototype;
    k.yb = function () {
        return this.tileLoadFunction;
    };
    k.zb = function () {
        return this.tileUrlFunction;
    };
    k.Ab = function () {
        return this.urls;
    };
    k.dj = function (a) {
        a = a.target;
        var b = x(a), c = a.getState();
        if (1 == c) {
            this.V[b] = !0;
            var d = 'tileloadstart';
        } else
            b in this.V && (delete this.V[b], d = 3 == c ? 'tileloaderror' : 2 == c || 5 == c ? 'tileloadend' : void 0);
        void 0 != d && this.b(new ly(d, a));
    };
    k.Fb = function (a) {
        this.a.clear();
        this.tileLoadFunction = a;
        this.u();
    };
    k.hb = function (a, b) {
        this.tileUrlFunction = a;
        ay(this.a);
        'undefined' !== typeof b ? jy(this, b) : this.u();
    };
    k.rb = function (a) {
        var b = this.urls = Yx(a);
        this.hb(this.dc ? this.dc.bind(this) : Vx(b, this.tileGrid), a);
    };
    k.vb = function (a) {
        this.urls = a;
        var b = a.join('\n');
        this.hb(this.dc ? this.dc.bind(this) : Vx(a, this.tileGrid), b);
    };
    k.kh = function (a, b, c) {
        a = a + '/' + b + '/' + c;
        this.a.a.hasOwnProperty(a) && this.a.get(a);
    };
    function ny(a) {
        my.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            extent: a.extent,
            logo: a.logo,
            opaque: a.opaque,
            projection: a.projection,
            state: a.state,
            tileGrid: a.tileGrid,
            tileLoadFunction: a.tileLoadFunction ? a.tileLoadFunction : oy,
            tilePixelRatio: a.tilePixelRatio,
            tileUrlFunction: a.tileUrlFunction,
            url: a.url,
            urls: a.urls,
            wrapX: a.wrapX,
            transition: a.transition
        });
        this.crossOrigin = void 0 !== a.crossOrigin ? a.crossOrigin : null;
        this.tileClass = void 0 !== a.tileClass ? a.tileClass : el;
        this.f = {};
        this.s = {};
        this.ob = a.reprojectionErrorThreshold;
        this.O = !1;
    }
    w(ny, my);
    k = ny.prototype;
    k.cj = function () {
        if (di(this.a))
            return !0;
        for (var a in this.f)
            if (di(this.f[a]))
                return !0;
        return !1;
    };
    k.sd = function (a, b) {
        a = this.Yd(a);
        this.a.sd(this.a == a ? b : {});
        for (var c in this.f) {
            var d = this.f[c];
            d.sd(d == a ? b : {});
        }
    };
    k.Zf = function (a) {
        return this.c && a && !Xb(this.c, a) ? 0 : this.$f();
    };
    k.$f = function () {
        return 0;
    };
    k.eg = function (a) {
        return this.c && a && !Xb(this.c, a) ? !1 : my.prototype.eg.call(this, a);
    };
    k.eb = function (a) {
        var b = this.c;
        return !this.tileGrid || b && !Xb(b, a) ? (b = x(a).toString(), b in this.s || (this.s[b] = zc(a)), this.s[b]) : this.tileGrid;
    };
    k.Yd = function (a) {
        var b = this.c;
        if (!b || Xb(b, a))
            return this.a;
        a = x(a).toString();
        a in this.f || (this.f[a] = new $x(this.a.highWaterMark));
        return this.f[a];
    };
    function py(a, b, c, d, e, f, g) {
        b = [
            b,
            c,
            d
        ];
        e = (c = ky(a, b, f)) ? a.tileUrlFunction(c, e, f) : void 0;
        e = new a.tileClass(b, void 0 !== e ? 0 : 4, void 0 !== e ? e : '', a.crossOrigin, a.tileLoadFunction, a.Ea);
        e.key = g;
        y(e, 'change', a.dj, a);
        return e;
    }
    k.ad = function (a, b, c, d, e) {
        var f = this.c;
        if (f && e && !Xb(f, e)) {
            var g = this.Yd(e);
            c = [
                a,
                b,
                c
            ];
            var h;
            a = c[0] + '/' + c[1] + '/' + c[2];
            g.a.hasOwnProperty(a) && (h = g.get(a));
            b = this.jc;
            if (h && h.key == b)
                return h;
            var l = this.eb(f), m = this.eb(e), n = ky(this, c, e);
            d = new hy(f, l, e, m, c, n, this.Xc(d), this.$f(), function (a, b, c, d) {
                return qy(this, a, b, c, d, f);
            }.bind(this), this.ob, this.O);
            d.key = b;
            h ? (d.g = h, dl(d), g.replace(a, d)) : g.set(a, d);
            return d;
        }
        return qy(this, a, b, c, d, f || e);
    };
    function qy(a, b, c, d, e, f) {
        var g = b + '/' + c + '/' + d, h = a.jc;
        if (a.a.a.hasOwnProperty(g)) {
            var l = a.a.get(g);
            if (l.key != h) {
                var m = l;
                l = py(a, b, c, d, e, f, h);
                0 == m.getState() ? l.g = m.g : l.g = m;
                dl(l);
                a.a.replace(g, l);
            }
        } else
            l = py(a, b, c, d, e, f, h), a.a.set(g, l);
        return l;
    }
    k.Qb = function (a) {
        if (this.O != a) {
            this.O = a;
            for (var b in this.f)
                this.f[b].clear();
            this.u();
        }
    };
    k.Rb = function (a, b) {
        if (a = Ob(a))
            a = x(a).toString(), a in this.s || (this.s[a] = b);
    };
    function oy(a, b) {
        a.Y().src = b;
    }
    function ry(a) {
        this.i = void 0 !== a.hidpi ? a.hidpi : !1;
        ny.call(this, {
            cacheSize: a.cacheSize,
            crossOrigin: 'anonymous',
            opaque: !0,
            projection: Ob('EPSG:3857'),
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            state: 'loading',
            tileLoadFunction: a.tileLoadFunction,
            tilePixelRatio: this.i ? 2 : 1,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0,
            transition: a.transition
        });
        this.o = void 0 !== a.culture ? a.culture : 'en-us';
        this.$ = void 0 !== a.maxZoom ? a.maxZoom : -1;
        this.l = a.key;
        this.B = a.imagerySet;
        Zx('https://dev.virtualearth.net/REST/v1/Imagery/Metadata/' + this.B + '?uriScheme=https&include=ImageryProviders&key=' + this.l + '&c=' + this.o, this.La.bind(this), void 0, 'jsonp');
    }
    w(ry, ny);
    ry.prototype.ca = function () {
        return this.l;
    };
    ry.prototype.ua = function () {
        return this.B;
    };
    ry.prototype.La = function (a) {
        if (200 != a.statusCode || 'OK' != a.statusDescription || 'ValidCredentials' != a.authenticationResultCode || 1 != a.resourceSets.length || 1 != a.resourceSets[0].resources.length)
            ww(this, 'error');
        else {
            var b = a.brandLogoUri;
            -1 == b.indexOf('https') && (b = b.replace('http', 'https'));
            var c = a.resourceSets[0].resources[0];
            a = -1 == this.$ ? c.zoomMax : this.$;
            var d = Dc(this.c);
            this.tileGrid = Bc({
                extent: d,
                minZoom: c.zoomMin,
                maxZoom: a,
                tileSize: (c.imageWidth == c.imageHeight ? c.imageWidth : [
                    c.imageWidth,
                    c.imageHeight
                ]) / (this.i ? 2 : 1)
            });
            var e = this.o, f = this.i;
            this.tileUrlFunction = Wx(c.imageUrlSubdomains.map(function (a) {
                var b = [
                        0,
                        0,
                        0
                    ], d = c.imageUrl.replace('{subdomain}', a).replace('{culture}', e);
                return function (a) {
                    if (a)
                        return oc(a[0], a[1], -a[2] - 1, b), a = d, f && (a += '&dpi=d1&device=mobile'), a.replace('{quadkey}', pc(b));
                };
            }));
            if (c.imageryProviders) {
                var g = Pb(Ob('EPSG:4326'), this.c);
                this.va(function (a) {
                    var b = [], d = a.viewState.zoom;
                    c.imageryProviders.map(function (c) {
                        for (var e = !1, f = c.coverageAreas, h = 0, l = f.length; h < l; ++h) {
                            var m = f[h];
                            if (d >= m.zoomMin && d <= m.zoomMax && (m = m.bbox, m = jb([
                                    m[1],
                                    m[0],
                                    m[3],
                                    m[2]
                                ], g), hb(m, a.extent))) {
                                e = !0;
                                break;
                            }
                        }
                        e && b.push(c.attribution);
                    });
                    b.push('<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html">Terms of Use</a>');
                    return b;
                });
            }
            this.T = b;
            ww(this, 'ready');
        }
    };
    function sy(a) {
        a = a || {};
        var b = void 0 !== a.projection ? a.projection : 'EPSG:3857', c = void 0 !== a.tileGrid ? a.tileGrid : Bc({
                extent: Dc(b),
                maxZoom: a.maxZoom,
                minZoom: a.minZoom,
                tileSize: a.tileSize
            });
        ny.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            opaque: a.opaque,
            projection: b,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileGrid: c,
            tileLoadFunction: a.tileLoadFunction,
            tilePixelRatio: a.tilePixelRatio,
            tileUrlFunction: a.tileUrlFunction,
            url: a.url,
            urls: a.urls,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0,
            transition: a.transition
        });
    }
    w(sy, ny);
    function ty(a) {
        this.o = a.account;
        this.B = a.map || '';
        this.i = a.config || {};
        this.l = {};
        sy.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            maxZoom: void 0 !== a.maxZoom ? a.maxZoom : 18,
            minZoom: a.minZoom,
            projection: a.projection,
            state: 'loading',
            wrapX: a.wrapX
        });
        uy(this);
    }
    w(ty, sy);
    k = ty.prototype;
    k.nl = function () {
        return this.i;
    };
    k.Sq = function (a) {
        kb(this.i, a);
        uy(this);
    };
    k.uq = function (a) {
        this.i = a || {};
        uy(this);
    };
    function uy(a) {
        var b = JSON.stringify(a.i);
        if (a.l[b])
            vy(a, a.l[b]);
        else {
            var c = 'https://' + a.o + '.carto.com/api/v1/map';
            a.B && (c += '/named/' + a.B);
            var d = new XMLHttpRequest();
            d.addEventListener('load', a.em.bind(a, b));
            d.addEventListener('error', a.dm.bind(a));
            d.open('POST', c);
            d.setRequestHeader('Content-type', 'application/json');
            d.send(JSON.stringify(a.i));
        }
    }
    k.em = function (a, b) {
        b = b.target;
        if (!b.status || 200 <= b.status && 300 > b.status) {
            try {
                var c = JSON.parse(b.responseText);
            } catch (d) {
                ww(this, 'error');
                return;
            }
            vy(this, c);
            this.l[a] = c;
            ww(this, 'ready');
        } else
            ww(this, 'error');
    };
    k.dm = function () {
        ww(this, 'error');
    };
    function vy(a, b) {
        a.rb('https://' + b.cdn_url.https + '/' + a.o + '/api/v1/map/' + b.layergroupid + '/{z}/{x}/{y}.png');
    }
    function X(a) {
        U.call(this, {
            attributions: a.attributions,
            extent: a.extent,
            logo: a.logo,
            projection: a.projection,
            wrapX: a.wrapX
        });
        this.resolution = void 0;
        this.distance = void 0 !== a.distance ? a.distance : 20;
        this.features = [];
        this.geometryFunction = a.geometryFunction || function (a) {
            a = a.U();
            oa(a instanceof C, 10);
            return a;
        };
        this.source = a.source;
        this.source.I('change', X.prototype.sa, this);
    }
    w(X, U);
    k = X.prototype;
    k.Eo = function () {
        return this.distance;
    };
    k.Fo = function () {
        return this.source;
    };
    k.ae = function (a, b, c) {
        this.source.ae(a, b, c);
        b !== this.resolution && (this.clear(), this.resolution = b, wy(this), this.Qc(this.features));
    };
    k.vq = function (a) {
        this.distance = a;
        this.sa();
    };
    k.sa = function () {
        this.clear();
        wy(this);
        this.Qc(this.features);
        U.prototype.sa.call(this);
    };
    function wy(a) {
        if (void 0 !== a.resolution) {
            a.features.length = 0;
            for (var b = Da(), c = a.distance * a.resolution, d = a.source.ee(), e = {}, f = 0, g = d.length; f < g; f++) {
                var h = d[f];
                x(h).toString() in e || !(h = a.geometryFunction(h)) || (h = h.W(), Pa(h, b), Fa(b, c, b), h = a.source.Yf(b), h = h.filter(function (a) {
                    a = x(a).toString();
                    return a in e ? !1 : e[a] = !0;
                }), a.features.push(xy(a, h)));
            }
        }
    }
    function xy(a, b) {
        for (var c = [
                    0,
                    0
                ], d = b.length - 1; 0 <= d; --d) {
            var e = a.geometryFunction(b[d]);
            e ? ze(c, e.W()) : b.splice(d, 1);
        }
        Ge(c, 1 / b.length);
        a = new Hk(new C(c));
        a.set('features', b);
        return a;
    }
    function yy(a, b, c, d, e, f) {
        this.s = b;
        this.l = a.G();
        var g = b.G(), h = g ? gb(c, g) : c;
        g = by(a, b, eb(h), d);
        this.f = new ey(a, b, h, this.l, 0.5 * g);
        this.c = d;
        this.g = c;
        a = gy(this.f);
        this.j = (this.Tb = f(a, g, e)) ? this.Tb.a : 1;
        this.je = this.i = null;
        e = 2;
        this.Tb && (e = 0);
        $h.call(this, c, d, this.j, e);
    }
    w(yy, $h);
    yy.prototype.ia = function () {
        1 == this.state && (Gc(this.je), this.je = null);
        $h.prototype.ia.call(this);
    };
    yy.prototype.Y = function () {
        return this.i;
    };
    yy.prototype.he = function () {
        var a = this.Tb.getState();
        2 == a && (this.i = dy(cb(this.g) / this.c, db(this.g) / this.c, this.j, this.Tb.resolution, 0, this.c, this.g, this.f, [{
                extent: this.Tb.G(),
                image: this.Tb.Y()
            }], 0));
        this.state = a;
        this.u();
    };
    yy.prototype.load = function () {
        if (0 == this.state) {
            this.state = 1;
            this.u();
            var a = this.Tb.getState();
            2 == a || 3 == a ? this.he() : (this.je = y(this.Tb, 'change', function () {
                var a = this.Tb.getState();
                if (2 == a || 3 == a)
                    Gc(this.je), this.je = null, this.he();
            }, this), this.Tb.load());
        }
    };
    function zy(a) {
        uw.call(this, {
            attributions: a.attributions,
            extent: a.extent,
            logo: a.logo,
            projection: a.projection,
            state: a.state
        });
        this.o = void 0 !== a.resolutions ? a.resolutions : null;
        this.i = null;
        this.ua = 0;
    }
    w(zy, uw);
    function Ay(a, b) {
        a.o && (b = a.o[fc(a.o, b, 0)]);
        return b;
    }
    zy.prototype.Y = function (a, b, c, d) {
        var e = this.c;
        if (e && d && !Xb(e, d)) {
            if (this.i) {
                if (this.ua == this.g && Xb(this.i.s, d) && this.i.resolution == b && Sa(this.i.G(), a))
                    return this.i;
                Pc(this.i);
                this.i = null;
            }
            this.i = new yy(e, d, a, b, c, function (a, b, c) {
                return this.Wc(a, b, c, e);
            }.bind(this));
            this.ua = this.g;
            return this.i;
        }
        e && (d = e);
        return this.Wc(a, b, c, d);
    };
    zy.prototype.j = function (a) {
        a = a.target;
        switch (a.getState()) {
        case 1:
            this.b(new By(Cy, a));
            break;
        case 2:
            this.b(new By(Dy, a));
            break;
        case 3:
            this.b(new By(Ey, a));
        }
    };
    function Fy(a, b) {
        a.Y().src = b;
    }
    function By(a, b) {
        Qc.call(this, a);
        this.image = b;
    }
    w(By, Qc);
    var Cy = 'imageloadstart', Dy = 'imageloadend', Ey = 'imageloaderror';
    function Gy(a, b) {
        var c = [];
        Object.keys(b).forEach(function (a) {
            null !== b[a] && void 0 !== b[a] && c.push(a + '=' + encodeURIComponent(b[a]));
        });
        var d = c.join('&');
        a = a.replace(/[?&]$/, '');
        a = -1 === a.indexOf('?') ? a + '?' : a + '&';
        return a + d;
    }
    function Hy(a) {
        a = a || {};
        zy.call(this, {
            attributions: a.attributions,
            logo: a.logo,
            projection: a.projection,
            resolutions: a.resolutions
        });
        this.V = void 0 !== a.crossOrigin ? a.crossOrigin : null;
        this.$ = void 0 !== a.hidpi ? a.hidpi : !0;
        this.a = a.url;
        this.f = void 0 !== a.imageLoadFunction ? a.imageLoadFunction : Fy;
        this.s = a.params || {};
        this.M = null;
        this.l = [
            0,
            0
        ];
        this.O = 0;
        this.B = void 0 !== a.ratio ? a.ratio : 1.5;
    }
    w(Hy, zy);
    k = Hy.prototype;
    k.Ho = function () {
        return this.s;
    };
    k.Wc = function (a, b, c, d) {
        if (void 0 === this.a)
            return null;
        b = Ay(this, b);
        c = this.$ ? c : 1;
        var e = this.M;
        if (e && this.O == this.g && e.resolution == b && e.a == c && La(e.G(), a))
            return e;
        e = {
            F: 'image',
            FORMAT: 'PNG32',
            TRANSPARENT: !0
        };
        kb(e, this.s);
        a = a.slice();
        var f = (a[0] + a[2]) / 2, g = (a[1] + a[3]) / 2;
        if (1 != this.B) {
            var h = this.B * cb(a) / 2, l = this.B * db(a) / 2;
            a[0] = f - h;
            a[1] = g - l;
            a[2] = f + h;
            a[3] = g + l;
        }
        h = b / c;
        l = Math.ceil(cb(a) / h);
        var m = Math.ceil(db(a) / h);
        a[0] = f - h * l / 2;
        a[2] = f + h * l / 2;
        a[1] = g - h * m / 2;
        a[3] = g + h * m / 2;
        this.l[0] = l;
        this.l[1] = m;
        f = a;
        g = this.l;
        h = c;
        d = d.wb.split(':').pop();
        e.SIZE = g[0] + ',' + g[1];
        e.BBOX = f.join(',');
        e.BBOXSR = d;
        e.IMAGESR = d;
        e.DPI = Math.round(90 * h);
        d = this.a;
        f = d.replace(/MapServer\/?$/, 'MapServer/export').replace(/ImageServer\/?$/, 'ImageServer/exportImage');
        f == d && oa(!1, 50);
        e = Gy(f, e);
        this.M = new bl(a, b, c, e, this.V, this.f);
        this.O = this.g;
        y(this.M, 'change', this.j, this);
        return this.M;
    };
    k.Go = function () {
        return this.f;
    };
    k.Io = function () {
        return this.a;
    };
    k.Jo = function (a) {
        this.M = null;
        this.f = a;
        this.u();
    };
    k.Ko = function (a) {
        a != this.a && (this.a = a, this.M = null, this.u());
    };
    k.Lo = function (a) {
        kb(this.s, a);
        this.M = null;
        this.u();
    };
    function Iy(a) {
        zy.call(this, {
            attributions: a.attributions,
            logo: a.logo,
            projection: a.projection,
            resolutions: a.resolutions,
            state: a.state
        });
        this.Ea = a.canvasFunction;
        this.V = null;
        this.$ = 0;
        this.La = void 0 !== a.ratio ? a.ratio : 1.5;
    }
    w(Iy, zy);
    Iy.prototype.Wc = function (a, b, c, d) {
        b = Ay(this, b);
        var e = this.V;
        if (e && this.$ == this.g && e.resolution == b && e.a == c && La(e.G(), a))
            return e;
        a = a.slice();
        ib(a, this.La);
        (d = this.Ea(a, b, c, [
            cb(a) / b * c,
            db(a) / b * c
        ], d)) && (e = new ai(a, b, c, d));
        this.V = e;
        this.$ = this.g;
        return e;
    };
    function Jy(a) {
        zy.call(this, {
            projection: a.projection,
            resolutions: a.resolutions
        });
        this.V = void 0 !== a.crossOrigin ? a.crossOrigin : null;
        this.l = void 0 !== a.displayDpi ? a.displayDpi : 96;
        this.f = a.params || {};
        this.O = a.url;
        this.a = void 0 !== a.imageLoadFunction ? a.imageLoadFunction : Fy;
        this.$ = void 0 !== a.hidpi ? a.hidpi : !0;
        this.ca = void 0 !== a.metersPerUnit ? a.metersPerUnit : 1;
        this.s = void 0 !== a.ratio ? a.ratio : 1;
        this.Ea = void 0 !== a.useOverlay ? a.useOverlay : !1;
        this.M = null;
        this.B = 0;
    }
    w(Jy, zy);
    k = Jy.prototype;
    k.No = function () {
        return this.f;
    };
    k.Wc = function (a, b, c) {
        b = Ay(this, b);
        c = this.$ ? c : 1;
        var d = this.M;
        if (d && this.B == this.g && d.resolution == b && d.a == c && La(d.G(), a))
            return d;
        1 != this.s && (a = a.slice(), ib(a, this.s));
        var e = [
            cb(a) / b * c,
            db(a) / b * c
        ];
        if (void 0 !== this.O) {
            d = this.O;
            var f = eb(a), g = this.ca, h = cb(a), l = db(a), m = e[0], n = e[1], p = 0.0254 / this.l;
            e = {
                OPERATION: this.Ea ? 'GETDYNAMICMAPOVERLAYIMAGE' : 'GETMAPIMAGE',
                VERSION: '2.0.0',
                LOCALE: 'en',
                CLIENTAGENT: 'ol.source.ImageMapGuide source',
                CLIP: '1',
                SETDISPLAYDPI: this.l,
                SETDISPLAYWIDTH: Math.round(e[0]),
                SETDISPLAYHEIGHT: Math.round(e[1]),
                SETVIEWSCALE: n * h > m * l ? h * g / (m * p) : l * g / (n * p),
                SETVIEWCENTERX: f[0],
                SETVIEWCENTERY: f[1]
            };
            kb(e, this.f);
            d = Gy(d, e);
            d = new bl(a, b, c, d, this.V, this.a);
            y(d, 'change', this.j, this);
        } else
            d = null;
        this.M = d;
        this.B = this.g;
        return d;
    };
    k.Mo = function () {
        return this.a;
    };
    k.Po = function (a) {
        kb(this.f, a);
        this.u();
    };
    k.Oo = function (a) {
        this.M = null;
        this.a = a;
        this.u();
    };
    function Ky(a) {
        var b = a.imageExtent, c = void 0 !== a.crossOrigin ? a.crossOrigin : null, d = void 0 !== a.imageLoadFunction ? a.imageLoadFunction : Fy;
        zy.call(this, {
            attributions: a.attributions,
            logo: a.logo,
            projection: Ob(a.projection)
        });
        this.M = new bl(b, void 0, 1, a.url, c, d);
        this.a = a.imageSize ? a.imageSize : null;
        y(this.M, 'change', this.j, this);
    }
    w(Ky, zy);
    Ky.prototype.Wc = function (a) {
        return hb(a, this.M.G()) ? this.M : null;
    };
    Ky.prototype.j = function (a) {
        if (2 == this.M.getState()) {
            var b = this.M.G(), c = this.M.Y();
            if (this.a) {
                var d = this.a[0];
                var e = this.a[1];
            } else
                d = c.width, e = c.height;
            b = Math.ceil(cb(b) / (db(b) / e));
            if (b != d) {
                b = hg(b, e);
                var f = b.canvas;
                b.drawImage(c, 0, 0, d, e, 0, 0, f.width, f.height);
                this.M.ih(f);
            }
        }
        zy.prototype.j.call(this, a);
    };
    function Ly(a) {
        this.a = a.source;
        this.ob = We();
        this.f = hg();
        this.l = [
            0,
            0
        ];
        this.ca = rj.Jc(9);
        this.bb = void 0 == a.renderBuffer ? 100 : a.renderBuffer;
        this.B = null;
        Iy.call(this, {
            attributions: a.attributions,
            canvasFunction: this.Mk.bind(this),
            logo: a.logo,
            projection: a.projection,
            ratio: a.ratio,
            resolutions: a.resolutions,
            state: this.a.getState()
        });
        this.O = null;
        this.s = void 0;
        this.aj(a.style);
        y(this.a, 'change', this.To, this);
    }
    w(Ly, Iy);
    k = Ly.prototype;
    k.Mk = function (a, b, c, d, e) {
        var f = new Vj(0.5 * b / c, a, b, c, this.a.$, this.ca, this.bb);
        this.a.ae(a, b, e);
        var g = !1;
        this.a.ec(a, function (a) {
            var d;
            if (!(d = g)) {
                var e;
                (d = a.ib()) ? e = d.call(a, b) : this.s && (e = this.s(a, b));
                if (e) {
                    var h, p = !1;
                    Array.isArray(e) || (e = [e]);
                    d = 0;
                    for (h = e.length; d < h; ++d)
                        p = ek(f, a, e[d], dk(b, c), this.So, this) || p;
                    d = p;
                } else
                    d = !1;
            }
            g = d;
        }, this);
        Zj(f);
        if (g)
            return null;
        this.l[0] != d[0] || this.l[1] != d[1] ? (this.f.canvas.width = d[0], this.f.canvas.height = d[1], this.l[0] = d[0], this.l[1] = d[1]) : this.f.clearRect(0, 0, d[0], d[1]);
        this.ca.clear();
        a = My(this, eb(a), b, c, d);
        f.Na(this.f, a, 0, {});
        this.B = f;
        return this.f.canvas;
    };
    k.wa = function (a, b, c, d, e, f) {
        if (this.B) {
            var g = {};
            return this.B.wa(a, b, 0, d, e, function (a) {
                var b = x(a).toString();
                if (!(b in g))
                    return g[b] = !0, f(a);
            }, null);
        }
    };
    k.Qo = function () {
        return this.a;
    };
    k.Ro = function () {
        return this.O;
    };
    k.ib = function () {
        return this.s;
    };
    function My(a, b, c, d, e) {
        c = d / c;
        return ef(a.ob, e[0] / 2, e[1] / 2, c, -c, 0, -b[0], -b[1]);
    }
    k.So = function () {
        this.u();
    };
    k.To = function () {
        ww(this, this.a.getState());
    };
    k.aj = function (a) {
        this.O = void 0 !== a ? a : Fk;
        this.s = a ? Dk(this.O) : void 0;
        this.u();
    };
    function Ny(a) {
        a = a || {};
        zy.call(this, {
            attributions: a.attributions,
            logo: a.logo,
            projection: a.projection,
            resolutions: a.resolutions
        });
        this.ca = void 0 !== a.crossOrigin ? a.crossOrigin : null;
        this.f = a.url;
        this.s = void 0 !== a.imageLoadFunction ? a.imageLoadFunction : Fy;
        this.a = a.params || {};
        this.l = !0;
        Oy(this);
        this.$ = a.serverType;
        this.Ea = void 0 !== a.hidpi ? a.hidpi : !0;
        this.M = null;
        this.B = [
            0,
            0
        ];
        this.V = 0;
        this.O = void 0 !== a.ratio ? a.ratio : 1.5;
    }
    w(Ny, zy);
    var Py = [
        101,
        101
    ];
    k = Ny.prototype;
    k.Uo = function (a, b, c, d) {
        if (void 0 !== this.f) {
            c = Ob(c);
            var e = this.c;
            e && e !== c && (b = by(e, c, a, b), a = ac(a, c, e));
            var f = fb(a, b, 0, Py), g = {
                    SERVICE: 'WMS',
                    VERSION: '1.3.0',
                    REQUEST: 'GetFeatureInfo',
                    FORMAT: 'image/png',
                    TRANSPARENT: !0,
                    QUERY_LAYERS: this.a.LAYERS
                };
            kb(g, this.a, d);
            d = Math.floor((f[3] - a[1]) / b);
            g[this.l ? 'I' : 'X'] = Math.floor((a[0] - f[0]) / b);
            g[this.l ? 'J' : 'Y'] = d;
            return Qy(this, f, Py, 1, e || c, g);
        }
    };
    k.Wo = function () {
        return this.a;
    };
    k.Wc = function (a, b, c, d) {
        if (void 0 === this.f)
            return null;
        b = Ay(this, b);
        1 == c || this.Ea && void 0 !== this.$ || (c = 1);
        var e = b / c, f = eb(a), g = fb(f, e, 0, [
                Math.ceil(cb(a) / e),
                Math.ceil(db(a) / e)
            ]);
        a = fb(f, e, 0, [
            Math.ceil(this.O * cb(a) / e),
            Math.ceil(this.O * db(a) / e)
        ]);
        if ((f = this.M) && this.V == this.g && f.resolution == b && f.a == c && La(f.G(), g))
            return f;
        g = {
            SERVICE: 'WMS',
            VERSION: '1.3.0',
            REQUEST: 'GetMap',
            FORMAT: 'image/png',
            TRANSPARENT: !0
        };
        kb(g, this.a);
        this.B[0] = Math.round(cb(a) / e);
        this.B[1] = Math.round(db(a) / e);
        d = Qy(this, a, this.B, c, d, g);
        this.M = new bl(a, b, c, d, this.ca, this.s);
        this.V = this.g;
        y(this.M, 'change', this.j, this);
        return this.M;
    };
    k.Vo = function () {
        return this.s;
    };
    function Qy(a, b, c, d, e, f) {
        oa(void 0 !== a.f, 9);
        f[a.l ? 'CRS' : 'SRS'] = e.wb;
        'STYLES' in a.a || (f.STYLES = '');
        if (1 != d)
            switch (a.$) {
            case 'geoserver':
                d = 90 * d + 0.5 | 0;
                f.FORMAT_OPTIONS = 'FORMAT_OPTIONS' in f ? f.FORMAT_OPTIONS + (';dpi:' + d) : 'dpi:' + d;
                break;
            case 'mapserver':
                f.MAP_RESOLUTION = 90 * d;
                break;
            case 'carmentaserver':
            case 'qgis':
                f.DPI = 90 * d;
                break;
            default:
                oa(!1, 8);
            }
        f.WIDTH = c[0];
        f.HEIGHT = c[1];
        c = e.b;
        var g;
        a.l && 'ne' == c.substr(0, 2) ? g = [
            b[1],
            b[0],
            b[3],
            b[2]
        ] : g = b;
        f.BBOX = g.join(',');
        return Gy(a.f, f);
    }
    k.Xo = function () {
        return this.f;
    };
    k.Yo = function (a) {
        this.M = null;
        this.s = a;
        this.u();
    };
    k.Zo = function (a) {
        a != this.f && (this.f = a, this.M = null, this.u());
    };
    k.$o = function (a) {
        kb(this.a, a);
        Oy(this);
        this.M = null;
        this.u();
    };
    function Oy(a) {
        a.l = 0 <= ye(a.a.VERSION || '1.3.0');
    }
    function Ry(a) {
        a = a || {};
        var b;
        void 0 !== a.attributions ? b = a.attributions : b = ['&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.'];
        sy.call(this, {
            attributions: b,
            cacheSize: a.cacheSize,
            crossOrigin: void 0 !== a.crossOrigin ? a.crossOrigin : 'anonymous',
            opaque: void 0 !== a.opaque ? a.opaque : !0,
            maxZoom: void 0 !== a.maxZoom ? a.maxZoom : 19,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileLoadFunction: a.tileLoadFunction,
            url: void 0 !== a.url ? a.url : 'https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png',
            wrapX: a.wrapX
        });
    }
    w(Ry, sy);
    rj.nf = {};
    rj.nf.Hf = function () {
    };
    (function (a) {
        function b(a, b, c) {
            if (g)
                return new ImageData(a, b, c);
            b = h.createImageData(b, c);
            b.data.set(a);
            return b;
        }
        function c(a) {
            var b = !0;
            try {
                new ImageData(10, 10);
            } catch (n) {
                b = !1;
            }
            return function (c) {
                var d = c.buffers, e = c.meta, f = c.width, g = c.height, h = d.length, l = d[0].byteLength;
                if (c.imageOps) {
                    l = Array(h);
                    for (c = 0; c < h; ++c) {
                        var m = c;
                        var n = new Uint8ClampedArray(d[c]);
                        var S = f, Ia = g;
                        n = b ? new ImageData(n, S, Ia) : {
                            data: n,
                            width: S,
                            height: Ia
                        };
                        l[m] = n;
                    }
                    f = a(l, e).data;
                } else {
                    f = new Uint8ClampedArray(l);
                    g = Array(h);
                    m = Array(h);
                    for (c = 0; c < h; ++c)
                        g[c] = new Uint8ClampedArray(d[c]), m[c] = [
                            0,
                            0,
                            0,
                            0
                        ];
                    for (d = 0; d < l; d += 4) {
                        for (c = 0; c < h; ++c)
                            n = g[c], m[c][0] = n[d], m[c][1] = n[d + 1], m[c][2] = n[d + 2], m[c][3] = n[d + 3];
                        c = a(m, e);
                        f[d] = c[0];
                        f[d + 1] = c[1];
                        f[d + 2] = c[2];
                        f[d + 3] = c[3];
                    }
                }
                return f.buffer;
            };
        }
        function d(a, b) {
            var d = Object.keys(a.lib || {}).map(function (b) {
                return 'var ' + b + ' = ' + a.lib[b].toString() + ';';
            }).concat([
                'var __minion__ = (' + c.toString() + ')(',
                a.operation.toString(),
                ');',
                'self.addEventListener("message", function(event) {',
                '  var buffer = __minion__(event.data);',
                '  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);',
                '});'
            ]);
            d = URL.createObjectURL(new Blob(d, { type: 'text/javascript' }));
            d = new Worker(d);
            d.addEventListener('message', b);
            return d;
        }
        function e(a, b) {
            var d = c(a.operation);
            return {
                postMessage: function (a) {
                    setTimeout(function () {
                        b({
                            data: {
                                buffer: d(a),
                                meta: a.meta
                            }
                        });
                    }, 0);
                }
            };
        }
        function f(a) {
            this.Jf = !!a.Cm;
            var b;
            0 === a.threads ? b = 0 : this.Jf ? b = 1 : b = a.threads || 1;
            var c = [];
            if (b)
                for (var f = 0; f < b; ++f)
                    c[f] = d(a, this.xh.bind(this, f));
            else
                c[0] = e(a, this.xh.bind(this, 0));
            this.we = c;
            this.Nd = [];
            this.Bk = a.Sp || Infinity;
            this.ve = 0;
            this.od = {};
            this.Kf = null;
        }
        var g = !0;
        try {
            new ImageData(10, 10);
        } catch (l) {
            g = !1;
        }
        var h = document.createElement('canvas').getContext('2d');
        f.prototype.Rp = function (a, b, c) {
            this.zk({
                inputs: a,
                ii: b,
                callback: c
            });
            this.uh();
        };
        f.prototype.zk = function (a) {
            for (this.Nd.push(a); this.Nd.length > this.Bk;)
                this.Nd.shift().callback(null, null);
        };
        f.prototype.uh = function () {
            if (0 === this.ve && 0 < this.Nd.length) {
                var a = this.Kf = this.Nd.shift(), b = a.inputs[0].width, c = a.inputs[0].height, d = a.inputs.map(function (a) {
                        return a.data.buffer;
                    }), e = this.we.length;
                this.ve = e;
                if (1 === e)
                    this.we[0].postMessage({
                        buffers: d,
                        meta: a.ii,
                        imageOps: this.Jf,
                        width: b,
                        height: c
                    }, d);
                else
                    for (var f = 4 * Math.ceil(a.inputs[0].data.length / 4 / e), g = 0; g < e; ++g) {
                        for (var h = g * f, z = [], A = 0, E = d.length; A < E; ++A)
                            z.push(d[g].slice(h, h + f));
                        this.we[g].postMessage({
                            buffers: z,
                            meta: a.ii,
                            imageOps: this.Jf,
                            width: b,
                            height: c
                        }, z);
                    }
            }
        };
        f.prototype.xh = function (a, b) {
            this.hr || (this.od[a] = b.data, --this.ve, 0 === this.ve && this.Ck());
        };
        f.prototype.Ck = function () {
            var a = this.Kf, c = this.we.length;
            if (1 === c) {
                var d = new Uint8ClampedArray(this.od[0].buffer);
                var e = this.od[0].meta;
            } else {
                var f = a.inputs[0].data.length;
                d = new Uint8ClampedArray(f);
                e = Array(f);
                f = 4 * Math.ceil(f / 4 / c);
                for (var g = 0; g < c; ++g) {
                    var h = g * f;
                    d.set(new Uint8ClampedArray(this.od[g].buffer), h);
                    e[g] = this.od[g].meta;
                }
            }
            this.Kf = null;
            this.od = {};
            a.callback(null, b(d, a.inputs[0].width, a.inputs[0].height), e);
            this.uh();
        };
        a['default'] = { Hf: f };
        a.Hf = f;
    }(rj.nf = rj.nf || {}));
    function Sy(a) {
        this.B = null;
        this.Ea = void 0 !== a.operationType ? a.operationType : 'pixel';
        this.La = void 0 !== a.threads ? a.threads : 1;
        this.f = Ty(a.sources);
        for (var b = 0, c = this.f.length; b < c; ++b)
            y(this.f[b], 'change', this.u, this);
        this.$ = new le(function () {
            return 1;
        }, this.u.bind(this));
        b = Uy(this.f);
        c = {};
        for (var d = 0, e = b.length; d < e; ++d)
            c[x(b[d].layer)] = b[d];
        this.a = null;
        this.O = {
            animate: !1,
            coordinateToPixelTransform: We(),
            extent: null,
            focus: null,
            index: 0,
            layerStates: c,
            layerStatesArray: b,
            logos: {},
            pixelRatio: 1,
            pixelToCoordinateTransform: We(),
            postRenderFunctions: [],
            size: [
                0,
                0
            ],
            skippedFeatureUids: {},
            tileQueue: this.$,
            time: Date.now(),
            usedTiles: {},
            viewState: { rotation: 0 },
            viewHints: [],
            wantedTiles: {}
        };
        zy.call(this, {});
        void 0 !== a.operation && this.s(a.operation, a.lib);
    }
    w(Sy, zy);
    Sy.prototype.s = function (a, b) {
        this.B = new rj.nf.Hf({
            operation: a,
            Cm: 'image' === this.Ea,
            Sp: 1,
            lib: b,
            threads: this.La
        });
        this.u();
    };
    Sy.prototype.Y = function (a, b, c, d) {
        c = !0;
        for (var e, f = 0, g = this.f.length; f < g; ++f)
            if (e = this.f[f].a.ha(), 'ready' !== e.getState()) {
                c = !1;
                break;
            }
        if (!c)
            return null;
        c = kb({}, this.O);
        c.viewState = kb({}, c.viewState);
        e = eb(a);
        c.extent = a.slice();
        c.focus = e;
        c.size[0] = Math.round(cb(a) / b);
        c.size[1] = Math.round(db(a) / b);
        c.time = Date.now();
        c.animate = !1;
        f = c.viewState;
        f.center = e;
        f.projection = d;
        f.resolution = b;
        this.l = c;
        this.a && (d = this.a.resolution, e = this.a.G(), b === d && Sa(a, e) || (this.a = null));
        if (!this.a || this.g !== this.V)
            a: {
                a = this.l;
                d = this.f.length;
                b = Array(d);
                for (e = 0; e < d; ++e) {
                    f = this.f[e];
                    g = a;
                    var h = a.layerStatesArray[e];
                    if (f.$c(g, h)) {
                        var l = g.size[0], m = g.size[1];
                        if (Vy) {
                            var n = Vy.canvas;
                            n.width !== l || n.height !== m ? Vy = hg(l, m) : Vy.clearRect(0, 0, l, m);
                        } else
                            Vy = hg(l, m);
                        f.df(g, h, Vy);
                        f = Vy.getImageData(0, 0, l, m);
                    } else
                        f = null;
                    if (f)
                        b[e] = f;
                    else
                        break a;
                }
                d = {};
                this.b(new Wy(Xy, a, d));
                this.B.Rp(b, d, this.ca.bind(this, a));
            }
        me(c.tileQueue, 16, 16);
        c.animate && requestAnimationFrame(this.u.bind(this));
        return this.a;
    };
    Sy.prototype.ca = function (a, b, c, d) {
        if (!b && c) {
            b = a.extent;
            var e = a.viewState.resolution;
            if (e === this.l.viewState.resolution && Sa(b, this.l.extent)) {
                if (this.a)
                    var f = this.a.Y().getContext('2d');
                else
                    f = hg(Math.round(cb(b) / e), Math.round(db(b) / e)), this.a = new ai(b, e, 1, f.canvas);
                f.putImageData(c, 0, 0);
                this.u();
                this.V = this.g;
                this.b(new Wy(Yy, a, d));
            }
        }
    };
    var Vy = null;
    function Uy(a) {
        return a.map(function (a) {
            return lg(a.a);
        });
    }
    function Ty(a) {
        for (var b = a.length, c = Array(b), d = 0; d < b; ++d) {
            var e = d, f = a[d], g = null;
            f instanceof iy ? (f = new Tx({ source: f }), g = new mj(f)) : f instanceof zy && (f = new Sx({ source: f }), g = new bj(f));
            c[e] = g;
        }
        return c;
    }
    function Wy(a, b, c) {
        Qc.call(this, a);
        this.extent = b.extent;
        this.resolution = b.viewState.resolution / b.pixelRatio;
        this.data = c;
    }
    w(Wy, Qc);
    Sy.prototype.Wc = function () {
        return null;
    };
    var Xy = 'beforeoperations', Yy = 'afteroperations';
    function Zy(a) {
        var b = a.layer.indexOf('-');
        b = $y[-1 == b ? a.layer : a.layer.slice(0, b)];
        var c = az[a.layer];
        sy.call(this, {
            attributions: bz,
            cacheSize: a.cacheSize,
            crossOrigin: 'anonymous',
            maxZoom: void 0 != a.maxZoom ? a.maxZoom : b.maxZoom,
            minZoom: void 0 != a.minZoom ? a.minZoom : b.minZoom,
            opaque: c.opaque,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileLoadFunction: a.tileLoadFunction,
            url: void 0 !== a.url ? a.url : 'https://stamen-tiles-{a-d}.a.ssl.fastly.net/' + a.layer + '/{z}/{x}/{y}.' + c.Ob,
            wrapX: a.wrapX
        });
    }
    w(Zy, sy);
    var bz = [
            'Map tiles by <a href="https://stamen.com/">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.',
            '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.'
        ], az = {
            terrain: {
                Ob: 'jpg',
                opaque: !0
            },
            'terrain-background': {
                Ob: 'jpg',
                opaque: !0
            },
            'terrain-labels': {
                Ob: 'png',
                opaque: !1
            },
            'terrain-lines': {
                Ob: 'png',
                opaque: !1
            },
            'toner-background': {
                Ob: 'png',
                opaque: !0
            },
            toner: {
                Ob: 'png',
                opaque: !0
            },
            'toner-hybrid': {
                Ob: 'png',
                opaque: !1
            },
            'toner-labels': {
                Ob: 'png',
                opaque: !1
            },
            'toner-lines': {
                Ob: 'png',
                opaque: !1
            },
            'toner-lite': {
                Ob: 'png',
                opaque: !0
            },
            watercolor: {
                Ob: 'jpg',
                opaque: !0
            }
        }, $y = {
            terrain: {
                minZoom: 4,
                maxZoom: 18
            },
            toner: {
                minZoom: 0,
                maxZoom: 20
            },
            watercolor: {
                minZoom: 1,
                maxZoom: 16
            }
        };
    function cz(a) {
        a = a || {};
        ny.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            projection: a.projection,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileGrid: a.tileGrid,
            tileLoadFunction: a.tileLoadFunction,
            url: a.url,
            urls: a.urls,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0,
            transition: a.transition
        });
        this.i = a.params || {};
        this.l = Da();
        jy(this, dz(this));
    }
    w(cz, ny);
    function dz(a) {
        var b = 0, c = [], d;
        for (d in a.i)
            c[b++] = d + '-' + a.i[d];
        return c.join('/');
    }
    cz.prototype.o = function () {
        return this.i;
    };
    cz.prototype.Xc = function (a) {
        return a;
    };
    cz.prototype.dc = function (a, b, c) {
        var d = this.tileGrid;
        d || (d = this.eb(c));
        if (!(d.b.length <= a[0])) {
            var e = d.Ma(a, this.l), f = Ba(d.Za(a[0]), this.j);
            1 != b && (f = Aa(f, b, this.j));
            d = {
                F: 'image',
                FORMAT: 'PNG32',
                TRANSPARENT: !0
            };
            kb(d, this.i);
            var g = this.urls;
            g ? (c = c.wb.split(':').pop(), d.SIZE = f[0] + ',' + f[1], d.BBOX = e.join(','), d.BBOXSR = c, d.IMAGESR = c, d.DPI = Math.round(d.DPI ? d.DPI * b : 90 * b), a = (1 == g.length ? g[0] : g[wa((a[1] << a[0]) + a[2], g.length)]).replace(/MapServer\/?$/, 'MapServer/export').replace(/ImageServer\/?$/, 'ImageServer/exportImage'), a = Gy(a, d)) : a = void 0;
            return a;
        }
    };
    cz.prototype.B = function (a) {
        kb(this.i, a);
        jy(this, dz(this));
    };
    function ez(a) {
        iy.call(this, {
            opaque: !1,
            projection: a.projection,
            tileGrid: a.tileGrid,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0
        });
    }
    w(ez, iy);
    ez.prototype.ad = function (a, b, c) {
        var d = a + '/' + b + '/' + c;
        if (this.a.a.hasOwnProperty(d))
            return this.a.get(d);
        var e = Ba(this.tileGrid.Za(a));
        a = [
            a,
            b,
            c
        ];
        b = (b = ky(this, a)) ? ky(this, b).toString() : '';
        e = new fz(a, e, b);
        this.a.set(d, e);
        return e;
    };
    function fz(a, b, c) {
        cl.call(this, a, 2);
        this.c = b;
        this.ta = c;
        this.a = null;
    }
    w(fz, cl);
    fz.prototype.Y = function () {
        if (this.a)
            return this.a;
        var a = this.c, b = hg(a[0], a[1]);
        b.strokeStyle = 'black';
        b.strokeRect(0.5, 0.5, a[0] + 0.5, a[1] + 0.5);
        b.fillStyle = 'black';
        b.textAlign = 'center';
        b.textBaseline = 'middle';
        b.font = '24px sans-serif';
        b.fillText(this.ta, a[0] / 2, a[1] / 2);
        return this.a = b.canvas;
    };
    fz.prototype.load = function () {
    };
    function gz(a) {
        this.i = null;
        ny.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            projection: Ob('EPSG:3857'),
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            state: 'loading',
            tileLoadFunction: a.tileLoadFunction,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0,
            transition: a.transition
        });
        if (a.url)
            if (a.jsonp)
                Zx(a.url, this.Cg.bind(this), this.ef.bind(this));
            else {
                var b = new XMLHttpRequest();
                b.addEventListener('load', this.bp.bind(this));
                b.addEventListener('error', this.ap.bind(this));
                b.open('GET', a.url);
                b.send();
            }
        else
            a.tileJSON ? this.Cg(a.tileJSON) : oa(!1, 51);
    }
    w(gz, ny);
    k = gz.prototype;
    k.bp = function (a) {
        a = a.target;
        if (!a.status || 200 <= a.status && 300 > a.status) {
            try {
                var b = JSON.parse(a.responseText);
            } catch (c) {
                this.ef();
                return;
            }
            this.Cg(b);
        } else
            this.ef();
    };
    k.ap = function () {
        this.ef();
    };
    k.Sl = function () {
        return this.i;
    };
    k.Cg = function (a) {
        var b = Ob('EPSG:4326'), c = this.c;
        if (void 0 !== a.bounds) {
            var d = Pb(b, c);
            d = jb(a.bounds, d);
        }
        var e = a.minzoom || 0, f = a.maxzoom || 22;
        this.tileGrid = c = Bc({
            extent: Dc(c),
            maxZoom: f,
            minZoom: e
        });
        this.tileUrlFunction = Vx(a.tiles, c);
        if (void 0 !== a.attribution && !this.C) {
            var g = void 0 !== d ? d : b.G();
            this.va(function (b) {
                return hb(g, b.extent) ? [a.attribution] : null;
            });
        }
        this.i = a;
        ww(this, 'ready');
    };
    k.ef = function () {
        ww(this, 'error');
    };
    function hz(a) {
        iy.call(this, {
            projection: Ob('EPSG:3857'),
            state: 'loading'
        });
        this.s = void 0 !== a.preemptive ? a.preemptive : !0;
        this.l = Xx;
        this.f = void 0;
        this.i = a.jsonp || !1;
        if (a.url)
            if (this.i)
                Zx(a.url, this.Dg.bind(this), this.ff.bind(this));
            else {
                var b = new XMLHttpRequest();
                b.addEventListener('load', this.gp.bind(this));
                b.addEventListener('error', this.fp.bind(this));
                b.open('GET', a.url);
                b.send();
            }
        else
            a.tileJSON ? this.Dg(a.tileJSON) : oa(!1, 51);
    }
    w(hz, iy);
    k = hz.prototype;
    k.gp = function (a) {
        a = a.target;
        if (!a.status || 200 <= a.status && 300 > a.status) {
            try {
                var b = JSON.parse(a.responseText);
            } catch (c) {
                this.ff();
                return;
            }
            this.Dg(b);
        } else
            this.ff();
    };
    k.fp = function () {
        this.ff();
    };
    k.Pl = function () {
        return this.f;
    };
    k.al = function (a, b, c, d, e) {
        this.tileGrid ? (b = this.tileGrid.Le(a, b), iz(this.ad(b[0], b[1], b[2], 1, this.c), a, c, d, e)) : !0 === e ? setTimeout(function () {
            c.call(d, null);
        }, 0) : c.call(d, null);
    };
    k.ff = function () {
        ww(this, 'error');
    };
    k.Dg = function (a) {
        var b = Ob('EPSG:4326'), c = this.c;
        if (void 0 !== a.bounds) {
            var d = Pb(b, c);
            d = jb(a.bounds, d);
        }
        var e = a.minzoom || 0, f = a.maxzoom || 22;
        this.tileGrid = c = Bc({
            extent: Dc(c),
            maxZoom: f,
            minZoom: e
        });
        this.f = a.template;
        if (e = a.grids) {
            this.l = Vx(e, c);
            if (void 0 !== a.attribution) {
                var g = void 0 !== d ? d : b.G();
                this.va(function (b) {
                    return hb(g, b.extent) ? [a.attribution] : null;
                });
            }
            ww(this, 'ready');
        } else
            ww(this, 'error');
    };
    k.ad = function (a, b, c, d, e) {
        var f = a + '/' + b + '/' + c;
        if (this.a.a.hasOwnProperty(f))
            return this.a.get(f);
        a = [
            a,
            b,
            c
        ];
        b = ky(this, a, e);
        d = this.l(b, d, e);
        d = new jz(a, void 0 !== d ? 0 : 4, void 0 !== d ? d : '', this.tileGrid.Ma(a), this.s, this.i);
        this.a.set(f, d);
        return d;
    };
    k.kh = function (a, b, c) {
        a = a + '/' + b + '/' + c;
        this.a.a.hasOwnProperty(a) && this.a.get(a);
    };
    function jz(a, b, c, d, e, f) {
        cl.call(this, a, b);
        this.v = c;
        this.a = d;
        this.N = e;
        this.c = this.l = this.f = null;
        this.o = f;
    }
    w(jz, cl);
    k = jz.prototype;
    k.Y = function () {
        return null;
    };
    k.getData = function (a) {
        if (!this.f || !this.l)
            return null;
        var b = this.f[Math.floor((1 - (a[1] - this.a[1]) / (this.a[3] - this.a[1])) * this.f.length)];
        if ('string' !== typeof b)
            return null;
        b = b.charCodeAt(Math.floor((a[0] - this.a[0]) / (this.a[2] - this.a[0]) * b.length));
        93 <= b && b--;
        35 <= b && b--;
        b -= 32;
        a = null;
        b in this.l && (b = this.l[b], this.c && b in this.c ? a = this.c[b] : a = b);
        return a;
    };
    function iz(a, b, c, d, e) {
        0 == a.state && !0 === e ? (Lc(a, 'change', function () {
            c.call(d, this.getData(b));
        }, a), kz(a)) : !0 === e ? setTimeout(function () {
            c.call(d, this.getData(b));
        }.bind(a), 0) : c.call(d, a.getData(b));
    }
    k.lb = function () {
        return this.v;
    };
    k.Ne = function () {
        this.state = 3;
        this.u();
    };
    k.bj = function (a) {
        this.f = a.grid;
        this.l = a.keys;
        this.c = a.data;
        this.state = 4;
        this.u();
    };
    function kz(a) {
        if (0 == a.state)
            if (a.state = 1, a.o)
                Zx(a.v, a.bj.bind(a), a.Ne.bind(a));
            else {
                var b = new XMLHttpRequest();
                b.addEventListener('load', a.ep.bind(a));
                b.addEventListener('error', a.cp.bind(a));
                b.open('GET', a.v);
                b.send();
            }
    }
    k.ep = function (a) {
        a = a.target;
        if (!a.status || 200 <= a.status && 300 > a.status) {
            try {
                var b = JSON.parse(a.responseText);
            } catch (c) {
                this.Ne();
                return;
            }
            this.bj(b);
        } else
            this.Ne();
    };
    k.cp = function () {
        this.Ne();
    };
    k.load = function () {
        this.N && kz(this);
    };
    function lz(a) {
        a = a || {};
        var b = a.params || {};
        ny.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            opaque: !('TRANSPARENT' in b ? b.TRANSPARENT : 1),
            projection: a.projection,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileClass: a.tileClass,
            tileGrid: a.tileGrid,
            tileLoadFunction: a.tileLoadFunction,
            url: a.url,
            urls: a.urls,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !0,
            transition: a.transition
        });
        this.o = void 0 !== a.gutter ? a.gutter : 0;
        this.i = b;
        this.l = !0;
        this.B = a.serverType;
        this.$ = void 0 !== a.hidpi ? a.hidpi : !0;
        this.ca = Da();
        mz(this);
        jy(this, nz(this));
    }
    w(lz, ny);
    k = lz.prototype;
    k.hp = function (a, b, c, d) {
        c = Ob(c);
        var e = this.c, f = this.tileGrid;
        f || (f = this.eb(c));
        b = f.Le(a, b);
        if (!(f.b.length <= b[0])) {
            var g = f.Ta(b[0]), h = f.Ma(b, this.ca);
            f = Ba(f.Za(b[0]), this.j);
            var l = this.o;
            0 !== l && (f = za(f, l, this.j), h = Fa(h, g * l, h));
            e && e !== c && (g = by(e, c, a, g), h = bc(h, c, e), a = ac(a, c, e));
            l = {
                SERVICE: 'WMS',
                VERSION: '1.3.0',
                REQUEST: 'GetFeatureInfo',
                FORMAT: 'image/png',
                TRANSPARENT: !0,
                QUERY_LAYERS: this.i.LAYERS
            };
            kb(l, this.i, d);
            d = Math.floor((h[3] - a[1]) / g);
            l[this.l ? 'I' : 'X'] = Math.floor((a[0] - h[0]) / g);
            l[this.l ? 'J' : 'Y'] = d;
            return oz(this, b, f, h, 1, e || c, l);
        }
    };
    k.$f = function () {
        return this.o;
    };
    k.ip = function () {
        return this.i;
    };
    function oz(a, b, c, d, e, f, g) {
        var h = a.urls;
        if (h) {
            g.WIDTH = c[0];
            g.HEIGHT = c[1];
            g[a.l ? 'CRS' : 'SRS'] = f.wb;
            'STYLES' in a.i || (g.STYLES = '');
            if (1 != e)
                switch (a.B) {
                case 'geoserver':
                    c = 90 * e + 0.5 | 0;
                    g.FORMAT_OPTIONS = 'FORMAT_OPTIONS' in g ? g.FORMAT_OPTIONS + (';dpi:' + c) : 'dpi:' + c;
                    break;
                case 'mapserver':
                    g.MAP_RESOLUTION = 90 * e;
                    break;
                case 'carmentaserver':
                case 'qgis':
                    g.DPI = 90 * e;
                    break;
                default:
                    oa(!1, 52);
                }
            f = f.b;
            a.l && 'ne' == f.substr(0, 2) && (a = d[0], d[0] = d[1], d[1] = a, a = d[2], d[2] = d[3], d[3] = a);
            g.BBOX = d.join(',');
            return Gy(1 == h.length ? h[0] : h[wa((b[1] << b[0]) + b[2], h.length)], g);
        }
    }
    k.Xc = function (a) {
        return this.$ && void 0 !== this.B ? a : 1;
    };
    function nz(a) {
        var b = 0, c = [], d;
        for (d in a.i)
            c[b++] = d + '-' + a.i[d];
        return c.join('/');
    }
    k.dc = function (a, b, c) {
        var d = this.tileGrid;
        d || (d = this.eb(c));
        if (!(d.b.length <= a[0])) {
            1 == b || this.$ && void 0 !== this.B || (b = 1);
            var e = d.Ta(a[0]), f = d.Ma(a, this.ca);
            d = Ba(d.Za(a[0]), this.j);
            var g = this.o;
            0 !== g && (d = za(d, g, this.j), f = Fa(f, e * g, f));
            1 != b && (d = Aa(d, b, this.j));
            e = {
                SERVICE: 'WMS',
                VERSION: '1.3.0',
                REQUEST: 'GetMap',
                FORMAT: 'image/png',
                TRANSPARENT: !0
            };
            kb(e, this.i);
            return oz(this, a, d, f, b, c, e);
        }
    };
    k.jp = function (a) {
        kb(this.i, a);
        mz(this);
        jy(this, nz(this));
    };
    function mz(a) {
        a.l = 0 <= ye(a.i.VERSION || '1.3.0');
    }
    function pz(a, b, c, d, e, f, g, h, l, m, n, p, q, r, u) {
        cl.call(this, a, b, u);
        this.v = {};
        this.o = {};
        this.c = m;
        this.a = [];
        this.D = c;
        this.l = f;
        this.f = [];
        this.N = [];
        if (f) {
            var v = l.Ma(f), z = l.Ta(a[0]);
            h.Vf(v, h.Dc(z), function (a) {
                var b = gb(v, h.Ma(a)), c = h.G();
                c && (b = gb(b, c));
                0.5 <= cb(b) / z && 0.5 <= db(b) / z && (b = a.toString(), c = m[b], c || (c = g(a, n, p), c = m[b] = new q(a, void 0 == c ? 4 : 0, void 0 == c ? '' : c, d, e), this.N.push(y(c, 'change', r))), c.c++, this.a.push(b));
            }.bind(this));
        }
    }
    w(pz, cl);
    k = pz.prototype;
    k.ia = function () {
        for (var a = 0, b = this.a.length; a < b; ++a) {
            var c = this.a[a], d = this.c[c];
            d.c--;
            0 == d.c && (delete this.c[c], Pc(d));
        }
        this.a.length = 0;
        this.c = null;
        this.f.forEach(Gc);
        this.f.length = 0;
        this.g && Pc(this.g);
        this.state = 5;
        this.u();
        this.N.forEach(Gc);
        this.N.length = 0;
        cl.prototype.ia.call(this);
    };
    function nk(a, b) {
        b = x(b).toString();
        b in a.v || (a.v[b] = hg());
        return a.v[b];
    }
    k.Y = function (a) {
        return -1 == mk(this, a).fh ? null : nk(this, a).canvas;
    };
    function mk(a, b) {
        b = x(b).toString();
        b in a.o || (a.o[b] = {
            Be: !1,
            eh: null,
            wf: -1,
            fh: -1
        });
        return a.o[b];
    }
    k.lb = function () {
        return this.a.join('/') + '-' + this.D;
    };
    k.load = function () {
        var a = 0, b = {};
        0 == this.state && oj(this, 1);
        1 == this.state && this.a.forEach(function (c) {
            var d = this.c[c];
            0 == d.state && (d.ug(this.C), d.load());
            1 == d.state && (c = y(d, 'change', function () {
                var c = d.getState();
                if (2 == c || 3 == c) {
                    var f = x(d);
                    3 == c ? b[f] = !0 : (--a, delete b[f]);
                    0 == a - Object.keys(b).length && this.Kh();
                }
            }.bind(this)), this.f.push(c), ++a);
        }.bind(this));
        0 == a - Object.keys(b).length && setTimeout(this.Kh.bind(this), 0);
    };
    k.Kh = function () {
        for (var a = this.a.length, b = 0, c = a - 1; 0 <= c; --c) {
            var d = this.c[this.a[c]].getState();
            2 != d && --a;
            4 == d && ++b;
        }
        a == this.a.length ? (this.f.forEach(Gc), this.f.length = 0, oj(this, 2)) : oj(this, b == this.a.length ? 4 : 3);
    };
    function qz(a, b) {
        a.ug(Eo(b, a.v, a.Cp.bind(a), a.Bp.bind(a)));
    }
    function rz(a) {
        var b = a.projection || 'EPSG:3857', c = a.extent || Dc(b), d = a.tileGrid || Bc({
                extent: c,
                maxZoom: a.maxZoom || 22,
                minZoom: a.minZoom,
                tileSize: a.tileSize || 512
            });
        my.call(this, {
            attributions: a.attributions,
            cacheSize: void 0 !== a.cacheSize ? a.cacheSize : 128,
            extent: c,
            logo: a.logo,
            opaque: !1,
            projection: b,
            state: a.state,
            tileGrid: d,
            tileLoadFunction: a.tileLoadFunction ? a.tileLoadFunction : qz,
            tileUrlFunction: a.tileUrlFunction,
            url: a.url,
            urls: a.urls,
            wrapX: void 0 === a.wrapX ? !0 : a.wrapX,
            transition: a.transition
        });
        this.l = a.format ? a.format : null;
        this.i = {};
        this.s = void 0 == a.overlaps ? !0 : a.overlaps;
        this.tileClass = a.tileClass ? a.tileClass : Kn;
        this.f = {};
    }
    w(rz, my);
    k = rz.prototype;
    k.clear = function () {
        this.a.clear();
        this.i = {};
    };
    k.ad = function (a, b, c, d, e) {
        var f = a + '/' + b + '/' + c;
        if (this.a.a.hasOwnProperty(f))
            return this.a.get(f);
        a = [
            a,
            b,
            c
        ];
        b = ky(this, a, e);
        d = new pz(a, null !== b ? 0 : 4, this.g, this.l, this.tileLoadFunction, b, this.tileUrlFunction, this.tileGrid, this.eb(e), this.i, d, e, this.tileClass, this.dj.bind(this), this.Ea);
        this.a.set(f, d);
        return d;
    };
    k.eb = function (a) {
        var b = a.wb, c = this.f[b];
        c || (c = this.tileGrid, c = this.f[b] = Ac(a, void 0, c ? c.Za(c.minZoom) : void 0));
        return c;
    };
    k.Xc = function (a) {
        return a;
    };
    k.Zd = function (a, b, c) {
        a = Ba(this.eb(c).Za(a));
        return [
            Math.round(a[0] * b),
            Math.round(a[1] * b)
        ];
    };
    function sz(a) {
        this.s = a.matrixIds;
        qc.call(this, {
            extent: a.extent,
            origin: a.origin,
            origins: a.origins,
            resolutions: a.resolutions,
            tileSize: a.tileSize,
            tileSizes: a.tileSizes,
            sizes: a.sizes
        });
    }
    w(sz, qc);
    sz.prototype.v = function () {
        return this.s;
    };
    function tz(a, b, c) {
        var d = [], e = [], f = [], g = [], h = [], l = void 0 !== c ? c : [];
        c = a.SupportedCRS;
        c = Ob(c.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/, '$1:$3')) || Ob(c);
        var m = c.Bc(), n = 'ne' == c.b.substr(0, 2);
        a.TileMatrix.sort(function (a, b) {
            return b.ScaleDenominator - a.ScaleDenominator;
        });
        a.TileMatrix.forEach(function (a) {
            var b;
            0 < l.length ? b = hc(l, function (b) {
                return a.Identifier == b.TileMatrix;
            }) : b = !0;
            if (b) {
                e.push(a.Identifier);
                b = 0.00028 * a.ScaleDenominator / m;
                var c = a.TileWidth, p = a.TileHeight;
                n ? f.push([
                    a.TopLeftCorner[1],
                    a.TopLeftCorner[0]
                ]) : f.push(a.TopLeftCorner);
                d.push(b);
                g.push(c == p ? c : [
                    c,
                    p
                ]);
                h.push([
                    a.MatrixWidth,
                    -a.MatrixHeight
                ]);
            }
        });
        return new sz({
            extent: b,
            origins: f,
            resolutions: d,
            matrixIds: e,
            tileSizes: g,
            sizes: h
        });
    }
    function Y(a) {
        this.La = void 0 !== a.version ? a.version : '1.0.0';
        this.B = void 0 !== a.format ? a.format : 'image/jpeg';
        this.i = void 0 !== a.dimensions ? a.dimensions : {};
        this.$ = a.layer;
        this.o = a.matrixSet;
        this.ca = a.style;
        var b = a.urls;
        void 0 === b && void 0 !== a.url && (b = Yx(a.url));
        var c = this.ua = void 0 !== a.requestEncoding ? a.requestEncoding : 'KVP', d = a.tileGrid, e = {
                layer: this.$,
                style: this.ca,
                tilematrixset: this.o
            };
        'KVP' == c && kb(e, {
            Service: 'WMTS',
            Request: 'GetTile',
            Version: this.La,
            Format: this.B
        });
        var f = this.i;
        this.l = function (a) {
            a = 'KVP' == c ? Gy(a, e) : a.replace(/\{(\w+?)\}/g, function (a, b) {
                return b.toLowerCase() in e ? e[b.toLowerCase()] : a;
            });
            return function (b) {
                if (b) {
                    var e = {
                        TileMatrix: d.s[b[0]],
                        TileCol: b[1],
                        TileRow: -b[2] - 1
                    };
                    kb(e, f);
                    b = a;
                    return b = 'KVP' == c ? Gy(b, e) : b.replace(/\{(\w+?)\}/g, function (a, b) {
                        return e[b];
                    });
                }
            };
        };
        var g = b && 0 < b.length ? Wx(b.map(this.l)) : Xx;
        ny.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            projection: a.projection,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileClass: a.tileClass,
            tileGrid: d,
            tileLoadFunction: a.tileLoadFunction,
            tilePixelRatio: a.tilePixelRatio,
            tileUrlFunction: g,
            urls: b,
            wrapX: void 0 !== a.wrapX ? a.wrapX : !1,
            transition: a.transition
        });
        jy(this, uz(this));
    }
    w(Y, ny);
    k = Y.prototype;
    k.vb = function (a) {
        this.urls = a;
        var b = a.join('\n');
        this.hb(this.dc ? this.dc.bind(this) : Wx(a.map(this.l.bind(this))), b);
    };
    k.ol = function () {
        return this.i;
    };
    k.kp = function () {
        return this.B;
    };
    k.lp = function () {
        return this.$;
    };
    k.Al = function () {
        return this.o;
    };
    k.Nl = function () {
        return this.ua;
    };
    k.mp = function () {
        return this.ca;
    };
    k.Ul = function () {
        return this.La;
    };
    function uz(a) {
        var b = 0, c = [], d;
        for (d in a.i)
            c[b++] = d + '-' + a.i[d];
        return c.join('/');
    }
    k.Tq = function (a) {
        kb(this.i, a);
        jy(this, uz(this));
    };
    function vz(a) {
        a = a || {};
        var b = a.size, c = b[0], d = b[1];
        b = a.extent || [
            0,
            -b[1],
            b[0],
            0
        ];
        var e = [], f = a.tileSize || 256, g = f;
        switch (void 0 !== a.tierSizeCalculation ? a.tierSizeCalculation : wz) {
        case wz:
            for (; c > g || d > g;)
                e.push([
                    Math.ceil(c / g),
                    Math.ceil(d / g)
                ]), g += g;
            break;
        case xz:
            for (; c > g || d > g;)
                e.push([
                    Math.ceil(c / g),
                    Math.ceil(d / g)
                ]), c >>= 1, d >>= 1;
            break;
        default:
            oa(!1, 53);
        }
        e.push([
            1,
            1
        ]);
        e.reverse();
        d = [1];
        var h = [0];
        g = 1;
        for (c = e.length; g < c; g++)
            d.push(1 << g), h.push(e[g - 1][0] * e[g - 1][1] + h[g - 1]);
        d.reverse();
        var l = new qc({
            tileSize: f,
            extent: b,
            origin: $a(b),
            resolutions: d
        });
        (b = a.url) && -1 == b.indexOf('{TileGroup}') && -1 == b.indexOf('{tileIndex}') && (b += '{TileGroup}/{z}-{x}-{y}.jpg');
        b = Yx(b);
        b = Wx(b.map(function (a) {
            return function (b) {
                if (b) {
                    var c = b[0], d = b[1];
                    b = -b[2] - 1;
                    var f = d + b * e[c][0], g = {
                            z: c,
                            x: d,
                            y: b,
                            tileIndex: f,
                            TileGroup: 'TileGroup' + ((f + h[c]) / l.Za(c) | 0)
                        };
                    return a.replace(/\{(\w+?)\}/g, function (a, b) {
                        return g[b];
                    });
                }
            };
        }));
        ny.call(this, {
            attributions: a.attributions,
            cacheSize: a.cacheSize,
            crossOrigin: a.crossOrigin,
            logo: a.logo,
            projection: a.projection,
            reprojectionErrorThreshold: a.reprojectionErrorThreshold,
            tileClass: yz.bind(null, l),
            tileGrid: l,
            tileUrlFunction: b,
            transition: a.transition
        });
    }
    w(vz, ny);
    function yz(a, b, c, d, e, f, g) {
        el.call(this, b, c, d, e, f, g);
        this.a = null;
        this.o = Ba(a.Za(b[0]));
    }
    w(yz, el);
    yz.prototype.Y = function () {
        if (this.a)
            return this.a;
        var a = el.prototype.Y.call(this);
        if (2 == this.state) {
            var b = this.o;
            if (a.width == b[0] && a.height == b[1])
                return this.a = a;
            b = hg(b[0], b[1]);
            b.drawImage(a, 0, 0);
            return this.a = b.canvas;
        }
        return a;
    };
    var wz = 'default', xz = 'truncated';
    ha.prototype.code = ha.prototype.code;
    t('ol.Attribution', Ec);
    Ec.prototype.getHTML = Ec.prototype.b;
    t('ol.CanvasMap', H);
    t('ol.Collection', B);
    B.prototype.clear = B.prototype.clear;
    B.prototype.extend = B.prototype.qg;
    B.prototype.forEach = B.prototype.forEach;
    B.prototype.getArray = B.prototype.Xm;
    B.prototype.item = B.prototype.item;
    B.prototype.getLength = B.prototype.kc;
    B.prototype.insertAt = B.prototype.Re;
    B.prototype.pop = B.prototype.pop;
    B.prototype.push = B.prototype.push;
    B.prototype.remove = B.prototype.remove;
    B.prototype.removeAt = B.prototype.Wg;
    B.prototype.setAt = B.prototype.rq;
    cd.prototype.element = cd.prototype.element;
    t('ol.color.asArray', vi);
    t('ol.color.asString', xi);
    t('ol.colorlike.asColorLike', zi);
    t('ol.control.defaults', Fg);
    t('ol.coordinate.add', ze);
    t('ol.coordinate.createStringXY', function (a) {
        return function (b) {
            return Ke(b, a);
        };
    });
    t('ol.coordinate.format', De);
    t('ol.coordinate.rotate', Fe);
    t('ol.coordinate.toStringHDMS', function (a, b) {
        return a ? Ce('NS', a[1], b) + ' ' + Ce('EW', a[0], b) : '';
    });
    t('ol.coordinate.toStringXY', Ke);
    t('ol.DeviceOrientation', pk);
    pk.prototype.getAlpha = pk.prototype.Ym;
    pk.prototype.getBeta = pk.prototype.ll;
    pk.prototype.getGamma = pk.prototype.ql;
    pk.prototype.getHeading = pk.prototype.Zm;
    pk.prototype.getTracking = pk.prototype.li;
    pk.prototype.setTracking = pk.prototype.rg;
    t('ol.easing.easeIn', Me);
    t('ol.easing.easeOut', Oe);
    t('ol.easing.inAndOut', Pe);
    t('ol.easing.linear', Qe);
    t('ol.easing.upAndDown', function (a) {
        return 0.5 > a ? Pe(2 * a) : 1 - Pe(2 * (a - 0.5));
    });
    t('ol.extent.boundingExtent', Ca);
    t('ol.extent.buffer', Fa);
    t('ol.extent.containsCoordinate', Ja);
    t('ol.extent.containsExtent', La);
    t('ol.extent.containsXY', Ka);
    t('ol.extent.createEmpty', Da);
    t('ol.extent.equals', Sa);
    t('ol.extent.extend', Ta);
    t('ol.extent.getArea', ab);
    t('ol.extent.getBottomLeft', Wa);
    t('ol.extent.getBottomRight', Ya);
    t('ol.extent.getCenter', eb);
    t('ol.extent.getHeight', db);
    t('ol.extent.getIntersection', gb);
    t('ol.extent.getSize', function (a) {
        return [
            a[2] - a[0],
            a[3] - a[1]
        ];
    });
    t('ol.extent.getTopLeft', $a);
    t('ol.extent.getTopRight', Za);
    t('ol.extent.getWidth', cb);
    t('ol.extent.intersects', hb);
    t('ol.extent.isEmpty', bb);
    t('ol.extent.applyTransform', jb);
    t('ol.Feature', Hk);
    Hk.prototype.clone = Hk.prototype.clone;
    Hk.prototype.getGeometry = Hk.prototype.U;
    Hk.prototype.getId = Hk.prototype.an;
    Hk.prototype.getGeometryName = Hk.prototype.sl;
    Hk.prototype.getStyle = Hk.prototype.bn;
    Hk.prototype.getStyleFunction = Hk.prototype.ib;
    Hk.prototype.setGeometry = Hk.prototype.Va;
    Hk.prototype.setStyle = Hk.prototype.sg;
    Hk.prototype.setId = Hk.prototype.qc;
    Hk.prototype.setGeometryName = Hk.prototype.Lc;
    t('ol.featureloader.xhr', Fo);
    t('ol.Geolocation', Jk);
    Jk.prototype.getAccuracy = Jk.prototype.el;
    Jk.prototype.getAccuracyGeometry = Jk.prototype.fl;
    Jk.prototype.getAltitude = Jk.prototype.gl;
    Jk.prototype.getAltitudeAccuracy = Jk.prototype.hl;
    Jk.prototype.getHeading = Jk.prototype.cn;
    Jk.prototype.getPosition = Jk.prototype.dn;
    Jk.prototype.getProjection = Jk.prototype.mi;
    Jk.prototype.getSpeed = Jk.prototype.Ol;
    Jk.prototype.getTracking = Jk.prototype.ni;
    Jk.prototype.getTrackingOptions = Jk.prototype.ai;
    Jk.prototype.setProjection = Jk.prototype.oi;
    Jk.prototype.setTracking = Jk.prototype.Ue;
    Jk.prototype.setTrackingOptions = Jk.prototype.Rj;
    t('ol.Graticule', Xk);
    Xk.prototype.getMap = Xk.prototype.gn;
    Xk.prototype.getMeridians = Xk.prototype.Cl;
    Xk.prototype.getParallels = Xk.prototype.Jl;
    Xk.prototype.setMap = Xk.prototype.setMap;
    t('ol.has.DEVICE_PIXEL_RATIO', nd);
    t('ol.has.CANVAS', pd);
    t('ol.has.DEVICE_ORIENTATION', qd);
    t('ol.has.GEOLOCATION', rd);
    t('ol.has.TOUCH', sd);
    t('ol.has.WEBGL', hd);
    bl.prototype.getImage = bl.prototype.Y;
    bl.prototype.load = bl.prototype.load;
    el.prototype.getImage = el.prototype.Y;
    t('ol.inherits', w);
    t('ol.interaction.defaults', Zh);
    t('ol.Kinetic', Gg);
    t('ol.loadingstrategy.all', tw);
    t('ol.loadingstrategy.bbox', function (a) {
        return [a];
    });
    t('ol.loadingstrategy.tile', function (a) {
        return function (b, c) {
            c = a.Dc(c);
            b = tc(a, b, c);
            var d = [];
            c = [
                c,
                0,
                0
            ];
            for (c[1] = b.fa; c[1] <= b.la; ++c[1])
                for (c[2] = b.ea; c[2] <= b.ka; ++c[2])
                    d.push(a.Ma(c));
            return d;
        };
    });
    t('ol.Map', K);
    ed.prototype.originalEvent = ed.prototype.originalEvent;
    ed.prototype.pixel = ed.prototype.pixel;
    ed.prototype.coordinate = ed.prototype.coordinate;
    ed.prototype.dragging = ed.prototype.dragging;
    dd.prototype.map = dd.prototype.map;
    dd.prototype.frameState = dd.prototype.frameState;
    t('ol.Object', Vc);
    Vc.prototype.get = Vc.prototype.get;
    Vc.prototype.getKeys = Vc.prototype.P;
    Vc.prototype.getProperties = Vc.prototype.L;
    Vc.prototype.set = Vc.prototype.set;
    Vc.prototype.setProperties = Vc.prototype.H;
    Vc.prototype.unset = Vc.prototype.R;
    Zc.prototype.key = Zc.prototype.key;
    Zc.prototype.oldValue = Zc.prototype.oldValue;
    t('ol.Observable', Uc);
    t('ol.Observable.unByKey', function (a) {
        if (Array.isArray(a))
            for (var b = 0, c = a.length; b < c; ++b)
                Gc(a[b]);
        else
            Gc(a);
    });
    Uc.prototype.changed = Uc.prototype.u;
    Uc.prototype.dispatchEvent = Uc.prototype.b;
    Uc.prototype.getRevision = Uc.prototype.K;
    Uc.prototype.on = Uc.prototype.I;
    Uc.prototype.once = Uc.prototype.once;
    Uc.prototype.un = Uc.prototype.J;
    t('ol.Overlay', Bn);
    Bn.prototype.getElement = Bn.prototype.Rd;
    Bn.prototype.getId = Bn.prototype.nn;
    Bn.prototype.getMap = Bn.prototype.Ve;
    Bn.prototype.getOffset = Bn.prototype.Xh;
    Bn.prototype.getPosition = Bn.prototype.pi;
    Bn.prototype.getPositioning = Bn.prototype.Yh;
    Bn.prototype.setElement = Bn.prototype.Hj;
    Bn.prototype.setMap = Bn.prototype.setMap;
    Bn.prototype.setOffset = Bn.prototype.Mj;
    Bn.prototype.setPosition = Bn.prototype.We;
    Bn.prototype.setPositioning = Bn.prototype.Pj;
    t('ol.PluggableMap', G);
    G.prototype.addControl = G.prototype.Mf;
    G.prototype.addInteraction = G.prototype.Nf;
    G.prototype.addLayer = G.prototype.xe;
    G.prototype.addOverlay = G.prototype.ye;
    G.prototype.forEachFeatureAtPixel = G.prototype.Tc;
    G.prototype.getFeaturesAtPixel = G.prototype.Xf;
    G.prototype.forEachLayerAtPixel = G.prototype.tg;
    G.prototype.hasFeatureAtPixel = G.prototype.ng;
    G.prototype.getEventCoordinate = G.prototype.Sd;
    G.prototype.getEventPixel = G.prototype.ud;
    G.prototype.getTarget = G.prototype.Xd;
    G.prototype.getTargetElement = G.prototype.Cc;
    G.prototype.getCoordinateFromPixel = G.prototype.Ra;
    G.prototype.getControls = G.prototype.Wf;
    G.prototype.getOverlays = G.prototype.gg;
    G.prototype.getOverlayById = G.prototype.fg;
    G.prototype.getInteractions = G.prototype.bg;
    G.prototype.getLayerGroup = G.prototype.hc;
    G.prototype.getLayers = G.prototype.Xe;
    G.prototype.getPixelFromCoordinate = G.prototype.Ia;
    G.prototype.getSize = G.prototype.Cb;
    G.prototype.getView = G.prototype.aa;
    G.prototype.getViewport = G.prototype.kg;
    G.prototype.renderSync = G.prototype.dh;
    G.prototype.render = G.prototype.render;
    G.prototype.removeControl = G.prototype.Xg;
    G.prototype.removeInteraction = G.prototype.Zg;
    G.prototype.removeLayer = G.prototype.$g;
    G.prototype.removeOverlay = G.prototype.ah;
    G.prototype.setLayerGroup = G.prototype.zf;
    G.prototype.setSize = G.prototype.be;
    G.prototype.setTarget = G.prototype.Ad;
    G.prototype.setView = G.prototype.jh;
    G.prototype.updateSize = G.prototype.Oc;
    t('ol.proj.METERS_PER_UNIT', ub);
    t('ol.proj.setProj4', function (a) {
        vb = a;
    });
    t('ol.proj.getPointResolution', Nb);
    t('ol.proj.addEquivalentProjections', Qb);
    t('ol.proj.addProjection', Rb);
    t('ol.proj.addCoordinateTransforms', Vb);
    t('ol.proj.fromLonLat', function (a, b) {
        return ac(a, 'EPSG:4326', void 0 !== b ? b : 'EPSG:3857');
    });
    t('ol.proj.toLonLat', function (a, b) {
        a = ac(a, void 0 !== b ? b : 'EPSG:3857', 'EPSG:4326');
        b = a[0];
        if (-180 > b || 180 < b)
            a[0] = wa(b + 180, 360) - 180;
        return a;
    });
    t('ol.proj.get', Ob);
    t('ol.proj.equivalent', Xb);
    t('ol.proj.getTransform', Yb);
    t('ol.proj.transform', ac);
    t('ol.proj.transformExtent', bc);
    t('ol.render.toContext', function (a, b) {
        var c = a.canvas, d = b ? b : {};
        b = d.pixelRatio || nd;
        if (d = d.size)
            c.width = d[0] * b, c.height = d[1] * b, c.style.width = d[0] + 'px', c.style.height = d[1] + 'px';
        c = [
            0,
            0,
            c.width,
            c.height
        ];
        d = cf(We(), b, b);
        return new Bi(a, b, c, d, 0);
    });
    t('ol.size.toSize', Ba);
    t('ol.Sphere', ob);
    ob.prototype.geodesicArea = ob.prototype.a;
    ob.prototype.haversineDistance = ob.prototype.b;
    t('ol.Sphere.getLength', rb);
    t('ol.Sphere.getArea', tb);
    t('ol.style.iconImageCache', ej);
    cl.prototype.getTileCoord = cl.prototype.i;
    cl.prototype.load = cl.prototype.load;
    t('ol.tilegrid.createXYZ', Bc);
    Kn.prototype.getExtent = Kn.prototype.G;
    Kn.prototype.getFormat = Kn.prototype.qn;
    Kn.prototype.getFeatures = Kn.prototype.pn;
    Kn.prototype.getProjection = Kn.prototype.rn;
    Kn.prototype.setExtent = Kn.prototype.ri;
    Kn.prototype.setFeatures = Kn.prototype.Ij;
    Kn.prototype.setProjection = Kn.prototype.vg;
    Kn.prototype.setLoader = Kn.prototype.ug;
    t('ol.View', F);
    F.prototype.animate = F.prototype.animate;
    F.prototype.getAnimating = F.prototype.Ac;
    F.prototype.getInteracting = F.prototype.Vh;
    F.prototype.cancelAnimations = F.prototype.rd;
    F.prototype.constrainCenter = F.prototype.Sc;
    F.prototype.constrainResolution = F.prototype.constrainResolution;
    F.prototype.constrainRotation = F.prototype.constrainRotation;
    F.prototype.getCenter = F.prototype.xa;
    F.prototype.calculateExtent = F.prototype.qd;
    F.prototype.getMaxResolution = F.prototype.sn;
    F.prototype.getMinResolution = F.prototype.vn;
    F.prototype.getMaxZoom = F.prototype.tn;
    F.prototype.setMaxZoom = F.prototype.Cq;
    F.prototype.getMinZoom = F.prototype.wn;
    F.prototype.setMinZoom = F.prototype.Dq;
    F.prototype.getProjection = F.prototype.xn;
    F.prototype.getResolution = F.prototype.Pa;
    F.prototype.getResolutions = F.prototype.yn;
    F.prototype.getResolutionForExtent = F.prototype.Je;
    F.prototype.getRotation = F.prototype.Sa;
    F.prototype.getZoom = F.prototype.lg;
    F.prototype.getZoomForResolution = F.prototype.Me;
    F.prototype.getResolutionForZoom = F.prototype.$h;
    F.prototype.fit = F.prototype.Uf;
    F.prototype.centerOn = F.prototype.Nk;
    F.prototype.rotate = F.prototype.rotate;
    F.prototype.setCenter = F.prototype.ub;
    F.prototype.setResolution = F.prototype.gd;
    F.prototype.setRotation = F.prototype.ce;
    F.prototype.setZoom = F.prototype.Tj;
    t('ol.xml.getAllTextContent', oo);
    t('ol.xml.parse', so);
    Hl.prototype.getGL = Hl.prototype.yp;
    Hl.prototype.useProgram = Hl.prototype.cd;
    t('ol.tilegrid.TileGrid', qc);
    qc.prototype.forEachTileCoord = qc.prototype.Vf;
    qc.prototype.getMaxZoom = qc.prototype.mj;
    qc.prototype.getMinZoom = qc.prototype.nj;
    qc.prototype.getOrigin = qc.prototype.Ic;
    qc.prototype.getResolution = qc.prototype.Ta;
    qc.prototype.getResolutions = qc.prototype.oj;
    qc.prototype.getTileCoordExtent = qc.prototype.Ma;
    qc.prototype.getTileCoordForCoordAndResolution = qc.prototype.Le;
    qc.prototype.getTileCoordForCoordAndZ = qc.prototype.jg;
    qc.prototype.getTileSize = qc.prototype.Za;
    qc.prototype.getZForResolution = qc.prototype.Dc;
    t('ol.tilegrid.WMTS', sz);
    sz.prototype.getMatrixIds = sz.prototype.v;
    t('ol.tilegrid.WMTS.createFromCapabilitiesMatrixSet', tz);
    t('ol.style.AtlasManager', Tm);
    t('ol.style.Circle', yk);
    yk.prototype.setRadius = yk.prototype.fd;
    t('ol.style.Fill', zk);
    zk.prototype.clone = zk.prototype.clone;
    zk.prototype.getColor = zk.prototype.g;
    zk.prototype.setColor = zk.prototype.c;
    t('ol.style.Icon', dr);
    dr.prototype.clone = dr.prototype.clone;
    dr.prototype.getAnchor = dr.prototype.Vc;
    dr.prototype.getColor = dr.prototype.np;
    dr.prototype.getImage = dr.prototype.Y;
    dr.prototype.getOrigin = dr.prototype.bd;
    dr.prototype.getSrc = dr.prototype.op;
    dr.prototype.getSize = dr.prototype.oc;
    dr.prototype.load = dr.prototype.load;
    cj.prototype.setSize = cj.prototype.c;
    t('ol.style.Image', vk);
    vk.prototype.getOpacity = vk.prototype.hf;
    vk.prototype.getRotateWithView = vk.prototype.jf;
    vk.prototype.getRotation = vk.prototype.kf;
    vk.prototype.getScale = vk.prototype.lf;
    vk.prototype.getSnapToPixel = vk.prototype.Ke;
    vk.prototype.setOpacity = vk.prototype.Ed;
    vk.prototype.setRotation = vk.prototype.mf;
    vk.prototype.setScale = vk.prototype.Fd;
    t('ol.style.RegularShape', wk);
    wk.prototype.clone = wk.prototype.clone;
    wk.prototype.getAnchor = wk.prototype.Vc;
    wk.prototype.getAngle = wk.prototype.ij;
    wk.prototype.getFill = wk.prototype.Fa;
    wk.prototype.getImage = wk.prototype.Y;
    wk.prototype.getOrigin = wk.prototype.bd;
    wk.prototype.getPoints = wk.prototype.jj;
    wk.prototype.getRadius = wk.prototype.kj;
    wk.prototype.getRadius2 = wk.prototype.Zh;
    wk.prototype.getSize = wk.prototype.oc;
    wk.prototype.getStroke = wk.prototype.Ga;
    t('ol.style.Stroke', Ak);
    Ak.prototype.clone = Ak.prototype.clone;
    Ak.prototype.getColor = Ak.prototype.pp;
    Ak.prototype.getLineCap = Ak.prototype.vl;
    Ak.prototype.getLineDash = Ak.prototype.qp;
    Ak.prototype.getLineDashOffset = Ak.prototype.wl;
    Ak.prototype.getLineJoin = Ak.prototype.xl;
    Ak.prototype.getMiterLimit = Ak.prototype.Dl;
    Ak.prototype.getWidth = Ak.prototype.rp;
    Ak.prototype.setColor = Ak.prototype.sp;
    Ak.prototype.setLineCap = Ak.prototype.yq;
    Ak.prototype.setLineDash = Ak.prototype.setLineDash;
    Ak.prototype.setLineDashOffset = Ak.prototype.zq;
    Ak.prototype.setLineJoin = Ak.prototype.Aq;
    Ak.prototype.setMiterLimit = Ak.prototype.Eq;
    Ak.prototype.setWidth = Ak.prototype.Kq;
    t('ol.style.Style', Bk);
    Bk.prototype.clone = Bk.prototype.clone;
    Bk.prototype.getRenderer = Bk.prototype.Ie;
    Bk.prototype.setRenderer = Bk.prototype.Iq;
    Bk.prototype.getGeometry = Bk.prototype.U;
    Bk.prototype.getGeometryFunction = Bk.prototype.rl;
    Bk.prototype.getFill = Bk.prototype.Fa;
    Bk.prototype.setFill = Bk.prototype.yf;
    Bk.prototype.getImage = Bk.prototype.Y;
    Bk.prototype.setImage = Bk.prototype.ih;
    Bk.prototype.getStroke = Bk.prototype.Ga;
    Bk.prototype.setStroke = Bk.prototype.Af;
    Bk.prototype.getText = Bk.prototype.Ka;
    Bk.prototype.setText = Bk.prototype.Hd;
    Bk.prototype.getZIndex = Bk.prototype.Ba;
    Bk.prototype.setGeometry = Bk.prototype.Va;
    Bk.prototype.setZIndex = Bk.prototype.$b;
    t('ol.style.Text', J);
    J.prototype.clone = J.prototype.clone;
    J.prototype.getOverflow = J.prototype.Gl;
    J.prototype.getFont = J.prototype.pl;
    J.prototype.getMaxAngle = J.prototype.Bl;
    J.prototype.getPlacement = J.prototype.Kl;
    J.prototype.getOffsetX = J.prototype.El;
    J.prototype.getOffsetY = J.prototype.Fl;
    J.prototype.getFill = J.prototype.Fa;
    J.prototype.getRotateWithView = J.prototype.tp;
    J.prototype.getRotation = J.prototype.up;
    J.prototype.getScale = J.prototype.vp;
    J.prototype.getStroke = J.prototype.Ga;
    J.prototype.getText = J.prototype.Ka;
    J.prototype.getTextAlign = J.prototype.Ql;
    J.prototype.getTextBaseline = J.prototype.Rl;
    J.prototype.getBackgroundFill = J.prototype.jl;
    J.prototype.getBackgroundStroke = J.prototype.kl;
    J.prototype.getPadding = J.prototype.Il;
    J.prototype.setOverflow = J.prototype.Fq;
    J.prototype.setFont = J.prototype.Jj;
    J.prototype.setMaxAngle = J.prototype.Bq;
    J.prototype.setOffsetX = J.prototype.Nj;
    J.prototype.setOffsetY = J.prototype.Oj;
    J.prototype.setPlacement = J.prototype.Hq;
    J.prototype.setFill = J.prototype.yf;
    J.prototype.setRotation = J.prototype.wp;
    J.prototype.setScale = J.prototype.lj;
    J.prototype.setStroke = J.prototype.Af;
    J.prototype.setText = J.prototype.Hd;
    J.prototype.setTextAlign = J.prototype.Qj;
    J.prototype.setTextBaseline = J.prototype.Jq;
    J.prototype.setBackgroundFill = J.prototype.sq;
    J.prototype.setBackgroundStroke = J.prototype.tq;
    J.prototype.setPadding = J.prototype.Gq;
    t('ol.source.BingMaps', ry);
    t('ol.source.BingMaps.TOS_ATTRIBUTION', '<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html">Terms of Use</a>');
    ry.prototype.getApiKey = ry.prototype.ca;
    ry.prototype.getImagerySet = ry.prototype.ua;
    t('ol.source.CartoDB', ty);
    ty.prototype.getConfig = ty.prototype.nl;
    ty.prototype.updateConfig = ty.prototype.Sq;
    ty.prototype.setConfig = ty.prototype.uq;
    t('ol.source.Cluster', X);
    X.prototype.getDistance = X.prototype.Eo;
    X.prototype.getSource = X.prototype.Fo;
    X.prototype.setDistance = X.prototype.vq;
    t('ol.source.Image', zy);
    By.prototype.image = By.prototype.image;
    t('ol.source.ImageArcGISRest', Hy);
    Hy.prototype.getParams = Hy.prototype.Ho;
    Hy.prototype.getImageLoadFunction = Hy.prototype.Go;
    Hy.prototype.getUrl = Hy.prototype.Io;
    Hy.prototype.setImageLoadFunction = Hy.prototype.Jo;
    Hy.prototype.setUrl = Hy.prototype.Ko;
    Hy.prototype.updateParams = Hy.prototype.Lo;
    t('ol.source.ImageCanvas', Iy);
    t('ol.source.ImageMapGuide', Jy);
    Jy.prototype.getParams = Jy.prototype.No;
    Jy.prototype.getImageLoadFunction = Jy.prototype.Mo;
    Jy.prototype.updateParams = Jy.prototype.Po;
    Jy.prototype.setImageLoadFunction = Jy.prototype.Oo;
    t('ol.source.ImageStatic', Ky);
    t('ol.source.ImageVector', Ly);
    Ly.prototype.getSource = Ly.prototype.Qo;
    Ly.prototype.getStyle = Ly.prototype.Ro;
    Ly.prototype.getStyleFunction = Ly.prototype.ib;
    Ly.prototype.setStyle = Ly.prototype.aj;
    t('ol.source.ImageWMS', Ny);
    Ny.prototype.getGetFeatureInfoUrl = Ny.prototype.Uo;
    Ny.prototype.getParams = Ny.prototype.Wo;
    Ny.prototype.getImageLoadFunction = Ny.prototype.Vo;
    Ny.prototype.getUrl = Ny.prototype.Xo;
    Ny.prototype.setImageLoadFunction = Ny.prototype.Yo;
    Ny.prototype.setUrl = Ny.prototype.Zo;
    Ny.prototype.updateParams = Ny.prototype.$o;
    t('ol.source.OSM', Ry);
    t('ol.source.OSM.ATTRIBUTION', '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.');
    t('ol.source.Raster', Sy);
    Sy.prototype.setOperation = Sy.prototype.s;
    Wy.prototype.extent = Wy.prototype.extent;
    Wy.prototype.resolution = Wy.prototype.resolution;
    Wy.prototype.data = Wy.prototype.data;
    t('ol.source.Source', uw);
    uw.prototype.getAttributions = uw.prototype.za;
    uw.prototype.getLogo = uw.prototype.Aa;
    uw.prototype.getProjection = uw.prototype.Da;
    uw.prototype.getState = uw.prototype.getState;
    uw.prototype.refresh = uw.prototype.sa;
    uw.prototype.setAttributions = uw.prototype.va;
    t('ol.source.Stamen', Zy);
    t('ol.source.Tile', iy);
    iy.prototype.getTileGrid = iy.prototype.jb;
    ly.prototype.tile = ly.prototype.tile;
    t('ol.source.TileArcGISRest', cz);
    cz.prototype.getParams = cz.prototype.o;
    cz.prototype.updateParams = cz.prototype.B;
    t('ol.source.TileDebug', ez);
    t('ol.source.TileImage', ny);
    ny.prototype.setRenderReprojectionEdges = ny.prototype.Qb;
    ny.prototype.setTileGridForProjection = ny.prototype.Rb;
    t('ol.source.TileJSON', gz);
    gz.prototype.getTileJSON = gz.prototype.Sl;
    t('ol.source.TileUTFGrid', hz);
    hz.prototype.getTemplate = hz.prototype.Pl;
    hz.prototype.forDataAtCoordinateAndResolution = hz.prototype.al;
    t('ol.source.TileWMS', lz);
    lz.prototype.getGetFeatureInfoUrl = lz.prototype.hp;
    lz.prototype.getParams = lz.prototype.ip;
    lz.prototype.updateParams = lz.prototype.jp;
    my.prototype.getTileLoadFunction = my.prototype.yb;
    my.prototype.getTileUrlFunction = my.prototype.zb;
    my.prototype.getUrls = my.prototype.Ab;
    my.prototype.setTileLoadFunction = my.prototype.Fb;
    my.prototype.setTileUrlFunction = my.prototype.hb;
    my.prototype.setUrl = my.prototype.rb;
    my.prototype.setUrls = my.prototype.vb;
    t('ol.source.Vector', U);
    U.prototype.addFeature = U.prototype.Gb;
    U.prototype.addFeatures = U.prototype.Qc;
    U.prototype.clear = U.prototype.clear;
    U.prototype.forEachFeature = U.prototype.Lh;
    U.prototype.forEachFeatureInExtent = U.prototype.ec;
    U.prototype.forEachFeatureIntersectingExtent = U.prototype.Mh;
    U.prototype.getFeaturesCollection = U.prototype.Th;
    U.prototype.getFeatures = U.prototype.ee;
    U.prototype.getFeaturesAtCoordinate = U.prototype.Sh;
    U.prototype.getFeaturesInExtent = U.prototype.Yf;
    U.prototype.getClosestFeatureToCoordinate = U.prototype.Oh;
    U.prototype.getExtent = U.prototype.G;
    U.prototype.getFeatureById = U.prototype.Rh;
    U.prototype.getFormat = U.prototype.ej;
    U.prototype.getUrl = U.prototype.fj;
    U.prototype.removeLoadedExtent = U.prototype.Cj;
    U.prototype.removeFeature = U.prototype.Lb;
    U.prototype.setLoader = U.prototype.hj;
    Bw.prototype.feature = Bw.prototype.feature;
    t('ol.source.VectorTile', rz);
    rz.prototype.clear = rz.prototype.clear;
    t('ol.source.WMTS', Y);
    Y.prototype.getDimensions = Y.prototype.ol;
    Y.prototype.getFormat = Y.prototype.kp;
    Y.prototype.getLayer = Y.prototype.lp;
    Y.prototype.getMatrixSet = Y.prototype.Al;
    Y.prototype.getRequestEncoding = Y.prototype.Nl;
    Y.prototype.getStyle = Y.prototype.mp;
    Y.prototype.getVersion = Y.prototype.Ul;
    Y.prototype.updateDimensions = Y.prototype.Tq;
    t('ol.source.WMTS.optionsFromCapabilities', function (a, b) {
        var c = hc(a.Contents.Layer, function (a) {
            return a.Identifier == b.layer;
        });
        if (null === c)
            return null;
        var d = a.Contents.TileMatrixSet;
        var e = 1 < c.TileMatrixSetLink.length ? 'projection' in b ? mc(c.TileMatrixSetLink, function (a) {
            var c = hc(d, function (b) {
                    return b.Identifier == a.TileMatrixSet;
                }).SupportedCRS, e = Ob(c.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/, '$1:$3')) || Ob(c), f = Ob(b.projection);
            return e && f ? Xb(e, f) : c == b.projection;
        }) : mc(c.TileMatrixSetLink, function (a) {
            return a.TileMatrixSet == b.matrixSet;
        }) : 0;
        0 > e && (e = 0);
        var f = c.TileMatrixSetLink[e].TileMatrixSet;
        var g = c.TileMatrixSetLink[e].TileMatrixSetLimits;
        var h = c.Format[0];
        'format' in b && (h = b.format);
        e = mc(c.Style, function (a) {
            return 'style' in b ? a.Title == b.style : a.isDefault;
        });
        0 > e && (e = 0);
        e = c.Style[e].Identifier;
        var l = {};
        'Dimension' in c && c.Dimension.forEach(function (a) {
            var b = a.Identifier, c = a.Default;
            void 0 === c && (c = a.Value[0]);
            l[b] = c;
        });
        var m = hc(a.Contents.TileMatrixSet, function (a) {
                return a.Identifier == f;
            }), n, p = m.SupportedCRS;
        p && (n = Ob(p.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/, '$1:$3')) || Ob(p));
        'projection' in b && (p = Ob(b.projection), !p || n && !Xb(p, n) || (n = p));
        p = c.WGS84BoundingBox;
        if (void 0 !== p) {
            var q = Ob('EPSG:4326').G();
            q = p[0] == q[0] && p[2] == q[2];
            var r = bc(p, 'EPSG:4326', n);
            (p = n.G()) && (La(p, r) || (r = void 0));
        }
        g = tz(m, r, g);
        var u = [];
        m = b.requestEncoding;
        m = void 0 !== m ? m : '';
        if ('OperationsMetadata' in a && 'GetTile' in a.OperationsMetadata)
            for (a = a.OperationsMetadata.GetTile.DCP.HTTP.Get, r = 0, p = a.length; r < p; ++r)
                if (a[r].Constraint) {
                    var v = hc(a[r].Constraint, function (a) {
                        return 'GetEncoding' == a.name;
                    }).AllowedValues.Value;
                    '' === m && (m = v[0]);
                    if ('KVP' === m)
                        ec(v, 'KVP') && u.push(a[r].href);
                    else
                        break;
                } else
                    a[r].href && (m = 'KVP', u.push(a[r].href));
        0 === u.length && (m = 'REST', c.ResourceURL.forEach(function (a) {
            'tile' === a.resourceType && (h = a.format, u.push(a.template));
        }));
        return {
            urls: u,
            layer: b.layer,
            matrixSet: f,
            format: h,
            projection: n,
            requestEncoding: m,
            tileGrid: g,
            style: e,
            dimensions: l,
            wrapX: q,
            crossOrigin: b.crossOrigin
        };
    });
    t('ol.source.XYZ', sy);
    t('ol.source.Zoomify', vz);
    t('ol.renderer.webgl.ImageLayer', pn);
    t('ol.renderer.webgl.Map', sn);
    t('ol.renderer.webgl.TileLayer', zn);
    t('ol.renderer.webgl.VectorLayer', An);
    t('ol.renderer.canvas.ImageLayer', bj);
    t('ol.renderer.canvas.Map', kj);
    t('ol.renderer.canvas.TileLayer', mj);
    t('ol.renderer.canvas.VectorLayer', hk);
    t('ol.renderer.canvas.VectorTileLayer', jk);
    bi.prototype.vectorContext = bi.prototype.vectorContext;
    bi.prototype.frameState = bi.prototype.frameState;
    bi.prototype.context = bi.prototype.context;
    bi.prototype.glContext = bi.prototype.glContext;
    it.prototype.get = it.prototype.get;
    it.prototype.getExtent = it.prototype.G;
    it.prototype.getId = it.prototype.Ao;
    it.prototype.getGeometry = it.prototype.U;
    it.prototype.getProperties = it.prototype.Bo;
    it.prototype.getType = it.prototype.S;
    t('ol.render.VectorContext', Ai);
    gn.prototype.setStyle = gn.prototype.Dd;
    gn.prototype.drawGeometry = gn.prototype.Hb;
    gn.prototype.drawFeature = gn.prototype.Ce;
    Bi.prototype.drawCircle = Bi.prototype.cc;
    Bi.prototype.setStyle = Bi.prototype.Dd;
    Bi.prototype.drawGeometry = Bi.prototype.Hb;
    Bi.prototype.drawFeature = Bi.prototype.Ce;
    t('ol.proj.common.add', cc);
    t('ol.proj.Projection', wb);
    wb.prototype.getCode = wb.prototype.ml;
    wb.prototype.getExtent = wb.prototype.G;
    wb.prototype.getUnits = wb.prototype.zo;
    wb.prototype.getMetersPerUnit = wb.prototype.Bc;
    wb.prototype.getWorldExtent = wb.prototype.Vl;
    wb.prototype.getAxisOrientation = wb.prototype.il;
    wb.prototype.isGlobal = wb.prototype.Gm;
    wb.prototype.setGlobal = wb.prototype.xq;
    wb.prototype.setExtent = wb.prototype.Si;
    wb.prototype.setWorldExtent = wb.prototype.Sj;
    wb.prototype.setGetPointResolution = wb.prototype.wq;
    t('ol.proj.Units.METERS_PER_UNIT', ub);
    t('ol.layer.Base', kg);
    kg.prototype.getExtent = kg.prototype.G;
    kg.prototype.getMaxResolution = kg.prototype.lc;
    kg.prototype.getMinResolution = kg.prototype.mc;
    kg.prototype.getOpacity = kg.prototype.nc;
    kg.prototype.getVisible = kg.prototype.Jb;
    kg.prototype.getZIndex = kg.prototype.Ba;
    kg.prototype.setExtent = kg.prototype.Fc;
    kg.prototype.setMaxResolution = kg.prototype.Mc;
    kg.prototype.setMinResolution = kg.prototype.Nc;
    kg.prototype.setOpacity = kg.prototype.Gc;
    kg.prototype.setVisible = kg.prototype.Hc;
    kg.prototype.setZIndex = kg.prototype.$b;
    t('ol.layer.Group', mg);
    mg.prototype.getLayers = mg.prototype.Cd;
    mg.prototype.setLayers = mg.prototype.Qi;
    t('ol.layer.Heatmap', V);
    V.prototype.getBlur = V.prototype.Nh;
    V.prototype.getGradient = V.prototype.Uh;
    V.prototype.getRadius = V.prototype.Ri;
    V.prototype.setBlur = V.prototype.Fj;
    V.prototype.setGradient = V.prototype.Lj;
    V.prototype.setRadius = V.prototype.fd;
    t('ol.layer.Image', Sx);
    Sx.prototype.getSource = Sx.prototype.ha;
    t('ol.layer.Layer', xg);
    xg.prototype.getSource = xg.prototype.ha;
    xg.prototype.setMap = xg.prototype.setMap;
    xg.prototype.setSource = xg.prototype.hd;
    t('ol.layer.Tile', Tx);
    Tx.prototype.getPreload = Tx.prototype.c;
    Tx.prototype.getSource = Tx.prototype.ha;
    Tx.prototype.setPreload = Tx.prototype.j;
    Tx.prototype.getUseInterimTilesOnError = Tx.prototype.i;
    Tx.prototype.setUseInterimTilesOnError = Tx.prototype.C;
    t('ol.layer.Vector', T);
    T.prototype.getSource = T.prototype.ha;
    T.prototype.getStyle = T.prototype.B;
    T.prototype.getStyleFunction = T.prototype.ib;
    T.prototype.setStyle = T.prototype.j;
    t('ol.layer.VectorTile', W);
    W.prototype.getPreload = W.prototype.c;
    W.prototype.getUseInterimTilesOnError = W.prototype.i;
    W.prototype.setPreload = W.prototype.T;
    W.prototype.setUseInterimTilesOnError = W.prototype.O;
    W.prototype.getSource = W.prototype.ha;
    t('ol.interaction.DoubleClickZoom', Ug);
    t('ol.interaction.DoubleClickZoom.handleEvent', Vg);
    t('ol.interaction.DragAndDrop', iw);
    t('ol.interaction.DragAndDrop.handleEvent', Re);
    lw.prototype.features = lw.prototype.features;
    lw.prototype.file = lw.prototype.file;
    lw.prototype.projection = lw.prototype.projection;
    t('ol.interaction.DragBox', th);
    th.prototype.getGeometry = th.prototype.U;
    yh.prototype.coordinate = yh.prototype.coordinate;
    yh.prototype.mapBrowserEvent = yh.prototype.mapBrowserEvent;
    t('ol.interaction.DragPan', ih);
    t('ol.interaction.DragRotate', mh);
    t('ol.interaction.DragRotateAndZoom', pw);
    t('ol.interaction.DragZoom', Ch);
    t('ol.interaction.Draw', Ew);
    t('ol.interaction.Draw.handleEvent', Gw);
    Ew.prototype.removeLastPoint = Ew.prototype.nq;
    Ew.prototype.finishDrawing = Ew.prototype.Pd;
    Ew.prototype.extend = Ew.prototype.Zn;
    t('ol.interaction.Draw.createRegularPolygon', function (a, b) {
        return function (c, d) {
            var e = c[0];
            c = c[1];
            var f = Math.sqrt(He(e, c));
            d = d ? d : Sf(new gw(e), a);
            Tf(d, e, f, b ? b : Math.atan((c[1] - e[1]) / (c[0] - e[0])));
            return d;
        };
    });
    t('ol.interaction.Draw.createBox', function () {
        return function (a, b) {
            a = Ca(a);
            b = b || new D(null);
            b.na([[
                    Wa(a),
                    Ya(a),
                    Za(a),
                    $a(a),
                    Wa(a)
                ]]);
            return b;
        };
    });
    Uw.prototype.feature = Uw.prototype.feature;
    t('ol.interaction.Extent', Vw);
    Vw.prototype.getExtent = Vw.prototype.G;
    Vw.prototype.setExtent = Vw.prototype.f;
    fx.prototype.extent = fx.prototype.extent;
    t('ol.interaction.Interaction', Jg);
    Jg.prototype.getActive = Jg.prototype.c;
    Jg.prototype.getMap = Jg.prototype.i;
    Jg.prototype.setActive = Jg.prototype.Ha;
    t('ol.interaction.KeyboardPan', Dh);
    t('ol.interaction.KeyboardPan.handleEvent', Eh);
    t('ol.interaction.KeyboardZoom', Fh);
    t('ol.interaction.KeyboardZoom.handleEvent', Gh);
    t('ol.interaction.Modify', gx);
    t('ol.interaction.Modify.handleEvent', jx);
    gx.prototype.removePoint = gx.prototype.Dj;
    ox.prototype.features = ox.prototype.features;
    ox.prototype.mapBrowserEvent = ox.prototype.mapBrowserEvent;
    t('ol.interaction.MouseWheelZoom', Hh);
    t('ol.interaction.MouseWheelZoom.handleEvent', Ih);
    Hh.prototype.setMouseAnchor = Hh.prototype.V;
    t('ol.interaction.PinchRotate', Rh);
    t('ol.interaction.PinchZoom', Vh);
    t('ol.interaction.Pointer', fh);
    t('ol.interaction.Pointer.handleEvent', gh);
    t('ol.interaction.Select', wx);
    wx.prototype.getFeatures = wx.prototype.lo;
    wx.prototype.getHitTolerance = wx.prototype.mo;
    wx.prototype.getLayer = wx.prototype.no;
    t('ol.interaction.Select.handleEvent', xx);
    wx.prototype.setHitTolerance = wx.prototype.po;
    wx.prototype.setMap = wx.prototype.setMap;
    zx.prototype.selected = zx.prototype.selected;
    zx.prototype.deselected = zx.prototype.deselected;
    zx.prototype.mapBrowserEvent = zx.prototype.mapBrowserEvent;
    t('ol.interaction.Snap', Bx);
    Bx.prototype.addFeature = Bx.prototype.Gb;
    Bx.prototype.removeFeature = Bx.prototype.Lb;
    t('ol.interaction.Translate', Gx);
    Gx.prototype.getHitTolerance = Gx.prototype.B;
    Gx.prototype.setHitTolerance = Gx.prototype.T;
    Mx.prototype.features = Mx.prototype.features;
    Mx.prototype.coordinate = Mx.prototype.coordinate;
    t('ol.geom.Circle', gw);
    gw.prototype.clone = gw.prototype.clone;
    gw.prototype.getCenter = gw.prototype.xa;
    gw.prototype.getRadius = gw.prototype.Bd;
    gw.prototype.getType = gw.prototype.S;
    gw.prototype.intersectsExtent = gw.prototype.$a;
    gw.prototype.setCenter = gw.prototype.ub;
    gw.prototype.setCenterAndRadius = gw.prototype.hh;
    gw.prototype.setRadius = gw.prototype.fd;
    gw.prototype.transform = gw.prototype.mb;
    t('ol.geom.Geometry', gf);
    gf.prototype.getClosestPoint = gf.prototype.Ib;
    gf.prototype.intersectsCoordinate = gf.prototype.Bb;
    gf.prototype.getExtent = gf.prototype.G;
    gf.prototype.rotate = gf.prototype.rotate;
    gf.prototype.scale = gf.prototype.scale;
    gf.prototype.simplify = gf.prototype.Sb;
    gf.prototype.transform = gf.prototype.mb;
    t('ol.geom.GeometryCollection', Mq);
    Mq.prototype.clone = Mq.prototype.clone;
    Mq.prototype.getGeometries = Mq.prototype.vd;
    Mq.prototype.getType = Mq.prototype.S;
    Mq.prototype.intersectsExtent = Mq.prototype.$a;
    Mq.prototype.setGeometries = Mq.prototype.Kj;
    Mq.prototype.applyTransform = Mq.prototype.Rc;
    Mq.prototype.translate = Mq.prototype.translate;
    t('ol.geom.LinearRing', Df);
    Df.prototype.clone = Df.prototype.clone;
    Df.prototype.getArea = Df.prototype.Vn;
    Df.prototype.getCoordinates = Df.prototype.W;
    Df.prototype.getType = Df.prototype.S;
    Df.prototype.setCoordinates = Df.prototype.na;
    t('ol.geom.LineString', I);
    I.prototype.appendCoordinate = I.prototype.Fk;
    I.prototype.clone = I.prototype.clone;
    I.prototype.forEachSegment = I.prototype.dl;
    I.prototype.getCoordinateAtM = I.prototype.Tn;
    I.prototype.getCoordinates = I.prototype.W;
    I.prototype.getCoordinateAt = I.prototype.Ph;
    I.prototype.getLength = I.prototype.Un;
    I.prototype.getType = I.prototype.S;
    I.prototype.intersectsExtent = I.prototype.$a;
    I.prototype.setCoordinates = I.prototype.na;
    t('ol.geom.MultiLineString', P);
    P.prototype.appendLineString = P.prototype.Gk;
    P.prototype.clone = P.prototype.clone;
    P.prototype.getCoordinateAtM = P.prototype.Wn;
    P.prototype.getCoordinates = P.prototype.W;
    P.prototype.getLineString = P.prototype.yl;
    P.prototype.getLineStrings = P.prototype.wd;
    P.prototype.getType = P.prototype.S;
    P.prototype.intersectsExtent = P.prototype.$a;
    P.prototype.setCoordinates = P.prototype.na;
    t('ol.geom.MultiPoint', No);
    No.prototype.appendPoint = No.prototype.Ik;
    No.prototype.clone = No.prototype.clone;
    No.prototype.getCoordinates = No.prototype.W;
    No.prototype.getPoint = No.prototype.Ll;
    No.prototype.getPoints = No.prototype.de;
    No.prototype.getType = No.prototype.S;
    No.prototype.intersectsExtent = No.prototype.$a;
    No.prototype.setCoordinates = No.prototype.na;
    t('ol.geom.MultiPolygon', Q);
    Q.prototype.appendPolygon = Q.prototype.Jk;
    Q.prototype.clone = Q.prototype.clone;
    Q.prototype.getArea = Q.prototype.Xn;
    Q.prototype.getCoordinates = Q.prototype.W;
    Q.prototype.getInteriorPoints = Q.prototype.ul;
    Q.prototype.getPolygon = Q.prototype.Ml;
    Q.prototype.getPolygons = Q.prototype.Vd;
    Q.prototype.getType = Q.prototype.S;
    Q.prototype.intersectsExtent = Q.prototype.$a;
    Q.prototype.setCoordinates = Q.prototype.na;
    t('ol.geom.Point', C);
    C.prototype.clone = C.prototype.clone;
    C.prototype.getCoordinates = C.prototype.W;
    C.prototype.getType = C.prototype.S;
    C.prototype.intersectsExtent = C.prototype.$a;
    C.prototype.setCoordinates = C.prototype.na;
    t('ol.geom.Polygon', D);
    D.prototype.appendLinearRing = D.prototype.Hk;
    D.prototype.clone = D.prototype.clone;
    D.prototype.getArea = D.prototype.Yn;
    D.prototype.getCoordinates = D.prototype.W;
    D.prototype.getInteriorPoint = D.prototype.tl;
    D.prototype.getLinearRingCount = D.prototype.zl;
    D.prototype.getLinearRing = D.prototype.Wh;
    D.prototype.getLinearRings = D.prototype.Ud;
    D.prototype.getType = D.prototype.S;
    D.prototype.intersectsExtent = D.prototype.$a;
    D.prototype.setCoordinates = D.prototype.na;
    t('ol.geom.Polygon.circular', Qf);
    t('ol.geom.Polygon.fromExtent', Rf);
    t('ol.geom.Polygon.fromCircle', Sf);
    t('ol.geom.SimpleGeometry', hf);
    hf.prototype.getFirstCoordinate = hf.prototype.fc;
    hf.prototype.getLastCoordinate = hf.prototype.gc;
    hf.prototype.getLayout = hf.prototype.ic;
    hf.prototype.applyTransform = hf.prototype.Rc;
    hf.prototype.translate = hf.prototype.translate;
    t('ol.format.EsriJSON', Po);
    Po.prototype.readFeature = Po.prototype.Yb;
    Po.prototype.readFeatures = Po.prototype.Qa;
    Po.prototype.readGeometry = Po.prototype.ed;
    Po.prototype.readProjection = Po.prototype.sb;
    Po.prototype.writeGeometry = Po.prototype.md;
    Po.prototype.writeGeometryObject = Po.prototype.se;
    Po.prototype.writeFeature = Po.prototype.Jd;
    Po.prototype.writeFeatureObject = Po.prototype.ld;
    Po.prototype.writeFeatures = Po.prototype.ac;
    Po.prototype.writeFeaturesObject = Po.prototype.qe;
    t('ol.format.Feature', Go);
    t('ol.format.filter.and', bu);
    t('ol.format.filter.or', function (a) {
        var b = [null].concat(Array.prototype.slice.call(arguments));
        return new (Function.prototype.bind.apply($t, b))();
    });
    t('ol.format.filter.not', function (a) {
        return new Yt(a);
    });
    t('ol.format.filter.bbox', cu);
    t('ol.format.filter.contains', function (a, b, c) {
        return new Lt(a, b, c);
    });
    t('ol.format.filter.intersects', function (a, b, c) {
        return new St(a, b, c);
    });
    t('ol.format.filter.within', function (a, b, c) {
        return new au(a, b, c);
    });
    t('ol.format.filter.equalTo', function (a, b, c) {
        return new Pt(a, b, c);
    });
    t('ol.format.filter.notEqualTo', function (a, b, c) {
        return new Zt(a, b, c);
    });
    t('ol.format.filter.lessThan', function (a, b) {
        return new Wt(a, b);
    });
    t('ol.format.filter.lessThanOrEqualTo', function (a, b) {
        return new Xt(a, b);
    });
    t('ol.format.filter.greaterThan', function (a, b) {
        return new Qt(a, b);
    });
    t('ol.format.filter.greaterThanOrEqualTo', function (a, b) {
        return new Rt(a, b);
    });
    t('ol.format.filter.isNull', function (a) {
        return new Vt(a);
    });
    t('ol.format.filter.between', function (a, b, c) {
        return new Tt(a, b, c);
    });
    t('ol.format.filter.like', function (a, b, c, d, e, f) {
        return new Ut(a, b, c, d, e, f);
    });
    t('ol.format.filter.during', function (a, b, c) {
        return new Nt(a, b, c);
    });
    t('ol.format.GeoJSON', Qq);
    Qq.prototype.readFeature = Qq.prototype.Yb;
    Qq.prototype.readFeatures = Qq.prototype.Qa;
    Qq.prototype.readGeometry = Qq.prototype.ed;
    Qq.prototype.readProjection = Qq.prototype.sb;
    Qq.prototype.writeFeature = Qq.prototype.Jd;
    Qq.prototype.writeFeatureObject = Qq.prototype.ld;
    Qq.prototype.writeFeatures = Qq.prototype.ac;
    Qq.prototype.writeFeaturesObject = Qq.prototype.qe;
    Qq.prototype.writeGeometry = Qq.prototype.md;
    Qq.prototype.writeGeometryObject = Qq.prototype.se;
    t('ol.format.GML', Kp);
    Kp.prototype.writeFeatures = Kp.prototype.ac;
    Kp.prototype.writeFeaturesNode = Kp.prototype.bc;
    t('ol.format.GML2', Tp);
    t('ol.format.GML3', Kp);
    Kp.prototype.writeGeometryNode = Kp.prototype.re;
    Kp.prototype.writeFeatures = Kp.prototype.ac;
    Kp.prototype.writeFeaturesNode = Kp.prototype.bc;
    Zo.prototype.readFeatures = Zo.prototype.Qa;
    t('ol.format.GPX', dq);
    dq.prototype.readFeature = dq.prototype.Yb;
    dq.prototype.readFeatures = dq.prototype.Qa;
    dq.prototype.readProjection = dq.prototype.sb;
    dq.prototype.writeFeatures = dq.prototype.ac;
    dq.prototype.writeFeaturesNode = dq.prototype.bc;
    t('ol.format.IGC', Xq);
    Xq.prototype.readFeature = Xq.prototype.Yb;
    Xq.prototype.readFeatures = Xq.prototype.Qa;
    Xq.prototype.readProjection = Xq.prototype.sb;
    t('ol.format.KML', er);
    er.prototype.readFeature = er.prototype.Yb;
    er.prototype.readFeatures = er.prototype.Qa;
    er.prototype.readName = er.prototype.cq;
    er.prototype.readNetworkLinks = er.prototype.eq;
    er.prototype.readRegion = er.prototype.hq;
    er.prototype.readRegionFromNode = er.prototype.vf;
    er.prototype.readProjection = er.prototype.sb;
    er.prototype.writeFeatures = er.prototype.ac;
    er.prototype.writeFeaturesNode = er.prototype.bc;
    t('ol.format.MVT', jt);
    jt.prototype.getLastExtent = jt.prototype.cg;
    jt.prototype.readFeatures = jt.prototype.Qa;
    jt.prototype.readProjection = jt.prototype.sb;
    jt.prototype.setLayers = jt.prototype.Sn;
    t('ol.format.OSMXML', ot);
    ot.prototype.readFeatures = ot.prototype.Qa;
    ot.prototype.readProjection = ot.prototype.sb;
    t('ol.format.Polyline', vt);
    t('ol.format.Polyline.encodeDeltas', wt);
    t('ol.format.Polyline.decodeDeltas', yt);
    t('ol.format.Polyline.encodeFloats', xt);
    t('ol.format.Polyline.decodeFloats', zt);
    vt.prototype.readFeature = vt.prototype.Yb;
    vt.prototype.readFeatures = vt.prototype.Qa;
    vt.prototype.readGeometry = vt.prototype.ed;
    vt.prototype.readProjection = vt.prototype.sb;
    vt.prototype.writeGeometry = vt.prototype.md;
    t('ol.format.TopoJSON', At);
    At.prototype.readFeatures = At.prototype.Qa;
    At.prototype.readProjection = At.prototype.sb;
    t('ol.format.WFS', du);
    du.prototype.readFeatures = du.prototype.Qa;
    du.prototype.readTransactionResponse = du.prototype.j;
    du.prototype.readFeatureCollectionMetadata = du.prototype.f;
    t('ol.format.WFS.writeFilter', function (a) {
        var b = no('http://www.opengis.net/ogc', 'Filter');
        Do({ node: b }, su, yo(a.rc), [a], []);
        return b;
    });
    du.prototype.writeGetFeature = du.prototype.s;
    du.prototype.writeTransaction = du.prototype.v;
    du.prototype.readProjection = du.prototype.sb;
    t('ol.format.WKT', Ku);
    Ku.prototype.readFeature = Ku.prototype.Yb;
    Ku.prototype.readFeatures = Ku.prototype.Qa;
    Ku.prototype.readGeometry = Ku.prototype.ed;
    Ku.prototype.writeFeature = Ku.prototype.Jd;
    Ku.prototype.writeFeatures = Ku.prototype.ac;
    Ku.prototype.writeGeometry = Ku.prototype.md;
    t('ol.format.WMSCapabilities', ev);
    ev.prototype.read = ev.prototype.read;
    t('ol.format.WMSGetFeatureInfo', Bv);
    Bv.prototype.readFeatures = Bv.prototype.Qa;
    t('ol.format.WMTSCapabilities', Sv);
    Sv.prototype.read = Sv.prototype.read;
    t('ol.format.filter.And', It);
    t('ol.format.filter.Bbox', Jt);
    t('ol.format.filter.Comparison', Mt);
    t('ol.format.filter.ComparisonBinary', Ot);
    t('ol.format.filter.Contains', Lt);
    t('ol.format.filter.During', Nt);
    t('ol.format.filter.EqualTo', Pt);
    t('ol.format.filter.Filter', Gt);
    t('ol.format.filter.GreaterThan', Qt);
    t('ol.format.filter.GreaterThanOrEqualTo', Rt);
    t('ol.format.filter.Intersects', St);
    t('ol.format.filter.IsBetween', Tt);
    t('ol.format.filter.IsLike', Ut);
    t('ol.format.filter.IsNull', Vt);
    t('ol.format.filter.LessThan', Wt);
    t('ol.format.filter.LessThanOrEqualTo', Xt);
    t('ol.format.filter.Not', Yt);
    t('ol.format.filter.NotEqualTo', Zt);
    t('ol.format.filter.Or', $t);
    t('ol.format.filter.Spatial', Kt);
    t('ol.format.filter.Within', au);
    t('ol.events.condition.altKeyOnly', Wg);
    t('ol.events.condition.altShiftKeysOnly', Xg);
    t('ol.events.condition.always', Re);
    t('ol.events.condition.click', function (a) {
        return 'click' == a.type;
    });
    t('ol.events.condition.never', Se);
    t('ol.events.condition.pointerMove', Zg);
    t('ol.events.condition.singleClick', $g);
    t('ol.events.condition.doubleClick', function (a) {
        return 'dblclick' == a.type;
    });
    t('ol.events.condition.noModifierKeys', ah);
    t('ol.events.condition.platformModifierKeyOnly', function (a) {
        a = a.originalEvent;
        return !a.altKey && (md ? a.metaKey : a.ctrlKey) && !a.shiftKey;
    });
    t('ol.events.condition.shiftKeyOnly', bh);
    t('ol.events.condition.targetNotEditable', ch);
    t('ol.events.condition.mouseOnly', dh);
    t('ol.events.condition.primaryAction', eh);
    Qc.prototype.type = Qc.prototype.type;
    Qc.prototype.target = Qc.prototype.target;
    Qc.prototype.preventDefault = Qc.prototype.preventDefault;
    Qc.prototype.stopPropagation = Qc.prototype.stopPropagation;
    t('ol.control.Attribution', zg);
    t('ol.control.Attribution.render', Ag);
    zg.prototype.getCollapsible = zg.prototype.An;
    zg.prototype.setCollapsible = zg.prototype.Dn;
    zg.prototype.setCollapsed = zg.prototype.Cn;
    zg.prototype.getCollapsed = zg.prototype.zn;
    t('ol.control.Control', vg);
    vg.prototype.getMap = vg.prototype.f;
    vg.prototype.setMap = vg.prototype.setMap;
    vg.prototype.setTarget = vg.prototype.i;
    t('ol.control.FullScreen', Mn);
    t('ol.control.MousePosition', Rn);
    t('ol.control.MousePosition.render', Sn);
    Rn.prototype.getCoordinateFormat = Rn.prototype.Qh;
    Rn.prototype.getProjection = Rn.prototype.si;
    Rn.prototype.setCoordinateFormat = Rn.prototype.Gj;
    Rn.prototype.setProjection = Rn.prototype.ti;
    t('ol.control.OverviewMap', Wn);
    t('ol.control.OverviewMap.render', Xn);
    Wn.prototype.getCollapsible = Wn.prototype.Gn;
    Wn.prototype.setCollapsible = Wn.prototype.Jn;
    Wn.prototype.setCollapsed = Wn.prototype.In;
    Wn.prototype.getCollapsed = Wn.prototype.Fn;
    Wn.prototype.getOverviewMap = Wn.prototype.Hl;
    t('ol.control.Rotate', Cg);
    t('ol.control.Rotate.render', Dg);
    t('ol.control.ScaleLine', ao);
    ao.prototype.getUnits = ao.prototype.C;
    t('ol.control.ScaleLine.render', bo);
    ao.prototype.setUnits = ao.prototype.O;
    t('ol.control.Zoom', Eg);
    t('ol.control.ZoomSlider', go);
    t('ol.control.ZoomSlider.render', io);
    t('ol.control.ZoomToExtent', lo);
    Vc.prototype.changed = Vc.prototype.u;
    Vc.prototype.dispatchEvent = Vc.prototype.b;
    Vc.prototype.getRevision = Vc.prototype.K;
    Vc.prototype.on = Vc.prototype.I;
    Vc.prototype.once = Vc.prototype.once;
    Vc.prototype.un = Vc.prototype.J;
    G.prototype.get = G.prototype.get;
    G.prototype.getKeys = G.prototype.P;
    G.prototype.getProperties = G.prototype.L;
    G.prototype.set = G.prototype.set;
    G.prototype.setProperties = G.prototype.H;
    G.prototype.unset = G.prototype.R;
    G.prototype.changed = G.prototype.u;
    G.prototype.dispatchEvent = G.prototype.b;
    G.prototype.getRevision = G.prototype.K;
    G.prototype.on = G.prototype.I;
    G.prototype.once = G.prototype.once;
    G.prototype.un = G.prototype.J;
    H.prototype.addControl = H.prototype.Mf;
    H.prototype.addInteraction = H.prototype.Nf;
    H.prototype.addLayer = H.prototype.xe;
    H.prototype.addOverlay = H.prototype.ye;
    H.prototype.forEachFeatureAtPixel = H.prototype.Tc;
    H.prototype.getFeaturesAtPixel = H.prototype.Xf;
    H.prototype.forEachLayerAtPixel = H.prototype.tg;
    H.prototype.hasFeatureAtPixel = H.prototype.ng;
    H.prototype.getEventCoordinate = H.prototype.Sd;
    H.prototype.getEventPixel = H.prototype.ud;
    H.prototype.getTarget = H.prototype.Xd;
    H.prototype.getTargetElement = H.prototype.Cc;
    H.prototype.getCoordinateFromPixel = H.prototype.Ra;
    H.prototype.getControls = H.prototype.Wf;
    H.prototype.getOverlays = H.prototype.gg;
    H.prototype.getOverlayById = H.prototype.fg;
    H.prototype.getInteractions = H.prototype.bg;
    H.prototype.getLayerGroup = H.prototype.hc;
    H.prototype.getLayers = H.prototype.Xe;
    H.prototype.getPixelFromCoordinate = H.prototype.Ia;
    H.prototype.getSize = H.prototype.Cb;
    H.prototype.getView = H.prototype.aa;
    H.prototype.getViewport = H.prototype.kg;
    H.prototype.renderSync = H.prototype.dh;
    H.prototype.render = H.prototype.render;
    H.prototype.removeControl = H.prototype.Xg;
    H.prototype.removeInteraction = H.prototype.Zg;
    H.prototype.removeLayer = H.prototype.$g;
    H.prototype.removeOverlay = H.prototype.ah;
    H.prototype.setLayerGroup = H.prototype.zf;
    H.prototype.setSize = H.prototype.be;
    H.prototype.setTarget = H.prototype.Ad;
    H.prototype.setView = H.prototype.jh;
    H.prototype.updateSize = H.prototype.Oc;
    H.prototype.get = H.prototype.get;
    H.prototype.getKeys = H.prototype.P;
    H.prototype.getProperties = H.prototype.L;
    H.prototype.set = H.prototype.set;
    H.prototype.setProperties = H.prototype.H;
    H.prototype.unset = H.prototype.R;
    H.prototype.changed = H.prototype.u;
    H.prototype.dispatchEvent = H.prototype.b;
    H.prototype.getRevision = H.prototype.K;
    H.prototype.on = H.prototype.I;
    H.prototype.once = H.prototype.once;
    H.prototype.un = H.prototype.J;
    B.prototype.get = B.prototype.get;
    B.prototype.getKeys = B.prototype.P;
    B.prototype.getProperties = B.prototype.L;
    B.prototype.set = B.prototype.set;
    B.prototype.setProperties = B.prototype.H;
    B.prototype.unset = B.prototype.R;
    B.prototype.changed = B.prototype.u;
    B.prototype.dispatchEvent = B.prototype.b;
    B.prototype.getRevision = B.prototype.K;
    B.prototype.on = B.prototype.I;
    B.prototype.once = B.prototype.once;
    B.prototype.un = B.prototype.J;
    cd.prototype.type = cd.prototype.type;
    cd.prototype.target = cd.prototype.target;
    cd.prototype.preventDefault = cd.prototype.preventDefault;
    cd.prototype.stopPropagation = cd.prototype.stopPropagation;
    pk.prototype.get = pk.prototype.get;
    pk.prototype.getKeys = pk.prototype.P;
    pk.prototype.getProperties = pk.prototype.L;
    pk.prototype.set = pk.prototype.set;
    pk.prototype.setProperties = pk.prototype.H;
    pk.prototype.unset = pk.prototype.R;
    pk.prototype.changed = pk.prototype.u;
    pk.prototype.dispatchEvent = pk.prototype.b;
    pk.prototype.getRevision = pk.prototype.K;
    pk.prototype.on = pk.prototype.I;
    pk.prototype.once = pk.prototype.once;
    pk.prototype.un = pk.prototype.J;
    Hk.prototype.get = Hk.prototype.get;
    Hk.prototype.getKeys = Hk.prototype.P;
    Hk.prototype.getProperties = Hk.prototype.L;
    Hk.prototype.set = Hk.prototype.set;
    Hk.prototype.setProperties = Hk.prototype.H;
    Hk.prototype.unset = Hk.prototype.R;
    Hk.prototype.changed = Hk.prototype.u;
    Hk.prototype.dispatchEvent = Hk.prototype.b;
    Hk.prototype.getRevision = Hk.prototype.K;
    Hk.prototype.on = Hk.prototype.I;
    Hk.prototype.once = Hk.prototype.once;
    Hk.prototype.un = Hk.prototype.J;
    Jk.prototype.get = Jk.prototype.get;
    Jk.prototype.getKeys = Jk.prototype.P;
    Jk.prototype.getProperties = Jk.prototype.L;
    Jk.prototype.set = Jk.prototype.set;
    Jk.prototype.setProperties = Jk.prototype.H;
    Jk.prototype.unset = Jk.prototype.R;
    Jk.prototype.changed = Jk.prototype.u;
    Jk.prototype.dispatchEvent = Jk.prototype.b;
    Jk.prototype.getRevision = Jk.prototype.K;
    Jk.prototype.on = Jk.prototype.I;
    Jk.prototype.once = Jk.prototype.once;
    Jk.prototype.un = Jk.prototype.J;
    el.prototype.getTileCoord = el.prototype.i;
    el.prototype.load = el.prototype.load;
    K.prototype.addControl = K.prototype.Mf;
    K.prototype.addInteraction = K.prototype.Nf;
    K.prototype.addLayer = K.prototype.xe;
    K.prototype.addOverlay = K.prototype.ye;
    K.prototype.forEachFeatureAtPixel = K.prototype.Tc;
    K.prototype.getFeaturesAtPixel = K.prototype.Xf;
    K.prototype.forEachLayerAtPixel = K.prototype.tg;
    K.prototype.hasFeatureAtPixel = K.prototype.ng;
    K.prototype.getEventCoordinate = K.prototype.Sd;
    K.prototype.getEventPixel = K.prototype.ud;
    K.prototype.getTarget = K.prototype.Xd;
    K.prototype.getTargetElement = K.prototype.Cc;
    K.prototype.getCoordinateFromPixel = K.prototype.Ra;
    K.prototype.getControls = K.prototype.Wf;
    K.prototype.getOverlays = K.prototype.gg;
    K.prototype.getOverlayById = K.prototype.fg;
    K.prototype.getInteractions = K.prototype.bg;
    K.prototype.getLayerGroup = K.prototype.hc;
    K.prototype.getLayers = K.prototype.Xe;
    K.prototype.getPixelFromCoordinate = K.prototype.Ia;
    K.prototype.getSize = K.prototype.Cb;
    K.prototype.getView = K.prototype.aa;
    K.prototype.getViewport = K.prototype.kg;
    K.prototype.renderSync = K.prototype.dh;
    K.prototype.render = K.prototype.render;
    K.prototype.removeControl = K.prototype.Xg;
    K.prototype.removeInteraction = K.prototype.Zg;
    K.prototype.removeLayer = K.prototype.$g;
    K.prototype.removeOverlay = K.prototype.ah;
    K.prototype.setLayerGroup = K.prototype.zf;
    K.prototype.setSize = K.prototype.be;
    K.prototype.setTarget = K.prototype.Ad;
    K.prototype.setView = K.prototype.jh;
    K.prototype.updateSize = K.prototype.Oc;
    K.prototype.get = K.prototype.get;
    K.prototype.getKeys = K.prototype.P;
    K.prototype.getProperties = K.prototype.L;
    K.prototype.set = K.prototype.set;
    K.prototype.setProperties = K.prototype.H;
    K.prototype.unset = K.prototype.R;
    K.prototype.changed = K.prototype.u;
    K.prototype.dispatchEvent = K.prototype.b;
    K.prototype.getRevision = K.prototype.K;
    K.prototype.on = K.prototype.I;
    K.prototype.once = K.prototype.once;
    K.prototype.un = K.prototype.J;
    dd.prototype.type = dd.prototype.type;
    dd.prototype.target = dd.prototype.target;
    dd.prototype.preventDefault = dd.prototype.preventDefault;
    dd.prototype.stopPropagation = dd.prototype.stopPropagation;
    ed.prototype.map = ed.prototype.map;
    ed.prototype.frameState = ed.prototype.frameState;
    ed.prototype.type = ed.prototype.type;
    ed.prototype.target = ed.prototype.target;
    ed.prototype.preventDefault = ed.prototype.preventDefault;
    ed.prototype.stopPropagation = ed.prototype.stopPropagation;
    Ad.prototype.originalEvent = Ad.prototype.originalEvent;
    Ad.prototype.pixel = Ad.prototype.pixel;
    Ad.prototype.coordinate = Ad.prototype.coordinate;
    Ad.prototype.dragging = Ad.prototype.dragging;
    Ad.prototype.preventDefault = Ad.prototype.preventDefault;
    Ad.prototype.stopPropagation = Ad.prototype.stopPropagation;
    Ad.prototype.map = Ad.prototype.map;
    Ad.prototype.frameState = Ad.prototype.frameState;
    Ad.prototype.type = Ad.prototype.type;
    Ad.prototype.target = Ad.prototype.target;
    Zc.prototype.type = Zc.prototype.type;
    Zc.prototype.target = Zc.prototype.target;
    Zc.prototype.preventDefault = Zc.prototype.preventDefault;
    Zc.prototype.stopPropagation = Zc.prototype.stopPropagation;
    Bn.prototype.get = Bn.prototype.get;
    Bn.prototype.getKeys = Bn.prototype.P;
    Bn.prototype.getProperties = Bn.prototype.L;
    Bn.prototype.set = Bn.prototype.set;
    Bn.prototype.setProperties = Bn.prototype.H;
    Bn.prototype.unset = Bn.prototype.R;
    Bn.prototype.changed = Bn.prototype.u;
    Bn.prototype.dispatchEvent = Bn.prototype.b;
    Bn.prototype.getRevision = Bn.prototype.K;
    Bn.prototype.on = Bn.prototype.I;
    Bn.prototype.once = Bn.prototype.once;
    Bn.prototype.un = Bn.prototype.J;
    pz.prototype.getTileCoord = pz.prototype.i;
    pz.prototype.load = pz.prototype.load;
    Kn.prototype.getTileCoord = Kn.prototype.i;
    Kn.prototype.load = Kn.prototype.load;
    F.prototype.get = F.prototype.get;
    F.prototype.getKeys = F.prototype.P;
    F.prototype.getProperties = F.prototype.L;
    F.prototype.set = F.prototype.set;
    F.prototype.setProperties = F.prototype.H;
    F.prototype.unset = F.prototype.R;
    F.prototype.changed = F.prototype.u;
    F.prototype.dispatchEvent = F.prototype.b;
    F.prototype.getRevision = F.prototype.K;
    F.prototype.on = F.prototype.I;
    F.prototype.once = F.prototype.once;
    F.prototype.un = F.prototype.J;
    sz.prototype.forEachTileCoord = sz.prototype.Vf;
    sz.prototype.getMaxZoom = sz.prototype.mj;
    sz.prototype.getMinZoom = sz.prototype.nj;
    sz.prototype.getOrigin = sz.prototype.Ic;
    sz.prototype.getResolution = sz.prototype.Ta;
    sz.prototype.getResolutions = sz.prototype.oj;
    sz.prototype.getTileCoordExtent = sz.prototype.Ma;
    sz.prototype.getTileCoordForCoordAndResolution = sz.prototype.Le;
    sz.prototype.getTileCoordForCoordAndZ = sz.prototype.jg;
    sz.prototype.getTileSize = sz.prototype.Za;
    sz.prototype.getZForResolution = sz.prototype.Dc;
    wk.prototype.getOpacity = wk.prototype.hf;
    wk.prototype.getRotateWithView = wk.prototype.jf;
    wk.prototype.getRotation = wk.prototype.kf;
    wk.prototype.getScale = wk.prototype.lf;
    wk.prototype.getSnapToPixel = wk.prototype.Ke;
    wk.prototype.setOpacity = wk.prototype.Ed;
    wk.prototype.setRotation = wk.prototype.mf;
    wk.prototype.setScale = wk.prototype.Fd;
    yk.prototype.clone = yk.prototype.clone;
    yk.prototype.getAngle = yk.prototype.ij;
    yk.prototype.getFill = yk.prototype.Fa;
    yk.prototype.getPoints = yk.prototype.jj;
    yk.prototype.getRadius = yk.prototype.kj;
    yk.prototype.getRadius2 = yk.prototype.Zh;
    yk.prototype.getStroke = yk.prototype.Ga;
    yk.prototype.getOpacity = yk.prototype.hf;
    yk.prototype.getRotateWithView = yk.prototype.jf;
    yk.prototype.getRotation = yk.prototype.kf;
    yk.prototype.getScale = yk.prototype.lf;
    yk.prototype.getSnapToPixel = yk.prototype.Ke;
    yk.prototype.setOpacity = yk.prototype.Ed;
    yk.prototype.setRotation = yk.prototype.mf;
    yk.prototype.setScale = yk.prototype.Fd;
    dr.prototype.getOpacity = dr.prototype.hf;
    dr.prototype.getRotateWithView = dr.prototype.jf;
    dr.prototype.getRotation = dr.prototype.kf;
    dr.prototype.getScale = dr.prototype.lf;
    dr.prototype.getSnapToPixel = dr.prototype.Ke;
    dr.prototype.setOpacity = dr.prototype.Ed;
    dr.prototype.setRotation = dr.prototype.mf;
    dr.prototype.setScale = dr.prototype.Fd;
    uw.prototype.get = uw.prototype.get;
    uw.prototype.getKeys = uw.prototype.P;
    uw.prototype.getProperties = uw.prototype.L;
    uw.prototype.set = uw.prototype.set;
    uw.prototype.setProperties = uw.prototype.H;
    uw.prototype.unset = uw.prototype.R;
    uw.prototype.changed = uw.prototype.u;
    uw.prototype.dispatchEvent = uw.prototype.b;
    uw.prototype.getRevision = uw.prototype.K;
    uw.prototype.on = uw.prototype.I;
    uw.prototype.once = uw.prototype.once;
    uw.prototype.un = uw.prototype.J;
    iy.prototype.getAttributions = iy.prototype.za;
    iy.prototype.getLogo = iy.prototype.Aa;
    iy.prototype.getProjection = iy.prototype.Da;
    iy.prototype.getState = iy.prototype.getState;
    iy.prototype.refresh = iy.prototype.sa;
    iy.prototype.setAttributions = iy.prototype.va;
    iy.prototype.get = iy.prototype.get;
    iy.prototype.getKeys = iy.prototype.P;
    iy.prototype.getProperties = iy.prototype.L;
    iy.prototype.set = iy.prototype.set;
    iy.prototype.setProperties = iy.prototype.H;
    iy.prototype.unset = iy.prototype.R;
    iy.prototype.changed = iy.prototype.u;
    iy.prototype.dispatchEvent = iy.prototype.b;
    iy.prototype.getRevision = iy.prototype.K;
    iy.prototype.on = iy.prototype.I;
    iy.prototype.once = iy.prototype.once;
    iy.prototype.un = iy.prototype.J;
    my.prototype.getTileGrid = my.prototype.jb;
    my.prototype.refresh = my.prototype.sa;
    my.prototype.getAttributions = my.prototype.za;
    my.prototype.getLogo = my.prototype.Aa;
    my.prototype.getProjection = my.prototype.Da;
    my.prototype.getState = my.prototype.getState;
    my.prototype.setAttributions = my.prototype.va;
    my.prototype.get = my.prototype.get;
    my.prototype.getKeys = my.prototype.P;
    my.prototype.getProperties = my.prototype.L;
    my.prototype.set = my.prototype.set;
    my.prototype.setProperties = my.prototype.H;
    my.prototype.unset = my.prototype.R;
    my.prototype.changed = my.prototype.u;
    my.prototype.dispatchEvent = my.prototype.b;
    my.prototype.getRevision = my.prototype.K;
    my.prototype.on = my.prototype.I;
    my.prototype.once = my.prototype.once;
    my.prototype.un = my.prototype.J;
    ny.prototype.getTileLoadFunction = ny.prototype.yb;
    ny.prototype.getTileUrlFunction = ny.prototype.zb;
    ny.prototype.getUrls = ny.prototype.Ab;
    ny.prototype.setTileLoadFunction = ny.prototype.Fb;
    ny.prototype.setTileUrlFunction = ny.prototype.hb;
    ny.prototype.setUrl = ny.prototype.rb;
    ny.prototype.setUrls = ny.prototype.vb;
    ny.prototype.getTileGrid = ny.prototype.jb;
    ny.prototype.refresh = ny.prototype.sa;
    ny.prototype.getAttributions = ny.prototype.za;
    ny.prototype.getLogo = ny.prototype.Aa;
    ny.prototype.getProjection = ny.prototype.Da;
    ny.prototype.getState = ny.prototype.getState;
    ny.prototype.setAttributions = ny.prototype.va;
    ny.prototype.get = ny.prototype.get;
    ny.prototype.getKeys = ny.prototype.P;
    ny.prototype.getProperties = ny.prototype.L;
    ny.prototype.set = ny.prototype.set;
    ny.prototype.setProperties = ny.prototype.H;
    ny.prototype.unset = ny.prototype.R;
    ny.prototype.changed = ny.prototype.u;
    ny.prototype.dispatchEvent = ny.prototype.b;
    ny.prototype.getRevision = ny.prototype.K;
    ny.prototype.on = ny.prototype.I;
    ny.prototype.once = ny.prototype.once;
    ny.prototype.un = ny.prototype.J;
    ry.prototype.setRenderReprojectionEdges = ry.prototype.Qb;
    ry.prototype.setTileGridForProjection = ry.prototype.Rb;
    ry.prototype.getTileLoadFunction = ry.prototype.yb;
    ry.prototype.getTileUrlFunction = ry.prototype.zb;
    ry.prototype.getUrls = ry.prototype.Ab;
    ry.prototype.setTileLoadFunction = ry.prototype.Fb;
    ry.prototype.setTileUrlFunction = ry.prototype.hb;
    ry.prototype.setUrl = ry.prototype.rb;
    ry.prototype.setUrls = ry.prototype.vb;
    ry.prototype.getTileGrid = ry.prototype.jb;
    ry.prototype.refresh = ry.prototype.sa;
    ry.prototype.getAttributions = ry.prototype.za;
    ry.prototype.getLogo = ry.prototype.Aa;
    ry.prototype.getProjection = ry.prototype.Da;
    ry.prototype.getState = ry.prototype.getState;
    ry.prototype.setAttributions = ry.prototype.va;
    ry.prototype.get = ry.prototype.get;
    ry.prototype.getKeys = ry.prototype.P;
    ry.prototype.getProperties = ry.prototype.L;
    ry.prototype.set = ry.prototype.set;
    ry.prototype.setProperties = ry.prototype.H;
    ry.prototype.unset = ry.prototype.R;
    ry.prototype.changed = ry.prototype.u;
    ry.prototype.dispatchEvent = ry.prototype.b;
    ry.prototype.getRevision = ry.prototype.K;
    ry.prototype.on = ry.prototype.I;
    ry.prototype.once = ry.prototype.once;
    ry.prototype.un = ry.prototype.J;
    sy.prototype.setRenderReprojectionEdges = sy.prototype.Qb;
    sy.prototype.setTileGridForProjection = sy.prototype.Rb;
    sy.prototype.getTileLoadFunction = sy.prototype.yb;
    sy.prototype.getTileUrlFunction = sy.prototype.zb;
    sy.prototype.getUrls = sy.prototype.Ab;
    sy.prototype.setTileLoadFunction = sy.prototype.Fb;
    sy.prototype.setTileUrlFunction = sy.prototype.hb;
    sy.prototype.setUrl = sy.prototype.rb;
    sy.prototype.setUrls = sy.prototype.vb;
    sy.prototype.getTileGrid = sy.prototype.jb;
    sy.prototype.refresh = sy.prototype.sa;
    sy.prototype.getAttributions = sy.prototype.za;
    sy.prototype.getLogo = sy.prototype.Aa;
    sy.prototype.getProjection = sy.prototype.Da;
    sy.prototype.getState = sy.prototype.getState;
    sy.prototype.setAttributions = sy.prototype.va;
    sy.prototype.get = sy.prototype.get;
    sy.prototype.getKeys = sy.prototype.P;
    sy.prototype.getProperties = sy.prototype.L;
    sy.prototype.set = sy.prototype.set;
    sy.prototype.setProperties = sy.prototype.H;
    sy.prototype.unset = sy.prototype.R;
    sy.prototype.changed = sy.prototype.u;
    sy.prototype.dispatchEvent = sy.prototype.b;
    sy.prototype.getRevision = sy.prototype.K;
    sy.prototype.on = sy.prototype.I;
    sy.prototype.once = sy.prototype.once;
    sy.prototype.un = sy.prototype.J;
    ty.prototype.setRenderReprojectionEdges = ty.prototype.Qb;
    ty.prototype.setTileGridForProjection = ty.prototype.Rb;
    ty.prototype.getTileLoadFunction = ty.prototype.yb;
    ty.prototype.getTileUrlFunction = ty.prototype.zb;
    ty.prototype.getUrls = ty.prototype.Ab;
    ty.prototype.setTileLoadFunction = ty.prototype.Fb;
    ty.prototype.setTileUrlFunction = ty.prototype.hb;
    ty.prototype.setUrl = ty.prototype.rb;
    ty.prototype.setUrls = ty.prototype.vb;
    ty.prototype.getTileGrid = ty.prototype.jb;
    ty.prototype.refresh = ty.prototype.sa;
    ty.prototype.getAttributions = ty.prototype.za;
    ty.prototype.getLogo = ty.prototype.Aa;
    ty.prototype.getProjection = ty.prototype.Da;
    ty.prototype.getState = ty.prototype.getState;
    ty.prototype.setAttributions = ty.prototype.va;
    ty.prototype.get = ty.prototype.get;
    ty.prototype.getKeys = ty.prototype.P;
    ty.prototype.getProperties = ty.prototype.L;
    ty.prototype.set = ty.prototype.set;
    ty.prototype.setProperties = ty.prototype.H;
    ty.prototype.unset = ty.prototype.R;
    ty.prototype.changed = ty.prototype.u;
    ty.prototype.dispatchEvent = ty.prototype.b;
    ty.prototype.getRevision = ty.prototype.K;
    ty.prototype.on = ty.prototype.I;
    ty.prototype.once = ty.prototype.once;
    ty.prototype.un = ty.prototype.J;
    U.prototype.getAttributions = U.prototype.za;
    U.prototype.getLogo = U.prototype.Aa;
    U.prototype.getProjection = U.prototype.Da;
    U.prototype.getState = U.prototype.getState;
    U.prototype.refresh = U.prototype.sa;
    U.prototype.setAttributions = U.prototype.va;
    U.prototype.get = U.prototype.get;
    U.prototype.getKeys = U.prototype.P;
    U.prototype.getProperties = U.prototype.L;
    U.prototype.set = U.prototype.set;
    U.prototype.setProperties = U.prototype.H;
    U.prototype.unset = U.prototype.R;
    U.prototype.changed = U.prototype.u;
    U.prototype.dispatchEvent = U.prototype.b;
    U.prototype.getRevision = U.prototype.K;
    U.prototype.on = U.prototype.I;
    U.prototype.once = U.prototype.once;
    U.prototype.un = U.prototype.J;
    X.prototype.addFeature = X.prototype.Gb;
    X.prototype.addFeatures = X.prototype.Qc;
    X.prototype.clear = X.prototype.clear;
    X.prototype.forEachFeature = X.prototype.Lh;
    X.prototype.forEachFeatureInExtent = X.prototype.ec;
    X.prototype.forEachFeatureIntersectingExtent = X.prototype.Mh;
    X.prototype.getFeaturesCollection = X.prototype.Th;
    X.prototype.getFeatures = X.prototype.ee;
    X.prototype.getFeaturesAtCoordinate = X.prototype.Sh;
    X.prototype.getFeaturesInExtent = X.prototype.Yf;
    X.prototype.getClosestFeatureToCoordinate = X.prototype.Oh;
    X.prototype.getExtent = X.prototype.G;
    X.prototype.getFeatureById = X.prototype.Rh;
    X.prototype.getFormat = X.prototype.ej;
    X.prototype.getUrl = X.prototype.fj;
    X.prototype.removeLoadedExtent = X.prototype.Cj;
    X.prototype.removeFeature = X.prototype.Lb;
    X.prototype.setLoader = X.prototype.hj;
    X.prototype.getAttributions = X.prototype.za;
    X.prototype.getLogo = X.prototype.Aa;
    X.prototype.getProjection = X.prototype.Da;
    X.prototype.getState = X.prototype.getState;
    X.prototype.refresh = X.prototype.sa;
    X.prototype.setAttributions = X.prototype.va;
    X.prototype.get = X.prototype.get;
    X.prototype.getKeys = X.prototype.P;
    X.prototype.getProperties = X.prototype.L;
    X.prototype.set = X.prototype.set;
    X.prototype.setProperties = X.prototype.H;
    X.prototype.unset = X.prototype.R;
    X.prototype.changed = X.prototype.u;
    X.prototype.dispatchEvent = X.prototype.b;
    X.prototype.getRevision = X.prototype.K;
    X.prototype.on = X.prototype.I;
    X.prototype.once = X.prototype.once;
    X.prototype.un = X.prototype.J;
    zy.prototype.getAttributions = zy.prototype.za;
    zy.prototype.getLogo = zy.prototype.Aa;
    zy.prototype.getProjection = zy.prototype.Da;
    zy.prototype.getState = zy.prototype.getState;
    zy.prototype.refresh = zy.prototype.sa;
    zy.prototype.setAttributions = zy.prototype.va;
    zy.prototype.get = zy.prototype.get;
    zy.prototype.getKeys = zy.prototype.P;
    zy.prototype.getProperties = zy.prototype.L;
    zy.prototype.set = zy.prototype.set;
    zy.prototype.setProperties = zy.prototype.H;
    zy.prototype.unset = zy.prototype.R;
    zy.prototype.changed = zy.prototype.u;
    zy.prototype.dispatchEvent = zy.prototype.b;
    zy.prototype.getRevision = zy.prototype.K;
    zy.prototype.on = zy.prototype.I;
    zy.prototype.once = zy.prototype.once;
    zy.prototype.un = zy.prototype.J;
    By.prototype.type = By.prototype.type;
    By.prototype.target = By.prototype.target;
    By.prototype.preventDefault = By.prototype.preventDefault;
    By.prototype.stopPropagation = By.prototype.stopPropagation;
    Hy.prototype.getAttributions = Hy.prototype.za;
    Hy.prototype.getLogo = Hy.prototype.Aa;
    Hy.prototype.getProjection = Hy.prototype.Da;
    Hy.prototype.getState = Hy.prototype.getState;
    Hy.prototype.refresh = Hy.prototype.sa;
    Hy.prototype.setAttributions = Hy.prototype.va;
    Hy.prototype.get = Hy.prototype.get;
    Hy.prototype.getKeys = Hy.prototype.P;
    Hy.prototype.getProperties = Hy.prototype.L;
    Hy.prototype.set = Hy.prototype.set;
    Hy.prototype.setProperties = Hy.prototype.H;
    Hy.prototype.unset = Hy.prototype.R;
    Hy.prototype.changed = Hy.prototype.u;
    Hy.prototype.dispatchEvent = Hy.prototype.b;
    Hy.prototype.getRevision = Hy.prototype.K;
    Hy.prototype.on = Hy.prototype.I;
    Hy.prototype.once = Hy.prototype.once;
    Hy.prototype.un = Hy.prototype.J;
    Iy.prototype.getAttributions = Iy.prototype.za;
    Iy.prototype.getLogo = Iy.prototype.Aa;
    Iy.prototype.getProjection = Iy.prototype.Da;
    Iy.prototype.getState = Iy.prototype.getState;
    Iy.prototype.refresh = Iy.prototype.sa;
    Iy.prototype.setAttributions = Iy.prototype.va;
    Iy.prototype.get = Iy.prototype.get;
    Iy.prototype.getKeys = Iy.prototype.P;
    Iy.prototype.getProperties = Iy.prototype.L;
    Iy.prototype.set = Iy.prototype.set;
    Iy.prototype.setProperties = Iy.prototype.H;
    Iy.prototype.unset = Iy.prototype.R;
    Iy.prototype.changed = Iy.prototype.u;
    Iy.prototype.dispatchEvent = Iy.prototype.b;
    Iy.prototype.getRevision = Iy.prototype.K;
    Iy.prototype.on = Iy.prototype.I;
    Iy.prototype.once = Iy.prototype.once;
    Iy.prototype.un = Iy.prototype.J;
    Jy.prototype.getAttributions = Jy.prototype.za;
    Jy.prototype.getLogo = Jy.prototype.Aa;
    Jy.prototype.getProjection = Jy.prototype.Da;
    Jy.prototype.getState = Jy.prototype.getState;
    Jy.prototype.refresh = Jy.prototype.sa;
    Jy.prototype.setAttributions = Jy.prototype.va;
    Jy.prototype.get = Jy.prototype.get;
    Jy.prototype.getKeys = Jy.prototype.P;
    Jy.prototype.getProperties = Jy.prototype.L;
    Jy.prototype.set = Jy.prototype.set;
    Jy.prototype.setProperties = Jy.prototype.H;
    Jy.prototype.unset = Jy.prototype.R;
    Jy.prototype.changed = Jy.prototype.u;
    Jy.prototype.dispatchEvent = Jy.prototype.b;
    Jy.prototype.getRevision = Jy.prototype.K;
    Jy.prototype.on = Jy.prototype.I;
    Jy.prototype.once = Jy.prototype.once;
    Jy.prototype.un = Jy.prototype.J;
    Ky.prototype.getAttributions = Ky.prototype.za;
    Ky.prototype.getLogo = Ky.prototype.Aa;
    Ky.prototype.getProjection = Ky.prototype.Da;
    Ky.prototype.getState = Ky.prototype.getState;
    Ky.prototype.refresh = Ky.prototype.sa;
    Ky.prototype.setAttributions = Ky.prototype.va;
    Ky.prototype.get = Ky.prototype.get;
    Ky.prototype.getKeys = Ky.prototype.P;
    Ky.prototype.getProperties = Ky.prototype.L;
    Ky.prototype.set = Ky.prototype.set;
    Ky.prototype.setProperties = Ky.prototype.H;
    Ky.prototype.unset = Ky.prototype.R;
    Ky.prototype.changed = Ky.prototype.u;
    Ky.prototype.dispatchEvent = Ky.prototype.b;
    Ky.prototype.getRevision = Ky.prototype.K;
    Ky.prototype.on = Ky.prototype.I;
    Ky.prototype.once = Ky.prototype.once;
    Ky.prototype.un = Ky.prototype.J;
    Ly.prototype.getAttributions = Ly.prototype.za;
    Ly.prototype.getLogo = Ly.prototype.Aa;
    Ly.prototype.getProjection = Ly.prototype.Da;
    Ly.prototype.getState = Ly.prototype.getState;
    Ly.prototype.refresh = Ly.prototype.sa;
    Ly.prototype.setAttributions = Ly.prototype.va;
    Ly.prototype.get = Ly.prototype.get;
    Ly.prototype.getKeys = Ly.prototype.P;
    Ly.prototype.getProperties = Ly.prototype.L;
    Ly.prototype.set = Ly.prototype.set;
    Ly.prototype.setProperties = Ly.prototype.H;
    Ly.prototype.unset = Ly.prototype.R;
    Ly.prototype.changed = Ly.prototype.u;
    Ly.prototype.dispatchEvent = Ly.prototype.b;
    Ly.prototype.getRevision = Ly.prototype.K;
    Ly.prototype.on = Ly.prototype.I;
    Ly.prototype.once = Ly.prototype.once;
    Ly.prototype.un = Ly.prototype.J;
    Ny.prototype.getAttributions = Ny.prototype.za;
    Ny.prototype.getLogo = Ny.prototype.Aa;
    Ny.prototype.getProjection = Ny.prototype.Da;
    Ny.prototype.getState = Ny.prototype.getState;
    Ny.prototype.refresh = Ny.prototype.sa;
    Ny.prototype.setAttributions = Ny.prototype.va;
    Ny.prototype.get = Ny.prototype.get;
    Ny.prototype.getKeys = Ny.prototype.P;
    Ny.prototype.getProperties = Ny.prototype.L;
    Ny.prototype.set = Ny.prototype.set;
    Ny.prototype.setProperties = Ny.prototype.H;
    Ny.prototype.unset = Ny.prototype.R;
    Ny.prototype.changed = Ny.prototype.u;
    Ny.prototype.dispatchEvent = Ny.prototype.b;
    Ny.prototype.getRevision = Ny.prototype.K;
    Ny.prototype.on = Ny.prototype.I;
    Ny.prototype.once = Ny.prototype.once;
    Ny.prototype.un = Ny.prototype.J;
    Ry.prototype.setRenderReprojectionEdges = Ry.prototype.Qb;
    Ry.prototype.setTileGridForProjection = Ry.prototype.Rb;
    Ry.prototype.getTileLoadFunction = Ry.prototype.yb;
    Ry.prototype.getTileUrlFunction = Ry.prototype.zb;
    Ry.prototype.getUrls = Ry.prototype.Ab;
    Ry.prototype.setTileLoadFunction = Ry.prototype.Fb;
    Ry.prototype.setTileUrlFunction = Ry.prototype.hb;
    Ry.prototype.setUrl = Ry.prototype.rb;
    Ry.prototype.setUrls = Ry.prototype.vb;
    Ry.prototype.getTileGrid = Ry.prototype.jb;
    Ry.prototype.refresh = Ry.prototype.sa;
    Ry.prototype.getAttributions = Ry.prototype.za;
    Ry.prototype.getLogo = Ry.prototype.Aa;
    Ry.prototype.getProjection = Ry.prototype.Da;
    Ry.prototype.getState = Ry.prototype.getState;
    Ry.prototype.setAttributions = Ry.prototype.va;
    Ry.prototype.get = Ry.prototype.get;
    Ry.prototype.getKeys = Ry.prototype.P;
    Ry.prototype.getProperties = Ry.prototype.L;
    Ry.prototype.set = Ry.prototype.set;
    Ry.prototype.setProperties = Ry.prototype.H;
    Ry.prototype.unset = Ry.prototype.R;
    Ry.prototype.changed = Ry.prototype.u;
    Ry.prototype.dispatchEvent = Ry.prototype.b;
    Ry.prototype.getRevision = Ry.prototype.K;
    Ry.prototype.on = Ry.prototype.I;
    Ry.prototype.once = Ry.prototype.once;
    Ry.prototype.un = Ry.prototype.J;
    Sy.prototype.getAttributions = Sy.prototype.za;
    Sy.prototype.getLogo = Sy.prototype.Aa;
    Sy.prototype.getProjection = Sy.prototype.Da;
    Sy.prototype.getState = Sy.prototype.getState;
    Sy.prototype.refresh = Sy.prototype.sa;
    Sy.prototype.setAttributions = Sy.prototype.va;
    Sy.prototype.get = Sy.prototype.get;
    Sy.prototype.getKeys = Sy.prototype.P;
    Sy.prototype.getProperties = Sy.prototype.L;
    Sy.prototype.set = Sy.prototype.set;
    Sy.prototype.setProperties = Sy.prototype.H;
    Sy.prototype.unset = Sy.prototype.R;
    Sy.prototype.changed = Sy.prototype.u;
    Sy.prototype.dispatchEvent = Sy.prototype.b;
    Sy.prototype.getRevision = Sy.prototype.K;
    Sy.prototype.on = Sy.prototype.I;
    Sy.prototype.once = Sy.prototype.once;
    Sy.prototype.un = Sy.prototype.J;
    Wy.prototype.type = Wy.prototype.type;
    Wy.prototype.target = Wy.prototype.target;
    Wy.prototype.preventDefault = Wy.prototype.preventDefault;
    Wy.prototype.stopPropagation = Wy.prototype.stopPropagation;
    Zy.prototype.setRenderReprojectionEdges = Zy.prototype.Qb;
    Zy.prototype.setTileGridForProjection = Zy.prototype.Rb;
    Zy.prototype.getTileLoadFunction = Zy.prototype.yb;
    Zy.prototype.getTileUrlFunction = Zy.prototype.zb;
    Zy.prototype.getUrls = Zy.prototype.Ab;
    Zy.prototype.setTileLoadFunction = Zy.prototype.Fb;
    Zy.prototype.setTileUrlFunction = Zy.prototype.hb;
    Zy.prototype.setUrl = Zy.prototype.rb;
    Zy.prototype.setUrls = Zy.prototype.vb;
    Zy.prototype.getTileGrid = Zy.prototype.jb;
    Zy.prototype.refresh = Zy.prototype.sa;
    Zy.prototype.getAttributions = Zy.prototype.za;
    Zy.prototype.getLogo = Zy.prototype.Aa;
    Zy.prototype.getProjection = Zy.prototype.Da;
    Zy.prototype.getState = Zy.prototype.getState;
    Zy.prototype.setAttributions = Zy.prototype.va;
    Zy.prototype.get = Zy.prototype.get;
    Zy.prototype.getKeys = Zy.prototype.P;
    Zy.prototype.getProperties = Zy.prototype.L;
    Zy.prototype.set = Zy.prototype.set;
    Zy.prototype.setProperties = Zy.prototype.H;
    Zy.prototype.unset = Zy.prototype.R;
    Zy.prototype.changed = Zy.prototype.u;
    Zy.prototype.dispatchEvent = Zy.prototype.b;
    Zy.prototype.getRevision = Zy.prototype.K;
    Zy.prototype.on = Zy.prototype.I;
    Zy.prototype.once = Zy.prototype.once;
    Zy.prototype.un = Zy.prototype.J;
    ly.prototype.type = ly.prototype.type;
    ly.prototype.target = ly.prototype.target;
    ly.prototype.preventDefault = ly.prototype.preventDefault;
    ly.prototype.stopPropagation = ly.prototype.stopPropagation;
    cz.prototype.setRenderReprojectionEdges = cz.prototype.Qb;
    cz.prototype.setTileGridForProjection = cz.prototype.Rb;
    cz.prototype.getTileLoadFunction = cz.prototype.yb;
    cz.prototype.getTileUrlFunction = cz.prototype.zb;
    cz.prototype.getUrls = cz.prototype.Ab;
    cz.prototype.setTileLoadFunction = cz.prototype.Fb;
    cz.prototype.setTileUrlFunction = cz.prototype.hb;
    cz.prototype.setUrl = cz.prototype.rb;
    cz.prototype.setUrls = cz.prototype.vb;
    cz.prototype.getTileGrid = cz.prototype.jb;
    cz.prototype.refresh = cz.prototype.sa;
    cz.prototype.getAttributions = cz.prototype.za;
    cz.prototype.getLogo = cz.prototype.Aa;
    cz.prototype.getProjection = cz.prototype.Da;
    cz.prototype.getState = cz.prototype.getState;
    cz.prototype.setAttributions = cz.prototype.va;
    cz.prototype.get = cz.prototype.get;
    cz.prototype.getKeys = cz.prototype.P;
    cz.prototype.getProperties = cz.prototype.L;
    cz.prototype.set = cz.prototype.set;
    cz.prototype.setProperties = cz.prototype.H;
    cz.prototype.unset = cz.prototype.R;
    cz.prototype.changed = cz.prototype.u;
    cz.prototype.dispatchEvent = cz.prototype.b;
    cz.prototype.getRevision = cz.prototype.K;
    cz.prototype.on = cz.prototype.I;
    cz.prototype.once = cz.prototype.once;
    cz.prototype.un = cz.prototype.J;
    ez.prototype.getTileGrid = ez.prototype.jb;
    ez.prototype.refresh = ez.prototype.sa;
    ez.prototype.getAttributions = ez.prototype.za;
    ez.prototype.getLogo = ez.prototype.Aa;
    ez.prototype.getProjection = ez.prototype.Da;
    ez.prototype.getState = ez.prototype.getState;
    ez.prototype.setAttributions = ez.prototype.va;
    ez.prototype.get = ez.prototype.get;
    ez.prototype.getKeys = ez.prototype.P;
    ez.prototype.getProperties = ez.prototype.L;
    ez.prototype.set = ez.prototype.set;
    ez.prototype.setProperties = ez.prototype.H;
    ez.prototype.unset = ez.prototype.R;
    ez.prototype.changed = ez.prototype.u;
    ez.prototype.dispatchEvent = ez.prototype.b;
    ez.prototype.getRevision = ez.prototype.K;
    ez.prototype.on = ez.prototype.I;
    ez.prototype.once = ez.prototype.once;
    ez.prototype.un = ez.prototype.J;
    gz.prototype.setRenderReprojectionEdges = gz.prototype.Qb;
    gz.prototype.setTileGridForProjection = gz.prototype.Rb;
    gz.prototype.getTileLoadFunction = gz.prototype.yb;
    gz.prototype.getTileUrlFunction = gz.prototype.zb;
    gz.prototype.getUrls = gz.prototype.Ab;
    gz.prototype.setTileLoadFunction = gz.prototype.Fb;
    gz.prototype.setTileUrlFunction = gz.prototype.hb;
    gz.prototype.setUrl = gz.prototype.rb;
    gz.prototype.setUrls = gz.prototype.vb;
    gz.prototype.getTileGrid = gz.prototype.jb;
    gz.prototype.refresh = gz.prototype.sa;
    gz.prototype.getAttributions = gz.prototype.za;
    gz.prototype.getLogo = gz.prototype.Aa;
    gz.prototype.getProjection = gz.prototype.Da;
    gz.prototype.getState = gz.prototype.getState;
    gz.prototype.setAttributions = gz.prototype.va;
    gz.prototype.get = gz.prototype.get;
    gz.prototype.getKeys = gz.prototype.P;
    gz.prototype.getProperties = gz.prototype.L;
    gz.prototype.set = gz.prototype.set;
    gz.prototype.setProperties = gz.prototype.H;
    gz.prototype.unset = gz.prototype.R;
    gz.prototype.changed = gz.prototype.u;
    gz.prototype.dispatchEvent = gz.prototype.b;
    gz.prototype.getRevision = gz.prototype.K;
    gz.prototype.on = gz.prototype.I;
    gz.prototype.once = gz.prototype.once;
    gz.prototype.un = gz.prototype.J;
    hz.prototype.getTileGrid = hz.prototype.jb;
    hz.prototype.refresh = hz.prototype.sa;
    hz.prototype.getAttributions = hz.prototype.za;
    hz.prototype.getLogo = hz.prototype.Aa;
    hz.prototype.getProjection = hz.prototype.Da;
    hz.prototype.getState = hz.prototype.getState;
    hz.prototype.setAttributions = hz.prototype.va;
    hz.prototype.get = hz.prototype.get;
    hz.prototype.getKeys = hz.prototype.P;
    hz.prototype.getProperties = hz.prototype.L;
    hz.prototype.set = hz.prototype.set;
    hz.prototype.setProperties = hz.prototype.H;
    hz.prototype.unset = hz.prototype.R;
    hz.prototype.changed = hz.prototype.u;
    hz.prototype.dispatchEvent = hz.prototype.b;
    hz.prototype.getRevision = hz.prototype.K;
    hz.prototype.on = hz.prototype.I;
    hz.prototype.once = hz.prototype.once;
    hz.prototype.un = hz.prototype.J;
    lz.prototype.setRenderReprojectionEdges = lz.prototype.Qb;
    lz.prototype.setTileGridForProjection = lz.prototype.Rb;
    lz.prototype.getTileLoadFunction = lz.prototype.yb;
    lz.prototype.getTileUrlFunction = lz.prototype.zb;
    lz.prototype.getUrls = lz.prototype.Ab;
    lz.prototype.setTileLoadFunction = lz.prototype.Fb;
    lz.prototype.setTileUrlFunction = lz.prototype.hb;
    lz.prototype.setUrl = lz.prototype.rb;
    lz.prototype.setUrls = lz.prototype.vb;
    lz.prototype.getTileGrid = lz.prototype.jb;
    lz.prototype.refresh = lz.prototype.sa;
    lz.prototype.getAttributions = lz.prototype.za;
    lz.prototype.getLogo = lz.prototype.Aa;
    lz.prototype.getProjection = lz.prototype.Da;
    lz.prototype.getState = lz.prototype.getState;
    lz.prototype.setAttributions = lz.prototype.va;
    lz.prototype.get = lz.prototype.get;
    lz.prototype.getKeys = lz.prototype.P;
    lz.prototype.getProperties = lz.prototype.L;
    lz.prototype.set = lz.prototype.set;
    lz.prototype.setProperties = lz.prototype.H;
    lz.prototype.unset = lz.prototype.R;
    lz.prototype.changed = lz.prototype.u;
    lz.prototype.dispatchEvent = lz.prototype.b;
    lz.prototype.getRevision = lz.prototype.K;
    lz.prototype.on = lz.prototype.I;
    lz.prototype.once = lz.prototype.once;
    lz.prototype.un = lz.prototype.J;
    Bw.prototype.type = Bw.prototype.type;
    Bw.prototype.target = Bw.prototype.target;
    Bw.prototype.preventDefault = Bw.prototype.preventDefault;
    Bw.prototype.stopPropagation = Bw.prototype.stopPropagation;
    rz.prototype.getTileLoadFunction = rz.prototype.yb;
    rz.prototype.getTileUrlFunction = rz.prototype.zb;
    rz.prototype.getUrls = rz.prototype.Ab;
    rz.prototype.setTileLoadFunction = rz.prototype.Fb;
    rz.prototype.setTileUrlFunction = rz.prototype.hb;
    rz.prototype.setUrl = rz.prototype.rb;
    rz.prototype.setUrls = rz.prototype.vb;
    rz.prototype.getTileGrid = rz.prototype.jb;
    rz.prototype.refresh = rz.prototype.sa;
    rz.prototype.getAttributions = rz.prototype.za;
    rz.prototype.getLogo = rz.prototype.Aa;
    rz.prototype.getProjection = rz.prototype.Da;
    rz.prototype.getState = rz.prototype.getState;
    rz.prototype.setAttributions = rz.prototype.va;
    rz.prototype.get = rz.prototype.get;
    rz.prototype.getKeys = rz.prototype.P;
    rz.prototype.getProperties = rz.prototype.L;
    rz.prototype.set = rz.prototype.set;
    rz.prototype.setProperties = rz.prototype.H;
    rz.prototype.unset = rz.prototype.R;
    rz.prototype.changed = rz.prototype.u;
    rz.prototype.dispatchEvent = rz.prototype.b;
    rz.prototype.getRevision = rz.prototype.K;
    rz.prototype.on = rz.prototype.I;
    rz.prototype.once = rz.prototype.once;
    rz.prototype.un = rz.prototype.J;
    Y.prototype.setRenderReprojectionEdges = Y.prototype.Qb;
    Y.prototype.setTileGridForProjection = Y.prototype.Rb;
    Y.prototype.getTileLoadFunction = Y.prototype.yb;
    Y.prototype.getTileUrlFunction = Y.prototype.zb;
    Y.prototype.getUrls = Y.prototype.Ab;
    Y.prototype.setTileLoadFunction = Y.prototype.Fb;
    Y.prototype.setTileUrlFunction = Y.prototype.hb;
    Y.prototype.setUrl = Y.prototype.rb;
    Y.prototype.setUrls = Y.prototype.vb;
    Y.prototype.getTileGrid = Y.prototype.jb;
    Y.prototype.refresh = Y.prototype.sa;
    Y.prototype.getAttributions = Y.prototype.za;
    Y.prototype.getLogo = Y.prototype.Aa;
    Y.prototype.getProjection = Y.prototype.Da;
    Y.prototype.getState = Y.prototype.getState;
    Y.prototype.setAttributions = Y.prototype.va;
    Y.prototype.get = Y.prototype.get;
    Y.prototype.getKeys = Y.prototype.P;
    Y.prototype.getProperties = Y.prototype.L;
    Y.prototype.set = Y.prototype.set;
    Y.prototype.setProperties = Y.prototype.H;
    Y.prototype.unset = Y.prototype.R;
    Y.prototype.changed = Y.prototype.u;
    Y.prototype.dispatchEvent = Y.prototype.b;
    Y.prototype.getRevision = Y.prototype.K;
    Y.prototype.on = Y.prototype.I;
    Y.prototype.once = Y.prototype.once;
    Y.prototype.un = Y.prototype.J;
    vz.prototype.setRenderReprojectionEdges = vz.prototype.Qb;
    vz.prototype.setTileGridForProjection = vz.prototype.Rb;
    vz.prototype.getTileLoadFunction = vz.prototype.yb;
    vz.prototype.getTileUrlFunction = vz.prototype.zb;
    vz.prototype.getUrls = vz.prototype.Ab;
    vz.prototype.setTileLoadFunction = vz.prototype.Fb;
    vz.prototype.setTileUrlFunction = vz.prototype.hb;
    vz.prototype.setUrl = vz.prototype.rb;
    vz.prototype.setUrls = vz.prototype.vb;
    vz.prototype.getTileGrid = vz.prototype.jb;
    vz.prototype.refresh = vz.prototype.sa;
    vz.prototype.getAttributions = vz.prototype.za;
    vz.prototype.getLogo = vz.prototype.Aa;
    vz.prototype.getProjection = vz.prototype.Da;
    vz.prototype.getState = vz.prototype.getState;
    vz.prototype.setAttributions = vz.prototype.va;
    vz.prototype.get = vz.prototype.get;
    vz.prototype.getKeys = vz.prototype.P;
    vz.prototype.getProperties = vz.prototype.L;
    vz.prototype.set = vz.prototype.set;
    vz.prototype.setProperties = vz.prototype.H;
    vz.prototype.unset = vz.prototype.R;
    vz.prototype.changed = vz.prototype.u;
    vz.prototype.dispatchEvent = vz.prototype.b;
    vz.prototype.getRevision = vz.prototype.K;
    vz.prototype.on = vz.prototype.I;
    vz.prototype.once = vz.prototype.once;
    vz.prototype.un = vz.prototype.J;
    hy.prototype.getTileCoord = hy.prototype.i;
    hy.prototype.load = hy.prototype.load;
    Ki.prototype.changed = Ki.prototype.u;
    Ki.prototype.dispatchEvent = Ki.prototype.b;
    Ki.prototype.getRevision = Ki.prototype.K;
    Ki.prototype.on = Ki.prototype.I;
    Ki.prototype.once = Ki.prototype.once;
    Ki.prototype.un = Ki.prototype.J;
    mn.prototype.changed = mn.prototype.u;
    mn.prototype.dispatchEvent = mn.prototype.b;
    mn.prototype.getRevision = mn.prototype.K;
    mn.prototype.on = mn.prototype.I;
    mn.prototype.once = mn.prototype.once;
    mn.prototype.un = mn.prototype.J;
    pn.prototype.changed = pn.prototype.u;
    pn.prototype.dispatchEvent = pn.prototype.b;
    pn.prototype.getRevision = pn.prototype.K;
    pn.prototype.on = pn.prototype.I;
    pn.prototype.once = pn.prototype.once;
    pn.prototype.un = pn.prototype.J;
    zn.prototype.changed = zn.prototype.u;
    zn.prototype.dispatchEvent = zn.prototype.b;
    zn.prototype.getRevision = zn.prototype.K;
    zn.prototype.on = zn.prototype.I;
    zn.prototype.once = zn.prototype.once;
    zn.prototype.un = zn.prototype.J;
    An.prototype.changed = An.prototype.u;
    An.prototype.dispatchEvent = An.prototype.b;
    An.prototype.getRevision = An.prototype.K;
    An.prototype.on = An.prototype.I;
    An.prototype.once = An.prototype.once;
    An.prototype.un = An.prototype.J;
    Xi.prototype.changed = Xi.prototype.u;
    Xi.prototype.dispatchEvent = Xi.prototype.b;
    Xi.prototype.getRevision = Xi.prototype.K;
    Xi.prototype.on = Xi.prototype.I;
    Xi.prototype.once = Xi.prototype.once;
    Xi.prototype.un = Xi.prototype.J;
    aj.prototype.changed = aj.prototype.u;
    aj.prototype.dispatchEvent = aj.prototype.b;
    aj.prototype.getRevision = aj.prototype.K;
    aj.prototype.on = aj.prototype.I;
    aj.prototype.once = aj.prototype.once;
    aj.prototype.un = aj.prototype.J;
    bj.prototype.changed = bj.prototype.u;
    bj.prototype.dispatchEvent = bj.prototype.b;
    bj.prototype.getRevision = bj.prototype.K;
    bj.prototype.on = bj.prototype.I;
    bj.prototype.once = bj.prototype.once;
    bj.prototype.un = bj.prototype.J;
    mj.prototype.changed = mj.prototype.u;
    mj.prototype.dispatchEvent = mj.prototype.b;
    mj.prototype.getRevision = mj.prototype.K;
    mj.prototype.on = mj.prototype.I;
    mj.prototype.once = mj.prototype.once;
    mj.prototype.un = mj.prototype.J;
    hk.prototype.changed = hk.prototype.u;
    hk.prototype.dispatchEvent = hk.prototype.b;
    hk.prototype.getRevision = hk.prototype.K;
    hk.prototype.on = hk.prototype.I;
    hk.prototype.once = hk.prototype.once;
    hk.prototype.un = hk.prototype.J;
    jk.prototype.changed = jk.prototype.u;
    jk.prototype.dispatchEvent = jk.prototype.b;
    jk.prototype.getRevision = jk.prototype.K;
    jk.prototype.on = jk.prototype.I;
    jk.prototype.once = jk.prototype.once;
    jk.prototype.un = jk.prototype.J;
    bi.prototype.type = bi.prototype.type;
    bi.prototype.target = bi.prototype.target;
    bi.prototype.preventDefault = bi.prototype.preventDefault;
    bi.prototype.stopPropagation = bi.prototype.stopPropagation;
    Md.prototype.type = Md.prototype.type;
    Md.prototype.target = Md.prototype.target;
    Md.prototype.preventDefault = Md.prototype.preventDefault;
    Md.prototype.stopPropagation = Md.prototype.stopPropagation;
    kg.prototype.get = kg.prototype.get;
    kg.prototype.getKeys = kg.prototype.P;
    kg.prototype.getProperties = kg.prototype.L;
    kg.prototype.set = kg.prototype.set;
    kg.prototype.setProperties = kg.prototype.H;
    kg.prototype.unset = kg.prototype.R;
    kg.prototype.changed = kg.prototype.u;
    kg.prototype.dispatchEvent = kg.prototype.b;
    kg.prototype.getRevision = kg.prototype.K;
    kg.prototype.on = kg.prototype.I;
    kg.prototype.once = kg.prototype.once;
    kg.prototype.un = kg.prototype.J;
    mg.prototype.getExtent = mg.prototype.G;
    mg.prototype.getMaxResolution = mg.prototype.lc;
    mg.prototype.getMinResolution = mg.prototype.mc;
    mg.prototype.getOpacity = mg.prototype.nc;
    mg.prototype.getVisible = mg.prototype.Jb;
    mg.prototype.getZIndex = mg.prototype.Ba;
    mg.prototype.setExtent = mg.prototype.Fc;
    mg.prototype.setMaxResolution = mg.prototype.Mc;
    mg.prototype.setMinResolution = mg.prototype.Nc;
    mg.prototype.setOpacity = mg.prototype.Gc;
    mg.prototype.setVisible = mg.prototype.Hc;
    mg.prototype.setZIndex = mg.prototype.$b;
    mg.prototype.get = mg.prototype.get;
    mg.prototype.getKeys = mg.prototype.P;
    mg.prototype.getProperties = mg.prototype.L;
    mg.prototype.set = mg.prototype.set;
    mg.prototype.setProperties = mg.prototype.H;
    mg.prototype.unset = mg.prototype.R;
    mg.prototype.changed = mg.prototype.u;
    mg.prototype.dispatchEvent = mg.prototype.b;
    mg.prototype.getRevision = mg.prototype.K;
    mg.prototype.on = mg.prototype.I;
    mg.prototype.once = mg.prototype.once;
    mg.prototype.un = mg.prototype.J;
    xg.prototype.getExtent = xg.prototype.G;
    xg.prototype.getMaxResolution = xg.prototype.lc;
    xg.prototype.getMinResolution = xg.prototype.mc;
    xg.prototype.getOpacity = xg.prototype.nc;
    xg.prototype.getVisible = xg.prototype.Jb;
    xg.prototype.getZIndex = xg.prototype.Ba;
    xg.prototype.setExtent = xg.prototype.Fc;
    xg.prototype.setMaxResolution = xg.prototype.Mc;
    xg.prototype.setMinResolution = xg.prototype.Nc;
    xg.prototype.setOpacity = xg.prototype.Gc;
    xg.prototype.setVisible = xg.prototype.Hc;
    xg.prototype.setZIndex = xg.prototype.$b;
    xg.prototype.get = xg.prototype.get;
    xg.prototype.getKeys = xg.prototype.P;
    xg.prototype.getProperties = xg.prototype.L;
    xg.prototype.set = xg.prototype.set;
    xg.prototype.setProperties = xg.prototype.H;
    xg.prototype.unset = xg.prototype.R;
    xg.prototype.changed = xg.prototype.u;
    xg.prototype.dispatchEvent = xg.prototype.b;
    xg.prototype.getRevision = xg.prototype.K;
    xg.prototype.on = xg.prototype.I;
    xg.prototype.once = xg.prototype.once;
    xg.prototype.un = xg.prototype.J;
    T.prototype.setMap = T.prototype.setMap;
    T.prototype.setSource = T.prototype.hd;
    T.prototype.getExtent = T.prototype.G;
    T.prototype.getMaxResolution = T.prototype.lc;
    T.prototype.getMinResolution = T.prototype.mc;
    T.prototype.getOpacity = T.prototype.nc;
    T.prototype.getVisible = T.prototype.Jb;
    T.prototype.getZIndex = T.prototype.Ba;
    T.prototype.setExtent = T.prototype.Fc;
    T.prototype.setMaxResolution = T.prototype.Mc;
    T.prototype.setMinResolution = T.prototype.Nc;
    T.prototype.setOpacity = T.prototype.Gc;
    T.prototype.setVisible = T.prototype.Hc;
    T.prototype.setZIndex = T.prototype.$b;
    T.prototype.get = T.prototype.get;
    T.prototype.getKeys = T.prototype.P;
    T.prototype.getProperties = T.prototype.L;
    T.prototype.set = T.prototype.set;
    T.prototype.setProperties = T.prototype.H;
    T.prototype.unset = T.prototype.R;
    T.prototype.changed = T.prototype.u;
    T.prototype.dispatchEvent = T.prototype.b;
    T.prototype.getRevision = T.prototype.K;
    T.prototype.on = T.prototype.I;
    T.prototype.once = T.prototype.once;
    T.prototype.un = T.prototype.J;
    V.prototype.getSource = V.prototype.ha;
    V.prototype.getStyle = V.prototype.B;
    V.prototype.getStyleFunction = V.prototype.ib;
    V.prototype.setStyle = V.prototype.j;
    V.prototype.setMap = V.prototype.setMap;
    V.prototype.setSource = V.prototype.hd;
    V.prototype.getExtent = V.prototype.G;
    V.prototype.getMaxResolution = V.prototype.lc;
    V.prototype.getMinResolution = V.prototype.mc;
    V.prototype.getOpacity = V.prototype.nc;
    V.prototype.getVisible = V.prototype.Jb;
    V.prototype.getZIndex = V.prototype.Ba;
    V.prototype.setExtent = V.prototype.Fc;
    V.prototype.setMaxResolution = V.prototype.Mc;
    V.prototype.setMinResolution = V.prototype.Nc;
    V.prototype.setOpacity = V.prototype.Gc;
    V.prototype.setVisible = V.prototype.Hc;
    V.prototype.setZIndex = V.prototype.$b;
    V.prototype.get = V.prototype.get;
    V.prototype.getKeys = V.prototype.P;
    V.prototype.getProperties = V.prototype.L;
    V.prototype.set = V.prototype.set;
    V.prototype.setProperties = V.prototype.H;
    V.prototype.unset = V.prototype.R;
    V.prototype.changed = V.prototype.u;
    V.prototype.dispatchEvent = V.prototype.b;
    V.prototype.getRevision = V.prototype.K;
    V.prototype.on = V.prototype.I;
    V.prototype.once = V.prototype.once;
    V.prototype.un = V.prototype.J;
    Sx.prototype.setMap = Sx.prototype.setMap;
    Sx.prototype.setSource = Sx.prototype.hd;
    Sx.prototype.getExtent = Sx.prototype.G;
    Sx.prototype.getMaxResolution = Sx.prototype.lc;
    Sx.prototype.getMinResolution = Sx.prototype.mc;
    Sx.prototype.getOpacity = Sx.prototype.nc;
    Sx.prototype.getVisible = Sx.prototype.Jb;
    Sx.prototype.getZIndex = Sx.prototype.Ba;
    Sx.prototype.setExtent = Sx.prototype.Fc;
    Sx.prototype.setMaxResolution = Sx.prototype.Mc;
    Sx.prototype.setMinResolution = Sx.prototype.Nc;
    Sx.prototype.setOpacity = Sx.prototype.Gc;
    Sx.prototype.setVisible = Sx.prototype.Hc;
    Sx.prototype.setZIndex = Sx.prototype.$b;
    Sx.prototype.get = Sx.prototype.get;
    Sx.prototype.getKeys = Sx.prototype.P;
    Sx.prototype.getProperties = Sx.prototype.L;
    Sx.prototype.set = Sx.prototype.set;
    Sx.prototype.setProperties = Sx.prototype.H;
    Sx.prototype.unset = Sx.prototype.R;
    Sx.prototype.changed = Sx.prototype.u;
    Sx.prototype.dispatchEvent = Sx.prototype.b;
    Sx.prototype.getRevision = Sx.prototype.K;
    Sx.prototype.on = Sx.prototype.I;
    Sx.prototype.once = Sx.prototype.once;
    Sx.prototype.un = Sx.prototype.J;
    Tx.prototype.setMap = Tx.prototype.setMap;
    Tx.prototype.setSource = Tx.prototype.hd;
    Tx.prototype.getExtent = Tx.prototype.G;
    Tx.prototype.getMaxResolution = Tx.prototype.lc;
    Tx.prototype.getMinResolution = Tx.prototype.mc;
    Tx.prototype.getOpacity = Tx.prototype.nc;
    Tx.prototype.getVisible = Tx.prototype.Jb;
    Tx.prototype.getZIndex = Tx.prototype.Ba;
    Tx.prototype.setExtent = Tx.prototype.Fc;
    Tx.prototype.setMaxResolution = Tx.prototype.Mc;
    Tx.prototype.setMinResolution = Tx.prototype.Nc;
    Tx.prototype.setOpacity = Tx.prototype.Gc;
    Tx.prototype.setVisible = Tx.prototype.Hc;
    Tx.prototype.setZIndex = Tx.prototype.$b;
    Tx.prototype.get = Tx.prototype.get;
    Tx.prototype.getKeys = Tx.prototype.P;
    Tx.prototype.getProperties = Tx.prototype.L;
    Tx.prototype.set = Tx.prototype.set;
    Tx.prototype.setProperties = Tx.prototype.H;
    Tx.prototype.unset = Tx.prototype.R;
    Tx.prototype.changed = Tx.prototype.u;
    Tx.prototype.dispatchEvent = Tx.prototype.b;
    Tx.prototype.getRevision = Tx.prototype.K;
    Tx.prototype.on = Tx.prototype.I;
    Tx.prototype.once = Tx.prototype.once;
    Tx.prototype.un = Tx.prototype.J;
    W.prototype.getStyle = W.prototype.B;
    W.prototype.getStyleFunction = W.prototype.ib;
    W.prototype.setStyle = W.prototype.j;
    W.prototype.setMap = W.prototype.setMap;
    W.prototype.setSource = W.prototype.hd;
    W.prototype.getExtent = W.prototype.G;
    W.prototype.getMaxResolution = W.prototype.lc;
    W.prototype.getMinResolution = W.prototype.mc;
    W.prototype.getOpacity = W.prototype.nc;
    W.prototype.getVisible = W.prototype.Jb;
    W.prototype.getZIndex = W.prototype.Ba;
    W.prototype.setExtent = W.prototype.Fc;
    W.prototype.setMaxResolution = W.prototype.Mc;
    W.prototype.setMinResolution = W.prototype.Nc;
    W.prototype.setOpacity = W.prototype.Gc;
    W.prototype.setVisible = W.prototype.Hc;
    W.prototype.setZIndex = W.prototype.$b;
    W.prototype.get = W.prototype.get;
    W.prototype.getKeys = W.prototype.P;
    W.prototype.getProperties = W.prototype.L;
    W.prototype.set = W.prototype.set;
    W.prototype.setProperties = W.prototype.H;
    W.prototype.unset = W.prototype.R;
    W.prototype.changed = W.prototype.u;
    W.prototype.dispatchEvent = W.prototype.b;
    W.prototype.getRevision = W.prototype.K;
    W.prototype.on = W.prototype.I;
    W.prototype.once = W.prototype.once;
    W.prototype.un = W.prototype.J;
    Jg.prototype.get = Jg.prototype.get;
    Jg.prototype.getKeys = Jg.prototype.P;
    Jg.prototype.getProperties = Jg.prototype.L;
    Jg.prototype.set = Jg.prototype.set;
    Jg.prototype.setProperties = Jg.prototype.H;
    Jg.prototype.unset = Jg.prototype.R;
    Jg.prototype.changed = Jg.prototype.u;
    Jg.prototype.dispatchEvent = Jg.prototype.b;
    Jg.prototype.getRevision = Jg.prototype.K;
    Jg.prototype.on = Jg.prototype.I;
    Jg.prototype.once = Jg.prototype.once;
    Jg.prototype.un = Jg.prototype.J;
    Ug.prototype.getActive = Ug.prototype.c;
    Ug.prototype.getMap = Ug.prototype.i;
    Ug.prototype.setActive = Ug.prototype.Ha;
    Ug.prototype.get = Ug.prototype.get;
    Ug.prototype.getKeys = Ug.prototype.P;
    Ug.prototype.getProperties = Ug.prototype.L;
    Ug.prototype.set = Ug.prototype.set;
    Ug.prototype.setProperties = Ug.prototype.H;
    Ug.prototype.unset = Ug.prototype.R;
    Ug.prototype.changed = Ug.prototype.u;
    Ug.prototype.dispatchEvent = Ug.prototype.b;
    Ug.prototype.getRevision = Ug.prototype.K;
    Ug.prototype.on = Ug.prototype.I;
    Ug.prototype.once = Ug.prototype.once;
    Ug.prototype.un = Ug.prototype.J;
    iw.prototype.getActive = iw.prototype.c;
    iw.prototype.getMap = iw.prototype.i;
    iw.prototype.setActive = iw.prototype.Ha;
    iw.prototype.get = iw.prototype.get;
    iw.prototype.getKeys = iw.prototype.P;
    iw.prototype.getProperties = iw.prototype.L;
    iw.prototype.set = iw.prototype.set;
    iw.prototype.setProperties = iw.prototype.H;
    iw.prototype.unset = iw.prototype.R;
    iw.prototype.changed = iw.prototype.u;
    iw.prototype.dispatchEvent = iw.prototype.b;
    iw.prototype.getRevision = iw.prototype.K;
    iw.prototype.on = iw.prototype.I;
    iw.prototype.once = iw.prototype.once;
    iw.prototype.un = iw.prototype.J;
    lw.prototype.type = lw.prototype.type;
    lw.prototype.target = lw.prototype.target;
    lw.prototype.preventDefault = lw.prototype.preventDefault;
    lw.prototype.stopPropagation = lw.prototype.stopPropagation;
    fh.prototype.getActive = fh.prototype.c;
    fh.prototype.getMap = fh.prototype.i;
    fh.prototype.setActive = fh.prototype.Ha;
    fh.prototype.get = fh.prototype.get;
    fh.prototype.getKeys = fh.prototype.P;
    fh.prototype.getProperties = fh.prototype.L;
    fh.prototype.set = fh.prototype.set;
    fh.prototype.setProperties = fh.prototype.H;
    fh.prototype.unset = fh.prototype.R;
    fh.prototype.changed = fh.prototype.u;
    fh.prototype.dispatchEvent = fh.prototype.b;
    fh.prototype.getRevision = fh.prototype.K;
    fh.prototype.on = fh.prototype.I;
    fh.prototype.once = fh.prototype.once;
    fh.prototype.un = fh.prototype.J;
    th.prototype.getActive = th.prototype.c;
    th.prototype.getMap = th.prototype.i;
    th.prototype.setActive = th.prototype.Ha;
    th.prototype.get = th.prototype.get;
    th.prototype.getKeys = th.prototype.P;
    th.prototype.getProperties = th.prototype.L;
    th.prototype.set = th.prototype.set;
    th.prototype.setProperties = th.prototype.H;
    th.prototype.unset = th.prototype.R;
    th.prototype.changed = th.prototype.u;
    th.prototype.dispatchEvent = th.prototype.b;
    th.prototype.getRevision = th.prototype.K;
    th.prototype.on = th.prototype.I;
    th.prototype.once = th.prototype.once;
    th.prototype.un = th.prototype.J;
    yh.prototype.type = yh.prototype.type;
    yh.prototype.target = yh.prototype.target;
    yh.prototype.preventDefault = yh.prototype.preventDefault;
    yh.prototype.stopPropagation = yh.prototype.stopPropagation;
    ih.prototype.getActive = ih.prototype.c;
    ih.prototype.getMap = ih.prototype.i;
    ih.prototype.setActive = ih.prototype.Ha;
    ih.prototype.get = ih.prototype.get;
    ih.prototype.getKeys = ih.prototype.P;
    ih.prototype.getProperties = ih.prototype.L;
    ih.prototype.set = ih.prototype.set;
    ih.prototype.setProperties = ih.prototype.H;
    ih.prototype.unset = ih.prototype.R;
    ih.prototype.changed = ih.prototype.u;
    ih.prototype.dispatchEvent = ih.prototype.b;
    ih.prototype.getRevision = ih.prototype.K;
    ih.prototype.on = ih.prototype.I;
    ih.prototype.once = ih.prototype.once;
    ih.prototype.un = ih.prototype.J;
    mh.prototype.getActive = mh.prototype.c;
    mh.prototype.getMap = mh.prototype.i;
    mh.prototype.setActive = mh.prototype.Ha;
    mh.prototype.get = mh.prototype.get;
    mh.prototype.getKeys = mh.prototype.P;
    mh.prototype.getProperties = mh.prototype.L;
    mh.prototype.set = mh.prototype.set;
    mh.prototype.setProperties = mh.prototype.H;
    mh.prototype.unset = mh.prototype.R;
    mh.prototype.changed = mh.prototype.u;
    mh.prototype.dispatchEvent = mh.prototype.b;
    mh.prototype.getRevision = mh.prototype.K;
    mh.prototype.on = mh.prototype.I;
    mh.prototype.once = mh.prototype.once;
    mh.prototype.un = mh.prototype.J;
    pw.prototype.getActive = pw.prototype.c;
    pw.prototype.getMap = pw.prototype.i;
    pw.prototype.setActive = pw.prototype.Ha;
    pw.prototype.get = pw.prototype.get;
    pw.prototype.getKeys = pw.prototype.P;
    pw.prototype.getProperties = pw.prototype.L;
    pw.prototype.set = pw.prototype.set;
    pw.prototype.setProperties = pw.prototype.H;
    pw.prototype.unset = pw.prototype.R;
    pw.prototype.changed = pw.prototype.u;
    pw.prototype.dispatchEvent = pw.prototype.b;
    pw.prototype.getRevision = pw.prototype.K;
    pw.prototype.on = pw.prototype.I;
    pw.prototype.once = pw.prototype.once;
    pw.prototype.un = pw.prototype.J;
    Ch.prototype.getGeometry = Ch.prototype.U;
    Ch.prototype.getActive = Ch.prototype.c;
    Ch.prototype.getMap = Ch.prototype.i;
    Ch.prototype.setActive = Ch.prototype.Ha;
    Ch.prototype.get = Ch.prototype.get;
    Ch.prototype.getKeys = Ch.prototype.P;
    Ch.prototype.getProperties = Ch.prototype.L;
    Ch.prototype.set = Ch.prototype.set;
    Ch.prototype.setProperties = Ch.prototype.H;
    Ch.prototype.unset = Ch.prototype.R;
    Ch.prototype.changed = Ch.prototype.u;
    Ch.prototype.dispatchEvent = Ch.prototype.b;
    Ch.prototype.getRevision = Ch.prototype.K;
    Ch.prototype.on = Ch.prototype.I;
    Ch.prototype.once = Ch.prototype.once;
    Ch.prototype.un = Ch.prototype.J;
    Ew.prototype.getActive = Ew.prototype.c;
    Ew.prototype.getMap = Ew.prototype.i;
    Ew.prototype.setActive = Ew.prototype.Ha;
    Ew.prototype.get = Ew.prototype.get;
    Ew.prototype.getKeys = Ew.prototype.P;
    Ew.prototype.getProperties = Ew.prototype.L;
    Ew.prototype.set = Ew.prototype.set;
    Ew.prototype.setProperties = Ew.prototype.H;
    Ew.prototype.unset = Ew.prototype.R;
    Ew.prototype.changed = Ew.prototype.u;
    Ew.prototype.dispatchEvent = Ew.prototype.b;
    Ew.prototype.getRevision = Ew.prototype.K;
    Ew.prototype.on = Ew.prototype.I;
    Ew.prototype.once = Ew.prototype.once;
    Ew.prototype.un = Ew.prototype.J;
    Uw.prototype.type = Uw.prototype.type;
    Uw.prototype.target = Uw.prototype.target;
    Uw.prototype.preventDefault = Uw.prototype.preventDefault;
    Uw.prototype.stopPropagation = Uw.prototype.stopPropagation;
    Vw.prototype.getActive = Vw.prototype.c;
    Vw.prototype.getMap = Vw.prototype.i;
    Vw.prototype.setActive = Vw.prototype.Ha;
    Vw.prototype.get = Vw.prototype.get;
    Vw.prototype.getKeys = Vw.prototype.P;
    Vw.prototype.getProperties = Vw.prototype.L;
    Vw.prototype.set = Vw.prototype.set;
    Vw.prototype.setProperties = Vw.prototype.H;
    Vw.prototype.unset = Vw.prototype.R;
    Vw.prototype.changed = Vw.prototype.u;
    Vw.prototype.dispatchEvent = Vw.prototype.b;
    Vw.prototype.getRevision = Vw.prototype.K;
    Vw.prototype.on = Vw.prototype.I;
    Vw.prototype.once = Vw.prototype.once;
    Vw.prototype.un = Vw.prototype.J;
    fx.prototype.type = fx.prototype.type;
    fx.prototype.target = fx.prototype.target;
    fx.prototype.preventDefault = fx.prototype.preventDefault;
    fx.prototype.stopPropagation = fx.prototype.stopPropagation;
    Dh.prototype.getActive = Dh.prototype.c;
    Dh.prototype.getMap = Dh.prototype.i;
    Dh.prototype.setActive = Dh.prototype.Ha;
    Dh.prototype.get = Dh.prototype.get;
    Dh.prototype.getKeys = Dh.prototype.P;
    Dh.prototype.getProperties = Dh.prototype.L;
    Dh.prototype.set = Dh.prototype.set;
    Dh.prototype.setProperties = Dh.prototype.H;
    Dh.prototype.unset = Dh.prototype.R;
    Dh.prototype.changed = Dh.prototype.u;
    Dh.prototype.dispatchEvent = Dh.prototype.b;
    Dh.prototype.getRevision = Dh.prototype.K;
    Dh.prototype.on = Dh.prototype.I;
    Dh.prototype.once = Dh.prototype.once;
    Dh.prototype.un = Dh.prototype.J;
    Fh.prototype.getActive = Fh.prototype.c;
    Fh.prototype.getMap = Fh.prototype.i;
    Fh.prototype.setActive = Fh.prototype.Ha;
    Fh.prototype.get = Fh.prototype.get;
    Fh.prototype.getKeys = Fh.prototype.P;
    Fh.prototype.getProperties = Fh.prototype.L;
    Fh.prototype.set = Fh.prototype.set;
    Fh.prototype.setProperties = Fh.prototype.H;
    Fh.prototype.unset = Fh.prototype.R;
    Fh.prototype.changed = Fh.prototype.u;
    Fh.prototype.dispatchEvent = Fh.prototype.b;
    Fh.prototype.getRevision = Fh.prototype.K;
    Fh.prototype.on = Fh.prototype.I;
    Fh.prototype.once = Fh.prototype.once;
    Fh.prototype.un = Fh.prototype.J;
    gx.prototype.getActive = gx.prototype.c;
    gx.prototype.getMap = gx.prototype.i;
    gx.prototype.setActive = gx.prototype.Ha;
    gx.prototype.get = gx.prototype.get;
    gx.prototype.getKeys = gx.prototype.P;
    gx.prototype.getProperties = gx.prototype.L;
    gx.prototype.set = gx.prototype.set;
    gx.prototype.setProperties = gx.prototype.H;
    gx.prototype.unset = gx.prototype.R;
    gx.prototype.changed = gx.prototype.u;
    gx.prototype.dispatchEvent = gx.prototype.b;
    gx.prototype.getRevision = gx.prototype.K;
    gx.prototype.on = gx.prototype.I;
    gx.prototype.once = gx.prototype.once;
    gx.prototype.un = gx.prototype.J;
    ox.prototype.type = ox.prototype.type;
    ox.prototype.target = ox.prototype.target;
    ox.prototype.preventDefault = ox.prototype.preventDefault;
    ox.prototype.stopPropagation = ox.prototype.stopPropagation;
    Hh.prototype.getActive = Hh.prototype.c;
    Hh.prototype.getMap = Hh.prototype.i;
    Hh.prototype.setActive = Hh.prototype.Ha;
    Hh.prototype.get = Hh.prototype.get;
    Hh.prototype.getKeys = Hh.prototype.P;
    Hh.prototype.getProperties = Hh.prototype.L;
    Hh.prototype.set = Hh.prototype.set;
    Hh.prototype.setProperties = Hh.prototype.H;
    Hh.prototype.unset = Hh.prototype.R;
    Hh.prototype.changed = Hh.prototype.u;
    Hh.prototype.dispatchEvent = Hh.prototype.b;
    Hh.prototype.getRevision = Hh.prototype.K;
    Hh.prototype.on = Hh.prototype.I;
    Hh.prototype.once = Hh.prototype.once;
    Hh.prototype.un = Hh.prototype.J;
    Rh.prototype.getActive = Rh.prototype.c;
    Rh.prototype.getMap = Rh.prototype.i;
    Rh.prototype.setActive = Rh.prototype.Ha;
    Rh.prototype.get = Rh.prototype.get;
    Rh.prototype.getKeys = Rh.prototype.P;
    Rh.prototype.getProperties = Rh.prototype.L;
    Rh.prototype.set = Rh.prototype.set;
    Rh.prototype.setProperties = Rh.prototype.H;
    Rh.prototype.unset = Rh.prototype.R;
    Rh.prototype.changed = Rh.prototype.u;
    Rh.prototype.dispatchEvent = Rh.prototype.b;
    Rh.prototype.getRevision = Rh.prototype.K;
    Rh.prototype.on = Rh.prototype.I;
    Rh.prototype.once = Rh.prototype.once;
    Rh.prototype.un = Rh.prototype.J;
    Vh.prototype.getActive = Vh.prototype.c;
    Vh.prototype.getMap = Vh.prototype.i;
    Vh.prototype.setActive = Vh.prototype.Ha;
    Vh.prototype.get = Vh.prototype.get;
    Vh.prototype.getKeys = Vh.prototype.P;
    Vh.prototype.getProperties = Vh.prototype.L;
    Vh.prototype.set = Vh.prototype.set;
    Vh.prototype.setProperties = Vh.prototype.H;
    Vh.prototype.unset = Vh.prototype.R;
    Vh.prototype.changed = Vh.prototype.u;
    Vh.prototype.dispatchEvent = Vh.prototype.b;
    Vh.prototype.getRevision = Vh.prototype.K;
    Vh.prototype.on = Vh.prototype.I;
    Vh.prototype.once = Vh.prototype.once;
    Vh.prototype.un = Vh.prototype.J;
    wx.prototype.getActive = wx.prototype.c;
    wx.prototype.getMap = wx.prototype.i;
    wx.prototype.setActive = wx.prototype.Ha;
    wx.prototype.get = wx.prototype.get;
    wx.prototype.getKeys = wx.prototype.P;
    wx.prototype.getProperties = wx.prototype.L;
    wx.prototype.set = wx.prototype.set;
    wx.prototype.setProperties = wx.prototype.H;
    wx.prototype.unset = wx.prototype.R;
    wx.prototype.changed = wx.prototype.u;
    wx.prototype.dispatchEvent = wx.prototype.b;
    wx.prototype.getRevision = wx.prototype.K;
    wx.prototype.on = wx.prototype.I;
    wx.prototype.once = wx.prototype.once;
    wx.prototype.un = wx.prototype.J;
    zx.prototype.type = zx.prototype.type;
    zx.prototype.target = zx.prototype.target;
    zx.prototype.preventDefault = zx.prototype.preventDefault;
    zx.prototype.stopPropagation = zx.prototype.stopPropagation;
    Bx.prototype.getActive = Bx.prototype.c;
    Bx.prototype.getMap = Bx.prototype.i;
    Bx.prototype.setActive = Bx.prototype.Ha;
    Bx.prototype.get = Bx.prototype.get;
    Bx.prototype.getKeys = Bx.prototype.P;
    Bx.prototype.getProperties = Bx.prototype.L;
    Bx.prototype.set = Bx.prototype.set;
    Bx.prototype.setProperties = Bx.prototype.H;
    Bx.prototype.unset = Bx.prototype.R;
    Bx.prototype.changed = Bx.prototype.u;
    Bx.prototype.dispatchEvent = Bx.prototype.b;
    Bx.prototype.getRevision = Bx.prototype.K;
    Bx.prototype.on = Bx.prototype.I;
    Bx.prototype.once = Bx.prototype.once;
    Bx.prototype.un = Bx.prototype.J;
    Gx.prototype.getActive = Gx.prototype.c;
    Gx.prototype.getMap = Gx.prototype.i;
    Gx.prototype.setActive = Gx.prototype.Ha;
    Gx.prototype.get = Gx.prototype.get;
    Gx.prototype.getKeys = Gx.prototype.P;
    Gx.prototype.getProperties = Gx.prototype.L;
    Gx.prototype.set = Gx.prototype.set;
    Gx.prototype.setProperties = Gx.prototype.H;
    Gx.prototype.unset = Gx.prototype.R;
    Gx.prototype.changed = Gx.prototype.u;
    Gx.prototype.dispatchEvent = Gx.prototype.b;
    Gx.prototype.getRevision = Gx.prototype.K;
    Gx.prototype.on = Gx.prototype.I;
    Gx.prototype.once = Gx.prototype.once;
    Gx.prototype.un = Gx.prototype.J;
    Mx.prototype.type = Mx.prototype.type;
    Mx.prototype.target = Mx.prototype.target;
    Mx.prototype.preventDefault = Mx.prototype.preventDefault;
    Mx.prototype.stopPropagation = Mx.prototype.stopPropagation;
    gf.prototype.get = gf.prototype.get;
    gf.prototype.getKeys = gf.prototype.P;
    gf.prototype.getProperties = gf.prototype.L;
    gf.prototype.set = gf.prototype.set;
    gf.prototype.setProperties = gf.prototype.H;
    gf.prototype.unset = gf.prototype.R;
    gf.prototype.changed = gf.prototype.u;
    gf.prototype.dispatchEvent = gf.prototype.b;
    gf.prototype.getRevision = gf.prototype.K;
    gf.prototype.on = gf.prototype.I;
    gf.prototype.once = gf.prototype.once;
    gf.prototype.un = gf.prototype.J;
    hf.prototype.getClosestPoint = hf.prototype.Ib;
    hf.prototype.intersectsCoordinate = hf.prototype.Bb;
    hf.prototype.getExtent = hf.prototype.G;
    hf.prototype.rotate = hf.prototype.rotate;
    hf.prototype.scale = hf.prototype.scale;
    hf.prototype.simplify = hf.prototype.Sb;
    hf.prototype.transform = hf.prototype.mb;
    hf.prototype.get = hf.prototype.get;
    hf.prototype.getKeys = hf.prototype.P;
    hf.prototype.getProperties = hf.prototype.L;
    hf.prototype.set = hf.prototype.set;
    hf.prototype.setProperties = hf.prototype.H;
    hf.prototype.unset = hf.prototype.R;
    hf.prototype.changed = hf.prototype.u;
    hf.prototype.dispatchEvent = hf.prototype.b;
    hf.prototype.getRevision = hf.prototype.K;
    hf.prototype.on = hf.prototype.I;
    hf.prototype.once = hf.prototype.once;
    hf.prototype.un = hf.prototype.J;
    gw.prototype.getFirstCoordinate = gw.prototype.fc;
    gw.prototype.getLastCoordinate = gw.prototype.gc;
    gw.prototype.getLayout = gw.prototype.ic;
    gw.prototype.rotate = gw.prototype.rotate;
    gw.prototype.scale = gw.prototype.scale;
    gw.prototype.getClosestPoint = gw.prototype.Ib;
    gw.prototype.intersectsCoordinate = gw.prototype.Bb;
    gw.prototype.getExtent = gw.prototype.G;
    gw.prototype.simplify = gw.prototype.Sb;
    gw.prototype.get = gw.prototype.get;
    gw.prototype.getKeys = gw.prototype.P;
    gw.prototype.getProperties = gw.prototype.L;
    gw.prototype.set = gw.prototype.set;
    gw.prototype.setProperties = gw.prototype.H;
    gw.prototype.unset = gw.prototype.R;
    gw.prototype.changed = gw.prototype.u;
    gw.prototype.dispatchEvent = gw.prototype.b;
    gw.prototype.getRevision = gw.prototype.K;
    gw.prototype.on = gw.prototype.I;
    gw.prototype.once = gw.prototype.once;
    gw.prototype.un = gw.prototype.J;
    Mq.prototype.getClosestPoint = Mq.prototype.Ib;
    Mq.prototype.intersectsCoordinate = Mq.prototype.Bb;
    Mq.prototype.getExtent = Mq.prototype.G;
    Mq.prototype.rotate = Mq.prototype.rotate;
    Mq.prototype.scale = Mq.prototype.scale;
    Mq.prototype.simplify = Mq.prototype.Sb;
    Mq.prototype.transform = Mq.prototype.mb;
    Mq.prototype.get = Mq.prototype.get;
    Mq.prototype.getKeys = Mq.prototype.P;
    Mq.prototype.getProperties = Mq.prototype.L;
    Mq.prototype.set = Mq.prototype.set;
    Mq.prototype.setProperties = Mq.prototype.H;
    Mq.prototype.unset = Mq.prototype.R;
    Mq.prototype.changed = Mq.prototype.u;
    Mq.prototype.dispatchEvent = Mq.prototype.b;
    Mq.prototype.getRevision = Mq.prototype.K;
    Mq.prototype.on = Mq.prototype.I;
    Mq.prototype.once = Mq.prototype.once;
    Mq.prototype.un = Mq.prototype.J;
    Df.prototype.getFirstCoordinate = Df.prototype.fc;
    Df.prototype.getLastCoordinate = Df.prototype.gc;
    Df.prototype.getLayout = Df.prototype.ic;
    Df.prototype.rotate = Df.prototype.rotate;
    Df.prototype.scale = Df.prototype.scale;
    Df.prototype.getClosestPoint = Df.prototype.Ib;
    Df.prototype.intersectsCoordinate = Df.prototype.Bb;
    Df.prototype.getExtent = Df.prototype.G;
    Df.prototype.simplify = Df.prototype.Sb;
    Df.prototype.transform = Df.prototype.mb;
    Df.prototype.get = Df.prototype.get;
    Df.prototype.getKeys = Df.prototype.P;
    Df.prototype.getProperties = Df.prototype.L;
    Df.prototype.set = Df.prototype.set;
    Df.prototype.setProperties = Df.prototype.H;
    Df.prototype.unset = Df.prototype.R;
    Df.prototype.changed = Df.prototype.u;
    Df.prototype.dispatchEvent = Df.prototype.b;
    Df.prototype.getRevision = Df.prototype.K;
    Df.prototype.on = Df.prototype.I;
    Df.prototype.once = Df.prototype.once;
    Df.prototype.un = Df.prototype.J;
    I.prototype.getFirstCoordinate = I.prototype.fc;
    I.prototype.getLastCoordinate = I.prototype.gc;
    I.prototype.getLayout = I.prototype.ic;
    I.prototype.rotate = I.prototype.rotate;
    I.prototype.scale = I.prototype.scale;
    I.prototype.getClosestPoint = I.prototype.Ib;
    I.prototype.intersectsCoordinate = I.prototype.Bb;
    I.prototype.getExtent = I.prototype.G;
    I.prototype.simplify = I.prototype.Sb;
    I.prototype.transform = I.prototype.mb;
    I.prototype.get = I.prototype.get;
    I.prototype.getKeys = I.prototype.P;
    I.prototype.getProperties = I.prototype.L;
    I.prototype.set = I.prototype.set;
    I.prototype.setProperties = I.prototype.H;
    I.prototype.unset = I.prototype.R;
    I.prototype.changed = I.prototype.u;
    I.prototype.dispatchEvent = I.prototype.b;
    I.prototype.getRevision = I.prototype.K;
    I.prototype.on = I.prototype.I;
    I.prototype.once = I.prototype.once;
    I.prototype.un = I.prototype.J;
    P.prototype.getFirstCoordinate = P.prototype.fc;
    P.prototype.getLastCoordinate = P.prototype.gc;
    P.prototype.getLayout = P.prototype.ic;
    P.prototype.rotate = P.prototype.rotate;
    P.prototype.scale = P.prototype.scale;
    P.prototype.getClosestPoint = P.prototype.Ib;
    P.prototype.intersectsCoordinate = P.prototype.Bb;
    P.prototype.getExtent = P.prototype.G;
    P.prototype.simplify = P.prototype.Sb;
    P.prototype.transform = P.prototype.mb;
    P.prototype.get = P.prototype.get;
    P.prototype.getKeys = P.prototype.P;
    P.prototype.getProperties = P.prototype.L;
    P.prototype.set = P.prototype.set;
    P.prototype.setProperties = P.prototype.H;
    P.prototype.unset = P.prototype.R;
    P.prototype.changed = P.prototype.u;
    P.prototype.dispatchEvent = P.prototype.b;
    P.prototype.getRevision = P.prototype.K;
    P.prototype.on = P.prototype.I;
    P.prototype.once = P.prototype.once;
    P.prototype.un = P.prototype.J;
    No.prototype.getFirstCoordinate = No.prototype.fc;
    No.prototype.getLastCoordinate = No.prototype.gc;
    No.prototype.getLayout = No.prototype.ic;
    No.prototype.rotate = No.prototype.rotate;
    No.prototype.scale = No.prototype.scale;
    No.prototype.getClosestPoint = No.prototype.Ib;
    No.prototype.intersectsCoordinate = No.prototype.Bb;
    No.prototype.getExtent = No.prototype.G;
    No.prototype.simplify = No.prototype.Sb;
    No.prototype.transform = No.prototype.mb;
    No.prototype.get = No.prototype.get;
    No.prototype.getKeys = No.prototype.P;
    No.prototype.getProperties = No.prototype.L;
    No.prototype.set = No.prototype.set;
    No.prototype.setProperties = No.prototype.H;
    No.prototype.unset = No.prototype.R;
    No.prototype.changed = No.prototype.u;
    No.prototype.dispatchEvent = No.prototype.b;
    No.prototype.getRevision = No.prototype.K;
    No.prototype.on = No.prototype.I;
    No.prototype.once = No.prototype.once;
    No.prototype.un = No.prototype.J;
    Q.prototype.getFirstCoordinate = Q.prototype.fc;
    Q.prototype.getLastCoordinate = Q.prototype.gc;
    Q.prototype.getLayout = Q.prototype.ic;
    Q.prototype.rotate = Q.prototype.rotate;
    Q.prototype.scale = Q.prototype.scale;
    Q.prototype.getClosestPoint = Q.prototype.Ib;
    Q.prototype.intersectsCoordinate = Q.prototype.Bb;
    Q.prototype.getExtent = Q.prototype.G;
    Q.prototype.simplify = Q.prototype.Sb;
    Q.prototype.transform = Q.prototype.mb;
    Q.prototype.get = Q.prototype.get;
    Q.prototype.getKeys = Q.prototype.P;
    Q.prototype.getProperties = Q.prototype.L;
    Q.prototype.set = Q.prototype.set;
    Q.prototype.setProperties = Q.prototype.H;
    Q.prototype.unset = Q.prototype.R;
    Q.prototype.changed = Q.prototype.u;
    Q.prototype.dispatchEvent = Q.prototype.b;
    Q.prototype.getRevision = Q.prototype.K;
    Q.prototype.on = Q.prototype.I;
    Q.prototype.once = Q.prototype.once;
    Q.prototype.un = Q.prototype.J;
    C.prototype.getFirstCoordinate = C.prototype.fc;
    C.prototype.getLastCoordinate = C.prototype.gc;
    C.prototype.getLayout = C.prototype.ic;
    C.prototype.rotate = C.prototype.rotate;
    C.prototype.scale = C.prototype.scale;
    C.prototype.getClosestPoint = C.prototype.Ib;
    C.prototype.intersectsCoordinate = C.prototype.Bb;
    C.prototype.getExtent = C.prototype.G;
    C.prototype.simplify = C.prototype.Sb;
    C.prototype.transform = C.prototype.mb;
    C.prototype.get = C.prototype.get;
    C.prototype.getKeys = C.prototype.P;
    C.prototype.getProperties = C.prototype.L;
    C.prototype.set = C.prototype.set;
    C.prototype.setProperties = C.prototype.H;
    C.prototype.unset = C.prototype.R;
    C.prototype.changed = C.prototype.u;
    C.prototype.dispatchEvent = C.prototype.b;
    C.prototype.getRevision = C.prototype.K;
    C.prototype.on = C.prototype.I;
    C.prototype.once = C.prototype.once;
    C.prototype.un = C.prototype.J;
    D.prototype.getFirstCoordinate = D.prototype.fc;
    D.prototype.getLastCoordinate = D.prototype.gc;
    D.prototype.getLayout = D.prototype.ic;
    D.prototype.rotate = D.prototype.rotate;
    D.prototype.scale = D.prototype.scale;
    D.prototype.getClosestPoint = D.prototype.Ib;
    D.prototype.intersectsCoordinate = D.prototype.Bb;
    D.prototype.getExtent = D.prototype.G;
    D.prototype.simplify = D.prototype.Sb;
    D.prototype.transform = D.prototype.mb;
    D.prototype.get = D.prototype.get;
    D.prototype.getKeys = D.prototype.P;
    D.prototype.getProperties = D.prototype.L;
    D.prototype.set = D.prototype.set;
    D.prototype.setProperties = D.prototype.H;
    D.prototype.unset = D.prototype.R;
    D.prototype.changed = D.prototype.u;
    D.prototype.dispatchEvent = D.prototype.b;
    D.prototype.getRevision = D.prototype.K;
    D.prototype.on = D.prototype.I;
    D.prototype.once = D.prototype.once;
    D.prototype.un = D.prototype.J;
    Kp.prototype.readFeatures = Kp.prototype.Qa;
    Tp.prototype.readFeatures = Tp.prototype.Qa;
    Kp.prototype.readFeatures = Kp.prototype.Qa;
    vg.prototype.get = vg.prototype.get;
    vg.prototype.getKeys = vg.prototype.P;
    vg.prototype.getProperties = vg.prototype.L;
    vg.prototype.set = vg.prototype.set;
    vg.prototype.setProperties = vg.prototype.H;
    vg.prototype.unset = vg.prototype.R;
    vg.prototype.changed = vg.prototype.u;
    vg.prototype.dispatchEvent = vg.prototype.b;
    vg.prototype.getRevision = vg.prototype.K;
    vg.prototype.on = vg.prototype.I;
    vg.prototype.once = vg.prototype.once;
    vg.prototype.un = vg.prototype.J;
    zg.prototype.getMap = zg.prototype.f;
    zg.prototype.setMap = zg.prototype.setMap;
    zg.prototype.setTarget = zg.prototype.i;
    zg.prototype.get = zg.prototype.get;
    zg.prototype.getKeys = zg.prototype.P;
    zg.prototype.getProperties = zg.prototype.L;
    zg.prototype.set = zg.prototype.set;
    zg.prototype.setProperties = zg.prototype.H;
    zg.prototype.unset = zg.prototype.R;
    zg.prototype.changed = zg.prototype.u;
    zg.prototype.dispatchEvent = zg.prototype.b;
    zg.prototype.getRevision = zg.prototype.K;
    zg.prototype.on = zg.prototype.I;
    zg.prototype.once = zg.prototype.once;
    zg.prototype.un = zg.prototype.J;
    Mn.prototype.getMap = Mn.prototype.f;
    Mn.prototype.setMap = Mn.prototype.setMap;
    Mn.prototype.setTarget = Mn.prototype.i;
    Mn.prototype.get = Mn.prototype.get;
    Mn.prototype.getKeys = Mn.prototype.P;
    Mn.prototype.getProperties = Mn.prototype.L;
    Mn.prototype.set = Mn.prototype.set;
    Mn.prototype.setProperties = Mn.prototype.H;
    Mn.prototype.unset = Mn.prototype.R;
    Mn.prototype.changed = Mn.prototype.u;
    Mn.prototype.dispatchEvent = Mn.prototype.b;
    Mn.prototype.getRevision = Mn.prototype.K;
    Mn.prototype.on = Mn.prototype.I;
    Mn.prototype.once = Mn.prototype.once;
    Mn.prototype.un = Mn.prototype.J;
    Rn.prototype.getMap = Rn.prototype.f;
    Rn.prototype.setMap = Rn.prototype.setMap;
    Rn.prototype.setTarget = Rn.prototype.i;
    Rn.prototype.get = Rn.prototype.get;
    Rn.prototype.getKeys = Rn.prototype.P;
    Rn.prototype.getProperties = Rn.prototype.L;
    Rn.prototype.set = Rn.prototype.set;
    Rn.prototype.setProperties = Rn.prototype.H;
    Rn.prototype.unset = Rn.prototype.R;
    Rn.prototype.changed = Rn.prototype.u;
    Rn.prototype.dispatchEvent = Rn.prototype.b;
    Rn.prototype.getRevision = Rn.prototype.K;
    Rn.prototype.on = Rn.prototype.I;
    Rn.prototype.once = Rn.prototype.once;
    Rn.prototype.un = Rn.prototype.J;
    Wn.prototype.getMap = Wn.prototype.f;
    Wn.prototype.setMap = Wn.prototype.setMap;
    Wn.prototype.setTarget = Wn.prototype.i;
    Wn.prototype.get = Wn.prototype.get;
    Wn.prototype.getKeys = Wn.prototype.P;
    Wn.prototype.getProperties = Wn.prototype.L;
    Wn.prototype.set = Wn.prototype.set;
    Wn.prototype.setProperties = Wn.prototype.H;
    Wn.prototype.unset = Wn.prototype.R;
    Wn.prototype.changed = Wn.prototype.u;
    Wn.prototype.dispatchEvent = Wn.prototype.b;
    Wn.prototype.getRevision = Wn.prototype.K;
    Wn.prototype.on = Wn.prototype.I;
    Wn.prototype.once = Wn.prototype.once;
    Wn.prototype.un = Wn.prototype.J;
    Cg.prototype.getMap = Cg.prototype.f;
    Cg.prototype.setMap = Cg.prototype.setMap;
    Cg.prototype.setTarget = Cg.prototype.i;
    Cg.prototype.get = Cg.prototype.get;
    Cg.prototype.getKeys = Cg.prototype.P;
    Cg.prototype.getProperties = Cg.prototype.L;
    Cg.prototype.set = Cg.prototype.set;
    Cg.prototype.setProperties = Cg.prototype.H;
    Cg.prototype.unset = Cg.prototype.R;
    Cg.prototype.changed = Cg.prototype.u;
    Cg.prototype.dispatchEvent = Cg.prototype.b;
    Cg.prototype.getRevision = Cg.prototype.K;
    Cg.prototype.on = Cg.prototype.I;
    Cg.prototype.once = Cg.prototype.once;
    Cg.prototype.un = Cg.prototype.J;
    ao.prototype.getMap = ao.prototype.f;
    ao.prototype.setMap = ao.prototype.setMap;
    ao.prototype.setTarget = ao.prototype.i;
    ao.prototype.get = ao.prototype.get;
    ao.prototype.getKeys = ao.prototype.P;
    ao.prototype.getProperties = ao.prototype.L;
    ao.prototype.set = ao.prototype.set;
    ao.prototype.setProperties = ao.prototype.H;
    ao.prototype.unset = ao.prototype.R;
    ao.prototype.changed = ao.prototype.u;
    ao.prototype.dispatchEvent = ao.prototype.b;
    ao.prototype.getRevision = ao.prototype.K;
    ao.prototype.on = ao.prototype.I;
    ao.prototype.once = ao.prototype.once;
    ao.prototype.un = ao.prototype.J;
    Eg.prototype.getMap = Eg.prototype.f;
    Eg.prototype.setMap = Eg.prototype.setMap;
    Eg.prototype.setTarget = Eg.prototype.i;
    Eg.prototype.get = Eg.prototype.get;
    Eg.prototype.getKeys = Eg.prototype.P;
    Eg.prototype.getProperties = Eg.prototype.L;
    Eg.prototype.set = Eg.prototype.set;
    Eg.prototype.setProperties = Eg.prototype.H;
    Eg.prototype.unset = Eg.prototype.R;
    Eg.prototype.changed = Eg.prototype.u;
    Eg.prototype.dispatchEvent = Eg.prototype.b;
    Eg.prototype.getRevision = Eg.prototype.K;
    Eg.prototype.on = Eg.prototype.I;
    Eg.prototype.once = Eg.prototype.once;
    Eg.prototype.un = Eg.prototype.J;
    go.prototype.getMap = go.prototype.f;
    go.prototype.setMap = go.prototype.setMap;
    go.prototype.setTarget = go.prototype.i;
    go.prototype.get = go.prototype.get;
    go.prototype.getKeys = go.prototype.P;
    go.prototype.getProperties = go.prototype.L;
    go.prototype.set = go.prototype.set;
    go.prototype.setProperties = go.prototype.H;
    go.prototype.unset = go.prototype.R;
    go.prototype.changed = go.prototype.u;
    go.prototype.dispatchEvent = go.prototype.b;
    go.prototype.getRevision = go.prototype.K;
    go.prototype.on = go.prototype.I;
    go.prototype.once = go.prototype.once;
    go.prototype.un = go.prototype.J;
    lo.prototype.getMap = lo.prototype.f;
    lo.prototype.setMap = lo.prototype.setMap;
    lo.prototype.setTarget = lo.prototype.i;
    lo.prototype.get = lo.prototype.get;
    lo.prototype.getKeys = lo.prototype.P;
    lo.prototype.getProperties = lo.prototype.L;
    lo.prototype.set = lo.prototype.set;
    lo.prototype.setProperties = lo.prototype.H;
    lo.prototype.unset = lo.prototype.R;
    lo.prototype.changed = lo.prototype.u;
    lo.prototype.dispatchEvent = lo.prototype.b;
    lo.prototype.getRevision = lo.prototype.K;
    lo.prototype.on = lo.prototype.I;
    lo.prototype.once = lo.prototype.once;
    lo.prototype.un = lo.prototype.J;
    return OPENLAYERS.ol;
}));
(function webpackUniversalModuleDefinition(root, factory) {
    if (typeof exports === 'object' && typeof module === 'object')
        module.exports = factory(openlayers, xmldom, request, itowns);
    else if (typeof define === 'function' && define.amd)
        define('Gp', [
            'ol',
            'require',
            'require',
            'itowns'
        ], factory);
    else if (typeof exports === 'object')
        exports['Gp'] = factory(openlayers, xmldom, request, itowns);
    else
        root['Gp'] = factory(root['ol'], root[undefined], root[undefined], root['itowns']);
}(typeof self !== 'undefined' ? self : this, function (__WEBPACK_EXTERNAL_MODULE_1__, __WEBPACK_EXTERNAL_MODULE_15__, __WEBPACK_EXTERNAL_MODULE_45__, __WEBPACK_EXTERNAL_MODULE_72__) {
    return function (modules) {
        var installedModules = {};
        function __webpack_require__(moduleId) {
            if (installedModules[moduleId]) {
                return installedModules[moduleId].exports;
            }
            var module = installedModules[moduleId] = {
                i: moduleId,
                l: false,
                exports: {}
            };
            modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
            module.l = true;
            return module.exports;
        }
        __webpack_require__.m = modules;
        __webpack_require__.c = installedModules;
        __webpack_require__.d = function (exports, name, getter) {
            if (!__webpack_require__.o(exports, name)) {
                Object.defineProperty(exports, name, {
                    configurable: false,
                    enumerable: true,
                    get: getter
                });
            }
            return exports;
        };
        __webpack_require__.n = function (module) {
            var getter = module && module.__esModule ? function getDefault() {
                return module['default'];
            } : function getModuleExports() {
                return module;
            };
            __webpack_require__.d(getter, 'a', getter);
            return getter;
        };
        __webpack_require__.o = function (object, property) {
            return Object.prototype.hasOwnProperty.call(object, property);
        };
        __webpack_require__.p = '';
        return __webpack_require__(__webpack_require__.s = 43);
    }([
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var Utils = {
                detectSupport: function detectSupport() {
                    var isDesktop = true;
                    var userAgent = window.navigator.userAgent.toLowerCase();
                    if (userAgent.indexOf('iphone') !== -1 || userAgent.indexOf('ipod') !== -1 || userAgent.indexOf('ipad') !== -1 || userAgent.indexOf('android') !== -1 || userAgent.indexOf('mobile') !== -1 || userAgent.indexOf('blackberry') !== -1 || userAgent.indexOf('tablet') !== -1 || userAgent.indexOf('phone') !== -1 || userAgent.indexOf('touch') !== -1) {
                        isDesktop = false;
                    }
                    if (userAgent.indexOf('msie') !== -1 || userAgent.indexOf('trident') !== -1) {
                        isDesktop = true;
                    }
                    return isDesktop;
                },
                assign: function assign(dest, source) {
                    dest = dest || {};
                    for (var prop in source) {
                        if (source.hasOwnProperty(prop)) {
                            dest[prop] = source[prop];
                        }
                    }
                    return dest;
                },
                mergeParams: function mergeParams(dest, source) {
                    if (!dest || !source) {
                        return;
                    }
                    for (var param in source) {
                        if (source.hasOwnProperty(param)) {
                            if (_typeof(source[param]) === 'object') {
                                if (dest.hasOwnProperty(param)) {
                                    this.mergeParams(dest[param], source[param]);
                                } else {
                                    dest[param] = source[param];
                                }
                            } else {
                                dest[param] = source[param];
                            }
                        }
                    }
                }
            };
            exports.default = Utils;
            return exports;
        },
        function (module, exports) {
            module.exports = __WEBPACK_EXTERNAL_MODULE_1__;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var SelectorID = {
                generate: function () {
                    var timestamp = Math.floor(Date.now());
                    return function () {
                        return timestamp++;
                    };
                }(),
                name: function name(id) {
                    var name = null;
                    var i = id.lastIndexOf('-');
                    if (i === -1) {
                        name = id;
                    } else {
                        name = id.substring(0, i);
                    }
                    return name;
                },
                index: function index(id) {
                    var index = null;
                    var name = this.name(id);
                    var i = name.lastIndexOf('_');
                    if (i !== -1) {
                        index = name.substring(i + 1);
                    }
                    return index;
                },
                uuid: function uuid(id) {
                    var uuid = null;
                    var i = id.lastIndexOf('-');
                    if (i !== -1) {
                        uuid = parseInt(id.substring(i + 1), 10);
                    }
                    return uuid;
                }
            };
            exports.default = SelectorID;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _loglevel = __webpack_require__(74);
            var Log = _interopRequireWildcard(_loglevel);
            function _interopRequireWildcard(obj) {
                if (obj && obj.__esModule) {
                    return obj;
                } else {
                    var newObj = {};
                    if (obj != null) {
                        for (var key in obj) {
                            if (Object.prototype.hasOwnProperty.call(obj, key))
                                newObj[key] = obj[key];
                        }
                    }
                    newObj.default = obj;
                    return newObj;
                }
            }
            var LoggerByDefault = {
                getLogger: function getLogger(name) {
                    false ? Log.disableAll() : Log.enableAll();
                    var logname = name || 'default';
                    return Log.getLogger(logname);
                }
            };
            exports.default = LoggerByDefault;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            (function webpackUniversalModuleDefinition(root, factory) {
                if (true)
                    module.exports = factory(__webpack_require__(15), __webpack_require__(45));
                else if (typeof define === 'function' && define.amd)
                    define('Gp', [
                        'require',
                        'require'
                    ], factory);
                else if (typeof exports === 'object')
                    exports['Gp'] = factory(xmldom, request);
                else
                    root['Gp'] = factory(root[undefined], root[undefined]);
            }(typeof self !== 'undefined' ? self : this, function (__WEBPACK_EXTERNAL_MODULE_20__, __WEBPACK_EXTERNAL_MODULE_52__) {
                return function (modules) {
                    var installedModules = {};
                    function __webpack_require__(moduleId) {
                        if (installedModules[moduleId]) {
                            return installedModules[moduleId].exports;
                        }
                        var module = installedModules[moduleId] = {
                            i: moduleId,
                            l: false,
                            exports: {}
                        };
                        modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
                        module.l = true;
                        return module.exports;
                    }
                    __webpack_require__.m = modules;
                    __webpack_require__.c = installedModules;
                    __webpack_require__.d = function (exports, name, getter) {
                        if (!__webpack_require__.o(exports, name)) {
                            Object.defineProperty(exports, name, {
                                configurable: false,
                                enumerable: true,
                                get: getter
                            });
                        }
                        return exports;
                    };
                    __webpack_require__.n = function (module) {
                        var getter = module && module.__esModule ? function getDefault() {
                            return module['default'];
                        } : function getModuleExports() {
                            return module;
                        };
                        __webpack_require__.d(getter, 'a', getter);
                        return getter;
                    };
                    __webpack_require__.o = function (object, property) {
                        return Object.prototype.hasOwnProperty.call(object, property);
                    };
                    __webpack_require__.p = '';
                    return __webpack_require__(__webpack_require__.s = 43);
                }([
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0_loglevel__ = __webpack_require__(47);
                        var __WEBPACK_IMPORTED_MODULE_0_loglevel___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_loglevel__);
                        var LoggerByDefault = {
                            getLogger: function (name) {
                                false ? Log.disableAll() : __WEBPACK_IMPORTED_MODULE_0_loglevel__['enableAll']();
                                var logname = name || 'default';
                                return __WEBPACK_IMPORTED_MODULE_0_loglevel__['getLogger'](logname);
                            }
                        };
                        __webpack_exports__['a'] = LoggerByDefault;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var MessagesResources = {
                            PARAM_MISSING: 'Parameter(s) \'%var%\' missing',
                            PARAM_EMPTY: 'Parameter(s) \'%var%\' empty',
                            PARAM_TYPE: 'Wrong type(s) for parameter(s) \'%var%\'',
                            PARAM_FORMAT: 'Parameter(s) \'%var%\' not correctly formatted',
                            PARAM_NOT_SUPPORT: 'Value(s) for parameter(s) \'%var%\' not supported',
                            PARAM_NOT_SUPPORT_NODEJS: 'Value(s) for parameter(s) \'%var%\' not supported to NodeJS',
                            PARAM_UNKNOWN: 'Value(s) for parameter(s) \'%var%\' unknown',
                            SERVICE_REQUEST_BUILD: 'An error occurred during the request building of the service',
                            SERVICE_REQUEST_EMPTY: 'The request sent to the service is empty',
                            SERVICE_RESPONSE_EXCEPTION: 'The service returned an exception : \'%var%\'',
                            SERVICE_RESPONSE_EXCEPTION_2: 'The service returned an exception',
                            SERVICE_RESPONSE_ANALYSE: 'An error occurred while parsing the response \'%var%\' of the service',
                            SERVICE_RESPONSE_ANALYSE_2: 'An unknown error occurred while parsing the response',
                            SERVICE_RESPONSE_EMPTY: 'The response of the service is empty',
                            SERVICE_RESPONSE_EMPTY_2: 'The response from the service could not be analyzed or is empty',
                            SERVICE_RESPONSE_FORMAT: 'The format of the service response is not supported (handled format(s) : \'%var%\')',
                            SERVICE_RESPONSE_FORMAT_2: 'The format of the service response is not supported',
                            SERVICE_RESPONSE_FORMAT_3: 'No suggestion matching the search',
                            CLASS_CONSTRUCTOR: '\'%var%\' constructor cannot be called as a function.',
                            getMessage: function (clef, parametres) {
                                if (Object.keys(arguments).length === 0) {
                                    return 'Message indefined !';
                                }
                                var params = Array.prototype.slice.call(arguments);
                                var key = params.shift();
                                var args = params;
                                var message = this[key];
                                try {
                                    if (Array.isArray(args) && args.length > 0) {
                                        message = message.replace('%var%', args.join(' - '));
                                    } else {
                                        message = message.replace('%var%', '%var% (not specified)');
                                    }
                                } catch (e) {
                                }
                                return message;
                            }
                        };
                        __webpack_exports__['a'] = MessagesResources;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function ErrorService(error) {
                            if (!(this instanceof ErrorService)) {
                                throw new TypeError('ErrorService constructor cannot be called as a function.');
                            }
                            var e = error;
                            if (typeof error === 'string' || error instanceof String) {
                                this.message = error;
                                this.status = -1;
                                this.type = ErrorService.TYPE_UNKERR;
                            } else {
                                this.message = e.message || 'undefined!?';
                                this.type = e.type;
                                this.status = e.status || -1;
                            }
                            this.name = 'ErrorService';
                            this.stack = new Error().stack;
                        }
                        ErrorService.TYPE_SRVERR = 'SERVICE_ERROR';
                        ErrorService.TYPE_USEERR = 'USAGE_ERROR';
                        ErrorService.TYPE_UNKERR = 'UNKNOWN_ERROR';
                        ErrorService.prototype = Object.create(Error.prototype, {
                            constructor: {
                                value: ErrorService,
                                writable: true,
                                configurable: true
                            }
                        });
                        __webpack_exports__['a'] = ErrorService;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__ = __webpack_require__(4);
                        var __WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_3__Protocols_Protocol__ = __webpack_require__(48);
                        var __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_5__DefaultUrlService__ = __webpack_require__(5);
                        function CommonService(options) {
                            if (!(this instanceof CommonService)) {
                                throw new TypeError(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__['a'].getMessage('CLASS_CONSTRUCTOR'));
                            }
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('CommonService');
                            this.logger.trace('[Constructeur CommonService (options)]');
                            this.options = {
                                protocol: 'XHR',
                                ssl: false,
                                proxyURL: '',
                                callbackSuffix: null,
                                httpMethod: 'GET',
                                timeOut: 0,
                                rawResponse: false,
                                scope: this,
                                onSuccess: function (response) {
                                    console.log('onSuccess - la reponse est la suivante : ', response);
                                },
                                onFailure: function (error) {
                                    if (error.status === 200 || !error.status) {
                                        console.log('onFailure : ', error.message);
                                    } else {
                                        console.log('onFailure - Erreur (', error.status, ') : ', error.message);
                                    }
                                }
                            };
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    this.options[opt] = options[opt];
                                }
                            }
                            if (!this.options.apiKey && !this.options.serverUrl) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'apiKey', 'serverUrl'));
                            }
                            if (this.options.rawResponse && !this.options.onSuccess) {
                                this.options.onSuccess = function (response) {
                                    console.log('onSuccess - la réponse brute du service est la suivante : ', response);
                                };
                            }
                            var bOnSuccess = !!(this.options.onSuccess !== null && typeof this.options.onSuccess === 'function');
                            if (!bOnSuccess) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'onSuccess()'));
                            }
                            if (!this.options.serverUrl) {
                                __WEBPACK_IMPORTED_MODULE_5__DefaultUrlService__['a'].ssl = this.options.ssl;
                                var urlByDefault = __WEBPACK_IMPORTED_MODULE_5__DefaultUrlService__['a'][this.CLASSNAME].url(this.options.apiKey);
                                if (typeof urlByDefault === 'string') {
                                    this.options.serverUrl = urlByDefault;
                                } else {
                                    this.logger.trace('URL par defaut à determiner au niveau du composant...');
                                }
                            }
                            this.options.httpMethod = typeof options.httpMethod === 'string' ? options.httpMethod.toUpperCase() : 'GET';
                            switch (this.options.httpMethod) {
                            case 'POST':
                            case 'GET':
                                break;
                            case 'PUT':
                            case 'DELETE':
                            case 'HEAD':
                            case 'OPTIONS':
                                throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__['a'].getMessage('PARAM_NOT_SUPPORT', 'httpMethod'));
                            default:
                                throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__['a'].getMessage('PARAM_UNKNOWN', 'httpMethod'));
                            }
                            this.options.protocol = typeof options.protocol === 'string' ? options.protocol.toUpperCase() : 'XHR';
                            switch (this.options.protocol) {
                            case 'JSONP':
                            case 'XHR':
                                break;
                            default:
                                throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__['a'].getMessage('PARAM_UNKNOWN', 'protocol'));
                            }
                            if (typeof window === 'undefined' && this.options.protocol === 'JSONP') {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_2__Utils_MessagesResources__['a'].getMessage('PARAM_NOT_SUPPORT_NODEJS', 'protocol=JSONP (instead use XHR)'));
                            }
                            if (this.options.protocol === 'JSONP') {
                                this.options.httpMethod = 'GET';
                            }
                            this.options.nocache = options.nocache || false;
                            this.options.outputFormat = null;
                            this.request = null;
                            this.response = null;
                        }
                        CommonService.prototype = {
                            constructor: CommonService,
                            call: function () {
                                this.logger.trace('CommonService::call ()');
                                var context = this;
                                function run() {
                                    this.logger.trace('CommonService::run ()');
                                    this.buildRequest.call(context, onError, onBuildRequest);
                                }
                                run.call(context);
                                function onBuildRequest(result) {
                                    this.logger.trace('CommonService::onBuildRequest : ', result);
                                    this.callService.call(context, onError, onCallService);
                                }
                                function onCallService(result) {
                                    this.logger.trace('CommonService::onCallService : ', result);
                                    this.analyzeResponse.call(context, onError, onAnalyzeResponse);
                                }
                                function onAnalyzeResponse(result) {
                                    this.logger.trace('CommonService::onAnalyzeResponse : ', result);
                                    if (result) {
                                        this.options.onSuccess.call(this, result);
                                    } else {
                                        return onError.call(this, new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__['a']('Analyse de la reponse en échec !?'));
                                    }
                                }
                                function onError(error) {
                                    this.logger.trace('CommonService::onError()');
                                    var e = error;
                                    if (!(e instanceof __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__['a'])) {
                                        e = new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__['a'](error.message);
                                    }
                                    this.options.onFailure.call(this, e);
                                }
                            },
                            buildRequest: function (error, success) {
                                this.logger.error('overwritten method !');
                                if (error) {
                                    error.call(this, 'This method must be overwritten !');
                                }
                                success.call(this, 'This method must be overwritten !');
                            },
                            callService: function (error, success) {
                                var strUrlProxified = null;
                                var strData = this.request;
                                var bUrlProxified = !!(this.options.proxyURL && this.options.protocol === 'XHR');
                                this.options.serverUrl = __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__['a'].normalyzeUrl(this.options.serverUrl, { 'gp-access-lib': '2.0.0' }, false);
                                if (bUrlProxified) {
                                    if (this.options.httpMethod === 'GET') {
                                        strUrlProxified = this.options.proxyURL + __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__['a'].normalyzeUrl(this.options.serverUrl, this.request, true);
                                        strData = null;
                                    }
                                    if (this.options.httpMethod === 'POST') {
                                        strUrlProxified = this.options.proxyURL + __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__['a'].normalyzeUrl(this.options.serverUrl, null, true);
                                        strData = this.request;
                                    }
                                }
                                var self = this;
                                var options = {
                                    url: strUrlProxified || this.options.serverUrl,
                                    method: this.options.httpMethod,
                                    protocol: this.options.protocol,
                                    timeOut: this.options.timeOut || 0,
                                    format: this.options.outputFormat,
                                    nocache: this.options.nocache || false,
                                    wrap: this.options.protocol !== 'XHR',
                                    callbackSuffix: this.options.callbackSuffix,
                                    data: strData,
                                    headers: null,
                                    content: this.options.contentType || 'application/xml',
                                    scope: this.options.scope || this,
                                    onResponse: function (response) {
                                        self.logger.trace('callService::onResponse()');
                                        var content = null;
                                        if (self.options.protocol === 'XHR') {
                                            content = response;
                                        }
                                        if (self.options.protocol === 'JSONP') {
                                            self.logger.trace('Response JSON', response);
                                            if (response) {
                                                if (response.http) {
                                                    if (response.http.status !== 200) {
                                                        error.call(self, new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__['a']({
                                                            status: response.http.status,
                                                            message: response.http.error,
                                                            type: __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                                        }));
                                                        return;
                                                    } else {
                                                        content = response.xml;
                                                        if (self.options.rawResponse) {
                                                            content = response;
                                                        }
                                                        if (typeof self.options.onBeforeParse === 'function') {
                                                            var newResponse = self.options.onBeforeParse(content);
                                                            if (typeof newResponse === 'string') {
                                                                content = newResponse;
                                                            }
                                                        }
                                                    }
                                                } else {
                                                    content = response;
                                                }
                                            } else {
                                                error.call(self, new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__['a']('Le contenu de la reponse est vide !?'));
                                                return;
                                            }
                                        }
                                        self.response = content;
                                        success.call(self, content);
                                    },
                                    onFailure: function (e) {
                                        self.logger.trace('callService::onFailure()');
                                        e.type = __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__['a'].TYPE_SRVERR;
                                        error.call(self, new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__['a'](e));
                                    },
                                    onTimeOut: function () {
                                        self.logger.trace('callService::onTimeOut()');
                                        error.call(self, new __WEBPACK_IMPORTED_MODULE_4__Exceptions_ErrorService__['a']('TimeOut!'));
                                    }
                                };
                                __WEBPACK_IMPORTED_MODULE_3__Protocols_Protocol__['a'].send(options);
                            },
                            analyzeResponse: function (error, success) {
                                this.logger.error('overwritten method !');
                                if (error) {
                                    error.call(this, 'This method must be overwritten !');
                                }
                                success.call(this, 'This method must be overwritten !');
                            }
                        };
                        __webpack_exports__['a'] = CommonService;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var Helper = {
                            normalyzeParameters: function (params) {
                                var myParams = null;
                                if (params) {
                                    var tabParams = [];
                                    for (var key in params) {
                                        if (params.hasOwnProperty(key)) {
                                            var value = params[key];
                                            if (!value) {
                                                value = '';
                                            }
                                            tabParams.push(key + '=' + value);
                                        }
                                    }
                                    myParams = tabParams.join('&');
                                }
                                return myParams;
                            },
                            normalyzeUrl: function (url, params, encode) {
                                var myUrl = url;
                                if (url) {
                                    var k = url.indexOf('?');
                                    if (k === -1) {
                                        myUrl += '?';
                                    }
                                    if (k !== -1 && k !== url.length - 1) {
                                        myUrl += '&';
                                    }
                                }
                                if (params) {
                                    if (typeof params === 'string') {
                                        myUrl += params;
                                    } else {
                                        myUrl += this.normalyzeParameters(params);
                                    }
                                }
                                if (encode) {
                                    myUrl = encodeURIComponent(myUrl);
                                }
                                return myUrl;
                            },
                            indent: function (n, msg) {
                                var num = n || 0;
                                return new Array(num + 1).join('\t') + msg;
                            }
                        };
                        __webpack_exports__['a'] = Helper;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var ISBROWSER = typeof window !== 'undefined' ? 1 : 0;
                        var HOSTNAME = 'wxs.ign.fr';
                        var DefaultUrlService = {
                            ssl: false,
                            url: function (key, path) {
                                var _protocol = ISBROWSER ? location && location.protocol && location.protocol.indexOf('https:') === 0 ? 'https://' : 'http://' : DefaultUrlService.ssl ? 'https://' : 'http://';
                                return _protocol + HOSTNAME.concat('/', key, path);
                            },
                            Alti: {
                                _key: {
                                    'elevation-json': '/alti/rest/elevation.json',
                                    'elevation-xml': '/alti/rest/elevation.xml',
                                    'profil-json': '/alti/rest/elevationLine.json',
                                    'profil-xml': '/alti/rest/elevationLine.xml',
                                    wps: '/alti/wps'
                                },
                                url: function (key) {
                                    return {
                                        'elevation-json': DefaultUrlService.url(key, this._key['elevation-json']),
                                        'elevation-xml': DefaultUrlService.url(key, this._key['elevation-xml']),
                                        'profil-json': DefaultUrlService.url(key, this._key['profil-json']),
                                        'profil-xml': DefaultUrlService.url(key, this._key['profil-xml']),
                                        wps: DefaultUrlService.url(key, this._key['wps'])
                                    };
                                }
                            },
                            ProcessIsoCurve: {
                                _key: {
                                    'iso-json': '/isochrone/isochrone.json',
                                    'iso-xml': '/isochrone/isochrone.xml'
                                },
                                url: function (key) {
                                    return {
                                        'iso-json': DefaultUrlService.url(key, this._key['iso-json']),
                                        'iso-xml': DefaultUrlService.url(key, this._key['iso-xml'])
                                    };
                                }
                            },
                            AutoComplete: {
                                _key: '/ols/apis/completion',
                                url: function (key) {
                                    return DefaultUrlService.url(key, this._key);
                                }
                            },
                            ReverseGeocode: {
                                _key: '/geoportail/ols',
                                url: function (key) {
                                    return DefaultUrlService.url(key, this._key);
                                }
                            },
                            AutoConf: {
                                _key: {
                                    apiKey: '/autoconf',
                                    apiKeys: '/autoconf?keys=%KEYS%',
                                    aggregate: '/autoconf/id/'
                                },
                                url: function (key) {
                                    var keys = '';
                                    if (Array.isArray(key) && key.length > 0) {
                                        keys = key[0];
                                        for (var i = 1; i < key.length; i++) {
                                            keys += ',' + key[i];
                                        }
                                    }
                                    return {
                                        apiKey: DefaultUrlService.url(key, this._key['apiKey']),
                                        apiKeys: DefaultUrlService.url(key[0], this._key['apiKeys']).replace('%KEYS%', keys),
                                        aggregate: DefaultUrlService.url(key, this._key['aggregate'])
                                    };
                                }
                            },
                            Geocode: {
                                _key: '/geoportail/ols',
                                url: function (key) {
                                    return DefaultUrlService.url(key, this._key);
                                }
                            },
                            Route: {
                                _key: {
                                    ols: '/itineraire/ols',
                                    'route-json': '/itineraire/rest/route.json',
                                    'route-xml': '/itineraire/rest/route.xml'
                                },
                                url: function (key) {
                                    return {
                                        ols: DefaultUrlService.url(key, this._key['ols']),
                                        'route-json': DefaultUrlService.url(key, this._key['route-json']),
                                        'route-xml': DefaultUrlService.url(key, this._key['route-xml'])
                                    };
                                }
                            }
                        };
                        __webpack_exports__['a'] = DefaultUrlService;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function XML(options) {
                            if (!(this instanceof XML)) {
                                throw new TypeError('XML constructor cannot be called as a function.');
                            }
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur XML ()]');
                            this.xmlString = null;
                            this.xmlDoc = null;
                            this.reader = null;
                            if (options) {
                                if (options.xmlString && typeof options.xmlString === 'string') {
                                    this.xmlString = options.xmlString;
                                    this.xmlDoc = __getXMLDOC(options.xmlString);
                                }
                                if (options.reader) {
                                    this.setReader(options.reader);
                                }
                            }
                        }
                        XML.prototype = {
                            constructor: XML,
                            getXMLString: function () {
                                return this.xmlString;
                            },
                            setXMLString: function (xmlString) {
                                if (xmlString && typeof xmlString === 'string') {
                                    this.xmlString = xmlString;
                                    this.xmlDoc = __getXMLDOC(xmlString);
                                }
                            },
                            getReader: function () {
                                return this.reader;
                            },
                            setReader: function (reader) {
                                if (reader && reader.read && typeof reader.read === 'function') {
                                    this.reader = reader;
                                }
                            },
                            getXMLDoc: function () {
                                return this.xmlDoc;
                            },
                            setXMLDoc: function (doc) {
                                this.xmlDoc = doc;
                            },
                            parse: function () {
                                if (!this.xmlDoc && this.xmlString) {
                                    this.xmlDoc = __getXMLDOC(this.xmlString);
                                }
                                if (this.xmlDoc) {
                                    var root = __getRootNode(this.xmlDoc);
                                    if (root) {
                                        var parserOutput;
                                        if (this.reader && this.reader.read) {
                                            parserOutput = this.reader.read(root);
                                        } else {
                                            parserOutput = {};
                                            parserOutput[root.nodeName] = __readDefault(root);
                                        }
                                        return parserOutput;
                                    } else {
                                        return {};
                                    }
                                }
                            }
                        };
                        function __getXMLDOC(xmlString) {
                            if (typeof window === 'undefined') {
                                var DOMParser = __webpack_require__(20).DOMParser;
                                return new DOMParser().parseFromString(xmlString, 'text/xml');
                            } else {
                                var parser;
                                var xmlDoc;
                                var errorMsg = 'Erreur lors du parsing de la réponse du service : XML non conforme';
                                if (window.ActiveXObject) {
                                    xmlDoc = new window.ActiveXObject('Microsoft.XMLDOM');
                                    xmlDoc.async = false;
                                    xmlDoc.loadXML(xmlString);
                                    var parseError = xmlDoc.parseError;
                                    if (parseError.errorCode) {
                                        if (parseError.line && parseError.linepos) {
                                            errorMsg += '( ligne ' + parseError.line + ', colonne ' + parseError.linepos;
                                        }
                                        if (parseError.reason) {
                                            errorMsg += ':  ' + parseError.reason + ')';
                                        }
                                        throw new Error(errorMsg);
                                    }
                                    return xmlDoc;
                                } else if (window.DOMParser) {
                                    parser = new window.DOMParser();
                                    try {
                                        xmlDoc = parser.parseFromString(xmlString, 'text/xml');
                                    } catch (e) {
                                        if (e.message === 'SyntaxError') {
                                            throw new Error(errorMsg);
                                        } else {
                                            throw new Error('Erreur lors du parsing de la réponse du service : ' + e.message);
                                        }
                                    }
                                    if (xmlDoc.getElementsByTagName('parsererror').length > 0) {
                                        var parsererror = xmlDoc.getElementsByTagName('parsererror');
                                        for (var i = 0; i < parsererror.length; i++) {
                                            var content = parsererror[i].innerHTML;
                                            if (content.indexOf('Huge input lookup') === -1) {
                                                errorMsg += '(' + content + ')';
                                                throw new Error(errorMsg);
                                            }
                                        }
                                    } else if (!xmlDoc.documentElement) {
                                        throw new Error(errorMsg);
                                    }
                                    return xmlDoc;
                                } else {
                                    throw new Error('Incompatible DOM Parser pour ce navigateur !');
                                }
                            }
                        }
                        function __getRootNode(xmlDoc) {
                            var root;
                            if (xmlDoc.nodeType === 9) {
                                root = xmlDoc.documentElement;
                            } else if (xmlDoc.nodeType === 1) {
                                root = xmlDoc;
                            }
                            return root;
                        }
                        function __readDefault(node) {
                            var data = {};
                            if (node.attributes.length > 0) {
                                var dataAttributes = __getAttributes(node);
                                data['attributes'] = dataAttributes;
                            }
                            if (node.hasChildNodes()) {
                                var childData = {};
                                var child;
                                var children = node.childNodes;
                                for (var i = 0; i < children.length; i++) {
                                    child = children[i];
                                    if (child.nodeType === 3) {
                                        data['textContent'] = child.nodeValue;
                                    } else if (child.nodeType === 1) {
                                        childData = __readDefault(child);
                                        if (!data[child.nodeName]) {
                                            data[child.nodeName] = childData;
                                        } else {
                                            if (!Array.isArray(data[child.nodeName])) {
                                                var old = data[child.nodeName];
                                                data[child.nodeName] = [];
                                                data[child.nodeName].push(old);
                                            }
                                            data[child.nodeName].push(childData);
                                        }
                                    }
                                }
                            }
                            return data;
                        }
                        function __getAttributes(node) {
                            if (node.attributes.length > 0) {
                                var nodeAttributes = {};
                                var attributes = node.attributes;
                                for (var i = 0; i < attributes.length; i++) {
                                    var attribute = attributes[i];
                                    nodeAttributes[attribute.nodeName] = attribute.nodeValue;
                                }
                                return nodeAttributes;
                            }
                        }
                        __webpack_exports__['a'] = XML;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function GeocodeLocation() {
                            if (!(this instanceof GeocodeLocation)) {
                                throw new TypeError('GeocodeLocation constructor cannot be called as a function.');
                            }
                            this.placeAttributes = {};
                            this.attributesList = [];
                            this.serviceAttributes = [];
                        }
                        GeocodeLocation.prototype = { constructor: GeocodeLocation };
                        __webpack_exports__['a'] = GeocodeLocation;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var WKT = {
                            toJson: function (strWkt, success, error) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                                var json = null;
                                try {
                                    if (!strWkt) {
                                        throw new Error('La chaine WKT n\'est pas renseignée !');
                                    }
                                    if (!success) {
                                        success = function (json) {
                                            console.log(json);
                                        };
                                    }
                                    if (!error) {
                                        error = function (e) {
                                            console.log(e);
                                        };
                                    }
                                    var regex;
                                    var subst;
                                    regex = /(-?\d+\.?[0-9]*)\s(-?\d+\.?[0-9]+)/g;
                                    subst = '[$1,$2]';
                                    strWkt = strWkt.replace(regex, subst);
                                    regex = /^(\w+)/;
                                    regex.exec(strWkt);
                                    if (RegExp.$1 === 'POLYGON') {
                                        subst = '{"type" : "Polygon",';
                                        strWkt = strWkt.replace(RegExp.$1, subst);
                                        regex = /(\({2}?)/;
                                        subst = '"coordinates" : [[';
                                        strWkt = strWkt.replace(regex, subst);
                                        regex = /(\){2}?)/;
                                        subst = ']]}';
                                        strWkt = strWkt.replace(regex, subst);
                                        regex = /(\()/g;
                                        subst = '[';
                                        strWkt = strWkt.replace(regex, subst);
                                        regex = /(\))/g;
                                        subst = ']';
                                        strWkt = strWkt.replace(regex, subst);
                                    } else if (RegExp.$1 === 'LINESTRING') {
                                        subst = '{"type" : "LineString",';
                                        strWkt = strWkt.replace(RegExp.$1, subst);
                                        regex = /(\(\(?)/;
                                        subst = '"coordinates" : [';
                                        strWkt = strWkt.replace(regex, subst);
                                        regex = /(\)\)?)/;
                                        subst = ']}';
                                        strWkt = strWkt.replace(regex, subst);
                                    }
                                    logger.trace(strWkt);
                                    json = JSON.parse(strWkt);
                                    if (!json) {
                                        throw new Error('Le JSON est vide !');
                                    }
                                    if (!json.type) {
                                        throw new Error('Le type de geometrie n\'est pas connu !');
                                    }
                                    if (!json.coordinates) {
                                        throw new Error('La liste des points est vide !');
                                    }
                                    success.call(this, json);
                                } catch (e) {
                                    if (e.name === 'SyntaxError') {
                                        error.call(this, 'Erreur de parsing JSON !');
                                        return;
                                    }
                                    error.call(this, e);
                                }
                            }
                        };
                        __webpack_exports__['a'] = WKT;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function AltiResponse() {
                            if (!(this instanceof AltiResponse)) {
                                throw new TypeError('AltiResponse constructor cannot be called as a function.');
                            }
                            this.elevations = [];
                        }
                        AltiResponse.prototype = { constructor: AltiResponse };
                        __webpack_exports__['a'] = AltiResponse;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Elevation() {
                            if (!(this instanceof Elevation)) {
                                throw new TypeError('Elevation constructor cannot be called as a function.');
                            }
                            this.z = null;
                        }
                        Elevation.prototype = { constructor: Elevation };
                        __webpack_exports__['a'] = Elevation;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__XLS_RequestHeader__ = __webpack_require__(65);
                        var __WEBPACK_IMPORTED_MODULE_2__XLS_Request__ = __webpack_require__(66);
                        var __WEBPACK_IMPORTED_MODULE_3__XLS_AbstractService__ = __webpack_require__(12);
                        function XLS(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur XLS()]');
                            if (!(this instanceof XLS)) {
                                throw new TypeError('XLS constructor cannot be called as a function.');
                            }
                            this.options = {
                                srsName: 'EPSG:4326',
                                maximumResponses: 25
                            };
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    if (options[opt]) {
                                        this.options[opt] = options[opt];
                                    }
                                }
                            }
                        }
                        XLS.VERSION = '1.2';
                        XLS.prototype = {
                            requestString: null,
                            namespace: false,
                            oService: null,
                            constructor: XLS,
                            template: '<?xml version="1.0" encoding="UTF-8"?>\n' + '<XLS version="__VERSION__"\n' + '__NAMESPACE__ \n' + '__SCHEMALOCATION__>\n' + '__REQUESTHEADER__\n' + '__REQUEST__\n' + '</XLS>\n',
                            namespaceByDefault: function () {
                                var ns = [
                                    'xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',
                                    'xmlns:xls="http://www.opengis.net/xls"',
                                    'xmlns:gml="http://www.opengis.net/gml"'
                                ];
                                return ns.join(' ');
                            },
                            schemaLocationByDefault: function () {
                                return 'xsi:schemaLocation="http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd"';
                            },
                            setService: function (oService) {
                                if (!oService) {
                                    this.logger.trace('L\'objet de type Service XSL n\'est pas encore defini !?');
                                    return;
                                }
                                if (oService instanceof __WEBPACK_IMPORTED_MODULE_3__XLS_AbstractService__['a']) {
                                    this.oService = oService;
                                } else {
                                    this.logger.error('L\'objet n\'est pas du type \'LocationUtilityService\' ou \'RouteService\' !?');
                                }
                            },
                            getService: function () {
                                return this.oService;
                            }
                        };
                        XLS.prototype.addNamespace = function (ns, request) {
                            var keyNS = ns.key;
                            var bFound = false;
                            var allNS = this.namespaceByDefault().split(' ');
                            for (var index = 0; index < allNS.length; index++) {
                                var element = allNS[index];
                                var map = element.split('=');
                                var key = map[0];
                                if (key === 'xmlns:' + keyNS) {
                                    bFound = true;
                                    break;
                                }
                            }
                            if (!bFound) {
                                this.logger.warn('L\'ajout d\'un nouvel namespace n\'est pas encore implémenté !');
                                return request;
                            }
                            var regex;
                            var subst;
                            regex = /<(\w+[\s>])/g;
                            subst = '<' + keyNS + ':$1';
                            request = request.replace(regex, subst);
                            regex = /<\/(\w+[\s>])/g;
                            subst = '</' + keyNS + ':$1';
                            request = request.replace(regex, subst);
                            this.logger.trace('namespace', request);
                            return request;
                        };
                        XLS.prototype.build = function () {
                            var bService = !!this.getService();
                            var template = '';
                            template = this.template;
                            template = template.replace(/__VERSION__/g, XLS.VERSION);
                            template = template.replace(/__NAMESPACE__/g, this.namespaceByDefault);
                            template = template.replace(/__SCHEMALOCATION__/g, this.schemaLocationByDefault);
                            var oHeader = new __WEBPACK_IMPORTED_MODULE_1__XLS_RequestHeader__['a']({ srsName: this.options.srsName });
                            template = template.replace(/__REQUESTHEADER__/g, oHeader.toString());
                            var oRequest = new __WEBPACK_IMPORTED_MODULE_2__XLS_Request__['a']({
                                maximumResponses: this.options.maximumResponses,
                                version: XLS.VERSION,
                                methodName: bService ? this.getService().CLASSTYPE : null
                            });
                            template = template.replace(/__REQUEST__/g, oRequest.toString());
                            if (bService) {
                                template = template.replace(/<!-- __REQUESTSERVICE__ -->/g, this.getService().toString());
                            }
                            if (!template) {
                                this.logger.warn('traduction tmpl : empty request !?');
                                return;
                            }
                            if (this.namespace) {
                                template = this.addNamespace({
                                    key: 'xls',
                                    url: 'http://www.opengis.net/xls'
                                }, template);
                            }
                            this.requestString = template;
                            this.logger.trace('traduction tmpl', template);
                            return this.requestString;
                        };
                        __webpack_exports__['a'] = XLS;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function AbstractService(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur AbstractService ()]');
                            if (!(this instanceof AbstractService)) {
                                throw new TypeError('AbstractService constructor cannot be called as a function.');
                            }
                            this.options = options || {};
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    this.options[opt] = options[opt];
                                }
                            }
                        }
                        AbstractService.prototype = {
                            strRequest: null,
                            oRequest: null,
                            oFilter: null,
                            constructor: AbstractService,
                            addRequest: function (oRequest) {
                                this.logger.error('overwritten method !');
                            },
                            addFilter: function (oFilter) {
                                this.logger.error('overwritten method !');
                            },
                            toString: function () {
                                this.logger.error('overwritten method !');
                            }
                        };
                        __webpack_exports__['a'] = AbstractService;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function GeocodeFilterExtension() {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('GeocodeFilterExtension');
                            this.logger.trace('[Constructeur GeocodeFilterExtension ()]');
                            if (!(this instanceof GeocodeFilterExtension)) {
                                throw new TypeError('GeocodeFilterExtension constructor cannot be called as a function.');
                            }
                            this.filters = [];
                        }
                        GeocodeFilterExtension.prototype = {
                            constructor: GeocodeFilterExtension,
                            addFilterExtensions: function (oGeocodeLocation) {
                                if (oGeocodeLocation) {
                                    this.filters.push(oGeocodeLocation);
                                }
                            },
                            getNames: function () {
                                var names = [];
                                for (var idx in this.filters) {
                                    names.push(this.filters[idx].CLASSNAME);
                                }
                                this.logger.trace(names);
                                return names;
                            },
                            getFilter: function (name) {
                                var filter = null;
                                for (var idx in this.filters) {
                                    if (this.filters[idx].CLASSNAME === name) {
                                        filter = this.filters[idx];
                                    }
                                }
                                this.logger.trace(filter);
                                return filter;
                            },
                            getFilters: function () {
                                this.logger.trace(this.filters);
                                return this.filters;
                            },
                            getAttributs: function (name) {
                                var attributs = [];
                                for (var idx in this.filters) {
                                    if (this.filters[idx].CLASSNAME === name) {
                                        attributs = this.filters[idx].attributesList;
                                    }
                                }
                                this.logger.trace(attributs);
                                return attributs;
                            },
                            setPlaceAttributs: function (name, options) {
                                var filter = this.getFilter(name);
                                var attributs = this.getAttributs(name);
                                for (var idx in attributs) {
                                    var value = attributs[idx];
                                    if (options[value]) {
                                        filter.placeAttributes[value] = options[value];
                                    }
                                }
                            },
                            getPlaceAttributs: function (name) {
                                var places = {};
                                for (var idx in this.filters) {
                                    if (this.filters[idx].CLASSNAME === name) {
                                        places = this.filters[idx].placeAttributes;
                                    }
                                }
                                this.logger.trace(places);
                                return places;
                            }
                        };
                        __webpack_exports__['a'] = GeocodeFilterExtension;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function GeocodeResponse() {
                            if (!(this instanceof GeocodeResponse)) {
                                throw new TypeError('GeocodeResponse constructor cannot be called as a function.');
                            }
                            this.locations = [];
                        }
                        GeocodeResponse.prototype = { constructor: GeocodeResponse };
                        __webpack_exports__['a'] = GeocodeResponse;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function GeocodedLocation() {
                            if (!(this instanceof GeocodedLocation)) {
                                throw new TypeError('GeocodedLocation constructor cannot be called as a function.');
                            }
                            this.position = {
                                x: null,
                                y: null
                            };
                            this.matchType = null;
                            this.placeAttributes = {};
                            this.type = null;
                        }
                        GeocodedLocation.prototype = { constructor: GeocodedLocation };
                        __webpack_exports__['a'] = GeocodedLocation;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function RouteResponse() {
                            if (!(this instanceof RouteResponse)) {
                                throw new TypeError('RouteResponse constructor cannot be called as a function.');
                            }
                            this.totalTime = null;
                            this.totalDistance = null;
                            this.bbox = {
                                left: null,
                                right: null,
                                top: null,
                                bottom: null
                            };
                            this.routeGeometry = null;
                            this.routeInstructions = [];
                        }
                        RouteResponse.prototype = { constructor: RouteResponse };
                        __webpack_exports__['a'] = RouteResponse;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function RouteInstruction() {
                            if (!(this instanceof RouteInstruction)) {
                                throw new TypeError('RouteInstruction constructor cannot be called as a function.');
                            }
                            this.duration = null;
                            this.distance = null;
                            this.code = null;
                            this.instruction = null;
                            this.geometry = null;
                        }
                        RouteInstruction.prototype = { constructor: RouteInstruction };
                        __webpack_exports__['a'] = RouteInstruction;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function ProcessIsoCurveResponse() {
                            if (!(this instanceof ProcessIsoCurveResponse)) {
                                throw new TypeError('ProcessIsoCurveResponse constructor cannot be called as a function.');
                            }
                            this.message = null;
                            this.id = null;
                            this.location = {};
                            this.location.x = null;
                            this.location.y = null;
                            this.srs = null;
                            this.geometry = null;
                            this.time = null;
                            this.distance = null;
                        }
                        ProcessIsoCurveResponse.prototype = { constructor: ProcessIsoCurveResponse };
                        __webpack_exports__['a'] = ProcessIsoCurveResponse;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__ = __webpack_require__(4);
                        var __WEBPACK_IMPORTED_MODULE_2_es6_promise__ = __webpack_require__(49);
                        var __WEBPACK_IMPORTED_MODULE_2_es6_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_es6_promise__);
                        var XHR = {
                            call: function (settings) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('XHR');
                                logger.trace('[XHR::call()]');
                                __WEBPACK_IMPORTED_MODULE_2_es6_promise___default.a.polyfill();
                                if (!settings.url) {
                                    throw new Error('missing parameter : url is not defined !');
                                }
                                if (!settings.method) {
                                    throw new Error('missing parameter : method is not defined !');
                                }
                                if (!settings.format) {
                                    settings.format = 'text';
                                }
                                var options = {};
                                options.url = settings.url;
                                options.data = settings.data ? settings.data : null;
                                options.method = settings.method;
                                options.timeOut = settings.timeOut || 0;
                                options.scope = settings.scope || this;
                                options.proxy = settings.proxy || null;
                                options.content = settings.content || null;
                                options.headers = settings.headers || { referer: 'http://localhost' };
                                switch (settings.method) {
                                case 'DELETE':
                                case 'GET':
                                    break;
                                case 'PUT':
                                case 'POST':
                                    options.content = settings.content ? settings.content : 'application/x-www-form-urlencoded';
                                    options.headers = settings.headers ? settings.headers : { referer: 'http://localhost' };
                                    break;
                                case 'HEAD':
                                case 'OPTIONS':
                                    throw new Error('HTTP method not yet supported !');
                                default:
                                    throw new Error('HTTP method unknown !');
                                }
                                switch (settings.format) {
                                case 'text':
                                    this.__call(options).then(function (response) {
                                        logger.trace(response);
                                        settings.onResponse.call(this, response);
                                    }).catch(function (error) {
                                        settings.onFailure.call(this, error);
                                    });
                                    break;
                                case 'json':
                                    this.__callJSON(options).then(function (response) {
                                        logger.trace(response);
                                        settings.onResponse.call(this, response);
                                    }).catch(function (error) {
                                        settings.onFailure.call(this, error);
                                    });
                                    break;
                                case 'xml':
                                    this.__callXML(options).then(function (response) {
                                        logger.trace(response);
                                        settings.onResponse.call(this, response);
                                    }).catch(function (error) {
                                        settings.onFailure.call(this, error);
                                    });
                                    break;
                                default:
                                    throw new Error('This output Format is not yet supported !');
                                }
                            },
                            __call: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('XHR');
                                logger.trace('[XHR::__call()]');
                                var promise = new Promise(function (resolve, reject) {
                                    var corps = options.method === 'POST' || options.method === 'PUT' ? 1 : 0;
                                    if (options.data && (typeof options.data === 'object' && Object.keys(options.data).length || typeof options.data === 'string' && options.data.length) && !corps) {
                                        options.url = __WEBPACK_IMPORTED_MODULE_1__Utils_Helper__['a'].normalyzeUrl(options.url, options.data);
                                    }
                                    logger.trace('URL = ', options.url);
                                    var hXHR = null;
                                    if (typeof window === 'undefined') {
                                        var req = __webpack_require__(52);
                                        if (options.data && typeof options.data === 'string' && corps) {
                                            options.body = options.data;
                                        }
                                        options.rejectUnauthorized = false;
                                        req(options, function (error, response, body) {
                                            if (!error && response.statusCode === 200 && body) {
                                                resolve(body);
                                            } else {
                                                reject('Errors Occured on Http Request (nodejs) : ' + error);
                                            }
                                        });
                                    } else {
                                        if (window.XMLHttpRequest) {
                                            logger.trace('XMLHttpRequest');
                                            hXHR = new XMLHttpRequest();
                                            hXHR.open(options.method, options.url, true);
                                            hXHR.overrideMimeType = options.content;
                                            var onTimeOutTrigger = null;
                                            if (options.timeOut > 0) {
                                                logger.trace('XHR - TimeOut actif !');
                                                onTimeOutTrigger = window.setTimeout(function () {
                                                    var message = 'TimeOut Occured on Http Request with XMLHttpRequest !';
                                                    reject({
                                                        message: message,
                                                        status: -1
                                                    });
                                                }, options.timeOut);
                                            }
                                            if (corps) {
                                                logger.trace('data = ', options.data);
                                                hXHR.setRequestHeader('Content-type', options.content);
                                            }
                                            hXHR.onerror = function (e) {
                                                console.log(e);
                                                reject(new Error('Errors Occured on Http Request with XMLHttpRequest !'));
                                            };
                                            hXHR.ontimeout = function () {
                                                reject(new Error('TimeOut Occured on Http Request with XMLHttpRequest !'));
                                            };
                                            hXHR.onreadystatechange = function () {
                                                if (hXHR.readyState === 4) {
                                                    if (hXHR.status === 200) {
                                                        window.clearTimeout(onTimeOutTrigger);
                                                        resolve(hXHR.response);
                                                    } else {
                                                        var message = 'Errors Occured on Http Request (status : \'' + hXHR.status + '\' | response : \'' + hXHR.response + '\')';
                                                        var status = hXHR.status;
                                                        reject({
                                                            message: message,
                                                            status: status
                                                        });
                                                    }
                                                }
                                            };
                                            var data4xhr = options.data && corps ? options.data : null;
                                            hXHR.send(data4xhr);
                                        } else if (window.XDomainRequest) {
                                            logger.trace('XDomainRequest');
                                            hXHR = new XDomainRequest();
                                            hXHR.open(options.method, options.url);
                                            hXHR.overrideMimeType = options.content;
                                            if (options.timeOut > 0) {
                                                hXHR.timeout = options.timeout;
                                                logger.trace('XHR - TimeOut actif !');
                                            }
                                            if (corps) {
                                                hXHR.setRequestHeader('Content-type', options.content);
                                            }
                                            hXHR.onerror = function () {
                                                reject(new Error('Errors Occured on Http Request with XMLHttpRequest !'));
                                            };
                                            hXHR.ontimeout = function () {
                                                reject(new Error('TimeOut Occured on Http Request with XMLHttpRequest !'));
                                            };
                                            hXHR.onload = function () {
                                                if (hXHR.status === 200) {
                                                    resolve(hXHR.responseText);
                                                } else {
                                                    var message = 'Errors Occured on Http Request (status : \'' + hXHR.status + '\' | response : \'' + hXHR.responseText + '\')';
                                                    var status = hXHR.status;
                                                    reject({
                                                        message: message,
                                                        status: status
                                                    });
                                                }
                                            };
                                            var data4xdr = options.data && corps ? options.data : null;
                                            hXHR.send(data4xdr);
                                        } else {
                                            throw new Error('CORS not supported');
                                        }
                                    }
                                });
                                return promise;
                            },
                            __callJSON: function (options) {
                                return this.__call(options).then(JSON.parse).catch(function (error) {
                                    console.log('_callJSON failed on : ', options.url, error);
                                });
                            },
                            __callXML: function (options) {
                                return this.__call(options).then(function (response) {
                                    var xmlDoc;
                                    if (typeof window === 'undefined') {
                                        var DOMParser = __webpack_require__(20).DOMParser;
                                        xmlDoc = new DOMParser().parseFromString(response, 'text/xml');
                                    } else {
                                        if (window.DOMParser) {
                                            var parser = new window.DOMParser();
                                            xmlDoc = parser.parseFromString(response, 'text/xml');
                                        } else {
                                            xmlDoc = new window.ActiveXObject('Microsoft.XMLDOM');
                                            xmlDoc.async = false;
                                            xmlDoc.loadXML(response);
                                        }
                                    }
                                    return xmlDoc;
                                }).catch(function (error) {
                                    console.log('__callXML failed on : ', options.url, error);
                                });
                            }
                        };
                        __webpack_exports__['a'] = XHR;
                    },
                    function (module, exports) {
                        module.exports = __WEBPACK_EXTERNAL_MODULE_20__;
                        return exports;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__AltiRequest__ = __webpack_require__(22);
                        function AltiElevationRequest(options) {
                            if (!(this instanceof AltiElevationRequest)) {
                                throw new TypeError('AltiElevationRequest constructor cannot be called as a function.');
                            }
                            this.CLASSNAME = 'AltiElevationRequest';
                            __WEBPACK_IMPORTED_MODULE_1__AltiRequest__['a'].apply(this, arguments);
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur AltiElevationRequest ()]');
                            this.zonly = this.options.zonly || false;
                        }
                        AltiElevationRequest.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__AltiRequest__['a'].prototype, {
                            zonly: {
                                get: function () {
                                    return this._zonly;
                                },
                                set: function (z) {
                                    this._zonly = z;
                                }
                            }
                        });
                        AltiElevationRequest.prototype.constructor = AltiElevationRequest;
                        AltiElevationRequest.prototype.getData = function () {
                            var map = [];
                            map.push({
                                k: 'lon',
                                v: this.getLon()
                            });
                            map.push({
                                k: 'lat',
                                v: this.getLat()
                            });
                            map.push({
                                k: 'indent',
                                v: this.indent
                            });
                            map.push({
                                k: 'crs',
                                v: this.crs
                            });
                            map.push({
                                k: 'zonly',
                                v: this.zonly
                            });
                            map.push({
                                k: 'format',
                                v: this.format
                            });
                            return map;
                        };
                        __webpack_exports__['a'] = AltiElevationRequest;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function AltiRequest(options) {
                            if (!(this instanceof AltiRequest)) {
                                throw new TypeError('AltiRequest constructor cannot be called as a function.');
                            }
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur AltiRequest ()]');
                            this.options = options || {};
                            this.positions = this.options.positions || [];
                            this.delimiter = this.options.delimiter || '|';
                            this.indent = this.options.indent || false;
                            this.crs = this.options.crs || 'CRS:84';
                            this.format = this.options.format || 'json';
                        }
                        AltiRequest.CLASSNAME = 'AltiRequest';
                        AltiRequest.prototype = {
                            constructor: AltiRequest,
                            setPositions: function (lstPosition) {
                                var positions = [];
                                for (var i = 0; i < lstPosition.length; i++) {
                                    var o = lstPosition[i];
                                    if (o.lon && o.lat) {
                                        positions.push(o);
                                    }
                                }
                                this.positions = positions;
                            },
                            getPositions: function (pos) {
                                if (!pos) {
                                    return this.positions;
                                }
                                var index = this.positions.length - 1;
                                if (pos > index || pos < index) {
                                    this.logger.warn('index out of range !');
                                    return this.positions;
                                }
                                return this.positions[pos];
                            },
                            addPositions: function (lstPosition) {
                                for (var i = 0; i < lstPosition.length; i++) {
                                    var o = lstPosition[i];
                                    if (o.lon && o.lat) {
                                        this.positions.push(lstPosition[i]);
                                    }
                                }
                            },
                            getLon: function () {
                                var lstLon = [];
                                for (var i = 0; i < this.positions.length; i++) {
                                    lstLon.push(this.positions[i].lon);
                                }
                                this.logger.trace(lstLon);
                                return lstLon.join(this.delimiter);
                            },
                            getLat: function () {
                                var lstLat = [];
                                for (var i = 0; i < this.positions.length; i++) {
                                    lstLat.push(this.positions[i].lat);
                                }
                                this.logger.trace(lstLat);
                                return lstLat.join(this.delimiter);
                            }
                        };
                        AltiRequest.prototype.getData = function () {
                            var map = [];
                            map.push({
                                k: 'lon',
                                v: this.getLon()
                            });
                            map.push({
                                k: 'lat',
                                v: this.getLat()
                            });
                            map.push({
                                k: 'delimiter',
                                v: this.delimiter
                            });
                            map.push({
                                k: 'indent',
                                v: this.indent
                            });
                            map.push({
                                k: 'crs',
                                v: this.crs
                            });
                            map.push({
                                k: 'format',
                                v: this.format
                            });
                            return map;
                        };
                        __webpack_exports__['a'] = AltiRequest;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__AltiRequest__ = __webpack_require__(22);
                        function AltiProfilRequest(options) {
                            if (!(this instanceof AltiProfilRequest)) {
                                throw new TypeError('AltiProfilRequest constructor cannot be called as a function.');
                            }
                            this.CLASSNAME = 'AltiProfilRequest';
                            __WEBPACK_IMPORTED_MODULE_1__AltiRequest__['a'].apply(this, arguments);
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur AltiProfilRequest ()]');
                            this.sampling = this.options.sampling || 3;
                        }
                        AltiProfilRequest.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__AltiRequest__['a'].prototype, {
                            sampling: {
                                get: function () {
                                    return this._sampling;
                                },
                                set: function (value) {
                                    this._sampling = value;
                                }
                            }
                        });
                        AltiProfilRequest.prototype.constructor = AltiProfilRequest;
                        AltiProfilRequest.prototype.getData = function () {
                            var map = [];
                            map.push({
                                k: 'lon',
                                v: this.getLon()
                            });
                            map.push({
                                k: 'lat',
                                v: this.getLat()
                            });
                            map.push({
                                k: 'indent',
                                v: this.indent
                            });
                            map.push({
                                k: 'crs',
                                v: this.crs
                            });
                            map.push({
                                k: 'sampling',
                                v: this.sampling
                            });
                            map.push({
                                k: 'format',
                                v: this.format
                            });
                            return map;
                        };
                        __webpack_exports__['a'] = AltiProfilRequest;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function AutoConfResponse() {
                            if (!(this instanceof AutoConfResponse)) {
                                throw new TypeError('AutoConfResponse constructor cannot be called as a function.');
                            }
                            this.generalOptions = {
                                apiKeys: {},
                                title: null,
                                defaultGMLGFIStyle: null,
                                theme: null,
                                wgs84Resolutions: []
                            };
                            this.layers = {};
                            this.territories = {};
                            this.tileMatrixSets = {};
                            this.services = {};
                        }
                        AutoConfResponse.prototype = {
                            constructor: AutoConfResponse,
                            isConfLoaded: function (apiKey) {
                                if (!apiKey) {
                                    return;
                                }
                                if (this.generalOptions.apiKeys[apiKey]) {
                                    return true;
                                }
                                return false;
                            },
                            getLayersId: function (apiKey) {
                                return this.generalOptions.apiKeys[apiKey];
                            },
                            getLayersConf: function (apiKey) {
                                var layers = {};
                                var layersIdArray = this.getLayersId(apiKey);
                                if (layersIdArray) {
                                    for (var i = 0; i < layersIdArray.length; i++) {
                                        var lyrId = layersIdArray[i];
                                        layers[lyrId] = this.layers[lyrId];
                                    }
                                }
                                return layers;
                            },
                            getLayerConf: function (layerId) {
                                if (!this.layers) {
                                    return;
                                }
                                return this.layers[layerId];
                            },
                            getTileMatrixSets: function () {
                                return this.tileMatrixSets;
                            },
                            getTMSConf: function (tmsID) {
                                if (!this.tileMatrixSets) {
                                    return;
                                }
                                return this.tileMatrixSets[tmsID];
                            },
                            getTerritories: function () {
                                return this.territories;
                            },
                            getTerritoryConf: function (territoryID) {
                                if (!this.territories) {
                                    return;
                                }
                                return this.territories[territoryID];
                            },
                            getServices: function () {
                                return this.services;
                            },
                            getServiceConf: function (serviceID) {
                                if (!this.services) {
                                    return;
                                }
                                return this.services[serviceID];
                            }
                        };
                        __webpack_exports__['a'] = AutoConfResponse;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Constraint() {
                            if (!(this instanceof Constraint)) {
                                throw new TypeError('Constraint constructor cannot be called as a function.');
                            }
                            this.crs = null;
                            this.bbox = {
                                left: null,
                                right: null,
                                top: null,
                                bottom: null
                            };
                            this.minScaleDenominator = null;
                            this.maxScaleDenominator = null;
                            this.temporalExtent = [
                                null,
                                null
                            ];
                        }
                        Constraint.prototype = { constructor: Constraint };
                        __webpack_exports__['a'] = Constraint;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Format() {
                            if (!(this instanceof Format)) {
                                throw new TypeError('Format constructor cannot be called as a function.');
                            }
                            this.current = null;
                            this.name = null;
                        }
                        Format.prototype = { constructor: Format };
                        __webpack_exports__['a'] = Format;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Layer() {
                            if (!(this instanceof Layer)) {
                                throw new TypeError('Layer constructor cannot be called as a function.');
                            }
                        }
                        Layer.prototype = {
                            constructor: Layer,
                            getName: function () {
                                return this.name;
                            },
                            getTitle: function () {
                                return this.title;
                            },
                            getDescription: function () {
                                return this.description;
                            },
                            getLayerId: function () {
                                return this.layerId;
                            },
                            getQuicklookUrl: function () {
                                return this.quicklookUrl;
                            },
                            getDefaultProjection: function () {
                                return this.defaultProjection;
                            },
                            getProjections: function () {
                                var projections = [];
                                projections.push(this.defaultProjection);
                                var proj = projections.concat(this.additionalProjections);
                                return proj;
                            },
                            getBBOX: function () {
                                if (!this.globalConstraint) {
                                    return;
                                }
                                return this.globalConstraint.bbox;
                            },
                            getMinScaleDenominator: function () {
                                if (!this.globalConstraint) {
                                    return;
                                }
                                return this.globalConstraint.minScaleDenominator;
                            },
                            getMaxScaleDenominator: function () {
                                if (!this.globalConstraint) {
                                    return;
                                }
                                return this.globalConstraint.maxScaleDenominator;
                            },
                            getTMSID: function () {
                                if (this.wmtsOptions) {
                                    return this.wmtsOptions.tileMatrixSetLink;
                                }
                            },
                            getServiceParams: function () {
                                return this.serviceParams;
                            },
                            getServerUrl: function (apiKey) {
                                if (!apiKey || !this.serviceParams || !this.serviceParams.serverUrl) {
                                    return;
                                }
                                return this.serviceParams.serverUrl[apiKey];
                            },
                            getLegends: function () {
                                return this.legends;
                            },
                            getMetadata: function () {
                                return this.metadata;
                            },
                            getStyles: function () {
                                return this.styles;
                            },
                            getDefaultStyle: function () {
                                if (!this.styles) {
                                    return;
                                }
                                var style;
                                var s = this.styles;
                                for (var i = 0; i < s.length; i++) {
                                    if (s[i].current === true) {
                                        style = s[i].name;
                                        break;
                                    }
                                }
                                return style;
                            },
                            getThematics: function () {
                                return this.thematics;
                            },
                            getDefaultFormat: function () {
                                if (!this.formats) {
                                    return;
                                }
                                var format;
                                var f = this.formats;
                                for (var i = 0; i < f.length; i++) {
                                    if (f[i].current === true) {
                                        format = f[i].name;
                                        break;
                                    }
                                }
                                return format;
                            },
                            getConstraints: function () {
                                return this.constraints;
                            },
                            getOriginators: function () {
                                return this.originators;
                            },
                            getDimensions: function () {
                                return this.dimensions;
                            },
                            getAggregatedLayers: function () {
                                if (this.isAggregate) {
                                    return this.aggregatedLayers;
                                } else {
                                }
                            }
                        };
                        __webpack_exports__['a'] = Layer;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Legend() {
                            if (!(this instanceof Legend)) {
                                throw new TypeError('Legend constructor cannot be called as a function.');
                            }
                            this.format = null;
                            this.url = null;
                            this.minScaleDenominator = null;
                        }
                        Legend.prototype = { constructor: Legend };
                        __webpack_exports__['a'] = Legend;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Metadata() {
                            if (!(this instanceof Metadata)) {
                                throw new TypeError('Metadata constructor cannot be called as a function.');
                            }
                            this.format = null;
                            this.url = null;
                        }
                        Metadata.prototype = { constructor: Metadata };
                        __webpack_exports__['a'] = Metadata;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Originator() {
                            if (!(this instanceof Originator)) {
                                throw new TypeError('Originator constructor cannot be called as a function.');
                            }
                            this.name = null;
                            this.attribution = null;
                            this.logo = null;
                            this.url = null;
                            this.constraints = [];
                        }
                        Originator.prototype = { constructor: Originator };
                        __webpack_exports__['a'] = Originator;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Service() {
                            if (!(this instanceof Service)) {
                                throw new TypeError('Service constructor cannot be called as a function.');
                            }
                            this.title = null;
                            this.serverUrl = null;
                            this.version = null;
                        }
                        Service.prototype = { constructor: Service };
                        __webpack_exports__['a'] = Service;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Style() {
                            if (!(this instanceof Style)) {
                                throw new TypeError('Style constructor cannot be called as a function.');
                            }
                            this.name = null;
                            this.title = null;
                            this.current = null;
                        }
                        Style.prototype = { constructor: Style };
                        __webpack_exports__['a'] = Style;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Territory() {
                            if (!(this instanceof Territory)) {
                                throw new TypeError('Territory constructor cannot be called as a function.');
                            }
                            this.isDefault = null;
                            this.defaultCRS = null;
                            this.additionalCRS = [];
                            this.geoBBOX = {
                                left: null,
                                right: null,
                                top: null,
                                bottom: null
                            };
                            this.geoCenter = {
                                lon: null,
                                lat: null
                            };
                            this.defaultOptions = {
                                resolution: null,
                                minScaleDenominator: null,
                                maxScaleDenominator: null
                            };
                            this.defaultLayers = [];
                        }
                        Territory.prototype = { constructor: Territory };
                        __webpack_exports__['a'] = Territory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function Thematic() {
                            if (!(this instanceof Thematic)) {
                                throw new TypeError('Thematic constructor cannot be called as a function.');
                            }
                            this.inspire = null;
                            this.name = null;
                        }
                        Thematic.prototype = { constructor: Thematic };
                        __webpack_exports__['a'] = Thematic;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function TileMatrixSet() {
                            if (!(this instanceof TileMatrixSet)) {
                                throw new TypeError('TileMatrixSet constructor cannot be called as a function.');
                            }
                            this.projection = null;
                            this.nativeResolutions = [];
                            this.matrixIds = [];
                            this.tileMatrices = {};
                        }
                        TileMatrixSet.prototype = {
                            constructor: TileMatrixSet,
                            getResolutions: function () {
                                return this.nativeResolutions;
                            },
                            getMatrixIds: function () {
                                return this.matrixIds;
                            },
                            getProjection: function () {
                                return this.projection;
                            },
                            getTileMatrices: function () {
                                return this.tileMatrices;
                            },
                            getTopLeftCorner: function () {
                                var topLeftCorner;
                                var matrices = this.getTileMatrices();
                                if (matrices) {
                                    for (var id in matrices) {
                                        if (matrices.hasOwnProperty(id)) {
                                            topLeftCorner = matrices[id].topLeftCorner;
                                            break;
                                        }
                                    }
                                }
                                return topLeftCorner;
                            }
                        };
                        __webpack_exports__['a'] = TileMatrixSet;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function TileMatrix() {
                            if (!(this instanceof TileMatrix)) {
                                throw new TypeError('TileMatrix constructor cannot be called as a function.');
                            }
                            this.matrixId = null;
                            this.matrixHeight = null;
                            this.matrixWidth = null;
                            this.scaleDenominator = null;
                            this.tileHeight = null;
                            this.tileWidth = null;
                            this.topLeftCorner = null;
                        }
                        TileMatrix.prototype = {
                            constructor: TileMatrix,
                            getTopLeftCorner: function () {
                                return this.topLeftCorner;
                            },
                            getScaleDenominator: function () {
                                return this.scaleDenominator;
                            },
                            getTileHeight: function () {
                                return this.tileHeight;
                            },
                            getTileWidth: function () {
                                return this.tileWidth;
                            },
                            getMatrixHeight: function () {
                                return this.matrixHeight;
                            },
                            getMatrixWidth: function () {
                                return this.matrixWidth;
                            }
                        };
                        __webpack_exports__['a'] = TileMatrix;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function TileMatrixLimit() {
                            if (!(this instanceof TileMatrixLimit)) {
                                throw new TypeError('TileMatrixLimit constructor cannot be called as a function.');
                            }
                            this.minTileRow = null;
                            this.maxTileRow = null;
                            this.minTileCol = null;
                            this.maxTileCol = null;
                        }
                        TileMatrixLimit.prototype = { constructor: TileMatrixLimit };
                        __webpack_exports__['a'] = TileMatrixLimit;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__AbstractService__ = __webpack_require__(12);
                        var __WEBPACK_IMPORTED_MODULE_2__LocationUtilityService_GeocodeRequest__ = __webpack_require__(67);
                        var __WEBPACK_IMPORTED_MODULE_3__LocationUtilityService_ReverseGeocodeRequest__ = __webpack_require__(69);
                        var __WEBPACK_IMPORTED_MODULE_4__LocationUtilityService_GeocodeFilterExtension__ = __webpack_require__(13);
                        function LocationUtilityService(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur LocationUtilityService ()]');
                            if (!(this instanceof LocationUtilityService)) {
                                throw new TypeError('LocationUtilityService constructor cannot be called as a function.');
                            }
                            this.CLASSNAME = 'LocationUtilityService';
                            this.CLASSTYPE = null;
                            __WEBPACK_IMPORTED_MODULE_1__AbstractService__['a'].apply(this, arguments);
                            if (this.options) {
                                this.CLASSTYPE = this.options.location ? 'GeocodeRequest' : this.options.position ? 'ReverseGeocodeRequest' : null;
                            }
                        }
                        LocationUtilityService.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__AbstractService__['a'].prototype, {});
                        LocationUtilityService.prototype.constructor = LocationUtilityService;
                        LocationUtilityService.prototype.addRequest = function (oLUSRequest) {
                            this.CLASSTYPE = oLUSRequest.CLASSNAME;
                            switch (this.CLASSTYPE) {
                            case 'GeocodeRequest':
                            case 'ReverseGeocodeRequest':
                                this.oRequest = oLUSRequest;
                                break;
                            default:
                                throw new Error('Ce n\'est pas un objet de type \'LUS Request\' !?');
                            }
                        };
                        LocationUtilityService.prototype.addFilter = function (oFilter) {
                            if (oFilter instanceof __WEBPACK_IMPORTED_MODULE_4__LocationUtilityService_GeocodeFilterExtension__['a']) {
                                this.oFilter = oFilter;
                            }
                        };
                        LocationUtilityService.prototype.toString = function () {
                            if (!this.oRequest) {
                                if (!this.options) {
                                    throw new Error('Les options ne sont pas renseignées, impossible de construire la requête !');
                                }
                                if (this.CLASSTYPE === 'GeocodeRequest') {
                                    var settingsDirect = {
                                        location: this.options.location,
                                        returnFreeForm: this.options.returnFreeForm,
                                        filterOptions: this.options.filterOptions || {}
                                    };
                                    this.oRequest = new __WEBPACK_IMPORTED_MODULE_2__LocationUtilityService_GeocodeRequest__['a'](settingsDirect);
                                    if (this.oFilter) {
                                        this.oRequest.addFilter(this.oFilter);
                                    }
                                } else if (this.CLASSTYPE === 'ReverseGeocodeRequest') {
                                    var settingsInv = {
                                        position: this.options.position,
                                        returnFreeForm: this.options.returnFreeForm,
                                        filterOptions: this.options.filterOptions || {}
                                    };
                                    this.oRequest = new __WEBPACK_IMPORTED_MODULE_3__LocationUtilityService_ReverseGeocodeRequest__['a'](settingsInv);
                                } else {
                                    this.logger.error('impossible de determiner le type de geocodage : Direct ou Inverse !?');
                                }
                            }
                            if (!this.oRequest) {
                                throw new Error('Type de Geocodage indefini !');
                            }
                            this.strRequest = this.oRequest.toString();
                            return this.strRequest;
                        };
                        __webpack_exports__['a'] = LocationUtilityService;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__ = __webpack_require__(15);
                        function DirectGeocodedLocation() {
                            if (!(this instanceof DirectGeocodedLocation)) {
                                throw new TypeError('DirectGeocodedLocation constructor cannot be called as a function.');
                            }
                            __WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__['a'].apply(this, arguments);
                            this.CLASSNAME = 'DirectGeocodedLocation';
                            this.accuracy = null;
                        }
                        DirectGeocodedLocation.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__['a'].prototype);
                        DirectGeocodedLocation.prototype.constructor = DirectGeocodedLocation;
                        __webpack_exports__['a'] = DirectGeocodedLocation;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__ = __webpack_require__(15);
                        function ReverseGeocodedLocation() {
                            if (!(this instanceof ReverseGeocodedLocation)) {
                                throw new TypeError('ReverseGeocodedLocation constructor cannot be called as a function.');
                            }
                            __WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__['a'].apply(this, arguments);
                            this.CLASSNAME = 'ReverseGeocodedLocation';
                            this.searchCenterDistance = null;
                        }
                        ReverseGeocodedLocation.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodedLocation__['a'].prototype);
                        ReverseGeocodedLocation.prototype.constructor = ReverseGeocodedLocation;
                        __webpack_exports__['a'] = ReverseGeocodedLocation;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function AutoCompleteResponse() {
                            if (!(this instanceof AutoCompleteResponse)) {
                                throw new TypeError('AutoCompleteResponse constructor cannot be called as a function.');
                            }
                            this.suggestedLocations = [];
                        }
                        AutoCompleteResponse.prototype = { constructor: AutoCompleteResponse };
                        __webpack_exports__['a'] = AutoCompleteResponse;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        function SuggestedLocation() {
                            if (!(this instanceof SuggestedLocation)) {
                                throw new TypeError('SuggestedLocation constructor cannot be called as a function.');
                            }
                            this.type = null;
                            this.position = {
                                x: null,
                                y: null
                            };
                            this.commune = null;
                            this.fullText = null;
                            this.postalCode = null;
                            this.classification = null;
                            this.street = null;
                            this.poi = null;
                            this.kind = null;
                        }
                        SuggestedLocation.prototype = { constructor: SuggestedLocation };
                        __webpack_exports__['a'] = SuggestedLocation;
                    },
                    function (module, exports, __webpack_require__) {
                        module.exports = __webpack_require__(44);
                        return exports;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        Object.defineProperty(__webpack_exports__, '__esModule', { value: true });
                        var __WEBPACK_IMPORTED_MODULE_0__Services_Services__ = __webpack_require__(45);
                        var __WEBPACK_IMPORTED_MODULE_1__Services_DefaultUrlService__ = __webpack_require__(5);
                        var __WEBPACK_IMPORTED_MODULE_2__Services_Alti_Response_model_AltiResponse__ = __webpack_require__(9);
                        var __WEBPACK_IMPORTED_MODULE_3__Services_Alti_Response_model_Elevation__ = __webpack_require__(10);
                        var __WEBPACK_IMPORTED_MODULE_4__Services_AutoComplete_Response_model_AutoCompleteResponse__ = __webpack_require__(41);
                        var __WEBPACK_IMPORTED_MODULE_5__Services_AutoComplete_Response_model_SuggestedLocation__ = __webpack_require__(42);
                        var __WEBPACK_IMPORTED_MODULE_6__Services_AutoConf_Response_model_AutoConfResponse__ = __webpack_require__(24);
                        var __WEBPACK_IMPORTED_MODULE_7__Services_AutoConf_Response_model_Constraint__ = __webpack_require__(25);
                        var __WEBPACK_IMPORTED_MODULE_8__Services_AutoConf_Response_model_Format__ = __webpack_require__(26);
                        var __WEBPACK_IMPORTED_MODULE_9__Services_AutoConf_Response_model_Layer__ = __webpack_require__(27);
                        var __WEBPACK_IMPORTED_MODULE_10__Services_AutoConf_Response_model_Legend__ = __webpack_require__(28);
                        var __WEBPACK_IMPORTED_MODULE_11__Services_AutoConf_Response_model_Metadata__ = __webpack_require__(29);
                        var __WEBPACK_IMPORTED_MODULE_12__Services_AutoConf_Response_model_Originator__ = __webpack_require__(30);
                        var __WEBPACK_IMPORTED_MODULE_13__Services_AutoConf_Response_model_Service__ = __webpack_require__(31);
                        var __WEBPACK_IMPORTED_MODULE_14__Services_AutoConf_Response_model_Style__ = __webpack_require__(32);
                        var __WEBPACK_IMPORTED_MODULE_15__Services_AutoConf_Response_model_Territory__ = __webpack_require__(33);
                        var __WEBPACK_IMPORTED_MODULE_16__Services_AutoConf_Response_model_Thematic__ = __webpack_require__(34);
                        var __WEBPACK_IMPORTED_MODULE_17__Services_AutoConf_Response_model_TileMatrix__ = __webpack_require__(36);
                        var __WEBPACK_IMPORTED_MODULE_18__Services_AutoConf_Response_model_TileMatrixLimit__ = __webpack_require__(37);
                        var __WEBPACK_IMPORTED_MODULE_19__Services_AutoConf_Response_model_TileMatrixSet__ = __webpack_require__(35);
                        var __WEBPACK_IMPORTED_MODULE_20__Services_Geocode_Response_model_GeocodeResponse__ = __webpack_require__(14);
                        var __WEBPACK_IMPORTED_MODULE_21__Services_Geocode_Response_model_GeocodedLocation__ = __webpack_require__(15);
                        var __WEBPACK_IMPORTED_MODULE_22__Services_Geocode_Response_model_DirectGeocodedLocation__ = __webpack_require__(39);
                        var __WEBPACK_IMPORTED_MODULE_23__Services_Geocode_Response_model_ReverseGeocodedLocation__ = __webpack_require__(40);
                        var __WEBPACK_IMPORTED_MODULE_24__Services_ProcessIsoCurve_Response_model_ProcessIsoCurveResponse__ = __webpack_require__(18);
                        var __WEBPACK_IMPORTED_MODULE_25__Services_Route_Response_model_RouteResponse__ = __webpack_require__(16);
                        var __WEBPACK_IMPORTED_MODULE_26__Services_Route_Response_model_RouteInstruction__ = __webpack_require__(17);
                        var __WEBPACK_IMPORTED_MODULE_27__Protocols_XHR__ = __webpack_require__(19);
                        var __WEBPACK_IMPORTED_MODULE_28__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_29__Utils_Helper__ = __webpack_require__(4);
                        var Gp = {
                            servicesVersion: '2.0.0',
                            servicesDate: '2018-04-05',
                            extend: function (strNS, value) {
                                var parts = strNS.split('.');
                                var parent = this;
                                var pl;
                                pl = parts.length;
                                for (var i = 0; i < pl; i++) {
                                    if (typeof parent[parts[i]] === 'undefined') {
                                        parent[parts[i]] = {};
                                    }
                                    var n = pl - 1;
                                    if (i === n) {
                                        parent[parts[i]] = value;
                                    }
                                    parent = parent[parts[i]];
                                }
                                return this;
                            }
                        };
                        Gp.extend('Protocols', {});
                        Gp.extend('Protocols.XHR', __WEBPACK_IMPORTED_MODULE_27__Protocols_XHR__['a']);
                        Gp.extend('Services', __WEBPACK_IMPORTED_MODULE_0__Services_Services__['a']);
                        Gp.extend('Services.AltiResponse', __WEBPACK_IMPORTED_MODULE_2__Services_Alti_Response_model_AltiResponse__['a']);
                        Gp.extend('Services.Alti.Elevation', __WEBPACK_IMPORTED_MODULE_3__Services_Alti_Response_model_Elevation__['a']);
                        Gp.extend('Services.AutoCompleteResponse', __WEBPACK_IMPORTED_MODULE_4__Services_AutoComplete_Response_model_AutoCompleteResponse__['a']);
                        Gp.extend('Services.AutoComplete.SuggestedLocation', __WEBPACK_IMPORTED_MODULE_5__Services_AutoComplete_Response_model_SuggestedLocation__['a']);
                        Gp.extend('Services.GetConfigResponse', __WEBPACK_IMPORTED_MODULE_6__Services_AutoConf_Response_model_AutoConfResponse__['a']);
                        Gp.extend('Services.Config.Constraint', __WEBPACK_IMPORTED_MODULE_7__Services_AutoConf_Response_model_Constraint__['a']);
                        Gp.extend('Services.Config.Format', __WEBPACK_IMPORTED_MODULE_8__Services_AutoConf_Response_model_Format__['a']);
                        Gp.extend('Services.Config.Layer', __WEBPACK_IMPORTED_MODULE_9__Services_AutoConf_Response_model_Layer__['a']);
                        Gp.extend('Services.Config.Legend', __WEBPACK_IMPORTED_MODULE_10__Services_AutoConf_Response_model_Legend__['a']);
                        Gp.extend('Services.Config.Metadata', __WEBPACK_IMPORTED_MODULE_11__Services_AutoConf_Response_model_Metadata__['a']);
                        Gp.extend('Services.Config.Originator', __WEBPACK_IMPORTED_MODULE_12__Services_AutoConf_Response_model_Originator__['a']);
                        Gp.extend('Services.Config.Service', __WEBPACK_IMPORTED_MODULE_13__Services_AutoConf_Response_model_Service__['a']);
                        Gp.extend('Services.Config.Style', __WEBPACK_IMPORTED_MODULE_14__Services_AutoConf_Response_model_Style__['a']);
                        Gp.extend('Services.Config.Territory', __WEBPACK_IMPORTED_MODULE_15__Services_AutoConf_Response_model_Territory__['a']);
                        Gp.extend('Services.Config.Thematic', __WEBPACK_IMPORTED_MODULE_16__Services_AutoConf_Response_model_Thematic__['a']);
                        Gp.extend('Services.Config.TileMatrix', __WEBPACK_IMPORTED_MODULE_17__Services_AutoConf_Response_model_TileMatrix__['a']);
                        Gp.extend('Services.Config.TileMatrixLimit', __WEBPACK_IMPORTED_MODULE_18__Services_AutoConf_Response_model_TileMatrixLimit__['a']);
                        Gp.extend('Services.Config.TileMatrixSet', __WEBPACK_IMPORTED_MODULE_19__Services_AutoConf_Response_model_TileMatrixSet__['a']);
                        Gp.extend('Services.GeocodeResponse', __WEBPACK_IMPORTED_MODULE_20__Services_Geocode_Response_model_GeocodeResponse__['a']);
                        Gp.extend('Services.Geocode.GeocodedLocation', __WEBPACK_IMPORTED_MODULE_21__Services_Geocode_Response_model_GeocodedLocation__['a']);
                        Gp.extend('Services.Geocode.DirectGeocodedLocation', __WEBPACK_IMPORTED_MODULE_22__Services_Geocode_Response_model_DirectGeocodedLocation__['a']);
                        Gp.extend('Services.Geocode.ReverseGeocodedLocation', __WEBPACK_IMPORTED_MODULE_23__Services_Geocode_Response_model_ReverseGeocodedLocation__['a']);
                        Gp.extend('Services.IsoCurveResponse', __WEBPACK_IMPORTED_MODULE_24__Services_ProcessIsoCurve_Response_model_ProcessIsoCurveResponse__['a']);
                        Gp.extend('Services.RouteResponse', __WEBPACK_IMPORTED_MODULE_25__Services_Route_Response_model_RouteResponse__['a']);
                        Gp.extend('Services.Route.RouteInstruction', __WEBPACK_IMPORTED_MODULE_26__Services_Route_Response_model_RouteInstruction__['a']);
                        Gp.extend('Error', __WEBPACK_IMPORTED_MODULE_28__Exceptions_ErrorService__['a']);
                        Gp.extend('Helper', __WEBPACK_IMPORTED_MODULE_29__Utils_Helper__['a']);
                        Gp.extend('Services.DefaultUrl', __WEBPACK_IMPORTED_MODULE_1__Services_DefaultUrlService__['a']);
                        __webpack_exports__['default'] = Gp;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Alti_Alti__ = __webpack_require__(46);
                        var __WEBPACK_IMPORTED_MODULE_1__AutoConf_AutoConf__ = __webpack_require__(60);
                        var __WEBPACK_IMPORTED_MODULE_2__Geocode_Geocode__ = __webpack_require__(63);
                        var __WEBPACK_IMPORTED_MODULE_3__Geocode_ReverseGeocode__ = __webpack_require__(78);
                        var __WEBPACK_IMPORTED_MODULE_4__AutoComplete_AutoComplete__ = __webpack_require__(82);
                        var __WEBPACK_IMPORTED_MODULE_5__Route_Route__ = __webpack_require__(84);
                        var __WEBPACK_IMPORTED_MODULE_6__ProcessIsoCurve_ProcessIsoCurve__ = __webpack_require__(96);
                        var Services = {
                            getConfig: function (options) {
                                var autoconfService = new __WEBPACK_IMPORTED_MODULE_1__AutoConf_AutoConf__['a'](options);
                                autoconfService.call();
                            },
                            getAltitude: function (options) {
                                var altiService = new __WEBPACK_IMPORTED_MODULE_0__Alti_Alti__['a'](options);
                                altiService.call();
                            },
                            geocode: function (options) {
                                var geocodeService = new __WEBPACK_IMPORTED_MODULE_2__Geocode_Geocode__['a'](options);
                                geocodeService.call();
                            },
                            reverseGeocode: function (options) {
                                var reverseGeocodeService = new __WEBPACK_IMPORTED_MODULE_3__Geocode_ReverseGeocode__['a'](options);
                                reverseGeocodeService.call();
                            },
                            autoComplete: function (options) {
                                var autoCompleteService = new __WEBPACK_IMPORTED_MODULE_4__AutoComplete_AutoComplete__['a'](options);
                                autoCompleteService.call();
                            },
                            route: function (options) {
                                var routeService = new __WEBPACK_IMPORTED_MODULE_5__Route_Route__['a'](options);
                                routeService.call();
                            },
                            isoCurve: function (options) {
                                var processIsoCurveService = new __WEBPACK_IMPORTED_MODULE_6__ProcessIsoCurve_ProcessIsoCurve__['a'](options);
                                processIsoCurveService.call();
                            }
                        };
                        var point = {};
                        var circle = {};
                        var bbox = {};
                        __webpack_exports__['a'] = Services;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__CommonService__ = __webpack_require__(3);
                        var __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__ = __webpack_require__(5);
                        var __WEBPACK_IMPORTED_MODULE_5__Request_AltiRequestFactory__ = __webpack_require__(54);
                        var __WEBPACK_IMPORTED_MODULE_6__Response_AltiResponseFactory__ = __webpack_require__(58);
                        function Alti(options) {
                            if (!(this instanceof Alti)) {
                                throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('CLASS_CONSTRUCTOR', 'Alti'));
                            }
                            this.CLASSNAME = 'Alti';
                            __WEBPACK_IMPORTED_MODULE_3__CommonService__['a'].apply(this, arguments);
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('Gp.Services.Alti');
                            this.logger.trace('[Constructeur Alti (options)]');
                            if (!options.positions) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'positions'));
                            }
                            if (options.positions.length === 0) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_EMPTY', 'positions'));
                            }
                            this.options.positions = options.positions;
                            this.options.outputFormat = typeof options.outputFormat === 'string' ? options.outputFormat.toLowerCase() : 'xml';
                            this.options.sampling = options.sampling || null;
                            this.options.api = typeof options.api === 'string' ? options.api.toUpperCase() : 'REST';
                            if (this.options.api === 'REST') {
                                this.options.httpMethod = 'GET';
                            }
                            this.options.zonly = options.zonly || false;
                            if (!this.options.serverUrl) {
                                var lstUrlByDefault = __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__['a'].Alti.url(this.options.apiKey);
                                var urlFound = null;
                                switch (this.options.api) {
                                case 'WPS':
                                    urlFound = lstUrlByDefault.wps;
                                    break;
                                case 'REST':
                                    var key = (options.sampling ? 'profil' : 'elevation') + '-' + this.options.outputFormat;
                                    urlFound = lstUrlByDefault[key];
                                    break;
                                default:
                                    throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_UNKNOWN', 'api'));
                                }
                                if (!urlFound) {
                                    throw new Error('Url by default not found !');
                                }
                                this.options.serverUrl = urlFound;
                                this.logger.trace('Server URL by default : ' + this.options.serverUrl);
                            }
                            var idx = this.options.serverUrl.lastIndexOf('.');
                            if (idx !== -1) {
                                var extension = this.options.serverUrl.substring(idx + 1);
                                if (extension && extension.length < 5) {
                                    this.logger.trace('Server Extension URL : ' + extension);
                                    switch (extension.toLowerCase()) {
                                    case 'json':
                                    case 'xml':
                                        this.options.outputFormat = extension.toLowerCase();
                                        break;
                                    default:
                                        throw new Error('type of service : unknown or unsupported (json or xml) !');
                                    }
                                }
                            }
                        }
                        Alti.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__CommonService__['a'].prototype, {});
                        Alti.prototype.constructor = Alti;
                        Alti.prototype.buildRequest = function (error, success) {
                            var options = {
                                httpMethod: this.options.httpMethod,
                                onSuccess: function (result) {
                                    this.request = result;
                                    success.call(this, this.request);
                                },
                                onError: error,
                                scope: this,
                                positions: this.options.positions,
                                outputFormat: this.options.outputFormat,
                                sampling: this.options.sampling,
                                api: this.options.api,
                                zonly: this.options.zonly
                            };
                            __WEBPACK_IMPORTED_MODULE_5__Request_AltiRequestFactory__['a'].build(options);
                        };
                        Alti.prototype.analyzeResponse = function (error, success) {
                            if (this.response) {
                                var options = {
                                    response: this.response,
                                    outputFormat: this.options.outputFormat,
                                    rawResponse: this.options.rawResponse,
                                    onError: error,
                                    onSuccess: success,
                                    scope: this
                                };
                                __WEBPACK_IMPORTED_MODULE_6__Response_AltiResponseFactory__['a'].build(options);
                            } else {
                                error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                            }
                        };
                        __webpack_exports__['a'] = Alti;
                    },
                    function (module, exports, __webpack_require__) {
                        var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;
                        (function (root, definition) {
                            'use strict';
                            if (true) {
                                !(__WEBPACK_AMD_DEFINE_FACTORY__ = definition, __WEBPACK_AMD_DEFINE_RESULT__ = typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? __WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module) : __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
                            } else if (typeof module === 'object' && module.exports) {
                                module.exports = definition();
                            } else {
                                root.log = definition();
                            }
                        }(this, function () {
                            'use strict';
                            var noop = function () {
                            };
                            var undefinedType = 'undefined';
                            var logMethods = [
                                'trace',
                                'debug',
                                'info',
                                'warn',
                                'error'
                            ];
                            function bindMethod(obj, methodName) {
                                var method = obj[methodName];
                                if (typeof method.bind === 'function') {
                                    return method.bind(obj);
                                } else {
                                    try {
                                        return Function.prototype.bind.call(method, obj);
                                    } catch (e) {
                                        return function () {
                                            return Function.prototype.apply.apply(method, [
                                                obj,
                                                arguments
                                            ]);
                                        };
                                    }
                                }
                            }
                            function realMethod(methodName) {
                                if (methodName === 'debug') {
                                    methodName = 'log';
                                }
                                if (typeof console === undefinedType) {
                                    return false;
                                } else if (console[methodName] !== undefined) {
                                    return bindMethod(console, methodName);
                                } else if (console.log !== undefined) {
                                    return bindMethod(console, 'log');
                                } else {
                                    return noop;
                                }
                            }
                            function replaceLoggingMethods(level, loggerName) {
                                for (var i = 0; i < logMethods.length; i++) {
                                    var methodName = logMethods[i];
                                    this[methodName] = i < level ? noop : this.methodFactory(methodName, level, loggerName);
                                }
                                this.log = this.debug;
                            }
                            function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {
                                return function () {
                                    if (typeof console !== undefinedType) {
                                        replaceLoggingMethods.call(this, level, loggerName);
                                        this[methodName].apply(this, arguments);
                                    }
                                };
                            }
                            function defaultMethodFactory(methodName, level, loggerName) {
                                return realMethod(methodName) || enableLoggingWhenConsoleArrives.apply(this, arguments);
                            }
                            function Logger(name, defaultLevel, factory) {
                                var self = this;
                                var currentLevel;
                                var storageKey = 'loglevel';
                                if (name) {
                                    storageKey += ':' + name;
                                }
                                function persistLevelIfPossible(levelNum) {
                                    var levelName = (logMethods[levelNum] || 'silent').toUpperCase();
                                    if (typeof window === undefinedType)
                                        return;
                                    try {
                                        window.localStorage[storageKey] = levelName;
                                        return;
                                    } catch (ignore) {
                                    }
                                    try {
                                        window.document.cookie = encodeURIComponent(storageKey) + '=' + levelName + ';';
                                    } catch (ignore) {
                                    }
                                }
                                function getPersistedLevel() {
                                    var storedLevel;
                                    if (typeof window === undefinedType)
                                        return;
                                    try {
                                        storedLevel = window.localStorage[storageKey];
                                    } catch (ignore) {
                                    }
                                    if (typeof storedLevel === undefinedType) {
                                        try {
                                            var cookie = window.document.cookie;
                                            var location = cookie.indexOf(encodeURIComponent(storageKey) + '=');
                                            if (location !== -1) {
                                                storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];
                                            }
                                        } catch (ignore) {
                                        }
                                    }
                                    if (self.levels[storedLevel] === undefined) {
                                        storedLevel = undefined;
                                    }
                                    return storedLevel;
                                }
                                self.name = name;
                                self.levels = {
                                    'TRACE': 0,
                                    'DEBUG': 1,
                                    'INFO': 2,
                                    'WARN': 3,
                                    'ERROR': 4,
                                    'SILENT': 5
                                };
                                self.methodFactory = factory || defaultMethodFactory;
                                self.getLevel = function () {
                                    return currentLevel;
                                };
                                self.setLevel = function (level, persist) {
                                    if (typeof level === 'string' && self.levels[level.toUpperCase()] !== undefined) {
                                        level = self.levels[level.toUpperCase()];
                                    }
                                    if (typeof level === 'number' && level >= 0 && level <= self.levels.SILENT) {
                                        currentLevel = level;
                                        if (persist !== false) {
                                            persistLevelIfPossible(level);
                                        }
                                        replaceLoggingMethods.call(self, level, name);
                                        if (typeof console === undefinedType && level < self.levels.SILENT) {
                                            return 'No console available for logging';
                                        }
                                    } else {
                                        throw 'log.setLevel() called with invalid level: ' + level;
                                    }
                                };
                                self.setDefaultLevel = function (level) {
                                    if (!getPersistedLevel()) {
                                        self.setLevel(level, false);
                                    }
                                };
                                self.enableAll = function (persist) {
                                    self.setLevel(self.levels.TRACE, persist);
                                };
                                self.disableAll = function (persist) {
                                    self.setLevel(self.levels.SILENT, persist);
                                };
                                var initialLevel = getPersistedLevel();
                                if (initialLevel == null) {
                                    initialLevel = defaultLevel == null ? 'WARN' : defaultLevel;
                                }
                                self.setLevel(initialLevel, false);
                            }
                            var defaultLogger = new Logger();
                            var _loggersByName = {};
                            defaultLogger.getLogger = function getLogger(name) {
                                if (typeof name !== 'string' || name === '') {
                                    throw new TypeError('You must supply a name when creating a logger.');
                                }
                                var logger = _loggersByName[name];
                                if (!logger) {
                                    logger = _loggersByName[name] = new Logger(name, defaultLogger.getLevel(), defaultLogger.methodFactory);
                                }
                                return logger;
                            };
                            var _log = typeof window !== undefinedType ? window.log : undefined;
                            defaultLogger.noConflict = function () {
                                if (typeof window !== undefinedType && window.log === defaultLogger) {
                                    window.log = _log;
                                }
                                return defaultLogger;
                            };
                            defaultLogger.getLoggers = function getLoggers() {
                                return _loggersByName;
                            };
                            return defaultLogger;
                        }));
                        return exports;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_Helper__ = __webpack_require__(4);
                        var __WEBPACK_IMPORTED_MODULE_1__XHR__ = __webpack_require__(19);
                        var __WEBPACK_IMPORTED_MODULE_2__JSONP__ = __webpack_require__(53);
                        var Protocol = {
                            send: function (options) {
                                var settings = options || {
                                    method: 'GET',
                                    protocol: 'XHR',
                                    timeOut: 0,
                                    format: null,
                                    wrap: true,
                                    nocache: true,
                                    output: 'json',
                                    callback: null,
                                    callbackSuffix: null
                                };
                                if (typeof window === 'undefined' && options.protocol === 'JSONP') {
                                    console.log('Value (s) for parameter (s) \'protocol=JSONP (instead use XHR)\' not supported to NodeJS');
                                    return;
                                }
                                if (options.protocol === 'XHR' || options.format === 'json') {
                                    settings.wrap = false;
                                } else if (options.protocol === 'JSONP' && options.format === 'xml') {
                                    settings.wrap = true;
                                }
                                settings.callback = options.protocol === 'JSONP' ? null : null;
                                settings.output = settings.wrap ? 'json' : null;
                                if (settings.wrap) {
                                    var params = {};
                                    params.output = settings.output;
                                    params.callback = settings.callback;
                                    delete params.callback;
                                    settings.url = __WEBPACK_IMPORTED_MODULE_0__Utils_Helper__['a'].normalyzeUrl(options.url, params);
                                }
                                switch (settings.protocol) {
                                case 'XHR':
                                    if (options.method === 'GET' && options.nocache) {
                                        settings.url = __WEBPACK_IMPORTED_MODULE_0__Utils_Helper__['a'].normalyzeUrl(settings.url, { t: new Date().getTime() });
                                    }
                                    __WEBPACK_IMPORTED_MODULE_1__XHR__['a'].call(settings);
                                    break;
                                case 'JSONP':
                                    if (settings.data) {
                                        settings.url = __WEBPACK_IMPORTED_MODULE_0__Utils_Helper__['a'].normalyzeUrl(settings.url, settings.data);
                                    }
                                    __WEBPACK_IMPORTED_MODULE_2__JSONP__['a'].call(settings);
                                    break;
                                default:
                                    throw new Error('protocol not supported (XHR|JSONP) !');
                                }
                            }
                        };
                        __webpack_exports__['a'] = Protocol;
                    },
                    function (module, exports, __webpack_require__) {
                        (function (process, global) {
                            (function (global, factory) {
                                true ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : global.ES6Promise = factory();
                            }(this, function () {
                                'use strict';
                                function objectOrFunction(x) {
                                    var type = typeof x;
                                    return x !== null && (type === 'object' || type === 'function');
                                }
                                function isFunction(x) {
                                    return typeof x === 'function';
                                }
                                var _isArray = void 0;
                                if (Array.isArray) {
                                    _isArray = Array.isArray;
                                } else {
                                    _isArray = function (x) {
                                        return Object.prototype.toString.call(x) === '[object Array]';
                                    };
                                }
                                var isArray = _isArray;
                                var len = 0;
                                var vertxNext = void 0;
                                var customSchedulerFn = void 0;
                                var asap = function asap(callback, arg) {
                                    queue[len] = callback;
                                    queue[len + 1] = arg;
                                    len += 2;
                                    if (len === 2) {
                                        if (customSchedulerFn) {
                                            customSchedulerFn(flush);
                                        } else {
                                            scheduleFlush();
                                        }
                                    }
                                };
                                function setScheduler(scheduleFn) {
                                    customSchedulerFn = scheduleFn;
                                }
                                function setAsap(asapFn) {
                                    asap = asapFn;
                                }
                                var browserWindow = typeof window !== 'undefined' ? window : undefined;
                                var browserGlobal = browserWindow || {};
                                var BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;
                                var isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';
                                var isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';
                                function useNextTick() {
                                    return function () {
                                        return process.nextTick(flush);
                                    };
                                }
                                function useVertxTimer() {
                                    if (typeof vertxNext !== 'undefined') {
                                        return function () {
                                            vertxNext(flush);
                                        };
                                    }
                                    return useSetTimeout();
                                }
                                function useMutationObserver() {
                                    var iterations = 0;
                                    var observer = new BrowserMutationObserver(flush);
                                    var node = document.createTextNode('');
                                    observer.observe(node, { characterData: true });
                                    return function () {
                                        node.data = iterations = ++iterations % 2;
                                    };
                                }
                                function useMessageChannel() {
                                    var channel = new MessageChannel();
                                    channel.port1.onmessage = flush;
                                    return function () {
                                        return channel.port2.postMessage(0);
                                    };
                                }
                                function useSetTimeout() {
                                    var globalSetTimeout = setTimeout;
                                    return function () {
                                        return globalSetTimeout(flush, 1);
                                    };
                                }
                                var queue = new Array(1000);
                                function flush() {
                                    for (var i = 0; i < len; i += 2) {
                                        var callback = queue[i];
                                        var arg = queue[i + 1];
                                        callback(arg);
                                        queue[i] = undefined;
                                        queue[i + 1] = undefined;
                                    }
                                    len = 0;
                                }
                                function attemptVertx() {
                                    try {
                                        var vertx = Function('return this')().require('vertx');
                                        vertxNext = vertx.runOnLoop || vertx.runOnContext;
                                        return useVertxTimer();
                                    } catch (e) {
                                        return useSetTimeout();
                                    }
                                }
                                var scheduleFlush = void 0;
                                if (isNode) {
                                    scheduleFlush = useNextTick();
                                } else if (BrowserMutationObserver) {
                                    scheduleFlush = useMutationObserver();
                                } else if (isWorker) {
                                    scheduleFlush = useMessageChannel();
                                } else if (browserWindow === undefined && 'function' === 'function') {
                                    scheduleFlush = attemptVertx();
                                } else {
                                    scheduleFlush = useSetTimeout();
                                }
                                function then(onFulfillment, onRejection) {
                                    var parent = this;
                                    var child = new this.constructor(noop);
                                    if (child[PROMISE_ID] === undefined) {
                                        makePromise(child);
                                    }
                                    var _state = parent._state;
                                    if (_state) {
                                        var callback = arguments[_state - 1];
                                        asap(function () {
                                            return invokeCallback(_state, child, callback, parent._result);
                                        });
                                    } else {
                                        subscribe(parent, child, onFulfillment, onRejection);
                                    }
                                    return child;
                                }
                                function resolve$1(object) {
                                    var Constructor = this;
                                    if (object && typeof object === 'object' && object.constructor === Constructor) {
                                        return object;
                                    }
                                    var promise = new Constructor(noop);
                                    resolve(promise, object);
                                    return promise;
                                }
                                var PROMISE_ID = Math.random().toString(36).substring(2);
                                function noop() {
                                }
                                var PENDING = void 0;
                                var FULFILLED = 1;
                                var REJECTED = 2;
                                var TRY_CATCH_ERROR = { error: null };
                                function selfFulfillment() {
                                    return new TypeError('You cannot resolve a promise with itself');
                                }
                                function cannotReturnOwn() {
                                    return new TypeError('A promises callback cannot return that same promise.');
                                }
                                function getThen(promise) {
                                    try {
                                        return promise.then;
                                    } catch (error) {
                                        TRY_CATCH_ERROR.error = error;
                                        return TRY_CATCH_ERROR;
                                    }
                                }
                                function tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {
                                    try {
                                        then$$1.call(value, fulfillmentHandler, rejectionHandler);
                                    } catch (e) {
                                        return e;
                                    }
                                }
                                function handleForeignThenable(promise, thenable, then$$1) {
                                    asap(function (promise) {
                                        var sealed = false;
                                        var error = tryThen(then$$1, thenable, function (value) {
                                            if (sealed) {
                                                return;
                                            }
                                            sealed = true;
                                            if (thenable !== value) {
                                                resolve(promise, value);
                                            } else {
                                                fulfill(promise, value);
                                            }
                                        }, function (reason) {
                                            if (sealed) {
                                                return;
                                            }
                                            sealed = true;
                                            reject(promise, reason);
                                        }, 'Settle: ' + (promise._label || ' unknown promise'));
                                        if (!sealed && error) {
                                            sealed = true;
                                            reject(promise, error);
                                        }
                                    }, promise);
                                }
                                function handleOwnThenable(promise, thenable) {
                                    if (thenable._state === FULFILLED) {
                                        fulfill(promise, thenable._result);
                                    } else if (thenable._state === REJECTED) {
                                        reject(promise, thenable._result);
                                    } else {
                                        subscribe(thenable, undefined, function (value) {
                                            return resolve(promise, value);
                                        }, function (reason) {
                                            return reject(promise, reason);
                                        });
                                    }
                                }
                                function handleMaybeThenable(promise, maybeThenable, then$$1) {
                                    if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {
                                        handleOwnThenable(promise, maybeThenable);
                                    } else {
                                        if (then$$1 === TRY_CATCH_ERROR) {
                                            reject(promise, TRY_CATCH_ERROR.error);
                                            TRY_CATCH_ERROR.error = null;
                                        } else if (then$$1 === undefined) {
                                            fulfill(promise, maybeThenable);
                                        } else if (isFunction(then$$1)) {
                                            handleForeignThenable(promise, maybeThenable, then$$1);
                                        } else {
                                            fulfill(promise, maybeThenable);
                                        }
                                    }
                                }
                                function resolve(promise, value) {
                                    if (promise === value) {
                                        reject(promise, selfFulfillment());
                                    } else if (objectOrFunction(value)) {
                                        handleMaybeThenable(promise, value, getThen(value));
                                    } else {
                                        fulfill(promise, value);
                                    }
                                }
                                function publishRejection(promise) {
                                    if (promise._onerror) {
                                        promise._onerror(promise._result);
                                    }
                                    publish(promise);
                                }
                                function fulfill(promise, value) {
                                    if (promise._state !== PENDING) {
                                        return;
                                    }
                                    promise._result = value;
                                    promise._state = FULFILLED;
                                    if (promise._subscribers.length !== 0) {
                                        asap(publish, promise);
                                    }
                                }
                                function reject(promise, reason) {
                                    if (promise._state !== PENDING) {
                                        return;
                                    }
                                    promise._state = REJECTED;
                                    promise._result = reason;
                                    asap(publishRejection, promise);
                                }
                                function subscribe(parent, child, onFulfillment, onRejection) {
                                    var _subscribers = parent._subscribers;
                                    var length = _subscribers.length;
                                    parent._onerror = null;
                                    _subscribers[length] = child;
                                    _subscribers[length + FULFILLED] = onFulfillment;
                                    _subscribers[length + REJECTED] = onRejection;
                                    if (length === 0 && parent._state) {
                                        asap(publish, parent);
                                    }
                                }
                                function publish(promise) {
                                    var subscribers = promise._subscribers;
                                    var settled = promise._state;
                                    if (subscribers.length === 0) {
                                        return;
                                    }
                                    var child = void 0, callback = void 0, detail = promise._result;
                                    for (var i = 0; i < subscribers.length; i += 3) {
                                        child = subscribers[i];
                                        callback = subscribers[i + settled];
                                        if (child) {
                                            invokeCallback(settled, child, callback, detail);
                                        } else {
                                            callback(detail);
                                        }
                                    }
                                    promise._subscribers.length = 0;
                                }
                                function tryCatch(callback, detail) {
                                    try {
                                        return callback(detail);
                                    } catch (e) {
                                        TRY_CATCH_ERROR.error = e;
                                        return TRY_CATCH_ERROR;
                                    }
                                }
                                function invokeCallback(settled, promise, callback, detail) {
                                    var hasCallback = isFunction(callback), value = void 0, error = void 0, succeeded = void 0, failed = void 0;
                                    if (hasCallback) {
                                        value = tryCatch(callback, detail);
                                        if (value === TRY_CATCH_ERROR) {
                                            failed = true;
                                            error = value.error;
                                            value.error = null;
                                        } else {
                                            succeeded = true;
                                        }
                                        if (promise === value) {
                                            reject(promise, cannotReturnOwn());
                                            return;
                                        }
                                    } else {
                                        value = detail;
                                        succeeded = true;
                                    }
                                    if (promise._state !== PENDING) {
                                    } else if (hasCallback && succeeded) {
                                        resolve(promise, value);
                                    } else if (failed) {
                                        reject(promise, error);
                                    } else if (settled === FULFILLED) {
                                        fulfill(promise, value);
                                    } else if (settled === REJECTED) {
                                        reject(promise, value);
                                    }
                                }
                                function initializePromise(promise, resolver) {
                                    try {
                                        resolver(function resolvePromise(value) {
                                            resolve(promise, value);
                                        }, function rejectPromise(reason) {
                                            reject(promise, reason);
                                        });
                                    } catch (e) {
                                        reject(promise, e);
                                    }
                                }
                                var id = 0;
                                function nextId() {
                                    return id++;
                                }
                                function makePromise(promise) {
                                    promise[PROMISE_ID] = id++;
                                    promise._state = undefined;
                                    promise._result = undefined;
                                    promise._subscribers = [];
                                }
                                function validationError() {
                                    return new Error('Array Methods must be provided an Array');
                                }
                                var Enumerator = function () {
                                    function Enumerator(Constructor, input) {
                                        this._instanceConstructor = Constructor;
                                        this.promise = new Constructor(noop);
                                        if (!this.promise[PROMISE_ID]) {
                                            makePromise(this.promise);
                                        }
                                        if (isArray(input)) {
                                            this.length = input.length;
                                            this._remaining = input.length;
                                            this._result = new Array(this.length);
                                            if (this.length === 0) {
                                                fulfill(this.promise, this._result);
                                            } else {
                                                this.length = this.length || 0;
                                                this._enumerate(input);
                                                if (this._remaining === 0) {
                                                    fulfill(this.promise, this._result);
                                                }
                                            }
                                        } else {
                                            reject(this.promise, validationError());
                                        }
                                    }
                                    Enumerator.prototype._enumerate = function _enumerate(input) {
                                        for (var i = 0; this._state === PENDING && i < input.length; i++) {
                                            this._eachEntry(input[i], i);
                                        }
                                    };
                                    Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {
                                        var c = this._instanceConstructor;
                                        var resolve$$1 = c.resolve;
                                        if (resolve$$1 === resolve$1) {
                                            var _then = getThen(entry);
                                            if (_then === then && entry._state !== PENDING) {
                                                this._settledAt(entry._state, i, entry._result);
                                            } else if (typeof _then !== 'function') {
                                                this._remaining--;
                                                this._result[i] = entry;
                                            } else if (c === Promise$1) {
                                                var promise = new c(noop);
                                                handleMaybeThenable(promise, entry, _then);
                                                this._willSettleAt(promise, i);
                                            } else {
                                                this._willSettleAt(new c(function (resolve$$1) {
                                                    return resolve$$1(entry);
                                                }), i);
                                            }
                                        } else {
                                            this._willSettleAt(resolve$$1(entry), i);
                                        }
                                    };
                                    Enumerator.prototype._settledAt = function _settledAt(state, i, value) {
                                        var promise = this.promise;
                                        if (promise._state === PENDING) {
                                            this._remaining--;
                                            if (state === REJECTED) {
                                                reject(promise, value);
                                            } else {
                                                this._result[i] = value;
                                            }
                                        }
                                        if (this._remaining === 0) {
                                            fulfill(promise, this._result);
                                        }
                                    };
                                    Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {
                                        var enumerator = this;
                                        subscribe(promise, undefined, function (value) {
                                            return enumerator._settledAt(FULFILLED, i, value);
                                        }, function (reason) {
                                            return enumerator._settledAt(REJECTED, i, reason);
                                        });
                                    };
                                    return Enumerator;
                                }();
                                function all(entries) {
                                    return new Enumerator(this, entries).promise;
                                }
                                function race(entries) {
                                    var Constructor = this;
                                    if (!isArray(entries)) {
                                        return new Constructor(function (_, reject) {
                                            return reject(new TypeError('You must pass an array to race.'));
                                        });
                                    } else {
                                        return new Constructor(function (resolve, reject) {
                                            var length = entries.length;
                                            for (var i = 0; i < length; i++) {
                                                Constructor.resolve(entries[i]).then(resolve, reject);
                                            }
                                        });
                                    }
                                }
                                function reject$1(reason) {
                                    var Constructor = this;
                                    var promise = new Constructor(noop);
                                    reject(promise, reason);
                                    return promise;
                                }
                                function needsResolver() {
                                    throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');
                                }
                                function needsNew() {
                                    throw new TypeError('Failed to construct \'Promise\': Please use the \'new\' operator, this object constructor cannot be called as a function.');
                                }
                                var Promise$1 = function () {
                                    function Promise(resolver) {
                                        this[PROMISE_ID] = nextId();
                                        this._result = this._state = undefined;
                                        this._subscribers = [];
                                        if (noop !== resolver) {
                                            typeof resolver !== 'function' && needsResolver();
                                            this instanceof Promise ? initializePromise(this, resolver) : needsNew();
                                        }
                                    }
                                    Promise.prototype.catch = function _catch(onRejection) {
                                        return this.then(null, onRejection);
                                    };
                                    Promise.prototype.finally = function _finally(callback) {
                                        var promise = this;
                                        var constructor = promise.constructor;
                                        return promise.then(function (value) {
                                            return constructor.resolve(callback()).then(function () {
                                                return value;
                                            });
                                        }, function (reason) {
                                            return constructor.resolve(callback()).then(function () {
                                                throw reason;
                                            });
                                        });
                                    };
                                    return Promise;
                                }();
                                Promise$1.prototype.then = then;
                                Promise$1.all = all;
                                Promise$1.race = race;
                                Promise$1.resolve = resolve$1;
                                Promise$1.reject = reject$1;
                                Promise$1._setScheduler = setScheduler;
                                Promise$1._setAsap = setAsap;
                                Promise$1._asap = asap;
                                function polyfill() {
                                    var local = void 0;
                                    if (typeof global !== 'undefined') {
                                        local = global;
                                    } else if (typeof self !== 'undefined') {
                                        local = self;
                                    } else {
                                        try {
                                            local = Function('return this')();
                                        } catch (e) {
                                            throw new Error('polyfill failed because global object is unavailable in this environment');
                                        }
                                    }
                                    var P = local.Promise;
                                    if (P) {
                                        var promiseToString = null;
                                        try {
                                            promiseToString = Object.prototype.toString.call(P.resolve());
                                        } catch (e) {
                                        }
                                        if (promiseToString === '[object Promise]' && !P.cast) {
                                            return;
                                        }
                                    }
                                    local.Promise = Promise$1;
                                }
                                Promise$1.polyfill = polyfill;
                                Promise$1.Promise = Promise$1;
                                return Promise$1;
                            }));
                        }.call(exports, __webpack_require__(50), __webpack_require__(51)));
                        return exports;
                    },
                    function (module, exports) {
                        var process = module.exports = {};
                        var cachedSetTimeout;
                        var cachedClearTimeout;
                        function defaultSetTimout() {
                            throw new Error('setTimeout has not been defined');
                        }
                        function defaultClearTimeout() {
                            throw new Error('clearTimeout has not been defined');
                        }
                        (function () {
                            try {
                                if (typeof setTimeout === 'function') {
                                    cachedSetTimeout = setTimeout;
                                } else {
                                    cachedSetTimeout = defaultSetTimout;
                                }
                            } catch (e) {
                                cachedSetTimeout = defaultSetTimout;
                            }
                            try {
                                if (typeof clearTimeout === 'function') {
                                    cachedClearTimeout = clearTimeout;
                                } else {
                                    cachedClearTimeout = defaultClearTimeout;
                                }
                            } catch (e) {
                                cachedClearTimeout = defaultClearTimeout;
                            }
                        }());
                        function runTimeout(fun) {
                            if (cachedSetTimeout === setTimeout) {
                                return setTimeout(fun, 0);
                            }
                            if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
                                cachedSetTimeout = setTimeout;
                                return setTimeout(fun, 0);
                            }
                            try {
                                return cachedSetTimeout(fun, 0);
                            } catch (e) {
                                try {
                                    return cachedSetTimeout.call(null, fun, 0);
                                } catch (e) {
                                    return cachedSetTimeout.call(this, fun, 0);
                                }
                            }
                        }
                        function runClearTimeout(marker) {
                            if (cachedClearTimeout === clearTimeout) {
                                return clearTimeout(marker);
                            }
                            if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
                                cachedClearTimeout = clearTimeout;
                                return clearTimeout(marker);
                            }
                            try {
                                return cachedClearTimeout(marker);
                            } catch (e) {
                                try {
                                    return cachedClearTimeout.call(null, marker);
                                } catch (e) {
                                    return cachedClearTimeout.call(this, marker);
                                }
                            }
                        }
                        var queue = [];
                        var draining = false;
                        var currentQueue;
                        var queueIndex = -1;
                        function cleanUpNextTick() {
                            if (!draining || !currentQueue) {
                                return;
                            }
                            draining = false;
                            if (currentQueue.length) {
                                queue = currentQueue.concat(queue);
                            } else {
                                queueIndex = -1;
                            }
                            if (queue.length) {
                                drainQueue();
                            }
                        }
                        function drainQueue() {
                            if (draining) {
                                return;
                            }
                            var timeout = runTimeout(cleanUpNextTick);
                            draining = true;
                            var len = queue.length;
                            while (len) {
                                currentQueue = queue;
                                queue = [];
                                while (++queueIndex < len) {
                                    if (currentQueue) {
                                        currentQueue[queueIndex].run();
                                    }
                                }
                                queueIndex = -1;
                                len = queue.length;
                            }
                            currentQueue = null;
                            draining = false;
                            runClearTimeout(timeout);
                        }
                        process.nextTick = function (fun) {
                            var args = new Array(arguments.length - 1);
                            if (arguments.length > 1) {
                                for (var i = 1; i < arguments.length; i++) {
                                    args[i - 1] = arguments[i];
                                }
                            }
                            queue.push(new Item(fun, args));
                            if (queue.length === 1 && !draining) {
                                runTimeout(drainQueue);
                            }
                        };
                        function Item(fun, array) {
                            this.fun = fun;
                            this.array = array;
                        }
                        Item.prototype.run = function () {
                            this.fun.apply(null, this.array);
                        };
                        process.title = 'browser';
                        process.browser = true;
                        process.env = {};
                        process.argv = [];
                        process.version = '';
                        process.versions = {};
                        function noop() {
                        }
                        process.on = noop;
                        process.addListener = noop;
                        process.once = noop;
                        process.off = noop;
                        process.removeListener = noop;
                        process.removeAllListeners = noop;
                        process.emit = noop;
                        process.prependListener = noop;
                        process.prependOnceListener = noop;
                        process.listeners = function (name) {
                            return [];
                        };
                        process.binding = function (name) {
                            throw new Error('process.binding is not supported');
                        };
                        process.cwd = function () {
                            return '/';
                        };
                        process.chdir = function (dir) {
                            throw new Error('process.chdir is not supported');
                        };
                        process.umask = function () {
                            return 0;
                        };
                        return exports;
                    },
                    function (module, exports) {
                        var g;
                        g = function () {
                            return this;
                        }();
                        try {
                            g = g || Function('return this')() || (1, eval)('this');
                        } catch (e) {
                            if (typeof window === 'object')
                                g = window;
                        }
                        module.exports = g;
                        return exports;
                    },
                    function (module, exports) {
                        module.exports = __WEBPACK_EXTERNAL_MODULE_52__;
                        return exports;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var JSONP = {
                            uuid: function () {
                                var id = Math.floor(Date.now());
                                return function () {
                                    return id++;
                                };
                            }(),
                            call: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('JSONP');
                                logger.trace('[JSONP::call ()]');
                                if (!options) {
                                    logger.error('missing parameter : options !');
                                    throw new Error('missing parameter : options !');
                                }
                                if (!options.url) {
                                    logger.error('missing parameter : options.url !');
                                    throw new Error('missing parameter : options.url !');
                                }
                                if (!options.timeOut) {
                                    logger.info('setting \'options.timeOut\' default value');
                                    options.timeOut = 0;
                                }
                                if (!options.onResponse) {
                                    logger.error('missing parameter : options.onResponse !');
                                    throw new Error('missing parameter : options.onResponse !');
                                }
                                var callbackId = typeof options.callbackSuffix === 'string' ? options.callbackSuffix : this.uuid();
                                var urlHasCallbackKey = false;
                                var urlHasCallbackName = false;
                                var idx = options.url.indexOf('callback=');
                                if (idx !== -1) {
                                    urlHasCallbackKey = true;
                                    var j = options.url.indexOf('&', idx);
                                    if (j === -1) {
                                        j = options.url.length;
                                    }
                                    var callbackName = options.url.substring(idx + 9, j);
                                    if (callbackName) {
                                        urlHasCallbackName = true;
                                        options.callbackName = callbackName;
                                        logger.info('setting \'options.callbackName\' value (' + options.callbackName + ') from \'options.url\' parameter');
                                    }
                                }
                                if (!urlHasCallbackKey) {
                                    var k = options.url.indexOf('?');
                                    if (k === -1) {
                                        options.url = options.url + '?' + 'callback=';
                                    } else if (k === options.url.length) {
                                        options.url = options.url + 'callback=';
                                    } else {
                                        options.url = options.url + '&' + 'callback=';
                                    }
                                    logger.info('setting callback default key in \'options.url\' : ' + options.url);
                                }
                                var HasCallbackName = options.callbackName ? true : urlHasCallbackName;
                                if (!urlHasCallbackName) {
                                    if (!options.callbackName) {
                                        logger.info('setting \'options.callbackName\' default value');
                                        options.callbackName = 'callback';
                                        if (callbackId || callbackId === '') {
                                            options.callbackName += callbackId;
                                        }
                                    }
                                    options.url = options.url.replace('callback=', 'callback=' + options.callbackName);
                                    logger.info('setting callback function name in \'options.url\' : ' + options.url);
                                }
                                if (!options.onTimeOut) {
                                    logger.info('setting \'options.onTimeOut\' default value');
                                    options.onTimeOut = function () {
                                        console.log('TimeOut while invoking url : ' + options.url);
                                    };
                                }
                                if (!HasCallbackName) {
                                    var self = this;
                                    var onTimeOutTrigger = null;
                                    if (options.timeOut > 0) {
                                        onTimeOutTrigger = window.setTimeout(function () {
                                            window[options.callbackName] = function () {
                                            };
                                            options.onTimeOut();
                                            self._deleteScript(callbackId);
                                        }, options.timeOut);
                                    }
                                    window[options.callbackName] = function (data) {
                                        window.clearTimeout(onTimeOutTrigger);
                                        options.onResponse(data);
                                        self._deleteScript(callbackId);
                                    };
                                }
                                this._createScript(callbackId, options.url);
                            },
                            _createScript: function (callbackId, url) {
                                var scriptu;
                                var scripto = document.getElementById('results' + callbackId);
                                scriptu = document.createElement('script');
                                scriptu.setAttribute('type', 'text/javascript');
                                scriptu.setAttribute('src', url);
                                scriptu.setAttribute('charset', 'UTF-8');
                                scriptu.setAttribute('id', 'results' + callbackId);
                                scriptu.setAttribute('async', 'true');
                                var node = document.documentElement || document.getElementsByTagName('head')[0];
                                if (scripto === null) {
                                    node.appendChild(scriptu);
                                } else {
                                    node.replaceChild(scriptu, scripto);
                                }
                            },
                            _deleteScript: function (callbackId) {
                                var script = document.getElementById('results' + callbackId);
                                if (script) {
                                    var node = script.parentNode || document.documentElement;
                                    if (!node) {
                                        return;
                                    }
                                    node.removeChild(script);
                                }
                            }
                        };
                        __webpack_exports__['a'] = JSONP;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_2__AltiRequestREST__ = __webpack_require__(55);
                        var __WEBPACK_IMPORTED_MODULE_3__AltiRequestWPS__ = __webpack_require__(56);
                        var AltiRequestFactory = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('AltiRequestFactory');
                                logger.trace(['AltiRequestFactory::build()']);
                                var request = null;
                                var settings = {
                                    type: options.sampling ? 'Profil' : 'Elevation',
                                    method: options.httpMethod,
                                    param: {
                                        positions: null,
                                        delimiter: null,
                                        indent: null,
                                        crs: null,
                                        format: null,
                                        sampling: null,
                                        zonly: null
                                    }
                                };
                                settings.param.positions = options.positions;
                                settings.param.format = options.outputFormat;
                                settings.param.sampling = options.sampling;
                                settings.param.zonly = options.zonly;
                                var bOnError = !!(options.onError !== null && typeof options.onError === 'function');
                                var bOnSuccess = !!(options.onSuccess !== null && typeof options.onSuccess === 'function');
                                var message = null;
                                switch (options.api) {
                                case 'REST':
                                    var myReq = new __WEBPACK_IMPORTED_MODULE_2__AltiRequestREST__['a'](settings);
                                    if (!myReq.processRequestString()) {
                                        message = 'Error in process request (rest) !';
                                        if (bOnError) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'](message));
                                            return;
                                        }
                                        throw new Error(message);
                                    }
                                    request = myReq.requestString;
                                    break;
                                case 'WPS':
                                    settings.wps = {
                                        service: null,
                                        version: null,
                                        identifier: null,
                                        rawdataoutput: null,
                                        request: null
                                    };
                                    request = __WEBPACK_IMPORTED_MODULE_3__AltiRequestWPS__['a'].build(settings);
                                    if (!request) {
                                        message = 'Error in process request (wps) !';
                                        if (bOnError) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'](message));
                                            return;
                                        }
                                        throw new Error(message);
                                    }
                                    break;
                                default:
                                    message = 'Type of API is not supported by service (REST or WPS) !';
                                    if (bOnError) {
                                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'](message));
                                        return;
                                    }
                                    throw new Error(message);
                                }
                                if (bOnSuccess) {
                                    options.onSuccess.call(options.scope, request);
                                }
                                return request;
                            }
                        };
                        __webpack_exports__['a'] = AltiRequestFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__model_AltiElevationRequest__ = __webpack_require__(21);
                        var __WEBPACK_IMPORTED_MODULE_3__model_AltiProfilRequest__ = __webpack_require__(23);
                        function AltiRequestREST(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('AltiRequestREST');
                            this.logger.trace('[Constructeur AltiRequestREST ()]');
                            if (!(this instanceof AltiRequestREST)) {
                                throw new TypeError('AltiRequestREST constructor cannot be called as a function.');
                            }
                            this.options = options || {};
                            if (!this.options) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_EMPTY', 'options'));
                            }
                            if (!this.options.type) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_EMPTY', 'type (Elevation or Profil)'));
                            }
                            this.DataObject = null;
                            switch (this.options.type) {
                            case 'Elevation':
                                this.DataObject = new __WEBPACK_IMPORTED_MODULE_2__model_AltiElevationRequest__['a'](this.options.param);
                                break;
                            case 'Profil':
                                this.DataObject = new __WEBPACK_IMPORTED_MODULE_3__model_AltiProfilRequest__['a'](this.options.param);
                                break;
                            default:
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_TYPE', 'type (Elevation or Profil)'));
                            }
                            this.method = this.options.method || 'GET';
                        }
                        AltiRequestREST.prototype = {
                            requestString: null,
                            constructor: AltiRequestREST,
                            template: {
                                get: {
                                    value: 'lon=__LON__&lat=__LAT__&indent=__INDENT__&crs=\'__CRS__\'',
                                    input: {
                                        point: '&zonly=__ZONLY__',
                                        profil: '&sampling=__SAMPLING__'
                                    }
                                },
                                post: {
                                    value: 'lon=__LON__\n' + 'lat=__LAT__\n' + 'indent=__INDENT__\n' + 'crs=\'__CRS__\'\n',
                                    input: {
                                        point: 'zonly=__ZONLY__',
                                        profil: 'sampling=__SAMPLING__'
                                    }
                                }
                            },
                            processRequestString: function () {
                                this.logger.trace('AltiRequestREST::processRequestString ()');
                                var template = '';
                                if (this.method === 'POST') {
                                    template = this.template.post.value;
                                } else if (this.method === 'GET') {
                                    template = this.template.get.value;
                                }
                                template = template.replace(/__LON__/g, this.DataObject.getLon());
                                template = template.replace(/__LAT__/g, this.DataObject.getLat());
                                template = template.replace(/__INDENT__/g, this.DataObject.indent);
                                template = template.replace(/__CRS__/g, this.DataObject.crs);
                                template = template + this.__addDataInputs();
                                this.logger.trace('traduction tmpl', template);
                                this.requestString = template;
                                return this.requestString;
                            },
                            __addDataInputs: function () {
                                this.logger.trace('AltiRequestREST::addDataInput ()');
                                var myTemplate;
                                if (this.method === 'POST') {
                                    myTemplate = this.template.post;
                                } else if (this.method === 'GET') {
                                    myTemplate = this.template.get;
                                } else {
                                    throw new Error('No other HTTP method supported by the service !');
                                }
                                var tmpl = null;
                                if (this.DataObject.CLASSNAME === 'AltiElevationRequest') {
                                    tmpl = myTemplate.input.point;
                                    return tmpl.replace(/__ZONLY__/g, this.DataObject.zonly);
                                } else if (this.DataObject.CLASSNAME === 'AltiProfilRequest') {
                                    tmpl = myTemplate.input.profil;
                                    return tmpl.replace(/__SAMPLING__/g, this.DataObject.sampling);
                                } else {
                                    throw new Error('No other object supported than elevation or profil !?');
                                }
                            }
                        };
                        __webpack_exports__['a'] = AltiRequestREST;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Formats_WPS__ = __webpack_require__(57);
                        var __WEBPACK_IMPORTED_MODULE_3__model_AltiElevationRequest__ = __webpack_require__(21);
                        var __WEBPACK_IMPORTED_MODULE_4__model_AltiProfilRequest__ = __webpack_require__(23);
                        var AltiRequestWPS = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('AltiRequestWPS');
                                logger.trace(['AltiRequestWPS::build()']);
                                if (!options) {
                                    throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_EMPTY', 'options'));
                                }
                                if (!options.type) {
                                    throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_EMPTY', 'type (Elevation or Profil)'));
                                }
                                var DataObject = null;
                                switch (options.type) {
                                case 'Elevation':
                                    options.wps.identifier = 'gs:WPSElevation';
                                    DataObject = new __WEBPACK_IMPORTED_MODULE_3__model_AltiElevationRequest__['a'](options.param);
                                    break;
                                case 'Profil':
                                    options.wps.identifier = 'gs:WPSLineElevation';
                                    DataObject = new __WEBPACK_IMPORTED_MODULE_4__model_AltiProfilRequest__['a'](options.param);
                                    break;
                                default:
                                    throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_TYPE', 'type (Elevation or Profil)'));
                                }
                                var settings = {
                                    data: DataObject,
                                    method: options.method,
                                    param: options.wps
                                };
                                var rqstWPS = new __WEBPACK_IMPORTED_MODULE_2__Formats_WPS__['a'](settings);
                                if (!rqstWPS.processRequestString()) {
                                    throw new Error('Enable to process request !');
                                }
                                return rqstWPS.requestString;
                            }
                        };
                        __webpack_exports__['a'] = AltiRequestWPS;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function WPS(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur WPS()]');
                            if (!(this instanceof WPS)) {
                                throw new TypeError('WPS constructor cannot be called as a function.');
                            }
                            this.options = options || {};
                            this.DataObject = this.options.data;
                            if (!this.DataObject) {
                                throw new TypeError('This data object is not defined !');
                            }
                            this.paramservice = this.options.param.service || 'WPS';
                            this.paramversion = this.options.param.version || '1.0.0';
                            this.paramidentifier = this.options.param.identifier || 'gs:WPS';
                            this.paramrawdataoutput = this.options.param.rawdataoutput || 'result';
                            this.paramrequest = this.options.param.request || 'Execute';
                            this.method = this.options.method || 'GET';
                        }
                        WPS.prototype = {
                            requestString: null,
                            constructor: WPS,
                            template: {
                                get: {
                                    value: 'service=__SERVICE__' + '&version=__VERSION__' + '&rawdataoutput=__RAWDATAOUTPUT__' + '&identifier=__IDENTIFIER__' + '&request=__REQUEST__' + '&datainputs=<!-- __DATAINPUTS__ -->',
                                    input: '__KEY__=__DATA__'
                                },
                                post: {
                                    value: '<?xml version="1.0" encoding="UTF-8"?>' + '<wps:__REQUEST__ version="__VERSION__" service="__SERVICE__" ' + '__NAMESPACE__ __SCHEMALOCATION__>' + '<ows:Identifier>__IDENTIFIER__</ows:Identifier>' + '<wps:DataInputs>' + '<!-- __DATAINPUTS__ -->' + '</wps:DataInputs>' + '<wps:ResponseForm>' + '<wps:RawDataOutput>' + '<ows:Identifier>__RAWDATAOUTPUT__</ows:Identifier>' + '</wps:RawDataOutput>' + '</wps:ResponseForm>' + '</wps:__REQUEST__>',
                                    input: '<wps:Input>' + '<ows:Identifier>__KEY__</ows:Identifier>' + '<wps:Data>' + '<wps:LiteralData>__DATA__</wps:LiteralData>' + '</wps:Data>' + '</wps:Input>'
                                }
                            },
                            namespaceByDefault: function () {
                                var ns = [
                                    'xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',
                                    'xmlns="http://www.opengis.net/wps/1.0.0"',
                                    'xmlns:wfs="http://www.opengis.net/wfs"',
                                    'xmlns:wps="http://www.opengis.net/wps/1.0.0"',
                                    'xmlns:ows="http://www.opengis.net/ows/1.1"',
                                    'xmlns:gml="http://www.opengis.net/gml"',
                                    'xmlns:ogc="http://www.opengis.net/ogc"',
                                    'xmlns:wcs="http://www.opengis.net/wcs/1.1.1"',
                                    'xmlns:xlink="http://www.w3.org/1999/xlink"'
                                ];
                                return ns.join(' ');
                            },
                            schemaLocationByDefault: function () {
                                return 'xsi:schemaLocation="http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd"';
                            },
                            processRequestString: function () {
                                this.logger.trace('WPS::processRequestString ()');
                                var template = '';
                                if (this.method === 'POST') {
                                    template = this.template.post.value;
                                } else if (this.method === 'GET') {
                                    template = this.template.get.value;
                                } else {
                                    this.logger.error('No other method supported by the service !');
                                    return false;
                                }
                                template = template.replace(/__SERVICE__/g, this.paramservice);
                                template = template.replace(/__VERSION__/g, this.paramversion);
                                template = template.replace(/__RAWDATAOUTPUT__/g, this.paramrawdataoutput);
                                template = template.replace(/__IDENTIFIER__/g, this.paramidentifier);
                                template = template.replace(/__REQUEST__/g, this.paramrequest);
                                if (this.method === 'POST') {
                                    template = template.replace(/__NAMESPACE__/g, this.namespaceByDefault);
                                    template = template.replace(/__SCHEMALOCATION__/g, this.schemaLocationByDefault);
                                }
                                template = template.replace(/<!-- __DATAINPUTS__ -->/g, this.__addDataInputs());
                                if (!template) {
                                    this.logger.warn('traduction tmpl : empty request !?');
                                    return false;
                                }
                                this.requestString = template;
                                this.logger.trace('traduction tmpl', template);
                                return true;
                            },
                            __addDataInputs: function () {
                                this.logger.trace('WPS::__addDataInputs ()');
                                var tmpl = this.method === 'GET' ? this.template.get.input : this.template.post.input;
                                var sep = this.method === 'GET' ? ';' : '';
                                var result = '';
                                var that = this;
                                var map = this.DataObject.getData();
                                for (var i = 0; i < map.length; i++) {
                                    (function (j) {
                                        if (sep) {
                                            sep = j === map.length - 1 ? '' : ';';
                                        }
                                        result = result.concat(that.__addDataInput(tmpl, map[j].k, map[j].v), sep);
                                    }(i));
                                }
                                return result;
                            },
                            __addDataInput: function (tmpl, key, data) {
                                var tmp = tmpl;
                                tmp = tmp.replace(/__KEY__/g, key);
                                tmp = tmp.replace(/__DATA__/g, data);
                                return tmp;
                            },
                            setMethod: function (method) {
                                if (method === 'GET' || method === 'POST') {
                                    this.method = method;
                                } else {
                                    this.logger.warn('support only GET and POST method !');
                                }
                            },
                            getMethod: function () {
                                return this.method;
                            }
                        };
                        __webpack_exports__['a'] = WPS;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(6);
                        var __WEBPACK_IMPORTED_MODULE_4__Formats_AltiResponseReader__ = __webpack_require__(59);
                        var __WEBPACK_IMPORTED_MODULE_5__model_AltiResponse__ = __webpack_require__(9);
                        var __WEBPACK_IMPORTED_MODULE_6__model_Elevation__ = __webpack_require__(10);
                        var AltiResponseFactory = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('AltiResponseFactory');
                                logger.trace(['AltiResponseFactory::build()']);
                                var data = null;
                                if (options.response) {
                                    if (options.rawResponse) {
                                        logger.trace('analyze response : raw');
                                        data = options.response;
                                    } else {
                                        switch (options.outputFormat) {
                                        case 'xml':
                                            logger.trace('analyze response : xml');
                                            try {
                                                var p = new __WEBPACK_IMPORTED_MODULE_3__Formats_XML__['a']({ reader: __WEBPACK_IMPORTED_MODULE_4__Formats_AltiResponseReader__['a'] });
                                                if (typeof options.response === 'string') {
                                                    p.setXMLString(options.response);
                                                } else {
                                                    p.setXMLDoc(options.response);
                                                }
                                                data = p.parse();
                                                if (!data) {
                                                    throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION_2'));
                                                }
                                            } catch (e) {
                                                var message = e.message;
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                    message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', message),
                                                    status: 200,
                                                    type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                                }));
                                                return;
                                            }
                                            break;
                                        case 'json':
                                            logger.trace('analyze response : json');
                                            logger.trace('analyze response : ', typeof options.response);
                                            var JSONResponse;
                                            if (typeof options.response === 'string') {
                                                JSONResponse = JSON.parse(options.response);
                                            } else {
                                                JSONResponse = options.response;
                                            }
                                            if (JSONResponse.error) {
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                    message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', JSONResponse.error.description),
                                                    status: 200,
                                                    type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                                }));
                                                return;
                                            }
                                            if (JSONResponse) {
                                                var elevations = JSONResponse.elevations;
                                                var altiResponse = new __WEBPACK_IMPORTED_MODULE_5__model_AltiResponse__['a']();
                                                var elevation;
                                                if (Array.isArray(elevations) && elevations.length) {
                                                    for (var i = 0; i < elevations.length; i++) {
                                                        elevation = new __WEBPACK_IMPORTED_MODULE_6__model_Elevation__['a']();
                                                        if (typeof elevations[i] === 'object') {
                                                            if (elevations[i].lon) {
                                                                elevation.lon = elevations[i].lon;
                                                            }
                                                            if (elevations[i].lat) {
                                                                elevation.lat = elevations[i].lat;
                                                            }
                                                            if (elevations[i].z) {
                                                                elevation.z = elevations[i].z;
                                                            }
                                                            if (elevations[i].acc) {
                                                                elevation.acc = elevations[i].acc;
                                                            }
                                                        } else if (typeof elevations[i] === 'number') {
                                                            elevation.z = elevations[i];
                                                        }
                                                        if (Array.isArray(altiResponse.elevations)) {
                                                            altiResponse.elevations.push(elevation);
                                                        }
                                                    }
                                                }
                                                data = altiResponse;
                                            }
                                            if (!data) {
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                    message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_ANALYSE_2'),
                                                    type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_UNKERR,
                                                    status: -1
                                                }));
                                                return;
                                            }
                                            break;
                                        default:
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_FORMAT_2'),
                                                type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_UNKERR,
                                                status: -1
                                            }));
                                            return;
                                        }
                                        if (data.exceptionReport) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', data.exceptionReport),
                                                type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR,
                                                status: 200
                                            }));
                                            return;
                                        } else if (data.error) {
                                            var errorMess = data.error.description;
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', errorMess),
                                                type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR,
                                                status: 200
                                            }));
                                            return;
                                        }
                                    }
                                } else {
                                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                                    return;
                                }
                                options.onSuccess.call(options.scope, data);
                            }
                        };
                        __webpack_exports__['a'] = AltiResponseFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Response_model_AltiResponse__ = __webpack_require__(9);
                        var __WEBPACK_IMPORTED_MODULE_1__Response_model_Elevation__ = __webpack_require__(10);
                        var AltiResponseReader = {};
                        AltiResponseReader.READERS = {
                            elevations: function (root) {
                                var altiResponse = new __WEBPACK_IMPORTED_MODULE_0__Response_model_AltiResponse__['a']();
                                if (root.hasChildNodes()) {
                                    var children = root.childNodes;
                                    var child;
                                    var elevation;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        if (AltiResponseReader.READERS[child.nodeName]) {
                                            elevation = AltiResponseReader.READERS[child.nodeName](child);
                                            altiResponse.elevations.push(elevation);
                                        }
                                    }
                                }
                                return altiResponse;
                            },
                            elevation: function (node) {
                                var elevation = new __WEBPACK_IMPORTED_MODULE_1__Response_model_Elevation__['a']();
                                if (node.hasChildNodes()) {
                                    var children = node.childNodes;
                                    var child;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        if (AltiResponseReader.READERS[child.nodeName]) {
                                            AltiResponseReader.READERS[child.nodeName](child, elevation);
                                        }
                                    }
                                }
                                return elevation;
                            },
                            lat: function (node, elevation) {
                                var textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    elevation.lat = parseFloat(textNode.nodeValue);
                                } else {
                                    throw new Error('Erreur dans la lecture de la réponse du service : latitude attendue mais absente');
                                }
                            },
                            lon: function (node, elevation) {
                                var textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    elevation.lon = parseFloat(textNode.nodeValue);
                                } else {
                                    throw new Error('Erreur dans la lecture de la réponse du service : longitude attendue mais absente');
                                }
                            },
                            z: function (node, elevation) {
                                var textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    if (elevation) {
                                        elevation.z = parseFloat(textNode.nodeValue);
                                    } else {
                                        elevation = new __WEBPACK_IMPORTED_MODULE_1__Response_model_Elevation__['a']();
                                        elevation.z = parseFloat(textNode.nodeValue);
                                        return elevation;
                                    }
                                } else {
                                    throw new Error('Erreur dans la lecture de la réponse du service : altitude attendue mais absente');
                                }
                            },
                            acc: function (node, elevation) {
                                var textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    elevation.acc = parseFloat(textNode.nodeValue);
                                } else {
                                    throw new Error('Erreur dans la lecture de la réponse du service : précision (acc) attendue mais absente');
                                }
                            },
                            exceptionreport: function (node) {
                                var response = {};
                                if (node.hasChildNodes()) {
                                    var children = node.childNodes;
                                    var child;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        if (child.nodeName === 'Exception') {
                                            response.exceptionReport = AltiResponseReader.READERS.exception(child);
                                        }
                                    }
                                }
                                return response;
                            },
                            exception: function (node) {
                                var exceptionReport = {};
                                var exceptionCode = node.getAttribute('exceptionCode');
                                if (exceptionCode) {
                                    exceptionReport.exceptionCode = exceptionCode;
                                }
                                var textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    exceptionReport.exception = textNode.nodeValue;
                                }
                                return exceptionReport;
                            },
                            error: function (node) {
                                var response = { error: {} };
                                if (node.hasChildNodes()) {
                                    var children = node.childNodes;
                                    var child;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        var textNode;
                                        if (child.nodeType === 1 && child.nodeName === 'code') {
                                            textNode = child.firstChild;
                                            if (textNode && textNode.nodeType === 3) {
                                                response.error.code = textNode.nodeValue;
                                            }
                                        }
                                        if (child.nodeType === 1 && child.nodeName === 'description') {
                                            textNode = child.firstChild;
                                            if (textNode && textNode.nodeType === 3) {
                                                response.error.description = textNode.nodeValue;
                                            }
                                        }
                                    }
                                }
                                return response;
                            }
                        };
                        AltiResponseReader.read = function (root) {
                            if (root.nodeName === 'elevations') {
                                var altiResponse = AltiResponseReader.READERS.elevations(root);
                                return altiResponse;
                            } else if (root.nodeName === 'ExceptionReport') {
                                var exceptionReport = AltiResponseReader.READERS.exceptionreport(root);
                                return exceptionReport;
                            } else if (root.nodeName === 'error') {
                                var error = AltiResponseReader.READERS.error(root);
                                return error;
                            } else {
                                throw new Error('Erreur lors de la lecture de la réponse : elle n\'est pas au format attendu.');
                            }
                        };
                        __webpack_exports__['a'] = AltiResponseReader;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Utils_Helper__ = __webpack_require__(4);
                        var __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__ = __webpack_require__(5);
                        var __WEBPACK_IMPORTED_MODULE_5__CommonService__ = __webpack_require__(3);
                        var __WEBPACK_IMPORTED_MODULE_6__Response_AutoConfResponseFactory__ = __webpack_require__(61);
                        function AutoConf(options) {
                            if (!(this instanceof AutoConf)) {
                                throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('CLASS_CONSTRUCTOR', 'AutoConf'));
                            }
                            this.CLASSNAME = 'AutoConf';
                            if (!options) {
                                options = {};
                            }
                            options.protocol = options.protocol || 'JSONP';
                            __WEBPACK_IMPORTED_MODULE_5__CommonService__['a'].apply(this, arguments);
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('Gp.Services.AutoConf');
                            this.logger.trace('[Constructeur AutoConf (options)]');
                            if (!this.options.serverUrl) {
                                if (!this.options.serverUrl) {
                                    var lstUrlByDefault = __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__['a'].AutoConf.url(this.options.apiKey);
                                    if (!this.options.layerId) {
                                        if (Array.isArray(this.options.apiKey) && this.options.apiKey.length > 0) {
                                            this.options.serverUrl = lstUrlByDefault.apiKeys;
                                        } else {
                                            this.options.serverUrl = lstUrlByDefault.apiKey;
                                        }
                                    } else {
                                        this.options.serverUrl = lstUrlByDefault.aggregate + this.options.layerId;
                                    }
                                }
                            }
                            if (this.options.protocol === 'XHR' && this.options.httpMethod === 'POST') {
                                this.logger.warn('Le service ne gére pas le mode d\'interrogation en POST, on bascule sur du GET !');
                                this.options.httpMethod = 'GET';
                            }
                            this.options.outputFormat = this.options.rawResponse ? '' : 'xml';
                        }
                        AutoConf.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_5__CommonService__['a'].prototype, {});
                        AutoConf.prototype.constructor = AutoConf;
                        AutoConf.prototype.buildRequest = function (error, success) {
                            var scope = typeof window !== 'undefined' ? window : {};
                            if (scope.Gp && scope.Gp.Config && scope.Gp.Config.generalOptions && scope.Gp.Config.layers) {
                                if (scope.Gp.Config.generalOptions.apiKeys[this.options.apiKey]) {
                                    if (this.options.layerId) {
                                        if (scope.Gp.Config.layers[this.options.layerId] && scope.Gp.Config.layers[this.options.layerId].aggregatedLayers) {
                                            this.logger.warn('Gp.Config existe déjà pour cette clé et cette couche');
                                            this.options.onSuccess.call(this, scope.Gp.Config);
                                            return;
                                        }
                                    } else {
                                        this.logger.warn('Gp.Config existe déjà pour cette clé');
                                        this.options.onSuccess.call(this, scope.Gp.Config);
                                        return;
                                    }
                                }
                            }
                            this.request = '';
                            var bLocal;
                            if (this.options.serverUrl.indexOf('http://') === -1) {
                                bLocal = true;
                            } else {
                                bLocal = false;
                            }
                            if (!bLocal && this.layerId) {
                                this.request = __WEBPACK_IMPORTED_MODULE_2__Utils_Helper__['a'].normalyzeParameters({ layerId: this.layerId });
                            }
                            this.request || this.request === '' ? success.call(this, this.request) : error.call(this, new __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_REQUEST_BUILD')));
                        };
                        AutoConf.prototype.analyzeResponse = function (error, success) {
                            if (this.response) {
                                var options = {
                                    layerId: this.options.layerId,
                                    response: this.response,
                                    rawResponse: this.options.rawResponse,
                                    onSuccess: success,
                                    onError: error,
                                    scope: this
                                };
                                __WEBPACK_IMPORTED_MODULE_6__Response_AutoConfResponseFactory__['a'].build(options);
                            } else {
                                error.call(this, new __WEBPACK_IMPORTED_MODULE_3__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                            }
                        };
                        __webpack_exports__['a'] = AutoConf;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(6);
                        var __WEBPACK_IMPORTED_MODULE_4__Formats_AutoConfResponseReader__ = __webpack_require__(62);
                        var AutoConfReponseFactory = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('AutoConfResponseFactory');
                                logger.trace(['AutoConfResponseFactory::build()']);
                                var data = null;
                                if (options.response) {
                                    if (options.rawResponse) {
                                        data = options.response;
                                    } else {
                                        try {
                                            var p = new __WEBPACK_IMPORTED_MODULE_3__Formats_XML__['a']({ reader: __WEBPACK_IMPORTED_MODULE_4__Formats_AutoConfResponseReader__['a'] });
                                            if (typeof options.response === 'string') {
                                                p.setXMLString(options.response);
                                            } else {
                                                p.setXMLDoc(options.response);
                                            }
                                            data = p.parse();
                                        } catch (e) {
                                            var message = e.message;
                                            if (typeof options.response === 'string') {
                                                message += '\n (raw response service\'' + options.response + '\')';
                                            } else {
                                                message += '\n (raw response service\'' + options.response.documentElement.innerHTML + '\')';
                                            }
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', message),
                                                status: 200,
                                                type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                            }));
                                            return;
                                        }
                                        var isEmpty = true;
                                        for (var key in data) {
                                            if (data.hasOwnProperty(key)) {
                                                isEmpty = false;
                                            }
                                        }
                                        if (isEmpty) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY_2')));
                                            return;
                                        }
                                        if (data.exceptionReport) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', data.exceptionReport),
                                                type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR,
                                                status: 200
                                            }));
                                            return;
                                        }
                                    }
                                } else {
                                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                                    return;
                                }
                                var scope = typeof window !== 'undefined' ? window : {};
                                if (!scope.Gp) {
                                    scope.Gp = {};
                                }
                                if (!scope.Gp.Config) {
                                    scope.Gp.Config = data;
                                } else {
                                    this.mergeConfig(scope.Gp.Config, data, options.layerId);
                                }
                                options.onSuccess.call(options.scope, scope.Gp.Config);
                            },
                            mergeConfig: function (GpConfig, data, layerId) {
                                if (data && GpConfig) {
                                    for (var prop in data) {
                                        if (data.hasOwnProperty(prop)) {
                                            if (prop === 'generalOptions') {
                                                for (var key in data[prop].apiKeys) {
                                                    if (data[prop].apiKeys.hasOwnProperty(key) && !GpConfig.generalOptions.apiKeys[key]) {
                                                        GpConfig.generalOptions.apiKeys[key] = data[prop].apiKeys[key];
                                                    }
                                                }
                                            } else {
                                                if (GpConfig[prop]) {
                                                    for (var obj in data[prop]) {
                                                        if (data[prop].hasOwnProperty(obj) && !GpConfig[prop][obj]) {
                                                            GpConfig[prop][obj] = data[prop][obj];
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    if (layerId) {
                                        var aggregatedLayers = [];
                                        for (var lyr in data.layers) {
                                            if (data.layers.hasOwnProperty(lyr)) {
                                                aggregatedLayers.push(lyr);
                                            }
                                        }
                                        if (GpConfig.layers[layerId]) {
                                            GpConfig.layers[layerId].aggregatedLayers = aggregatedLayers;
                                        }
                                    }
                                }
                            }
                        };
                        __webpack_exports__['a'] = AutoConfReponseFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Response_model_AutoConfResponse__ = __webpack_require__(24);
                        var __WEBPACK_IMPORTED_MODULE_1__Response_model_Constraint__ = __webpack_require__(25);
                        var __WEBPACK_IMPORTED_MODULE_2__Response_model_Format__ = __webpack_require__(26);
                        var __WEBPACK_IMPORTED_MODULE_3__Response_model_Layer__ = __webpack_require__(27);
                        var __WEBPACK_IMPORTED_MODULE_4__Response_model_Legend__ = __webpack_require__(28);
                        var __WEBPACK_IMPORTED_MODULE_5__Response_model_Metadata__ = __webpack_require__(29);
                        var __WEBPACK_IMPORTED_MODULE_6__Response_model_Originator__ = __webpack_require__(30);
                        var __WEBPACK_IMPORTED_MODULE_7__Response_model_Service__ = __webpack_require__(31);
                        var __WEBPACK_IMPORTED_MODULE_8__Response_model_Style__ = __webpack_require__(32);
                        var __WEBPACK_IMPORTED_MODULE_9__Response_model_Territory__ = __webpack_require__(33);
                        var __WEBPACK_IMPORTED_MODULE_10__Response_model_Thematic__ = __webpack_require__(34);
                        var __WEBPACK_IMPORTED_MODULE_11__Response_model_TileMatrixSet__ = __webpack_require__(35);
                        var __WEBPACK_IMPORTED_MODULE_12__Response_model_TileMatrix__ = __webpack_require__(36);
                        var __WEBPACK_IMPORTED_MODULE_13__Response_model_TileMatrixLimit__ = __webpack_require__(37);
                        var AutoConfResponseReader = {};
                        AutoConfResponseReader.VERSION = '1.1.0';
                        AutoConfResponseReader.NAMESPACES = {
                            xmlns: 'http://www.opengis.net/context',
                            gpp: 'http://api.ign.fr/geoportail',
                            ows: 'http://www.opengis.net/ows/1.1',
                            sld: 'http://www.opengis.net/sld',
                            wmts: 'http://www.opengis.net/wmts/1.0',
                            xlink: 'http://www.w3.org/1999/xlink',
                            xsi: 'http://www.w3.org/2001/XMLSchema-instance'
                        };
                        AutoConfResponseReader.SCHEMALOCATION = [
                            'http://www.opengis.net/context http://gpp3-wxs.ign.fr/schemas/extContext.xsd http://api.ign.fr/geoportail http://wxs.ign.fr/schemas/autoconf/autoconf.xsd',
                            'http://www.opengis.net/context http://gpp3-wxs.ign.fr/schemas/extContext.xsd http://api.ign.fr/geoportail http://gpp3-wxs.ign.fr/schemas/autoconf.xsd'
                        ];
                        AutoConfResponseReader.DEFAULTPREFIX = 'context';
                        AutoConfResponseReader.READERS = {
                            context: {
                                ViewContext: function (viewContextNode) {
                                    __checkServiceAttributes(viewContextNode);
                                    var config = new __WEBPACK_IMPORTED_MODULE_0__Response_model_AutoConfResponse__['a']();
                                    __getChildNodes(viewContextNode, config);
                                    return config;
                                },
                                Title: function (titleNode, data) {
                                    if (data && data.generalOptions) {
                                        data.generalOptions.title = __getChildValue(titleNode);
                                    } else if (data && data.lyr) {
                                        data.lyr.title = __getChildValue(titleNode);
                                    }
                                },
                                Abstract: function (node, data) {
                                    if (data && data.lyr) {
                                        data.lyr.description = __getChildValue(node);
                                    }
                                },
                                Server: function (node, data) {
                                    var serverId = node.getAttribute('service');
                                    var title = node.getAttribute('title');
                                    var version = node.getAttribute('version');
                                    if (serverId) {
                                        if (data && data.services && typeof data.services === 'object' && !data.services[serverId]) {
                                            var s = new __WEBPACK_IMPORTED_MODULE_7__Response_model_Service__['a']();
                                            s.title = title;
                                            s.version = version;
                                            __getChildNodes(node, s);
                                            data.services[serverId] = s;
                                        } else if (data && data.lyr) {
                                            if (!data.lyr.serviceParams) {
                                                data.lyr.serviceParams = {};
                                            }
                                            data.lyr.serviceParams.id = serverId;
                                            data.lyr.serviceParams.version = version;
                                        }
                                    }
                                },
                                OnlineResource: function (node, service) {
                                    if (service && service.hasOwnProperty('serverUrl')) {
                                        service.serverUrl = node.getAttribute('xlink:href');
                                    }
                                },
                                LayerList: function (layerListNode, config) {
                                    __getChildNodes(layerListNode, config);
                                    if (config && config.layers && config.generalOptions && config.services) {
                                        for (var lyr in config.layers) {
                                            if (config.layers.hasOwnProperty(lyr)) {
                                                var layerConfig = config.layers[lyr];
                                                var apiKeys = layerConfig.apiKeys;
                                                if (apiKeys && Array.isArray(apiKeys)) {
                                                    for (var i = 0; i < apiKeys.length; i++) {
                                                        var key = apiKeys[i];
                                                        if (config.generalOptions.apiKeys) {
                                                            if (!config.generalOptions.apiKeys[key] || !Array.isArray(config.generalOptions.apiKeys[key])) {
                                                                config.generalOptions.apiKeys[key] = [];
                                                            }
                                                            config.generalOptions.apiKeys[key].push(lyr);
                                                        }
                                                    }
                                                }
                                                var serviceParams = layerConfig.serviceParams;
                                                if (serviceParams && serviceParams.id) {
                                                    if (!config.services[serviceParams.id]) {
                                                        var s = new __WEBPACK_IMPORTED_MODULE_7__Response_model_Service__['a']();
                                                        if (serviceParams.serverUrl) {
                                                            s.serverUrl = serviceParams.serverUrl;
                                                        }
                                                        if (serviceParams.version) {
                                                            s.version = serviceParams.version;
                                                        }
                                                        config.services[serviceParams.id] = s;
                                                    }
                                                }
                                                if (layerConfig.wmtsOptions && layerConfig.wmtsOptions.tileMatrixSetLink && config.tileMatrixSets) {
                                                    var tmsLink = layerConfig.wmtsOptions.tileMatrixSetLink;
                                                    var tileMatrixSets = config.tileMatrixSets;
                                                    for (var tms in tileMatrixSets) {
                                                        if (tileMatrixSets.hasOwnProperty(tms) && tms === tmsLink) {
                                                            layerConfig.defaultProjection = tileMatrixSets[tms].projection;
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                },
                                Layer: function (layerNode, config) {
                                    if (config && config.layers) {
                                        var lyrData = {
                                            lyr: new __WEBPACK_IMPORTED_MODULE_3__Response_model_Layer__['a'](),
                                            lyrId: null
                                        };
                                        var hidden = layerNode.getAttribute('hidden');
                                        if (hidden === '1') {
                                            lyrData.lyr.hidden = true;
                                        } else {
                                            lyrData.lyr.hidden = false;
                                        }
                                        var queryable = layerNode.getAttribute('queryable');
                                        if (queryable === '1') {
                                            lyrData.lyr.queryable = true;
                                        } else {
                                            lyrData.lyr.queryable = false;
                                        }
                                        __getChildNodes(layerNode, lyrData);
                                        if (lyrData.lyrId) {
                                            if (lyrData.lyr.serviceParams && lyrData.lyr.serviceParams.id) {
                                                var serviceid = lyrData.lyr.serviceParams.id;
                                                if (serviceid.toUpperCase().indexOf('OPENLS') !== -1 || serviceid.toUpperCase().indexOf('ELEVATION') !== -1) {
                                                    var resourceId = lyrData.lyrId.split('$')[0];
                                                    lyrData.lyrId = resourceId + '$' + serviceid;
                                                }
                                            }
                                            lyrData.lyr.layerId = lyrData.lyrId;
                                            config.layers[lyrData.lyrId] = lyrData.lyr;
                                        }
                                    }
                                },
                                Name: function (node, lyrData) {
                                    if (lyrData && lyrData.lyr) {
                                        lyrData.lyr.name = __getChildValue(node);
                                    }
                                },
                                SRS: function (node, lyrData) {
                                    if (lyrData && lyrData.lyr) {
                                        lyrData.lyr.defaultProjection = __getChildValue(node);
                                    }
                                },
                                Format: function (node, lyrData) {
                                    if (lyrData && lyrData.lyr) {
                                        var f = new __WEBPACK_IMPORTED_MODULE_2__Response_model_Format__['a']();
                                        var current = node.getAttribute('current');
                                        if (current === '1') {
                                            f.current = true;
                                        } else {
                                            f.current = false;
                                        }
                                        f.name = __getChildValue(node);
                                        if (!lyrData.lyr.formats || !Array.isArray(lyrData.lyr.formats)) {
                                            lyrData.lyr.formats = [];
                                        }
                                        lyrData.lyr.formats.push(f);
                                    }
                                },
                                Style: function (node, lyrData) {
                                    if (lyrData && lyrData.lyr) {
                                        var s = new __WEBPACK_IMPORTED_MODULE_8__Response_model_Style__['a']();
                                        var current = node.getAttribute('current');
                                        if (current === '1' || current === 1) {
                                            s.current = true;
                                        } else {
                                            s.current = false;
                                        }
                                        if (node.hasChildNodes) {
                                            var children = node.childNodes;
                                            var child;
                                            var childName;
                                            for (var i = 0; i < children.length; i++) {
                                                child = children[i];
                                                if (child.nodeType === 1) {
                                                    childName = child.localName || child.baseName || child.nodeName;
                                                    if (childName === 'Name') {
                                                        s.name = __getChildValue(child);
                                                    } else if (childName === 'Title') {
                                                        s.title = __getChildValue(child);
                                                    }
                                                }
                                            }
                                        }
                                        if (!lyrData.lyr.styles || !Array.isArray(lyrData.lyr.styles)) {
                                            lyrData.lyr.styles = [];
                                        }
                                        lyrData.lyr.styles.push(s);
                                    }
                                },
                                Dimension: function (node, lyrData) {
                                    var name = node.getAttribute('name');
                                    var dim = __getChildValue(node);
                                    if (lyrData && lyrData.lyr) {
                                        if (!lyrData.lyr.dimensions) {
                                            lyrData.lyr.dimensions = {};
                                        }
                                        if (name === 'Type') {
                                            lyrData.lyr.dimensions.type = dim;
                                        } else if (name === 'VisibilityRange') {
                                            lyrData.lyr.dimensions.visibilityRange = dim;
                                        } else if (name === 'VisibilityMode ') {
                                            lyrData.lyr.dimensions.visibilityMode = dim;
                                        } else if (name === 'GeometricType') {
                                            lyrData.lyr.dimensions.geometricType = dim;
                                        } else if (name === 'NoDataValue') {
                                            lyrData.lyr.dimensions.noDataValue = dim;
                                        }
                                    }
                                }
                            },
                            gpp: {
                                Theme: function (themeNode, config) {
                                    if (config && config.generalOptions && config.generalOptions.hasOwnProperty('theme')) {
                                        config.generalOptions.theme = __getChildValue(themeNode);
                                    }
                                },
                                defaultGMLGFIStyleUrl: function (node, config) {
                                    if (config && config.generalOptions && config.generalOptions.hasOwnProperty('defaultGMLGFIStyle')) {
                                        config.generalOptions.defaultGMLGFIStyle = __getChildValue(node);
                                    }
                                },
                                Territory: function (territoryNode, config) {
                                    var tid = territoryNode.getAttribute('id');
                                    if (tid) {
                                        var t = new __WEBPACK_IMPORTED_MODULE_9__Response_model_Territory__['a']();
                                        var isDefault = territoryNode.getAttribute('default');
                                        if (isDefault === '1') {
                                            t.isDefault = true;
                                        } else {
                                            t.isDefault = false;
                                        }
                                        __getChildNodes(territoryNode, t);
                                        if (config && config.territories && typeof config.territories === 'object') {
                                            config.territories[tid] = t;
                                        }
                                    }
                                },
                                defaultCRS: function (node, territory) {
                                    if (territory && territory.hasOwnProperty('defaultCRS')) {
                                        territory.defaultCRS = __getChildValue(node);
                                    }
                                },
                                AdditionalCRS: function (node, data) {
                                    var addCRS = __getChildValue(node);
                                    if (addCRS && data) {
                                        if (Array.isArray(data.additionalCRS)) {
                                            data.additionalCRS.push(addCRS);
                                        } else {
                                            if (!data.additionalProjections || !Array.isArray(data.additionalProjections)) {
                                                data.additionalProjections = [];
                                            }
                                            data.additionalProjections.push(addCRS);
                                        }
                                    }
                                },
                                DefaultLayer: function (node, territory) {
                                    var lyr = node.getAttribute('layerId');
                                    if (lyr && territory && Array.isArray(territory.defaultLayers)) {
                                        territory.defaultLayers.push(lyr);
                                    }
                                },
                                BoundingBox: function (node, data) {
                                    if (data) {
                                        var values = __getChildValue(node).split(',');
                                        if (values.length === 4) {
                                            var bbox = {
                                                left: parseFloat(values[0]),
                                                right: parseFloat(values[2]),
                                                top: parseFloat(values[3]),
                                                bottom: parseFloat(values[1])
                                            };
                                            var minT = node.getAttribute('minT');
                                            var maxT = node.getAttribute('maxT');
                                            if (data.hasOwnProperty('geoBBOX')) {
                                                data.geoBBOX = bbox;
                                            } else if (data.hasOwnProperty('bbox')) {
                                                if (data.bbox.left || data.bbox.right || data.bbox.top || data.bbox.bottom) {
                                                    if (!data.multiConstraints) {
                                                        data.multiConstraints = [];
                                                    }
                                                    var newConstraint = new __WEBPACK_IMPORTED_MODULE_1__Response_model_Constraint__['a']();
                                                    newConstraint.bbox = bbox;
                                                    newConstraint.temporalExtent = [
                                                        minT,
                                                        maxT
                                                    ];
                                                    data.multiConstraints.push(newConstraint);
                                                } else {
                                                    data.bbox = bbox;
                                                    data.temporalExtent = [
                                                        minT,
                                                        maxT
                                                    ];
                                                }
                                            } else {
                                                if (!data.globalConstraint) {
                                                    data.globalConstraint = new __WEBPACK_IMPORTED_MODULE_1__Response_model_Constraint__['a']();
                                                }
                                                data.globalConstraint.bbox = bbox;
                                                data.globalConstraint.temporalExtent = [
                                                    minT,
                                                    maxT
                                                ];
                                            }
                                        }
                                    }
                                },
                                Resolution: function (node, territory) {
                                    var res = __getChildValue(node);
                                    if (res && territory && territory.defaultOptions && territory.defaultOptions.hasOwnProperty('resolution')) {
                                        territory.defaultOptions.resolution = parseFloat(res);
                                    }
                                },
                                x: function (node, territory) {
                                    var lon = __getChildValue(node);
                                    if (lon && territory && territory.geoCenter && territory.geoCenter.hasOwnProperty('lon')) {
                                        territory.geoCenter.lon = parseFloat(lon);
                                    }
                                },
                                y: function (node, territory) {
                                    var lat = __getChildValue(node);
                                    if (lat && territory && territory.geoCenter && territory.geoCenter.hasOwnProperty('lat')) {
                                        territory.geoCenter.lat = parseFloat(lat);
                                    }
                                },
                                Resolutions: function (resNode, config) {
                                    if (config && config.generalOptions && config.generalOptions.hasOwnProperty('wgs84Resolutions')) {
                                        config.generalOptions.wgs84Resolutions = __getChildValue(resNode).split(',');
                                    }
                                },
                                Layer: function (node, lyrData) {
                                    if (lyrData && lyrData.hasOwnProperty('lyrId') && lyrData.lyr) {
                                        lyrData.lyrId = node.getAttribute('id');
                                        var aggregate = node.getAttribute('aggregate');
                                        var more = node.getAttribute('more');
                                        if (aggregate || more) {
                                            lyrData.lyr.isAggregate = true;
                                        }
                                        __getChildNodes(node, lyrData.lyr);
                                    }
                                },
                                Constraint: function (node, data) {
                                    var c = new __WEBPACK_IMPORTED_MODULE_1__Response_model_Constraint__['a']();
                                    __getChildNodes(node, c);
                                    if (data) {
                                        if (!data.constraints || !Array.isArray(data.constraints)) {
                                            data.constraints = [];
                                        }
                                        if (c.multiConstraints && Array.isArray(c.multiConstraints)) {
                                            var constraint = new __WEBPACK_IMPORTED_MODULE_1__Response_model_Constraint__['a']();
                                            constraint.crs = c.crs;
                                            constraint.bbox = c.bbox;
                                            constraint.minScaleDenominator = c.minScaleDenominator;
                                            constraint.maxScaleDenominator = c.maxScaleDenominator;
                                            constraint.temporalExtent = c.temporalExtent;
                                            data.constraints.push(constraint);
                                            for (var i = 0; i < c.multiConstraints.length; i++) {
                                                constraint = new __WEBPACK_IMPORTED_MODULE_1__Response_model_Constraint__['a']();
                                                constraint.crs = c.crs;
                                                constraint.minScaleDenominator = c.minScaleDenominator;
                                                constraint.maxScaleDenominator = c.maxScaleDenominator;
                                                constraint.bbox = c.multiConstraints[i].bbox;
                                                constraint.temporalExtent = c.multiConstraints[i].temporalExtent;
                                                data.constraints.push(constraint);
                                            }
                                        } else {
                                            data.constraints.push(c);
                                        }
                                    }
                                },
                                CRS: function (node, data) {
                                    if (data && data.hasOwnProperty('crs')) {
                                        data.crs = __getChildValue(node);
                                    }
                                },
                                Thematic: function (node, lyr) {
                                    if (lyr) {
                                        var t = new __WEBPACK_IMPORTED_MODULE_10__Response_model_Thematic__['a']();
                                        t.inspire = false;
                                        t.name = __getChildValue(node);
                                        if (!lyr.thematics || !Array.isArray(lyr.thematics)) {
                                            lyr.thematics = [];
                                        }
                                        lyr.thematics.push(t);
                                    }
                                },
                                InspireThematic: function (node, lyr) {
                                    if (lyr) {
                                        var t = new __WEBPACK_IMPORTED_MODULE_10__Response_model_Thematic__['a']();
                                        t.inspire = true;
                                        t.name = __getChildValue(node);
                                        if (!lyr.thematics || !Array.isArray(lyr.thematics)) {
                                            lyr.thematics = [];
                                        }
                                        lyr.thematics.push(t);
                                    }
                                },
                                Originator: function (node, lyr) {
                                    if (lyr) {
                                        var o = new __WEBPACK_IMPORTED_MODULE_6__Response_model_Originator__['a']();
                                        o.name = node.getAttribute('name');
                                        __getChildNodes(node, o);
                                        if (!lyr.originators || !Array.isArray(lyr.originators)) {
                                            lyr.originators = [];
                                        }
                                        lyr.originators.push(o);
                                    }
                                },
                                Attribution: function (node, originator) {
                                    if (originator && originator.hasOwnProperty('attribution')) {
                                        originator.attribution = __getChildValue(node);
                                    }
                                },
                                Logo: function (node, originator) {
                                    if (originator && originator.hasOwnProperty('logo')) {
                                        originator.logo = __getChildValue(node);
                                    }
                                },
                                URL: function (node, originator) {
                                    if (originator && originator.hasOwnProperty('url')) {
                                        originator.url = __getChildValue(node);
                                    }
                                },
                                Legend: function (node, lyr) {
                                    var l = new __WEBPACK_IMPORTED_MODULE_4__Response_model_Legend__['a']();
                                    __getChildNodes(node, l);
                                    if (lyr) {
                                        if (!lyr.legends || !Array.isArray(lyr.legends)) {
                                            lyr.legends = [];
                                        }
                                        lyr.legends.push(l);
                                    }
                                },
                                LegendURL: function (node, legend) {
                                    if (legend && legend.hasOwnProperty('format')) {
                                        legend.format = node.getAttribute('format');
                                        if (node.hasChildNodes) {
                                            var child = node.childNodes[0];
                                            var childName = child.localName || child.baseName || child.nodeName;
                                            if (childName === 'OnlineResource' && legend.hasOwnProperty('url')) {
                                                legend.url = child.getAttribute('xlink:href');
                                            }
                                        }
                                    }
                                },
                                QuickLook: function (node, lyr) {
                                    if (node.hasChildNodes) {
                                        var child = node.childNodes[0];
                                        var childName = child.localName || child.baseName || child.nodeName;
                                        if (childName === 'OnlineResource' && lyr) {
                                            lyr.quicklookUrl = child.getAttribute('xlink:href');
                                        }
                                    }
                                },
                                MetadataURL: function (node, lyr) {
                                    if (lyr) {
                                        var m = new __WEBPACK_IMPORTED_MODULE_5__Response_model_Metadata__['a']();
                                        m.format = node.getAttribute('format');
                                        if (node.hasChildNodes) {
                                            var child = node.childNodes[0];
                                            var childName = child.localName || child.baseName || child.nodeName;
                                            if (childName === 'OnlineResource') {
                                                m.url = child.getAttribute('xlink:href');
                                            }
                                        }
                                        if (!lyr.metadata && !Array.isArray(lyr.metadata)) {
                                            lyr.metadata = [];
                                        }
                                        lyr.metadata.push(m);
                                    }
                                },
                                Key: function (node, lyr) {
                                    if (lyr) {
                                        var key = node.getAttribute('id');
                                        if (!lyr.apiKeys || !Array.isArray(lyr.apiKeys)) {
                                            lyr.apiKeys = [];
                                        }
                                        lyr.apiKeys.push(key);
                                        var serverUrl = __getChildValue(node);
                                        if (!lyr.serviceParams) {
                                            lyr.serviceParams = {};
                                        }
                                        if (!lyr.serviceParams.serverUrl) {
                                            lyr.serviceParams.serverUrl = {};
                                        }
                                        if (!lyr.serviceParams.serverUrl[key]) {
                                            lyr.serviceParams.serverUrl[key] = serverUrl;
                                        }
                                    }
                                }
                            },
                            ows: {
                                Identifier: function (node, data) {
                                    if (data && data.hasOwnProperty('TMS')) {
                                        data.identifier = __getChildValue(node);
                                    } else if (data && data.hasOwnProperty('matrixId')) {
                                        data.matrixId = __getChildValue(node);
                                    }
                                },
                                SupportedCRS: function (node, tmsData) {
                                    if (tmsData && tmsData.TMS && tmsData.TMS.hasOwnProperty('projection')) {
                                        tmsData.TMS.projection = __getChildValue(node);
                                    }
                                }
                            },
                            sld: {
                                MinScaleDenominator: function (node, data) {
                                    var minScale = __getChildValue(node);
                                    if (minScale && data) {
                                        if (data.hasOwnProperty('defaultOptions')) {
                                            data.defaultOptions.minScaleDenominator = parseFloat(minScale);
                                        } else if (data.lyr) {
                                            if (!data.lyr.globalConstraint) {
                                                data.lyr.globalConstraint = new __WEBPACK_IMPORTED_MODULE_1__Response_model_Constraint__['a']();
                                            }
                                            data.lyr.globalConstraint.minScaleDenominator = parseFloat(minScale);
                                        } else if (data.hasOwnProperty('minScaleDenominator')) {
                                            data.minScaleDenominator = parseFloat(minScale);
                                        }
                                    }
                                },
                                MaxScaleDenominator: function (node, data) {
                                    var maxScale = __getChildValue(node);
                                    if (maxScale && data) {
                                        if (data.hasOwnProperty('defaultOptions')) {
                                            data.defaultOptions.maxScaleDenominator = parseFloat(maxScale);
                                        } else if (data.lyr) {
                                            if (!data.lyr.globalConstraint) {
                                                data.lyr.globalConstraint = new __WEBPACK_IMPORTED_MODULE_1__Response_model_Constraint__['a']();
                                            }
                                            data.lyr.globalConstraint.maxScaleDenominator = parseFloat(maxScale);
                                        } else if (data.hasOwnProperty('maxScaleDenominator')) {
                                            data.maxScaleDenominator = parseFloat(maxScale);
                                        }
                                    }
                                }
                            },
                            wmts: {
                                TileMatrixSetLimits: function (node, lyr) {
                                    if (lyr) {
                                        var limits = {};
                                        __getChildNodes(node, limits);
                                        if (!lyr.wmtsOptions) {
                                            lyr.wmtsOptions = {};
                                        }
                                        lyr.wmtsOptions.tileMatrixSetLimits = limits;
                                    }
                                },
                                TileMatrixLimits: function (node, limits) {
                                    var limit = new __WEBPACK_IMPORTED_MODULE_13__Response_model_TileMatrixLimit__['a']();
                                    var limitId;
                                    if (node.hasChildNodes) {
                                        var children = node.childNodes;
                                        for (var i = 0; i < children.length; i++) {
                                            var child = children[i];
                                            var childName = child.localName || child.baseName || child.nodeName;
                                            if (childName === 'TileMatrix') {
                                                limitId = __getChildValue(child);
                                            } else if (childName === 'MinTileRow') {
                                                limit.minTileRow = __getChildValue(child);
                                            } else if (childName === 'MaxTileRow') {
                                                limit.maxTileRow = __getChildValue(child);
                                            } else if (childName === 'MinTileCol') {
                                                limit.minTileCol = __getChildValue(child);
                                            } else if (childName === 'MaxTileCol') {
                                                limit.maxTileCol = __getChildValue(child);
                                            }
                                        }
                                        if (limitId && limits && !limits[limitId]) {
                                            limits[limitId] = limit;
                                        }
                                    }
                                },
                                TileMatrixSet: function (node, data) {
                                    if (data && data.tileMatrixSets) {
                                        var tmsData = {};
                                        tmsData.TMS = new __WEBPACK_IMPORTED_MODULE_11__Response_model_TileMatrixSet__['a']();
                                        tmsData.resolutions = [];
                                        __getChildNodes(node, tmsData);
                                        var tileMatrices = tmsData.TMS.tileMatrices;
                                        for (var tm in tileMatrices) {
                                            if (tileMatrices.hasOwnProperty(tm)) {
                                                tmsData.TMS.matrixIds.push(tm);
                                            }
                                        }
                                        if (tmsData.TMS.getProjection() === 'IGNF:WGS84G' || tmsData.TMS.getProjection() === 'EPSG:4326') {
                                            if (data.generalOptions && Array.isArray(data.generalOptions.wgs84Resolutions)) {
                                                var wgs84Resolutions = data.generalOptions.wgs84Resolutions;
                                                for (var i = 0; i < wgs84Resolutions.length; i++) {
                                                    tmsData.resolutions[i] = parseFloat(wgs84Resolutions[i]);
                                                }
                                            }
                                        }
                                        if (Array.isArray(tmsData.resolutions) && tmsData.resolutions.sort !== undefined) {
                                            tmsData.resolutions.sort(function (x, y) {
                                                return y - x;
                                            });
                                        }
                                        tmsData.TMS.nativeResolutions = tmsData.resolutions;
                                        data.tileMatrixSets[tmsData.identifier] = tmsData.TMS;
                                    } else {
                                        if (data && !data.wmtsOptions) {
                                            data.wmtsOptions = {};
                                        }
                                        data.wmtsOptions.tileMatrixSetLink = __getChildValue(node);
                                    }
                                },
                                TileMatrix: function (node, tmsData) {
                                    if (tmsData) {
                                        var tileMatrix = new __WEBPACK_IMPORTED_MODULE_12__Response_model_TileMatrix__['a']();
                                        __getChildNodes(node, tileMatrix);
                                        if (tmsData.TMS && tmsData.TMS.getProjection()) {
                                            var proj = tmsData.TMS.getProjection();
                                            if (proj === 'EPSG:3857' || proj === 'EPSG:2154') {
                                                var r = tileMatrix.scaleDenominator * 0.00028;
                                                if (tmsData.resolutions && Array.isArray(tmsData.resolutions)) {
                                                    tmsData.resolutions.push(r);
                                                }
                                            }
                                        }
                                        if (tmsData.TMS && tmsData.TMS.tileMatrices) {
                                            tmsData.TMS.tileMatrices[tileMatrix.matrixId] = tileMatrix;
                                        }
                                    }
                                },
                                ScaleDenominator: function (node, tileMatrix) {
                                    var scale = __getChildValue(node);
                                    if (scale && tileMatrix && tileMatrix.hasOwnProperty('scaleDenominator')) {
                                        tileMatrix.scaleDenominator = parseFloat(scale);
                                    }
                                },
                                TopLeftCorner: function (node, tileMatrix) {
                                    var values = __getChildValue(node).split(' ');
                                    if (values && tileMatrix) {
                                        tileMatrix.topLeftCorner = {};
                                        tileMatrix.topLeftCorner.x = parseFloat(values[0]);
                                        tileMatrix.topLeftCorner.y = parseFloat(values[1]);
                                    }
                                },
                                TileWidth: function (node, tileMatrix) {
                                    var value = __getChildValue(node);
                                    if (value && tileMatrix && tileMatrix.hasOwnProperty('tileWidth')) {
                                        tileMatrix.tileWidth = parseInt(value, 10);
                                    }
                                },
                                TileHeight: function (node, tileMatrix) {
                                    var value = __getChildValue(node);
                                    if (value && tileMatrix && tileMatrix.hasOwnProperty('tileHeight')) {
                                        tileMatrix.tileHeight = parseInt(value, 10);
                                    }
                                },
                                MatrixWidth: function (node, tileMatrix) {
                                    var value = __getChildValue(node);
                                    if (value && tileMatrix && tileMatrix.hasOwnProperty('matrixWidth')) {
                                        tileMatrix.matrixWidth = parseInt(value, 10);
                                    }
                                },
                                MatrixHeight: function (node, tileMatrix) {
                                    var value = __getChildValue(node);
                                    if (value && tileMatrix && tileMatrix.hasOwnProperty('matrixHeight')) {
                                        tileMatrix.matrixHeight = parseInt(value, 10);
                                    }
                                }
                            },
                            serviceException: function (node) {
                                var response = {};
                                if (node.hasChildNodes()) {
                                    var children = node.childNodes;
                                    var child;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        if (child.nodeName === 'exception') {
                                            response.exceptionReport = AutoConfResponseReader.READERS['exception'](child);
                                        }
                                    }
                                }
                                return response;
                            },
                            exception: function (node) {
                                var exceptionReport = {};
                                var exceptionCode = node.getAttribute('code');
                                if (exceptionCode) {
                                    exceptionReport.exceptionCode = exceptionCode;
                                }
                                var textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    exceptionReport.exception = textNode.nodeValue;
                                }
                                return exceptionReport;
                            }
                        };
                        AutoConfResponseReader.read = function (root) {
                            if (root.nodeName === 'ViewContext') {
                                var nsPrefix = root.prefix || AutoConfResponseReader.DEFAULTPREFIX;
                                var config = AutoConfResponseReader.READERS[nsPrefix][root.nodeName](root);
                                return config;
                            } else if (root.nodeName === 'serviceException') {
                                var exceptionReport = AutoConfResponseReader.READERS[root.nodeName](root);
                                return exceptionReport;
                            } else {
                                throw new Error('Erreur lors de la lecture de la réponse : elle n\'est pas au format attendu.');
                            }
                        };
                        function __getAttributes(node) {
                            if (node.attributes.length > 0) {
                                var nodeAttributes = {};
                                var attributes = node.attributes;
                                for (var i = 0; i < attributes.length; i++) {
                                    var attribute = attributes[i];
                                    nodeAttributes[attribute.nodeName] = attribute.nodeValue;
                                }
                                return nodeAttributes;
                            }
                        }
                        function __getChildNodes(node, data) {
                            if (node.hasChildNodes()) {
                                var children = node.childNodes;
                                var child;
                                var childName;
                                var childPrefix;
                                for (var i = 0; i < children.length; i++) {
                                    child = children[i];
                                    if (child.nodeType === 1) {
                                        childName = child.localName || child.baseName || child.nodeName;
                                        childPrefix = child.prefix || AutoConfResponseReader.DEFAULTPREFIX;
                                        if (AutoConfResponseReader.READERS[childPrefix][childName]) {
                                            var reader = AutoConfResponseReader.READERS[childPrefix][childName];
                                            reader(child, data);
                                        } else {
                                            __getChildNodes(child, data);
                                        }
                                    }
                                }
                            }
                        }
                        function __getChildValue(node) {
                            var textNode;
                            var value = '';
                            if (node.hasChildNodes()) {
                                textNode = node.firstChild;
                                if (textNode.nodeType === 3 || textNode.nodeType === 4) {
                                    value = textNode.nodeValue;
                                }
                            }
                            return value;
                        }
                        function __checkServiceAttributes(viewContextNode) {
                            if (viewContextNode.attributes.length > 0) {
                                var xlsAttributes = __getAttributes(viewContextNode);
                                for (var att in xlsAttributes) {
                                    if (xlsAttributes.hasOwnProperty(att)) {
                                        if (att === 'version') {
                                            if (xlsAttributes['version'] !== AutoConfResponseReader.VERSION) {
                                                console.log('[AutoConfResponseReader] autoconf version is not the expected one : there may be errors in parsing');
                                                return;
                                            }
                                        }
                                        if (att === 'xmlns') {
                                            if (xlsAttributes[att] !== AutoConfResponseReader.NAMESPACES.xmlns) {
                                                console.log('[AutoConfResponseReader] autoconf response default namespace is not the expected one');
                                                return;
                                            }
                                            continue;
                                        }
                                        var prefix = att.split(':')[0];
                                        var ns = att.split(':')[1];
                                        if (prefix === 'xmlns' && ns) {
                                            if (AutoConfResponseReader.NAMESPACES[ns]) {
                                                if (AutoConfResponseReader.NAMESPACES[ns] !== xlsAttributes[att]) {
                                                    console.log('[AutoConfResponseReader] autoconf response ' + att + ' namespace is not the expected one');
                                                    return;
                                                }
                                            }
                                        }
                                        if (ns === 'schemaLocation') {
                                            if (xlsAttributes[att] !== AutoConfResponseReader.SCHEMALOCATION[0] && xlsAttributes[att] !== AutoConfResponseReader.SCHEMALOCATION[1]) {
                                                console.log('[AutoConfResponseReader] autoconf response schema location is not the expected one');
                                                return;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        __webpack_exports__['a'] = AutoConfResponseReader;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__CommonService__ = __webpack_require__(3);
                        var __WEBPACK_IMPORTED_MODULE_4__Request_DirectGeocodeRequestFactory__ = __webpack_require__(64);
                        var __WEBPACK_IMPORTED_MODULE_5__Response_DirectGeocodeResponseFactory__ = __webpack_require__(76);
                        function Geocode(options) {
                            if (!(this instanceof Geocode)) {
                                throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('CLASS_CONSTRUCTOR', 'Geocode'));
                            }
                            this.CLASSNAME = 'Geocode';
                            __WEBPACK_IMPORTED_MODULE_3__CommonService__['a'].apply(this, arguments);
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('Gp.Services.Geocode');
                            this.logger.trace('[Constructeur Geocode (options)]');
                            if (!options.location) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'location'));
                            }
                            if (typeof options.location === 'object' && Object.keys(options.location).length === 0) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_EMPTY', 'location'));
                            } else if (typeof options.location === 'string' && options.location.length === 0) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_EMPTY', 'location'));
                            }
                            this.options.location = options.location;
                            if (!options.filterOptions || typeof options.filterOptions !== 'object') {
                                this.options.filterOptions = options.filterOptions = { type: ['StreetAddress'] };
                            }
                            if (Object.keys(options.filterOptions).length === 0) {
                                this.options.filterOptions = { type: ['StreetAddress'] };
                            }
                            var filter = Object.keys(options.filterOptions);
                            for (var i = 0; i < filter.length; i++) {
                                var key = filter[i];
                                var filtersCouldBeNumberList = [
                                    'department',
                                    'number',
                                    'postalCode',
                                    'insee',
                                    'importance',
                                    'ID',
                                    'IDTR',
                                    'absorbedCity',
                                    'sheet',
                                    'section',
                                    'inseeRegion',
                                    'inseeDepartment'
                                ];
                                if (filtersCouldBeNumberList.indexOf(key) !== -1 && typeof options.filterOptions[key] !== 'string') {
                                    options.filterOptions[key] = options.filterOptions[key].toString();
                                }
                                if (!options.filterOptions[key]) {
                                    delete this.options.filterOptions[key];
                                }
                            }
                            this.options.filterOptions.type = options.filterOptions.type || ['StreetAddress'];
                            this.options.maximumResponses = options.maximumResponses || 25;
                            this.options.returnFreeForm = options.returnFreeForm || false;
                            this.options.srs = options.srs || 'EPSG:4326';
                            this.options.outputFormat = this.options.rawResponse ? '' : 'xml';
                        }
                        Geocode.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__CommonService__['a'].prototype, {});
                        Geocode.prototype.constructor = Geocode;
                        Geocode.prototype.buildRequest = function (error, success) {
                            var options = {
                                httpMethod: this.options.httpMethod,
                                location: this.options.location,
                                returnFreeForm: this.options.returnFreeForm,
                                filterOptions: this.options.filterOptions,
                                srs: this.options.srs,
                                maximumResponses: this.options.maximumResponses
                            };
                            this.request = __WEBPACK_IMPORTED_MODULE_4__Request_DirectGeocodeRequestFactory__['a'].build(options);
                            !this.request ? error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_REQUEST_BUILD'))) : success.call(this, this.request);
                        };
                        Geocode.prototype.analyzeResponse = function (error, success) {
                            if (this.response) {
                                var options = {
                                    response: this.response,
                                    rawResponse: this.options.rawResponse,
                                    onError: error,
                                    onSuccess: success,
                                    scope: this
                                };
                                __WEBPACK_IMPORTED_MODULE_5__Response_DirectGeocodeResponseFactory__['a'].build(options);
                            } else {
                                error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                            }
                        };
                        __webpack_exports__['a'] = Geocode;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__ = __webpack_require__(11);
                        var __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_LocationUtilityService__ = __webpack_require__(38);
                        var __WEBPACK_IMPORTED_MODULE_3__Formats_XLS_LocationUtilityService_GeocodeFilterExtension__ = __webpack_require__(13);
                        var __WEBPACK_IMPORTED_MODULE_4__Request_model_StreetAddress__ = __webpack_require__(72);
                        var __WEBPACK_IMPORTED_MODULE_5__Request_model_PositionOfInterest__ = __webpack_require__(73);
                        var __WEBPACK_IMPORTED_MODULE_6__Request_model_CadastralParcel__ = __webpack_require__(74);
                        var __WEBPACK_IMPORTED_MODULE_7__Request_model_Administratif__ = __webpack_require__(75);
                        var DirectGeocodeRequestFactory = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('DirectGeocodeRequestFactory');
                                logger.trace(['DirectGeocodeRequestFactory::build()']);
                                var request = null;
                                var oFilter = new __WEBPACK_IMPORTED_MODULE_3__Formats_XLS_LocationUtilityService_GeocodeFilterExtension__['a']();
                                oFilter.addFilterExtensions(new __WEBPACK_IMPORTED_MODULE_7__Request_model_Administratif__['a']());
                                oFilter.addFilterExtensions(new __WEBPACK_IMPORTED_MODULE_4__Request_model_StreetAddress__['a']());
                                oFilter.addFilterExtensions(new __WEBPACK_IMPORTED_MODULE_5__Request_model_PositionOfInterest__['a']());
                                oFilter.addFilterExtensions(new __WEBPACK_IMPORTED_MODULE_6__Request_model_CadastralParcel__['a']());
                                var oLUS = new __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_LocationUtilityService__['a']({
                                    location: options.location,
                                    returnFreeForm: options.returnFreeForm,
                                    filterOptions: options.filterOptions
                                });
                                oLUS.addFilter(oFilter);
                                var oXLS = new __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__['a']({
                                    srsName: options.srs,
                                    maximumResponses: options.maximumResponses
                                });
                                oXLS.namespace = true;
                                oXLS.setService(oLUS);
                                request = oXLS.build();
                                if (options.httpMethod === 'GET') {
                                    var myRequest = 'qxml=' + encodeURIComponent(request).replace(/-/g, '%2D').replace(/_/g, '%5F').replace(/\./g, '%2E').replace(/!/g, '%21').replace(/~/g, '%7E').replace(/\*/g, '%2A').replace(/'/g, '%27').replace(/\(/g, '%28').replace(/\)/g, '%29');
                                    request = myRequest;
                                }
                                logger.trace(request);
                                return request;
                            }
                        };
                        __webpack_exports__['a'] = DirectGeocodeRequestFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function RequestHeader(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur RequestHeader ()]');
                            if (!(this instanceof RequestHeader)) {
                                throw new TypeError('RequestHeader constructor cannot be called as a function.');
                            }
                            this.options = options || { srsName: 'EPSG:4326' };
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    this.options[opt] = options[opt];
                                }
                            }
                        }
                        RequestHeader.prototype = {
                            requestString: null,
                            template: '<RequestHeader srsName="__SRSNAME__"/>',
                            constructor: RequestHeader,
                            toString: function () {
                                var template = null;
                                template = this.template;
                                template = template.replace(/__SRSNAME__/g, this.options.srsName);
                                this.requestString = template;
                                return this.requestString;
                            }
                        };
                        __webpack_exports__['a'] = RequestHeader;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function Request(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur Request ()]');
                            if (!(this instanceof Request)) {
                                throw new TypeError('Request constructor cannot be called as a function.');
                            }
                            this.options = options || {
                                maximumResponses: 25,
                                methodName: null,
                                version: '1.2'
                            };
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    this.options[opt] = options[opt];
                                }
                            }
                        }
                        Request.prototype = {
                            requestString: null,
                            template: '<Request maximumResponses="__MAXRESPONSES__" methodName="__METHODNAME__" requestID="__UUID__" version="__VERSION__">' + '<!-- __REQUESTSERVICE__ -->' + '</Request>',
                            constructor: Request,
                            guid: function () {
                                return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                                    var r = Math.random() * 16 | 0;
                                    var v = c === 'x' ? r : r & 3 | 8;
                                    return v.toString(16);
                                });
                            },
                            toString: function () {
                                var template = null;
                                template = this.template;
                                template = template.replace(/__MAXRESPONSES__/g, this.options.maximumResponses);
                                template = template.replace(/__METHODNAME__/g, this.options.methodName);
                                template = template.replace(/__UUID__/g, this.guid());
                                template = template.replace(/__VERSION__/g, this.options.version);
                                this.requestString = template;
                                return this.requestString;
                            }
                        };
                        __webpack_exports__['a'] = Request;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__model_Address__ = __webpack_require__(68);
                        var __WEBPACK_IMPORTED_MODULE_2__GeocodeFilterExtension__ = __webpack_require__(13);
                        function GeocodeRequest(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur GeocodeRequest ()]');
                            if (!(this instanceof GeocodeRequest)) {
                                throw new TypeError('GeocodeRequest constructor cannot be called as a function.');
                            }
                            this.options = options || {};
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    this.options[opt] = options[opt];
                                }
                            }
                            this.CLASSNAME = 'GeocodeRequest';
                        }
                        GeocodeRequest.prototype = {
                            strRequest: null,
                            oAddress: null,
                            oFilter: null,
                            template: '<GeocodeRequest returnFreeForm="__RETURNFREEFORM__">' + '__ADDRESS__' + '</GeocodeRequest>',
                            addAddress: function (oAddress) {
                                if (oAddress instanceof __WEBPACK_IMPORTED_MODULE_1__model_Address__['a']) {
                                    this.oAddress = oAddress;
                                }
                            },
                            addFilter: function (oFilter) {
                                if (oFilter instanceof __WEBPACK_IMPORTED_MODULE_2__GeocodeFilterExtension__['a']) {
                                    this.oFilter = oFilter;
                                }
                            },
                            constructor: GeocodeRequest,
                            toString: function () {
                                var template = '';
                                template = this.template;
                                if (!this.oAddress) {
                                    var settings = {};
                                    settings.location = this.options.location;
                                    settings.type = this.options.filterOptions.type || ['StreetAddress'];
                                    settings.filter = this.options.filterOptions;
                                    delete settings.filter.type;
                                    if (this.oFilter) {
                                        settings.filter = {};
                                        for (var idx in settings.type) {
                                            var filter = settings.type[idx];
                                            var oFilter = this.oFilter.getFilter(filter);
                                            if (!oFilter) {
                                                this.logger.warn('Le filtre \'' + filter + '\' n\'existe pas !?');
                                                continue;
                                            }
                                            var mFilter = this.options.filterOptions;
                                            var attributs = oFilter.attributesList;
                                            for (var idxe = 0; idxe < attributs.length; idxe++) {
                                                var key = attributs[idxe];
                                                if (mFilter[key]) {
                                                    var matchingKey = oFilter.serviceAttributes[idxe];
                                                    oFilter.placeAttributes[matchingKey] = mFilter[key];
                                                    this.logger.trace('Selection du filtre \'' + key + '\' sur le type \'' + filter + '\'.');
                                                }
                                            }
                                            var places = oFilter.placeAttributes;
                                            for (var kplace in places) {
                                                if (places.hasOwnProperty(kplace)) {
                                                    settings.filter[kplace] = places[kplace];
                                                }
                                            }
                                        }
                                    }
                                    this.oAddress = new __WEBPACK_IMPORTED_MODULE_1__model_Address__['a'](settings);
                                    if (!this.oAddress) {
                                        throw new Error('La construction de l\'adresse n\'est pas correctement definie !?');
                                    }
                                }
                                template = template.replace(/__ADDRESS__/g, this.oAddress.toString());
                                template = template.replace(/__RETURNFREEFORM__/g, this.options.returnFreeForm ? 'true' : 'false');
                                this.strRequest = template;
                                return this.strRequest;
                            }
                        };
                        __webpack_exports__['a'] = GeocodeRequest;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function Address(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('Address');
                            this.logger.trace('[Constructeur Address ()]');
                            if (!(this instanceof Address)) {
                                throw new TypeError('Address constructor cannot be called as a function.');
                            }
                            this.options = options || {
                                location: {},
                                type: ['StreetAddress'],
                                filter: {}
                            };
                            if (!options.location) {
                                throw new Error('l\'option \'location\' n\'est pas renseignée !');
                            }
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    this.options[opt] = options[opt];
                                }
                            }
                        }
                        Address.prototype = {
                            constructor: Address,
                            requestString: null,
                            template: {
                                address: '<Address countryCode="__COUNTRYCODE__">' + '__LOCATION__' + '__PLACE__' + '__POSTALCODE__' + '__ENVELOPE__' + '</Address>',
                                location: {
                                    freeFormAddress: '<freeFormAddress>__FREEFORMADDRESSVALUE__</freeFormAddress>',
                                    streetAddress: {
                                        container: '<StreetAddress>' + '__STREET__' + '__BUILDING__' + '</StreetAddress>',
                                        building: '<Building number="__BUILDINGVALUE__"/>',
                                        street: '<Street>__STREETVALUE__</Street>'
                                    }
                                },
                                place: '<Place type="__PLACETYPE__">__PLACEVALUE__</Place>',
                                postalCode: '<PostalCode>__POSTALCODEVALUE__</PostalCode>',
                                envelope: '<gml:Envelope>' + '<gml:lowerCorner>__LEFT__ __BOTTOM__</gml:lowerCorner>' + '<gml:upperCorner>__RIGHT__ __TOP__</gml:upperCorner>' + '</gml:Envelope>'
                            }
                        };
                        Address.prototype.toString = function () {
                            var template = null;
                            template = this.template.address;
                            template = template.replace(/__COUNTRYCODE__/g, this.options.type);
                            if (typeof this.options.location === 'string') {
                                var tmplFreeFormAddress = this.template.location.freeFormAddress;
                                tmplFreeFormAddress = tmplFreeFormAddress.replace(/__FREEFORMADDRESSVALUE__/g, this.options.location);
                                template = template.replace(/__LOCATION__/g, tmplFreeFormAddress);
                            } else {
                                var tmplBuilding = '';
                                var tmplStreet = '';
                                if (this.options.location.number) {
                                    tmplBuilding = this.template.location.streetAddress.building;
                                    tmplBuilding = tmplBuilding.replace(/__BUILDINGVALUE__/g, this.options.location.number);
                                }
                                if (this.options.location.street) {
                                    tmplStreet = this.template.location.streetAddress.street;
                                    tmplStreet = tmplStreet.replace(/__STREETVALUE__/g, this.options.location.street);
                                }
                                var tmplStreetAddress = this.template.location.streetAddress.container;
                                tmplStreetAddress = tmplStreetAddress.replace(/__STREET__/g, tmplStreet);
                                tmplStreetAddress = tmplStreetAddress.replace(/__BUILDING__/g, tmplBuilding);
                                template = template.replace(/__LOCATION__/g, tmplStreetAddress);
                            }
                            var tmplPostalCode = '';
                            if (this.options.location.postalCode) {
                                tmplPostalCode = this.template.postalCode;
                                tmplPostalCode = tmplPostalCode.replace(/__POSTALCODEVALUE__/g, this.options.location.postalCode);
                            }
                            var tmplEnvelope = '';
                            if (this.options.filter) {
                                var bbox = this.options.filter.bbox;
                                if (bbox) {
                                    tmplEnvelope = this.template.envelope;
                                    tmplEnvelope = tmplEnvelope.replace(/__LEFT__/g, bbox.left);
                                    tmplEnvelope = tmplEnvelope.replace(/__BOTTOM__/g, bbox.bottom);
                                    tmplEnvelope = tmplEnvelope.replace(/__RIGHT__/g, bbox.right);
                                    tmplEnvelope = tmplEnvelope.replace(/__TOP__/g, bbox.top);
                                }
                            }
                            var Places = [];
                            var tmplPlace = '';
                            if (this.options.filter) {
                                var filters = this.options.filter;
                                for (var filter in filters) {
                                    if (filter === 'bbox') {
                                        continue;
                                    }
                                    tmplPlace = this.template.place;
                                    tmplPlace = tmplPlace.replace(/__PLACETYPE__/g, filter);
                                    tmplPlace = tmplPlace.replace(/__PLACEVALUE__/g, filters[filter]);
                                    Places.push(tmplPlace);
                                }
                            }
                            var tmplPlaceCity = '';
                            if (this.options.location.city) {
                                tmplPlaceCity = this.template.place;
                                tmplPlaceCity = tmplPlaceCity.replace(/__PLACETYPE__/g, 'Municipality');
                                tmplPlaceCity = tmplPlaceCity.replace(/__PLACEVALUE__/g, this.options.location.city);
                                Places.push(tmplPlaceCity);
                            }
                            template = template.replace(/__POSTALCODE__/g, tmplPostalCode);
                            template = template.replace(/__PLACE__/g, Places.join('\n'));
                            template = template.replace(/__ENVELOPE__/g, tmplEnvelope);
                            this.requestString = template;
                            return this.requestString;
                        };
                        __webpack_exports__['a'] = Address;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__model_Position__ = __webpack_require__(70);
                        var __WEBPACK_IMPORTED_MODULE_2__model_Preference__ = __webpack_require__(71);
                        function ReverseGeocodeRequest(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur ReverseGeocodeRequest ()]');
                            if (!(this instanceof ReverseGeocodeRequest)) {
                                throw new TypeError('ReverseGeocodeRequest constructor cannot be called as a function.');
                            }
                            this.options = options || {};
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    this.options[opt] = options[opt];
                                }
                            }
                            this.CLASSNAME = 'ReverseGeocodeRequest';
                        }
                        ReverseGeocodeRequest.prototype = {
                            strRequest: null,
                            oPosition: null,
                            oPreference: null,
                            constructor: ReverseGeocodeRequest,
                            template: '<ReverseGeocodeRequest returnFreeForm="__RETURNFREEFORM__">' + '__POSITION__' + '__PREFERENCE__' + '</ReverseGeocodeRequest>',
                            addPosition: function (oPosition) {
                                if (oPosition instanceof __WEBPACK_IMPORTED_MODULE_1__model_Position__['a']) {
                                    this.oPosition = oPosition;
                                }
                            },
                            addPreferences: function (oPreference) {
                                if (oPreference instanceof __WEBPACK_IMPORTED_MODULE_2__model_Preference__['a']) {
                                    this.oPreference = oPreference;
                                }
                            },
                            toString: function () {
                                var template = '';
                                template = this.template;
                                if (!this.oPreference) {
                                    this.oPreference = new __WEBPACK_IMPORTED_MODULE_2__model_Preference__['a'](this.options.filterOptions.type || ['StreetAddress']);
                                    if (!this.oPreference) {
                                        throw new Error('Les preferences ne sont pas definies !?');
                                    }
                                }
                                template = template.replace(/__PREFERENCE__/g, this.oPreference.toString());
                                if (!this.oPosition) {
                                    var settings = {
                                        position: this.options.position,
                                        filter: {}
                                    };
                                    if (this.options.filterOptions) {
                                        settings.filter = this.options.filterOptions;
                                        delete settings.filter.type;
                                    }
                                    this.oPosition = new __WEBPACK_IMPORTED_MODULE_1__model_Position__['a'](settings);
                                    if (!this.oPosition) {
                                        throw new Error('La position et ses filtres ne sont pas definis !?');
                                    }
                                }
                                template = template.replace(/__POSITION__/g, this.oPosition.toString());
                                template = template.replace(/__RETURNFREEFORM__/g, this.options.returnFreeForm ? 'true' : 'false');
                                this.strRequest = template;
                                return this.strRequest;
                            }
                        };
                        __webpack_exports__['a'] = ReverseGeocodeRequest;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function Position(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('Position');
                            this.logger.trace('[Constructeur Position ()]');
                            if (!(this instanceof Position)) {
                                throw new TypeError('Position constructor cannot be called as a function.');
                            }
                            this.options = options || {};
                            if (!options.position) {
                                throw new Error('l\'option \'position\' n\'est pas renseignée !');
                            }
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    this.options[opt] = options[opt];
                                }
                            }
                        }
                        Position.prototype = {
                            constructor: Position,
                            requestString: null,
                            template: {
                                position: '<Position>' + '__GMLPOINT__' + '__GMLFILTER__' + '</Position>',
                                gml: {
                                    point: '<gml:Point xmlns:gml="http://www.opengis.net/gml"><gml:pos>__X__ __Y__</gml:pos></gml:Point>',
                                    pos: null,
                                    filter: {
                                        bbox: '<gml:Envelope xmlns:gml="http://www.opengis.net/gml">' + '<gml:lowerCorner>__LEFT__ __BOTTOM__</gml:lowerCorner>' + '<gml:upperCorner>__RIGHT__ __TOP__</gml:upperCorner>' + '</gml:Envelope>',
                                        circle: '<gml:CircleByCenterPoint xmlns:gml="http://www.opengis.net/gml"><gml:pos>__X__ __Y__</gml:pos><gml:radius>__RADIUS__</gml:radius></gml:CircleByCenterPoint>',
                                        polygon: '<gml:Polygon xmlns:gml="http://www.opengis.net/gml"><gml:exterior><gml:LinearRing><gml:posList>__XY__</gml:posList></gml:LinearRing></gml:exterior></gml:Polygon>',
                                        multipolygon: null
                                    }
                                }
                            }
                        };
                        Position.prototype.toString = function () {
                            var template = this.template.position;
                            var tmplGmlPoint = this.template.gml.point;
                            tmplGmlPoint = tmplGmlPoint.replace(/__X__/g, this.options.position.x);
                            tmplGmlPoint = tmplGmlPoint.replace(/__Y__/g, this.options.position.y);
                            var tmplGmlFilter = '';
                            if (this.options.filter) {
                                var filter = this.options.filter;
                                for (var name in filter) {
                                    switch (name) {
                                    case 'circle':
                                        tmplGmlFilter = this.template.gml.filter[name];
                                        tmplGmlFilter = tmplGmlFilter.replace(/__X__/g, filter[name].x);
                                        tmplGmlFilter = tmplGmlFilter.replace(/__Y__/g, filter[name].y);
                                        tmplGmlFilter = tmplGmlFilter.replace(/__RADIUS__/g, filter[name].radius);
                                        break;
                                    case 'bbox':
                                        tmplGmlFilter = this.template.gml.filter[name];
                                        tmplGmlFilter = tmplGmlFilter.replace(/__LEFT__/g, filter[name].left);
                                        tmplGmlFilter = tmplGmlFilter.replace(/__BOTTOM__/g, filter[name].bottom);
                                        tmplGmlFilter = tmplGmlFilter.replace(/__RIGHT__/g, filter[name].right);
                                        tmplGmlFilter = tmplGmlFilter.replace(/__TOP__/g, filter[name].top);
                                        break;
                                    case 'polygon':
                                        tmplGmlFilter = this.template.gml.filter[name];
                                        var strPoints = '';
                                        var lstPoints = filter[name];
                                        for (var i = 0; i < lstPoints.length; i++) {
                                            var coord = lstPoints[i];
                                            if (Array.isArray(coord)) {
                                                this.logger.error('Holes are not implemented !');
                                                break;
                                            }
                                            if (coord.x && coord.y || (coord.x === 0 || coord.y === 0)) {
                                                strPoints += coord.x + ' ' + coord.y;
                                            }
                                            if (lstPoints.length !== i + 1) {
                                                strPoints += ' ';
                                            }
                                        }
                                        tmplGmlFilter = tmplGmlFilter.replace(/__XY__/g, strPoints);
                                        break;
                                    case 'multipolygon':
                                        this.logger.warn('Filter \'' + name + '\' is not yet implemented !');
                                        break;
                                    default:
                                        this.logger.error('This filter \'' + name + '\' is not useful !');
                                    }
                                }
                            }
                            template = template.replace(/__GMLPOINT__/g, tmplGmlPoint);
                            template = template.replace(/__GMLFILTER__/g, tmplGmlFilter);
                            this.requestString = template;
                            return this.requestString;
                        };
                        __webpack_exports__['a'] = Position;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function Preference(type) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('Preference');
                            this.logger.trace('[Constructeur Preference ()]');
                            if (!(this instanceof Preference)) {
                                throw new TypeError('Preference constructor cannot be called as a function.');
                            }
                            this.type = type;
                        }
                        Preference.prototype = {
                            constructor: Preference,
                            requestString: null,
                            template: '<ReverseGeocodePreference>__TYPE__</ReverseGeocodePreference>'
                        };
                        Preference.prototype.toString = function () {
                            var Preferences = [];
                            var tmplPreference = '';
                            for (var idx = 0; idx < this.type.length; idx++) {
                                tmplPreference = this.template;
                                tmplPreference = tmplPreference.replace(/__TYPE__/g, this.type[idx]);
                                Preferences.push(tmplPreference);
                            }
                            this.strRequest = Preferences.join('\n');
                            return this.strRequest;
                        };
                        __webpack_exports__['a'] = Preference;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__ = __webpack_require__(7);
                        function StreetAddress() {
                            if (!(this instanceof StreetAddress)) {
                                throw new TypeError('StreetAddress constructor cannot be called as a function.');
                            }
                            __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__['a'].apply(this, arguments);
                            this.CLASSNAME = 'StreetAddress';
                            this.attributesList = [
                                'bbox',
                                'ID',
                                'IDTR',
                                'quality',
                                'territory',
                                'commune',
                                'department',
                                'insee',
                                'municipality'
                            ];
                            this.serviceAttributes = [
                                'bbox',
                                'ID',
                                'IDTR',
                                'Qualite',
                                'Territoire',
                                'Commune',
                                'Departement',
                                'INSEE',
                                'Municipality'
                            ];
                        }
                        StreetAddress.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__['a'].prototype);
                        StreetAddress.prototype.constructor = StreetAddress;
                        __webpack_exports__['a'] = StreetAddress;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__ = __webpack_require__(7);
                        function PositionOfInterest() {
                            if (!(this instanceof PositionOfInterest)) {
                                throw new TypeError('PositionOfInterest constructor cannot be called as a function.');
                            }
                            __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__['a'].apply(this, arguments);
                            this.CLASSNAME = 'PositionOfInterest';
                            this.attributesList = [
                                'bbox',
                                'importance',
                                'nature',
                                'territory',
                                'commune',
                                'department',
                                'insee',
                                'municipality'
                            ];
                            this.serviceAttributes = [
                                'bbox',
                                'Importance',
                                'Nature',
                                'Territoire',
                                'Commune',
                                'Departement',
                                'INSEE',
                                'Municipality'
                            ];
                        }
                        PositionOfInterest.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__['a'].prototype);
                        PositionOfInterest.prototype.constructor = PositionOfInterest;
                        __webpack_exports__['a'] = PositionOfInterest;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__ = __webpack_require__(7);
                        function CadastralParcel() {
                            if (!(this instanceof CadastralParcel)) {
                                throw new TypeError('CadastralParcel constructor cannot be called as a function.');
                            }
                            __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__['a'].apply(this, arguments);
                            this.CLASSNAME = 'CadastralParcel';
                            this.attributesList = [
                                'absorbedCity',
                                'sheet',
                                'number',
                                'section',
                                'commune',
                                'department',
                                'insee',
                                'municipality',
                                'origin'
                            ];
                            this.serviceAttributes = [
                                'CommuneAbsorbee',
                                'Feuille',
                                'Numero',
                                'Section',
                                'Commune',
                                'Departement',
                                'INSEE',
                                'Municipality',
                                'Type'
                            ];
                        }
                        CadastralParcel.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__['a'].prototype);
                        CadastralParcel.prototype.constructor = CadastralParcel;
                        __webpack_exports__['a'] = CadastralParcel;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__ = __webpack_require__(7);
                        function Administratif() {
                            if (!(this instanceof Administratif)) {
                                throw new TypeError('Administratif constructor cannot be called as a function.');
                            }
                            __WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__['a'].apply(this, arguments);
                            this.CLASSNAME = 'Administratif';
                            this.attributesList = [
                                'bbox',
                                'prefecture',
                                'inseeRegion',
                                'inseeDepartment',
                                'municipality'
                            ];
                            this.serviceAttributes = [
                                'bbox',
                                'Prefecture',
                                'InseeRegion',
                                'InseeDepartement',
                                'Municipality'
                            ];
                        }
                        Administratif.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__GeocodeLocation__['a'].prototype);
                        Administratif.prototype.constructor = Administratif;
                        __webpack_exports__['a'] = Administratif;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Formats_XML__ = __webpack_require__(6);
                        var __WEBPACK_IMPORTED_MODULE_3__Formats_DirectGeocodeResponseReader__ = __webpack_require__(77);
                        var DirectGeocodeReponseFactory = {
                            build: function (options) {
                                var data = null;
                                if (options.response) {
                                    if (options.rawResponse) {
                                        data = options.response;
                                    } else {
                                        try {
                                            var p = new __WEBPACK_IMPORTED_MODULE_2__Formats_XML__['a']({ reader: __WEBPACK_IMPORTED_MODULE_3__Formats_DirectGeocodeResponseReader__['a'] });
                                            if (typeof options.response === 'string') {
                                                p.setXMLString(options.response);
                                            } else {
                                                p.setXMLDoc(options.response);
                                            }
                                            data = p.parse();
                                            if (!data) {
                                                throw new Error('L\'analyse de la réponse du service !?');
                                            }
                                        } catch (e) {
                                            var message = e.message;
                                            if (typeof options.response === 'string') {
                                                message += '(\'' + options.response + '\')';
                                            } else {
                                                message += '(\'' + options.response.documentElement.innerHTML + '\')';
                                            }
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_0__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_ANALYSE', message),
                                                type: __WEBPACK_IMPORTED_MODULE_0__Exceptions_ErrorService__['a'].TYPE_UNKERR,
                                                status: -1
                                            }));
                                            return;
                                        }
                                        if (data.exceptionReport) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_0__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', data.exceptionReport),
                                                type: __WEBPACK_IMPORTED_MODULE_0__Exceptions_ErrorService__['a'].TYPE_SRVERR,
                                                status: 200
                                            }));
                                            return;
                                        }
                                    }
                                } else {
                                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_0__Exceptions_ErrorService__['a']({
                                        message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY'),
                                        type: __WEBPACK_IMPORTED_MODULE_0__Exceptions_ErrorService__['a'].TYPE_SRVERR,
                                        status: -1
                                    }));
                                    return;
                                }
                                options.onSuccess.call(options.scope, data);
                            }
                        };
                        __webpack_exports__['a'] = DirectGeocodeReponseFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_2__Response_model_GeocodeResponse__ = __webpack_require__(14);
                        var __WEBPACK_IMPORTED_MODULE_3__Response_model_DirectGeocodedLocation__ = __webpack_require__(39);
                        var DirectGeocodeResponseReader = {};
                        DirectGeocodeResponseReader.VERSION = '1.2';
                        DirectGeocodeResponseReader.NAMESPACES = {
                            xmlns: 'http://www.opengis.net/xls',
                            gml: 'http://www.opengis.net/gml',
                            xls: 'http://www.opengis.net/xls',
                            xlsext: 'http://www.opengis.net/xlsext',
                            xsi: 'http://www.w3.org/2001/XMLSchema-instance'
                        };
                        DirectGeocodeResponseReader.SCHEMALOCATION = 'http://wxs.ign.fr/schemas/olsAll.xsd';
                        DirectGeocodeResponseReader.DEFAULTPREFIX = 'xls';
                        DirectGeocodeResponseReader.READERS = {
                            xls: {
                                XLS: function (root) {
                                    var geocodeResponse = new __WEBPACK_IMPORTED_MODULE_2__Response_model_GeocodeResponse__['a']();
                                    __checkServiceAttributes(root);
                                    __getChildNodes(root, geocodeResponse);
                                    return geocodeResponse;
                                },
                                GeocodedAddress: function (node, geocodeResponse) {
                                    var geocodedLocation = new __WEBPACK_IMPORTED_MODULE_3__Response_model_DirectGeocodedLocation__['a']();
                                    __getChildNodes(node, geocodedLocation);
                                    if (geocodeResponse && Array.isArray(geocodeResponse.locations)) {
                                        geocodeResponse.locations.push(geocodedLocation);
                                    }
                                },
                                GeocodeMatchCode: function (node, geocodedLocation) {
                                    var acc = node.getAttribute('accuracy');
                                    if (acc && geocodedLocation) {
                                        geocodedLocation.accuracy = parseFloat(acc);
                                    }
                                    var matchType = node.getAttribute('matchType');
                                    if (matchType && geocodedLocation) {
                                        geocodedLocation.matchType = matchType;
                                    }
                                },
                                Address: function (node, geocodedLocation) {
                                    var countrycode = node.getAttribute('countryCode');
                                    if (geocodedLocation && countrycode) {
                                        geocodedLocation.type = countrycode;
                                    }
                                    __getChildNodes(node, geocodedLocation);
                                },
                                freeFormAddress: function (node, geocodedLocation) {
                                    if (geocodedLocation && geocodedLocation.hasOwnProperty('placeAttributes')) {
                                        geocodedLocation.placeAttributes.freeform = __getChildValue(node);
                                    }
                                },
                                Building: function (node, geocodedLocation) {
                                    var num = node.getAttribute('number');
                                    if (geocodedLocation && geocodedLocation.hasOwnProperty('placeAttributes')) {
                                        if (num) {
                                            geocodedLocation.placeAttributes.number = num;
                                        } else if (node.getAttribute('buildingName')) {
                                            geocodedLocation.placeAttributes.number = node.getAttribute('buildingName');
                                        } else if (node.getAttribute('subdivision')) {
                                            geocodedLocation.placeAttributes.number = node.getAttribute('subdivision');
                                        }
                                    }
                                },
                                Street: function (node, geocodedLocation) {
                                    if (geocodedLocation && geocodedLocation.hasOwnProperty('placeAttributes')) {
                                        if (geocodedLocation.type === 'StreetAddress') {
                                            geocodedLocation.placeAttributes.street = __getChildValue(node);
                                        } else if (geocodedLocation.type === 'CadastralParcel') {
                                            geocodedLocation.placeAttributes.cadastralParcel = __getChildValue(node);
                                        }
                                    }
                                },
                                Place: function (node, geocodedLocation) {
                                    var placeType = node.getAttribute('type');
                                    var placeName = __getChildValue(node);
                                    if (geocodedLocation && geocodedLocation.hasOwnProperty('placeAttributes')) {
                                        if (placeType === 'Municipality') {
                                            geocodedLocation.placeAttributes.municipality = placeName;
                                        } else if (placeType === 'Bbox') {
                                            var values = placeName.split(';');
                                            if (values.length === 4) {
                                                geocodedLocation.placeAttributes.bbox = {
                                                    left: parseFloat(values[0]),
                                                    right: parseFloat(values[2]),
                                                    top: parseFloat(values[1]),
                                                    bottom: parseFloat(values[3])
                                                };
                                            }
                                        } else if (placeType === 'Commune') {
                                            geocodedLocation.placeAttributes.commune = placeName;
                                        } else if (placeType === 'Departement') {
                                            geocodedLocation.placeAttributes.department = placeName;
                                        } else if (placeType === 'INSEE') {
                                            geocodedLocation.placeAttributes.insee = placeName;
                                        } else if (placeType === 'Qualite') {
                                            geocodedLocation.placeAttributes.quality = placeName;
                                        } else if (placeType === 'Territoire') {
                                            geocodedLocation.placeAttributes.territory = placeName;
                                        } else if (placeType === 'ID') {
                                            geocodedLocation.placeAttributes.ID = placeName;
                                        } else if (placeType === 'ID_TR') {
                                            geocodedLocation.placeAttributes.IDTR = placeName;
                                        } else if (placeType === 'Importance') {
                                            geocodedLocation.placeAttributes.importance = parseInt(placeName, 10);
                                        } else if (placeType === 'Nature') {
                                            geocodedLocation.placeAttributes.nature = placeName;
                                        } else if (placeType === 'Numero') {
                                            geocodedLocation.placeAttributes.number = placeName;
                                        } else if (placeType === 'Feuille') {
                                            geocodedLocation.placeAttributes.sheet = placeName;
                                        } else if (placeType === 'Section') {
                                            geocodedLocation.placeAttributes.section = placeName;
                                        } else if (placeType === 'CommuneAbsorbee') {
                                            geocodedLocation.placeAttributes.absorbedCity = placeName;
                                        } else if (placeType === 'Arrondissement') {
                                            if (placeName) {
                                                geocodedLocation.placeAttributes.arrondissement = placeName;
                                            }
                                        } else if (placeType === 'Type') {
                                            geocodedLocation.placeAttributes.origin = placeName;
                                        } else if (placeType === 'Prefecture') {
                                            geocodedLocation.placeAttributes.prefecture = placeName;
                                        } else if (placeType === 'InseeRegion') {
                                            geocodedLocation.placeAttributes.inseeRegion = placeName;
                                        } else if (placeType === 'InseeDepartment') {
                                            geocodedLocation.placeAttributes.inseeDepartment = placeName;
                                        }
                                    }
                                },
                                PostalCode: function (node, geocodedLocation) {
                                    if (geocodedLocation && geocodedLocation.hasOwnProperty('placeAttributes')) {
                                        geocodedLocation.placeAttributes.postalCode = __getChildValue(node);
                                    }
                                },
                                Error: function (node) {
                                    var srvMess = node.getAttribute('message');
                                    var errorCode = node.getAttribute('errorCode');
                                    var message = __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', '(' + errorCode + ') : ' + srvMess);
                                    throw new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a']({
                                        message: message,
                                        type: __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                    });
                                }
                            },
                            gml: {
                                pos: function (node, geocodedLocation) {
                                    var pos = __getChildValue(node);
                                    if (geocodedLocation && pos) {
                                        geocodedLocation.position = {
                                            x: parseFloat(pos.split(' ')[0]),
                                            y: parseFloat(pos.split(' ')[1])
                                        };
                                    }
                                }
                            },
                            ExceptionReport: function (node) {
                                var response = {};
                                if (node.hasChildNodes()) {
                                    var children = node.childNodes;
                                    var child;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        if (child.nodeName === 'Exception') {
                                            response.exceptionReport = DirectGeocodeResponseReader.READERS['Exception'](child);
                                        }
                                    }
                                }
                                return response;
                            },
                            Exception: function (node) {
                                var exceptionReport = {};
                                var exceptionCode = node.getAttribute('exceptionCode');
                                if (exceptionCode) {
                                    exceptionReport.exceptionCode = exceptionCode;
                                }
                                var textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    exceptionReport.exception = textNode.nodeValue;
                                }
                                return exceptionReport;
                            }
                        };
                        DirectGeocodeResponseReader.read = function (root) {
                            if (root.nodeName === 'XLS') {
                                var nsPrefix = root.prefix;
                                if (!nsPrefix) {
                                    nsPrefix = DirectGeocodeResponseReader.DEFAULTPREFIX;
                                }
                                var geocodeResponse = DirectGeocodeResponseReader.READERS[nsPrefix][root.nodeName](root);
                                return geocodeResponse;
                            } else if (root.nodeName === 'ExceptionReport') {
                                var exceptionReport = DirectGeocodeResponseReader.READERS[root.nodeName](root);
                                return exceptionReport;
                            } else {
                                var mess = __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_ANALYSE', root.nodeName);
                                throw new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a']({
                                    message: mess,
                                    type: __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'].TYPE_UNKERR,
                                    status: 200
                                });
                            }
                        };
                        function __getAttributes(node) {
                            if (node.attributes.length > 0) {
                                var nodeAttributes = {};
                                var attributes = node.attributes;
                                for (var i = 0; i < attributes.length; i++) {
                                    var attribute = attributes[i];
                                    nodeAttributes[attribute.nodeName] = attribute.nodeValue;
                                }
                                return nodeAttributes;
                            }
                        }
                        function __getChildNodes(node, data) {
                            if (node.hasChildNodes()) {
                                var children = node.childNodes;
                                var child;
                                var childName;
                                var childPrefix;
                                for (var i = 0; i < children.length; i++) {
                                    child = children[i];
                                    if (child.nodeType === 1) {
                                        childName = child.localName || child.baseName || child.nodeName;
                                        childPrefix = child.prefix || DirectGeocodeResponseReader.DEFAULTPREFIX;
                                        if (DirectGeocodeResponseReader.READERS[childPrefix][childName]) {
                                            var reader = DirectGeocodeResponseReader.READERS[childPrefix][childName];
                                            reader(child, data);
                                        } else {
                                            __getChildNodes(child, data);
                                        }
                                    }
                                }
                            }
                        }
                        function __getChildValue(node) {
                            var textNode;
                            var value = '';
                            if (node.hasChildNodes()) {
                                textNode = node.firstChild;
                                if (textNode.nodeType === 3) {
                                    value = textNode.nodeValue;
                                }
                            }
                            return value;
                        }
                        function __checkServiceAttributes(XLSNode) {
                            if (XLSNode.attributes.length > 0) {
                                var xlsAttributes = __getAttributes(XLSNode);
                                for (var att in xlsAttributes) {
                                    if (xlsAttributes.hasOwnProperty(att)) {
                                        if (att === 'version') {
                                            if (xlsAttributes['version'] !== DirectGeocodeResponseReader.VERSION) {
                                                console.log('[DirectGeocodeResponseReader] geocode version is not the expected one : there may be errors in parsing');
                                                return;
                                            }
                                        }
                                        if (att === 'xmlns') {
                                            if (xlsAttributes[att] !== DirectGeocodeResponseReader.NAMESPACES[DirectGeocodeResponseReader.DEFAULTPREFIX]) {
                                                console.log('[DirectGeocodeResponseReader] geocode response default namespace is not the expected one');
                                                return;
                                            }
                                            continue;
                                        }
                                        var prefix = att.split(':')[0];
                                        var ns = att.split(':')[1];
                                        if (prefix === 'xmlns' && ns) {
                                            if (DirectGeocodeResponseReader.NAMESPACES[ns]) {
                                                if (DirectGeocodeResponseReader.NAMESPACES[ns] !== xlsAttributes[att]) {
                                                    console.log('[DirectGeocodeResponseReader] geocode response ' + att + ' namespace is not the expected one');
                                                    return;
                                                }
                                            }
                                        }
                                        if (ns === 'schemaLocation') {
                                            if (DirectGeocodeResponseReader.SCHEMALOCATION !== xlsAttributes[att]) {
                                                console.log('[DirectGeocodeResponseReader] geocode response schema location is not the expected one');
                                                return;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        __webpack_exports__['a'] = DirectGeocodeResponseReader;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__CommonService__ = __webpack_require__(3);
                        var __WEBPACK_IMPORTED_MODULE_4__Request_ReverseGeocodeRequestFactory__ = __webpack_require__(79);
                        var __WEBPACK_IMPORTED_MODULE_5__Response_ReverseGeocodeResponseFactory__ = __webpack_require__(80);
                        function ReverseGeocode(options) {
                            if (!(this instanceof ReverseGeocode)) {
                                throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('CLASS_CONSTRUCTOR', 'ReverseGeocode'));
                            }
                            this.CLASSNAME = 'ReverseGeocode';
                            __WEBPACK_IMPORTED_MODULE_3__CommonService__['a'].apply(this, arguments);
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('Gp.Services.ReverseGeocode');
                            this.logger.trace('[Constructeur ReverseGeocode (options)]');
                            if (!options.position) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'position'));
                            }
                            if (options.position.x === null) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'position.x'));
                            }
                            if (options.position.y === null) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'position.y'));
                            }
                            this.options.position = options.position;
                            if (!options.filterOptions || typeof options.filterOptions !== 'object') {
                                this.options.filterOptions = options.filterOptions = { type: ['StreetAddress'] };
                            }
                            if (Object.keys(options.filterOptions).length === 0) {
                                this.options.filterOptions = { type: ['StreetAddress'] };
                            }
                            var filter = Object.keys(options.filterOptions);
                            for (var i = 0; i < filter.length; i++) {
                                var key = filter[i];
                                if (!options.filterOptions[key] || Object.keys(options.filterOptions[key]).length === 0) {
                                    delete this.options.filterOptions[key];
                                }
                            }
                            this.options.filterOptions.type = options.filterOptions.type || ['StreetAddress'];
                            if (!Array.isArray(this.options.filterOptions.type)) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_TYPE', 'filterOptions.type'));
                            }
                            this.options.maximumResponses = options.maximumResponses || 25;
                            this.options.returnFreeForm = options.returnFreeForm || false;
                            this.options.srs = options.srs || 'CRS:84';
                            if (ReverseGeocode.geoEPSG.indexOf(this.options.srs) === -1) {
                                this.options.position = {
                                    x: this.options.position.y,
                                    y: this.options.position.x
                                };
                                if (this.options.filterOptions && this.options.filterOptions.circle) {
                                    var circle = this.options.filterOptions.circle;
                                    this.options.filterOptions.circle = {
                                        x: circle.y,
                                        y: circle.x,
                                        radius: circle.radius
                                    };
                                }
                                if (this.options.filterOptions && this.options.filterOptions.polygon) {
                                    var polygon = this.options.filterOptions.polygon;
                                    for (i = 0; i < polygon.length; i++) {
                                        var coords = polygon[i];
                                        this.options.filterOptions.polygon[i] = {
                                            x: coords.y,
                                            y: coords.x
                                        };
                                    }
                                }
                            }
                            this.options.outputFormat = this.options.rawResponse ? '' : 'xml';
                        }
                        ReverseGeocode.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__CommonService__['a'].prototype, {});
                        ReverseGeocode.prototype.constructor = ReverseGeocode;
                        ReverseGeocode.prototype.buildRequest = function (error, success) {
                            var options = {
                                httpMethod: this.options.httpMethod,
                                position: this.options.position,
                                returnFreeForm: this.options.returnFreeForm,
                                filterOptions: this.options.filterOptions,
                                srs: 'EPSG:4326',
                                maximumResponses: this.options.maximumResponses
                            };
                            this.request = __WEBPACK_IMPORTED_MODULE_4__Request_ReverseGeocodeRequestFactory__['a'].build(options);
                            !this.request ? error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_REQUEST_BUILD'))) : success.call(this, this.request);
                        };
                        ReverseGeocode.prototype.analyzeResponse = function (error, success) {
                            if (this.response) {
                                var options = {
                                    response: this.response,
                                    rawResponse: this.options.rawResponse,
                                    onError: error,
                                    onSuccess: success,
                                    scope: this
                                };
                                __WEBPACK_IMPORTED_MODULE_5__Response_ReverseGeocodeResponseFactory__['a'].build(options);
                            } else {
                                error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                            }
                        };
                        ReverseGeocode.geoEPSG = ['EPSG:4326'];
                        __webpack_exports__['a'] = ReverseGeocode;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__ = __webpack_require__(11);
                        var __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_LocationUtilityService__ = __webpack_require__(38);
                        var ReverseGeocodeRequestFactory = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('ReverseGeocodeRequestFactory');
                                logger.trace(['ReverseGeocodeRequestFactory::build()']);
                                var settings = options || {};
                                var request = null;
                                var oLUS = new __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_LocationUtilityService__['a']({
                                    position: settings.position,
                                    returnFreeForm: settings.returnFreeForm,
                                    filterOptions: settings.filterOptions
                                });
                                var oXLS = new __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__['a']({
                                    srsName: settings.srs,
                                    maximumResponses: settings.maximumResponses
                                });
                                oXLS.namespace = true;
                                oXLS.setService(oLUS);
                                request = oXLS.build();
                                if (settings.httpMethod === 'GET') {
                                    var myRequest = 'qxml=' + encodeURIComponent(request).replace(/-/g, '%2D').replace(/_/g, '%5F').replace(/\./g, '%2E').replace(/!/g, '%21').replace(/~/g, '%7E').replace(/\*/g, '%2A').replace(/'/g, '%27').replace(/\(/g, '%28').replace(/\)/g, '%29');
                                    request = myRequest;
                                }
                                logger.trace(request);
                                return request;
                            }
                        };
                        __webpack_exports__['a'] = ReverseGeocodeRequestFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_2__Formats_XML__ = __webpack_require__(6);
                        var __WEBPACK_IMPORTED_MODULE_3__Formats_ReverseGeocodeResponseReader__ = __webpack_require__(81);
                        var ReverseGeocodeReponseFactory = {
                            build: function (options) {
                                var data = null;
                                if (options.response) {
                                    if (options.rawResponse) {
                                        data = options.response;
                                    } else {
                                        try {
                                            var p = new __WEBPACK_IMPORTED_MODULE_2__Formats_XML__['a']({ reader: __WEBPACK_IMPORTED_MODULE_3__Formats_ReverseGeocodeResponseReader__['a'] });
                                            if (typeof options.response === 'string') {
                                                p.setXMLString(options.response);
                                            } else {
                                                p.setXMLDoc(options.response);
                                            }
                                            data = p.parse();
                                            if (!data) {
                                                throw new Error('L\'analyse de la réponse du service !?');
                                            }
                                        } catch (e) {
                                            e.status = 200;
                                            options.onError.call(options.scope, e);
                                            return;
                                        }
                                        if (data.exceptionReport) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', data.exceptionReport),
                                                type: __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'].TYPE_SRVERR,
                                                status: 200
                                            }));
                                            return;
                                        }
                                        if (options.scope && options.scope.options && options.scope.options.srs && options.scope.options.srs !== 'EPSG:4326') {
                                            var location;
                                            var pos;
                                            if (data || data.locations || data.locations.length) {
                                                for (var i = 0; i < data.locations.length; i++) {
                                                    location = data.locations[i];
                                                    if (location) {
                                                        pos = location.position;
                                                        if (pos) {
                                                            location.position = {
                                                                x: pos.y,
                                                                y: pos.x
                                                            };
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                } else {
                                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a']({
                                        message: __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY'),
                                        type: __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'].TYPE_SRVERR,
                                        status: -1
                                    }));
                                    return;
                                }
                                options.onSuccess.call(options.scope, data);
                            }
                        };
                        __webpack_exports__['a'] = ReverseGeocodeReponseFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_2__Response_model_GeocodeResponse__ = __webpack_require__(14);
                        var __WEBPACK_IMPORTED_MODULE_3__Response_model_ReverseGeocodedLocation__ = __webpack_require__(40);
                        var ReverseGeocodeResponseReader = {};
                        ReverseGeocodeResponseReader.VERSION = '1.2';
                        ReverseGeocodeResponseReader.NAMESPACES = {
                            xmlns: 'http://www.opengis.net/xls',
                            gml: 'http://www.opengis.net/gml',
                            xls: 'http://www.opengis.net/xls',
                            xlsext: 'http://www.opengis.net/xlsext',
                            xsi: 'http://www.w3.org/2001/XMLSchema-instance'
                        };
                        ReverseGeocodeResponseReader.SCHEMALOCATION = 'http://wxs.ign.fr/schemas/olsAll.xsd';
                        ReverseGeocodeResponseReader.DEFAULTPREFIX = 'xls';
                        ReverseGeocodeResponseReader.READERS = {
                            xls: {
                                XLS: function (root) {
                                    var reverseGeocodeResponse = new __WEBPACK_IMPORTED_MODULE_2__Response_model_GeocodeResponse__['a']();
                                    __checkServiceAttributes(root);
                                    __getChildNodes(root, reverseGeocodeResponse);
                                    return reverseGeocodeResponse;
                                },
                                ReverseGeocodedLocation: function (node, reverseGeocodeResponse) {
                                    var reverseGeocodedLocation = new __WEBPACK_IMPORTED_MODULE_3__Response_model_ReverseGeocodedLocation__['a']();
                                    __getChildNodes(node, reverseGeocodedLocation);
                                    if (reverseGeocodeResponse && Array.isArray(reverseGeocodeResponse.locations)) {
                                        reverseGeocodeResponse.locations.push(reverseGeocodedLocation);
                                    }
                                },
                                Address: function (node, reverseGeocodedLocation) {
                                    var countrycode = node.getAttribute('countryCode');
                                    if (reverseGeocodedLocation && countrycode) {
                                        reverseGeocodedLocation.type = countrycode;
                                    }
                                    __getChildNodes(node, reverseGeocodedLocation);
                                },
                                Building: function (node, reverseGeocodedLocation) {
                                    var num = node.getAttribute('number');
                                    if (reverseGeocodedLocation && reverseGeocodedLocation.hasOwnProperty('placeAttributes')) {
                                        if (num) {
                                            reverseGeocodedLocation.placeAttributes.number = num;
                                        } else if (node.getAttribute('buildingName')) {
                                            reverseGeocodedLocation.placeAttributes.number = node.getAttribute('buildingName');
                                        } else if (node.getAttribute('subdivision')) {
                                            reverseGeocodedLocation.placeAttributes.number = node.getAttribute('subdivision');
                                        }
                                    }
                                },
                                Street: function (node, reverseGeocodedLocation) {
                                    if (reverseGeocodedLocation.type === 'StreetAddress') {
                                        reverseGeocodedLocation.placeAttributes.street = __getChildValue(node);
                                    } else if (reverseGeocodedLocation.type === 'CadastralParcel') {
                                        reverseGeocodedLocation.placeAttributes.cadastralParcel = __getChildValue(node);
                                    }
                                },
                                Place: function (node, reverseGeocodedLocation) {
                                    var placeType = node.getAttribute('type');
                                    var placeName = __getChildValue(node);
                                    if (reverseGeocodedLocation && reverseGeocodedLocation.hasOwnProperty('placeAttributes')) {
                                        if (placeType === 'Municipality') {
                                            reverseGeocodedLocation.placeAttributes.municipality = placeName;
                                        } else if (placeType === 'Bbox') {
                                            var values = placeName.split(';');
                                            if (values.length === 4) {
                                                reverseGeocodedLocation.placeAttributes.bbox = {
                                                    left: parseFloat(values[0]),
                                                    right: parseFloat(values[2]),
                                                    top: parseFloat(values[1]),
                                                    bottom: parseFloat(values[3])
                                                };
                                            }
                                        } else if (placeType === 'Commune') {
                                            reverseGeocodedLocation.placeAttributes.commune = placeName;
                                        } else if (placeType === 'Departement') {
                                            reverseGeocodedLocation.placeAttributes.department = placeName;
                                        } else if (placeType === 'INSEE') {
                                            reverseGeocodedLocation.placeAttributes.insee = placeName;
                                        } else if (placeType === 'Qualite') {
                                            reverseGeocodedLocation.placeAttributes.quality = placeName;
                                        } else if (placeType === 'Territoire') {
                                            reverseGeocodedLocation.placeAttributes.territory = placeName;
                                        } else if (placeType === 'ID') {
                                            reverseGeocodedLocation.placeAttributes.ID = placeName;
                                        } else if (placeType === 'ID_TR') {
                                            reverseGeocodedLocation.placeAttributes.IDTR = placeName;
                                        } else if (placeType === 'Importance') {
                                            reverseGeocodedLocation.placeAttributes.importance = parseInt(placeName, 10);
                                        } else if (placeType === 'Nature') {
                                            reverseGeocodedLocation.placeAttributes.nature = placeName;
                                        } else if (placeType === 'Numero') {
                                            reverseGeocodedLocation.placeAttributes.number = placeName;
                                        } else if (placeType === 'Feuille') {
                                            reverseGeocodedLocation.placeAttributes.sheet = placeName;
                                        } else if (placeType === 'Section') {
                                            reverseGeocodedLocation.placeAttributes.section = placeName;
                                        } else if (placeType === 'CommuneAbsorbee') {
                                            reverseGeocodedLocation.placeAttributes.absorbedCity = placeName;
                                        } else if (placeType === 'Arrondissement') {
                                            if (placeName) {
                                                reverseGeocodedLocation.placeAttributes.arrondissement = placeName;
                                            }
                                        } else if (placeType === 'Type') {
                                            reverseGeocodedLocation.placeAttributes.origin = placeName;
                                        } else if (placeType === 'Prefecture') {
                                            reverseGeocodedLocation.placeAttributes.prefecture = placeName;
                                        } else if (placeType === 'InseeRegion') {
                                            reverseGeocodedLocation.placeAttributes.inseeRegion = placeName;
                                        } else if (placeType === 'InseeDepartment') {
                                            reverseGeocodedLocation.placeAttributes.inseeDepartment = placeName;
                                        }
                                    }
                                },
                                PostalCode: function (node, reverseGeocodedLocation) {
                                    if (reverseGeocodedLocation && reverseGeocodedLocation.hasOwnProperty('placeAttributes')) {
                                        reverseGeocodedLocation.placeAttributes.postalCode = __getChildValue(node);
                                    }
                                },
                                SearchCentreDistance: function (node, reverseGeocodedLocation) {
                                    if (reverseGeocodedLocation) {
                                        reverseGeocodedLocation.searchCenterDistance = parseFloat(node.getAttribute('value'));
                                    }
                                },
                                Error: function (node) {
                                    var srvMess = node.getAttribute('message');
                                    var errorCode = node.getAttribute('errorCode');
                                    var message = __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', '(' + errorCode + ') : ' + srvMess);
                                    throw new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a']({
                                        message: message,
                                        type: __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                    });
                                }
                            },
                            gml: {
                                pos: function (node, reverseGeocodedLocation) {
                                    var pos = __getChildValue(node);
                                    if (reverseGeocodedLocation && pos) {
                                        reverseGeocodedLocation.position = {
                                            x: parseFloat(pos.split(' ')[0]),
                                            y: parseFloat(pos.split(' ')[1])
                                        };
                                    }
                                }
                            },
                            xlsext: {
                                ExtendedGeocodeMatchCode: function (node, reverseGeocodedLocation) {
                                    if (reverseGeocodedLocation) {
                                        reverseGeocodedLocation.matchType = __getChildValue(node);
                                    }
                                }
                            },
                            ExceptionReport: function (node) {
                                var response = {};
                                if (node.hasChildNodes()) {
                                    var children = node.childNodes;
                                    var child;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        if (child.nodeName === 'Exception') {
                                            response.exceptionReport = ReverseGeocodeResponseReader.READERS['Exception'](child);
                                        }
                                    }
                                }
                                return response;
                            },
                            Exception: function (node) {
                                var exceptionReport = {};
                                var exceptionCode = node.getAttribute('exceptionCode');
                                if (exceptionCode) {
                                    exceptionReport.exceptionCode = exceptionCode;
                                }
                                var textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    exceptionReport.exception = textNode.nodeValue;
                                }
                                return exceptionReport;
                            }
                        };
                        ReverseGeocodeResponseReader.read = function (root) {
                            if (root.nodeName === 'XLS') {
                                var nsPrefix = root.prefix;
                                if (!nsPrefix) {
                                    nsPrefix = ReverseGeocodeResponseReader.DEFAULTPREFIX;
                                }
                                var geocodeResponse = ReverseGeocodeResponseReader.READERS[nsPrefix][root.nodeName](root);
                                return geocodeResponse;
                            } else if (root.nodeName === 'ExceptionReport') {
                                var exceptionReport = ReverseGeocodeResponseReader.READERS[root.nodeName](root);
                                return exceptionReport;
                            } else {
                                throw new Error('Erreur lors de la lecture de la réponse : elle n\'est pas au format attendu.');
                            }
                        };
                        function __getAttributes(node) {
                            if (node.attributes.length > 0) {
                                var nodeAttributes = {};
                                var attributes = node.attributes;
                                for (var i = 0; i < attributes.length; i++) {
                                    var attribute = attributes[i];
                                    nodeAttributes[attribute.nodeName] = attribute.nodeValue;
                                }
                                return nodeAttributes;
                            }
                        }
                        function __getChildNodes(node, data) {
                            if (node.hasChildNodes()) {
                                var children = node.childNodes;
                                var child;
                                var childName;
                                var childPrefix;
                                for (var i = 0; i < children.length; i++) {
                                    child = children[i];
                                    if (child.nodeType === 1) {
                                        childName = child.localName || child.baseName || child.nodeName;
                                        childPrefix = child.prefix || ReverseGeocodeResponseReader.DEFAULTPREFIX;
                                        if (ReverseGeocodeResponseReader.READERS[childPrefix][childName]) {
                                            var reader = ReverseGeocodeResponseReader.READERS[childPrefix][childName];
                                            reader(child, data);
                                        } else {
                                            __getChildNodes(child, data);
                                        }
                                    }
                                }
                            }
                        }
                        function __getChildValue(node) {
                            var textNode;
                            var value = '';
                            if (node.hasChildNodes()) {
                                textNode = node.firstChild;
                                if (textNode.nodeType === 3) {
                                    value = textNode.nodeValue;
                                }
                            }
                            return value;
                        }
                        function __checkServiceAttributes(XLSNode) {
                            if (XLSNode.attributes.length > 0) {
                                var xlsAttributes = __getAttributes(XLSNode);
                                for (var att in xlsAttributes) {
                                    if (xlsAttributes.hasOwnProperty(att)) {
                                        if (att === 'version') {
                                            if (xlsAttributes['version'] !== ReverseGeocodeResponseReader.VERSION) {
                                                console.log('[ReverseGeocodeResponseReader] geocode version is not the expected one : there may be errors in parsing');
                                                return;
                                            }
                                        }
                                        if (att === 'xmlns') {
                                            if (xlsAttributes[att] !== ReverseGeocodeResponseReader.NAMESPACES[ReverseGeocodeResponseReader.DEFAULTPREFIX]) {
                                                console.log('[ReverseGeocodeResponseReader] geocode response default namespace is not the expected one');
                                                return;
                                            }
                                            continue;
                                        }
                                        var prefix = att.split(':')[0];
                                        var ns = att.split(':')[1];
                                        if (prefix === 'xmlns' && ns) {
                                            if (ReverseGeocodeResponseReader.NAMESPACES[ns]) {
                                                if (ReverseGeocodeResponseReader.NAMESPACES[ns] !== xlsAttributes[att]) {
                                                    console.log('[ReverseGeocodeResponseReader] geocode response ' + att + ' namespace is not the expected one');
                                                    return;
                                                }
                                            }
                                        }
                                        if (ns === 'schemaLocation') {
                                            if (ReverseGeocodeResponseReader.SCHEMALOCATION !== xlsAttributes[att]) {
                                                console.log('[ReverseGeocodeResponseReader] geocode response schema location is not the expected one');
                                                return;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        __webpack_exports__['a'] = ReverseGeocodeResponseReader;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__CommonService__ = __webpack_require__(3);
                        var __WEBPACK_IMPORTED_MODULE_1__Response_AutoCompleteResponseFactory__ = __webpack_require__(83);
                        var __WEBPACK_IMPORTED_MODULE_2__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_3__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_4__Utils_Helper__ = __webpack_require__(4);
                        var __WEBPACK_IMPORTED_MODULE_5__Exceptions_ErrorService__ = __webpack_require__(2);
                        function AutoComplete(options) {
                            if (!(this instanceof AutoComplete)) {
                                throw new TypeError(__WEBPACK_IMPORTED_MODULE_3__Utils_MessagesResources__['a'].getMessage('CLASS_CONSTRUCTOR', 'AutoComplete'));
                            }
                            this.CLASSNAME = 'AutoComplete';
                            __WEBPACK_IMPORTED_MODULE_0__CommonService__['a'].apply(this, arguments);
                            this.logger = __WEBPACK_IMPORTED_MODULE_2__Utils_LoggerByDefault__['a'].getLogger('Gp.Services.AutoComplete');
                            this.logger.trace('[Constructeur AutoComplete (options)]');
                            if (!options.text) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_3__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'text'));
                            }
                            this.options.text = options.text;
                            if (!options.filterOptions || typeof options.filterOptions !== 'object') {
                                this.options.filterOptions = options.filterOptions = {
                                    territory: [],
                                    type: ['StreetAddress']
                                };
                            }
                            if (Object.keys(options.filterOptions).length === 0) {
                                this.options.filterOptions = {
                                    territory: [],
                                    type: ['StreetAddress']
                                };
                            }
                            this.options.filterOptions.type = options.filterOptions.type || ['StreetAddress'];
                            this.options.filterOptions.territory = options.filterOptions.territory || [];
                            this.options.maximumResponses = options.maximumResponses || 10;
                            if (this.options.protocol === 'XHR' && this.options.httpMethod === 'POST') {
                                this.logger.warn('Le service ne gére pas le mode d\'interrogation en POST, on bascule sur du GET !');
                                this.options.httpMethod = 'GET';
                            }
                            this.options.outputFormat = this.options.rawResponse ? '' : 'json';
                        }
                        AutoComplete.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_0__CommonService__['a'].prototype, {});
                        AutoComplete.prototype.constructor = AutoComplete;
                        AutoComplete.prototype.buildRequest = function (error, success) {
                            var territories = '';
                            if (this.options.filterOptions.territory) {
                                territories = this.options.filterOptions.territory.join(';');
                            }
                            var types = '';
                            if (this.options.filterOptions.type) {
                                types = this.options.filterOptions.type.join(',');
                            }
                            this.request = __WEBPACK_IMPORTED_MODULE_4__Utils_Helper__['a'].normalyzeParameters({
                                text: encodeURIComponent(this.options.text),
                                type: types,
                                terr: territories,
                                maximumResponses: this.options.maximumResponses
                            });
                            !this.request ? error.call(this, new __WEBPACK_IMPORTED_MODULE_5__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_3__Utils_MessagesResources__['a'].getMessage('SERVICE_REQUEST_BUILD'))) : success.call(this, this.request);
                        };
                        AutoComplete.prototype.analyzeResponse = function (error, success) {
                            if (this.response) {
                                var options = {
                                    response: this.response,
                                    rawResponse: this.options.rawResponse,
                                    onSuccess: success,
                                    onError: error,
                                    scope: this
                                };
                                __WEBPACK_IMPORTED_MODULE_1__Response_AutoCompleteResponseFactory__['a'].build(options);
                            } else {
                                error.call(this, new __WEBPACK_IMPORTED_MODULE_5__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_3__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                            }
                        };
                        __webpack_exports__['a'] = AutoComplete;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__model_AutoCompleteResponse__ = __webpack_require__(41);
                        var __WEBPACK_IMPORTED_MODULE_4__model_SuggestedLocation__ = __webpack_require__(42);
                        var AutoCompleteResponseFactory = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('AutoCompleteResponseFactory');
                                logger.trace(['AutoCompleteResponseFactory::build()']);
                                var data = null;
                                if (options.response) {
                                    if (options.rawResponse) {
                                        logger.trace('analyze response : raw');
                                        data = options.response;
                                    } else {
                                        var JSONResponse;
                                        if (typeof options.response === 'string') {
                                            JSONResponse = JSON.parse(options.response);
                                        } else {
                                            JSONResponse = options.response;
                                        }
                                        if (JSONResponse) {
                                            if (JSONResponse.error) {
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                    message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', JSONResponse.error.description),
                                                    status: JSONResponse.error.code,
                                                    type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                                }));
                                                return;
                                            }
                                            data = new __WEBPACK_IMPORTED_MODULE_3__model_AutoCompleteResponse__['a']();
                                            if (JSONResponse.results && Array.isArray(JSONResponse.results)) {
                                                var suggestedLocation;
                                                for (var i = 0; i < JSONResponse.results.length; i++) {
                                                    var result = JSONResponse.results[i];
                                                    suggestedLocation = new __WEBPACK_IMPORTED_MODULE_4__model_SuggestedLocation__['a']();
                                                    if (suggestedLocation) {
                                                        if (result && result.country === 'StreetAddress') {
                                                            suggestedLocation.street = result.street;
                                                            suggestedLocation.type = 'StreetAddress';
                                                        } else if (result && result.country === 'PositionOfInterest') {
                                                            suggestedLocation.poi = result.street;
                                                            suggestedLocation.kind = result.kind;
                                                            suggestedLocation.type = 'PositionOfInterest';
                                                        }
                                                        if (suggestedLocation.position) {
                                                            suggestedLocation.position.x = result.x;
                                                            suggestedLocation.position.y = result.y;
                                                        }
                                                        suggestedLocation.commune = result.city;
                                                        suggestedLocation.fullText = result.fulltext;
                                                        suggestedLocation.postalCode = result.zipcode;
                                                        suggestedLocation.classification = result.classification;
                                                    }
                                                    data.suggestedLocations.push(suggestedLocation);
                                                }
                                            } else {
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_FORMAT_3')));
                                                return;
                                            }
                                            if (!data.suggestedLocations.length) {
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_FORMAT_3')));
                                                return;
                                            }
                                        }
                                        if (!data) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_ANALYSE_2'),
                                                type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_UNKERR,
                                                status: -1
                                            }));
                                            return;
                                        }
                                        if (data.exceptionReport) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', data.exceptionReport),
                                                type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR,
                                                status: 200
                                            }));
                                            return;
                                        }
                                    }
                                } else {
                                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                                    return;
                                }
                                options.onSuccess.call(options.scope, data);
                            }
                        };
                        __webpack_exports__['a'] = AutoCompleteResponseFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__CommonService__ = __webpack_require__(3);
                        var __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__ = __webpack_require__(5);
                        var __WEBPACK_IMPORTED_MODULE_5__Request_RouteRequestFactory__ = __webpack_require__(85);
                        var __WEBPACK_IMPORTED_MODULE_6__Response_RouteResponseFactory__ = __webpack_require__(93);
                        function Route(options) {
                            if (!(this instanceof Route)) {
                                throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('CLASS_CONSTRUCTOR', 'Route'));
                            }
                            this.CLASSNAME = 'Route';
                            __WEBPACK_IMPORTED_MODULE_3__CommonService__['a'].apply(this, arguments);
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('Gp.Services.Route');
                            this.logger.trace('[Constructeur Route (options)]');
                            if (!options.startPoint) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'startPoint'));
                            }
                            if (options.startPoint.x === null) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'startPoint.x'));
                            }
                            if (options.startPoint.y === null) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'startPoint.y'));
                            }
                            if (!options.endPoint) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'endPoint'));
                            }
                            if (options.endPoint.x === null) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'endPoint.x'));
                            }
                            if (options.endPoint.y === null) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'endPoint.y'));
                            }
                            this.options.api = typeof options.api === 'string' ? options.api.toUpperCase() : 'REST';
                            this.options.outputFormat = typeof options.outputFormat === 'string' ? options.outputFormat.toLowerCase() : 'json';
                            this.options.startPoint = options.startPoint;
                            this.options.endPoint = options.endPoint;
                            this.options.viaPoints = options.viaPoints || null;
                            this.options.exclusions = options.exclusions || null;
                            this.options.routePreference = options.routePreference || 'fastest';
                            this.options.graph = options.graph || 'Voiture';
                            this.options.geometryInInstructions = options.geometryInInstructions || false;
                            this.options.provideBbox = options.provideBbox || true;
                            this.options.distanceUnit = options.distanceUnit || 'km';
                            this.options.expectedStartTime = null;
                            this.options.srs = options.srs || 'EPSG:4326';
                            this.options.api = 'REST';
                            this.logger.warn('FIXME : Surcharge option \'api\' : REST');
                            if (this.options.protocol === 'XHR') {
                                this.options.httpMethod = 'GET';
                                this.logger.trace('Surcharge option \'HttpMethod\' : ' + this.options.httpMethod);
                            }
                            if (!this.options.serverUrl) {
                                var lstUrlByDefault = __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__['a'].Route.url(this.options.apiKey);
                                var urlFound = null;
                                switch (this.options.api) {
                                case 'OLS':
                                    urlFound = lstUrlByDefault.ols;
                                    break;
                                case 'REST':
                                    var key = 'route' + '-' + this.options.outputFormat;
                                    urlFound = lstUrlByDefault[key];
                                    break;
                                default:
                                    throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_UNKNOWN', 'api'));
                                }
                                if (!urlFound) {
                                    throw new Error('Url by default not found !');
                                }
                                this.options.serverUrl = urlFound;
                                this.logger.trace('Serveur URL par defaut : ' + this.options.serverUrl);
                            }
                            var idx = this.options.serverUrl.lastIndexOf('.');
                            if (idx !== -1) {
                                var extension = this.options.serverUrl.substring(idx + 1);
                                if (extension && extension.length < 5) {
                                    this.logger.trace('Serveur Extension URL : ' + extension);
                                    switch (extension.toLowerCase()) {
                                    case 'json':
                                    case 'xml':
                                        this.options.outputFormat = extension.toLowerCase();
                                        break;
                                    default:
                                        throw new Error('type of service : unknown or unsupported (json or xml) !');
                                    }
                                }
                            }
                        }
                        Route.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__CommonService__['a'].prototype, {});
                        Route.prototype.constructor = Route;
                        Route.prototype.buildRequest = function (error, success) {
                            var options = {
                                api: this.options.api,
                                startPoint: this.options.startPoint,
                                endPoint: this.options.endPoint,
                                viaPoints: this.options.viaPoints,
                                provideBbox: this.options.provideBbox,
                                exclusions: this.options.exclusions,
                                distanceUnit: this.options.distanceUnit,
                                graph: this.options.graph,
                                geometryInInstructions: this.options.geometryInInstructions,
                                routePreference: this.options.routePreference,
                                srs: this.options.srs
                            };
                            this.request = __WEBPACK_IMPORTED_MODULE_5__Request_RouteRequestFactory__['a'].build(options);
                            if (!this.request) {
                                error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_REQUEST_BUILD')));
                            } else {
                                success.call(this, this.request);
                            }
                        };
                        Route.prototype.analyzeResponse = function (error, success) {
                            if (this.response) {
                                var options = {
                                    distanceUnit: this.options.distanceUnit,
                                    response: this.response,
                                    outputFormat: this.options.outputFormat,
                                    api: this.options.api,
                                    rawResponse: this.options.rawResponse,
                                    onError: error,
                                    onSuccess: success,
                                    scope: this
                                };
                                __WEBPACK_IMPORTED_MODULE_6__Response_RouteResponseFactory__['a'].build(options);
                            } else {
                                error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                            }
                        };
                        __webpack_exports__['a'] = Route;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_2__RouteRequestOLS__ = __webpack_require__(86);
                        var __WEBPACK_IMPORTED_MODULE_3__RouteRequestREST__ = __webpack_require__(91);
                        var RouteRequestFactory = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('RouteRequestFactory');
                                logger.trace(['RouteRequestFactory::build()']);
                                var request = null;
                                var settings = options || {};
                                var bOnError = !!(options.onError !== null && typeof options.onError === 'function');
                                var message = null;
                                switch (options.api) {
                                case 'REST':
                                    var myReq = new __WEBPACK_IMPORTED_MODULE_3__RouteRequestREST__['a'](settings);
                                    if (!myReq.processRequestString()) {
                                        message = 'Error process request (rest) !';
                                        if (bOnError) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'](message));
                                            return;
                                        }
                                        throw new Error(message);
                                    }
                                    request = myReq.requestString;
                                    break;
                                case 'OLS':
                                    request = __WEBPACK_IMPORTED_MODULE_2__RouteRequestOLS__['a'].build(settings);
                                    if (!request) {
                                        message = 'Error process request (ols) !';
                                        if (bOnError) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'](message));
                                            return;
                                        }
                                        throw new Error(message);
                                    }
                                    break;
                                default:
                                    message = 'Type of API is not supported by service (REST or OLS) !';
                                    if (bOnError) {
                                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_1__Exceptions_ErrorService__['a'](message));
                                        return;
                                    }
                                    throw new Error(message);
                                }
                                return request;
                            }
                        };
                        __webpack_exports__['a'] = RouteRequestFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__ = __webpack_require__(11);
                        var __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_RouteService__ = __webpack_require__(87);
                        var RouteRequestOLS = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('RouteRequestOLS');
                                logger.trace(['RouteRequestOLS::build()']);
                                var request = null;
                                var settings = {
                                    startPoint: options.startPoint,
                                    endPoint: options.endPoint,
                                    viaPoint: options.viaPoints,
                                    provideBoundingBox: options.provideBbox,
                                    avoidFeature: options.exclusions,
                                    expectedStartTime: options.expectedStartTime,
                                    distanceUnit: options.distanceUnit,
                                    graph: options.graph,
                                    provideGeometry: options.geometryInInstructions,
                                    routePreference: options.routePreference
                                };
                                var oRS = new __WEBPACK_IMPORTED_MODULE_2__Formats_XLS_RouteService__['a'](settings);
                                var oXLS = new __WEBPACK_IMPORTED_MODULE_1__Formats_XLS__['a']({
                                    srsName: options.srs,
                                    maximumResponses: options.maximumResponses
                                });
                                oXLS.namespace = true;
                                oXLS.setService(oRS);
                                request = oXLS.build();
                                if (options.httpMethod === 'GET') {
                                    var myRequest = 'qxml=' + encodeURIComponent(request).replace(/-/g, '%2D').replace(/_/g, '%5F').replace(/\./g, '%2E').replace(/!/g, '%21').replace(/~/g, '%7E').replace(/\*/g, '%2A').replace(/'/g, '%27').replace(/\(/g, '%28').replace(/\)/g, '%29');
                                    request = myRequest;
                                }
                                return request;
                            }
                        };
                        __webpack_exports__['a'] = RouteRequestOLS;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__AbstractService__ = __webpack_require__(12);
                        var __WEBPACK_IMPORTED_MODULE_2__RouteService_DetermineRouteRequest__ = __webpack_require__(88);
                        var __WEBPACK_IMPORTED_MODULE_3__RouteService_RouteRequestExtension__ = __webpack_require__(90);
                        var __WEBPACK_IMPORTED_MODULE_3__RouteService_RouteRequestExtension___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3__RouteService_RouteRequestExtension__);
                        function RouteService(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur RouteService ()]');
                            if (!(this instanceof RouteService)) {
                                throw new TypeError('RouteService constructor cannot be called as a function.');
                            }
                            this.CLASSNAME = 'RouteService';
                            this.CLASSTYPE = 'RouteRequest';
                            __WEBPACK_IMPORTED_MODULE_1__AbstractService__['a'].apply(this, arguments);
                        }
                        RouteService.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__AbstractService__['a'].prototype, {});
                        RouteService.prototype.constructor = RouteService;
                        RouteService.prototype.addRequest = function (oRequest) {
                            if (oRequest.CLASSNAME === 'DetermineRouteRequest') {
                                this.oRequest = oRequest;
                            } else {
                                throw new Error('Ce n\'est pas un objet de type \'Route Request\' !?');
                            }
                        };
                        RouteService.prototype.addFilter = function (oFilter) {
                            if (oFilter instanceof __WEBPACK_IMPORTED_MODULE_3__RouteService_RouteRequestExtension___default.a) {
                                this.oFilter = oFilter;
                            }
                        };
                        RouteService.prototype.toString = function () {
                            if (!this.oRequest) {
                                if (!this.options) {
                                    throw new Error('Les options ne sont pas renseignées, impossible de construire la requête !');
                                }
                                if (this.CLASSTYPE === 'RouteRequest') {
                                    var settings = {
                                        distanceUnit: this.options.distanceUnit || null,
                                        provideGeometry: this.options.provideGeometry || null,
                                        provideBoundingBox: this.options.provideBoundingBox || null,
                                        route: {
                                            routePreference: this.options.routePreference || null,
                                            startPoint: this.options.startPoint,
                                            viaPoint: this.options.viaPoint || null,
                                            endPoint: this.options.endPoint,
                                            avoidFeature: this.options.avoidFeature || null,
                                            graph: this.options.graph || null,
                                            expectedStartTime: this.options.expectedStartTime || null
                                        }
                                    };
                                    this.oRequest = new __WEBPACK_IMPORTED_MODULE_2__RouteService_DetermineRouteRequest__['a'](settings);
                                    if (this.oFilter) {
                                        this.oRequest.addFilter(this.oFilter);
                                    }
                                }
                            }
                            if (!this.oRequest) {
                                throw new Error('Type de requête indefini !');
                            }
                            this.strRequest = this.oRequest.toString();
                            return this.strRequest;
                        };
                        __webpack_exports__['a'] = RouteService;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__model_RoutePlan__ = __webpack_require__(89);
                        function DetermineRouteRequest(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur DetermineRouteRequest ()]');
                            if (!(this instanceof DetermineRouteRequest)) {
                                throw new TypeError('DetermineRouteRequest constructor cannot be called as a function.');
                            }
                            this.options = options || {};
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    this.options[opt] = options[opt];
                                }
                            }
                            this.CLASSNAME = 'DetermineRouteRequest';
                        }
                        DetermineRouteRequest.prototype = {
                            strRequest: null,
                            oRoutePlan: null,
                            template: {
                                determineRouteRequest: '<DetermineRouteRequest distanceUnit="__DISTANCEUNIT__">' + '__ROUTEPLAN__' + '__ROUTEINSTRUCTIONREQUEST__' + '__ROUTEGEOMETRYREQUEST__' + '__ROUTEMAPREQUEST__' + '</DetermineRouteRequest>',
                                routeInstructionRequest: '<RouteInstructionsRequest ' + 'provideGeometry="__PROVIDEGEOMETRY__" ' + 'provideBoundingBox="__PROVIDEBBOX__" />',
                                routeGeometryRequest: '<RouteGeometryRequest />',
                                routeMapRequest: ''
                            },
                            addRoute: function (oRoutePlan) {
                                if (oRoutePlan instanceof __WEBPACK_IMPORTED_MODULE_1__model_RoutePlan__['a']) {
                                    this.oRoutePlan = oRoutePlan;
                                }
                            },
                            constructor: DetermineRouteRequest,
                            toString: function () {
                                var template = '';
                                template = this.template.determineRouteRequest;
                                template = template.replace(/__DISTANCEUNIT__/g, this.options.distanceUnit || 'KM');
                                if (!this.oRoutePlan) {
                                    var settings = this.options.route;
                                    this.oRoutePlan = new __WEBPACK_IMPORTED_MODULE_1__model_RoutePlan__['a'](settings);
                                    if (!this.oRoutePlan) {
                                        throw new Error('La construction du calcul d\'initineraire n\'est pas correctement definie !?');
                                    }
                                }
                                template = template.replace(/__ROUTEPLAN__/g, this.oRoutePlan.toString());
                                var tmplInstruction = this.template.routeInstructionRequest;
                                tmplInstruction = tmplInstruction.replace(/__PROVIDEGEOMETRY__/g, this.options.provideGeometry || false);
                                tmplInstruction = tmplInstruction.replace(/__PROVIDEBBOX__/g, this.options.provideBoundingBox || false);
                                template = template.replace(/__ROUTEINSTRUCTIONREQUEST__/g, tmplInstruction);
                                var tmplGeometry = this.template.routeGeometryRequest;
                                template = template.replace(/__ROUTEGEOMETRYREQUEST__/g, tmplGeometry);
                                var tmplMap = this.template.routeMapRequest;
                                template = template.replace(/__ROUTEMAPREQUEST__/g, tmplMap);
                                this.strRequest = template;
                                return this.strRequest;
                            }
                        };
                        __webpack_exports__['a'] = DetermineRouteRequest;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function RoutePlan(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('RoutePlan');
                            this.logger.trace('[Constructeur RoutePlan ()]');
                            if (!(this instanceof RoutePlan)) {
                                throw new TypeError('RoutePlan constructor cannot be called as a function.');
                            }
                            this.options = options || {};
                            if (!options.startPoint) {
                                throw new Error('l\'option \'startPoint\' n\'est pas renseignée !');
                            }
                            if (!options.endPoint) {
                                throw new Error('l\'option \'endPoint\' n\'est pas renseignée !');
                            }
                            for (var opt in options) {
                                if (options.hasOwnProperty(opt)) {
                                    this.options[opt] = options[opt];
                                }
                            }
                        }
                        RoutePlan.prototype = {
                            constructor: RoutePlan,
                            requestString: null,
                            template: {
                                routePlan: '<RoutePlan>' + '__ROUTEPREFERENCE__' + '__GRAPH__' + '__WAYPOINTLIST__' + '__AVOIDLIST__' + '</RoutePlan>',
                                routePreference: '<RoutePreference>__VALUEROUTEPREFERENCE__</RoutePreference>',
                                graph: '<xlsext:graphName xmlns:xlsext="http://www.opengis.net/xlsext" name="__VALUEGRAPH__"/>',
                                wayPointList: {
                                    container: '<WayPointList>' + '__STARTPOINT__' + '__VIAPOINT__' + '__ENDPOINT__' + '</WayPointList>',
                                    point: '<Position><gml:Point xmlns:gml="http://www.opengis.net/gml"><gml:pos>__X__ __Y__</gml:pos></gml:Point></Position>',
                                    startPoint: '<StartPoint>' + '__POINT__' + '</StartPoint>',
                                    endPoint: '<EndPoint>' + '__POINT__' + '</EndPoint>',
                                    viaPoint: '<ViaPoint>' + '__POINT__' + '</ViaPoint>'
                                },
                                avoidList: {
                                    container: '<AvoidList>' + '__AVOIDFEATURE__' + '</AvoidList>',
                                    avoidFeature: '<AvoidFeature>__VALUEAVOIDFEATURE__</AvoidFeature>'
                                }
                            },
                            toString: function () {
                                var template = '';
                                template = this.template.routePlan;
                                if (this.options.routePreference) {
                                    var tmplPreference = this.template.routePreference;
                                    tmplPreference = tmplPreference.replace(/__VALUEROUTEPREFERENCE__/, this.options.routePreference);
                                    template = template.replace(/__ROUTEPREFERENCE__/g, tmplPreference);
                                }
                                template = template.replace(/__ROUTEPREFERENCE__/g, '');
                                if (this.options.avoidFeature) {
                                    var tmplAvoidList = this.template.avoidList.container;
                                    var avoidFeatures = [];
                                    for (var i = 0; i < this.options.avoidFeature.length; i++) {
                                        var tmplAvoidFeature = this.template.avoidList.avoidFeature;
                                        tmplAvoidFeature = tmplAvoidFeature.replace(/__VALUEAVOIDFEATURE__/, this.options.avoidFeature[i]);
                                        avoidFeatures.push(tmplAvoidFeature);
                                    }
                                    tmplAvoidList = tmplAvoidList.replace(/__AVOIDFEATURE__/, avoidFeatures.join('\n'));
                                    template = template.replace(/__AVOIDLIST__/g, tmplAvoidList);
                                }
                                template = template.replace(/__AVOIDLIST__/g, '');
                                if (this.options.graph) {
                                    var tmplVehicle = this.template.graph;
                                    tmplVehicle = tmplVehicle.replace(/__VALUEGRAPH__/, this.options.graph);
                                    template = template.replace(/__GRAPH__/g, tmplVehicle);
                                }
                                template = template.replace(/__GRAPH__/g, '');
                                var tmplWayPointList = this.template.wayPointList.container;
                                var tmplPoint = '';
                                tmplPoint = this.template.wayPointList.point;
                                tmplPoint = tmplPoint.replace(/__X__/, this.options.startPoint.x);
                                tmplPoint = tmplPoint.replace(/__Y__/, this.options.startPoint.y);
                                tmplWayPointList = tmplWayPointList.replace(/__STARTPOINT__/, this.template.wayPointList.startPoint.replace(/__POINT__/, tmplPoint));
                                tmplPoint = this.template.wayPointList.point;
                                tmplPoint = tmplPoint.replace(/__X__/, this.options.endPoint.x);
                                tmplPoint = tmplPoint.replace(/__Y__/, this.options.endPoint.y);
                                tmplWayPointList = tmplWayPointList.replace(/__ENDPOINT__/, this.template.wayPointList.endPoint.replace(/__POINT__/, tmplPoint));
                                if (this.options.viaPoint) {
                                    var points = [];
                                    for (var j = 0; j < this.options.viaPoint.length; j++) {
                                        var p = this.options.viaPoint[j];
                                        tmplPoint = this.template.wayPointList.point;
                                        tmplPoint = tmplPoint.replace(/__X__/, p.x);
                                        tmplPoint = tmplPoint.replace(/__Y__/, p.y);
                                        points.push(tmplPoint);
                                    }
                                    tmplWayPointList = tmplWayPointList.replace(/__VIAPOINT__/, this.template.wayPointList.viaPoint.replace(/__POINT__/, points.join('\n')));
                                } else {
                                    tmplWayPointList = tmplWayPointList.replace(/__VIAPOINT__/, '');
                                }
                                template = template.replace(/__WAYPOINTLIST__/g, tmplWayPointList);
                                this.requestString = template;
                                return this.requestString;
                            }
                        };
                        __webpack_exports__['a'] = RoutePlan;
                    },
                    function (module, exports) {
                        return exports;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__model_RouteParamREST__ = __webpack_require__(92);
                        function RouteRequestREST(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('RouteRequestREST');
                            this.logger.trace('[Constructeur RouteRequestREST ()]');
                            if (!(this instanceof RouteRequestREST)) {
                                throw new TypeError('RouteRequestREST constructor cannot be called as a function.');
                            }
                            if (!options) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_EMPTY', 'options'));
                            }
                            this.settings = options;
                        }
                        RouteRequestREST.prototype = {
                            requestString: null,
                            constructor: RouteRequestREST,
                            processRequestString: function () {
                                this.logger.warn('FIXME : PROTOTYPE !');
                                var oParams = new __WEBPACK_IMPORTED_MODULE_2__model_RouteParamREST__['a'](this.settings);
                                var params = oParams.getParams();
                                var request = '';
                                for (var i = 0; i < params.length; i++) {
                                    var o = params[i];
                                    if (request) {
                                        request += '&';
                                    }
                                    request += o.k + '=' + o.v;
                                }
                                this.logger.trace(request);
                                this.requestString = request;
                                return this.requestString;
                            }
                        };
                        __webpack_exports__['a'] = RouteRequestREST;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function RouteParamREST(options) {
                            if (!(this instanceof RouteParamREST)) {
                                throw new TypeError('RouteParamREST constructor cannot be called as a function.');
                            }
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur RouteParamREST ()]');
                            this.options = options || {};
                            this.origin = this.options.startPoint.x + ',' + this.options.startPoint.y;
                            this.destination = this.options.endPoint.x + ',' + this.options.endPoint.y;
                            this.waypoints = this.options.viaPoints || null;
                            this.startDateTime = this.options.expectedStartTime || null;
                            this.graphName = this.options.graph;
                            this.srs = this.options.srs;
                            this.exclusions = this.options.exclusions;
                            this.method = 'TIME';
                            if (this.options.routePreference) {
                                var value = this.options.routePreference;
                                switch (value) {
                                case 'fastest':
                                    this.method = 'TIME';
                                    break;
                                case 'shortest':
                                    this.method = 'DISTANCE';
                                    break;
                                default:
                                    this.logger.warn('Par defaut, on prend l\'itinéraire le plus rapide !');
                                    this.method = 'TIME';
                                }
                            }
                            this.format = this.options.geometryInInstructions ? 'STANDARDEXT' : 'STANDARD';
                            this.tolerance = 10;
                            this.profileId = null;
                            this.profileName = null;
                        }
                        RouteParamREST.CLASSNAME = 'RouteParamREST';
                        RouteParamREST.prototype = {
                            constructor: RouteParamREST,
                            getWaypoints: function () {
                                if (!this.waypoints) {
                                    return;
                                }
                                var array = [];
                                for (var i = 0; i < this.waypoints.length; i++) {
                                    var obj = this.waypoints[i];
                                    array.push(obj.x + ',' + obj.y);
                                }
                                return array.join(';');
                            },
                            getExclusions: function () {
                                return this.exclusions.join(';');
                            }
                        };
                        RouteParamREST.prototype.getParams = function () {
                            var map = [];
                            map.push({
                                k: 'origin',
                                v: this.origin
                            });
                            map.push({
                                k: 'destination',
                                v: this.destination
                            });
                            map.push({
                                k: 'method',
                                v: this.method
                            });
                            if (this.waypoints) {
                                map.push({
                                    k: 'waypoints',
                                    v: this.getWaypoints()
                                });
                            }
                            if (this.startDateTime) {
                                map.push({
                                    k: 'startDateTime',
                                    v: this.startDateTime
                                });
                            }
                            if (this.graphName) {
                                map.push({
                                    k: 'graphName',
                                    v: this.graphName
                                });
                            }
                            if (this.exclusions) {
                                map.push({
                                    k: 'exclusions',
                                    v: this.getExclusions()
                                });
                            }
                            if (this.srs) {
                                map.push({
                                    k: 'srs',
                                    v: this.srs
                                });
                            }
                            if (this.format) {
                                map.push({
                                    k: 'format',
                                    v: this.format
                                });
                            }
                            return map;
                        };
                        __webpack_exports__['a'] = RouteParamREST;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(6);
                        var __WEBPACK_IMPORTED_MODULE_4__Formats_WKT__ = __webpack_require__(8);
                        var __WEBPACK_IMPORTED_MODULE_5__Formats_RouteResponseRESTReader__ = __webpack_require__(94);
                        var __WEBPACK_IMPORTED_MODULE_6__Formats_RouteResponseOLSReader__ = __webpack_require__(95);
                        var __WEBPACK_IMPORTED_MODULE_7__model_RouteResponse__ = __webpack_require__(16);
                        var __WEBPACK_IMPORTED_MODULE_8__model_RouteInstruction__ = __webpack_require__(17);
                        var RouteResponseFactory = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('RouteResponseFactory');
                                logger.trace('RouteResponseFactory::build()');
                                var data = null;
                                if (options.response) {
                                    if (options.rawResponse) {
                                        logger.trace('analyze response : raw');
                                        data = options.response;
                                    } else {
                                        switch (options.outputFormat) {
                                        case 'xml':
                                            logger.trace('analyze response : xml');
                                            var routeReader = options.api === 'REST' ? __WEBPACK_IMPORTED_MODULE_5__Formats_RouteResponseRESTReader__['a'] : __WEBPACK_IMPORTED_MODULE_6__Formats_RouteResponseOLSReader__['a'];
                                            try {
                                                var p = new __WEBPACK_IMPORTED_MODULE_3__Formats_XML__['a']({ reader: routeReader });
                                                if (typeof options.response === 'string') {
                                                    p.setXMLString(options.response);
                                                } else {
                                                    p.setXMLDoc(options.response);
                                                }
                                                data = p.parse();
                                                if (!data) {
                                                    throw new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_FORMAT', 'xml'));
                                                }
                                            } catch (e) {
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_ANALYSE', options.response)));
                                                return;
                                            }
                                            break;
                                        case 'json':
                                            logger.trace('analyze response : json');
                                            var JSONResponse;
                                            if (typeof options.response === 'string') {
                                                JSONResponse = JSON.parse(options.response);
                                            } else {
                                                JSONResponse = options.response;
                                            }
                                            if (JSONResponse.message) {
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', JSONResponse.message)));
                                                return;
                                            }
                                            if (JSONResponse) {
                                                var legs = [];
                                                var legSteps = [];
                                                var steps = [];
                                                data = new __WEBPACK_IMPORTED_MODULE_7__model_RouteResponse__['a']();
                                                if (data.hasOwnProperty('totalTime')) {
                                                    data.totalTime = parseFloat(JSONResponse.durationSeconds);
                                                }
                                                if (data.hasOwnProperty('totalDistance')) {
                                                    data.totalDistance = options.distanceUnit === 'm' ? JSONResponse.distanceMeters : JSONResponse.distance;
                                                }
                                                if (data.hasOwnProperty('bbox')) {
                                                    var coords = JSONResponse.bounds.split(/[,;]/);
                                                    data.bbox.left = parseFloat(coords[0]);
                                                    data.bbox.bottom = parseFloat(coords[1]);
                                                    data.bbox.right = parseFloat(coords[2]);
                                                    data.bbox.top = parseFloat(coords[3]);
                                                }
                                                var onWKTSuccess = function (json) {
                                                    data.routeGeometry = json;
                                                };
                                                var onWKTError = function (e) {
                                                    console.log(e);
                                                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_FORMAT', ['geometryWkt'])));
                                                };
                                                if (data.hasOwnProperty('routeGeometry')) {
                                                    var geometry = JSONResponse.geometryWkt || JSONResponse.simplifiedWkt;
                                                    if (geometry) {
                                                        __WEBPACK_IMPORTED_MODULE_4__Formats_WKT__['a'].toJson(geometry, onWKTSuccess, onWKTError);
                                                        if (!data.routeGeometry) {
                                                            return;
                                                        }
                                                    }
                                                }
                                                if (data.hasOwnProperty('routeInstructions')) {
                                                    var legList = JSONResponse.legs;
                                                    var i;
                                                    if (Array.isArray(legList) && legList.length) {
                                                        for (i = 0; i < legList.length; i++) {
                                                            legs.push(legList[i]);
                                                        }
                                                    }
                                                    if (Array.isArray(legs) && legs.length) {
                                                        for (i = 0; i < legs.length; i++) {
                                                            legSteps.push(legs[i].steps);
                                                        }
                                                    }
                                                    if (Array.isArray(legSteps) && legSteps.length) {
                                                        for (i = 0; i < legSteps.length; i++) {
                                                            steps = steps.concat(legSteps[i]);
                                                        }
                                                    }
                                                    steps.forEach(function (step) {
                                                        data.routeInstructions.push(new __WEBPACK_IMPORTED_MODULE_8__model_RouteInstruction__['a']());
                                                        data.routeInstructions[data.routeInstructions.length - 1].duration = step.durationSeconds;
                                                        data.routeInstructions[data.routeInstructions.length - 1].distance = options.distanceUnit === 'm' ? step.distanceMeters : step.distance;
                                                        data.routeInstructions[data.routeInstructions.length - 1].code = step.navInstruction;
                                                        var points = [];
                                                        for (var i = 0; i < step.points.length; i++) {
                                                            var point = step.points[i].split(',');
                                                            if (point) {
                                                                points.push(point);
                                                            }
                                                        }
                                                        if (points && points.length !== 0) {
                                                            data.routeInstructions[data.routeInstructions.length - 1].geometry = {
                                                                coordinates: points,
                                                                type: 'LineString'
                                                            };
                                                        } else {
                                                            data.routeInstructions[data.routeInstructions.length - 1].geometry = null;
                                                        }
                                                        if (step.name === 'Valeur non renseignée') {
                                                            step.name = '';
                                                        }
                                                        switch (step.navInstruction) {
                                                        case 'F':
                                                            if (step.name) {
                                                                data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Tout droit ' + step.name;
                                                            } else {
                                                                data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Continuer tout droit ';
                                                            }
                                                            break;
                                                        case 'B':
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Demi-tour ' + step.name;
                                                            break;
                                                        case 'L':
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Tourner à gauche ' + step.name;
                                                            break;
                                                        case 'R':
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Tourner à droite ' + step.name;
                                                            break;
                                                        case 'BL':
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Tourner très à gauche ' + step.name;
                                                            break;
                                                        case 'BR':
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Tourner très à droite ' + step.name;
                                                            break;
                                                        case 'FL':
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Tourner légèrement à gauche ' + step.name;
                                                            break;
                                                        case 'FR':
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Tourner légèrement à droite ' + step.name;
                                                            break;
                                                        case 'round_about_entry':
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Entrée rond-point ' + step.name;
                                                            break;
                                                        case 'round_about_exit':
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Sortie rond-point ' + step.name;
                                                            break;
                                                        case null:
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = 'Prendre tout droit ' + step.name;
                                                            break;
                                                        default:
                                                            data.routeInstructions[data.routeInstructions.length - 1].instruction = '?' + step.navInstruction + '? ' + step.name;
                                                            break;
                                                        }
                                                    });
                                                }
                                            }
                                            if (!data) {
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_ANALYSE', 'json')));
                                                return;
                                            }
                                            break;
                                        default:
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_FORMAT', 'json', 'xml')));
                                            return;
                                        }
                                        if (data && data.exceptionReport) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION_2')));
                                            return;
                                        }
                                    }
                                } else {
                                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                                    return;
                                }
                                options.onSuccess.call(options.scope, data);
                            }
                        };
                        __webpack_exports__['a'] = RouteResponseFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_1__Formats_WKT__ = __webpack_require__(8);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__Response_model_RouteResponse__ = __webpack_require__(16);
                        var __WEBPACK_IMPORTED_MODULE_4__Response_model_RouteInstruction__ = __webpack_require__(17);
                        var RouteResponseRESTReader = {};
                        RouteResponseRESTReader.READERS = {
                            routeResult: function (node) {
                                var response = new __WEBPACK_IMPORTED_MODULE_3__Response_model_RouteResponse__['a']();
                                __getChildNodes(node, response);
                                if (response.status === 'error') {
                                    var message = __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', response.message);
                                    throw new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                        message: message,
                                        type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                    });
                                }
                                return response;
                            },
                            status: function (node, response) {
                                var status = __getChildValue(node);
                                if (status === 'ERROR' || status === 'error') {
                                    if (response) {
                                        response.status = 'error';
                                    }
                                }
                            },
                            message: function (node, response) {
                                if (response) {
                                    response.message = __getChildValue(node);
                                }
                            },
                            distance: function (node, response) {
                                if (response) {
                                    response.totalDistance = __getChildValue(node);
                                }
                            },
                            durationSeconds: function (node, response) {
                                if (response) {
                                    response.totalTime = parseFloat(__getChildValue(node));
                                }
                            },
                            bounds: function (node, response) {
                                if (response && response.bbox) {
                                    var coords = __getChildValue(node).split(/[,;]/);
                                    response.bbox.left = parseFloat(coords[0]);
                                    response.bbox.bottom = parseFloat(coords[1]);
                                    response.bbox.right = parseFloat(coords[2]);
                                    response.bbox.top = parseFloat(coords[3]);
                                }
                            },
                            geometryWkt: function (node, response) {
                                if (response) {
                                    var geomWkt = node.innerHTML;
                                    var onWKTSuccess = function (json) {
                                        response.routeGeometry = json;
                                    };
                                    var onWKTError = function () {
                                        var msg = __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('PARAM_FORMAT', ['geometryWkt']);
                                        throw new Error(msg);
                                    };
                                    __WEBPACK_IMPORTED_MODULE_1__Formats_WKT__['a'].toJson(geomWkt, onWKTSuccess, onWKTError);
                                }
                            },
                            step: function (node, response) {
                                var routeInstruction = new __WEBPACK_IMPORTED_MODULE_4__Response_model_RouteInstruction__['a']();
                                var name;
                                if (node.hasChildNodes) {
                                    var children = node.childNodes;
                                    var child;
                                    var childName;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        if (child.nodeType === 1) {
                                            childName = child.localName || child.baseName || child.nodeName;
                                            if (childName === 'durationSeconds') {
                                                routeInstruction.duration = __getChildValue(child);
                                            } else if (childName === 'distance') {
                                                routeInstruction.distance = __getChildValue(child);
                                            } else if (childName === 'navInstruction') {
                                                routeInstruction.code = __getChildValue(child);
                                            } else if (childName === 'name') {
                                                name = __getChildValue(child);
                                            }
                                        }
                                    }
                                }
                                if (routeInstruction.code) {
                                    switch (routeInstruction.code) {
                                    case 'F':
                                        if (name !== 'Valeur non renseignée') {
                                            routeInstruction.instruction = 'Tout droit ' + name;
                                        } else {
                                            routeInstruction.instruction = 'Continuer tout droit ';
                                        }
                                        break;
                                    case 'B':
                                        routeInstruction.instruction = 'Demi-tour ' + name;
                                        break;
                                    case 'L':
                                        routeInstruction.instruction = 'Tourner à gauche ' + name;
                                        break;
                                    case 'R':
                                        routeInstruction.instruction = 'Tourner à droite ' + name;
                                        break;
                                    case 'BL':
                                        routeInstruction.instruction = 'Tourner très à gauche ' + name;
                                        break;
                                    case 'BR':
                                        routeInstruction.instruction = 'Tourner très à droite ' + name;
                                        break;
                                    case 'FL':
                                        routeInstruction.instruction = 'Tourner légèrement à gauche ' + name;
                                        break;
                                    case 'FR':
                                        routeInstruction.instruction = 'Tourner légèrement à droite ' + name;
                                        break;
                                    case 'round_about_entry':
                                        routeInstruction.instruction = 'Entrée rond-point ' + name;
                                        break;
                                    case 'round_about_exit':
                                        routeInstruction.instruction = 'Sortie rond-point ' + name;
                                        break;
                                    case null:
                                        routeInstruction.instruction = 'Prendre ' + name;
                                        break;
                                    default:
                                        routeInstruction.instruction = '?' + routeInstruction.code + '? ' + name;
                                        break;
                                    }
                                }
                                if (Array.isArray(response.routeInstructions)) {
                                    response.routeInstructions.push(routeInstruction);
                                }
                            }
                        };
                        RouteResponseRESTReader.read = function (root) {
                            var response;
                            if (root.nodeName === 'routeResult') {
                                response = RouteResponseRESTReader.READERS['routeResult'](root);
                                return response;
                            } else {
                                throw new Error('Erreur lors de la lecture de la réponse : elle n\'est pas au format attendu.');
                            }
                        };
                        function __getChildValue(node) {
                            var textNode;
                            var value = '';
                            if (node.hasChildNodes()) {
                                textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    value = textNode.nodeValue;
                                }
                            }
                            return value;
                        }
                        function __getChildNodes(node, data) {
                            if (node.hasChildNodes()) {
                                var children = node.childNodes;
                                var child;
                                var childName;
                                for (var i = 0; i < children.length; i++) {
                                    child = children[i];
                                    if (child.nodeType === 1) {
                                        childName = child.localName || child.baseName || child.nodeName;
                                        if (RouteResponseRESTReader.READERS[childName]) {
                                            var reader = RouteResponseRESTReader.READERS[childName];
                                            reader(child, data);
                                        } else {
                                            __getChildNodes(child, data);
                                        }
                                    }
                                }
                            }
                        }
                        __webpack_exports__['a'] = RouteResponseRESTReader;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var RouteResponseOLSReader = {};
                        RouteResponseOLSReader.READERS = {};
                        RouteResponseOLSReader.read = function (root) {
                            var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('RouteResponseOLSReader');
                            logger.error('not yet implemented !');
                        };
                        __webpack_exports__['a'] = RouteResponseOLSReader;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__CommonService__ = __webpack_require__(3);
                        var __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__ = __webpack_require__(5);
                        var __WEBPACK_IMPORTED_MODULE_5__Request_ProcessIsoCurveRequest__ = __webpack_require__(97);
                        var __WEBPACK_IMPORTED_MODULE_6__Response_ProcessIsoCurveResponseFactory__ = __webpack_require__(99);
                        function ProcessIsoCurve(options) {
                            if (!(this instanceof ProcessIsoCurve)) {
                                throw new TypeError(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('CLASS_CONSTRUCTOR', 'ProcessIsoCurve'));
                            }
                            this.CLASSNAME = 'ProcessIsoCurve';
                            __WEBPACK_IMPORTED_MODULE_3__CommonService__['a'].apply(this, arguments);
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('Gp.Services.ProcessIsoCurve');
                            this.logger.trace('[Constructeur ProcessIsoCurve (options)]');
                            if (!options.position) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'position'));
                            }
                            if (options.position.x === null) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'position.x'));
                            }
                            if (options.position.y === null) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_MISSING', 'position.y'));
                            }
                            if (!options.time && !options.distance) {
                                throw new Error('Parameter (s) \'distance\' missing. Parameter time to calculate an isochrone, parameter distance for an isodistance');
                            }
                            if (!options.time && options.distance) {
                                this.options.method = 'distance';
                                if (this.options.time) {
                                    delete this.options.time;
                                }
                            }
                            if (options.time && !options.distance) {
                                this.options.method = 'time';
                                if (this.options.distance) {
                                    delete this.options.distance;
                                }
                            }
                            this.options.method = this.options.method || 'time';
                            this.options.exclusions = options.exclusions || null;
                            this.options.graph = options.graph || 'Voiture';
                            this.options.reverse = options.reverse || false;
                            this.options.smoothing = options.smoothing || false;
                            this.options.holes = options.holes || false;
                            this.options.srs = options.srs || 'EPSG:4326';
                            this.options.outputFormat = typeof options.outputFormat === 'string' ? options.outputFormat.toLowerCase() : 'json';
                            if (!this.options.serverUrl) {
                                var lstUrlByDefault = __WEBPACK_IMPORTED_MODULE_4__DefaultUrlService__['a'].ProcessIsoCurve.url(this.options.apiKey);
                                var urlFound = lstUrlByDefault['iso' + '-' + this.options.outputFormat];
                                if (!urlFound) {
                                    throw new Error('Url by default not found !');
                                }
                                this.options.serverUrl = urlFound;
                                this.logger.trace('Serveur URL par defaut : ' + this.options.serverUrl);
                            }
                            var idx = this.options.serverUrl.lastIndexOf('.');
                            if (idx !== -1) {
                                var extension = this.options.serverUrl.substring(idx + 1);
                                if (extension && extension.length < 5) {
                                    this.logger.trace('Serveur Extension URL : ' + extension);
                                    switch (extension.toLowerCase()) {
                                    case 'json':
                                    case 'xml':
                                        this.options.outputFormat = extension.toLowerCase();
                                        break;
                                    default:
                                        throw new Error('type of service : unknown or unsupported (json or xml) !');
                                    }
                                }
                            }
                        }
                        ProcessIsoCurve.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__CommonService__['a'].prototype, {});
                        ProcessIsoCurve.prototype.constructor = ProcessIsoCurve;
                        ProcessIsoCurve.prototype.buildRequest = function (error, success) {
                            try {
                                var oIsoCurve = new __WEBPACK_IMPORTED_MODULE_5__Request_ProcessIsoCurveRequest__['a'](this.options);
                                if (!oIsoCurve.processRequestString()) {
                                    throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_REQUEST_BUILD'));
                                }
                                this.request = oIsoCurve.requestString;
                            } catch (e) {
                                error.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](e.message));
                                return;
                            }
                            success.call(this, this.request);
                        };
                        ProcessIsoCurve.prototype.analyzeResponse = function (onError, onSuccess) {
                            if (this.response) {
                                var options = {
                                    response: this.response,
                                    outputFormat: this.options.outputFormat,
                                    rawResponse: this.options.rawResponse,
                                    onSuccess: onSuccess,
                                    onError: onError,
                                    scope: this
                                };
                                __WEBPACK_IMPORTED_MODULE_6__Response_ProcessIsoCurveResponseFactory__['a'].build(options);
                            } else {
                                onError.call(this, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                            }
                        };
                        __webpack_exports__['a'] = ProcessIsoCurve;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__model_ProcessIsoCurveParam__ = __webpack_require__(98);
                        function ProcessIsoCurveRequest(options) {
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('ProcessIsoCurveRequest');
                            this.logger.trace('[Constructeur ProcessIsoCurveRequest ()]');
                            if (!(this instanceof ProcessIsoCurveRequest)) {
                                throw new TypeError('ProcessIsoCurveRequest constructor cannot be called as a function.');
                            }
                            if (!options) {
                                throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_EMPTY', 'options'));
                            }
                            this.settings = options;
                            this.mode = this.settings.httpMethod || 'GET';
                        }
                        ProcessIsoCurveRequest.prototype = {
                            requestString: null,
                            constructor: ProcessIsoCurveRequest,
                            template: {
                                container: '<?xml version="1.0" encoding="UTF-8"?>\n' + '<isochroneRequest>\n' + '__ID__' + '\t<location>\n' + '\t\t<x>__X__</x>\n' + '\t\t<y>__Y__</y>\n' + '\t</location>\n' + '\t<srs>__SRS__</srs>\n' + '\t<graphName>__GRAPHNAME__</graphName>\n' + '__PROFIL__' + '__EXCLUSIONS__' + '\t<method>__METHOD__</method>\n' + '__TIME__' + '__DISTANCE__' + '\t<reverse>__REVERSE__</reverse>\n' + '\t<smoothing>__SMOOTHING__</smoothing>\n' + '\t<holes>__HOLES__</holes>\n' + '</isochroneRequest>',
                                id: '\t<id>__IDVALUE__</id>\n',
                                profil: '\t<profileId>__PROFILID__</profileId>\n' + '\t<profileName>__PROFILNAME__</profileName>\n',
                                exclusions: {
                                    container: '\t<exclusions>\n' + '__EXCLUSIONFEATURE__\n' + '\t</exclusions>\n',
                                    feature: '\t\t<exclusion>__EXCLUSIONVALUE__</exclusion>'
                                },
                                time: '\t<time>__TIMEVALUE__</time>\n',
                                distance: '\t<distance>__DISTANCEVALUE__</distance>\n'
                            },
                            processRequestString: function () {
                                var request = '';
                                var i = 0;
                                switch (this.mode) {
                                case 'GET':
                                    this.logger.trace('Process GET Request');
                                    var oParams = new __WEBPACK_IMPORTED_MODULE_2__model_ProcessIsoCurveParam__['a'](this.settings);
                                    var params = oParams.getParams();
                                    for (i = 0; i < params.length; i++) {
                                        var o = params[i];
                                        if (request) {
                                            request += '&';
                                        }
                                        request += o.k + '=' + o.v;
                                    }
                                    break;
                                case 'POST':
                                    this.logger.trace('Process POST Request');
                                    request = this.template.container;
                                    request = request.replace(/__ID__/g, '');
                                    request = request.replace(/__PROFIL__/g, '');
                                    request = request.replace(/__X__/g, this.settings.position.x);
                                    request = request.replace(/__Y__/g, this.settings.position.y);
                                    request = request.replace(/__GRAPHNAME__/g, this.settings.graph);
                                    request = request.replace(/__SRS__/g, this.settings.srs);
                                    request = request.replace(/__SMOOTHING__/g, this.settings.smoothing);
                                    request = request.replace(/__HOLES__/g, this.settings.holes);
                                    request = request.replace(/__REVERSE__/g, this.settings.reverse);
                                    if (this.settings.exclusions) {
                                        var tmplExclusions = this.template.exclusions.container;
                                        var exclusions = [];
                                        for (i = 0; i < this.settings.exclusions.length; i++) {
                                            var tmplFeature = this.template.exclusions.feature;
                                            tmplFeature = tmplFeature.replace(/__EXCLUSIONVALUE__/, this.settings.exclusions[i]);
                                            exclusions.push(tmplFeature);
                                        }
                                        tmplExclusions = tmplExclusions.replace(/__EXCLUSIONFEATURE__/, exclusions.join('\n'));
                                        request = request.replace(/__EXCLUSIONS__/g, tmplExclusions);
                                    }
                                    request = request.replace(/__EXCLUSIONS__/g, '');
                                    if (this.settings.distance) {
                                        var tmplDistance = this.template.distance;
                                        tmplDistance = tmplDistance.replace(/__DISTANCEVALUE__/g, this.settings.distance);
                                        request = request.replace(/__DISTANCE__/g, tmplDistance);
                                        request = request.replace(/__METHOD__/g, 'distance');
                                    }
                                    request = request.replace(/__DISTANCE__/g, '');
                                    if (this.settings.time) {
                                        var tmplTime = this.template.time;
                                        tmplTime = tmplTime.replace(/__TIMEVALUE__/g, this.settings.time);
                                        request = request.replace(/__TIME__/g, tmplTime);
                                        request = request.replace(/__METHOD__/g, 'time');
                                    }
                                    request = request.replace(/__TIME__/g, '');
                                    break;
                                default:
                                    this.logger.error('No other HTTP method supported by the service !');
                                }
                                this.logger.trace(request);
                                this.requestString = request;
                                return this.requestString;
                            }
                        };
                        __webpack_exports__['a'] = ProcessIsoCurveRequest;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        function ProcessIsoCurveParam(options) {
                            if (!(this instanceof ProcessIsoCurveParam)) {
                                throw new TypeError('ProcessIsoCurveParam constructor cannot be called as a function.');
                            }
                            this.logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger();
                            this.logger.trace('[Constructeur ProcessIsoCurveParam ()]');
                            this.options = options || {};
                            this.id = this.options.id;
                            this.location = this.options.position;
                            this.srs = this.options.srs;
                            this.graphName = this.options.graph;
                            this.profileId = this.options.profileId || null;
                            this.profileName = this.options.profileName || null;
                            this.exclusions = this.options.exclusions;
                            this.reverse = this.options.reverse;
                            this.smoothing = this.options.smoothing;
                            this.holes = this.options.holes;
                            var value = this.options.method;
                            switch (value) {
                            case 'time':
                                this.method = 'time';
                                this.time = this.options.time;
                                break;
                            case 'distance':
                                this.method = 'distance';
                                this.distance = this.options.distance;
                                break;
                            default:
                                this.logger.warn('Par defaut, on calcule un isochrone !');
                                this.method = 'time';
                            }
                        }
                        ProcessIsoCurveParam.CLASSNAME = 'ProcessIsoCurveParam';
                        ProcessIsoCurveParam.prototype = {
                            constructor: ProcessIsoCurveParam,
                            getLocation: function () {
                                return this.location.x + ',' + this.location.y;
                            },
                            getExclusions: function () {
                                return this.exclusions.join(';');
                            }
                        };
                        ProcessIsoCurveParam.prototype.getParams = function () {
                            var map = [];
                            map.push({
                                k: 'location',
                                v: this.getLocation()
                            });
                            map.push({
                                k: 'smoothing',
                                v: this.smoothing
                            });
                            map.push({
                                k: 'holes',
                                v: this.holes
                            });
                            map.push({
                                k: 'reverse',
                                v: this.reverse
                            });
                            map.push({
                                k: 'method',
                                v: this.method
                            });
                            if (this.time) {
                                map.push({
                                    k: 'time',
                                    v: this.time
                                });
                            }
                            if (this.distance) {
                                map.push({
                                    k: 'distance',
                                    v: this.distance
                                });
                            }
                            map.push({
                                k: 'graphName',
                                v: this.graphName
                            });
                            if (this.exclusions) {
                                map.push({
                                    k: 'exclusions',
                                    v: this.getExclusions()
                                });
                            }
                            if (this.srs) {
                                map.push({
                                    k: 'srs',
                                    v: this.srs
                                });
                            }
                            return map;
                        };
                        __webpack_exports__['a'] = ProcessIsoCurveParam;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__ = __webpack_require__(0);
                        var __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__Formats_XML__ = __webpack_require__(6);
                        var __WEBPACK_IMPORTED_MODULE_4__Formats_WKT__ = __webpack_require__(8);
                        var __WEBPACK_IMPORTED_MODULE_5__Formats_ProcessIsoCurveResponseReader__ = __webpack_require__(100);
                        var __WEBPACK_IMPORTED_MODULE_6__model_ProcessIsoCurveResponse__ = __webpack_require__(18);
                        var ProcessIsoCurveResponseFactory = {
                            build: function (options) {
                                var logger = __WEBPACK_IMPORTED_MODULE_0__Utils_LoggerByDefault__['a'].getLogger('ProcessIsoCurveResponseFactory');
                                logger.trace(['ProcessIsoCurveResponseFactory::build()']);
                                var data = null;
                                if (options.response) {
                                    if (options.rawResponse) {
                                        logger.trace('analyze response : raw');
                                        data = options.response;
                                    } else {
                                        switch (options.outputFormat) {
                                        case 'xml':
                                            logger.trace('analyze response : xml');
                                            try {
                                                var p = new __WEBPACK_IMPORTED_MODULE_3__Formats_XML__['a']({ reader: __WEBPACK_IMPORTED_MODULE_5__Formats_ProcessIsoCurveResponseReader__['a'] });
                                                if (typeof options.response === 'string') {
                                                    p.setXMLString(options.response);
                                                } else {
                                                    p.setXMLDoc(options.response);
                                                }
                                                data = p.parse();
                                                if (!data) {
                                                    throw new Error(__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION_2'));
                                                }
                                            } catch (e) {
                                                var message = e.message;
                                                message += '\n (raw response service : \'' + options.response + '\')';
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                    message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', message),
                                                    status: 200,
                                                    type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                                }));
                                                return;
                                            }
                                            break;
                                        case 'json':
                                            logger.trace('analyze response : json');
                                            var JSONResponse;
                                            if (typeof options.response === 'string') {
                                                JSONResponse = JSON.parse(options.response);
                                            } else {
                                                JSONResponse = options.response;
                                            }
                                            if (JSONResponse.status === 'OK' || JSONResponse.status === 'ok') {
                                                data = new __WEBPACK_IMPORTED_MODULE_6__model_ProcessIsoCurveResponse__['a']();
                                                if (data) {
                                                    data.time = JSONResponse.time;
                                                    data.distance = JSONResponse.distance;
                                                    data.message = JSONResponse.message;
                                                    data.id = JSONResponse.id;
                                                    data.srs = JSONResponse.srs;
                                                    var onWKTSuccess = function (json) {
                                                        data.geometry = json;
                                                    };
                                                    var onWKTError = function () {
                                                        options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({ message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('PARAM_FORMAT', 'wktGeometry') }));
                                                    };
                                                    if (data.hasOwnProperty('geometry')) {
                                                        __WEBPACK_IMPORTED_MODULE_4__Formats_WKT__['a'].toJson(JSONResponse.wktGeometry, onWKTSuccess, onWKTError);
                                                        if (!data.geometry) {
                                                            return;
                                                        }
                                                    }
                                                    var coords = JSONResponse.location.split(',');
                                                    if (data.location) {
                                                        data.location.x = coords[0];
                                                        data.location.y = coords[1];
                                                    }
                                                } else {
                                                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_ANALYSE', options.response)));
                                                    return;
                                                }
                                            } else if (JSONResponse.status === 'ERROR' || JSONResponse.status === 'error') {
                                                var mess = JSONResponse.message;
                                                mess += '\n (raw response service : \'' + JSONResponse + '\')';
                                                options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', mess)));
                                                return;
                                            }
                                            break;
                                        default:
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_FORMAT', 'json', 'xml')));
                                            return;
                                        }
                                        if (data && data.exceptionReport) {
                                            options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                                message: __WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', data.exceptionReport),
                                                type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR,
                                                status: 200
                                            }));
                                            return;
                                        }
                                    }
                                } else {
                                    options.onError.call(options.scope, new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'](__WEBPACK_IMPORTED_MODULE_1__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EMPTY')));
                                    return;
                                }
                                options.onSuccess.call(options.scope, data);
                            }
                        };
                        __webpack_exports__['a'] = ProcessIsoCurveResponseFactory;
                    },
                    function (module, __webpack_exports__, __webpack_require__) {
                        'use strict';
                        var __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__ = __webpack_require__(1);
                        var __WEBPACK_IMPORTED_MODULE_1__Formats_WKT__ = __webpack_require__(8);
                        var __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__ = __webpack_require__(2);
                        var __WEBPACK_IMPORTED_MODULE_3__Response_model_ProcessIsoCurveResponse__ = __webpack_require__(18);
                        var ProcessIsoCurveResponseReader = {};
                        ProcessIsoCurveResponseReader.READERS = {
                            isochronResult: function (root) {
                                var response = new __WEBPACK_IMPORTED_MODULE_3__Response_model_ProcessIsoCurveResponse__['a']();
                                if (root.hasChildNodes()) {
                                    var children = root.childNodes;
                                    var child;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        if (ProcessIsoCurveResponseReader.READERS[child.nodeName]) {
                                            ProcessIsoCurveResponseReader.READERS[child.nodeName](child, response);
                                        }
                                    }
                                }
                                if (response.status === 'error') {
                                    var message = __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', response.message);
                                    throw new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                        message: message,
                                        type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                    });
                                }
                                return response;
                            },
                            message: function (node, response) {
                                if (response) {
                                    response.message = __getChildValue(node);
                                }
                            },
                            status: function (node, response) {
                                var status = __getChildValue(node);
                                if (status === 'ERROR' || status === 'error') {
                                    if (response) {
                                        response.status = 'error';
                                    }
                                }
                            },
                            id: function (node, response) {
                                if (response) {
                                    response.id = __getChildValue(node);
                                }
                            },
                            location: function (node, response) {
                                var coords = __getChildValue(node);
                                if (response && response.location) {
                                    response.location.x = parseFloat(coords.split(',')[0]);
                                    response.location.y = parseFloat(coords.split(',')[1]);
                                }
                            },
                            srs: function (node, response) {
                                if (response) {
                                    response.srs = __getChildValue(node);
                                }
                            },
                            distance: function (node, response) {
                                if (response) {
                                    response.distance = parseFloat(__getChildValue(node));
                                }
                            },
                            time: function (node, response) {
                                if (response) {
                                    response.time = parseFloat(__getChildValue(node));
                                }
                            },
                            wktGeometry: function (node, response) {
                                if (response) {
                                    var wktGeometry = node.innerHTML;
                                    var onWKTSuccess = function (json) {
                                        response.geometry = json;
                                    };
                                    var onWKTError = function () {
                                        var msg = __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('PARAM_FORMAT', ['wktGeometry']);
                                        throw new Error(msg);
                                    };
                                    if (response.hasOwnProperty('geometry')) {
                                        __WEBPACK_IMPORTED_MODULE_1__Formats_WKT__['a'].toJson(wktGeometry, onWKTSuccess, onWKTError);
                                    }
                                }
                            },
                            serviceResult: function (node) {
                                var response = {};
                                if (node.hasChildNodes()) {
                                    var children = node.childNodes;
                                    var child;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        if (ProcessIsoCurveResponseReader.READERS[child.nodeName]) {
                                            ProcessIsoCurveResponseReader.READERS[child.nodeName](child, response);
                                        }
                                    }
                                }
                                return response;
                            },
                            ExceptionReport: function (node) {
                                var response = {};
                                if (node.hasChildNodes()) {
                                    var children = node.childNodes;
                                    var child;
                                    for (var i = 0; i < children.length; i++) {
                                        child = children[i];
                                        if (child.nodeName === 'Exception') {
                                            response.exceptionReport = ProcessIsoCurveResponseReader.READERS['Exception'](child);
                                        }
                                    }
                                }
                                return response;
                            },
                            Exception: function (node) {
                                var exceptionReport = {};
                                var exceptionCode = node.getAttribute('exceptionCode');
                                if (exceptionCode) {
                                    exceptionReport.exceptionCode = exceptionCode;
                                }
                                var textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    exceptionReport.exception = textNode.nodeValue;
                                }
                                return exceptionReport;
                            }
                        };
                        ProcessIsoCurveResponseReader.read = function (root) {
                            var response;
                            if (root.nodeName === 'isochronResult' || root.nodeName === 'isochroneResult' || root.nodeName === 'IsochroneResult') {
                                response = ProcessIsoCurveResponseReader.READERS['isochronResult'](root);
                                return response;
                            } else if (root.nodeName === 'ExceptionReport') {
                                response = ProcessIsoCurveResponseReader.READERS[root.nodeName](root);
                                return response;
                            } else if (ProcessIsoCurveResponseReader.READERS[root.nodeName]) {
                                response = ProcessIsoCurveResponseReader.READERS[root.nodeName](root);
                                if (response.status === 'error') {
                                    var errMsg = __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_EXCEPTION', response.message);
                                    throw new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                        message: errMsg,
                                        type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_SRVERR
                                    });
                                }
                                return response;
                            } else {
                                throw new __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a']({
                                    message: __WEBPACK_IMPORTED_MODULE_0__Utils_MessagesResources__['a'].getMessage('SERVICE_RESPONSE_ANALYSE', root.nodeName),
                                    type: __WEBPACK_IMPORTED_MODULE_2__Exceptions_ErrorService__['a'].TYPE_UNKERR
                                });
                            }
                        };
                        function __getChildValue(node) {
                            var textNode;
                            var value = '';
                            if (node.hasChildNodes()) {
                                textNode = node.firstChild;
                                if (textNode && textNode.nodeType === 3) {
                                    value = textNode.nodeValue;
                                }
                            }
                            return value;
                        }
                        __webpack_exports__['a'] = ProcessIsoCurveResponseReader;
                    }
                ])['default'];
            }));
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var LayerUtils = {
                getZoomLevelFromScaleDenominator: function getZoomLevelFromScaleDenominator(scaleDenominator, crs) {
                    var resolutionsNatives = {};
                    switch (crs) {
                    case 'EPSG:2154':
                        resolutionsNatives = {
                            0: 104579.224549894,
                            1: 52277.5323537905,
                            2: 26135.4870785954,
                            3: 13066.8913818,
                            4: 6533.2286041135,
                            5: 3266.5595244627,
                            6: 1633.2660045974,
                            7: 816.629554986,
                            8: 408.3139146768,
                            9: 204.1567415109,
                            10: 102.0783167832,
                            11: 51.0391448966,
                            12: 25.5195690743,
                            13: 12.7597836936,
                            14: 6.379891636,
                            15: 3.1899457653,
                            16: 1.5949728695,
                            17: 0.7974864315,
                            18: 0.3987432149,
                            19: 0.1993716073,
                            20: 0.0996858037,
                            21: 0.0498429018
                        };
                        break;
                    default:
                        resolutionsNatives = {
                            0: 156543.033928041,
                            1: 78271.51696402048,
                            2: 39135.758482010235,
                            3: 19567.87924100512,
                            4: 9783.93962050256,
                            5: 4891.96981025128,
                            6: 2445.98490512564,
                            7: 1222.99245256282,
                            8: 611.49622628141,
                            9: 305.7481131407048,
                            10: 152.8740565703525,
                            11: 76.43702828517624,
                            12: 38.21851414258813,
                            13: 19.10925707129406,
                            14: 9.554628535647032,
                            15: 4.777314267823516,
                            16: 2.388657133911758,
                            17: 1.194328566955879,
                            18: 0.5971642834779395,
                            19: 0.2985821417389697,
                            20: 0.1492910708694849,
                            21: 0.0746455354347424
                        };
                        break;
                    }
                    var resolution = scaleDenominator * 0.00028;
                    for (var index in resolutionsNatives) {
                        if (resolutionsNatives.hasOwnProperty(index)) {
                            if (resolutionsNatives[index] <= resolution) {
                                index = parseInt(index, 10);
                                return index;
                            }
                        }
                    }
                    return 0;
                },
                getAttributions: function getAttributions(params) {
                    var zoom = params.zoom;
                    var attributions = [];
                    if (params.originators != null && params.visibility) {
                        var drawLogo;
                        for (var j = 0, jl = params.originators.length; j < jl; j++) {
                            drawLogo = true;
                            var originator = params.originators[j];
                            var constraints = params.originators[j].constraints || [];
                            for (var k = 0, kl = constraints.length; k < kl; k++) {
                                var constraint = constraints[k];
                                drawLogo = true;
                                var minZoomLevel = this.getZoomLevelFromScaleDenominator(constraint.maxScaleDenominator, params.crs);
                                var maxZoomLevel = this.getZoomLevelFromScaleDenominator(constraint.minScaleDenominator, params.crs) || 21;
                                if (minZoomLevel && minZoomLevel > zoom) {
                                    drawLogo = false;
                                }
                                if (drawLogo && maxZoomLevel !== null && maxZoomLevel < zoom) {
                                    drawLogo = false;
                                }
                                var bbox = constraint.bbox;
                                if (drawLogo && bbox) {
                                    drawLogo = false;
                                    var viewExtent = params.extent;
                                    if (viewExtent) {
                                        var bounds = [
                                            bbox.top,
                                            bbox.left,
                                            bbox.bottom,
                                            bbox.right
                                        ];
                                        if (this.intersects(viewExtent, bounds)) {
                                            drawLogo = true;
                                            break;
                                        }
                                    }
                                }
                            }
                            if (drawLogo) {
                                var logo = originator.logo;
                                var url = originator.url;
                                var name = originator.name ? originator.name : '';
                                var text = originator.attribution;
                                var container = document.createElement('div');
                                container.className = 'gp-control-attribution';
                                var link = null;
                                link = document.createElement('a');
                                link.className = 'gp-control-attribution-link';
                                link.target = '_blank';
                                container.appendChild(link);
                                if (url) {
                                    link.href = url;
                                }
                                var bImage = !!logo;
                                var image = null;
                                if (bImage) {
                                    image = document.createElement('img');
                                    if (link) {
                                        image.className = 'gp-control-attribution-image';
                                        link.appendChild(image);
                                    } else {
                                        image.className = '';
                                        container.appendChild(image);
                                    }
                                    image.src = logo;
                                    image.title = text || name;
                                    image.style.height = '30px';
                                    image.style.width = '30px';
                                } else {
                                    if (name) {
                                        link.textContent = name;
                                    } else if (text) {
                                        link.textContent = text;
                                    } else if (url) {
                                        link.textContent = url;
                                    } else {
                                        link.textContent = '';
                                    }
                                }
                                attributions.push(container.innerHTML + ' ');
                            }
                        }
                    }
                    return attributions;
                },
                intersects: function intersects(extent1, extent2) {
                    var intersectsX = extent1[1] <= extent2[3] && extent2[1] <= extent1[3];
                    var intersectsY = extent1[2] <= extent2[0] && extent2[2] <= extent1[0];
                    return intersectsX && intersectsY;
                }
            };
            exports.default = LayerUtils;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Config = __webpack_require__(10);
            var _Config2 = _interopRequireDefault(_Config);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            exports.default = {
                check: function check(options) {
                    var logger = _LoggerByDefault2.default.getLogger('checkrightmanagement');
                    if (!options) {
                        logger.error('WARNING : ' + 'no parameter specified !');
                        return;
                    }
                    var _key = options.key;
                    var _resources = options.resources || [];
                    var _services = options.services || [];
                    if (!_resources || _resources.length === 0) {
                        logger.error('WARNING : ' + 'no parameter \'resources\' specified !');
                        return;
                    }
                    if (!_services || _services.length === 0) {
                        logger.error('WARNING : ' + 'no parameter \'services\' specified !');
                        return;
                    }
                    var _rightManagement = {};
                    if (!_key) {
                        if (!_Config2.default.isConfigLoaded()) {
                            console.log('WARNING : ' + 'The \'apiKey\' parameter is missing, ' + 'and the contract key configuration has not been loaded, ' + 'so impossible to check yours rights !');
                            return;
                        } else {
                            _key = Object.keys(_Config2.default.configuration.generalOptions.apiKeys)[0];
                            logger.log(_key);
                        }
                    }
                    if (_key) {
                        if (!_Config2.default.isConfigLoaded()) {
                            console.log('WARNING : ' + 'the contract key configuration has not been loaded, ' + 'so be carefull !');
                            var _noRightManagement = {};
                            for (var i = 0; i < _services.length; i++) {
                                var service = _services[i];
                                _noRightManagement[service] = [];
                                for (var j = 0; j < _resources.length; j++) {
                                    var resource = _resources[j];
                                    _noRightManagement[service].push(resource);
                                }
                            }
                            _noRightManagement.key = _key;
                            logger.log('right management not checked', _noRightManagement);
                            return _noRightManagement;
                        } else {
                            for (var k = 0; k < _resources.length; k++) {
                                var _resource = _resources[k];
                                for (var l = 0; l < _services.length; l++) {
                                    var _service = _services[l];
                                    var params = _Config2.default.getServiceParams(_resource, _service, _key);
                                    if (!params || Object.keys(params).length === 0) {
                                        console.log('WARNING : ' + 'The contract key configuration has no rights to load this geoportal ' + 'resource (' + _resource + ') ' + 'for this service (' + _service + ') ');
                                        continue;
                                    }
                                    if (!_rightManagement[_service]) {
                                        _rightManagement[_service] = [];
                                    }
                                    _rightManagement[_service].push(_resource);
                                }
                            }
                            if (!_rightManagement || Object.keys(_rightManagement).length === 0) {
                                console.log('WARNING : ' + 'The contract key configuration has been loaded, ' + 'and the \'apiKey\' parameter has been set, ' + 'but, there is a problem on the mapping between the contract and the key !');
                                return;
                            }
                            _rightManagement.key = _key;
                            logger.log('right management checked', _rightManagement);
                            return _rightManagement;
                        }
                    }
                }
            };
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var Marker = {
                lightOrange: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARDSURBVFiF3ZndaxxVGMZ/Z/YjX00Nadpo1qrFBgu56D9QbAtiLoRC7ywSNK1NURRREBKRFlSwFBW0gnSrJXY1CmISgyjFiyYSFC9ajE3MmpjdjWlMUtNos9lN9mteLzbRuCbZmTMTBB+Yi51znvd5n3nPnjnnjBIR/i/wuh4xpCpI0ojiENAA1AE1wCzwKzCE0EM5l2iShJvSyrXKnFVb8dOK4hmg3AIjifAmaU7ztMy7kYI7Zs6rQwjvka+AXcyiOMZx6XGahuE0AEHVitCFnhGAGoQugqrVaSrOKpNP4FWnSaxCGy1yWpesbyY/tLpwo7p/w0RxWHfI6Zk5q7ZSwhj6Q2sjzJLiXp1JQe+p+mllc4wA1CzHtw37lQmpCha5gbXpVxdJythh9z1kvzJJGrFixPBmOXixl+Z4mONmguZ4mIMXezG8WQsq5cs6tmDfTP7NXiSqN0vTzBD1TQfwbdmDUhX4tuyhvukATTNDlgxZ0SmUtUsgv0TZGPsv9FNSvXfNtpLqvey/0O+KTgF0zNQV7XHP4dsdtVvVKYCOmeqiPbwVOx21W9UpgI6ZWNEe2cSEo3arOgWwb0YYLp5G17Sjdqs6BdCZzYqL9B3dR2puYM221NwAfUf3uaJTAB0zaye5GmbWS6i2gdFQL5mFMCIJMgthRkO9hGobMLPFN4VWdAoptlcAQeUDRoG77YrZwDhQT4tk7JDsV6ZFMggv2+bZwyt2jYDuQnOa94GIFrc4IkzRrkPUM3NKsijatLjF0copsbJ++xec7TTPqw6EI/oB/glT+PC+13Y/aSQNv/Is+tNer09lMn7DMHwAYppp8fvTIpISkVQsFrslqww4M9OuqkgzANzl1MhCyrjZGAycm573pK1yFCyi5FoWvo/FYlPOT2fOqftRXMbB9lkEs+3zbe2f/FD5i3YMj2p3vn8/IV8DZ5yE+Gqkot+JEQCPada5dRhxEriiQ5ya90w+272916F+KpnJDLhjpkUy5HgESNqhZU2Vfr5ne+dSFtOBeso06J6cnEy6d0z0hPwEPGeH8sGVykvfjpfe1NZUci2+mHg7Go2G8z/d/goQVJ9B8S1veMYffujduo/thl+ZwUzDuBqJRGZWt7n/FcDH46lFNVLilar1uiTTxsJTnTssH/QpJVlMNQa5wbGJiWERya3Vz30zzfLb3OveY3dU5j5dp4e80Xdbd3TOu/H/yyAtpjnqgeGS8crRQRks+v5xf5gtY/KM/6NAVebhwvv90bLvHu2o/XId2pJSMmIaxo/RaHRMxN6yZtPM0K5K/7hl/FxVZgZWbs0mPDceeKcuGE95/kpSKUmaImHDNIfHrl+PiIj2zOb+MFvBY7IUOVl2ZG9g6bJH4ckJuRe/2NYZT3myKIkrGM4pNRyLjY+LW09URDb1+uaF0pfm3zJ+7zhRGdq1c9eDuwOBOzdLa/OG2X+APwE8DU64Y/5gfAAAAABJRU5ErkJggg==',
                darkOrange: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAQ+SURBVFiF3ZlLaFxlGIaf/5zJpJNpaoxpYieoCxULEYK7Lqp0IWQhFLooKNKEtNIULxWlQoJgQQWLFMEg0lQMuXgD0dRSkNJFgoy0IrYNSTpj08xMmoxNYhLUyUwyt/O5mFbjmGTOLS58d3O+y/u95/vnvx0lIvxf4HE9Y7PyU0ETwl6gAQgANcA88AswhuIsKc7TJ0k3qZVrnTmqtpGhHeFloMJERArF+3g5Qaf84UYJ7og5rPai+JhCB6xiHuEQp+Ws0zI0pwloU+0oBrAnBKAGxQBtqt1pKc46UyjgHadFrEIHXXLCbrB9MYWhNYAb3f0bBsI+u0POnpijahtpJrA/tDbCPOU8aGdSsPdWM7SzOUIAam7ntwzrnWlWfnzMYW76tYsUy9RaXYesd6aCJswI0Tw5WvuG6EyEOWUk6UyEae0bQvPkTLEUeCzBupjCyl4iqyfHydkxdh3YQ/nWnSjlp3zrTnYd2MPJ2TFTgszwFNNaDaCwRdkYLd1B/NWNa9r81Y20dAdd4SmCHTGBkh6P7bvXkd0sTxHsiKku6eH13+fIbpanCHbExEp6ZJJTjuxmeYpgXYwiVNLnysCMI7tZniLYmc1Kk/Qe3E1ycXhNW3JxmN6Du13hKYIdMWsXuRpGzsOxugYu9Q+RXgojkiS9FOZS/xDH6howcqUPhWZ4imB9B9CmyoBx4AGrZBYwCTxMl2StBFnvTJdkUbxlOc4a3rYqBOxuNHfQC0RsxZZGhAA9dgLtiTkuOYQOW7Gl0c5xMbN/+xecnTQPq89QPGM/wT9hCJ8+MvjQ81pK8yp92ZvxeMpUNuvVNK0MQAwjI15vRkTSIpKOxWK/yyoBzsS0qiq8DAP3OxWylNMWmoL1XTMresZsjIJllIzk4GosFrvl/HbmiHoCYRAHx2cBo2Pknp4v45U3befQVY/z8/sp+Q5410mKC7P+oBMhALphBNy6jHgDxU92Am+t6PFXhrcPOeRPp7LZYXfEdEkWjWeBlJWwnKEyr41s/3rFwHDAnjY0zsTj8ZR710Qfys/Aq1ZCPrlZef7iwpYF25xKRhLLyQ+i0Wi48NPtrwBt6hsofeQNJ7zhp74PfGE1/Z0ZzNC0y5FIZHa1zf2vAFmeS2vqerkuVeu5pPLa0otXa01f9CklOQw1AfnRiampkIjk1/JzX0y3/LrY7Dm0w5f/ah0Pee/GXWeiSc/G/y+NjBjGuA6h8snK8VEZLbn+uD/MbiPe7P283pd9uvh5cMH3Q8uPdd+uE7ailFw3NO1aNBqdELG2rdk0MbSqLb8p7UZVmVF/59F8Wp97Mhg4ncjqfxWplKQMkbBmGKGJ6emIiNie2TZPDHB5v+/xxrtXBnWFnhfyL1yp/ejCXMUMShIKQnmlQrFYbFJcKmJTxQBc3O9789FtmZfOzfjPvT5S068bmWvj09PTm8G16WL+S/wJLybNu1V6htkAAAAASUVORK5CYII=',
                red: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAQxSURBVFiF3ZldaBxVFMd/d2ayTRtjQpo2mlilWBEMshoj+FAERZIHIdA3iw+V1icRREFIQAKNgsUHQfBFwZI2WgWxqYUiVTDBBj9ILC5Nu2tjdjemsR+mSZNNNvsxO8eHTTRuk+zMnQmCf9iHnXvO+Z//nDvn3rmjRIT/C6zAI4ZVFRbtKDpQNCM0AvXANIo/EC4inMbmLBFZDJJaBVaZJ9Sd2HQCrwDbXHikgfewOMKPMh9ECsGIeVx1IHxEsQJeMY3iEMNy2m8aht8AtKpOhH70hADUI/TTqjr9puKvMsUE3vabxCp0MSJHdJ31xRSnVj9BVPcfOCj26U45PTHFh30c/am1EaaxuF+nKejd1WLX2gwhAPXL8T3De2XCqooKbuCu/eoiTZ6dXtch75WxaMeNENOyOXx8kHOpGMPOIudSMQ4fH8S0bBcs25Z5PMF7ZVpVL3BgQxvTsvn6+kVq6sK3jc3NRGhraKZgl9t9HGNEXvCSmvfKKJrL2nQfHVpTCEBNXZjuo0OB8JTAu5jiXmtjPL3vLl/jbnlKoNPN6spaVFbt8jXulqcEOmKSZS0yi5O+xt3ylEBHTLSsxbf913yNu+UpgU4DKE/Sc3AvczORNcfmZiL0HNwbCE8JvItxWDvJ1SjYFm0NzZzpG2RpIYbIIksLMc70Dbpsy+54SqCzzlQAY8B9Xsk8YAJ4gBHJe3HyXpkRyaN407OfN7zlVQjobjTv4BgQ1/ItjzjV9Oo46okZEBuhS8u3PDoZEDf7t9vg903zBLBfP8C/4cAnD87teclIGyFlLoVyllWh8vmQYRgVAOI4OQmFciKSFZFsMpmck1UC/Il5VNViEgHu9StkQYyb7bNNH1wrmDm3PgqWUHLBhl+SyeRV/6czLepJDAbw8fos4HTNb+/9PFv9u3YMU/X6f38/L98B7/gJ8U2uasiPEADTcRqDOozoBn7WcbzqmFOvpnYM+uTPpvP5SDBiimvP8xRPKV3DFpV7fX7HyYyD44M96xicmpqaSgd3TDQsv6J4zYvLx5nqsz/kK29qcyq5kFpafD+RSMSKf4P+CvCY+hJFRzmzmB2KPTvb+JnX8CsdzDGM8/F4/PrqseC/AggvZlGXtyipXc8kLcbCy6mdrg/6lBIbR41DYXR8cjIqIoW17IIXc17+nHnEOnS3VfhiHQt5d7HmVMK2Nn6+DHLiOGMmRLdMVI+NymjZ9Sf4abaMqZbQp01G/rnS60P5rT8duNXw1TpuGaXksmMYlxKJxLiIt23NponhKVV5a874rdZwmlYuTTvmjWdmGj9Mifl3kkpJ2hGJGY4THb9yJS4i2p0t+Gm2ggHJxMNb94eNzIAJZgEKbyxsP5kS00ZJSkG0oFQ0mZyYkKDuqIhs6u/7hyt75luM2RMPVfft3rW7bU9T0z2bxbV50+w/wF8f81R5OpwBhwAAAABJRU5ErkJggg==',
                turquoiseBlue: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASxSURBVFiF3ZhdbBRVGIafc2Z2210hbeWnpcQVUC8kwBUJXJBIgwkgBEPEC1GMxhgE4gUJJsYERMWI3orYaiqgrYSWH/mvMaQLciE1RAKUkrLbbhMobQ20/LT7N3OOF0CC0O7szGwv9L3c73u/93vnnD3zzYH/EUTBKx6sHUvQWgR6GTAdmASMA26A6AYuofUhQnYTVevuFlK6cGaObC9DGh8i9PtAKA/GEIKvSRZtZfnbA4VooTBmjlWvQFADPOmBfRN4l8Xv7ffbhvTF1lpwrHoTgga8GeE+by9NNRvR2tfDNfyQmVv5MYJP8L/CAqgidtai/sgpP0W84d7WavBV43Eo0CtYvOaAF7K3Rg7sKKU4Hcf71sqFfmz1DEvX9rslevvPFKc/YnSMAJRhyA+8EN2vzMHasQSzveR3/HrFEMV2udv3kOlaJmgtIg8jYcMcqpu1oGXJhMi0oJQVGaV6Dvd1day62DwnaWWd+GHSciGwz01rHraZXuaUETbMoe6qVR3Ly6fMD0oZAYJBKSOvVEyd3z3/jVjIDCSddYSjzqPwYEY875RRN2tBS4kZnDFcrNQMztw144UzjjKa6W4787IylU4ZSyZEpuWKv1w+dWohdB6Fl9NsnFNCUMqKnHGRO34PYnz+Ld2DFzN3nBIySvXkjGt1PQ+d23l3dB9ezPQ6JRzu6+rIFT/Q25lwVNHkfCDDwYuZFqeEVReb5wxYmQvDxfqz6QtvnW+e69yZcNR5jOKWgKbZKSVpZUOV0bpnG3vi0YxWXUAmo1XXnp54tLL5p+dSyi52FlJRt625nwCavxlDyrgKlLjm5o9byPBkFr456IbkfmWq1t1FsMM1zx1q3RoBr4OmpT4F+jxxndGHrbZ4IXozs3RtP0Ks98R1ghDrvYz/4PfD6ti39Qix0leNh6H07siaL9ZJKYuKtA6lhSgKaC0sWwYATENlLSmVECIZTKcHZ167NtAI9gO6PzO/1ZRg6XPAFF91AJnKDES21NaYN26l8uVoLWyhSZhS/345kUj4/+Q9XjMPdBR/9wl6Qn3TjyWnzyW88i3Y5e92BmDx6tPAV35KjDnXftqHEQBhKDXZvxmA4p5NCJzH+mFg3rxzvXzn0ZN+5BUoW8p4YcxUbbZQ4nXyGEIfhrDt7MS6o/tEOm07Z48ArTPCMPYnEomewpgBeGl1HMQGN5SSk381hdsSNzwqag1tRbZdHY/HL8JoXJwfr24AXnVKK7rae/mpz3fs8aCQ1FqfxzTPxuPxf7243V9oOMESa4XOvqgDZtlIKTKVHpz4w6Ej+ZbUWlgIHdNStkYikbZoNGoNl1f4lQGM3V8us0tLfhmhvh6/98Tu0hN/XslVQ2uRlahOIWWrMozLsVgs7aQ7KmYAAnVb67PjSh+bDsKtHX9Ubmv4dQRaEiE6JLQHwuG21tbWjBvNwm+z+8hmU+/Iu8l5akwo8uA34/bg3+W1B088nKdhCK2vmFJemjV7dqyxsdHzyTZqKwMQ2r55bmpK+SktRABb2ZO+2//9E+djvcAthIgZ0P5aZ+eVzaAKoTeqZgCKt238LP10xYaxZy7tq/j5+E5Ms629vb0b0KOt/Z/GP4jqqfL5oxVsAAAAAElFTkSuQmCC',
                defaultOffset: [
                    -25.5,
                    -38
                ]
            };
            exports.default = Marker;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('GlobeViewExtended');
            function GlobeViewExtended(viewerDiv, coordCarto, options) {
                viewerDiv.style.position = !options || !options.position ? 'relative' : options.position;
                var env = typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {};
                this._itowns = env.itowns;
                this._viewerDiv = viewerDiv;
                this._widgets = [];
                this._initEventMap();
                this._isInitialized = false;
                this._globeView = new this._itowns.GlobeView(viewerDiv, coordCarto, options);
                var self = this;
                this.listen(GlobeViewExtended.EVENTS.GLOBE_INITIALIZED, function () {
                    self._isInitialized = true;
                });
                this._globeView.addFrameRequester(this._itowns.MAIN_LOOP_EVENTS.BEFORE_RENDER, function () {
                    clearTimeout(this._preRenderTimer);
                    self._preRenderTimer = setTimeout(function () {
                        if (self._fetchVisibleColorLayers || self._fetchVisibleElevationLayers || self._fetchExtent) {
                            var event = { type: GlobeViewExtended.EVENTS.PRE_RENDER };
                            if (self._fetchExtent) {
                                event.extent = new self._itowns.Extent('EPSG:4326', 180, -180, 90, -90);
                            }
                            if (self._fetchVisibleColorLayers) {
                                event.colorLayersId = [];
                            }
                            if (self._fetchVisibleElevationLayers) {
                                event.elevationLayersId = [];
                            }
                            self._getCurrentSceneInfos(self._globeView.scene, event);
                            self._globeView.dispatchEvent(event);
                        }
                    }, 100);
                }.bind(this));
                if (this._globeView.controls) {
                    this.freezeControl();
                }
            }
            GlobeViewExtended.prototype._initEventMap = function () {
                if (!GlobeViewExtended.EVENTS) {
                    GlobeViewExtended.EVENTS = {
                        RANGE_CHANGED: this._itowns.CONTROL_EVENTS.RANGE_CHANGED,
                        CENTER_CHANGED: this._itowns.CONTROL_EVENTS.CAMERA_TARGET_CHANGED,
                        ORIENTATION_CHANGED: this._itowns.CONTROL_EVENTS.ORIENTATION_CHANGED,
                        LAYER_ADDED: this._itowns.GLOBE_VIEW_EVENTS.LAYER_ADDED,
                        LAYER_REMOVED: this._itowns.GLOBE_VIEW_EVENTS.LAYER_REMOVED,
                        LAYERS_ORDER_CHANGED: this._itowns.GLOBE_VIEW_EVENTS.COLOR_LAYERS_ORDER_CHANGED,
                        GLOBE_INITIALIZED: this._itowns.GLOBE_VIEW_EVENTS.GLOBE_INITIALIZED,
                        VIEW_INITIALIZED: 'viewinitialized',
                        PRE_RENDER: 'prerender',
                        MOUSE_MOVE: 'mousemove',
                        AFTER_RENDER: this._itowns.MAIN_LOOP_EVENTS.AFTER_RENDER,
                        OPACITY_PROPERTY_CHANGED: 'opacity-property-changed',
                        VISIBLE_PROPERTY_CHANGED: 'visible-property-changed',
                        SEQUENCE_PROPERTY_CHANGED: 'sequence-property-changed'
                    };
                }
            };
            GlobeViewExtended.prototype.constructor = GlobeViewExtended;
            GlobeViewExtended.prototype.getGlobeView = function () {
                return this._globeView;
            };
            GlobeViewExtended.prototype.isInitialized = function () {
                return this._isInitialized;
            };
            GlobeViewExtended.prototype.onCameraMoveStop = function (cb) {
                var self = this;
                function afterRenderHandler() {
                    self._globeView.removeFrameRequester(self._itowns.MAIN_LOOP_EVENTS.AFTER_CAMERA_UPDATE, afterRenderHandler);
                    cb();
                }
                this._globeView.addFrameRequester(this._itowns.MAIN_LOOP_EVENTS.AFTER_CAMERA_UPDATE, afterRenderHandler);
            };
            GlobeViewExtended.prototype.freezeControl = function () {
                this._globeView.controls.enabled = false;
                this.onCameraMoveStop(function () {
                    this._globeView.controls.enabled = true;
                }.bind(this));
            };
            GlobeViewExtended.prototype.listen = function (type, callback) {
                if (typeof callback !== 'function') {
                    console.log('no callback provided for event : ' + type);
                    return null;
                }
                var target = this._getEventTarget(type);
                if (!target) {
                    return null;
                }
                if (type === GlobeViewExtended.EVENTS.AFTER_RENDER) {
                    target.addFrameRequester(type, callback);
                } else {
                    target.addEventListener(type, callback);
                }
                return {
                    target: target,
                    callback: callback,
                    type: type
                };
            };
            GlobeViewExtended.prototype.addLayerListener = function (layer, type, callback) {
                if (typeof callback !== 'function') {
                    console.log('no callback provided for event : ' + type);
                    return null;
                }
                layer.addEventListener(type, callback);
                return {
                    target: layer,
                    callback: callback,
                    type: type
                };
            };
            GlobeViewExtended.prototype._getEventTarget = function (type) {
                switch (type) {
                case GlobeViewExtended.EVENTS.RANGE_CHANGED:
                case GlobeViewExtended.EVENTS.CENTER_CHANGED:
                case GlobeViewExtended.EVENTS.ORIENTATION_CHANGED:
                    return this.getGlobeView().controls;
                case GlobeViewExtended.EVENTS.LAYER_ADDED:
                case GlobeViewExtended.EVENTS.LAYER_REMOVED:
                case GlobeViewExtended.EVENTS.LAYERS_ORDER_CHANGED:
                case GlobeViewExtended.EVENTS.GLOBE_INITIALIZED:
                case GlobeViewExtended.EVENTS.PRE_RENDER:
                case GlobeViewExtended.EVENTS.AFTER_RENDER:
                case GlobeViewExtended.EVENTS.VIEW_INITIALIZED:
                    return this.getGlobeView();
                case GlobeViewExtended.EVENTS.MOUSE_MOVE:
                    return this._viewerDiv;
                default:
                    console.log('unhandled event : ' + type);
                    return null;
                }
            };
            GlobeViewExtended.prototype.forgetByKey = function (key) {
                if (key.type === GlobeViewExtended.EVENTS.AFTER_RENDER) {
                    key.target.removeFrameRequester(key.type, key.callback);
                } else {
                    key.target.removeEventListener(key.type, key.callback);
                }
            };
            GlobeViewExtended.prototype.removeLayerListener = function (layer, type, callback) {
                this.forgetByKey({
                    target: layer,
                    callback: callback,
                    type: type
                });
            };
            GlobeViewExtended.prototype.forget = function (type, callback) {
                var target = this._getEventTarget(type);
                if (!target) {
                    return null;
                }
                this.forgetByKey({
                    target: target,
                    callback: callback,
                    type: type
                });
            };
            GlobeViewExtended.prototype.addLayer = function (layer) {
                var promise = this.getGlobeView().addLayer(layer);
                this.getGlobeView().notifyChange(true);
                return promise;
            };
            GlobeViewExtended.prototype.removeLayer = function (layerId) {
                this.getGlobeView().removeLayer(layerId);
                this.getGlobeView().notifyChange(true);
            };
            GlobeViewExtended.prototype.setLayerOpacity = function (layerId, opacityValue) {
                this.getColorLayerById(layerId).opacity = opacityValue;
                this.getGlobeView().notifyChange(true);
            };
            GlobeViewExtended.prototype.setLayerVisibility = function (layerId, visible) {
                this.getColorLayerById(layerId).visible = visible;
                this.getGlobeView().notifyChange(true);
            };
            GlobeViewExtended.prototype.moveLayerToIndex = function (layerId, index) {
                this._itowns.ColorLayersOrdering.moveLayerToIndex(this.getGlobeView(), layerId, index);
                this.getGlobeView().notifyChange(true);
            };
            GlobeViewExtended.prototype.removeEventListener = function (type, callback) {
                switch (type) {
                case 'mousemove':
                    this._viewerDiv.removeEventListener(type, callback);
                    break;
                case 'centerchanged':
                    this.getGlobeView().controls.removeEventListener(type, callback);
                    break;
                default:
                    this.getGlobeView().removeEventListener(type, callback);
                    break;
                }
            };
            GlobeViewExtended.prototype.preRenderEventFetchViewExtent = function (b) {
                if (typeof b === 'undefined') {
                    b = true;
                }
                this._fetchExtent = b;
            };
            GlobeViewExtended.prototype.preRenderEventFetchColorLayersDisplayed = function (b) {
                if (typeof b === 'undefined') {
                    b = true;
                }
                this._fetchVisibleColorLayers = b;
            };
            GlobeViewExtended.prototype.preRenderEventFetchElevationLayersDisplayed = function (b) {
                if (typeof b === 'undefined') {
                    b = true;
                }
                this._fetchVisibleElevationLayers = b;
            };
            GlobeViewExtended.prototype.preRenderEventFetchLayersDisplayed = function (b) {
                if (typeof b === 'undefined') {
                    b = true;
                }
                this._fetchVisibleColorLayers = b;
                this._fetchVisibleElevationLayers = b;
            };
            GlobeViewExtended.prototype.getLayerById = function (layerId) {
                var layer = this.getGlobeView().getLayers(function (l) {
                    if (l.id === layerId) {
                        return l;
                    }
                })[0];
                if (!layer) {
                    logger.trace('[GlobeViewExtended]  : no Layer found for the id \'' + layerId + '\'');
                    return;
                }
                return layer;
            };
            GlobeViewExtended.prototype.getColorLayerById = function (layerId) {
                var layer = this.getGlobeView().getLayers(function (l) {
                    if (l.id === layerId && l.type === 'color') {
                        return l;
                    }
                })[0];
                if (!layer) {
                    logger.trace('[GlobeViewExtended]  : no colorLayer found for the id \'' + layerId + '\'');
                    return;
                }
                return layer;
            };
            GlobeViewExtended.prototype.getColorLayers = function () {
                return this.getGlobeView().getLayers(function (layer) {
                    if (layer.type === 'color') {
                        return layer;
                    }
                });
            };
            GlobeViewExtended.prototype.getVectorLayers = function () {
                return this.getGlobeView().getLayers(function (layer) {
                    if (layer.protocol === 'rasterizer') {
                        return layer;
                    }
                });
            };
            GlobeViewExtended.prototype.getElevationLayers = function () {
                return this.getGlobeView().getLayers(function (layer) {
                    if (layer.type === 'elevation') {
                        return layer;
                    }
                });
            };
            GlobeViewExtended.prototype.getExtent = function () {
                var options = { extent: new this._itowns.Extent('EPSG:4326', 180, -180, 90, -90) };
                this._getCurrentSceneInfos(this.scene, options);
                return options.extent;
            };
            GlobeViewExtended.prototype._getCurrentSceneInfos = function (node, options) {
                if (!node || !node.visible) {
                    return;
                }
                if (node.level) {
                    if (node.material.visible) {
                        if (options.colorLayersId) {
                            for (var i = 0; i < node.material.colorLayersId.length; ++i) {
                                if (options.colorLayersId.indexOf(node.material.colorLayersId[i]) < 0) {
                                    options.colorLayersId.push(node.material.colorLayersId[i]);
                                }
                            }
                        }
                        if (options.elevationLayersId) {
                            for (var j = 0; j < node.material.elevationLayersId.length; ++j) {
                                if (options.elevationLayersId.indexOf(node.material.elevationLayersId[j]) < 0) {
                                    options.elevationLayersId.push(node.material.elevationLayersId[j]);
                                }
                            }
                        }
                        if (options.extent) {
                            options.extent.union(node.extent);
                        }
                    }
                }
                if (node.children) {
                    for (var child in node.children) {
                        this._getCurrentSceneInfos(node.children[child], options);
                    }
                }
            };
            GlobeViewExtended.prototype.addWidget = function (widget) {
                if (!widget.getTarget()) {
                    widget.setTarget(this._viewerDiv, 'absolute');
                }
                widget.setGlobe(this);
                this._widgets.push(widget);
            };
            GlobeViewExtended.prototype.getWidgets = function () {
                return this._widgets;
            };
            GlobeViewExtended.prototype.removeWidget = function (widget) {
                widget.setGlobe();
                for (var idx = 0; idx < this._widgets.length; idx++) {
                    if (this._widgets[idx] === widget) {
                        this._widgets.splice(idx, 1);
                    }
                }
            };
            GlobeViewExtended.prototype.getTargetElement = function () {
                return this._viewerDiv;
            };
            GlobeViewExtended.prototype.getScale = function () {
                return this.getGlobeView().controls.getScale();
            };
            GlobeViewExtended.prototype.setTilt = function (tilt) {
                return this.getGlobeView().controls.setTilt(tilt, false);
            };
            GlobeViewExtended.prototype.getTilt = function () {
                return this.getGlobeView().controls.getCameraOrientation()[0];
            };
            GlobeViewExtended.prototype.setAzimuth = function (azimuth) {
                return this.getGlobeView().controls.setHeading(azimuth, false);
            };
            GlobeViewExtended.prototype.getAzimuth = function () {
                return this.getGlobeView().controls.getCameraOrientation()[1];
            };
            GlobeViewExtended.prototype.getCoordinateFromPixel = function (x, y) {
                return this.getGlobeView().controls.pickGeoPosition({
                    x: x,
                    y: y
                });
            };
            GlobeViewExtended.prototype.getCoordinateFromMouseEvent = function (mouseEvent) {
                var coords = this.getGlobeView().eventToViewCoords(mouseEvent);
                return this.getGlobeView().controls.pickGeoPosition(coords);
            };
            GlobeViewExtended.prototype.getFeaturesAtMousePosition = function (mouseEvent) {
                var vectorLayers = this.getVectorLayers();
                if (!vectorLayers) {
                    return;
                }
                var visibleFeatures = [];
                var geoCoord = this.getCoordinateFromMouseEvent(mouseEvent);
                if (geoCoord) {
                    var precision = this.getGlobeView().controls.pixelsToDegrees(5);
                    for (var i = 0; i < vectorLayers.length; i++) {
                        var idx;
                        var layer = vectorLayers[i];
                        if (!layer.visible) {
                            continue;
                        }
                        var result = this._itowns.FeaturesUtils.filterFeaturesUnderCoordinate(geoCoord, layer.feature, precision);
                        for (idx = 0; idx < result.length; idx++) {
                            visibleFeatures.push(result[idx]);
                        }
                    }
                }
                return visibleFeatures;
            };
            GlobeViewExtended.prototype.setCameraTargetGeoPosition = function (center) {
                return this.getGlobeView().controls.setCameraTargetGeoPositionAdvanced(center, false);
            };
            GlobeViewExtended.prototype.getCenter = function () {
                var cameraCenter = this.getGlobeView().controls.getCameraTargetGeoPosition();
                var center = {
                    lon: cameraCenter.longitude(),
                    lat: cameraCenter.latitude(),
                    alt: cameraCenter.altitude()
                };
                return center;
            };
            GlobeViewExtended.prototype.getZoom = function () {
                return this.getGlobeView().controls.getZoom();
            };
            GlobeViewExtended.prototype.setZoom = function (zoom) {
                return this.getGlobeView().controls.setZoom(zoom, false);
            };
            GlobeViewExtended.prototype.pixelsToMeters = function (pixels) {
                return this.getGlobeView().controls.pixelsToMeters(pixels);
            };
            GlobeViewExtended.prototype.metersToPixels = function (value) {
                return this.getGlobeView().controls.metersToPixels(value);
            };
            GlobeViewExtended.prototype.getRange = function () {
                return this.getGlobeView().controls.getRange();
            };
            GlobeViewExtended.prototype.moveTarget = function () {
                return this.getGlobeView().controls.moveTarget();
            };
            GlobeViewExtended.prototype.getLayerEventInfos = function (evt) {
                var propertyName = evt.type.replace('-property-changed', '');
                return {
                    propertyName: propertyName,
                    previousValue: evt.previous[propertyName],
                    newValue: evt.new[propertyName]
                };
            };
            GlobeViewExtended.prototype.setBackground = function () {
                this.getGlobeView().mainLoop.gfxEngine.renderer.setClearColor(0, 0);
            };
            GlobeViewExtended.prototype.setCameraPosition = function (target, distance) {
                this.getGlobeView().camera.camera3D.position.copy(target).setLength(distance);
            };
            GlobeViewExtended.prototype.lookAt = function (target) {
                this.getGlobeView().camera.camera3D.lookAt(target);
            };
            GlobeViewExtended.prototype.notifyChange = function () {
                this.getGlobeView().notifyChange(true);
            };
            GlobeViewExtended.prototype.resize = function (width, height) {
                this.getGlobeView().mainLoop.gfxEngine.onWindowResize(width, height);
                this.getGlobeView().notifyChange(true);
            };
            exports.default = GlobeViewExtended;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            (function (global, factory) {
                true ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : global.proj4 = factory();
            }(this, function () {
                'use strict';
                var globals = function (defs) {
                    defs('EPSG:4326', '+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees');
                    defs('EPSG:4269', '+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees');
                    defs('EPSG:3857', '+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs');
                    defs.WGS84 = defs['EPSG:4326'];
                    defs['EPSG:3785'] = defs['EPSG:3857'];
                    defs.GOOGLE = defs['EPSG:3857'];
                    defs['EPSG:900913'] = defs['EPSG:3857'];
                    defs['EPSG:102113'] = defs['EPSG:3857'];
                };
                var PJD_3PARAM = 1;
                var PJD_7PARAM = 2;
                var PJD_WGS84 = 4;
                var PJD_NODATUM = 5;
                var SEC_TO_RAD = 0.00000484813681109536;
                var HALF_PI = Math.PI / 2;
                var SIXTH = 0.16666666666666666;
                var RA4 = 0.04722222222222222;
                var RA6 = 0.022156084656084655;
                var EPSLN = 1e-10;
                var D2R = 0.017453292519943295;
                var R2D = 57.29577951308232;
                var FORTPI = Math.PI / 4;
                var TWO_PI = Math.PI * 2;
                var SPI = 3.14159265359;
                var exports$1 = {};
                exports$1.greenwich = 0;
                exports$1.lisbon = -9.131906111111;
                exports$1.paris = 2.337229166667;
                exports$1.bogota = -74.080916666667;
                exports$1.madrid = -3.687938888889;
                exports$1.rome = 12.452333333333;
                exports$1.bern = 7.439583333333;
                exports$1.jakarta = 106.807719444444;
                exports$1.ferro = -17.666666666667;
                exports$1.brussels = 4.367975;
                exports$1.stockholm = 18.058277777778;
                exports$1.athens = 23.7163375;
                exports$1.oslo = 10.722916666667;
                var units = {
                    ft: { to_meter: 0.3048 },
                    'us-ft': { to_meter: 1200 / 3937 }
                };
                var ignoredChar = /[\s_\-\/\(\)]/g;
                function match(obj, key) {
                    if (obj[key]) {
                        return obj[key];
                    }
                    var keys = Object.keys(obj);
                    var lkey = key.toLowerCase().replace(ignoredChar, '');
                    var i = -1;
                    var testkey, processedKey;
                    while (++i < keys.length) {
                        testkey = keys[i];
                        processedKey = testkey.toLowerCase().replace(ignoredChar, '');
                        if (processedKey === lkey) {
                            return obj[testkey];
                        }
                    }
                }
                var parseProj = function (defData) {
                    var self = {};
                    var paramObj = defData.split('+').map(function (v) {
                        return v.trim();
                    }).filter(function (a) {
                        return a;
                    }).reduce(function (p, a) {
                        var split = a.split('=');
                        split.push(true);
                        p[split[0].toLowerCase()] = split[1];
                        return p;
                    }, {});
                    var paramName, paramVal, paramOutname;
                    var params = {
                        proj: 'projName',
                        datum: 'datumCode',
                        rf: function (v) {
                            self.rf = parseFloat(v);
                        },
                        lat_0: function (v) {
                            self.lat0 = v * D2R;
                        },
                        lat_1: function (v) {
                            self.lat1 = v * D2R;
                        },
                        lat_2: function (v) {
                            self.lat2 = v * D2R;
                        },
                        lat_ts: function (v) {
                            self.lat_ts = v * D2R;
                        },
                        lon_0: function (v) {
                            self.long0 = v * D2R;
                        },
                        lon_1: function (v) {
                            self.long1 = v * D2R;
                        },
                        lon_2: function (v) {
                            self.long2 = v * D2R;
                        },
                        alpha: function (v) {
                            self.alpha = parseFloat(v) * D2R;
                        },
                        lonc: function (v) {
                            self.longc = v * D2R;
                        },
                        x_0: function (v) {
                            self.x0 = parseFloat(v);
                        },
                        y_0: function (v) {
                            self.y0 = parseFloat(v);
                        },
                        k_0: function (v) {
                            self.k0 = parseFloat(v);
                        },
                        k: function (v) {
                            self.k0 = parseFloat(v);
                        },
                        a: function (v) {
                            self.a = parseFloat(v);
                        },
                        b: function (v) {
                            self.b = parseFloat(v);
                        },
                        r_a: function () {
                            self.R_A = true;
                        },
                        zone: function (v) {
                            self.zone = parseInt(v, 10);
                        },
                        south: function () {
                            self.utmSouth = true;
                        },
                        towgs84: function (v) {
                            self.datum_params = v.split(',').map(function (a) {
                                return parseFloat(a);
                            });
                        },
                        to_meter: function (v) {
                            self.to_meter = parseFloat(v);
                        },
                        units: function (v) {
                            self.units = v;
                            var unit = match(units, v);
                            if (unit) {
                                self.to_meter = unit.to_meter;
                            }
                        },
                        from_greenwich: function (v) {
                            self.from_greenwich = v * D2R;
                        },
                        pm: function (v) {
                            var pm = match(exports$1, v);
                            self.from_greenwich = (pm ? pm : parseFloat(v)) * D2R;
                        },
                        nadgrids: function (v) {
                            if (v === '@null') {
                                self.datumCode = 'none';
                            } else {
                                self.nadgrids = v;
                            }
                        },
                        axis: function (v) {
                            var legalAxis = 'ewnsud';
                            if (v.length === 3 && legalAxis.indexOf(v.substr(0, 1)) !== -1 && legalAxis.indexOf(v.substr(1, 1)) !== -1 && legalAxis.indexOf(v.substr(2, 1)) !== -1) {
                                self.axis = v;
                            }
                        }
                    };
                    for (paramName in paramObj) {
                        paramVal = paramObj[paramName];
                        if (paramName in params) {
                            paramOutname = params[paramName];
                            if (typeof paramOutname === 'function') {
                                paramOutname(paramVal);
                            } else {
                                self[paramOutname] = paramVal;
                            }
                        } else {
                            self[paramName] = paramVal;
                        }
                    }
                    if (typeof self.datumCode === 'string' && self.datumCode !== 'WGS84') {
                        self.datumCode = self.datumCode.toLowerCase();
                    }
                    return self;
                };
                var NEUTRAL = 1;
                var KEYWORD = 2;
                var NUMBER = 3;
                var QUOTED = 4;
                var AFTERQUOTE = 5;
                var ENDED = -1;
                var whitespace = /\s/;
                var latin = /[A-Za-z]/;
                var keyword = /[A-Za-z84]/;
                var endThings = /[,\]]/;
                var digets = /[\d\.E\-\+]/;
                function Parser(text) {
                    if (typeof text !== 'string') {
                        throw new Error('not a string');
                    }
                    this.text = text.trim();
                    this.level = 0;
                    this.place = 0;
                    this.root = null;
                    this.stack = [];
                    this.currentObject = null;
                    this.state = NEUTRAL;
                }
                Parser.prototype.readCharicter = function () {
                    var char = this.text[this.place++];
                    if (this.state !== QUOTED) {
                        while (whitespace.test(char)) {
                            if (this.place >= this.text.length) {
                                return;
                            }
                            char = this.text[this.place++];
                        }
                    }
                    switch (this.state) {
                    case NEUTRAL:
                        return this.neutral(char);
                    case KEYWORD:
                        return this.keyword(char);
                    case QUOTED:
                        return this.quoted(char);
                    case AFTERQUOTE:
                        return this.afterquote(char);
                    case NUMBER:
                        return this.number(char);
                    case ENDED:
                        return;
                    }
                };
                Parser.prototype.afterquote = function (char) {
                    if (char === '"') {
                        this.word += '"';
                        this.state = QUOTED;
                        return;
                    }
                    if (endThings.test(char)) {
                        this.word = this.word.trim();
                        this.afterItem(char);
                        return;
                    }
                    throw new Error('havn\'t handled "' + char + '" in afterquote yet, index ' + this.place);
                };
                Parser.prototype.afterItem = function (char) {
                    if (char === ',') {
                        if (this.word !== null) {
                            this.currentObject.push(this.word);
                        }
                        this.word = null;
                        this.state = NEUTRAL;
                        return;
                    }
                    if (char === ']') {
                        this.level--;
                        if (this.word !== null) {
                            this.currentObject.push(this.word);
                            this.word = null;
                        }
                        this.state = NEUTRAL;
                        this.currentObject = this.stack.pop();
                        if (!this.currentObject) {
                            this.state = ENDED;
                        }
                        return;
                    }
                };
                Parser.prototype.number = function (char) {
                    if (digets.test(char)) {
                        this.word += char;
                        return;
                    }
                    if (endThings.test(char)) {
                        this.word = parseFloat(this.word);
                        this.afterItem(char);
                        return;
                    }
                    throw new Error('havn\'t handled "' + char + '" in number yet, index ' + this.place);
                };
                Parser.prototype.quoted = function (char) {
                    if (char === '"') {
                        this.state = AFTERQUOTE;
                        return;
                    }
                    this.word += char;
                    return;
                };
                Parser.prototype.keyword = function (char) {
                    if (keyword.test(char)) {
                        this.word += char;
                        return;
                    }
                    if (char === '[') {
                        var newObjects = [];
                        newObjects.push(this.word);
                        this.level++;
                        if (this.root === null) {
                            this.root = newObjects;
                        } else {
                            this.currentObject.push(newObjects);
                        }
                        this.stack.push(this.currentObject);
                        this.currentObject = newObjects;
                        this.state = NEUTRAL;
                        return;
                    }
                    if (endThings.test(char)) {
                        this.afterItem(char);
                        return;
                    }
                    throw new Error('havn\'t handled "' + char + '" in keyword yet, index ' + this.place);
                };
                Parser.prototype.neutral = function (char) {
                    if (latin.test(char)) {
                        this.word = char;
                        this.state = KEYWORD;
                        return;
                    }
                    if (char === '"') {
                        this.word = '';
                        this.state = QUOTED;
                        return;
                    }
                    if (digets.test(char)) {
                        this.word = char;
                        this.state = NUMBER;
                        return;
                    }
                    if (endThings.test(char)) {
                        this.afterItem(char);
                        return;
                    }
                    throw new Error('havn\'t handled "' + char + '" in neutral yet, index ' + this.place);
                };
                Parser.prototype.output = function () {
                    while (this.place < this.text.length) {
                        this.readCharicter();
                    }
                    if (this.state === ENDED) {
                        return this.root;
                    }
                    throw new Error('unable to parse string "' + this.text + '". State is ' + this.state);
                };
                function parseString(txt) {
                    var parser = new Parser(txt);
                    return parser.output();
                }
                function mapit(obj, key, value) {
                    if (Array.isArray(key)) {
                        value.unshift(key);
                        key = null;
                    }
                    var thing = key ? {} : obj;
                    var out = value.reduce(function (newObj, item) {
                        sExpr(item, newObj);
                        return newObj;
                    }, thing);
                    if (key) {
                        obj[key] = out;
                    }
                }
                function sExpr(v, obj) {
                    if (!Array.isArray(v)) {
                        obj[v] = true;
                        return;
                    }
                    var key = v.shift();
                    if (key === 'PARAMETER') {
                        key = v.shift();
                    }
                    if (v.length === 1) {
                        if (Array.isArray(v[0])) {
                            obj[key] = {};
                            sExpr(v[0], obj[key]);
                            return;
                        }
                        obj[key] = v[0];
                        return;
                    }
                    if (!v.length) {
                        obj[key] = true;
                        return;
                    }
                    if (key === 'TOWGS84') {
                        obj[key] = v;
                        return;
                    }
                    if (!Array.isArray(key)) {
                        obj[key] = {};
                    }
                    var i;
                    switch (key) {
                    case 'UNIT':
                    case 'PRIMEM':
                    case 'VERT_DATUM':
                        obj[key] = {
                            name: v[0].toLowerCase(),
                            convert: v[1]
                        };
                        if (v.length === 3) {
                            sExpr(v[2], obj[key]);
                        }
                        return;
                    case 'SPHEROID':
                    case 'ELLIPSOID':
                        obj[key] = {
                            name: v[0],
                            a: v[1],
                            rf: v[2]
                        };
                        if (v.length === 4) {
                            sExpr(v[3], obj[key]);
                        }
                        return;
                    case 'PROJECTEDCRS':
                    case 'PROJCRS':
                    case 'GEOGCS':
                    case 'GEOCCS':
                    case 'PROJCS':
                    case 'LOCAL_CS':
                    case 'GEODCRS':
                    case 'GEODETICCRS':
                    case 'GEODETICDATUM':
                    case 'EDATUM':
                    case 'ENGINEERINGDATUM':
                    case 'VERT_CS':
                    case 'VERTCRS':
                    case 'VERTICALCRS':
                    case 'COMPD_CS':
                    case 'COMPOUNDCRS':
                    case 'ENGINEERINGCRS':
                    case 'ENGCRS':
                    case 'FITTED_CS':
                    case 'LOCAL_DATUM':
                    case 'DATUM':
                        v[0] = [
                            'name',
                            v[0]
                        ];
                        mapit(obj, key, v);
                        return;
                    default:
                        i = -1;
                        while (++i < v.length) {
                            if (!Array.isArray(v[i])) {
                                return sExpr(v, obj[key]);
                            }
                        }
                        return mapit(obj, key, v);
                    }
                }
                var D2R$1 = 0.017453292519943295;
                function rename(obj, params) {
                    var outName = params[0];
                    var inName = params[1];
                    if (!(outName in obj) && inName in obj) {
                        obj[outName] = obj[inName];
                        if (params.length === 3) {
                            obj[outName] = params[2](obj[outName]);
                        }
                    }
                }
                function d2r(input) {
                    return input * D2R$1;
                }
                function cleanWKT(wkt) {
                    if (wkt.type === 'GEOGCS') {
                        wkt.projName = 'longlat';
                    } else if (wkt.type === 'LOCAL_CS') {
                        wkt.projName = 'identity';
                        wkt.local = true;
                    } else {
                        if (typeof wkt.PROJECTION === 'object') {
                            wkt.projName = Object.keys(wkt.PROJECTION)[0];
                        } else {
                            wkt.projName = wkt.PROJECTION;
                        }
                    }
                    if (wkt.UNIT) {
                        wkt.units = wkt.UNIT.name.toLowerCase();
                        if (wkt.units === 'metre') {
                            wkt.units = 'meter';
                        }
                        if (wkt.UNIT.convert) {
                            if (wkt.type === 'GEOGCS') {
                                if (wkt.DATUM && wkt.DATUM.SPHEROID) {
                                    wkt.to_meter = wkt.UNIT.convert * wkt.DATUM.SPHEROID.a;
                                }
                            } else {
                                wkt.to_meter = wkt.UNIT.convert, 10;
                            }
                        }
                    }
                    var geogcs = wkt.GEOGCS;
                    if (wkt.type === 'GEOGCS') {
                        geogcs = wkt;
                    }
                    if (geogcs) {
                        if (geogcs.DATUM) {
                            wkt.datumCode = geogcs.DATUM.name.toLowerCase();
                        } else {
                            wkt.datumCode = geogcs.name.toLowerCase();
                        }
                        if (wkt.datumCode.slice(0, 2) === 'd_') {
                            wkt.datumCode = wkt.datumCode.slice(2);
                        }
                        if (wkt.datumCode === 'new_zealand_geodetic_datum_1949' || wkt.datumCode === 'new_zealand_1949') {
                            wkt.datumCode = 'nzgd49';
                        }
                        if (wkt.datumCode === 'wgs_1984') {
                            if (wkt.PROJECTION === 'Mercator_Auxiliary_Sphere') {
                                wkt.sphere = true;
                            }
                            wkt.datumCode = 'wgs84';
                        }
                        if (wkt.datumCode.slice(-6) === '_ferro') {
                            wkt.datumCode = wkt.datumCode.slice(0, -6);
                        }
                        if (wkt.datumCode.slice(-8) === '_jakarta') {
                            wkt.datumCode = wkt.datumCode.slice(0, -8);
                        }
                        if (~wkt.datumCode.indexOf('belge')) {
                            wkt.datumCode = 'rnb72';
                        }
                        if (geogcs.DATUM && geogcs.DATUM.SPHEROID) {
                            wkt.ellps = geogcs.DATUM.SPHEROID.name.replace('_19', '').replace(/[Cc]larke\_18/, 'clrk');
                            if (wkt.ellps.toLowerCase().slice(0, 13) === 'international') {
                                wkt.ellps = 'intl';
                            }
                            wkt.a = geogcs.DATUM.SPHEROID.a;
                            wkt.rf = parseFloat(geogcs.DATUM.SPHEROID.rf, 10);
                        }
                        if (~wkt.datumCode.indexOf('osgb_1936')) {
                            wkt.datumCode = 'osgb36';
                        }
                        if (~wkt.datumCode.indexOf('osni_1952')) {
                            wkt.datumCode = 'osni52';
                        }
                        if (~wkt.datumCode.indexOf('tm65') || ~wkt.datumCode.indexOf('geodetic_datum_of_1965')) {
                            wkt.datumCode = 'ire65';
                        }
                    }
                    if (wkt.b && !isFinite(wkt.b)) {
                        wkt.b = wkt.a;
                    }
                    function toMeter(input) {
                        var ratio = wkt.to_meter || 1;
                        return input * ratio;
                    }
                    var renamer = function (a) {
                        return rename(wkt, a);
                    };
                    var list = [
                        [
                            'standard_parallel_1',
                            'Standard_Parallel_1'
                        ],
                        [
                            'standard_parallel_2',
                            'Standard_Parallel_2'
                        ],
                        [
                            'false_easting',
                            'False_Easting'
                        ],
                        [
                            'false_northing',
                            'False_Northing'
                        ],
                        [
                            'central_meridian',
                            'Central_Meridian'
                        ],
                        [
                            'latitude_of_origin',
                            'Latitude_Of_Origin'
                        ],
                        [
                            'latitude_of_origin',
                            'Central_Parallel'
                        ],
                        [
                            'scale_factor',
                            'Scale_Factor'
                        ],
                        [
                            'k0',
                            'scale_factor'
                        ],
                        [
                            'latitude_of_center',
                            'Latitude_of_center'
                        ],
                        [
                            'lat0',
                            'latitude_of_center',
                            d2r
                        ],
                        [
                            'longitude_of_center',
                            'Longitude_Of_Center'
                        ],
                        [
                            'longc',
                            'longitude_of_center',
                            d2r
                        ],
                        [
                            'x0',
                            'false_easting',
                            toMeter
                        ],
                        [
                            'y0',
                            'false_northing',
                            toMeter
                        ],
                        [
                            'long0',
                            'central_meridian',
                            d2r
                        ],
                        [
                            'lat0',
                            'latitude_of_origin',
                            d2r
                        ],
                        [
                            'lat0',
                            'standard_parallel_1',
                            d2r
                        ],
                        [
                            'lat1',
                            'standard_parallel_1',
                            d2r
                        ],
                        [
                            'lat2',
                            'standard_parallel_2',
                            d2r
                        ],
                        [
                            'alpha',
                            'azimuth',
                            d2r
                        ],
                        [
                            'srsCode',
                            'name'
                        ]
                    ];
                    list.forEach(renamer);
                    if (!wkt.long0 && wkt.longc && (wkt.projName === 'Albers_Conic_Equal_Area' || wkt.projName === 'Lambert_Azimuthal_Equal_Area')) {
                        wkt.long0 = wkt.longc;
                    }
                    if (!wkt.lat_ts && wkt.lat1 && (wkt.projName === 'Stereographic_South_Pole' || wkt.projName === 'Polar Stereographic (variant B)')) {
                        wkt.lat0 = d2r(wkt.lat1 > 0 ? 90 : -90);
                        wkt.lat_ts = wkt.lat1;
                    }
                }
                var wkt = function (wkt) {
                    var lisp = parseString(wkt);
                    var type = lisp.shift();
                    var name = lisp.shift();
                    lisp.unshift([
                        'name',
                        name
                    ]);
                    lisp.unshift([
                        'type',
                        type
                    ]);
                    var obj = {};
                    sExpr(lisp, obj);
                    cleanWKT(obj);
                    return obj;
                };
                function defs(name) {
                    var that = this;
                    if (arguments.length === 2) {
                        var def = arguments[1];
                        if (typeof def === 'string') {
                            if (def.charAt(0) === '+') {
                                defs[name] = parseProj(arguments[1]);
                            } else {
                                defs[name] = wkt(arguments[1]);
                            }
                        } else {
                            defs[name] = def;
                        }
                    } else if (arguments.length === 1) {
                        if (Array.isArray(name)) {
                            return name.map(function (v) {
                                if (Array.isArray(v)) {
                                    defs.apply(that, v);
                                } else {
                                    defs(v);
                                }
                            });
                        } else if (typeof name === 'string') {
                            if (name in defs) {
                                return defs[name];
                            }
                        } else if ('EPSG' in name) {
                            defs['EPSG:' + name.EPSG] = name;
                        } else if ('ESRI' in name) {
                            defs['ESRI:' + name.ESRI] = name;
                        } else if ('IAU2000' in name) {
                            defs['IAU2000:' + name.IAU2000] = name;
                        } else {
                            console.log(name);
                        }
                        return;
                    }
                }
                globals(defs);
                function testObj(code) {
                    return typeof code === 'string';
                }
                function testDef(code) {
                    return code in defs;
                }
                var codeWords = [
                    'PROJECTEDCRS',
                    'PROJCRS',
                    'GEOGCS',
                    'GEOCCS',
                    'PROJCS',
                    'LOCAL_CS',
                    'GEODCRS',
                    'GEODETICCRS',
                    'GEODETICDATUM',
                    'ENGCRS',
                    'ENGINEERINGCRS'
                ];
                function testWKT(code) {
                    return codeWords.some(function (word) {
                        return code.indexOf(word) > -1;
                    });
                }
                function testProj(code) {
                    return code[0] === '+';
                }
                function parse(code) {
                    if (testObj(code)) {
                        if (testDef(code)) {
                            return defs[code];
                        }
                        if (testWKT(code)) {
                            return wkt(code);
                        }
                        if (testProj(code)) {
                            return parseProj(code);
                        }
                    } else {
                        return code;
                    }
                }
                var extend = function (destination, source) {
                    destination = destination || {};
                    var value, property;
                    if (!source) {
                        return destination;
                    }
                    for (property in source) {
                        value = source[property];
                        if (value !== undefined) {
                            destination[property] = value;
                        }
                    }
                    return destination;
                };
                var msfnz = function (eccent, sinphi, cosphi) {
                    var con = eccent * sinphi;
                    return cosphi / Math.sqrt(1 - con * con);
                };
                var sign = function (x) {
                    return x < 0 ? -1 : 1;
                };
                var adjust_lon = function (x) {
                    return Math.abs(x) <= SPI ? x : x - sign(x) * TWO_PI;
                };
                var tsfnz = function (eccent, phi, sinphi) {
                    var con = eccent * sinphi;
                    var com = 0.5 * eccent;
                    con = Math.pow((1 - con) / (1 + con), com);
                    return Math.tan(0.5 * (HALF_PI - phi)) / con;
                };
                var phi2z = function (eccent, ts) {
                    var eccnth = 0.5 * eccent;
                    var con, dphi;
                    var phi = HALF_PI - 2 * Math.atan(ts);
                    for (var i = 0; i <= 15; i++) {
                        con = eccent * Math.sin(phi);
                        dphi = HALF_PI - 2 * Math.atan(ts * Math.pow((1 - con) / (1 + con), eccnth)) - phi;
                        phi += dphi;
                        if (Math.abs(dphi) <= 1e-10) {
                            return phi;
                        }
                    }
                    return -9999;
                };
                function init() {
                    var con = this.b / this.a;
                    this.es = 1 - con * con;
                    if (!('x0' in this)) {
                        this.x0 = 0;
                    }
                    if (!('y0' in this)) {
                        this.y0 = 0;
                    }
                    this.e = Math.sqrt(this.es);
                    if (this.lat_ts) {
                        if (this.sphere) {
                            this.k0 = Math.cos(this.lat_ts);
                        } else {
                            this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));
                        }
                    } else {
                        if (!this.k0) {
                            if (this.k) {
                                this.k0 = this.k;
                            } else {
                                this.k0 = 1;
                            }
                        }
                    }
                }
                function forward(p) {
                    var lon = p.x;
                    var lat = p.y;
                    if (lat * R2D > 90 && lat * R2D < -90 && lon * R2D > 180 && lon * R2D < -180) {
                        return null;
                    }
                    var x, y;
                    if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {
                        return null;
                    } else {
                        if (this.sphere) {
                            x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);
                            y = this.y0 + this.a * this.k0 * Math.log(Math.tan(FORTPI + 0.5 * lat));
                        } else {
                            var sinphi = Math.sin(lat);
                            var ts = tsfnz(this.e, lat, sinphi);
                            x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);
                            y = this.y0 - this.a * this.k0 * Math.log(ts);
                        }
                        p.x = x;
                        p.y = y;
                        return p;
                    }
                }
                function inverse(p) {
                    var x = p.x - this.x0;
                    var y = p.y - this.y0;
                    var lon, lat;
                    if (this.sphere) {
                        lat = HALF_PI - 2 * Math.atan(Math.exp(-y / (this.a * this.k0)));
                    } else {
                        var ts = Math.exp(-y / (this.a * this.k0));
                        lat = phi2z(this.e, ts);
                        if (lat === -9999) {
                            return null;
                        }
                    }
                    lon = adjust_lon(this.long0 + x / (this.a * this.k0));
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$1 = [
                    'Mercator',
                    'Popular Visualisation Pseudo Mercator',
                    'Mercator_1SP',
                    'Mercator_Auxiliary_Sphere',
                    'merc'
                ];
                var merc = {
                    init: init,
                    forward: forward,
                    inverse: inverse,
                    names: names$1
                };
                function init$1() {
                }
                function identity(pt) {
                    return pt;
                }
                var names$2 = [
                    'longlat',
                    'identity'
                ];
                var longlat = {
                    init: init$1,
                    forward: identity,
                    inverse: identity,
                    names: names$2
                };
                var projs = [
                    merc,
                    longlat
                ];
                var names$$1 = {};
                var projStore = [];
                function add(proj, i) {
                    var len = projStore.length;
                    if (!proj.names) {
                        console.log(i);
                        return true;
                    }
                    projStore[len] = proj;
                    proj.names.forEach(function (n) {
                        names$$1[n.toLowerCase()] = len;
                    });
                    return this;
                }
                function get(name) {
                    if (!name) {
                        return false;
                    }
                    var n = name.toLowerCase();
                    if (typeof names$$1[n] !== 'undefined' && projStore[names$$1[n]]) {
                        return projStore[names$$1[n]];
                    }
                }
                function start() {
                    projs.forEach(add);
                }
                var projections = {
                    start: start,
                    add: add,
                    get: get
                };
                var exports$2 = {};
                exports$2.MERIT = {
                    a: 6378137,
                    rf: 298.257,
                    ellipseName: 'MERIT 1983'
                };
                exports$2.SGS85 = {
                    a: 6378136,
                    rf: 298.257,
                    ellipseName: 'Soviet Geodetic System 85'
                };
                exports$2.GRS80 = {
                    a: 6378137,
                    rf: 298.257222101,
                    ellipseName: 'GRS 1980(IUGG, 1980)'
                };
                exports$2.IAU76 = {
                    a: 6378140,
                    rf: 298.257,
                    ellipseName: 'IAU 1976'
                };
                exports$2.airy = {
                    a: 6377563.396,
                    b: 6356256.91,
                    ellipseName: 'Airy 1830'
                };
                exports$2.APL4 = {
                    a: 6378137,
                    rf: 298.25,
                    ellipseName: 'Appl. Physics. 1965'
                };
                exports$2.NWL9D = {
                    a: 6378145,
                    rf: 298.25,
                    ellipseName: 'Naval Weapons Lab., 1965'
                };
                exports$2.mod_airy = {
                    a: 6377340.189,
                    b: 6356034.446,
                    ellipseName: 'Modified Airy'
                };
                exports$2.andrae = {
                    a: 6377104.43,
                    rf: 300,
                    ellipseName: 'Andrae 1876 (Den., Iclnd.)'
                };
                exports$2.aust_SA = {
                    a: 6378160,
                    rf: 298.25,
                    ellipseName: 'Australian Natl & S. Amer. 1969'
                };
                exports$2.GRS67 = {
                    a: 6378160,
                    rf: 298.247167427,
                    ellipseName: 'GRS 67(IUGG 1967)'
                };
                exports$2.bessel = {
                    a: 6377397.155,
                    rf: 299.1528128,
                    ellipseName: 'Bessel 1841'
                };
                exports$2.bess_nam = {
                    a: 6377483.865,
                    rf: 299.1528128,
                    ellipseName: 'Bessel 1841 (Namibia)'
                };
                exports$2.clrk66 = {
                    a: 6378206.4,
                    b: 6356583.8,
                    ellipseName: 'Clarke 1866'
                };
                exports$2.clrk80 = {
                    a: 6378249.145,
                    rf: 293.4663,
                    ellipseName: 'Clarke 1880 mod.'
                };
                exports$2.clrk58 = {
                    a: 6378293.645208759,
                    rf: 294.2606763692654,
                    ellipseName: 'Clarke 1858'
                };
                exports$2.CPM = {
                    a: 6375738.7,
                    rf: 334.29,
                    ellipseName: 'Comm. des Poids et Mesures 1799'
                };
                exports$2.delmbr = {
                    a: 6376428,
                    rf: 311.5,
                    ellipseName: 'Delambre 1810 (Belgium)'
                };
                exports$2.engelis = {
                    a: 6378136.05,
                    rf: 298.2566,
                    ellipseName: 'Engelis 1985'
                };
                exports$2.evrst30 = {
                    a: 6377276.345,
                    rf: 300.8017,
                    ellipseName: 'Everest 1830'
                };
                exports$2.evrst48 = {
                    a: 6377304.063,
                    rf: 300.8017,
                    ellipseName: 'Everest 1948'
                };
                exports$2.evrst56 = {
                    a: 6377301.243,
                    rf: 300.8017,
                    ellipseName: 'Everest 1956'
                };
                exports$2.evrst69 = {
                    a: 6377295.664,
                    rf: 300.8017,
                    ellipseName: 'Everest 1969'
                };
                exports$2.evrstSS = {
                    a: 6377298.556,
                    rf: 300.8017,
                    ellipseName: 'Everest (Sabah & Sarawak)'
                };
                exports$2.fschr60 = {
                    a: 6378166,
                    rf: 298.3,
                    ellipseName: 'Fischer (Mercury Datum) 1960'
                };
                exports$2.fschr60m = {
                    a: 6378155,
                    rf: 298.3,
                    ellipseName: 'Fischer 1960'
                };
                exports$2.fschr68 = {
                    a: 6378150,
                    rf: 298.3,
                    ellipseName: 'Fischer 1968'
                };
                exports$2.helmert = {
                    a: 6378200,
                    rf: 298.3,
                    ellipseName: 'Helmert 1906'
                };
                exports$2.hough = {
                    a: 6378270,
                    rf: 297,
                    ellipseName: 'Hough'
                };
                exports$2.intl = {
                    a: 6378388,
                    rf: 297,
                    ellipseName: 'International 1909 (Hayford)'
                };
                exports$2.kaula = {
                    a: 6378163,
                    rf: 298.24,
                    ellipseName: 'Kaula 1961'
                };
                exports$2.lerch = {
                    a: 6378139,
                    rf: 298.257,
                    ellipseName: 'Lerch 1979'
                };
                exports$2.mprts = {
                    a: 6397300,
                    rf: 191,
                    ellipseName: 'Maupertius 1738'
                };
                exports$2.new_intl = {
                    a: 6378157.5,
                    b: 6356772.2,
                    ellipseName: 'New International 1967'
                };
                exports$2.plessis = {
                    a: 6376523,
                    rf: 6355863,
                    ellipseName: 'Plessis 1817 (France)'
                };
                exports$2.krass = {
                    a: 6378245,
                    rf: 298.3,
                    ellipseName: 'Krassovsky, 1942'
                };
                exports$2.SEasia = {
                    a: 6378155,
                    b: 6356773.3205,
                    ellipseName: 'Southeast Asia'
                };
                exports$2.walbeck = {
                    a: 6376896,
                    b: 6355834.8467,
                    ellipseName: 'Walbeck'
                };
                exports$2.WGS60 = {
                    a: 6378165,
                    rf: 298.3,
                    ellipseName: 'WGS 60'
                };
                exports$2.WGS66 = {
                    a: 6378145,
                    rf: 298.25,
                    ellipseName: 'WGS 66'
                };
                exports$2.WGS7 = {
                    a: 6378135,
                    rf: 298.26,
                    ellipseName: 'WGS 72'
                };
                var WGS84 = exports$2.WGS84 = {
                    a: 6378137,
                    rf: 298.257223563,
                    ellipseName: 'WGS 84'
                };
                exports$2.sphere = {
                    a: 6370997,
                    b: 6370997,
                    ellipseName: 'Normal Sphere (r=6370997)'
                };
                function eccentricity(a, b, rf, R_A) {
                    var a2 = a * a;
                    var b2 = b * b;
                    var es = (a2 - b2) / a2;
                    var e = 0;
                    if (R_A) {
                        a *= 1 - es * (SIXTH + es * (RA4 + es * RA6));
                        a2 = a * a;
                        es = 0;
                    } else {
                        e = Math.sqrt(es);
                    }
                    var ep2 = (a2 - b2) / b2;
                    return {
                        es: es,
                        e: e,
                        ep2: ep2
                    };
                }
                function sphere(a, b, rf, ellps, sphere) {
                    if (!a) {
                        var ellipse = match(exports$2, ellps);
                        if (!ellipse) {
                            ellipse = WGS84;
                        }
                        a = ellipse.a;
                        b = ellipse.b;
                        rf = ellipse.rf;
                    }
                    if (rf && !b) {
                        b = (1 - 1 / rf) * a;
                    }
                    if (rf === 0 || Math.abs(a - b) < EPSLN) {
                        sphere = true;
                        b = a;
                    }
                    return {
                        a: a,
                        b: b,
                        rf: rf,
                        sphere: sphere
                    };
                }
                var exports$3 = {};
                exports$3.wgs84 = {
                    towgs84: '0,0,0',
                    ellipse: 'WGS84',
                    datumName: 'WGS84'
                };
                exports$3.ch1903 = {
                    towgs84: '674.374,15.056,405.346',
                    ellipse: 'bessel',
                    datumName: 'swiss'
                };
                exports$3.ggrs87 = {
                    towgs84: '-199.87,74.79,246.62',
                    ellipse: 'GRS80',
                    datumName: 'Greek_Geodetic_Reference_System_1987'
                };
                exports$3.nad83 = {
                    towgs84: '0,0,0',
                    ellipse: 'GRS80',
                    datumName: 'North_American_Datum_1983'
                };
                exports$3.nad27 = {
                    nadgrids: '@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat',
                    ellipse: 'clrk66',
                    datumName: 'North_American_Datum_1927'
                };
                exports$3.potsdam = {
                    towgs84: '606.0,23.0,413.0',
                    ellipse: 'bessel',
                    datumName: 'Potsdam Rauenberg 1950 DHDN'
                };
                exports$3.carthage = {
                    towgs84: '-263.0,6.0,431.0',
                    ellipse: 'clark80',
                    datumName: 'Carthage 1934 Tunisia'
                };
                exports$3.hermannskogel = {
                    towgs84: '653.0,-212.0,449.0',
                    ellipse: 'bessel',
                    datumName: 'Hermannskogel'
                };
                exports$3.osni52 = {
                    towgs84: '482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15',
                    ellipse: 'airy',
                    datumName: 'Irish National'
                };
                exports$3.ire65 = {
                    towgs84: '482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15',
                    ellipse: 'mod_airy',
                    datumName: 'Ireland 1965'
                };
                exports$3.rassadiran = {
                    towgs84: '-133.63,-157.5,-158.62',
                    ellipse: 'intl',
                    datumName: 'Rassadiran'
                };
                exports$3.nzgd49 = {
                    towgs84: '59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993',
                    ellipse: 'intl',
                    datumName: 'New Zealand Geodetic Datum 1949'
                };
                exports$3.osgb36 = {
                    towgs84: '446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894',
                    ellipse: 'airy',
                    datumName: 'Airy 1830'
                };
                exports$3.s_jtsk = {
                    towgs84: '589,76,480',
                    ellipse: 'bessel',
                    datumName: 'S-JTSK (Ferro)'
                };
                exports$3.beduaram = {
                    towgs84: '-106,-87,188',
                    ellipse: 'clrk80',
                    datumName: 'Beduaram'
                };
                exports$3.gunung_segara = {
                    towgs84: '-403,684,41',
                    ellipse: 'bessel',
                    datumName: 'Gunung Segara Jakarta'
                };
                exports$3.rnb72 = {
                    towgs84: '106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1',
                    ellipse: 'intl',
                    datumName: 'Reseau National Belge 1972'
                };
                function datum(datumCode, datum_params, a, b, es, ep2) {
                    var out = {};
                    if (datumCode === undefined || datumCode === 'none') {
                        out.datum_type = PJD_NODATUM;
                    } else {
                        out.datum_type = PJD_WGS84;
                    }
                    if (datum_params) {
                        out.datum_params = datum_params.map(parseFloat);
                        if (out.datum_params[0] !== 0 || out.datum_params[1] !== 0 || out.datum_params[2] !== 0) {
                            out.datum_type = PJD_3PARAM;
                        }
                        if (out.datum_params.length > 3) {
                            if (out.datum_params[3] !== 0 || out.datum_params[4] !== 0 || out.datum_params[5] !== 0 || out.datum_params[6] !== 0) {
                                out.datum_type = PJD_7PARAM;
                                out.datum_params[3] *= SEC_TO_RAD;
                                out.datum_params[4] *= SEC_TO_RAD;
                                out.datum_params[5] *= SEC_TO_RAD;
                                out.datum_params[6] = out.datum_params[6] / 1000000 + 1;
                            }
                        }
                    }
                    out.a = a;
                    out.b = b;
                    out.es = es;
                    out.ep2 = ep2;
                    return out;
                }
                function Projection$1(srsCode, callback) {
                    if (!(this instanceof Projection$1)) {
                        return new Projection$1(srsCode);
                    }
                    callback = callback || function (error) {
                        if (error) {
                            throw error;
                        }
                    };
                    var json = parse(srsCode);
                    if (typeof json !== 'object') {
                        callback(srsCode);
                        return;
                    }
                    var ourProj = Projection$1.projections.get(json.projName);
                    if (!ourProj) {
                        callback(srsCode);
                        return;
                    }
                    if (json.datumCode && json.datumCode !== 'none') {
                        var datumDef = match(exports$3, json.datumCode);
                        if (datumDef) {
                            json.datum_params = datumDef.towgs84 ? datumDef.towgs84.split(',') : null;
                            json.ellps = datumDef.ellipse;
                            json.datumName = datumDef.datumName ? datumDef.datumName : json.datumCode;
                        }
                    }
                    json.k0 = json.k0 || 1;
                    json.axis = json.axis || 'enu';
                    json.ellps = json.ellps || 'wgs84';
                    var sphere_ = sphere(json.a, json.b, json.rf, json.ellps, json.sphere);
                    var ecc = eccentricity(sphere_.a, sphere_.b, sphere_.rf, json.R_A);
                    var datumObj = json.datum || datum(json.datumCode, json.datum_params, sphere_.a, sphere_.b, ecc.es, ecc.ep2);
                    extend(this, json);
                    extend(this, ourProj);
                    this.a = sphere_.a;
                    this.b = sphere_.b;
                    this.rf = sphere_.rf;
                    this.sphere = sphere_.sphere;
                    this.es = ecc.es;
                    this.e = ecc.e;
                    this.ep2 = ecc.ep2;
                    this.datum = datumObj;
                    this.init();
                    callback(null, this);
                }
                Projection$1.projections = projections;
                Projection$1.projections.start();
                function compareDatums(source, dest) {
                    if (source.datum_type !== dest.datum_type) {
                        return false;
                    } else if (source.a !== dest.a || Math.abs(source.es - dest.es) > 5e-11) {
                        return false;
                    } else if (source.datum_type === PJD_3PARAM) {
                        return source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2];
                    } else if (source.datum_type === PJD_7PARAM) {
                        return source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2] && source.datum_params[3] === dest.datum_params[3] && source.datum_params[4] === dest.datum_params[4] && source.datum_params[5] === dest.datum_params[5] && source.datum_params[6] === dest.datum_params[6];
                    } else {
                        return true;
                    }
                }
                function geodeticToGeocentric(p, es, a) {
                    var Longitude = p.x;
                    var Latitude = p.y;
                    var Height = p.z ? p.z : 0;
                    var Rn;
                    var Sin_Lat;
                    var Sin2_Lat;
                    var Cos_Lat;
                    if (Latitude < -HALF_PI && Latitude > -1.001 * HALF_PI) {
                        Latitude = -HALF_PI;
                    } else if (Latitude > HALF_PI && Latitude < 1.001 * HALF_PI) {
                        Latitude = HALF_PI;
                    } else if (Latitude < -HALF_PI || Latitude > HALF_PI) {
                        return null;
                    }
                    if (Longitude > Math.PI) {
                        Longitude -= 2 * Math.PI;
                    }
                    Sin_Lat = Math.sin(Latitude);
                    Cos_Lat = Math.cos(Latitude);
                    Sin2_Lat = Sin_Lat * Sin_Lat;
                    Rn = a / Math.sqrt(1 - es * Sin2_Lat);
                    return {
                        x: (Rn + Height) * Cos_Lat * Math.cos(Longitude),
                        y: (Rn + Height) * Cos_Lat * Math.sin(Longitude),
                        z: (Rn * (1 - es) + Height) * Sin_Lat
                    };
                }
                function geocentricToGeodetic(p, es, a, b) {
                    var genau = 1e-12;
                    var genau2 = genau * genau;
                    var maxiter = 30;
                    var P;
                    var RR;
                    var CT;
                    var ST;
                    var RX;
                    var RK;
                    var RN;
                    var CPHI0;
                    var SPHI0;
                    var CPHI;
                    var SPHI;
                    var SDPHI;
                    var iter;
                    var X = p.x;
                    var Y = p.y;
                    var Z = p.z ? p.z : 0;
                    var Longitude;
                    var Latitude;
                    var Height;
                    P = Math.sqrt(X * X + Y * Y);
                    RR = Math.sqrt(X * X + Y * Y + Z * Z);
                    if (P / a < genau) {
                        Longitude = 0;
                        if (RR / a < genau) {
                            Latitude = HALF_PI;
                            Height = -b;
                            return {
                                x: p.x,
                                y: p.y,
                                z: p.z
                            };
                        }
                    } else {
                        Longitude = Math.atan2(Y, X);
                    }
                    CT = Z / RR;
                    ST = P / RR;
                    RX = 1 / Math.sqrt(1 - es * (2 - es) * ST * ST);
                    CPHI0 = ST * (1 - es) * RX;
                    SPHI0 = CT * RX;
                    iter = 0;
                    do {
                        iter++;
                        RN = a / Math.sqrt(1 - es * SPHI0 * SPHI0);
                        Height = P * CPHI0 + Z * SPHI0 - RN * (1 - es * SPHI0 * SPHI0);
                        RK = es * RN / (RN + Height);
                        RX = 1 / Math.sqrt(1 - RK * (2 - RK) * ST * ST);
                        CPHI = ST * (1 - RK) * RX;
                        SPHI = CT * RX;
                        SDPHI = SPHI * CPHI0 - CPHI * SPHI0;
                        CPHI0 = CPHI;
                        SPHI0 = SPHI;
                    } while (SDPHI * SDPHI > genau2 && iter < maxiter);
                    Latitude = Math.atan(SPHI / Math.abs(CPHI));
                    return {
                        x: Longitude,
                        y: Latitude,
                        z: Height
                    };
                }
                function geocentricToWgs84(p, datum_type, datum_params) {
                    if (datum_type === PJD_3PARAM) {
                        return {
                            x: p.x + datum_params[0],
                            y: p.y + datum_params[1],
                            z: p.z + datum_params[2]
                        };
                    } else if (datum_type === PJD_7PARAM) {
                        var Dx_BF = datum_params[0];
                        var Dy_BF = datum_params[1];
                        var Dz_BF = datum_params[2];
                        var Rx_BF = datum_params[3];
                        var Ry_BF = datum_params[4];
                        var Rz_BF = datum_params[5];
                        var M_BF = datum_params[6];
                        return {
                            x: M_BF * (p.x - Rz_BF * p.y + Ry_BF * p.z) + Dx_BF,
                            y: M_BF * (Rz_BF * p.x + p.y - Rx_BF * p.z) + Dy_BF,
                            z: M_BF * (-Ry_BF * p.x + Rx_BF * p.y + p.z) + Dz_BF
                        };
                    }
                }
                function geocentricFromWgs84(p, datum_type, datum_params) {
                    if (datum_type === PJD_3PARAM) {
                        return {
                            x: p.x - datum_params[0],
                            y: p.y - datum_params[1],
                            z: p.z - datum_params[2]
                        };
                    } else if (datum_type === PJD_7PARAM) {
                        var Dx_BF = datum_params[0];
                        var Dy_BF = datum_params[1];
                        var Dz_BF = datum_params[2];
                        var Rx_BF = datum_params[3];
                        var Ry_BF = datum_params[4];
                        var Rz_BF = datum_params[5];
                        var M_BF = datum_params[6];
                        var x_tmp = (p.x - Dx_BF) / M_BF;
                        var y_tmp = (p.y - Dy_BF) / M_BF;
                        var z_tmp = (p.z - Dz_BF) / M_BF;
                        return {
                            x: x_tmp + Rz_BF * y_tmp - Ry_BF * z_tmp,
                            y: -Rz_BF * x_tmp + y_tmp + Rx_BF * z_tmp,
                            z: Ry_BF * x_tmp - Rx_BF * y_tmp + z_tmp
                        };
                    }
                }
                function checkParams(type) {
                    return type === PJD_3PARAM || type === PJD_7PARAM;
                }
                var datum_transform = function (source, dest, point) {
                    if (compareDatums(source, dest)) {
                        return point;
                    }
                    if (source.datum_type === PJD_NODATUM || dest.datum_type === PJD_NODATUM) {
                        return point;
                    }
                    if (source.es === dest.es && source.a === dest.a && !checkParams(source.datum_type) && !checkParams(dest.datum_type)) {
                        return point;
                    }
                    point = geodeticToGeocentric(point, source.es, source.a);
                    if (checkParams(source.datum_type)) {
                        point = geocentricToWgs84(point, source.datum_type, source.datum_params);
                    }
                    if (checkParams(dest.datum_type)) {
                        point = geocentricFromWgs84(point, dest.datum_type, dest.datum_params);
                    }
                    return geocentricToGeodetic(point, dest.es, dest.a, dest.b);
                };
                var adjust_axis = function (crs, denorm, point) {
                    var xin = point.x, yin = point.y, zin = point.z || 0;
                    var v, t, i;
                    var out = {};
                    for (i = 0; i < 3; i++) {
                        if (denorm && i === 2 && point.z === undefined) {
                            continue;
                        }
                        if (i === 0) {
                            v = xin;
                            t = 'x';
                        } else if (i === 1) {
                            v = yin;
                            t = 'y';
                        } else {
                            v = zin;
                            t = 'z';
                        }
                        switch (crs.axis[i]) {
                        case 'e':
                            out[t] = v;
                            break;
                        case 'w':
                            out[t] = -v;
                            break;
                        case 'n':
                            out[t] = v;
                            break;
                        case 's':
                            out[t] = -v;
                            break;
                        case 'u':
                            if (point[t] !== undefined) {
                                out.z = v;
                            }
                            break;
                        case 'd':
                            if (point[t] !== undefined) {
                                out.z = -v;
                            }
                            break;
                        default:
                            return null;
                        }
                    }
                    return out;
                };
                var toPoint = function (array) {
                    var out = {
                        x: array[0],
                        y: array[1]
                    };
                    if (array.length > 2) {
                        out.z = array[2];
                    }
                    if (array.length > 3) {
                        out.m = array[3];
                    }
                    return out;
                };
                var checkSanity = function (point) {
                    checkCoord(point.x);
                    checkCoord(point.y);
                };
                function checkCoord(num) {
                    if (typeof Number.isFinite === 'function') {
                        if (Number.isFinite(num)) {
                            return;
                        }
                        throw new TypeError('coordinates must be finite numbers');
                    }
                    if (typeof num !== 'number' || num !== num || !isFinite(num)) {
                        throw new TypeError('coordinates must be finite numbers');
                    }
                }
                function checkNotWGS(source, dest) {
                    return (source.datum.datum_type === PJD_3PARAM || source.datum.datum_type === PJD_7PARAM) && dest.datumCode !== 'WGS84' || (dest.datum.datum_type === PJD_3PARAM || dest.datum.datum_type === PJD_7PARAM) && source.datumCode !== 'WGS84';
                }
                function transform(source, dest, point) {
                    var wgs84;
                    if (Array.isArray(point)) {
                        point = toPoint(point);
                    }
                    checkSanity(point);
                    if (source.datum && dest.datum && checkNotWGS(source, dest)) {
                        wgs84 = new Projection$1('WGS84');
                        point = transform(source, wgs84, point);
                        source = wgs84;
                    }
                    if (source.axis !== 'enu') {
                        point = adjust_axis(source, false, point);
                    }
                    if (source.projName === 'longlat') {
                        point = {
                            x: point.x * D2R,
                            y: point.y * D2R
                        };
                    } else {
                        if (source.to_meter) {
                            point = {
                                x: point.x * source.to_meter,
                                y: point.y * source.to_meter
                            };
                        }
                        point = source.inverse(point);
                    }
                    if (source.from_greenwich) {
                        point.x += source.from_greenwich;
                    }
                    point = datum_transform(source.datum, dest.datum, point);
                    if (dest.from_greenwich) {
                        point = {
                            x: point.x - dest.from_greenwich,
                            y: point.y
                        };
                    }
                    if (dest.projName === 'longlat') {
                        point = {
                            x: point.x * R2D,
                            y: point.y * R2D
                        };
                    } else {
                        point = dest.forward(point);
                        if (dest.to_meter) {
                            point = {
                                x: point.x / dest.to_meter,
                                y: point.y / dest.to_meter
                            };
                        }
                    }
                    if (dest.axis !== 'enu') {
                        return adjust_axis(dest, true, point);
                    }
                    return point;
                }
                var wgs84 = Projection$1('WGS84');
                function transformer(from, to, coords) {
                    var transformedArray, out, keys;
                    if (Array.isArray(coords)) {
                        transformedArray = transform(from, to, coords);
                        if (coords.length === 3) {
                            return [
                                transformedArray.x,
                                transformedArray.y,
                                transformedArray.z
                            ];
                        } else {
                            return [
                                transformedArray.x,
                                transformedArray.y
                            ];
                        }
                    } else {
                        out = transform(from, to, coords);
                        keys = Object.keys(coords);
                        if (keys.length === 2) {
                            return out;
                        }
                        keys.forEach(function (key) {
                            if (key === 'x' || key === 'y') {
                                return;
                            }
                            out[key] = coords[key];
                        });
                        return out;
                    }
                }
                function checkProj(item) {
                    if (item instanceof Projection$1) {
                        return item;
                    }
                    if (item.oProj) {
                        return item.oProj;
                    }
                    return Projection$1(item);
                }
                function proj4$1(fromProj, toProj, coord) {
                    fromProj = checkProj(fromProj);
                    var single = false;
                    var obj;
                    if (typeof toProj === 'undefined') {
                        toProj = fromProj;
                        fromProj = wgs84;
                        single = true;
                    } else if (typeof toProj.x !== 'undefined' || Array.isArray(toProj)) {
                        coord = toProj;
                        toProj = fromProj;
                        fromProj = wgs84;
                        single = true;
                    }
                    toProj = checkProj(toProj);
                    if (coord) {
                        return transformer(fromProj, toProj, coord);
                    } else {
                        obj = {
                            forward: function (coords) {
                                return transformer(fromProj, toProj, coords);
                            },
                            inverse: function (coords) {
                                return transformer(toProj, fromProj, coords);
                            }
                        };
                        if (single) {
                            obj.oProj = toProj;
                        }
                        return obj;
                    }
                }
                var NUM_100K_SETS = 6;
                var SET_ORIGIN_COLUMN_LETTERS = 'AJSAJS';
                var SET_ORIGIN_ROW_LETTERS = 'AFAFAF';
                var A = 65;
                var I = 73;
                var O = 79;
                var V = 86;
                var Z = 90;
                var mgrs = {
                    forward: forward$1,
                    inverse: inverse$1,
                    toPoint: toPoint$1
                };
                function forward$1(ll, accuracy) {
                    accuracy = accuracy || 5;
                    return encode(LLtoUTM({
                        lat: ll[1],
                        lon: ll[0]
                    }), accuracy);
                }
                function inverse$1(mgrs) {
                    var bbox = UTMtoLL(decode(mgrs.toUpperCase()));
                    if (bbox.lat && bbox.lon) {
                        return [
                            bbox.lon,
                            bbox.lat,
                            bbox.lon,
                            bbox.lat
                        ];
                    }
                    return [
                        bbox.left,
                        bbox.bottom,
                        bbox.right,
                        bbox.top
                    ];
                }
                function toPoint$1(mgrs) {
                    var bbox = UTMtoLL(decode(mgrs.toUpperCase()));
                    if (bbox.lat && bbox.lon) {
                        return [
                            bbox.lon,
                            bbox.lat
                        ];
                    }
                    return [
                        (bbox.left + bbox.right) / 2,
                        (bbox.top + bbox.bottom) / 2
                    ];
                }
                function degToRad(deg) {
                    return deg * (Math.PI / 180);
                }
                function radToDeg(rad) {
                    return 180 * (rad / Math.PI);
                }
                function LLtoUTM(ll) {
                    var Lat = ll.lat;
                    var Long = ll.lon;
                    var a = 6378137;
                    var eccSquared = 0.00669438;
                    var k0 = 0.9996;
                    var LongOrigin;
                    var eccPrimeSquared;
                    var N, T, C, A, M;
                    var LatRad = degToRad(Lat);
                    var LongRad = degToRad(Long);
                    var LongOriginRad;
                    var ZoneNumber;
                    ZoneNumber = Math.floor((Long + 180) / 6) + 1;
                    if (Long === 180) {
                        ZoneNumber = 60;
                    }
                    if (Lat >= 56 && Lat < 64 && Long >= 3 && Long < 12) {
                        ZoneNumber = 32;
                    }
                    if (Lat >= 72 && Lat < 84) {
                        if (Long >= 0 && Long < 9) {
                            ZoneNumber = 31;
                        } else if (Long >= 9 && Long < 21) {
                            ZoneNumber = 33;
                        } else if (Long >= 21 && Long < 33) {
                            ZoneNumber = 35;
                        } else if (Long >= 33 && Long < 42) {
                            ZoneNumber = 37;
                        }
                    }
                    LongOrigin = (ZoneNumber - 1) * 6 - 180 + 3;
                    LongOriginRad = degToRad(LongOrigin);
                    eccPrimeSquared = eccSquared / (1 - eccSquared);
                    N = a / Math.sqrt(1 - eccSquared * Math.sin(LatRad) * Math.sin(LatRad));
                    T = Math.tan(LatRad) * Math.tan(LatRad);
                    C = eccPrimeSquared * Math.cos(LatRad) * Math.cos(LatRad);
                    A = Math.cos(LatRad) * (LongRad - LongOriginRad);
                    M = a * ((1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256) * LatRad - (3 * eccSquared / 8 + 3 * eccSquared * eccSquared / 32 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(2 * LatRad) + (15 * eccSquared * eccSquared / 256 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(4 * LatRad) - 35 * eccSquared * eccSquared * eccSquared / 3072 * Math.sin(6 * LatRad));
                    var UTMEasting = k0 * N * (A + (1 - T + C) * A * A * A / 6 + (5 - 18 * T + T * T + 72 * C - 58 * eccPrimeSquared) * A * A * A * A * A / 120) + 500000;
                    var UTMNorthing = k0 * (M + N * Math.tan(LatRad) * (A * A / 2 + (5 - T + 9 * C + 4 * C * C) * A * A * A * A / 24 + (61 - 58 * T + T * T + 600 * C - 330 * eccPrimeSquared) * A * A * A * A * A * A / 720));
                    if (Lat < 0) {
                        UTMNorthing += 10000000;
                    }
                    return {
                        northing: Math.round(UTMNorthing),
                        easting: Math.round(UTMEasting),
                        zoneNumber: ZoneNumber,
                        zoneLetter: getLetterDesignator(Lat)
                    };
                }
                function UTMtoLL(utm) {
                    var UTMNorthing = utm.northing;
                    var UTMEasting = utm.easting;
                    var zoneLetter = utm.zoneLetter;
                    var zoneNumber = utm.zoneNumber;
                    if (zoneNumber < 0 || zoneNumber > 60) {
                        return null;
                    }
                    var k0 = 0.9996;
                    var a = 6378137;
                    var eccSquared = 0.00669438;
                    var eccPrimeSquared;
                    var e1 = (1 - Math.sqrt(1 - eccSquared)) / (1 + Math.sqrt(1 - eccSquared));
                    var N1, T1, C1, R1, D, M;
                    var LongOrigin;
                    var mu, phi1Rad;
                    var x = UTMEasting - 500000;
                    var y = UTMNorthing;
                    if (zoneLetter < 'N') {
                        y -= 10000000;
                    }
                    LongOrigin = (zoneNumber - 1) * 6 - 180 + 3;
                    eccPrimeSquared = eccSquared / (1 - eccSquared);
                    M = y / k0;
                    mu = M / (a * (1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256));
                    phi1Rad = mu + (3 * e1 / 2 - 27 * e1 * e1 * e1 / 32) * Math.sin(2 * mu) + (21 * e1 * e1 / 16 - 55 * e1 * e1 * e1 * e1 / 32) * Math.sin(4 * mu) + 151 * e1 * e1 * e1 / 96 * Math.sin(6 * mu);
                    N1 = a / Math.sqrt(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad));
                    T1 = Math.tan(phi1Rad) * Math.tan(phi1Rad);
                    C1 = eccPrimeSquared * Math.cos(phi1Rad) * Math.cos(phi1Rad);
                    R1 = a * (1 - eccSquared) / Math.pow(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad), 1.5);
                    D = x / (N1 * k0);
                    var lat = phi1Rad - N1 * Math.tan(phi1Rad) / R1 * (D * D / 2 - (5 + 3 * T1 + 10 * C1 - 4 * C1 * C1 - 9 * eccPrimeSquared) * D * D * D * D / 24 + (61 + 90 * T1 + 298 * C1 + 45 * T1 * T1 - 252 * eccPrimeSquared - 3 * C1 * C1) * D * D * D * D * D * D / 720);
                    lat = radToDeg(lat);
                    var lon = (D - (1 + 2 * T1 + C1) * D * D * D / 6 + (5 - 2 * C1 + 28 * T1 - 3 * C1 * C1 + 8 * eccPrimeSquared + 24 * T1 * T1) * D * D * D * D * D / 120) / Math.cos(phi1Rad);
                    lon = LongOrigin + radToDeg(lon);
                    var result;
                    if (utm.accuracy) {
                        var topRight = UTMtoLL({
                            northing: utm.northing + utm.accuracy,
                            easting: utm.easting + utm.accuracy,
                            zoneLetter: utm.zoneLetter,
                            zoneNumber: utm.zoneNumber
                        });
                        result = {
                            top: topRight.lat,
                            right: topRight.lon,
                            bottom: lat,
                            left: lon
                        };
                    } else {
                        result = {
                            lat: lat,
                            lon: lon
                        };
                    }
                    return result;
                }
                function getLetterDesignator(lat) {
                    var LetterDesignator = 'Z';
                    if (84 >= lat && lat >= 72) {
                        LetterDesignator = 'X';
                    } else if (72 > lat && lat >= 64) {
                        LetterDesignator = 'W';
                    } else if (64 > lat && lat >= 56) {
                        LetterDesignator = 'V';
                    } else if (56 > lat && lat >= 48) {
                        LetterDesignator = 'U';
                    } else if (48 > lat && lat >= 40) {
                        LetterDesignator = 'T';
                    } else if (40 > lat && lat >= 32) {
                        LetterDesignator = 'S';
                    } else if (32 > lat && lat >= 24) {
                        LetterDesignator = 'R';
                    } else if (24 > lat && lat >= 16) {
                        LetterDesignator = 'Q';
                    } else if (16 > lat && lat >= 8) {
                        LetterDesignator = 'P';
                    } else if (8 > lat && lat >= 0) {
                        LetterDesignator = 'N';
                    } else if (0 > lat && lat >= -8) {
                        LetterDesignator = 'M';
                    } else if (-8 > lat && lat >= -16) {
                        LetterDesignator = 'L';
                    } else if (-16 > lat && lat >= -24) {
                        LetterDesignator = 'K';
                    } else if (-24 > lat && lat >= -32) {
                        LetterDesignator = 'J';
                    } else if (-32 > lat && lat >= -40) {
                        LetterDesignator = 'H';
                    } else if (-40 > lat && lat >= -48) {
                        LetterDesignator = 'G';
                    } else if (-48 > lat && lat >= -56) {
                        LetterDesignator = 'F';
                    } else if (-56 > lat && lat >= -64) {
                        LetterDesignator = 'E';
                    } else if (-64 > lat && lat >= -72) {
                        LetterDesignator = 'D';
                    } else if (-72 > lat && lat >= -80) {
                        LetterDesignator = 'C';
                    }
                    return LetterDesignator;
                }
                function encode(utm, accuracy) {
                    var seasting = '00000' + utm.easting, snorthing = '00000' + utm.northing;
                    return utm.zoneNumber + utm.zoneLetter + get100kID(utm.easting, utm.northing, utm.zoneNumber) + seasting.substr(seasting.length - 5, accuracy) + snorthing.substr(snorthing.length - 5, accuracy);
                }
                function get100kID(easting, northing, zoneNumber) {
                    var setParm = get100kSetForZone(zoneNumber);
                    var setColumn = Math.floor(easting / 100000);
                    var setRow = Math.floor(northing / 100000) % 20;
                    return getLetter100kID(setColumn, setRow, setParm);
                }
                function get100kSetForZone(i) {
                    var setParm = i % NUM_100K_SETS;
                    if (setParm === 0) {
                        setParm = NUM_100K_SETS;
                    }
                    return setParm;
                }
                function getLetter100kID(column, row, parm) {
                    var index = parm - 1;
                    var colOrigin = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index);
                    var rowOrigin = SET_ORIGIN_ROW_LETTERS.charCodeAt(index);
                    var colInt = colOrigin + column - 1;
                    var rowInt = rowOrigin + row;
                    var rollover = false;
                    if (colInt > Z) {
                        colInt = colInt - Z + A - 1;
                        rollover = true;
                    }
                    if (colInt === I || colOrigin < I && colInt > I || (colInt > I || colOrigin < I) && rollover) {
                        colInt++;
                    }
                    if (colInt === O || colOrigin < O && colInt > O || (colInt > O || colOrigin < O) && rollover) {
                        colInt++;
                        if (colInt === I) {
                            colInt++;
                        }
                    }
                    if (colInt > Z) {
                        colInt = colInt - Z + A - 1;
                    }
                    if (rowInt > V) {
                        rowInt = rowInt - V + A - 1;
                        rollover = true;
                    } else {
                        rollover = false;
                    }
                    if (rowInt === I || rowOrigin < I && rowInt > I || (rowInt > I || rowOrigin < I) && rollover) {
                        rowInt++;
                    }
                    if (rowInt === O || rowOrigin < O && rowInt > O || (rowInt > O || rowOrigin < O) && rollover) {
                        rowInt++;
                        if (rowInt === I) {
                            rowInt++;
                        }
                    }
                    if (rowInt > V) {
                        rowInt = rowInt - V + A - 1;
                    }
                    var twoLetter = String.fromCharCode(colInt) + String.fromCharCode(rowInt);
                    return twoLetter;
                }
                function decode(mgrsString) {
                    if (mgrsString && mgrsString.length === 0) {
                        throw 'MGRSPoint coverting from nothing';
                    }
                    var length = mgrsString.length;
                    var hunK = null;
                    var sb = '';
                    var testChar;
                    var i = 0;
                    while (!/[A-Z]/.test(testChar = mgrsString.charAt(i))) {
                        if (i >= 2) {
                            throw 'MGRSPoint bad conversion from: ' + mgrsString;
                        }
                        sb += testChar;
                        i++;
                    }
                    var zoneNumber = parseInt(sb, 10);
                    if (i === 0 || i + 3 > length) {
                        throw 'MGRSPoint bad conversion from: ' + mgrsString;
                    }
                    var zoneLetter = mgrsString.charAt(i++);
                    if (zoneLetter <= 'A' || zoneLetter === 'B' || zoneLetter === 'Y' || zoneLetter >= 'Z' || zoneLetter === 'I' || zoneLetter === 'O') {
                        throw 'MGRSPoint zone letter ' + zoneLetter + ' not handled: ' + mgrsString;
                    }
                    hunK = mgrsString.substring(i, i += 2);
                    var set = get100kSetForZone(zoneNumber);
                    var east100k = getEastingFromChar(hunK.charAt(0), set);
                    var north100k = getNorthingFromChar(hunK.charAt(1), set);
                    while (north100k < getMinNorthing(zoneLetter)) {
                        north100k += 2000000;
                    }
                    var remainder = length - i;
                    if (remainder % 2 !== 0) {
                        throw 'MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters' + mgrsString;
                    }
                    var sep = remainder / 2;
                    var sepEasting = 0;
                    var sepNorthing = 0;
                    var accuracyBonus, sepEastingString, sepNorthingString, easting, northing;
                    if (sep > 0) {
                        accuracyBonus = 100000 / Math.pow(10, sep);
                        sepEastingString = mgrsString.substring(i, i + sep);
                        sepEasting = parseFloat(sepEastingString) * accuracyBonus;
                        sepNorthingString = mgrsString.substring(i + sep);
                        sepNorthing = parseFloat(sepNorthingString) * accuracyBonus;
                    }
                    easting = sepEasting + east100k;
                    northing = sepNorthing + north100k;
                    return {
                        easting: easting,
                        northing: northing,
                        zoneLetter: zoneLetter,
                        zoneNumber: zoneNumber,
                        accuracy: accuracyBonus
                    };
                }
                function getEastingFromChar(e, set) {
                    var curCol = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set - 1);
                    var eastingValue = 100000;
                    var rewindMarker = false;
                    while (curCol !== e.charCodeAt(0)) {
                        curCol++;
                        if (curCol === I) {
                            curCol++;
                        }
                        if (curCol === O) {
                            curCol++;
                        }
                        if (curCol > Z) {
                            if (rewindMarker) {
                                throw 'Bad character: ' + e;
                            }
                            curCol = A;
                            rewindMarker = true;
                        }
                        eastingValue += 100000;
                    }
                    return eastingValue;
                }
                function getNorthingFromChar(n, set) {
                    if (n > 'V') {
                        throw 'MGRSPoint given invalid Northing ' + n;
                    }
                    var curRow = SET_ORIGIN_ROW_LETTERS.charCodeAt(set - 1);
                    var northingValue = 0;
                    var rewindMarker = false;
                    while (curRow !== n.charCodeAt(0)) {
                        curRow++;
                        if (curRow === I) {
                            curRow++;
                        }
                        if (curRow === O) {
                            curRow++;
                        }
                        if (curRow > V) {
                            if (rewindMarker) {
                                throw 'Bad character: ' + n;
                            }
                            curRow = A;
                            rewindMarker = true;
                        }
                        northingValue += 100000;
                    }
                    return northingValue;
                }
                function getMinNorthing(zoneLetter) {
                    var northing;
                    switch (zoneLetter) {
                    case 'C':
                        northing = 1100000;
                        break;
                    case 'D':
                        northing = 2000000;
                        break;
                    case 'E':
                        northing = 2800000;
                        break;
                    case 'F':
                        northing = 3700000;
                        break;
                    case 'G':
                        northing = 4600000;
                        break;
                    case 'H':
                        northing = 5500000;
                        break;
                    case 'J':
                        northing = 6400000;
                        break;
                    case 'K':
                        northing = 7300000;
                        break;
                    case 'L':
                        northing = 8200000;
                        break;
                    case 'M':
                        northing = 9100000;
                        break;
                    case 'N':
                        northing = 0;
                        break;
                    case 'P':
                        northing = 800000;
                        break;
                    case 'Q':
                        northing = 1700000;
                        break;
                    case 'R':
                        northing = 2600000;
                        break;
                    case 'S':
                        northing = 3500000;
                        break;
                    case 'T':
                        northing = 4400000;
                        break;
                    case 'U':
                        northing = 5300000;
                        break;
                    case 'V':
                        northing = 6200000;
                        break;
                    case 'W':
                        northing = 7000000;
                        break;
                    case 'X':
                        northing = 7900000;
                        break;
                    default:
                        northing = -1;
                    }
                    if (northing >= 0) {
                        return northing;
                    } else {
                        throw 'Invalid zone letter: ' + zoneLetter;
                    }
                }
                function Point(x, y, z) {
                    if (!(this instanceof Point)) {
                        return new Point(x, y, z);
                    }
                    if (Array.isArray(x)) {
                        this.x = x[0];
                        this.y = x[1];
                        this.z = x[2] || 0;
                    } else if (typeof x === 'object') {
                        this.x = x.x;
                        this.y = x.y;
                        this.z = x.z || 0;
                    } else if (typeof x === 'string' && typeof y === 'undefined') {
                        var coords = x.split(',');
                        this.x = parseFloat(coords[0], 10);
                        this.y = parseFloat(coords[1], 10);
                        this.z = parseFloat(coords[2], 10) || 0;
                    } else {
                        this.x = x;
                        this.y = y;
                        this.z = z || 0;
                    }
                    console.warn('proj4.Point will be removed in version 3, use proj4.toPoint');
                }
                Point.fromMGRS = function (mgrsStr) {
                    return new Point(toPoint$1(mgrsStr));
                };
                Point.prototype.toMGRS = function (accuracy) {
                    return forward$1([
                        this.x,
                        this.y
                    ], accuracy);
                };
                var version = '2.4.4';
                var C00 = 1;
                var C02 = 0.25;
                var C04 = 0.046875;
                var C06 = 0.01953125;
                var C08 = 0.01068115234375;
                var C22 = 0.75;
                var C44 = 0.46875;
                var C46 = 0.013020833333333334;
                var C48 = 0.007120768229166667;
                var C66 = 0.3645833333333333;
                var C68 = 0.005696614583333333;
                var C88 = 0.3076171875;
                var pj_enfn = function (es) {
                    var en = [];
                    en[0] = C00 - es * (C02 + es * (C04 + es * (C06 + es * C08)));
                    en[1] = es * (C22 - es * (C04 + es * (C06 + es * C08)));
                    var t = es * es;
                    en[2] = t * (C44 - es * (C46 + es * C48));
                    t *= es;
                    en[3] = t * (C66 - es * C68);
                    en[4] = t * es * C88;
                    return en;
                };
                var pj_mlfn = function (phi, sphi, cphi, en) {
                    cphi *= sphi;
                    sphi *= sphi;
                    return en[0] * phi - cphi * (en[1] + sphi * (en[2] + sphi * (en[3] + sphi * en[4])));
                };
                var MAX_ITER = 20;
                var pj_inv_mlfn = function (arg, es, en) {
                    var k = 1 / (1 - es);
                    var phi = arg;
                    for (var i = MAX_ITER; i; --i) {
                        var s = Math.sin(phi);
                        var t = 1 - es * s * s;
                        t = (pj_mlfn(phi, s, Math.cos(phi), en) - arg) * (t * Math.sqrt(t)) * k;
                        phi -= t;
                        if (Math.abs(t) < EPSLN) {
                            return phi;
                        }
                    }
                    return phi;
                };
                function init$2() {
                    this.x0 = this.x0 !== undefined ? this.x0 : 0;
                    this.y0 = this.y0 !== undefined ? this.y0 : 0;
                    this.long0 = this.long0 !== undefined ? this.long0 : 0;
                    this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;
                    if (this.es) {
                        this.en = pj_enfn(this.es);
                        this.ml0 = pj_mlfn(this.lat0, Math.sin(this.lat0), Math.cos(this.lat0), this.en);
                    }
                }
                function forward$2(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var delta_lon = adjust_lon(lon - this.long0);
                    var con;
                    var x, y;
                    var sin_phi = Math.sin(lat);
                    var cos_phi = Math.cos(lat);
                    if (!this.es) {
                        var b = cos_phi * Math.sin(delta_lon);
                        if (Math.abs(Math.abs(b) - 1) < EPSLN) {
                            return 93;
                        } else {
                            x = 0.5 * this.a * this.k0 * Math.log((1 + b) / (1 - b)) + this.x0;
                            y = cos_phi * Math.cos(delta_lon) / Math.sqrt(1 - Math.pow(b, 2));
                            b = Math.abs(y);
                            if (b >= 1) {
                                if (b - 1 > EPSLN) {
                                    return 93;
                                } else {
                                    y = 0;
                                }
                            } else {
                                y = Math.acos(y);
                            }
                            if (lat < 0) {
                                y = -y;
                            }
                            y = this.a * this.k0 * (y - this.lat0) + this.y0;
                        }
                    } else {
                        var al = cos_phi * delta_lon;
                        var als = Math.pow(al, 2);
                        var c = this.ep2 * Math.pow(cos_phi, 2);
                        var cs = Math.pow(c, 2);
                        var tq = Math.abs(cos_phi) > EPSLN ? Math.tan(lat) : 0;
                        var t = Math.pow(tq, 2);
                        var ts = Math.pow(t, 2);
                        con = 1 - this.es * Math.pow(sin_phi, 2);
                        al = al / Math.sqrt(con);
                        var ml = pj_mlfn(lat, sin_phi, cos_phi, this.en);
                        x = this.a * (this.k0 * al * (1 + als / 6 * (1 - t + c + als / 20 * (5 - 18 * t + ts + 14 * c - 58 * t * c + als / 42 * (61 + 179 * ts - ts * t - 479 * t))))) + this.x0;
                        y = this.a * (this.k0 * (ml - this.ml0 + sin_phi * delta_lon * al / 2 * (1 + als / 12 * (5 - t + 9 * c + 4 * cs + als / 30 * (61 + ts - 58 * t + 270 * c - 330 * t * c + als / 56 * (1385 + 543 * ts - ts * t - 3111 * t)))))) + this.y0;
                    }
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$2(p) {
                    var con, phi;
                    var lat, lon;
                    var x = (p.x - this.x0) * (1 / this.a);
                    var y = (p.y - this.y0) * (1 / this.a);
                    if (!this.es) {
                        var f = Math.exp(x / this.k0);
                        var g = 0.5 * (f - 1 / f);
                        var temp = this.lat0 + y / this.k0;
                        var h = Math.cos(temp);
                        con = Math.sqrt((1 - Math.pow(h, 2)) / (1 + Math.pow(g, 2)));
                        lat = Math.asin(con);
                        if (y < 0) {
                            lat = -lat;
                        }
                        if (g === 0 && h === 0) {
                            lon = 0;
                        } else {
                            lon = adjust_lon(Math.atan2(g, h) + this.long0);
                        }
                    } else {
                        con = this.ml0 + y / this.k0;
                        phi = pj_inv_mlfn(con, this.es, this.en);
                        if (Math.abs(phi) < HALF_PI) {
                            var sin_phi = Math.sin(phi);
                            var cos_phi = Math.cos(phi);
                            var tan_phi = Math.abs(cos_phi) > EPSLN ? Math.tan(phi) : 0;
                            var c = this.ep2 * Math.pow(cos_phi, 2);
                            var cs = Math.pow(c, 2);
                            var t = Math.pow(tan_phi, 2);
                            var ts = Math.pow(t, 2);
                            con = 1 - this.es * Math.pow(sin_phi, 2);
                            var d = x * Math.sqrt(con) / this.k0;
                            var ds = Math.pow(d, 2);
                            con = con * tan_phi;
                            lat = phi - con * ds / (1 - this.es) * 0.5 * (1 - ds / 12 * (5 + 3 * t - 9 * c * t + c - 4 * cs - ds / 30 * (61 + 90 * t - 252 * c * t + 45 * ts + 46 * c - ds / 56 * (1385 + 3633 * t + 4095 * ts + 1574 * ts * t))));
                            lon = adjust_lon(this.long0 + d * (1 - ds / 6 * (1 + 2 * t + c - ds / 20 * (5 + 28 * t + 24 * ts + 8 * c * t + 6 * c - ds / 42 * (61 + 662 * t + 1320 * ts + 720 * ts * t)))) / cos_phi);
                        } else {
                            lat = HALF_PI * sign(y);
                            lon = 0;
                        }
                    }
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$3 = [
                    'Transverse_Mercator',
                    'Transverse Mercator',
                    'tmerc'
                ];
                var tmerc = {
                    init: init$2,
                    forward: forward$2,
                    inverse: inverse$2,
                    names: names$3
                };
                var sinh = function (x) {
                    var r = Math.exp(x);
                    r = (r - 1 / r) / 2;
                    return r;
                };
                var hypot = function (x, y) {
                    x = Math.abs(x);
                    y = Math.abs(y);
                    var a = Math.max(x, y);
                    var b = Math.min(x, y) / (a ? a : 1);
                    return a * Math.sqrt(1 + Math.pow(b, 2));
                };
                var log1py = function (x) {
                    var y = 1 + x;
                    var z = y - 1;
                    return z === 0 ? x : x * Math.log(y) / z;
                };
                var asinhy = function (x) {
                    var y = Math.abs(x);
                    y = log1py(y * (1 + y / (hypot(1, y) + 1)));
                    return x < 0 ? -y : y;
                };
                var gatg = function (pp, B) {
                    var cos_2B = 2 * Math.cos(2 * B);
                    var i = pp.length - 1;
                    var h1 = pp[i];
                    var h2 = 0;
                    var h;
                    while (--i >= 0) {
                        h = -h2 + cos_2B * h1 + pp[i];
                        h2 = h1;
                        h1 = h;
                    }
                    return B + h * Math.sin(2 * B);
                };
                var clens = function (pp, arg_r) {
                    var r = 2 * Math.cos(arg_r);
                    var i = pp.length - 1;
                    var hr1 = pp[i];
                    var hr2 = 0;
                    var hr;
                    while (--i >= 0) {
                        hr = -hr2 + r * hr1 + pp[i];
                        hr2 = hr1;
                        hr1 = hr;
                    }
                    return Math.sin(arg_r) * hr;
                };
                var cosh = function (x) {
                    var r = Math.exp(x);
                    r = (r + 1 / r) / 2;
                    return r;
                };
                var clens_cmplx = function (pp, arg_r, arg_i) {
                    var sin_arg_r = Math.sin(arg_r);
                    var cos_arg_r = Math.cos(arg_r);
                    var sinh_arg_i = sinh(arg_i);
                    var cosh_arg_i = cosh(arg_i);
                    var r = 2 * cos_arg_r * cosh_arg_i;
                    var i = -2 * sin_arg_r * sinh_arg_i;
                    var j = pp.length - 1;
                    var hr = pp[j];
                    var hi1 = 0;
                    var hr1 = 0;
                    var hi = 0;
                    var hr2;
                    var hi2;
                    while (--j >= 0) {
                        hr2 = hr1;
                        hi2 = hi1;
                        hr1 = hr;
                        hi1 = hi;
                        hr = -hr2 + r * hr1 - i * hi1 + pp[j];
                        hi = -hi2 + i * hr1 + r * hi1;
                    }
                    r = sin_arg_r * cosh_arg_i;
                    i = cos_arg_r * sinh_arg_i;
                    return [
                        r * hr - i * hi,
                        r * hi + i * hr
                    ];
                };
                function init$3() {
                    if (this.es === undefined || this.es <= 0) {
                        throw new Error('incorrect elliptical usage');
                    }
                    this.x0 = this.x0 !== undefined ? this.x0 : 0;
                    this.y0 = this.y0 !== undefined ? this.y0 : 0;
                    this.long0 = this.long0 !== undefined ? this.long0 : 0;
                    this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;
                    this.cgb = [];
                    this.cbg = [];
                    this.utg = [];
                    this.gtu = [];
                    var f = this.es / (1 + Math.sqrt(1 - this.es));
                    var n = f / (2 - f);
                    var np = n;
                    this.cgb[0] = n * (2 + n * (-2 / 3 + n * (-2 + n * (116 / 45 + n * (26 / 45 + n * (-2854 / 675))))));
                    this.cbg[0] = n * (-2 + n * (2 / 3 + n * (4 / 3 + n * (-82 / 45 + n * (32 / 45 + n * (4642 / 4725))))));
                    np = np * n;
                    this.cgb[1] = np * (7 / 3 + n * (-8 / 5 + n * (-227 / 45 + n * (2704 / 315 + n * (2323 / 945)))));
                    this.cbg[1] = np * (5 / 3 + n * (-16 / 15 + n * (-13 / 9 + n * (904 / 315 + n * (-1522 / 945)))));
                    np = np * n;
                    this.cgb[2] = np * (56 / 15 + n * (-136 / 35 + n * (-1262 / 105 + n * (73814 / 2835))));
                    this.cbg[2] = np * (-26 / 15 + n * (34 / 21 + n * (8 / 5 + n * (-12686 / 2835))));
                    np = np * n;
                    this.cgb[3] = np * (4279 / 630 + n * (-332 / 35 + n * (-399572 / 14175)));
                    this.cbg[3] = np * (1237 / 630 + n * (-12 / 5 + n * (-24832 / 14175)));
                    np = np * n;
                    this.cgb[4] = np * (4174 / 315 + n * (-144838 / 6237));
                    this.cbg[4] = np * (-734 / 315 + n * (109598 / 31185));
                    np = np * n;
                    this.cgb[5] = np * (601676 / 22275);
                    this.cbg[5] = np * (444337 / 155925);
                    np = Math.pow(n, 2);
                    this.Qn = this.k0 / (1 + n) * (1 + np * (1 / 4 + np * (1 / 64 + np / 256)));
                    this.utg[0] = n * (-0.5 + n * (2 / 3 + n * (-37 / 96 + n * (1 / 360 + n * (81 / 512 + n * (-96199 / 604800))))));
                    this.gtu[0] = n * (0.5 + n * (-2 / 3 + n * (5 / 16 + n * (41 / 180 + n * (-127 / 288 + n * (7891 / 37800))))));
                    this.utg[1] = np * (-1 / 48 + n * (-1 / 15 + n * (437 / 1440 + n * (-46 / 105 + n * (1118711 / 3870720)))));
                    this.gtu[1] = np * (13 / 48 + n * (-3 / 5 + n * (557 / 1440 + n * (281 / 630 + n * (-1983433 / 1935360)))));
                    np = np * n;
                    this.utg[2] = np * (-17 / 480 + n * (37 / 840 + n * (209 / 4480 + n * (-5569 / 90720))));
                    this.gtu[2] = np * (61 / 240 + n * (-103 / 140 + n * (15061 / 26880 + n * (167603 / 181440))));
                    np = np * n;
                    this.utg[3] = np * (-4397 / 161280 + n * (11 / 504 + n * (830251 / 7257600)));
                    this.gtu[3] = np * (49561 / 161280 + n * (-179 / 168 + n * (6601661 / 7257600)));
                    np = np * n;
                    this.utg[4] = np * (-4583 / 161280 + n * (108847 / 3991680));
                    this.gtu[4] = np * (34729 / 80640 + n * (-3418889 / 1995840));
                    np = np * n;
                    this.utg[5] = np * (-20648693 / 638668800);
                    this.gtu[5] = np * (212378941 / 319334400);
                    var Z = gatg(this.cbg, this.lat0);
                    this.Zb = -this.Qn * (Z + clens(this.gtu, 2 * Z));
                }
                function forward$3(p) {
                    var Ce = adjust_lon(p.x - this.long0);
                    var Cn = p.y;
                    Cn = gatg(this.cbg, Cn);
                    var sin_Cn = Math.sin(Cn);
                    var cos_Cn = Math.cos(Cn);
                    var sin_Ce = Math.sin(Ce);
                    var cos_Ce = Math.cos(Ce);
                    Cn = Math.atan2(sin_Cn, cos_Ce * cos_Cn);
                    Ce = Math.atan2(sin_Ce * cos_Cn, hypot(sin_Cn, cos_Cn * cos_Ce));
                    Ce = asinhy(Math.tan(Ce));
                    var tmp = clens_cmplx(this.gtu, 2 * Cn, 2 * Ce);
                    Cn = Cn + tmp[0];
                    Ce = Ce + tmp[1];
                    var x;
                    var y;
                    if (Math.abs(Ce) <= 2.623395162778) {
                        x = this.a * (this.Qn * Ce) + this.x0;
                        y = this.a * (this.Qn * Cn + this.Zb) + this.y0;
                    } else {
                        x = Infinity;
                        y = Infinity;
                    }
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$3(p) {
                    var Ce = (p.x - this.x0) * (1 / this.a);
                    var Cn = (p.y - this.y0) * (1 / this.a);
                    Cn = (Cn - this.Zb) / this.Qn;
                    Ce = Ce / this.Qn;
                    var lon;
                    var lat;
                    if (Math.abs(Ce) <= 2.623395162778) {
                        var tmp = clens_cmplx(this.utg, 2 * Cn, 2 * Ce);
                        Cn = Cn + tmp[0];
                        Ce = Ce + tmp[1];
                        Ce = Math.atan(sinh(Ce));
                        var sin_Cn = Math.sin(Cn);
                        var cos_Cn = Math.cos(Cn);
                        var sin_Ce = Math.sin(Ce);
                        var cos_Ce = Math.cos(Ce);
                        Cn = Math.atan2(sin_Cn * cos_Ce, hypot(sin_Ce, cos_Ce * cos_Cn));
                        Ce = Math.atan2(sin_Ce, cos_Ce * cos_Cn);
                        lon = adjust_lon(Ce + this.long0);
                        lat = gatg(this.cgb, Cn);
                    } else {
                        lon = Infinity;
                        lat = Infinity;
                    }
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$4 = [
                    'Extended_Transverse_Mercator',
                    'Extended Transverse Mercator',
                    'etmerc'
                ];
                var etmerc = {
                    init: init$3,
                    forward: forward$3,
                    inverse: inverse$3,
                    names: names$4
                };
                var adjust_zone = function (zone, lon) {
                    if (zone === undefined) {
                        zone = Math.floor((adjust_lon(lon) + Math.PI) * 30 / Math.PI) + 1;
                        if (zone < 0) {
                            return 0;
                        } else if (zone > 60) {
                            return 60;
                        }
                    }
                    return zone;
                };
                var dependsOn = 'etmerc';
                function init$4() {
                    var zone = adjust_zone(this.zone, this.long0);
                    if (zone === undefined) {
                        throw new Error('unknown utm zone');
                    }
                    this.lat0 = 0;
                    this.long0 = (6 * Math.abs(zone) - 183) * D2R;
                    this.x0 = 500000;
                    this.y0 = this.utmSouth ? 10000000 : 0;
                    this.k0 = 0.9996;
                    etmerc.init.apply(this);
                    this.forward = etmerc.forward;
                    this.inverse = etmerc.inverse;
                }
                var names$5 = [
                    'Universal Transverse Mercator System',
                    'utm'
                ];
                var utm = {
                    init: init$4,
                    names: names$5,
                    dependsOn: dependsOn
                };
                var srat = function (esinp, exp) {
                    return Math.pow((1 - esinp) / (1 + esinp), exp);
                };
                var MAX_ITER$1 = 20;
                function init$6() {
                    var sphi = Math.sin(this.lat0);
                    var cphi = Math.cos(this.lat0);
                    cphi *= cphi;
                    this.rc = Math.sqrt(1 - this.es) / (1 - this.es * sphi * sphi);
                    this.C = Math.sqrt(1 + this.es * cphi * cphi / (1 - this.es));
                    this.phic0 = Math.asin(sphi / this.C);
                    this.ratexp = 0.5 * this.C * this.e;
                    this.K = Math.tan(0.5 * this.phic0 + FORTPI) / (Math.pow(Math.tan(0.5 * this.lat0 + FORTPI), this.C) * srat(this.e * sphi, this.ratexp));
                }
                function forward$5(p) {
                    var lon = p.x;
                    var lat = p.y;
                    p.y = 2 * Math.atan(this.K * Math.pow(Math.tan(0.5 * lat + FORTPI), this.C) * srat(this.e * Math.sin(lat), this.ratexp)) - HALF_PI;
                    p.x = this.C * lon;
                    return p;
                }
                function inverse$5(p) {
                    var DEL_TOL = 1e-14;
                    var lon = p.x / this.C;
                    var lat = p.y;
                    var num = Math.pow(Math.tan(0.5 * lat + FORTPI) / this.K, 1 / this.C);
                    for (var i = MAX_ITER$1; i > 0; --i) {
                        lat = 2 * Math.atan(num * srat(this.e * Math.sin(p.y), -0.5 * this.e)) - HALF_PI;
                        if (Math.abs(lat - p.y) < DEL_TOL) {
                            break;
                        }
                        p.y = lat;
                    }
                    if (!i) {
                        return null;
                    }
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$7 = ['gauss'];
                var gauss = {
                    init: init$6,
                    forward: forward$5,
                    inverse: inverse$5,
                    names: names$7
                };
                function init$5() {
                    gauss.init.apply(this);
                    if (!this.rc) {
                        return;
                    }
                    this.sinc0 = Math.sin(this.phic0);
                    this.cosc0 = Math.cos(this.phic0);
                    this.R2 = 2 * this.rc;
                    if (!this.title) {
                        this.title = 'Oblique Stereographic Alternative';
                    }
                }
                function forward$4(p) {
                    var sinc, cosc, cosl, k;
                    p.x = adjust_lon(p.x - this.long0);
                    gauss.forward.apply(this, [p]);
                    sinc = Math.sin(p.y);
                    cosc = Math.cos(p.y);
                    cosl = Math.cos(p.x);
                    k = this.k0 * this.R2 / (1 + this.sinc0 * sinc + this.cosc0 * cosc * cosl);
                    p.x = k * cosc * Math.sin(p.x);
                    p.y = k * (this.cosc0 * sinc - this.sinc0 * cosc * cosl);
                    p.x = this.a * p.x + this.x0;
                    p.y = this.a * p.y + this.y0;
                    return p;
                }
                function inverse$4(p) {
                    var sinc, cosc, lon, lat, rho;
                    p.x = (p.x - this.x0) / this.a;
                    p.y = (p.y - this.y0) / this.a;
                    p.x /= this.k0;
                    p.y /= this.k0;
                    if (rho = Math.sqrt(p.x * p.x + p.y * p.y)) {
                        var c = 2 * Math.atan2(rho, this.R2);
                        sinc = Math.sin(c);
                        cosc = Math.cos(c);
                        lat = Math.asin(cosc * this.sinc0 + p.y * sinc * this.cosc0 / rho);
                        lon = Math.atan2(p.x * sinc, rho * this.cosc0 * cosc - p.y * this.sinc0 * sinc);
                    } else {
                        lat = this.phic0;
                        lon = 0;
                    }
                    p.x = lon;
                    p.y = lat;
                    gauss.inverse.apply(this, [p]);
                    p.x = adjust_lon(p.x + this.long0);
                    return p;
                }
                var names$6 = [
                    'Stereographic_North_Pole',
                    'Oblique_Stereographic',
                    'Polar_Stereographic',
                    'sterea',
                    'Oblique Stereographic Alternative'
                ];
                var sterea = {
                    init: init$5,
                    forward: forward$4,
                    inverse: inverse$4,
                    names: names$6
                };
                function ssfn_(phit, sinphi, eccen) {
                    sinphi *= eccen;
                    return Math.tan(0.5 * (HALF_PI + phit)) * Math.pow((1 - sinphi) / (1 + sinphi), 0.5 * eccen);
                }
                function init$7() {
                    this.coslat0 = Math.cos(this.lat0);
                    this.sinlat0 = Math.sin(this.lat0);
                    if (this.sphere) {
                        if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {
                            this.k0 = 0.5 * (1 + sign(this.lat0) * Math.sin(this.lat_ts));
                        }
                    } else {
                        if (Math.abs(this.coslat0) <= EPSLN) {
                            if (this.lat0 > 0) {
                                this.con = 1;
                            } else {
                                this.con = -1;
                            }
                        }
                        this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e));
                        if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {
                            this.k0 = 0.5 * this.cons * msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / tsfnz(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts));
                        }
                        this.ms1 = msfnz(this.e, this.sinlat0, this.coslat0);
                        this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - HALF_PI;
                        this.cosX0 = Math.cos(this.X0);
                        this.sinX0 = Math.sin(this.X0);
                    }
                }
                function forward$6(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var sinlat = Math.sin(lat);
                    var coslat = Math.cos(lat);
                    var A, X, sinX, cosX, ts, rh;
                    var dlon = adjust_lon(lon - this.long0);
                    if (Math.abs(Math.abs(lon - this.long0) - Math.PI) <= EPSLN && Math.abs(lat + this.lat0) <= EPSLN) {
                        p.x = NaN;
                        p.y = NaN;
                        return p;
                    }
                    if (this.sphere) {
                        A = 2 * this.k0 / (1 + this.sinlat0 * sinlat + this.coslat0 * coslat * Math.cos(dlon));
                        p.x = this.a * A * coslat * Math.sin(dlon) + this.x0;
                        p.y = this.a * A * (this.coslat0 * sinlat - this.sinlat0 * coslat * Math.cos(dlon)) + this.y0;
                        return p;
                    } else {
                        X = 2 * Math.atan(this.ssfn_(lat, sinlat, this.e)) - HALF_PI;
                        cosX = Math.cos(X);
                        sinX = Math.sin(X);
                        if (Math.abs(this.coslat0) <= EPSLN) {
                            ts = tsfnz(this.e, lat * this.con, this.con * sinlat);
                            rh = 2 * this.a * this.k0 * ts / this.cons;
                            p.x = this.x0 + rh * Math.sin(lon - this.long0);
                            p.y = this.y0 - this.con * rh * Math.cos(lon - this.long0);
                            return p;
                        } else if (Math.abs(this.sinlat0) < EPSLN) {
                            A = 2 * this.a * this.k0 / (1 + cosX * Math.cos(dlon));
                            p.y = A * sinX;
                        } else {
                            A = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * sinX + this.cosX0 * cosX * Math.cos(dlon)));
                            p.y = A * (this.cosX0 * sinX - this.sinX0 * cosX * Math.cos(dlon)) + this.y0;
                        }
                        p.x = A * cosX * Math.sin(dlon) + this.x0;
                    }
                    return p;
                }
                function inverse$6(p) {
                    p.x -= this.x0;
                    p.y -= this.y0;
                    var lon, lat, ts, ce, Chi;
                    var rh = Math.sqrt(p.x * p.x + p.y * p.y);
                    if (this.sphere) {
                        var c = 2 * Math.atan(rh / (0.5 * this.a * this.k0));
                        lon = this.long0;
                        lat = this.lat0;
                        if (rh <= EPSLN) {
                            p.x = lon;
                            p.y = lat;
                            return p;
                        }
                        lat = Math.asin(Math.cos(c) * this.sinlat0 + p.y * Math.sin(c) * this.coslat0 / rh);
                        if (Math.abs(this.coslat0) < EPSLN) {
                            if (this.lat0 > 0) {
                                lon = adjust_lon(this.long0 + Math.atan2(p.x, -1 * p.y));
                            } else {
                                lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));
                            }
                        } else {
                            lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(c), rh * this.coslat0 * Math.cos(c) - p.y * this.sinlat0 * Math.sin(c)));
                        }
                        p.x = lon;
                        p.y = lat;
                        return p;
                    } else {
                        if (Math.abs(this.coslat0) <= EPSLN) {
                            if (rh <= EPSLN) {
                                lat = this.lat0;
                                lon = this.long0;
                                p.x = lon;
                                p.y = lat;
                                return p;
                            }
                            p.x *= this.con;
                            p.y *= this.con;
                            ts = rh * this.cons / (2 * this.a * this.k0);
                            lat = this.con * phi2z(this.e, ts);
                            lon = this.con * adjust_lon(this.con * this.long0 + Math.atan2(p.x, -1 * p.y));
                        } else {
                            ce = 2 * Math.atan(rh * this.cosX0 / (2 * this.a * this.k0 * this.ms1));
                            lon = this.long0;
                            if (rh <= EPSLN) {
                                Chi = this.X0;
                            } else {
                                Chi = Math.asin(Math.cos(ce) * this.sinX0 + p.y * Math.sin(ce) * this.cosX0 / rh);
                                lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(ce), rh * this.cosX0 * Math.cos(ce) - p.y * this.sinX0 * Math.sin(ce)));
                            }
                            lat = -1 * phi2z(this.e, Math.tan(0.5 * (HALF_PI + Chi)));
                        }
                    }
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$8 = [
                    'stere',
                    'Stereographic_South_Pole',
                    'Polar Stereographic (variant B)'
                ];
                var stere = {
                    init: init$7,
                    forward: forward$6,
                    inverse: inverse$6,
                    names: names$8,
                    ssfn_: ssfn_
                };
                function init$8() {
                    var phy0 = this.lat0;
                    this.lambda0 = this.long0;
                    var sinPhy0 = Math.sin(phy0);
                    var semiMajorAxis = this.a;
                    var invF = this.rf;
                    var flattening = 1 / invF;
                    var e2 = 2 * flattening - Math.pow(flattening, 2);
                    var e = this.e = Math.sqrt(e2);
                    this.R = this.k0 * semiMajorAxis * Math.sqrt(1 - e2) / (1 - e2 * Math.pow(sinPhy0, 2));
                    this.alpha = Math.sqrt(1 + e2 / (1 - e2) * Math.pow(Math.cos(phy0), 4));
                    this.b0 = Math.asin(sinPhy0 / this.alpha);
                    var k1 = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2));
                    var k2 = Math.log(Math.tan(Math.PI / 4 + phy0 / 2));
                    var k3 = Math.log((1 + e * sinPhy0) / (1 - e * sinPhy0));
                    this.K = k1 - this.alpha * k2 + this.alpha * e / 2 * k3;
                }
                function forward$7(p) {
                    var Sa1 = Math.log(Math.tan(Math.PI / 4 - p.y / 2));
                    var Sa2 = this.e / 2 * Math.log((1 + this.e * Math.sin(p.y)) / (1 - this.e * Math.sin(p.y)));
                    var S = -this.alpha * (Sa1 + Sa2) + this.K;
                    var b = 2 * (Math.atan(Math.exp(S)) - Math.PI / 4);
                    var I = this.alpha * (p.x - this.lambda0);
                    var rotI = Math.atan(Math.sin(I) / (Math.sin(this.b0) * Math.tan(b) + Math.cos(this.b0) * Math.cos(I)));
                    var rotB = Math.asin(Math.cos(this.b0) * Math.sin(b) - Math.sin(this.b0) * Math.cos(b) * Math.cos(I));
                    p.y = this.R / 2 * Math.log((1 + Math.sin(rotB)) / (1 - Math.sin(rotB))) + this.y0;
                    p.x = this.R * rotI + this.x0;
                    return p;
                }
                function inverse$7(p) {
                    var Y = p.x - this.x0;
                    var X = p.y - this.y0;
                    var rotI = Y / this.R;
                    var rotB = 2 * (Math.atan(Math.exp(X / this.R)) - Math.PI / 4);
                    var b = Math.asin(Math.cos(this.b0) * Math.sin(rotB) + Math.sin(this.b0) * Math.cos(rotB) * Math.cos(rotI));
                    var I = Math.atan(Math.sin(rotI) / (Math.cos(this.b0) * Math.cos(rotI) - Math.sin(this.b0) * Math.tan(rotB)));
                    var lambda = this.lambda0 + I / this.alpha;
                    var S = 0;
                    var phy = b;
                    var prevPhy = -1000;
                    var iteration = 0;
                    while (Math.abs(phy - prevPhy) > 1e-7) {
                        if (++iteration > 20) {
                            return;
                        }
                        S = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + b / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(phy)) / 2));
                        prevPhy = phy;
                        phy = 2 * Math.atan(Math.exp(S)) - Math.PI / 2;
                    }
                    p.x = lambda;
                    p.y = phy;
                    return p;
                }
                var names$9 = ['somerc'];
                var somerc = {
                    init: init$8,
                    forward: forward$7,
                    inverse: inverse$7,
                    names: names$9
                };
                function init$9() {
                    this.no_off = this.no_off || false;
                    this.no_rot = this.no_rot || false;
                    if (isNaN(this.k0)) {
                        this.k0 = 1;
                    }
                    var sinlat = Math.sin(this.lat0);
                    var coslat = Math.cos(this.lat0);
                    var con = this.e * sinlat;
                    this.bl = Math.sqrt(1 + this.es / (1 - this.es) * Math.pow(coslat, 4));
                    this.al = this.a * this.bl * this.k0 * Math.sqrt(1 - this.es) / (1 - con * con);
                    var t0 = tsfnz(this.e, this.lat0, sinlat);
                    var dl = this.bl / coslat * Math.sqrt((1 - this.es) / (1 - con * con));
                    if (dl * dl < 1) {
                        dl = 1;
                    }
                    var fl;
                    var gl;
                    if (!isNaN(this.longc)) {
                        if (this.lat0 >= 0) {
                            fl = dl + Math.sqrt(dl * dl - 1);
                        } else {
                            fl = dl - Math.sqrt(dl * dl - 1);
                        }
                        this.el = fl * Math.pow(t0, this.bl);
                        gl = 0.5 * (fl - 1 / fl);
                        this.gamma0 = Math.asin(Math.sin(this.alpha) / dl);
                        this.long0 = this.longc - Math.asin(gl * Math.tan(this.gamma0)) / this.bl;
                    } else {
                        var t1 = tsfnz(this.e, this.lat1, Math.sin(this.lat1));
                        var t2 = tsfnz(this.e, this.lat2, Math.sin(this.lat2));
                        if (this.lat0 >= 0) {
                            this.el = (dl + Math.sqrt(dl * dl - 1)) * Math.pow(t0, this.bl);
                        } else {
                            this.el = (dl - Math.sqrt(dl * dl - 1)) * Math.pow(t0, this.bl);
                        }
                        var hl = Math.pow(t1, this.bl);
                        var ll = Math.pow(t2, this.bl);
                        fl = this.el / hl;
                        gl = 0.5 * (fl - 1 / fl);
                        var jl = (this.el * this.el - ll * hl) / (this.el * this.el + ll * hl);
                        var pl = (ll - hl) / (ll + hl);
                        var dlon12 = adjust_lon(this.long1 - this.long2);
                        this.long0 = 0.5 * (this.long1 + this.long2) - Math.atan(jl * Math.tan(0.5 * this.bl * dlon12) / pl) / this.bl;
                        this.long0 = adjust_lon(this.long0);
                        var dlon10 = adjust_lon(this.long1 - this.long0);
                        this.gamma0 = Math.atan(Math.sin(this.bl * dlon10) / gl);
                        this.alpha = Math.asin(dl * Math.sin(this.gamma0));
                    }
                    if (this.no_off) {
                        this.uc = 0;
                    } else {
                        if (this.lat0 >= 0) {
                            this.uc = this.al / this.bl * Math.atan2(Math.sqrt(dl * dl - 1), Math.cos(this.alpha));
                        } else {
                            this.uc = -1 * this.al / this.bl * Math.atan2(Math.sqrt(dl * dl - 1), Math.cos(this.alpha));
                        }
                    }
                }
                function forward$8(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var dlon = adjust_lon(lon - this.long0);
                    var us, vs;
                    var con;
                    if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {
                        if (lat > 0) {
                            con = -1;
                        } else {
                            con = 1;
                        }
                        vs = this.al / this.bl * Math.log(Math.tan(FORTPI + con * this.gamma0 * 0.5));
                        us = -1 * con * HALF_PI * this.al / this.bl;
                    } else {
                        var t = tsfnz(this.e, lat, Math.sin(lat));
                        var ql = this.el / Math.pow(t, this.bl);
                        var sl = 0.5 * (ql - 1 / ql);
                        var tl = 0.5 * (ql + 1 / ql);
                        var vl = Math.sin(this.bl * dlon);
                        var ul = (sl * Math.sin(this.gamma0) - vl * Math.cos(this.gamma0)) / tl;
                        if (Math.abs(Math.abs(ul) - 1) <= EPSLN) {
                            vs = Number.POSITIVE_INFINITY;
                        } else {
                            vs = 0.5 * this.al * Math.log((1 - ul) / (1 + ul)) / this.bl;
                        }
                        if (Math.abs(Math.cos(this.bl * dlon)) <= EPSLN) {
                            us = this.al * this.bl * dlon;
                        } else {
                            us = this.al * Math.atan2(sl * Math.cos(this.gamma0) + vl * Math.sin(this.gamma0), Math.cos(this.bl * dlon)) / this.bl;
                        }
                    }
                    if (this.no_rot) {
                        p.x = this.x0 + us;
                        p.y = this.y0 + vs;
                    } else {
                        us -= this.uc;
                        p.x = this.x0 + vs * Math.cos(this.alpha) + us * Math.sin(this.alpha);
                        p.y = this.y0 + us * Math.cos(this.alpha) - vs * Math.sin(this.alpha);
                    }
                    return p;
                }
                function inverse$8(p) {
                    var us, vs;
                    if (this.no_rot) {
                        vs = p.y - this.y0;
                        us = p.x - this.x0;
                    } else {
                        vs = (p.x - this.x0) * Math.cos(this.alpha) - (p.y - this.y0) * Math.sin(this.alpha);
                        us = (p.y - this.y0) * Math.cos(this.alpha) + (p.x - this.x0) * Math.sin(this.alpha);
                        us += this.uc;
                    }
                    var qp = Math.exp(-1 * this.bl * vs / this.al);
                    var sp = 0.5 * (qp - 1 / qp);
                    var tp = 0.5 * (qp + 1 / qp);
                    var vp = Math.sin(this.bl * us / this.al);
                    var up = (vp * Math.cos(this.gamma0) + sp * Math.sin(this.gamma0)) / tp;
                    var ts = Math.pow(this.el / Math.sqrt((1 + up) / (1 - up)), 1 / this.bl);
                    if (Math.abs(up - 1) < EPSLN) {
                        p.x = this.long0;
                        p.y = HALF_PI;
                    } else if (Math.abs(up + 1) < EPSLN) {
                        p.x = this.long0;
                        p.y = -1 * HALF_PI;
                    } else {
                        p.y = phi2z(this.e, ts);
                        p.x = adjust_lon(this.long0 - Math.atan2(sp * Math.cos(this.gamma0) - vp * Math.sin(this.gamma0), Math.cos(this.bl * us / this.al)) / this.bl);
                    }
                    return p;
                }
                var names$10 = [
                    'Hotine_Oblique_Mercator',
                    'Hotine Oblique Mercator',
                    'Hotine_Oblique_Mercator_Azimuth_Natural_Origin',
                    'Hotine_Oblique_Mercator_Azimuth_Center',
                    'omerc'
                ];
                var omerc = {
                    init: init$9,
                    forward: forward$8,
                    inverse: inverse$8,
                    names: names$10
                };
                function init$10() {
                    if (!this.lat2) {
                        this.lat2 = this.lat1;
                    }
                    if (!this.k0) {
                        this.k0 = 1;
                    }
                    this.x0 = this.x0 || 0;
                    this.y0 = this.y0 || 0;
                    if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
                        return;
                    }
                    var temp = this.b / this.a;
                    this.e = Math.sqrt(1 - temp * temp);
                    var sin1 = Math.sin(this.lat1);
                    var cos1 = Math.cos(this.lat1);
                    var ms1 = msfnz(this.e, sin1, cos1);
                    var ts1 = tsfnz(this.e, this.lat1, sin1);
                    var sin2 = Math.sin(this.lat2);
                    var cos2 = Math.cos(this.lat2);
                    var ms2 = msfnz(this.e, sin2, cos2);
                    var ts2 = tsfnz(this.e, this.lat2, sin2);
                    var ts0 = tsfnz(this.e, this.lat0, Math.sin(this.lat0));
                    if (Math.abs(this.lat1 - this.lat2) > EPSLN) {
                        this.ns = Math.log(ms1 / ms2) / Math.log(ts1 / ts2);
                    } else {
                        this.ns = sin1;
                    }
                    if (isNaN(this.ns)) {
                        this.ns = sin1;
                    }
                    this.f0 = ms1 / (this.ns * Math.pow(ts1, this.ns));
                    this.rh = this.a * this.f0 * Math.pow(ts0, this.ns);
                    if (!this.title) {
                        this.title = 'Lambert Conformal Conic';
                    }
                }
                function forward$9(p) {
                    var lon = p.x;
                    var lat = p.y;
                    if (Math.abs(2 * Math.abs(lat) - Math.PI) <= EPSLN) {
                        lat = sign(lat) * (HALF_PI - 2 * EPSLN);
                    }
                    var con = Math.abs(Math.abs(lat) - HALF_PI);
                    var ts, rh1;
                    if (con > EPSLN) {
                        ts = tsfnz(this.e, lat, Math.sin(lat));
                        rh1 = this.a * this.f0 * Math.pow(ts, this.ns);
                    } else {
                        con = lat * this.ns;
                        if (con <= 0) {
                            return null;
                        }
                        rh1 = 0;
                    }
                    var theta = this.ns * adjust_lon(lon - this.long0);
                    p.x = this.k0 * (rh1 * Math.sin(theta)) + this.x0;
                    p.y = this.k0 * (this.rh - rh1 * Math.cos(theta)) + this.y0;
                    return p;
                }
                function inverse$9(p) {
                    var rh1, con, ts;
                    var lat, lon;
                    var x = (p.x - this.x0) / this.k0;
                    var y = this.rh - (p.y - this.y0) / this.k0;
                    if (this.ns > 0) {
                        rh1 = Math.sqrt(x * x + y * y);
                        con = 1;
                    } else {
                        rh1 = -Math.sqrt(x * x + y * y);
                        con = -1;
                    }
                    var theta = 0;
                    if (rh1 !== 0) {
                        theta = Math.atan2(con * x, con * y);
                    }
                    if (rh1 !== 0 || this.ns > 0) {
                        con = 1 / this.ns;
                        ts = Math.pow(rh1 / (this.a * this.f0), con);
                        lat = phi2z(this.e, ts);
                        if (lat === -9999) {
                            return null;
                        }
                    } else {
                        lat = -HALF_PI;
                    }
                    lon = adjust_lon(theta / this.ns + this.long0);
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$11 = [
                    'Lambert Tangential Conformal Conic Projection',
                    'Lambert_Conformal_Conic',
                    'Lambert_Conformal_Conic_2SP',
                    'lcc'
                ];
                var lcc = {
                    init: init$10,
                    forward: forward$9,
                    inverse: inverse$9,
                    names: names$11
                };
                function init$11() {
                    this.a = 6377397.155;
                    this.es = 0.006674372230614;
                    this.e = Math.sqrt(this.es);
                    if (!this.lat0) {
                        this.lat0 = 0.863937979737193;
                    }
                    if (!this.long0) {
                        this.long0 = 0.7417649320975901 - 0.308341501185665;
                    }
                    if (!this.k0) {
                        this.k0 = 0.9999;
                    }
                    this.s45 = 0.785398163397448;
                    this.s90 = 2 * this.s45;
                    this.fi0 = this.lat0;
                    this.e2 = this.es;
                    this.e = Math.sqrt(this.e2);
                    this.alfa = Math.sqrt(1 + this.e2 * Math.pow(Math.cos(this.fi0), 4) / (1 - this.e2));
                    this.uq = 1.04216856380474;
                    this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa);
                    this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2);
                    this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g;
                    this.k1 = this.k0;
                    this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2));
                    this.s0 = 1.37008346281555;
                    this.n = Math.sin(this.s0);
                    this.ro0 = this.k1 * this.n0 / Math.tan(this.s0);
                    this.ad = this.s90 - this.uq;
                }
                function forward$10(p) {
                    var gfi, u, deltav, s, d, eps, ro;
                    var lon = p.x;
                    var lat = p.y;
                    var delta_lon = adjust_lon(lon - this.long0);
                    gfi = Math.pow((1 + this.e * Math.sin(lat)) / (1 - this.e * Math.sin(lat)), this.alfa * this.e / 2);
                    u = 2 * (Math.atan(this.k * Math.pow(Math.tan(lat / 2 + this.s45), this.alfa) / gfi) - this.s45);
                    deltav = -delta_lon * this.alfa;
                    s = Math.asin(Math.cos(this.ad) * Math.sin(u) + Math.sin(this.ad) * Math.cos(u) * Math.cos(deltav));
                    d = Math.asin(Math.cos(u) * Math.sin(deltav) / Math.cos(s));
                    eps = this.n * d;
                    ro = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(s / 2 + this.s45), this.n);
                    p.y = ro * Math.cos(eps) / 1;
                    p.x = ro * Math.sin(eps) / 1;
                    if (!this.czech) {
                        p.y *= -1;
                        p.x *= -1;
                    }
                    return p;
                }
                function inverse$10(p) {
                    var u, deltav, s, d, eps, ro, fi1;
                    var ok;
                    var tmp = p.x;
                    p.x = p.y;
                    p.y = tmp;
                    if (!this.czech) {
                        p.y *= -1;
                        p.x *= -1;
                    }
                    ro = Math.sqrt(p.x * p.x + p.y * p.y);
                    eps = Math.atan2(p.y, p.x);
                    d = eps / Math.sin(this.s0);
                    s = 2 * (Math.atan(Math.pow(this.ro0 / ro, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45);
                    u = Math.asin(Math.cos(this.ad) * Math.sin(s) - Math.sin(this.ad) * Math.cos(s) * Math.cos(d));
                    deltav = Math.asin(Math.cos(s) * Math.sin(d) / Math.cos(u));
                    p.x = this.long0 - deltav / this.alfa;
                    fi1 = u;
                    ok = 0;
                    var iter = 0;
                    do {
                        p.y = 2 * (Math.atan(Math.pow(this.k, -1 / this.alfa) * Math.pow(Math.tan(u / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(fi1)) / (1 - this.e * Math.sin(fi1)), this.e / 2)) - this.s45);
                        if (Math.abs(fi1 - p.y) < 1e-10) {
                            ok = 1;
                        }
                        fi1 = p.y;
                        iter += 1;
                    } while (ok === 0 && iter < 15);
                    if (iter >= 15) {
                        return null;
                    }
                    return p;
                }
                var names$12 = [
                    'Krovak',
                    'krovak'
                ];
                var krovak = {
                    init: init$11,
                    forward: forward$10,
                    inverse: inverse$10,
                    names: names$12
                };
                var mlfn = function (e0, e1, e2, e3, phi) {
                    return e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi);
                };
                var e0fn = function (x) {
                    return 1 - 0.25 * x * (1 + x / 16 * (3 + 1.25 * x));
                };
                var e1fn = function (x) {
                    return 0.375 * x * (1 + 0.25 * x * (1 + 0.46875 * x));
                };
                var e2fn = function (x) {
                    return 0.05859375 * x * x * (1 + 0.75 * x);
                };
                var e3fn = function (x) {
                    return x * x * x * (35 / 3072);
                };
                var gN = function (a, e, sinphi) {
                    var temp = e * sinphi;
                    return a / Math.sqrt(1 - temp * temp);
                };
                var adjust_lat = function (x) {
                    return Math.abs(x) < HALF_PI ? x : x - sign(x) * Math.PI;
                };
                var imlfn = function (ml, e0, e1, e2, e3) {
                    var phi;
                    var dphi;
                    phi = ml / e0;
                    for (var i = 0; i < 15; i++) {
                        dphi = (ml - (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi))) / (e0 - 2 * e1 * Math.cos(2 * phi) + 4 * e2 * Math.cos(4 * phi) - 6 * e3 * Math.cos(6 * phi));
                        phi += dphi;
                        if (Math.abs(dphi) <= 1e-10) {
                            return phi;
                        }
                    }
                    return NaN;
                };
                function init$12() {
                    if (!this.sphere) {
                        this.e0 = e0fn(this.es);
                        this.e1 = e1fn(this.es);
                        this.e2 = e2fn(this.es);
                        this.e3 = e3fn(this.es);
                        this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
                    }
                }
                function forward$11(p) {
                    var x, y;
                    var lam = p.x;
                    var phi = p.y;
                    lam = adjust_lon(lam - this.long0);
                    if (this.sphere) {
                        x = this.a * Math.asin(Math.cos(phi) * Math.sin(lam));
                        y = this.a * (Math.atan2(Math.tan(phi), Math.cos(lam)) - this.lat0);
                    } else {
                        var sinphi = Math.sin(phi);
                        var cosphi = Math.cos(phi);
                        var nl = gN(this.a, this.e, sinphi);
                        var tl = Math.tan(phi) * Math.tan(phi);
                        var al = lam * Math.cos(phi);
                        var asq = al * al;
                        var cl = this.es * cosphi * cosphi / (1 - this.es);
                        var ml = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);
                        x = nl * al * (1 - asq * tl * (1 / 6 - (8 - tl + 8 * cl) * asq / 120));
                        y = ml - this.ml0 + nl * sinphi / cosphi * asq * (0.5 + (5 - tl + 6 * cl) * asq / 24);
                    }
                    p.x = x + this.x0;
                    p.y = y + this.y0;
                    return p;
                }
                function inverse$11(p) {
                    p.x -= this.x0;
                    p.y -= this.y0;
                    var x = p.x / this.a;
                    var y = p.y / this.a;
                    var phi, lam;
                    if (this.sphere) {
                        var dd = y + this.lat0;
                        phi = Math.asin(Math.sin(dd) * Math.cos(x));
                        lam = Math.atan2(Math.tan(x), Math.cos(dd));
                    } else {
                        var ml1 = this.ml0 / this.a + y;
                        var phi1 = imlfn(ml1, this.e0, this.e1, this.e2, this.e3);
                        if (Math.abs(Math.abs(phi1) - HALF_PI) <= EPSLN) {
                            p.x = this.long0;
                            p.y = HALF_PI;
                            if (y < 0) {
                                p.y *= -1;
                            }
                            return p;
                        }
                        var nl1 = gN(this.a, this.e, Math.sin(phi1));
                        var rl1 = nl1 * nl1 * nl1 / this.a / this.a * (1 - this.es);
                        var tl1 = Math.pow(Math.tan(phi1), 2);
                        var dl = x * this.a / nl1;
                        var dsq = dl * dl;
                        phi = phi1 - nl1 * Math.tan(phi1) / rl1 * dl * dl * (0.5 - (1 + 3 * tl1) * dl * dl / 24);
                        lam = dl * (1 - dsq * (tl1 / 3 + (1 + 3 * tl1) * tl1 * dsq / 15)) / Math.cos(phi1);
                    }
                    p.x = adjust_lon(lam + this.long0);
                    p.y = adjust_lat(phi);
                    return p;
                }
                var names$13 = [
                    'Cassini',
                    'Cassini_Soldner',
                    'cass'
                ];
                var cass = {
                    init: init$12,
                    forward: forward$11,
                    inverse: inverse$11,
                    names: names$13
                };
                var qsfnz = function (eccent, sinphi) {
                    var con;
                    if (eccent > 1e-7) {
                        con = eccent * sinphi;
                        return (1 - eccent * eccent) * (sinphi / (1 - con * con) - 0.5 / eccent * Math.log((1 - con) / (1 + con)));
                    } else {
                        return 2 * sinphi;
                    }
                };
                var S_POLE = 1;
                var N_POLE = 2;
                var EQUIT = 3;
                var OBLIQ = 4;
                function init$13() {
                    var t = Math.abs(this.lat0);
                    if (Math.abs(t - HALF_PI) < EPSLN) {
                        this.mode = this.lat0 < 0 ? this.S_POLE : this.N_POLE;
                    } else if (Math.abs(t) < EPSLN) {
                        this.mode = this.EQUIT;
                    } else {
                        this.mode = this.OBLIQ;
                    }
                    if (this.es > 0) {
                        var sinphi;
                        this.qp = qsfnz(this.e, 1);
                        this.mmf = 0.5 / (1 - this.es);
                        this.apa = authset(this.es);
                        switch (this.mode) {
                        case this.N_POLE:
                            this.dd = 1;
                            break;
                        case this.S_POLE:
                            this.dd = 1;
                            break;
                        case this.EQUIT:
                            this.rq = Math.sqrt(0.5 * this.qp);
                            this.dd = 1 / this.rq;
                            this.xmf = 1;
                            this.ymf = 0.5 * this.qp;
                            break;
                        case this.OBLIQ:
                            this.rq = Math.sqrt(0.5 * this.qp);
                            sinphi = Math.sin(this.lat0);
                            this.sinb1 = qsfnz(this.e, sinphi) / this.qp;
                            this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1);
                            this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * sinphi * sinphi) * this.rq * this.cosb1);
                            this.ymf = (this.xmf = this.rq) / this.dd;
                            this.xmf *= this.dd;
                            break;
                        }
                    } else {
                        if (this.mode === this.OBLIQ) {
                            this.sinph0 = Math.sin(this.lat0);
                            this.cosph0 = Math.cos(this.lat0);
                        }
                    }
                }
                function forward$12(p) {
                    var x, y, coslam, sinlam, sinphi, q, sinb, cosb, b, cosphi;
                    var lam = p.x;
                    var phi = p.y;
                    lam = adjust_lon(lam - this.long0);
                    if (this.sphere) {
                        sinphi = Math.sin(phi);
                        cosphi = Math.cos(phi);
                        coslam = Math.cos(lam);
                        if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                            y = this.mode === this.EQUIT ? 1 + cosphi * coslam : 1 + this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;
                            if (y <= EPSLN) {
                                return null;
                            }
                            y = Math.sqrt(2 / y);
                            x = y * cosphi * Math.sin(lam);
                            y *= this.mode === this.EQUIT ? sinphi : this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;
                        } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                            if (this.mode === this.N_POLE) {
                                coslam = -coslam;
                            }
                            if (Math.abs(phi + this.phi0) < EPSLN) {
                                return null;
                            }
                            y = FORTPI - phi * 0.5;
                            y = 2 * (this.mode === this.S_POLE ? Math.cos(y) : Math.sin(y));
                            x = y * Math.sin(lam);
                            y *= coslam;
                        }
                    } else {
                        sinb = 0;
                        cosb = 0;
                        b = 0;
                        coslam = Math.cos(lam);
                        sinlam = Math.sin(lam);
                        sinphi = Math.sin(phi);
                        q = qsfnz(this.e, sinphi);
                        if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                            sinb = q / this.qp;
                            cosb = Math.sqrt(1 - sinb * sinb);
                        }
                        switch (this.mode) {
                        case this.OBLIQ:
                            b = 1 + this.sinb1 * sinb + this.cosb1 * cosb * coslam;
                            break;
                        case this.EQUIT:
                            b = 1 + cosb * coslam;
                            break;
                        case this.N_POLE:
                            b = HALF_PI + phi;
                            q = this.qp - q;
                            break;
                        case this.S_POLE:
                            b = phi - HALF_PI;
                            q = this.qp + q;
                            break;
                        }
                        if (Math.abs(b) < EPSLN) {
                            return null;
                        }
                        switch (this.mode) {
                        case this.OBLIQ:
                        case this.EQUIT:
                            b = Math.sqrt(2 / b);
                            if (this.mode === this.OBLIQ) {
                                y = this.ymf * b * (this.cosb1 * sinb - this.sinb1 * cosb * coslam);
                            } else {
                                y = (b = Math.sqrt(2 / (1 + cosb * coslam))) * sinb * this.ymf;
                            }
                            x = this.xmf * b * cosb * sinlam;
                            break;
                        case this.N_POLE:
                        case this.S_POLE:
                            if (q >= 0) {
                                x = (b = Math.sqrt(q)) * sinlam;
                                y = coslam * (this.mode === this.S_POLE ? b : -b);
                            } else {
                                x = y = 0;
                            }
                            break;
                        }
                    }
                    p.x = this.a * x + this.x0;
                    p.y = this.a * y + this.y0;
                    return p;
                }
                function inverse$12(p) {
                    p.x -= this.x0;
                    p.y -= this.y0;
                    var x = p.x / this.a;
                    var y = p.y / this.a;
                    var lam, phi, cCe, sCe, q, rho, ab;
                    if (this.sphere) {
                        var cosz = 0, rh, sinz = 0;
                        rh = Math.sqrt(x * x + y * y);
                        phi = rh * 0.5;
                        if (phi > 1) {
                            return null;
                        }
                        phi = 2 * Math.asin(phi);
                        if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                            sinz = Math.sin(phi);
                            cosz = Math.cos(phi);
                        }
                        switch (this.mode) {
                        case this.EQUIT:
                            phi = Math.abs(rh) <= EPSLN ? 0 : Math.asin(y * sinz / rh);
                            x *= sinz;
                            y = cosz * rh;
                            break;
                        case this.OBLIQ:
                            phi = Math.abs(rh) <= EPSLN ? this.phi0 : Math.asin(cosz * this.sinph0 + y * sinz * this.cosph0 / rh);
                            x *= sinz * this.cosph0;
                            y = (cosz - Math.sin(phi) * this.sinph0) * rh;
                            break;
                        case this.N_POLE:
                            y = -y;
                            phi = HALF_PI - phi;
                            break;
                        case this.S_POLE:
                            phi -= HALF_PI;
                            break;
                        }
                        lam = y === 0 && (this.mode === this.EQUIT || this.mode === this.OBLIQ) ? 0 : Math.atan2(x, y);
                    } else {
                        ab = 0;
                        if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
                            x /= this.dd;
                            y *= this.dd;
                            rho = Math.sqrt(x * x + y * y);
                            if (rho < EPSLN) {
                                p.x = 0;
                                p.y = this.phi0;
                                return p;
                            }
                            sCe = 2 * Math.asin(0.5 * rho / this.rq);
                            cCe = Math.cos(sCe);
                            x *= sCe = Math.sin(sCe);
                            if (this.mode === this.OBLIQ) {
                                ab = cCe * this.sinb1 + y * sCe * this.cosb1 / rho;
                                q = this.qp * ab;
                                y = rho * this.cosb1 * cCe - y * this.sinb1 * sCe;
                            } else {
                                ab = y * sCe / rho;
                                q = this.qp * ab;
                                y = rho * cCe;
                            }
                        } else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
                            if (this.mode === this.N_POLE) {
                                y = -y;
                            }
                            q = x * x + y * y;
                            if (!q) {
                                p.x = 0;
                                p.y = this.phi0;
                                return p;
                            }
                            ab = 1 - q / this.qp;
                            if (this.mode === this.S_POLE) {
                                ab = -ab;
                            }
                        }
                        lam = Math.atan2(x, y);
                        phi = authlat(Math.asin(ab), this.apa);
                    }
                    p.x = adjust_lon(this.long0 + lam);
                    p.y = phi;
                    return p;
                }
                var P00 = 0.3333333333333333;
                var P01 = 0.17222222222222222;
                var P02 = 0.10257936507936508;
                var P10 = 0.06388888888888888;
                var P11 = 0.0664021164021164;
                var P20 = 0.016415012942191543;
                function authset(es) {
                    var t;
                    var APA = [];
                    APA[0] = es * P00;
                    t = es * es;
                    APA[0] += t * P01;
                    APA[1] = t * P10;
                    t *= es;
                    APA[0] += t * P02;
                    APA[1] += t * P11;
                    APA[2] = t * P20;
                    return APA;
                }
                function authlat(beta, APA) {
                    var t = beta + beta;
                    return beta + APA[0] * Math.sin(t) + APA[1] * Math.sin(t + t) + APA[2] * Math.sin(t + t + t);
                }
                var names$14 = [
                    'Lambert Azimuthal Equal Area',
                    'Lambert_Azimuthal_Equal_Area',
                    'laea'
                ];
                var laea = {
                    init: init$13,
                    forward: forward$12,
                    inverse: inverse$12,
                    names: names$14,
                    S_POLE: S_POLE,
                    N_POLE: N_POLE,
                    EQUIT: EQUIT,
                    OBLIQ: OBLIQ
                };
                var asinz = function (x) {
                    if (Math.abs(x) > 1) {
                        x = x > 1 ? 1 : -1;
                    }
                    return Math.asin(x);
                };
                function init$14() {
                    if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
                        return;
                    }
                    this.temp = this.b / this.a;
                    this.es = 1 - Math.pow(this.temp, 2);
                    this.e3 = Math.sqrt(this.es);
                    this.sin_po = Math.sin(this.lat1);
                    this.cos_po = Math.cos(this.lat1);
                    this.t1 = this.sin_po;
                    this.con = this.sin_po;
                    this.ms1 = msfnz(this.e3, this.sin_po, this.cos_po);
                    this.qs1 = qsfnz(this.e3, this.sin_po, this.cos_po);
                    this.sin_po = Math.sin(this.lat2);
                    this.cos_po = Math.cos(this.lat2);
                    this.t2 = this.sin_po;
                    this.ms2 = msfnz(this.e3, this.sin_po, this.cos_po);
                    this.qs2 = qsfnz(this.e3, this.sin_po, this.cos_po);
                    this.sin_po = Math.sin(this.lat0);
                    this.cos_po = Math.cos(this.lat0);
                    this.t3 = this.sin_po;
                    this.qs0 = qsfnz(this.e3, this.sin_po, this.cos_po);
                    if (Math.abs(this.lat1 - this.lat2) > EPSLN) {
                        this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1);
                    } else {
                        this.ns0 = this.con;
                    }
                    this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1;
                    this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0;
                }
                function forward$13(p) {
                    var lon = p.x;
                    var lat = p.y;
                    this.sin_phi = Math.sin(lat);
                    this.cos_phi = Math.cos(lat);
                    var qs = qsfnz(this.e3, this.sin_phi, this.cos_phi);
                    var rh1 = this.a * Math.sqrt(this.c - this.ns0 * qs) / this.ns0;
                    var theta = this.ns0 * adjust_lon(lon - this.long0);
                    var x = rh1 * Math.sin(theta) + this.x0;
                    var y = this.rh - rh1 * Math.cos(theta) + this.y0;
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$13(p) {
                    var rh1, qs, con, theta, lon, lat;
                    p.x -= this.x0;
                    p.y = this.rh - p.y + this.y0;
                    if (this.ns0 >= 0) {
                        rh1 = Math.sqrt(p.x * p.x + p.y * p.y);
                        con = 1;
                    } else {
                        rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);
                        con = -1;
                    }
                    theta = 0;
                    if (rh1 !== 0) {
                        theta = Math.atan2(con * p.x, con * p.y);
                    }
                    con = rh1 * this.ns0 / this.a;
                    if (this.sphere) {
                        lat = Math.asin((this.c - con * con) / (2 * this.ns0));
                    } else {
                        qs = (this.c - con * con) / this.ns0;
                        lat = this.phi1z(this.e3, qs);
                    }
                    lon = adjust_lon(theta / this.ns0 + this.long0);
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                function phi1z(eccent, qs) {
                    var sinphi, cosphi, con, com, dphi;
                    var phi = asinz(0.5 * qs);
                    if (eccent < EPSLN) {
                        return phi;
                    }
                    var eccnts = eccent * eccent;
                    for (var i = 1; i <= 25; i++) {
                        sinphi = Math.sin(phi);
                        cosphi = Math.cos(phi);
                        con = eccent * sinphi;
                        com = 1 - con * con;
                        dphi = 0.5 * com * com / cosphi * (qs / (1 - eccnts) - sinphi / com + 0.5 / eccent * Math.log((1 - con) / (1 + con)));
                        phi = phi + dphi;
                        if (Math.abs(dphi) <= 1e-7) {
                            return phi;
                        }
                    }
                    return null;
                }
                var names$15 = [
                    'Albers_Conic_Equal_Area',
                    'Albers',
                    'aea'
                ];
                var aea = {
                    init: init$14,
                    forward: forward$13,
                    inverse: inverse$13,
                    names: names$15,
                    phi1z: phi1z
                };
                function init$15() {
                    this.sin_p14 = Math.sin(this.lat0);
                    this.cos_p14 = Math.cos(this.lat0);
                    this.infinity_dist = 1000 * this.a;
                    this.rc = 1;
                }
                function forward$14(p) {
                    var sinphi, cosphi;
                    var dlon;
                    var coslon;
                    var ksp;
                    var g;
                    var x, y;
                    var lon = p.x;
                    var lat = p.y;
                    dlon = adjust_lon(lon - this.long0);
                    sinphi = Math.sin(lat);
                    cosphi = Math.cos(lat);
                    coslon = Math.cos(dlon);
                    g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;
                    ksp = 1;
                    if (g > 0 || Math.abs(g) <= EPSLN) {
                        x = this.x0 + this.a * ksp * cosphi * Math.sin(dlon) / g;
                        y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon) / g;
                    } else {
                        x = this.x0 + this.infinity_dist * cosphi * Math.sin(dlon);
                        y = this.y0 + this.infinity_dist * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);
                    }
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$14(p) {
                    var rh;
                    var sinc, cosc;
                    var c;
                    var lon, lat;
                    p.x = (p.x - this.x0) / this.a;
                    p.y = (p.y - this.y0) / this.a;
                    p.x /= this.k0;
                    p.y /= this.k0;
                    if (rh = Math.sqrt(p.x * p.x + p.y * p.y)) {
                        c = Math.atan2(rh, this.rc);
                        sinc = Math.sin(c);
                        cosc = Math.cos(c);
                        lat = asinz(cosc * this.sin_p14 + p.y * sinc * this.cos_p14 / rh);
                        lon = Math.atan2(p.x * sinc, rh * this.cos_p14 * cosc - p.y * this.sin_p14 * sinc);
                        lon = adjust_lon(this.long0 + lon);
                    } else {
                        lat = this.phic0;
                        lon = 0;
                    }
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$16 = ['gnom'];
                var gnom = {
                    init: init$15,
                    forward: forward$14,
                    inverse: inverse$14,
                    names: names$16
                };
                var iqsfnz = function (eccent, q) {
                    var temp = 1 - (1 - eccent * eccent) / (2 * eccent) * Math.log((1 - eccent) / (1 + eccent));
                    if (Math.abs(Math.abs(q) - temp) < 0.000001) {
                        if (q < 0) {
                            return -1 * HALF_PI;
                        } else {
                            return HALF_PI;
                        }
                    }
                    var phi = Math.asin(0.5 * q);
                    var dphi;
                    var sin_phi;
                    var cos_phi;
                    var con;
                    for (var i = 0; i < 30; i++) {
                        sin_phi = Math.sin(phi);
                        cos_phi = Math.cos(phi);
                        con = eccent * sin_phi;
                        dphi = Math.pow(1 - con * con, 2) / (2 * cos_phi) * (q / (1 - eccent * eccent) - sin_phi / (1 - con * con) + 0.5 / eccent * Math.log((1 - con) / (1 + con)));
                        phi += dphi;
                        if (Math.abs(dphi) <= 1e-10) {
                            return phi;
                        }
                    }
                    return NaN;
                };
                function init$16() {
                    if (!this.sphere) {
                        this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));
                    }
                }
                function forward$15(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var x, y;
                    var dlon = adjust_lon(lon - this.long0);
                    if (this.sphere) {
                        x = this.x0 + this.a * dlon * Math.cos(this.lat_ts);
                        y = this.y0 + this.a * Math.sin(lat) / Math.cos(this.lat_ts);
                    } else {
                        var qs = qsfnz(this.e, Math.sin(lat));
                        x = this.x0 + this.a * this.k0 * dlon;
                        y = this.y0 + this.a * qs * 0.5 / this.k0;
                    }
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$15(p) {
                    p.x -= this.x0;
                    p.y -= this.y0;
                    var lon, lat;
                    if (this.sphere) {
                        lon = adjust_lon(this.long0 + p.x / this.a / Math.cos(this.lat_ts));
                        lat = Math.asin(p.y / this.a * Math.cos(this.lat_ts));
                    } else {
                        lat = iqsfnz(this.e, 2 * p.y * this.k0 / this.a);
                        lon = adjust_lon(this.long0 + p.x / (this.a * this.k0));
                    }
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$17 = ['cea'];
                var cea = {
                    init: init$16,
                    forward: forward$15,
                    inverse: inverse$15,
                    names: names$17
                };
                function init$17() {
                    this.x0 = this.x0 || 0;
                    this.y0 = this.y0 || 0;
                    this.lat0 = this.lat0 || 0;
                    this.long0 = this.long0 || 0;
                    this.lat_ts = this.lat_ts || 0;
                    this.title = this.title || 'Equidistant Cylindrical (Plate Carre)';
                    this.rc = Math.cos(this.lat_ts);
                }
                function forward$16(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var dlon = adjust_lon(lon - this.long0);
                    var dlat = adjust_lat(lat - this.lat0);
                    p.x = this.x0 + this.a * dlon * this.rc;
                    p.y = this.y0 + this.a * dlat;
                    return p;
                }
                function inverse$16(p) {
                    var x = p.x;
                    var y = p.y;
                    p.x = adjust_lon(this.long0 + (x - this.x0) / (this.a * this.rc));
                    p.y = adjust_lat(this.lat0 + (y - this.y0) / this.a);
                    return p;
                }
                var names$18 = [
                    'Equirectangular',
                    'Equidistant_Cylindrical',
                    'eqc'
                ];
                var eqc = {
                    init: init$17,
                    forward: forward$16,
                    inverse: inverse$16,
                    names: names$18
                };
                var MAX_ITER$2 = 20;
                function init$18() {
                    this.temp = this.b / this.a;
                    this.es = 1 - Math.pow(this.temp, 2);
                    this.e = Math.sqrt(this.es);
                    this.e0 = e0fn(this.es);
                    this.e1 = e1fn(this.es);
                    this.e2 = e2fn(this.es);
                    this.e3 = e3fn(this.es);
                    this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
                }
                function forward$17(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var x, y, el;
                    var dlon = adjust_lon(lon - this.long0);
                    el = dlon * Math.sin(lat);
                    if (this.sphere) {
                        if (Math.abs(lat) <= EPSLN) {
                            x = this.a * dlon;
                            y = -1 * this.a * this.lat0;
                        } else {
                            x = this.a * Math.sin(el) / Math.tan(lat);
                            y = this.a * (adjust_lat(lat - this.lat0) + (1 - Math.cos(el)) / Math.tan(lat));
                        }
                    } else {
                        if (Math.abs(lat) <= EPSLN) {
                            x = this.a * dlon;
                            y = -1 * this.ml0;
                        } else {
                            var nl = gN(this.a, this.e, Math.sin(lat)) / Math.tan(lat);
                            x = nl * Math.sin(el);
                            y = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, lat) - this.ml0 + nl * (1 - Math.cos(el));
                        }
                    }
                    p.x = x + this.x0;
                    p.y = y + this.y0;
                    return p;
                }
                function inverse$17(p) {
                    var lon, lat, x, y, i;
                    var al, bl;
                    var phi, dphi;
                    x = p.x - this.x0;
                    y = p.y - this.y0;
                    if (this.sphere) {
                        if (Math.abs(y + this.a * this.lat0) <= EPSLN) {
                            lon = adjust_lon(x / this.a + this.long0);
                            lat = 0;
                        } else {
                            al = this.lat0 + y / this.a;
                            bl = x * x / this.a / this.a + al * al;
                            phi = al;
                            var tanphi;
                            for (i = MAX_ITER$2; i; --i) {
                                tanphi = Math.tan(phi);
                                dphi = -1 * (al * (phi * tanphi + 1) - phi - 0.5 * (phi * phi + bl) * tanphi) / ((phi - al) / tanphi - 1);
                                phi += dphi;
                                if (Math.abs(dphi) <= EPSLN) {
                                    lat = phi;
                                    break;
                                }
                            }
                            lon = adjust_lon(this.long0 + Math.asin(x * Math.tan(phi) / this.a) / Math.sin(lat));
                        }
                    } else {
                        if (Math.abs(y + this.ml0) <= EPSLN) {
                            lat = 0;
                            lon = adjust_lon(this.long0 + x / this.a);
                        } else {
                            al = (this.ml0 + y) / this.a;
                            bl = x * x / this.a / this.a + al * al;
                            phi = al;
                            var cl, mln, mlnp, ma;
                            var con;
                            for (i = MAX_ITER$2; i; --i) {
                                con = this.e * Math.sin(phi);
                                cl = Math.sqrt(1 - con * con) * Math.tan(phi);
                                mln = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);
                                mlnp = this.e0 - 2 * this.e1 * Math.cos(2 * phi) + 4 * this.e2 * Math.cos(4 * phi) - 6 * this.e3 * Math.cos(6 * phi);
                                ma = mln / this.a;
                                dphi = (al * (cl * ma + 1) - ma - 0.5 * cl * (ma * ma + bl)) / (this.es * Math.sin(2 * phi) * (ma * ma + bl - 2 * al * ma) / (4 * cl) + (al - ma) * (cl * mlnp - 2 / Math.sin(2 * phi)) - mlnp);
                                phi -= dphi;
                                if (Math.abs(dphi) <= EPSLN) {
                                    lat = phi;
                                    break;
                                }
                            }
                            cl = Math.sqrt(1 - this.es * Math.pow(Math.sin(lat), 2)) * Math.tan(lat);
                            lon = adjust_lon(this.long0 + Math.asin(x * cl / this.a) / Math.sin(lat));
                        }
                    }
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$19 = [
                    'Polyconic',
                    'poly'
                ];
                var poly = {
                    init: init$18,
                    forward: forward$17,
                    inverse: inverse$17,
                    names: names$19
                };
                function init$19() {
                    this.A = [];
                    this.A[1] = 0.6399175073;
                    this.A[2] = -0.1358797613;
                    this.A[3] = 0.063294409;
                    this.A[4] = -0.02526853;
                    this.A[5] = 0.0117879;
                    this.A[6] = -0.0055161;
                    this.A[7] = 0.0026906;
                    this.A[8] = -0.001333;
                    this.A[9] = 0.00067;
                    this.A[10] = -0.00034;
                    this.B_re = [];
                    this.B_im = [];
                    this.B_re[1] = 0.7557853228;
                    this.B_im[1] = 0;
                    this.B_re[2] = 0.249204646;
                    this.B_im[2] = 0.003371507;
                    this.B_re[3] = -0.001541739;
                    this.B_im[3] = 0.04105856;
                    this.B_re[4] = -0.10162907;
                    this.B_im[4] = 0.01727609;
                    this.B_re[5] = -0.26623489;
                    this.B_im[5] = -0.36249218;
                    this.B_re[6] = -0.6870983;
                    this.B_im[6] = -1.1651967;
                    this.C_re = [];
                    this.C_im = [];
                    this.C_re[1] = 1.3231270439;
                    this.C_im[1] = 0;
                    this.C_re[2] = -0.577245789;
                    this.C_im[2] = -0.007809598;
                    this.C_re[3] = 0.508307513;
                    this.C_im[3] = -0.112208952;
                    this.C_re[4] = -0.15094762;
                    this.C_im[4] = 0.18200602;
                    this.C_re[5] = 1.01418179;
                    this.C_im[5] = 1.64497696;
                    this.C_re[6] = 1.9660549;
                    this.C_im[6] = 2.5127645;
                    this.D = [];
                    this.D[1] = 1.5627014243;
                    this.D[2] = 0.5185406398;
                    this.D[3] = -0.03333098;
                    this.D[4] = -0.1052906;
                    this.D[5] = -0.0368594;
                    this.D[6] = 0.007317;
                    this.D[7] = 0.0122;
                    this.D[8] = 0.00394;
                    this.D[9] = -0.0013;
                }
                function forward$18(p) {
                    var n;
                    var lon = p.x;
                    var lat = p.y;
                    var delta_lat = lat - this.lat0;
                    var delta_lon = lon - this.long0;
                    var d_phi = delta_lat / SEC_TO_RAD * 0.00001;
                    var d_lambda = delta_lon;
                    var d_phi_n = 1;
                    var d_psi = 0;
                    for (n = 1; n <= 10; n++) {
                        d_phi_n = d_phi_n * d_phi;
                        d_psi = d_psi + this.A[n] * d_phi_n;
                    }
                    var th_re = d_psi;
                    var th_im = d_lambda;
                    var th_n_re = 1;
                    var th_n_im = 0;
                    var th_n_re1;
                    var th_n_im1;
                    var z_re = 0;
                    var z_im = 0;
                    for (n = 1; n <= 6; n++) {
                        th_n_re1 = th_n_re * th_re - th_n_im * th_im;
                        th_n_im1 = th_n_im * th_re + th_n_re * th_im;
                        th_n_re = th_n_re1;
                        th_n_im = th_n_im1;
                        z_re = z_re + this.B_re[n] * th_n_re - this.B_im[n] * th_n_im;
                        z_im = z_im + this.B_im[n] * th_n_re + this.B_re[n] * th_n_im;
                    }
                    p.x = z_im * this.a + this.x0;
                    p.y = z_re * this.a + this.y0;
                    return p;
                }
                function inverse$18(p) {
                    var n;
                    var x = p.x;
                    var y = p.y;
                    var delta_x = x - this.x0;
                    var delta_y = y - this.y0;
                    var z_re = delta_y / this.a;
                    var z_im = delta_x / this.a;
                    var z_n_re = 1;
                    var z_n_im = 0;
                    var z_n_re1;
                    var z_n_im1;
                    var th_re = 0;
                    var th_im = 0;
                    for (n = 1; n <= 6; n++) {
                        z_n_re1 = z_n_re * z_re - z_n_im * z_im;
                        z_n_im1 = z_n_im * z_re + z_n_re * z_im;
                        z_n_re = z_n_re1;
                        z_n_im = z_n_im1;
                        th_re = th_re + this.C_re[n] * z_n_re - this.C_im[n] * z_n_im;
                        th_im = th_im + this.C_im[n] * z_n_re + this.C_re[n] * z_n_im;
                    }
                    for (var i = 0; i < this.iterations; i++) {
                        var th_n_re = th_re;
                        var th_n_im = th_im;
                        var th_n_re1;
                        var th_n_im1;
                        var num_re = z_re;
                        var num_im = z_im;
                        for (n = 2; n <= 6; n++) {
                            th_n_re1 = th_n_re * th_re - th_n_im * th_im;
                            th_n_im1 = th_n_im * th_re + th_n_re * th_im;
                            th_n_re = th_n_re1;
                            th_n_im = th_n_im1;
                            num_re = num_re + (n - 1) * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);
                            num_im = num_im + (n - 1) * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);
                        }
                        th_n_re = 1;
                        th_n_im = 0;
                        var den_re = this.B_re[1];
                        var den_im = this.B_im[1];
                        for (n = 2; n <= 6; n++) {
                            th_n_re1 = th_n_re * th_re - th_n_im * th_im;
                            th_n_im1 = th_n_im * th_re + th_n_re * th_im;
                            th_n_re = th_n_re1;
                            th_n_im = th_n_im1;
                            den_re = den_re + n * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);
                            den_im = den_im + n * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);
                        }
                        var den2 = den_re * den_re + den_im * den_im;
                        th_re = (num_re * den_re + num_im * den_im) / den2;
                        th_im = (num_im * den_re - num_re * den_im) / den2;
                    }
                    var d_psi = th_re;
                    var d_lambda = th_im;
                    var d_psi_n = 1;
                    var d_phi = 0;
                    for (n = 1; n <= 9; n++) {
                        d_psi_n = d_psi_n * d_psi;
                        d_phi = d_phi + this.D[n] * d_psi_n;
                    }
                    var lat = this.lat0 + d_phi * SEC_TO_RAD * 100000;
                    var lon = this.long0 + d_lambda;
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$20 = [
                    'New_Zealand_Map_Grid',
                    'nzmg'
                ];
                var nzmg = {
                    init: init$19,
                    forward: forward$18,
                    inverse: inverse$18,
                    names: names$20
                };
                function init$20() {
                }
                function forward$19(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var dlon = adjust_lon(lon - this.long0);
                    var x = this.x0 + this.a * dlon;
                    var y = this.y0 + this.a * Math.log(Math.tan(Math.PI / 4 + lat / 2.5)) * 1.25;
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$19(p) {
                    p.x -= this.x0;
                    p.y -= this.y0;
                    var lon = adjust_lon(this.long0 + p.x / this.a);
                    var lat = 2.5 * (Math.atan(Math.exp(0.8 * p.y / this.a)) - Math.PI / 4);
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$21 = [
                    'Miller_Cylindrical',
                    'mill'
                ];
                var mill = {
                    init: init$20,
                    forward: forward$19,
                    inverse: inverse$19,
                    names: names$21
                };
                var MAX_ITER$3 = 20;
                function init$21() {
                    if (!this.sphere) {
                        this.en = pj_enfn(this.es);
                    } else {
                        this.n = 1;
                        this.m = 0;
                        this.es = 0;
                        this.C_y = Math.sqrt((this.m + 1) / this.n);
                        this.C_x = this.C_y / (this.m + 1);
                    }
                }
                function forward$20(p) {
                    var x, y;
                    var lon = p.x;
                    var lat = p.y;
                    lon = adjust_lon(lon - this.long0);
                    if (this.sphere) {
                        if (!this.m) {
                            lat = this.n !== 1 ? Math.asin(this.n * Math.sin(lat)) : lat;
                        } else {
                            var k = this.n * Math.sin(lat);
                            for (var i = MAX_ITER$3; i; --i) {
                                var V = (this.m * lat + Math.sin(lat) - k) / (this.m + Math.cos(lat));
                                lat -= V;
                                if (Math.abs(V) < EPSLN) {
                                    break;
                                }
                            }
                        }
                        x = this.a * this.C_x * lon * (this.m + Math.cos(lat));
                        y = this.a * this.C_y * lat;
                    } else {
                        var s = Math.sin(lat);
                        var c = Math.cos(lat);
                        y = this.a * pj_mlfn(lat, s, c, this.en);
                        x = this.a * lon * c / Math.sqrt(1 - this.es * s * s);
                    }
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$20(p) {
                    var lat, temp, lon, s;
                    p.x -= this.x0;
                    lon = p.x / this.a;
                    p.y -= this.y0;
                    lat = p.y / this.a;
                    if (this.sphere) {
                        lat /= this.C_y;
                        lon = lon / (this.C_x * (this.m + Math.cos(lat)));
                        if (this.m) {
                            lat = asinz((this.m * lat + Math.sin(lat)) / this.n);
                        } else if (this.n !== 1) {
                            lat = asinz(Math.sin(lat) / this.n);
                        }
                        lon = adjust_lon(lon + this.long0);
                        lat = adjust_lat(lat);
                    } else {
                        lat = pj_inv_mlfn(p.y / this.a, this.es, this.en);
                        s = Math.abs(lat);
                        if (s < HALF_PI) {
                            s = Math.sin(lat);
                            temp = this.long0 + p.x * Math.sqrt(1 - this.es * s * s) / (this.a * Math.cos(lat));
                            lon = adjust_lon(temp);
                        } else if (s - EPSLN < HALF_PI) {
                            lon = this.long0;
                        }
                    }
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$22 = [
                    'Sinusoidal',
                    'sinu'
                ];
                var sinu = {
                    init: init$21,
                    forward: forward$20,
                    inverse: inverse$20,
                    names: names$22
                };
                function init$22() {
                }
                function forward$21(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var delta_lon = adjust_lon(lon - this.long0);
                    var theta = lat;
                    var con = Math.PI * Math.sin(lat);
                    while (true) {
                        var delta_theta = -(theta + Math.sin(theta) - con) / (1 + Math.cos(theta));
                        theta += delta_theta;
                        if (Math.abs(delta_theta) < EPSLN) {
                            break;
                        }
                    }
                    theta /= 2;
                    if (Math.PI / 2 - Math.abs(lat) < EPSLN) {
                        delta_lon = 0;
                    }
                    var x = 0.900316316158 * this.a * delta_lon * Math.cos(theta) + this.x0;
                    var y = 1.4142135623731 * this.a * Math.sin(theta) + this.y0;
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$21(p) {
                    var theta;
                    var arg;
                    p.x -= this.x0;
                    p.y -= this.y0;
                    arg = p.y / (1.4142135623731 * this.a);
                    if (Math.abs(arg) > 0.999999999999) {
                        arg = 0.999999999999;
                    }
                    theta = Math.asin(arg);
                    var lon = adjust_lon(this.long0 + p.x / (0.900316316158 * this.a * Math.cos(theta)));
                    if (lon < -Math.PI) {
                        lon = -Math.PI;
                    }
                    if (lon > Math.PI) {
                        lon = Math.PI;
                    }
                    arg = (2 * theta + Math.sin(2 * theta)) / Math.PI;
                    if (Math.abs(arg) > 1) {
                        arg = 1;
                    }
                    var lat = Math.asin(arg);
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$23 = [
                    'Mollweide',
                    'moll'
                ];
                var moll = {
                    init: init$22,
                    forward: forward$21,
                    inverse: inverse$21,
                    names: names$23
                };
                function init$23() {
                    if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
                        return;
                    }
                    this.lat2 = this.lat2 || this.lat1;
                    this.temp = this.b / this.a;
                    this.es = 1 - Math.pow(this.temp, 2);
                    this.e = Math.sqrt(this.es);
                    this.e0 = e0fn(this.es);
                    this.e1 = e1fn(this.es);
                    this.e2 = e2fn(this.es);
                    this.e3 = e3fn(this.es);
                    this.sinphi = Math.sin(this.lat1);
                    this.cosphi = Math.cos(this.lat1);
                    this.ms1 = msfnz(this.e, this.sinphi, this.cosphi);
                    this.ml1 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat1);
                    if (Math.abs(this.lat1 - this.lat2) < EPSLN) {
                        this.ns = this.sinphi;
                    } else {
                        this.sinphi = Math.sin(this.lat2);
                        this.cosphi = Math.cos(this.lat2);
                        this.ms2 = msfnz(this.e, this.sinphi, this.cosphi);
                        this.ml2 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat2);
                        this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1);
                    }
                    this.g = this.ml1 + this.ms1 / this.ns;
                    this.ml0 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
                    this.rh = this.a * (this.g - this.ml0);
                }
                function forward$22(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var rh1;
                    if (this.sphere) {
                        rh1 = this.a * (this.g - lat);
                    } else {
                        var ml = mlfn(this.e0, this.e1, this.e2, this.e3, lat);
                        rh1 = this.a * (this.g - ml);
                    }
                    var theta = this.ns * adjust_lon(lon - this.long0);
                    var x = this.x0 + rh1 * Math.sin(theta);
                    var y = this.y0 + this.rh - rh1 * Math.cos(theta);
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$22(p) {
                    p.x -= this.x0;
                    p.y = this.rh - p.y + this.y0;
                    var con, rh1, lat, lon;
                    if (this.ns >= 0) {
                        rh1 = Math.sqrt(p.x * p.x + p.y * p.y);
                        con = 1;
                    } else {
                        rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);
                        con = -1;
                    }
                    var theta = 0;
                    if (rh1 !== 0) {
                        theta = Math.atan2(con * p.x, con * p.y);
                    }
                    if (this.sphere) {
                        lon = adjust_lon(this.long0 + theta / this.ns);
                        lat = adjust_lat(this.g - rh1 / this.a);
                        p.x = lon;
                        p.y = lat;
                        return p;
                    } else {
                        var ml = this.g - rh1 / this.a;
                        lat = imlfn(ml, this.e0, this.e1, this.e2, this.e3);
                        lon = adjust_lon(this.long0 + theta / this.ns);
                        p.x = lon;
                        p.y = lat;
                        return p;
                    }
                }
                var names$24 = [
                    'Equidistant_Conic',
                    'eqdc'
                ];
                var eqdc = {
                    init: init$23,
                    forward: forward$22,
                    inverse: inverse$22,
                    names: names$24
                };
                function init$24() {
                    this.R = this.a;
                }
                function forward$23(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var dlon = adjust_lon(lon - this.long0);
                    var x, y;
                    if (Math.abs(lat) <= EPSLN) {
                        x = this.x0 + this.R * dlon;
                        y = this.y0;
                    }
                    var theta = asinz(2 * Math.abs(lat / Math.PI));
                    if (Math.abs(dlon) <= EPSLN || Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {
                        x = this.x0;
                        if (lat >= 0) {
                            y = this.y0 + Math.PI * this.R * Math.tan(0.5 * theta);
                        } else {
                            y = this.y0 + Math.PI * this.R * -Math.tan(0.5 * theta);
                        }
                    }
                    var al = 0.5 * Math.abs(Math.PI / dlon - dlon / Math.PI);
                    var asq = al * al;
                    var sinth = Math.sin(theta);
                    var costh = Math.cos(theta);
                    var g = costh / (sinth + costh - 1);
                    var gsq = g * g;
                    var m = g * (2 / sinth - 1);
                    var msq = m * m;
                    var con = Math.PI * this.R * (al * (g - msq) + Math.sqrt(asq * (g - msq) * (g - msq) - (msq + asq) * (gsq - msq))) / (msq + asq);
                    if (dlon < 0) {
                        con = -con;
                    }
                    x = this.x0 + con;
                    var q = asq + g;
                    con = Math.PI * this.R * (m * q - al * Math.sqrt((msq + asq) * (asq + 1) - q * q)) / (msq + asq);
                    if (lat >= 0) {
                        y = this.y0 + con;
                    } else {
                        y = this.y0 - con;
                    }
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$23(p) {
                    var lon, lat;
                    var xx, yy, xys, c1, c2, c3;
                    var a1;
                    var m1;
                    var con;
                    var th1;
                    var d;
                    p.x -= this.x0;
                    p.y -= this.y0;
                    con = Math.PI * this.R;
                    xx = p.x / con;
                    yy = p.y / con;
                    xys = xx * xx + yy * yy;
                    c1 = -Math.abs(yy) * (1 + xys);
                    c2 = c1 - 2 * yy * yy + xx * xx;
                    c3 = -2 * c1 + 1 + 2 * yy * yy + xys * xys;
                    d = yy * yy / c3 + (2 * c2 * c2 * c2 / c3 / c3 / c3 - 9 * c1 * c2 / c3 / c3) / 27;
                    a1 = (c1 - c2 * c2 / 3 / c3) / c3;
                    m1 = 2 * Math.sqrt(-a1 / 3);
                    con = 3 * d / a1 / m1;
                    if (Math.abs(con) > 1) {
                        if (con >= 0) {
                            con = 1;
                        } else {
                            con = -1;
                        }
                    }
                    th1 = Math.acos(con) / 3;
                    if (p.y >= 0) {
                        lat = (-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;
                    } else {
                        lat = -(-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;
                    }
                    if (Math.abs(xx) < EPSLN) {
                        lon = this.long0;
                    } else {
                        lon = adjust_lon(this.long0 + Math.PI * (xys - 1 + Math.sqrt(1 + 2 * (xx * xx - yy * yy) + xys * xys)) / 2 / xx);
                    }
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$25 = [
                    'Van_der_Grinten_I',
                    'VanDerGrinten',
                    'vandg'
                ];
                var vandg = {
                    init: init$24,
                    forward: forward$23,
                    inverse: inverse$23,
                    names: names$25
                };
                function init$25() {
                    this.sin_p12 = Math.sin(this.lat0);
                    this.cos_p12 = Math.cos(this.lat0);
                }
                function forward$24(p) {
                    var lon = p.x;
                    var lat = p.y;
                    var sinphi = Math.sin(p.y);
                    var cosphi = Math.cos(p.y);
                    var dlon = adjust_lon(lon - this.long0);
                    var e0, e1, e2, e3, Mlp, Ml, tanphi, Nl1, Nl, psi, Az, G, H, GH, Hs, c, kp, cos_c, s, s2, s3, s4, s5;
                    if (this.sphere) {
                        if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
                            p.x = this.x0 + this.a * (HALF_PI - lat) * Math.sin(dlon);
                            p.y = this.y0 - this.a * (HALF_PI - lat) * Math.cos(dlon);
                            return p;
                        } else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
                            p.x = this.x0 + this.a * (HALF_PI + lat) * Math.sin(dlon);
                            p.y = this.y0 + this.a * (HALF_PI + lat) * Math.cos(dlon);
                            return p;
                        } else {
                            cos_c = this.sin_p12 * sinphi + this.cos_p12 * cosphi * Math.cos(dlon);
                            c = Math.acos(cos_c);
                            kp = c / Math.sin(c);
                            p.x = this.x0 + this.a * kp * cosphi * Math.sin(dlon);
                            p.y = this.y0 + this.a * kp * (this.cos_p12 * sinphi - this.sin_p12 * cosphi * Math.cos(dlon));
                            return p;
                        }
                    } else {
                        e0 = e0fn(this.es);
                        e1 = e1fn(this.es);
                        e2 = e2fn(this.es);
                        e3 = e3fn(this.es);
                        if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
                            Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
                            Ml = this.a * mlfn(e0, e1, e2, e3, lat);
                            p.x = this.x0 + (Mlp - Ml) * Math.sin(dlon);
                            p.y = this.y0 - (Mlp - Ml) * Math.cos(dlon);
                            return p;
                        } else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
                            Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
                            Ml = this.a * mlfn(e0, e1, e2, e3, lat);
                            p.x = this.x0 + (Mlp + Ml) * Math.sin(dlon);
                            p.y = this.y0 + (Mlp + Ml) * Math.cos(dlon);
                            return p;
                        } else {
                            tanphi = sinphi / cosphi;
                            Nl1 = gN(this.a, this.e, this.sin_p12);
                            Nl = gN(this.a, this.e, sinphi);
                            psi = Math.atan((1 - this.es) * tanphi + this.es * Nl1 * this.sin_p12 / (Nl * cosphi));
                            Az = Math.atan2(Math.sin(dlon), this.cos_p12 * Math.tan(psi) - this.sin_p12 * Math.cos(dlon));
                            if (Az === 0) {
                                s = Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));
                            } else if (Math.abs(Math.abs(Az) - Math.PI) <= EPSLN) {
                                s = -Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));
                            } else {
                                s = Math.asin(Math.sin(dlon) * Math.cos(psi) / Math.sin(Az));
                            }
                            G = this.e * this.sin_p12 / Math.sqrt(1 - this.es);
                            H = this.e * this.cos_p12 * Math.cos(Az) / Math.sqrt(1 - this.es);
                            GH = G * H;
                            Hs = H * H;
                            s2 = s * s;
                            s3 = s2 * s;
                            s4 = s3 * s;
                            s5 = s4 * s;
                            c = Nl1 * s * (1 - s2 * Hs * (1 - Hs) / 6 + s3 / 8 * GH * (1 - 2 * Hs) + s4 / 120 * (Hs * (4 - 7 * Hs) - 3 * G * G * (1 - 7 * Hs)) - s5 / 48 * GH);
                            p.x = this.x0 + c * Math.sin(Az);
                            p.y = this.y0 + c * Math.cos(Az);
                            return p;
                        }
                    }
                }
                function inverse$24(p) {
                    p.x -= this.x0;
                    p.y -= this.y0;
                    var rh, z, sinz, cosz, lon, lat, con, e0, e1, e2, e3, Mlp, M, N1, psi, Az, cosAz, tmp, A, B, D, Ee, F;
                    if (this.sphere) {
                        rh = Math.sqrt(p.x * p.x + p.y * p.y);
                        if (rh > 2 * HALF_PI * this.a) {
                            return;
                        }
                        z = rh / this.a;
                        sinz = Math.sin(z);
                        cosz = Math.cos(z);
                        lon = this.long0;
                        if (Math.abs(rh) <= EPSLN) {
                            lat = this.lat0;
                        } else {
                            lat = asinz(cosz * this.sin_p12 + p.y * sinz * this.cos_p12 / rh);
                            con = Math.abs(this.lat0) - HALF_PI;
                            if (Math.abs(con) <= EPSLN) {
                                if (this.lat0 >= 0) {
                                    lon = adjust_lon(this.long0 + Math.atan2(p.x, -p.y));
                                } else {
                                    lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));
                                }
                            } else {
                                lon = adjust_lon(this.long0 + Math.atan2(p.x * sinz, rh * this.cos_p12 * cosz - p.y * this.sin_p12 * sinz));
                            }
                        }
                        p.x = lon;
                        p.y = lat;
                        return p;
                    } else {
                        e0 = e0fn(this.es);
                        e1 = e1fn(this.es);
                        e2 = e2fn(this.es);
                        e3 = e3fn(this.es);
                        if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
                            Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
                            rh = Math.sqrt(p.x * p.x + p.y * p.y);
                            M = Mlp - rh;
                            lat = imlfn(M / this.a, e0, e1, e2, e3);
                            lon = adjust_lon(this.long0 + Math.atan2(p.x, -1 * p.y));
                            p.x = lon;
                            p.y = lat;
                            return p;
                        } else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
                            Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
                            rh = Math.sqrt(p.x * p.x + p.y * p.y);
                            M = rh - Mlp;
                            lat = imlfn(M / this.a, e0, e1, e2, e3);
                            lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));
                            p.x = lon;
                            p.y = lat;
                            return p;
                        } else {
                            rh = Math.sqrt(p.x * p.x + p.y * p.y);
                            Az = Math.atan2(p.x, p.y);
                            N1 = gN(this.a, this.e, this.sin_p12);
                            cosAz = Math.cos(Az);
                            tmp = this.e * this.cos_p12 * cosAz;
                            A = -tmp * tmp / (1 - this.es);
                            B = 3 * this.es * (1 - A) * this.sin_p12 * this.cos_p12 * cosAz / (1 - this.es);
                            D = rh / N1;
                            Ee = D - A * (1 + A) * Math.pow(D, 3) / 6 - B * (1 + 3 * A) * Math.pow(D, 4) / 24;
                            F = 1 - A * Ee * Ee / 2 - D * Ee * Ee * Ee / 6;
                            psi = Math.asin(this.sin_p12 * Math.cos(Ee) + this.cos_p12 * Math.sin(Ee) * cosAz);
                            lon = adjust_lon(this.long0 + Math.asin(Math.sin(Az) * Math.sin(Ee) / Math.cos(psi)));
                            lat = Math.atan((1 - this.es * F * this.sin_p12 / Math.sin(psi)) * Math.tan(psi) / (1 - this.es));
                            p.x = lon;
                            p.y = lat;
                            return p;
                        }
                    }
                }
                var names$26 = [
                    'Azimuthal_Equidistant',
                    'aeqd'
                ];
                var aeqd = {
                    init: init$25,
                    forward: forward$24,
                    inverse: inverse$24,
                    names: names$26
                };
                function init$26() {
                    this.sin_p14 = Math.sin(this.lat0);
                    this.cos_p14 = Math.cos(this.lat0);
                }
                function forward$25(p) {
                    var sinphi, cosphi;
                    var dlon;
                    var coslon;
                    var ksp;
                    var g, x, y;
                    var lon = p.x;
                    var lat = p.y;
                    dlon = adjust_lon(lon - this.long0);
                    sinphi = Math.sin(lat);
                    cosphi = Math.cos(lat);
                    coslon = Math.cos(dlon);
                    g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;
                    ksp = 1;
                    if (g > 0 || Math.abs(g) <= EPSLN) {
                        x = this.a * ksp * cosphi * Math.sin(dlon);
                        y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);
                    }
                    p.x = x;
                    p.y = y;
                    return p;
                }
                function inverse$25(p) {
                    var rh;
                    var z;
                    var sinz, cosz;
                    var con;
                    var lon, lat;
                    p.x -= this.x0;
                    p.y -= this.y0;
                    rh = Math.sqrt(p.x * p.x + p.y * p.y);
                    z = asinz(rh / this.a);
                    sinz = Math.sin(z);
                    cosz = Math.cos(z);
                    lon = this.long0;
                    if (Math.abs(rh) <= EPSLN) {
                        lat = this.lat0;
                        p.x = lon;
                        p.y = lat;
                        return p;
                    }
                    lat = asinz(cosz * this.sin_p14 + p.y * sinz * this.cos_p14 / rh);
                    con = Math.abs(this.lat0) - HALF_PI;
                    if (Math.abs(con) <= EPSLN) {
                        if (this.lat0 >= 0) {
                            lon = adjust_lon(this.long0 + Math.atan2(p.x, -p.y));
                        } else {
                            lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));
                        }
                        p.x = lon;
                        p.y = lat;
                        return p;
                    }
                    lon = adjust_lon(this.long0 + Math.atan2(p.x * sinz, rh * this.cos_p14 * cosz - p.y * this.sin_p14 * sinz));
                    p.x = lon;
                    p.y = lat;
                    return p;
                }
                var names$27 = ['ortho'];
                var ortho = {
                    init: init$26,
                    forward: forward$25,
                    inverse: inverse$25,
                    names: names$27
                };
                var FACE_ENUM = {
                    FRONT: 1,
                    RIGHT: 2,
                    BACK: 3,
                    LEFT: 4,
                    TOP: 5,
                    BOTTOM: 6
                };
                var AREA_ENUM = {
                    AREA_0: 1,
                    AREA_1: 2,
                    AREA_2: 3,
                    AREA_3: 4
                };
                function init$27() {
                    this.x0 = this.x0 || 0;
                    this.y0 = this.y0 || 0;
                    this.lat0 = this.lat0 || 0;
                    this.long0 = this.long0 || 0;
                    this.lat_ts = this.lat_ts || 0;
                    this.title = this.title || 'Quadrilateralized Spherical Cube';
                    if (this.lat0 >= HALF_PI - FORTPI / 2) {
                        this.face = FACE_ENUM.TOP;
                    } else if (this.lat0 <= -(HALF_PI - FORTPI / 2)) {
                        this.face = FACE_ENUM.BOTTOM;
                    } else if (Math.abs(this.long0) <= FORTPI) {
                        this.face = FACE_ENUM.FRONT;
                    } else if (Math.abs(this.long0) <= HALF_PI + FORTPI) {
                        this.face = this.long0 > 0 ? FACE_ENUM.RIGHT : FACE_ENUM.LEFT;
                    } else {
                        this.face = FACE_ENUM.BACK;
                    }
                    if (this.es !== 0) {
                        this.one_minus_f = 1 - (this.a - this.b) / this.a;
                        this.one_minus_f_squared = this.one_minus_f * this.one_minus_f;
                    }
                }
                function forward$26(p) {
                    var xy = {
                        x: 0,
                        y: 0
                    };
                    var lat, lon;
                    var theta, phi;
                    var t, mu;
                    var area = { value: 0 };
                    p.x -= this.long0;
                    if (this.es !== 0) {
                        lat = Math.atan(this.one_minus_f_squared * Math.tan(p.y));
                    } else {
                        lat = p.y;
                    }
                    lon = p.x;
                    if (this.face === FACE_ENUM.TOP) {
                        phi = HALF_PI - lat;
                        if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {
                            area.value = AREA_ENUM.AREA_0;
                            theta = lon - HALF_PI;
                        } else if (lon > HALF_PI + FORTPI || lon <= -(HALF_PI + FORTPI)) {
                            area.value = AREA_ENUM.AREA_1;
                            theta = lon > 0 ? lon - SPI : lon + SPI;
                        } else if (lon > -(HALF_PI + FORTPI) && lon <= -FORTPI) {
                            area.value = AREA_ENUM.AREA_2;
                            theta = lon + HALF_PI;
                        } else {
                            area.value = AREA_ENUM.AREA_3;
                            theta = lon;
                        }
                    } else if (this.face === FACE_ENUM.BOTTOM) {
                        phi = HALF_PI + lat;
                        if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {
                            area.value = AREA_ENUM.AREA_0;
                            theta = -lon + HALF_PI;
                        } else if (lon < FORTPI && lon >= -FORTPI) {
                            area.value = AREA_ENUM.AREA_1;
                            theta = -lon;
                        } else if (lon < -FORTPI && lon >= -(HALF_PI + FORTPI)) {
                            area.value = AREA_ENUM.AREA_2;
                            theta = -lon - HALF_PI;
                        } else {
                            area.value = AREA_ENUM.AREA_3;
                            theta = lon > 0 ? -lon + SPI : -lon - SPI;
                        }
                    } else {
                        var q, r, s;
                        var sinlat, coslat;
                        var sinlon, coslon;
                        if (this.face === FACE_ENUM.RIGHT) {
                            lon = qsc_shift_lon_origin(lon, +HALF_PI);
                        } else if (this.face === FACE_ENUM.BACK) {
                            lon = qsc_shift_lon_origin(lon, +SPI);
                        } else if (this.face === FACE_ENUM.LEFT) {
                            lon = qsc_shift_lon_origin(lon, -HALF_PI);
                        }
                        sinlat = Math.sin(lat);
                        coslat = Math.cos(lat);
                        sinlon = Math.sin(lon);
                        coslon = Math.cos(lon);
                        q = coslat * coslon;
                        r = coslat * sinlon;
                        s = sinlat;
                        if (this.face === FACE_ENUM.FRONT) {
                            phi = Math.acos(q);
                            theta = qsc_fwd_equat_face_theta(phi, s, r, area);
                        } else if (this.face === FACE_ENUM.RIGHT) {
                            phi = Math.acos(r);
                            theta = qsc_fwd_equat_face_theta(phi, s, -q, area);
                        } else if (this.face === FACE_ENUM.BACK) {
                            phi = Math.acos(-q);
                            theta = qsc_fwd_equat_face_theta(phi, s, -r, area);
                        } else if (this.face === FACE_ENUM.LEFT) {
                            phi = Math.acos(-r);
                            theta = qsc_fwd_equat_face_theta(phi, s, q, area);
                        } else {
                            phi = theta = 0;
                            area.value = AREA_ENUM.AREA_0;
                        }
                    }
                    mu = Math.atan(12 / SPI * (theta + Math.acos(Math.sin(theta) * Math.cos(FORTPI)) - HALF_PI));
                    t = Math.sqrt((1 - Math.cos(phi)) / (Math.cos(mu) * Math.cos(mu)) / (1 - Math.cos(Math.atan(1 / Math.cos(theta)))));
                    if (area.value === AREA_ENUM.AREA_1) {
                        mu += HALF_PI;
                    } else if (area.value === AREA_ENUM.AREA_2) {
                        mu += SPI;
                    } else if (area.value === AREA_ENUM.AREA_3) {
                        mu += 1.5 * SPI;
                    }
                    xy.x = t * Math.cos(mu);
                    xy.y = t * Math.sin(mu);
                    xy.x = xy.x * this.a + this.x0;
                    xy.y = xy.y * this.a + this.y0;
                    p.x = xy.x;
                    p.y = xy.y;
                    return p;
                }
                function inverse$26(p) {
                    var lp = {
                        lam: 0,
                        phi: 0
                    };
                    var mu, nu, cosmu, tannu;
                    var tantheta, theta, cosphi, phi;
                    var t;
                    var area = { value: 0 };
                    p.x = (p.x - this.x0) / this.a;
                    p.y = (p.y - this.y0) / this.a;
                    nu = Math.atan(Math.sqrt(p.x * p.x + p.y * p.y));
                    mu = Math.atan2(p.y, p.x);
                    if (p.x >= 0 && p.x >= Math.abs(p.y)) {
                        area.value = AREA_ENUM.AREA_0;
                    } else if (p.y >= 0 && p.y >= Math.abs(p.x)) {
                        area.value = AREA_ENUM.AREA_1;
                        mu -= HALF_PI;
                    } else if (p.x < 0 && -p.x >= Math.abs(p.y)) {
                        area.value = AREA_ENUM.AREA_2;
                        mu = mu < 0 ? mu + SPI : mu - SPI;
                    } else {
                        area.value = AREA_ENUM.AREA_3;
                        mu += HALF_PI;
                    }
                    t = SPI / 12 * Math.tan(mu);
                    tantheta = Math.sin(t) / (Math.cos(t) - 1 / Math.sqrt(2));
                    theta = Math.atan(tantheta);
                    cosmu = Math.cos(mu);
                    tannu = Math.tan(nu);
                    cosphi = 1 - cosmu * cosmu * tannu * tannu * (1 - Math.cos(Math.atan(1 / Math.cos(theta))));
                    if (cosphi < -1) {
                        cosphi = -1;
                    } else if (cosphi > +1) {
                        cosphi = +1;
                    }
                    if (this.face === FACE_ENUM.TOP) {
                        phi = Math.acos(cosphi);
                        lp.phi = HALF_PI - phi;
                        if (area.value === AREA_ENUM.AREA_0) {
                            lp.lam = theta + HALF_PI;
                        } else if (area.value === AREA_ENUM.AREA_1) {
                            lp.lam = theta < 0 ? theta + SPI : theta - SPI;
                        } else if (area.value === AREA_ENUM.AREA_2) {
                            lp.lam = theta - HALF_PI;
                        } else {
                            lp.lam = theta;
                        }
                    } else if (this.face === FACE_ENUM.BOTTOM) {
                        phi = Math.acos(cosphi);
                        lp.phi = phi - HALF_PI;
                        if (area.value === AREA_ENUM.AREA_0) {
                            lp.lam = -theta + HALF_PI;
                        } else if (area.value === AREA_ENUM.AREA_1) {
                            lp.lam = -theta;
                        } else if (area.value === AREA_ENUM.AREA_2) {
                            lp.lam = -theta - HALF_PI;
                        } else {
                            lp.lam = theta < 0 ? -theta - SPI : -theta + SPI;
                        }
                    } else {
                        var q, r, s;
                        q = cosphi;
                        t = q * q;
                        if (t >= 1) {
                            s = 0;
                        } else {
                            s = Math.sqrt(1 - t) * Math.sin(theta);
                        }
                        t += s * s;
                        if (t >= 1) {
                            r = 0;
                        } else {
                            r = Math.sqrt(1 - t);
                        }
                        if (area.value === AREA_ENUM.AREA_1) {
                            t = r;
                            r = -s;
                            s = t;
                        } else if (area.value === AREA_ENUM.AREA_2) {
                            r = -r;
                            s = -s;
                        } else if (area.value === AREA_ENUM.AREA_3) {
                            t = r;
                            r = s;
                            s = -t;
                        }
                        if (this.face === FACE_ENUM.RIGHT) {
                            t = q;
                            q = -r;
                            r = t;
                        } else if (this.face === FACE_ENUM.BACK) {
                            q = -q;
                            r = -r;
                        } else if (this.face === FACE_ENUM.LEFT) {
                            t = q;
                            q = r;
                            r = -t;
                        }
                        lp.phi = Math.acos(-s) - HALF_PI;
                        lp.lam = Math.atan2(r, q);
                        if (this.face === FACE_ENUM.RIGHT) {
                            lp.lam = qsc_shift_lon_origin(lp.lam, -HALF_PI);
                        } else if (this.face === FACE_ENUM.BACK) {
                            lp.lam = qsc_shift_lon_origin(lp.lam, -SPI);
                        } else if (this.face === FACE_ENUM.LEFT) {
                            lp.lam = qsc_shift_lon_origin(lp.lam, +HALF_PI);
                        }
                    }
                    if (this.es !== 0) {
                        var invert_sign;
                        var tanphi, xa;
                        invert_sign = lp.phi < 0 ? 1 : 0;
                        tanphi = Math.tan(lp.phi);
                        xa = this.b / Math.sqrt(tanphi * tanphi + this.one_minus_f_squared);
                        lp.phi = Math.atan(Math.sqrt(this.a * this.a - xa * xa) / (this.one_minus_f * xa));
                        if (invert_sign) {
                            lp.phi = -lp.phi;
                        }
                    }
                    lp.lam += this.long0;
                    p.x = lp.lam;
                    p.y = lp.phi;
                    return p;
                }
                function qsc_fwd_equat_face_theta(phi, y, x, area) {
                    var theta;
                    if (phi < EPSLN) {
                        area.value = AREA_ENUM.AREA_0;
                        theta = 0;
                    } else {
                        theta = Math.atan2(y, x);
                        if (Math.abs(theta) <= FORTPI) {
                            area.value = AREA_ENUM.AREA_0;
                        } else if (theta > FORTPI && theta <= HALF_PI + FORTPI) {
                            area.value = AREA_ENUM.AREA_1;
                            theta -= HALF_PI;
                        } else if (theta > HALF_PI + FORTPI || theta <= -(HALF_PI + FORTPI)) {
                            area.value = AREA_ENUM.AREA_2;
                            theta = theta >= 0 ? theta - SPI : theta + SPI;
                        } else {
                            area.value = AREA_ENUM.AREA_3;
                            theta += HALF_PI;
                        }
                    }
                    return theta;
                }
                function qsc_shift_lon_origin(lon, offset) {
                    var slon = lon + offset;
                    if (slon < -SPI) {
                        slon += TWO_PI;
                    } else if (slon > +SPI) {
                        slon -= TWO_PI;
                    }
                    return slon;
                }
                var names$28 = [
                    'Quadrilateralized Spherical Cube',
                    'Quadrilateralized_Spherical_Cube',
                    'qsc'
                ];
                var qsc = {
                    init: init$27,
                    forward: forward$26,
                    inverse: inverse$26,
                    names: names$28
                };
                var includedProjections = function (proj4) {
                    proj4.Proj.projections.add(tmerc);
                    proj4.Proj.projections.add(etmerc);
                    proj4.Proj.projections.add(utm);
                    proj4.Proj.projections.add(sterea);
                    proj4.Proj.projections.add(stere);
                    proj4.Proj.projections.add(somerc);
                    proj4.Proj.projections.add(omerc);
                    proj4.Proj.projections.add(lcc);
                    proj4.Proj.projections.add(krovak);
                    proj4.Proj.projections.add(cass);
                    proj4.Proj.projections.add(laea);
                    proj4.Proj.projections.add(aea);
                    proj4.Proj.projections.add(gnom);
                    proj4.Proj.projections.add(cea);
                    proj4.Proj.projections.add(eqc);
                    proj4.Proj.projections.add(poly);
                    proj4.Proj.projections.add(nzmg);
                    proj4.Proj.projections.add(mill);
                    proj4.Proj.projections.add(sinu);
                    proj4.Proj.projections.add(moll);
                    proj4.Proj.projections.add(eqdc);
                    proj4.Proj.projections.add(vandg);
                    proj4.Proj.projections.add(aeqd);
                    proj4.Proj.projections.add(ortho);
                    proj4.Proj.projections.add(qsc);
                };
                proj4$1.defaultDatum = 'WGS84';
                proj4$1.Proj = Projection$1;
                proj4$1.WGS84 = new proj4$1.Proj('WGS84');
                proj4$1.Point = Point;
                proj4$1.toPoint = toPoint;
                proj4$1.defs = defs;
                proj4$1.transform = transform;
                proj4$1.mgrs = mgrs;
                proj4$1.version = version;
                includedProjections(proj4$1);
                return proj4$1;
            }));
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            (function (global) {
                Object.defineProperty(exports, '__esModule', { value: true });
                var Config = {
                    configuration: null,
                    isConfigLoaded: function isConfigLoaded() {
                        var scope = typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : typeof global !== 'undefined' ? global : {};
                        if (scope.Gp && scope.Gp.Config && Object.keys(scope.Gp.Config).length !== 0) {
                            this.configuration = scope.Gp.Config;
                            return true;
                        }
                        return false;
                    },
                    getLayerId: function getLayerId(layerName, service) {
                        var layerId = null;
                        if (this.configuration) {
                            var layers = this.configuration['layers'];
                            for (var key in layers) {
                                if (layers.hasOwnProperty(key)) {
                                    var parts = key.split('$');
                                    if (layerName === parts[0]) {
                                        if (parts[1]) {
                                            var servicePartsLayer = parts[1].split(':');
                                            var servicePartsService = parts[1].split(';');
                                            if (servicePartsService[1] === service) {
                                                layerId = key;
                                                break;
                                            }
                                            if (servicePartsLayer[2] === service) {
                                                layerId = key;
                                                break;
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        if (!layerId) {
                            console.log('ERROR layer id (layer name: ' + layerName + ' / service: ' + service + ') was not found !?');
                        }
                        return layerId;
                    },
                    getLayerParams: function getLayerParams(layerName, service, apiKey) {
                        var params = {};
                        if (this.configuration) {
                            var layerId = this.getLayerId(layerName, service);
                            if (layerId) {
                                var layerConf = this.configuration.layers[layerId];
                                var key = layerConf.apiKeys[0];
                                if (apiKey) {
                                    if (apiKey !== key) {
                                        console.log('ERROR different keys (' + apiKey + ' !== ' + key + ') !?');
                                        return;
                                    }
                                }
                                apiKey = apiKey || key;
                                params.key = apiKey;
                                params.url = layerConf.getServerUrl(apiKey);
                                params.version = layerConf.getServiceParams().version;
                                params.styles = layerConf.getDefaultStyle();
                                params.format = layerConf.getDefaultFormat();
                                params.projection = layerConf.getDefaultProjection();
                                params.minScale = layerConf.getMinScaleDenominator();
                                params.maxScale = layerConf.getMaxScaleDenominator();
                                params.extent = layerConf.getBBOX();
                                params.legends = layerConf.getLegends();
                                params.metadata = layerConf.getMetadata();
                                params.originators = layerConf.getOriginators();
                                params.title = layerConf.getTitle();
                                params.description = layerConf.getDescription();
                                params.quicklookUrl = layerConf.getQuicklookUrl();
                                if (layerConf.wmtsOptions) {
                                    params.tileMatrixSetLimits = layerConf.wmtsOptions.tileMatrixSetLimits;
                                }
                                var TMSLink = layerConf.getTMSID();
                                if (TMSLink) {
                                    params.TMSLink = TMSLink;
                                    var tmsConf = this.configuration.getTMSConf(TMSLink);
                                    params.matrixOrigin = tmsConf.getTopLeftCorner();
                                    params.nativeResolutions = tmsConf.nativeResolutions;
                                    params.matrixIds = tmsConf.matrixIds;
                                    params.tileMatrices = tmsConf.tileMatrices;
                                }
                            }
                        }
                        return params;
                    },
                    getServiceParams: function getServiceParams(resource, service, apiKey) {
                        var params = {};
                        if (this.configuration) {
                            var layerId = this.getLayerId(resource, service);
                            if (layerId) {
                                var layerConf = this.configuration.layers[layerId];
                                var key = layerConf.apiKeys[0];
                                if (apiKey) {
                                    if (apiKey !== key) {
                                        return;
                                    }
                                }
                                apiKey = apiKey || key;
                                params.key = apiKey;
                                params.url = layerConf.getServerUrl(apiKey);
                                params.version = layerConf.getServiceParams().version;
                                params.extent = layerConf.getBBOX();
                                params.title = layerConf.getTitle();
                                params.description = layerConf.getDescription();
                            }
                        }
                        return params;
                    },
                    getResolutions: function getResolutions() {
                        var resolutions = [];
                        if (this.configuration) {
                            resolutions = this.configuration['generalOptions']['wgs84Resolutions'];
                        }
                        return resolutions;
                    },
                    getTileMatrix: function getTileMatrix(tmsName) {
                        var tms = {};
                        if (this.configuration) {
                            if (tmsName) {
                                tms = this.configuration['tileMatrixSets'][tmsName.toUpperCase()];
                            }
                        }
                        return tms;
                    },
                    getGlobalConstraints: function getGlobalConstraints(layerId) {
                        var params = {};
                        if (layerId) {
                            var layerConf = this.configuration.layers[layerId];
                            params.projection = layerConf.getDefaultProjection();
                            params.minScale = layerConf.getMinScaleDenominator();
                            params.maxScale = layerConf.getMaxScaleDenominator();
                            params.extent = layerConf.getBBOX();
                        }
                        return params;
                    }
                };
                exports.default = Config;
            }.call(exports, __webpack_require__(75)));
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            function Widget(options) {
                this.name = null;
                this._element = null;
                this._target = null;
                this._globe = null;
                this.setOptions(options);
            }
            Widget.prototype.constructor = Widget;
            Widget.prototype.getElement = function getElement() {
                return this._element;
            };
            Widget.prototype.setTarget = function setTarget(targetDiv, position) {
                if (!targetDiv) {
                    return;
                }
                if (position && position !== 'absolute' && position !== 'relative') {
                    console.log('[ERROR] Widget:setTarget - position value should be \'absolute\' or \'relative\'');
                    return;
                }
                if (this._target && this._element) {
                    this._target.removeChild(this._element);
                }
                this._target = targetDiv;
                if (!this._element) {
                    console.log('[ERROR] Widget:setTarget - widget element not created');
                    return;
                }
                this._element.style.position = position || 'relative';
                targetDiv.appendChild(this._element);
            };
            Widget.prototype.getTarget = function getTarget() {
                return this._target;
            };
            Widget.prototype.setOptions = function setOptions(options) {
                this.name = options.name;
                this._element = options.element;
                this.setTarget(options.target, options.position);
            };
            Widget.prototype.getGlobe = function getGlobe() {
                return this._globe;
            };
            Widget.prototype.setGlobe = function setGlobe(globe) {
                this._globe = globe;
            };
            exports.default = Widget;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _LayerSwitcherDOM = __webpack_require__(36);
            var _LayerSwitcherDOM2 = _interopRequireDefault(_LayerSwitcherDOM);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function LayerSwitcher(lsOptions) {
                lsOptions = lsOptions || {};
                var options = lsOptions.options || {};
                var layers = lsOptions.layers || [];
                if (!(this instanceof LayerSwitcher)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (layers && !Array.isArray(layers)) {
                    throw new Error('ERROR WRONG_TYPE : layers should be an array');
                }
                if (options && (typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {
                    throw new Error('ERROR WRONG_TYPE : options should be an object');
                }
                this._initialize(options, layers);
                var container = this._initContainer(options);
                _ol2.default.control.Control.call(this, {
                    element: container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(LayerSwitcher, _ol2.default.control.Control);
            LayerSwitcher.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(LayerSwitcher.prototype, _LayerSwitcherDOM2.default);
            LayerSwitcher.prototype.constructor = LayerSwitcher;
            LayerSwitcher.prototype.setMap = function (map) {
                if (map) {
                    this._addMapLayers(map);
                    this._listeners.onMoveListener = map.on('moveend', function () {
                        this._onMapMoveEnd.call(this, map);
                    }, this);
                    this._listeners.onAddListener = map.getLayers().on('add', function (evt) {
                        var layer = evt.element;
                        var id;
                        if (!layer.hasOwnProperty('gpLayerId')) {
                            id = this._layerId;
                            layer.gpLayerId = id;
                            this._layerId++;
                        } else {
                            id = layer.gpLayerId;
                        }
                        if (!this._layers[id]) {
                            this.addLayer(layer);
                        }
                    }, this);
                    this._listeners.onRemoveListener = map.getLayers().on('remove', function (evt) {
                        var layer = evt.element;
                        var id = layer.gpLayerId;
                        if (this._layers[id]) {
                            this.removeLayer(layer);
                        }
                    }, this);
                } else {
                    _ol2.default.Observable.unByKey(this._listeners.onMoveListener);
                    _ol2.default.Observable.unByKey(this._listeners.onAddListener);
                    _ol2.default.Observable.unByKey(this._listeners.onRemoveListener);
                    for (var i = this._layersOrder.length - 1; i >= 0; i--) {
                        this._layersOrder[i].layer.setZIndex(0);
                    }
                }
                _ol2.default.control.Control.prototype.setMap.call(this, map);
            };
            LayerSwitcher.prototype.addLayer = function (layer, config) {
                var map = this.getMap();
                config = config || {};
                if (!layer) {
                    console.log('[ERROR] LayerSwitcher:addLayer - missing layer parameter');
                    return;
                }
                var id = layer.gpLayerId;
                if (id === 'undefined') {
                    console.log('[ERROR] LayerSwitcher:addLayer - configuration cannot be set for ' + layer + ' layer (layer id not found)');
                    return;
                }
                var isLayerInMap = false;
                map.getLayers().forEach(function (lyr) {
                    if (lyr.gpLayerId === id) {
                        isLayerInMap = true;
                    }
                }, this);
                if (!isLayerInMap) {
                    console.log('[ERROR] LayerSwitcher:addLayer - configuration cannot be set for ', layer, ' layer (layer is not in map.getLayers() )');
                    return;
                }
                if (!this._layers[id]) {
                    var layerInfos = this.getLayerInfo(layer) || {};
                    var opacity = layer.getOpacity();
                    var visibility = layer.getVisible();
                    var isInRange = this.isInRange(layer, map);
                    var layerOptions = {
                        layer: layer,
                        id: id,
                        opacity: opacity != null ? opacity : 1,
                        visibility: visibility != null ? visibility : true,
                        inRange: isInRange != null ? isInRange : true,
                        title: config.title != null ? config.title : layerInfos._title || id,
                        description: config.description || layerInfos._description || null,
                        legends: config.legends || layerInfos._legends || [],
                        metadata: config.metadata || layerInfos._metadata || [],
                        quicklookUrl: config.quicklookUrl || layerInfos._quicklookUrl || null
                    };
                    this._layers[id] = layerOptions;
                    var layerDiv = this._createLayerDiv(layerOptions);
                    this._layers[id].div = layerDiv;
                    if (layer.getZIndex && layer.getZIndex() !== 0 || layer._forceNullzIndex) {
                        this._updateLayersOrder(map);
                    } else {
                        this._layersOrder.unshift(layerOptions);
                        this._lastZIndex++;
                        layer.setZIndex(this._lastZIndex);
                        this._layerListContainer.insertBefore(layerDiv, this._layerListContainer.firstChild);
                    }
                    layer.on('change:opacity', this._updateLayerOpacity, this);
                    layer.on('change:visible', this._updateLayerVisibility, this);
                    var context = this;
                    var updateLayersOrder = function updateLayersOrder(e) {
                        context._updateLayersOrder.call(context, e);
                    };
                    if (this._layers[id].onZIndexChangeEvent == null) {
                        this._layers[id].onZIndexChangeEvent = layer.on('change:zIndex', updateLayersOrder);
                    }
                } else if (this._layers[id] && config) {
                    for (var prop in config) {
                        if (config.hasOwnProperty(prop)) {
                            this._layers[id][prop] = config[prop];
                        }
                    }
                    if (config.title) {
                        var nameDiv = document.getElementById(this._addUID('GPname_ID_' + id));
                        if (nameDiv) {
                            nameDiv.innerHTML = config.title;
                            nameDiv.title = config.description || config.title;
                        }
                    }
                    var infodiv = document.getElementById(this._addUID('GPinfo_ID_' + id));
                    if (!document.getElementById(this._addUID('GPinfo_ID_' + id)) && config.description) {
                        var advancedTools = document.getElementById(this._addUID('GPadvancedTools_ID_' + id));
                        if (advancedTools) {
                            advancedTools.appendChild(this._createAdvancedToolInformationElement({ id: id }));
                        }
                    }
                    if (infodiv && infodiv.className === 'GPlayerInfoOpened') {
                        document.getElementById(this._addUID('GPlayerInfoPanel')).className = 'GPlayerInfoPanelClosed';
                        infodiv.className === 'GPlayerInfo';
                    }
                }
            };
            LayerSwitcher.prototype.removeLayer = function (layer) {
                var layerID = layer.gpLayerId;
                var layerList = document.getElementById(this._addUID('GPlayersList'));
                var infodiv = document.getElementById(this._addUID('GPinfo_ID_' + layerID));
                if (infodiv && infodiv.className === 'GPlayerInfoOpened') {
                    document.getElementById(this._addUID('GPlayerInfoPanel')).className = 'GPlayerInfoPanelClosed';
                    infodiv.className === 'GPlayerInfo';
                }
                var layerDiv = document.getElementById(this._addUID('GPlayerSwitcher_ID_' + layerID));
                layerList.removeChild(layerDiv);
                var layerIndex = Math.abs(layer.getZIndex() - this._lastZIndex);
                this._layersOrder.splice(layerIndex, 1);
                this._lastZIndex--;
                var layerOrderTemp = this._layersOrder;
                for (var i = 0; i < layerOrderTemp.length; i++) {
                    layerOrderTemp[i].layer.setZIndex(this._lastZIndex - i);
                }
                delete this._layers[layerID];
            };
            LayerSwitcher.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] LayerSwitcher:setCollapsed - missing collapsed parameter');
                    return;
                }
                var isCollapsed = !document.getElementById(this._addUID('GPshowLayersList')).checked;
                if (collapsed && isCollapsed || !collapsed && !isCollapsed) {
                    return;
                }
                if (!isCollapsed) {
                    var layers = document.getElementsByClassName('GPlayerInfoOpened');
                    for (var i = 0; i < layers.length; i++) {
                        layers[i].className = 'GPlayerInfo';
                    }
                    document.getElementById(this._addUID('GPlayerInfoPanel')).className = 'GPlayerInfoPanelClosed';
                }
                document.getElementById(this._addUID('GPshowLayersList')).checked = !collapsed;
            };
            LayerSwitcher.prototype.getCollapsed = function () {
                return this.collapsed;
            };
            LayerSwitcher.prototype.setRemovable = function (layer, removable) {
                if (!layer) {
                    return;
                }
                var layerID = layer.gpLayerId;
                if (layerID == null) {
                    console.log('[LayerSwitcher:setRemovable] layer should be added to map before calling setRemovable method');
                    return;
                }
                var removalDiv = document.getElementById(this._addUID('GPremove_ID_' + layerID));
                console.log(removalDiv.style.display);
                if (removalDiv) {
                    if (removable === false) {
                        removalDiv.style.display = 'none';
                    } else if (removable === true) {
                        removalDiv.style.display = 'block';
                    } else {
                    }
                }
            };
            LayerSwitcher.prototype._initialize = function (options, layers) {
                this._uid = _SelectorID2.default.generate();
                this._layers = {};
                this._layersOrder = [];
                this._layersIndex = {};
                this._lastZIndex = 0;
                this._layerId = 0;
                this.collapsed = options.collapsed !== undefined ? options.collapsed : true;
                this._layerListContainer = null;
                this._listeners = {};
                for (var i = 0; i < layers.length; i++) {
                    var layer = layers[i].layer;
                    if (layer) {
                        var id;
                        if (!layer.hasOwnProperty('gpLayerId')) {
                            id = this._layerId;
                            layer.gpLayerId = id;
                            this._layerId++;
                        } else {
                            id = layer.gpLayerId;
                        }
                        var conf = layers[i].config || {};
                        var opacity = layer.getOpacity();
                        var visibility = layer.getVisible();
                        var layerOptions = {
                            layer: layer,
                            id: id,
                            opacity: opacity != null ? opacity : 1,
                            visibility: visibility != null ? visibility : true,
                            title: conf.title != null ? conf.title : id,
                            description: conf.description || null,
                            legends: conf.legends || [],
                            metadata: conf.metadata || [],
                            quicklookUrl: conf.quicklookUrl || null
                        };
                        this._layers[id] = layerOptions;
                    }
                }
            };
            LayerSwitcher.prototype._initContainer = function () {
                var container = this._createMainContainerElement();
                var input = this._createMainLayersShowElement();
                container.appendChild(input);
                if (!this.collapsed) {
                    input.checked = 'checked';
                    this.collapsed = false;
                } else {
                    this.collapsed = true;
                }
                var context = this;
                var changeCollapsed = function changeCollapsed(e) {
                    this.collapsed = !e.target.checked;
                    this.dispatchEvent('change:collapsed');
                };
                input.addEventListener('click', function (e) {
                    changeCollapsed.call(context, e);
                });
                var divL = this._layerListContainer = this._createMainLayersElement();
                container.appendChild(divL);
                this._createDraggableElement(divL, this);
                var picto = this._createMainPictoElement();
                container.appendChild(picto);
                var divI = this._createMainInfoElement();
                container.appendChild(divI);
                return container;
            };
            LayerSwitcher.prototype._addMapLayers = function (map) {
                this._layersIndex = {};
                var context = this;
                map.getLayers().forEach(function (layer) {
                    var id;
                    if (!layer.hasOwnProperty('gpLayerId')) {
                        id = this._layerId;
                        layer.gpLayerId = id;
                        this._layerId++;
                    } else {
                        id = layer.gpLayerId;
                    }
                    var layerInfos = this.getLayerInfo(layer) || {};
                    if (!this._layers[id]) {
                        var opacity = layer.getOpacity();
                        var visibility = layer.getVisible();
                        var isInRange = this.isInRange(layer, map);
                        var layerOptions = {
                            layer: layer,
                            id: id,
                            opacity: opacity != null ? opacity : 1,
                            visibility: visibility != null ? visibility : true,
                            inRange: isInRange != null ? isInRange : true,
                            title: layerInfos._title || id,
                            description: layerInfos._description || null,
                            legends: layerInfos._legends || [],
                            metadata: layerInfos._metadata || [],
                            quicklookUrl: layerInfos._quicklookUrl || null
                        };
                        this._layers[id] = layerOptions;
                    } else {
                        this._layers[id].opacity = layer.getOpacity();
                        this._layers[id].visibility = layer.getVisible();
                        this._layers[id].inRange = this.isInRange(layer, map);
                    }
                    layer.on('change:opacity', this._updateLayerOpacity, this);
                    layer.on('change:visible', this._updateLayerVisibility, this);
                    var layerIndex = null;
                    if (layer.getZIndex !== undefined) {
                        layerIndex = layer.getZIndex();
                        if (!this._layersIndex[layerIndex] || !Array.isArray(this._layersIndex[layerIndex])) {
                            this._layersIndex[layerIndex] = [];
                        }
                        this._layersIndex[layerIndex].push(this._layers[id]);
                    }
                }, this);
                var updateLayersOrder = function updateLayersOrder(e) {
                    context._updateLayersOrder.call(context, e);
                };
                for (var zindex in this._layersIndex) {
                    if (this._layersIndex.hasOwnProperty(zindex)) {
                        var layers = this._layersIndex[zindex];
                        for (var l = 0; l < layers.length; l++) {
                            this._layersOrder.unshift(layers[l]);
                            this._lastZIndex++;
                            layers[l].layer.setZIndex(this._lastZIndex);
                            if (this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent == null) {
                                this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent = layers[l].layer.on('change:zIndex', updateLayersOrder);
                            }
                        }
                    }
                }
                for (var j = 0; j < this._layersOrder.length; j++) {
                    var layerOptions = this._layersOrder[j];
                    var layerDiv = this._createLayerDiv(layerOptions);
                    this._layerListContainer.appendChild(layerDiv);
                    this._layers[layerOptions.id].div = layerDiv;
                }
            };
            LayerSwitcher.prototype._createLayerDiv = function (layerOptions) {
                var isLegends = layerOptions.legends && layerOptions.legends.length !== 0;
                var isMetadata = layerOptions.metadata && layerOptions.metadata.length !== 0;
                var isQuicklookUrl = layerOptions.quicklookUrl;
                if (isLegends || isMetadata || isQuicklookUrl) {
                    layerOptions.displayInformationElement = true;
                }
                var layerDiv = this._createContainerLayerElement(layerOptions);
                if (!layerOptions.inRange) {
                    layerDiv.classList.add('outOfRange');
                }
                return layerDiv;
            };
            LayerSwitcher.prototype._onChangeLayerOpacity = function (e) {
                var divId = e.target.id;
                var layerID = _SelectorID2.default.index(divId);
                var layer = this._layers[layerID].layer;
                var opacityValue = e.target.value;
                var opacityId = document.getElementById(this._addUID('GPopacityValue_ID_' + layerID));
                opacityId.innerHTML = opacityValue + '%';
                layer.setOpacity(opacityValue / 100);
            };
            LayerSwitcher.prototype._updateLayerOpacity = function (e) {
                var opacity = e.target.getOpacity();
                if (opacity > 1) {
                    opacity = 1;
                }
                if (opacity < 0) {
                    opacity = 0;
                }
                var id = e.target.gpLayerId;
                var layerOpacityInput = document.getElementById(this._addUID('GPopacityValueDiv_ID_' + id));
                layerOpacityInput.value = Math.round(opacity * 100);
                var layerOpacitySpan = document.getElementById(this._addUID('GPopacityValue_ID_' + id));
                layerOpacitySpan.innerHTML = Math.round(opacity * 100) + '%';
            };
            LayerSwitcher.prototype._onVisibilityLayerClick = function (e) {
                var divId = e.target.id;
                var layerID = _SelectorID2.default.index(divId);
                var layer = this._layers[layerID].layer;
                layer.setVisible(e.target.checked);
            };
            LayerSwitcher.prototype._updateLayerVisibility = function (e) {
                var visible = e.target.getVisible();
                var id = e.target.gpLayerId;
                var layerVisibilityInput = document.getElementById(this._addUID('GPvisibility_ID_' + id));
                layerVisibilityInput.checked = visible;
            };
            LayerSwitcher.prototype._updateLayersOrder = function () {
                var map = this.getMap();
                if (!map) {
                    return;
                }
                this._layersIndex = {};
                var layerIndex;
                var id;
                map.getLayers().forEach(function (layer) {
                    id = layer.gpLayerId;
                    _ol2.default.Observable.unByKey(this._layers[id].onZIndexChangeEvent);
                    this._layers[id].onZIndexChangeEvent = null;
                    layerIndex = null;
                    if (layer.getZIndex !== undefined) {
                        layerIndex = layer.getZIndex();
                        if (!this._layersIndex[layerIndex] || !Array.isArray(this._layersIndex[layerIndex])) {
                            this._layersIndex[layerIndex] = [];
                        }
                        this._layersIndex[layerIndex].push(this._layers[id]);
                    }
                }, this);
                this._lastZIndex = 0;
                var context = this;
                var updateLayersOrder = function updateLayersOrder(e) {
                    context._updateLayersOrder.call(context, e);
                };
                this._layersOrder = [];
                for (var zindex in this._layersIndex) {
                    if (this._layersIndex.hasOwnProperty(zindex)) {
                        var layers = this._layersIndex[zindex];
                        for (var l = 0; l < layers.length; l++) {
                            this._layersOrder.unshift(layers[l]);
                            this._lastZIndex++;
                            if (this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent == null) {
                                this._layers[layers[l].layer.gpLayerId].onZIndexChangeEvent = layers[l].layer.on('change:zIndex', updateLayersOrder);
                            }
                        }
                    }
                }
                if (this._layerListContainer) {
                    while (this._layerListContainer.firstChild) {
                        this._layerListContainer.removeChild(this._layerListContainer.firstChild);
                    }
                    for (var j = 0; j < this._layersOrder.length; j++) {
                        var layerOptions = this._layersOrder[j];
                        this._layerListContainer.appendChild(layerOptions.div);
                    }
                } else {
                    console.log('[ol.control.LayerSwitcher] _updateLayersOrder : layer list container not found to update layers order ?!');
                }
            };
            LayerSwitcher.prototype._onOpenLayerInfoClick = function (e) {
                var divId = e.target.id;
                var layerID = _SelectorID2.default.index(divId);
                var layerOptions = this._layers[layerID];
                var panel;
                var info;
                divId = document.getElementById(e.target.id);
                if (divId.className === 'GPlayerInfoOpened') {
                    if (divId.classList !== undefined) {
                        divId.classList.remove('GPlayerInfoOpened');
                        divId.classList.add('GPlayerInfo');
                    }
                    panel = document.getElementById(this._addUID('GPlayerInfoPanel'));
                    if (panel.classList !== undefined) {
                        panel.classList.remove('GPpanel');
                        panel.classList.remove('GPlayerInfoPanelOpened');
                        panel.classList.add('GPlayerInfoPanelClosed');
                    }
                    info = document.getElementById(this._addUID('GPlayerInfoContent'));
                    panel.removeChild(info);
                    return;
                }
                var layers = document.getElementsByClassName('GPlayerInfoOpened');
                for (var i = 0; i < layers.length; i++) {
                    layers[i].className = 'GPlayerInfo';
                }
                if (divId.classList !== undefined) {
                    divId.classList.remove('GPlayerInfo');
                    divId.classList.add('GPlayerInfoOpened');
                }
                panel = document.getElementById(this._addUID('GPlayerInfoPanel'));
                if (panel.classList !== undefined) {
                    panel.classList.add('GPpanel');
                    panel.classList.remove('GPlayerInfoPanelClosed');
                    panel.classList.add('GPlayerInfoPanelOpened');
                }
                info = document.getElementById(this._addUID('GPlayerInfoContent'));
                if (info) {
                    panel.removeChild(info);
                }
                var obj = {
                    title: layerOptions.title,
                    description: layerOptions.description,
                    quicklookUrl: layerOptions.quicklookUrl,
                    metadata: layerOptions.metadata,
                    legends: layerOptions.legends
                };
                var maxResolution = layerOptions.layer.getMaxResolution();
                if (maxResolution === Infinity) {
                    obj._maxScaleDenominator = 560000000;
                } else {
                    obj._maxScaleDenominator = Math.round(maxResolution / 0.00028);
                }
                var infoLayer = this._createContainerLayerInfoElement(obj);
                panel.appendChild(infoLayer);
            };
            LayerSwitcher.prototype._onDropLayerClick = function (e) {
                var divId = e.target.id;
                var layerID = _SelectorID2.default.index(divId);
                var layer = this._layers[layerID].layer;
                this.getMap().getLayers().remove(layer);
            };
            LayerSwitcher.prototype._onDragAndDropLayerClick = function () {
                var map = this.getMap();
                var context = this;
                var updateLayersOrder = function updateLayersOrder(e) {
                    context._updateLayersOrder.call(context, e);
                };
                var matchesLayers = document.querySelectorAll('div.GPlayerSwitcher_layer');
                var maxZIndex = matchesLayers.length;
                this._layersOrder = [];
                for (var i = 0; i < matchesLayers.length; i++) {
                    var tag = matchesLayers[i].id;
                    var id = _SelectorID2.default.index(tag);
                    var layer = this._layers[id].layer;
                    _ol2.default.Observable.unByKey(this._layers[id].onZIndexChangeEvent);
                    this._layers[id].onZIndexChangeEvent = null;
                    if (layer.setZIndex) {
                        layer.setZIndex(maxZIndex);
                        this._layersOrder.push(this._layers[id]);
                        maxZIndex--;
                    }
                    if (this._layers[id].onZIndexChangeEvent == null) {
                        this._layers[id].onZIndexChangeEvent = layer.on('change:zIndex', updateLayersOrder);
                    }
                }
                map.updateSize();
            };
            LayerSwitcher.prototype._onMapMoveEnd = function (map) {
                map.getLayers().forEach(function (layer) {
                    var id = layer.gpLayerId;
                    if (this._layers[id]) {
                        var layerOptions = this._layers[id];
                        var layerDiv;
                        if (this.isInRange(layer, map) && !layerOptions.inRange) {
                            layerOptions.inRange = true;
                            layerDiv = document.getElementById(this._addUID('GPlayerSwitcher_ID_' + id));
                            layerDiv.classList.remove('outOfRange');
                        } else if (!this.isInRange(layer, map) && layerOptions.inRange) {
                            layerOptions.inRange = false;
                            layerDiv = document.getElementById(this._addUID('GPlayerSwitcher_ID_' + id));
                            layerDiv.classList.add('outOfRange');
                        }
                    }
                }, this);
            };
            LayerSwitcher.prototype.getLayerDOMId = function (olLayer) {
                var foundId = null;
                this.getMap().getLayers().forEach(function (layer) {
                    if (layer == olLayer) {
                        foundId = layer.hasOwnProperty('gpLayerId') ? layer.gpLayerId : null;
                    }
                }, this);
                return foundId !== null ? this._addUID('GPlayerSwitcher_ID_' + foundId) : null;
            };
            LayerSwitcher.prototype.isInRange = function (layer, map) {
                if (!map) {
                    return;
                }
                var mapResolution = map.getView().getResolution();
                if (mapResolution > layer.getMaxResolution() || mapResolution < layer.getMinResolution()) {
                    return false;
                }
                var mapExtent = map.getView().calculateExtent(map.getSize());
                var layerExtent = layer.getExtent();
                if (layerExtent && !_ol2.default.extent.intersects(mapExtent, layerExtent)) {
                    return false;
                }
                return true;
            };
            LayerSwitcher.prototype.getLayerInfo = function (layer) {
                var layerInfo = {};
                if (layer.getSource !== undefined) {
                    var src = layer.getSource();
                    layerInfo._title = src._title || '';
                    layerInfo._description = src._description || '';
                    layerInfo._quicklookUrl = src._quicklookUrl || '';
                    layerInfo._metadata = src._metadata || [];
                    layerInfo._legends = src._legends || [];
                }
                return layerInfo;
            };
            exports.default = LayerSwitcher;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Interactions = __webpack_require__(19);
            var _Interactions2 = _interopRequireDefault(_Interactions);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('measures');
            var Measures = {
                DEFAULT_POINTER_STYLE: new _ol2.default.style.Circle({
                    radius: 5,
                    stroke: new _ol2.default.style.Stroke({
                        color: '#002A50',
                        width: 2
                    }),
                    fill: new _ol2.default.style.Fill({ color: 'rgba(255, 155, 0, 0.7)' })
                }),
                DEFAULT_DRAW_START_STYLE: new _ol2.default.style.Style({
                    fill: new _ol2.default.style.Fill({ color: 'rgba(0, 183, 152, 0.2)' }),
                    stroke: new _ol2.default.style.Stroke({
                        color: '#002A50',
                        lineDash: [
                            10,
                            10
                        ],
                        width: 2
                    })
                }),
                DEFAULT_DRAW_FINISH_STYLE: new _ol2.default.style.Style({
                    fill: new _ol2.default.style.Fill({ color: 'rgba(0, 183, 152, 0.3)' }),
                    stroke: new _ol2.default.style.Stroke({
                        color: '#002A50',
                        width: 3
                    })
                }),
                tools: {
                    MeasureLength: {
                        active: false,
                        instance: null
                    },
                    MeasureArea: {
                        active: false,
                        instance: null
                    },
                    MeasureAzimuth: {
                        active: false,
                        instance: null
                    }
                },
                measureDraw: null,
                measureSource: null,
                measureVector: null,
                sketch: null,
                measureTooltipElement: null,
                measureTooltip: null,
                helpTooltipElement: null,
                helpTooltip: null,
                clean: function clean() {
                    var _class = this.CLASSNAME;
                    logger.trace('[' + _class + '] deactived tool !');
                    this.clearMeasure();
                    this.clearMeasureToolTip();
                    this.removeMeasureEvents();
                    this._showContainer.checked = false;
                },
                onPointerMoveHandler: function onPointerMoveHandler(e) {
                    if (e.dragging) {
                        return;
                    }
                    var tooltipCoord = e.coordinate;
                    if (this.sketch) {
                        var output;
                        var geom = this.sketch.getGeometry();
                        output = this.format(geom);
                        if (geom.getType() === 'LineString') {
                            tooltipCoord = geom.getLastCoordinate();
                        } else if (geom.getType() === 'Polygon') {
                            tooltipCoord = geom.getInteriorPoint().getCoordinates();
                        } else {
                            return;
                        }
                        this.measureTooltipElement.innerHTML = output;
                        this.measureTooltip.setPosition(tooltipCoord);
                    }
                },
                onShowMeasureClick: function onShowMeasureClick(e, type) {
                    var self = this.CLASSNAME;
                    for (var className in this.tools) {
                        if (this.tools.hasOwnProperty(className)) {
                            var o = this.tools[className];
                            if (o.active && className !== self) {
                                o.active = false;
                                if (o.instance !== null) {
                                    o.instance.clean();
                                }
                            }
                        }
                    }
                    var map = this.getMap();
                    _Interactions2.default.unset(map, { current: 'Measures' });
                    if (!this._showContainer.checked) {
                        this.addMeasureEvents();
                        this.initMeasureInteraction();
                        this.addMeasureInteraction(type);
                        this.tools[self].active = true;
                    } else {
                        this.clearMeasure();
                        this.clearMeasureToolTip();
                        this.removeMeasureEvents();
                        this.tools[self].active = false;
                    }
                },
                clearMeasureToolTip: function clearMeasureToolTip() {
                    var map = this.getMap();
                    if (!map) {
                        return;
                    }
                    var mapContainer = map.getTargetElement();
                    var overlays = mapContainer.getElementsByClassName('ol-overlaycontainer-stopevent');
                    for (var k = 0; k < overlays.length; k++) {
                        var nodes = overlays[k];
                        var len = nodes.children.length;
                        var nodesToRemove = [];
                        for (var i = 0; i < len; i++) {
                            var node = nodes.children[i];
                            if (node.children.length !== 0) {
                                var child = node.children[0];
                                if (child.className === 'GPmeasureTooltip GPmeasureTooltip-static' || child.className === 'GPmeasureTooltip GPmeasureTooltip-measure') {
                                    nodesToRemove.push(node);
                                }
                            }
                        }
                        for (var j = 0; j < nodesToRemove.length; j++) {
                            nodes.removeChild(nodesToRemove[j]);
                        }
                    }
                },
                clearMeasure: function clearMeasure() {
                    var map = this.getMap();
                    if (this.measureVector) {
                        map.removeLayer(this.measureVector);
                        this.measureVector = null;
                    }
                    if (this.measureDraw) {
                        map.removeInteraction(this.measureDraw);
                        this.measureDraw = null;
                    }
                },
                createMeasureTooltip: function createMeasureTooltip(map) {
                    if (this.measureTooltipElement) {
                        this.measureTooltipElement.parentNode.removeChild(this.measureTooltipElement);
                    }
                    this.measureTooltipElement = document.createElement('div');
                    this.measureTooltipElement.className = 'GPmeasureTooltip GPmeasureTooltip-measure';
                    this.measureTooltip = new _ol2.default.Overlay({
                        element: this.measureTooltipElement,
                        offset: [
                            0,
                            -15
                        ],
                        positioning: 'bottom-center'
                    });
                    map.addOverlay(this.measureTooltip);
                },
                createHelpTooltip: function createHelpTooltip(map) {
                    if (this.helpTooltipElement) {
                        this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement);
                    }
                    this.helpTooltipElement = document.createElement('div');
                    this.helpTooltipElement.className = 'tooltip hidden';
                    this.helpTooltip = new _ol2.default.Overlay({
                        element: this.helpTooltipElement,
                        offset: [
                            15,
                            0
                        ],
                        positioning: 'center-left'
                    });
                    map.addOverlay(this.helpTooltip);
                },
                createStylingMeasureInteraction: function createStylingMeasureInteraction(styles) {
                    this.options.styles = styles || {};
                    logger.trace('style start', this.options.styles.start);
                    var startStyleOpts = {
                        image: Measures.DEFAULT_POINTER_STYLE,
                        fill: Measures.DEFAULT_DRAW_START_STYLE.getFill(),
                        stroke: Measures.DEFAULT_DRAW_START_STYLE.getStroke()
                    };
                    if (this.options.styles.hasOwnProperty('pointer') && this.options.styles.pointer instanceof _ol2.default.style.Image) {
                        startStyleOpts.image = this.options.styles.pointer;
                    }
                    if (this.options.styles.hasOwnProperty('start') && this.options.styles.start instanceof _ol2.default.style.Style) {
                        if (this.options.styles.start.getFill() != null) {
                            startStyleOpts.fill = this.options.styles.start.getFill();
                        }
                        if (this.options.styles.start.getStroke() != null) {
                            startStyleOpts.stroke = this.options.styles.start.getStroke();
                        }
                    }
                    this.options.styles.start = new _ol2.default.style.Style(startStyleOpts);
                    logger.trace('style finish', this.options.styles.finish);
                    var finishStyleOpts = {
                        fill: Measures.DEFAULT_DRAW_FINISH_STYLE.getFill(),
                        stroke: Measures.DEFAULT_DRAW_FINISH_STYLE.getStroke()
                    };
                    if (this.options.styles.hasOwnProperty('finish') && this.options.styles.finish instanceof _ol2.default.style.Style) {
                        if (this.options.styles.finish.getFill() != null) {
                            finishStyleOpts.fill = this.options.styles.finish.getFill();
                        }
                        if (this.options.styles.finish.getStroke() != null) {
                            finishStyleOpts.stroke = this.options.styles.finish.getStroke();
                        }
                    }
                    this.options.styles.finish = new _ol2.default.style.Style(finishStyleOpts);
                },
                addMeasureInteraction: function addMeasureInteraction(type) {
                    var map = this.getMap();
                    var self = this;
                    this.measureDraw = new _ol2.default.interaction.Draw({
                        source: this.measureSource,
                        condition: function condition(event) {
                            if (event.originalEvent.ctrlKey) {
                                if (self.sketch) {
                                    this.removeLastPoint();
                                }
                                return false;
                            }
                            return true;
                        },
                        type: type,
                        style: this.options.styles.start || Measures.DEFAULT_DRAW_START_STYLE
                    });
                    this.measureDraw.setProperties({
                        name: 'Measures',
                        source: this
                    });
                    map.addInteraction(this.measureDraw);
                    this.createMeasureTooltip(map);
                    this.measureDraw.on('drawstart', function (evt) {
                        self.sketch = evt.feature;
                    }, this);
                    this.measureDraw.on('drawend', function () {
                        if (self.sketch) {
                            var output;
                            var tooltipCoord;
                            var geom = self.sketch.getGeometry();
                            output = self.format(geom);
                            if (geom.getType() === 'LineString') {
                                tooltipCoord = geom.getLastCoordinate();
                            } else if (geom.getType() === 'Polygon') {
                                tooltipCoord = geom.getInteriorPoint().getCoordinates();
                            } else {
                                return;
                            }
                            self.measureTooltipElement.innerHTML = output;
                            self.measureTooltip.setPosition(tooltipCoord);
                        }
                        self.measureTooltipElement.className = 'GPmeasureTooltip GPmeasureTooltip-static';
                        self.measureTooltip.setOffset([
                            0,
                            -7
                        ]);
                        self.sketch = null;
                        self.measureTooltipElement = null;
                        self.createMeasureTooltip(map);
                    }, this);
                },
                initMeasureInteraction: function initMeasureInteraction() {
                    var map = this.getMap();
                    this.measureSource = new _ol2.default.source.Vector();
                    this.measureVector = new _ol2.default.layer.Vector({
                        source: this.measureSource,
                        style: this.options.styles.finish || Measures.DEFAULT_DRAW_FINISH_STYLE
                    });
                    this.measureVector.gpResultLayerId = 'measure';
                    map.addLayer(this.measureVector);
                }
            };
            exports.default = Measures;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _MeasureToolBoxDOM = __webpack_require__(109);
            var _MeasureToolBoxDOM2 = _interopRequireDefault(_MeasureToolBoxDOM);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('toolbox');
            var MeasureToolBox = {
                _toolbox: {},
                add: function add(map, ctrl) {
                    logger.trace('ToolBox.add()', ctrl);
                    if (!map) {
                        logger.trace('map doesn\'t exist !?');
                        return;
                    }
                    var mapContainer = map.getTargetElement();
                    var mapDocument = mapContainer.ownerDocument;
                    var mapId = mapContainer.id;
                    if (!this._toolbox || Object.keys(this._toolbox).length === 0) {
                        this._toolbox[mapId] = _SelectorID2.default.generate();
                    } else {
                        if (!this._toolbox[mapId]) {
                            this._toolbox[mapId] = _SelectorID2.default.generate();
                        }
                    }
                    var uid = this._toolbox[mapId];
                    if (!mapDocument.getElementById(this.getToolBoxID(uid))) {
                        logger.trace('create toolbox !');
                        var toolboxContainer = this._createToolBoxContainerElement(uid);
                        var overlaysContainer = mapContainer.getElementsByClassName('ol-overlaycontainer-stopevent');
                        overlaysContainer[0].appendChild(toolboxContainer);
                    }
                    var widgetContainer = mapDocument.getElementById(this.getWidgetID(uid));
                    ctrl.setTarget(widgetContainer);
                    logger.trace('add control to toolbox !');
                }
            };
            _Utils2.default.assign(MeasureToolBox, _MeasureToolBoxDOM2.default);
            exports.default = MeasureToolBox;
            return exports;
        },
        function (module, exports) {
            module.exports = __WEBPACK_EXTERNAL_MODULE_15__;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var ProxyUtils = {
                proxifyUrl: function proxifyUrl(url, proxyOptions) {
                    var logger = _LoggerByDefault2.default.getLogger('proxifyUrl');
                    if (!proxyOptions || !proxyOptions.hasOwnProperty('proxyUrl') || proxyOptions.proxyUrl === null || proxyOptions.proxyUrl.trim().length == 0) {
                        return url;
                    }
                    if (proxyOptions.noProxyDomains && Array.isArray(proxyOptions.noProxyDomains) && proxyOptions.noProxyDomains.length > 0) {
                        for (var i in proxyOptions.noProxyDomains) {
                            logger.trace('[ProxyUtils] proxifyUrl : analyzing ' + proxyOptions.noProxyDomains[i]);
                            if (url.indexOf(proxyOptions.noProxyDomains[i]) !== -1) {
                                logger.info('[ProxyUtils] proxifyUrl : ' + url + ' found in noProxyDomains list (' + proxyOptions.noProxyDomains[i] + ').');
                                return url;
                            }
                        }
                    }
                    return proxyOptions.proxyUrl + encodeURIComponent(url);
                }
            };
            exports.default = ProxyUtils;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _ProxyUtils = __webpack_require__(16);
            var _ProxyUtils2 = _interopRequireDefault(_ProxyUtils);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('GfiUtils');
            var GfiUtils = {
                getLayerFormat: function getLayerFormat(l) {
                    var source = l.getSource();
                    if (source instanceof _ol2.default.source.TileWMS || source instanceof _ol2.default.source.ImageWMS) {
                        return 'wms';
                    }
                    if (source instanceof _ol2.default.source.WMTS) {
                        return 'wmts';
                    }
                    if (source instanceof _ol2.default.source.Vector || source instanceof _ol2.default.source.VectorTile) {
                        return 'vector';
                    }
                    return 'unknown';
                },
                displayInfo: function displayInfo(map, coords, content, contentType, autoPanOptions) {
                    logger.trace('[GfiUtils] : displayInfo...');
                    if (!contentType) {
                        contentType = 'text/html';
                    }
                    if (content === null) {
                        return;
                    }
                    var _htmlDoc = null;
                    var _parser = null;
                    var _content = content;
                    _content = _content.replace(/\n/g, '');
                    _content = _content.replace(/(>)\s*(<)/g, '$1$2');
                    var scope = typeof window !== 'undefined' ? window : null;
                    if ((false ? 'undefined' : _typeof(exports)) === 'object' && window === null) {
                        var DOMParser = __webpack_require__(15).DOMParser;
                        _parser = new DOMParser();
                        _htmlDoc = _parser.parseFromString(_content, contentType);
                    } else if (scope.DOMParser) {
                        _parser = new scope.DOMParser();
                        _htmlDoc = _parser.parseFromString(_content, contentType);
                    } else if (scope.ActiveXObject) {
                        _htmlDoc = new scope.ActiveXObject('Microsoft.XMLDOM');
                        _htmlDoc.async = false;
                        _htmlDoc.loadXML(_content);
                    } else {
                        console.log('Incompatible environment for DOM Parser !');
                        return false;
                    }
                    var body = _htmlDoc.getElementsByTagName('body');
                    if (body && body.length === 1) {
                        if (!body[0].hasChildNodes()) {
                            return false;
                        }
                    }
                    var element = document.createElement('div');
                    element.className = 'gp-feature-info-div';
                    var closer = document.createElement('input');
                    closer.type = 'button';
                    closer.className = 'gp-styling-button closer';
                    closer.onclick = function () {
                        if (map.featuresOverlay) {
                            map.removeOverlay(map.featuresOverlay);
                            map.featuresOverlay = null;
                        }
                        return false;
                    };
                    var contentDiv = document.createElement('div');
                    contentDiv.className = 'gp-features-content-div';
                    contentDiv.innerHTML = content;
                    element.appendChild(contentDiv);
                    element.appendChild(closer);
                    if (map.featuresOverlay) {
                        map.removeOverlay(map.featuresOverlay);
                        map.featuresOverlay = null;
                    }
                    map.featuresOverlay = new _ol2.default.Overlay({
                        element: element,
                        autoPan: autoPanOptions.autoPan,
                        autoPanAnimation: autoPanOptions.autoPanAnimation,
                        autoPanMargin: autoPanOptions.autoPanMargin,
                        positioning: 'bottom-center',
                        insertFirst: false,
                        stopEvent: true
                    });
                    map.addOverlay(map.featuresOverlay);
                    map.featuresOverlay.setPosition(coords);
                    map.featuresOverlay.render();
                    return true;
                },
                features2html: function features2html(map, features) {
                    var content = document.createElement('div');
                    features.forEach(function (f) {
                        var props = f.getProperties();
                        if (props.hasOwnProperty('name')) {
                            var nameDiv = document.createElement('div');
                            nameDiv.className = 'gp-att-name-div';
                            nameDiv.insertAdjacentHTML('afterbegin', props['name']);
                            content.appendChild(nameDiv);
                        }
                        if (props.hasOwnProperty('description')) {
                            var descDiv = document.createElement('div');
                            descDiv.className = 'gp-att-description-div';
                            descDiv.insertAdjacentHTML('afterbegin', props['description']);
                            content.appendChild(descDiv);
                        }
                        var p = null;
                        var others = false;
                        var oDiv = null;
                        var ul = null;
                        var li = null;
                        for (p in props) {
                            if (p == 'geometry' || p == 'value' || p == 'name' || p == 'description' || p == 'styleUrl') {
                                continue;
                            }
                            if (p == 'extensionsNode_' && props[p] === undefined) {
                                continue;
                            }
                            if (!others) {
                                oDiv = document.createElement('div');
                                oDiv.className = 'gp-att-others-div';
                                ul = document.createElement('ul');
                                others = true;
                            }
                            li = document.createElement('li');
                            var span = document.createElement('span');
                            span.className = 'gp-attname-others-span';
                            span.appendChild(document.createTextNode(p + ' : '));
                            li.appendChild(span);
                            li.appendChild(document.createTextNode(props[p]));
                            ul.appendChild(li);
                        }
                        if (ul) {
                            oDiv.appendChild(ul);
                            content.appendChild(oDiv);
                        }
                    }, map);
                    if (!content.hasChildNodes()) {
                        content = null;
                    }
                    return content;
                },
                layerGetFeatureAtCoordinates: function layerGetFeatureAtCoordinates(map, olLayer, olCoordinate) {
                    var pixel = map.getPixelFromCoordinate(olCoordinate);
                    return map.hasFeatureAtPixel(pixel, function (layer) {
                        if (layer === olLayer) {
                            return true;
                        }
                        return false;
                    });
                },
                displayVectorFeatureInfo: function displayVectorFeatureInfo(map, olCoordinate, olLayers, autoPanOptions) {
                    var pixel = map.getPixelFromCoordinate(olCoordinate);
                    var features = [];
                    map.forEachFeatureAtPixel(pixel, function (feature, layer) {
                        if (!olLayers || olLayers.indexOf(layer) > -1) {
                            features.push(feature);
                        }
                    });
                    if (features.length == 0) {
                        return false;
                    }
                    var content = this.features2html(map, features);
                    if (content === null) {
                        return false;
                    }
                    this.displayInfo(map, olCoordinate, content.innerHTML, 'text/html', autoPanOptions);
                    return true;
                },
                displayFeatureInfo: function displayFeatureInfo(map, olCoordinate, gfiLayers, proxyOptions, autoPanOptions) {
                    var layersOrdered = {};
                    for (var j = 0; j < gfiLayers.length; j++) {
                        var layer = gfiLayers[j];
                        var position = layer.obj.getZIndex();
                        if (!layersOrdered[position]) {
                            layersOrdered[position] = [];
                        }
                        layersOrdered[position].push(layer);
                    }
                    var requests = [];
                    var positions = Object.keys(layersOrdered);
                    positions.sort(function (a, b) {
                        return b - a;
                    });
                    var foundFeature = false;
                    for (var k = 0; k < positions.length; k++) {
                        var p = positions[k];
                        for (var h = 0; h < layersOrdered[p].length; ++h) {
                            var l = layersOrdered[p][h].obj;
                            var infoFormat = layersOrdered[p][h].infoFormat || 'text/html';
                            var minMaxResolutionOk = true;
                            if (l.minResolution && l.minResolution > map.getResolution()) {
                                minMaxResolutionOk = false;
                            }
                            if (minMaxResolutionOk && l.maxResolution && l.maxResolution < map.getResolution()) {
                                minMaxResolutionOk = false;
                            }
                            if (l.getVisible() && minMaxResolutionOk) {
                                var format = this.getLayerFormat(l);
                                if (format == 'vector') {
                                    if (!foundFeature && this.layerGetFeatureAtCoordinates(map, l, olCoordinate)) {
                                        requests.push({
                                            format: format,
                                            scope: this,
                                            coordinate: olCoordinate
                                        });
                                    }
                                    continue;
                                } else if (format != 'wms' && format != 'wmts') {
                                    console.log('[ERROR] DisplayFeatureInfo - layer format \'' + format + '\' not allowed');
                                    continue;
                                }
                                var _res = map.getView().getResolution();
                                var _url = null;
                                if (format == 'wmts') {
                                    _url = l.getSource().getGetFeatureInfoUrl(olCoordinate, _res, map.getView().getProjection(), { INFOFORMAT: infoFormat });
                                } else {
                                    _url = l.getSource().getGetFeatureInfoUrl(olCoordinate, _res, map.getView().getProjection(), { INFO_FORMAT: infoFormat });
                                }
                                requests.push({
                                    format: infoFormat,
                                    url: _ProxyUtils2.default.proxifyUrl(_url, proxyOptions),
                                    scope: this,
                                    coordinate: olCoordinate
                                });
                            }
                        }
                    }
                    var vectorLayersOrdered = null;
                    function requestsSync(list, iterator, callback) {
                        if (list.length === 0) {
                            return;
                        }
                        var nextItemIndex = 0;
                        function report(displayed) {
                            nextItemIndex++;
                            if (displayed || nextItemIndex === list.length) {
                                callback();
                            } else {
                                iterator(list[nextItemIndex], report);
                            }
                        }
                        iterator(list[0], report);
                    }
                    var context = this;
                    requestsSync(requests, function (data, report) {
                        if (data.format == 'vector') {
                            if (!vectorLayersOrdered) {
                                vectorLayersOrdered = [];
                                for (var m = 0; m < positions.length; m++) {
                                    var p = positions[m];
                                    for (var n = 0; n < layersOrdered[p].length; ++n) {
                                        vectorLayersOrdered.push(layersOrdered[p][n].obj);
                                    }
                                }
                            }
                            report(data.scope.displayVectorFeatureInfo(map, data.coordinate, vectorLayersOrdered, autoPanOptions));
                        } else {
                            _gp2.default.Protocols.XHR.call({
                                url: data.url,
                                method: 'GET',
                                scope: data.scope,
                                onResponse: function onResponse(resp) {
                                    var exception = false;
                                    if (resp.trim().length === 0 || resp.indexOf('java.lang.NullPointerException') !== -1 || resp.indexOf('not queryable') !== -1) {
                                        exception = true;
                                    }
                                    var displayed = !exception && context.displayInfo(map, data.coordinate, resp, 'text/html', autoPanOptions);
                                    report(displayed);
                                },
                                onFailure: function onFailure(error) {
                                    console.log(error);
                                    report(false);
                                }
                            });
                        }
                    }, function () {
                        logger.trace('Finish sync to GFI !');
                    });
                },
                getPosition: function getPosition(e, map) {
                    if (e.coordinate) {
                        return e.coordinate;
                    }
                    var pixel = [
                        0,
                        0
                    ];
                    if (e.offsetX || e.offsetY) {
                        pixel[0] = e.offsetX;
                        pixel[1] = e.offsetY;
                    } else if (e.pointerType === 'touch') {
                        var p = e.pointers[0];
                        pixel[0] = p.pageX;
                        pixel[1] = p.pageY;
                    }
                    var coordinate = map.getCoordinateFromPixel(pixel);
                    return coordinate;
                },
                onDisplayFeatureInfo: function onDisplayFeatureInfo(e, gfiObj) {
                    if (!gfiObj.isActive()) {
                        return;
                    }
                    logger.trace(e);
                    var map = gfiObj.getMap();
                    if (e.type == 'contextmenu' || e.type == 'dblclick') {
                        e.preventDefault();
                    } else if (e.type == 'singleclick') {
                        var interactions = map.getInteractions().getArray();
                        for (var i = 0; i < interactions.length; i++) {
                            if (interactions[i].getActive() && (interactions[i] instanceof _ol2.default.interaction.Select || interactions[i] instanceof _ol2.default.interaction.Modify || interactions[i] instanceof _ol2.default.interaction.Draw)) {
                                return;
                            }
                        }
                    }
                    var proxyOptions = {};
                    if (gfiObj._proxyUrl) {
                        proxyOptions.proxyUrl = gfiObj._proxyUrl;
                    }
                    if (gfiObj._noProxyDomains) {
                        proxyOptions.noProxyDomains = gfiObj._noProxyDomains;
                    }
                    var autoPanOptions = {};
                    if (gfiObj._autoPan) {
                        autoPanOptions.autoPan = gfiObj._autoPan;
                    }
                    if (gfiObj._autoPanAnimation) {
                        autoPanOptions.autoPanAnimation = gfiObj._autoPanAnimation;
                    }
                    if (gfiObj._autoPanMargin) {
                        autoPanOptions.autoPanMargin = gfiObj._autoPanMargin;
                    }
                    var eventLayers = [];
                    for (var j = 0; j < gfiObj._layers.length; ++j) {
                        var event = gfiObj._layers[j].event ? gfiObj._layers[j].event : gfiObj._defaultEvent;
                        if (event == e.type) {
                            var ind = eventLayers.push(gfiObj._layers[j]) - 1;
                            if (!eventLayers[ind].infoFormat) {
                                eventLayers[ind].infoFormat = gfiObj._defaultInfoFormat;
                            }
                        }
                    }
                    var coords = this.getPosition(e, map);
                    this.displayFeatureInfo(map, coords, eventLayers, proxyOptions, autoPanOptions);
                }
            };
            exports.default = GfiUtils;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('extended KML format');
            function KML(options) {
                if (!(this instanceof KML)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                _ol2.default.format.KML.call(this, options);
                this.options = options || {};
            }
            _ol2.default.inherits(KML, _ol2.default.format.KML);
            KML.prototype = Object.create(_ol2.default.format.KML.prototype, {});
            KML.prototype.constructor = KML;
            function _kmlFormattedToString(xml) {
                var reg = /(>)\s*(<)(\/*)/g;
                var wsexp = / *(.*) +\n/g;
                var contexp = /(<.+>)(.+\n)/g;
                xml = xml.replace(reg, '$1\n$2$3').replace(wsexp, '$1\n').replace(contexp, '$1\n$2');
                var formatted = '';
                var lines = xml.split('\n');
                var indent = 0;
                var lastType = 'other';
                var transitions = {
                    'single->single': 0,
                    'single->closing': -1,
                    'single->opening': 0,
                    'single->other': 0,
                    'closing->single': 0,
                    'closing->closing': -1,
                    'closing->opening': 0,
                    'closing->other': 0,
                    'opening->single': 1,
                    'opening->closing': 0,
                    'opening->opening': 1,
                    'opening->other': 1,
                    'other->single': 0,
                    'other->closing': -1,
                    'other->opening': 0,
                    'other->other': 0
                };
                for (var i = 0; i < lines.length; i++) {
                    var ln = lines[i];
                    var single = Boolean(ln.match(/<.+\/>/));
                    var closing = Boolean(ln.match(/<\/.+>/));
                    var opening = Boolean(ln.match(/<[^!].*>/));
                    var type = single ? 'single' : closing ? 'closing' : opening ? 'opening' : 'other';
                    var fromTo = lastType + '->' + type;
                    lastType = type;
                    var padding = '';
                    indent += transitions[fromTo];
                    for (var j = 0; j < indent; j++) {
                        padding += '\t';
                    }
                    if (fromTo == 'opening->closing') {
                        formatted = formatted.substr(0, formatted.length - 1) + ln + '\n';
                    } else {
                        formatted += padding + ln + '\n';
                    }
                }
                logger.trace(formatted);
                return formatted;
            }
            function _kmlParse(kmlString) {
                var kmlDoc = null;
                var parser = null;
                var scope = typeof window !== 'undefined' ? window : null;
                if ((false ? 'undefined' : _typeof(exports)) === 'object' && window === null) {
                    var DOMParser = __webpack_require__(15).DOMParser;
                    parser = new DOMParser();
                    kmlDoc = parser.parseFromString(kmlString, 'text/xml');
                } else if (scope.DOMParser) {
                    parser = new scope.DOMParser();
                    kmlDoc = parser.parseFromString(kmlString, 'text/xml');
                } else if (scope.ActiveXObject) {
                    kmlDoc = new scope.ActiveXObject('Microsoft.XMLDOM');
                    kmlDoc.async = false;
                    kmlDoc.loadXML(kmlString);
                } else {
                    console.log('Incompatible environment for DOM Parser !');
                }
                logger.trace(kmlDoc);
                return kmlDoc;
            }
            function _kmlToString(kmlDoc) {
                var oSerializer = new XMLSerializer();
                var kmlStringExtended = oSerializer.serializeToString(kmlDoc);
                logger.trace(kmlStringExtended);
                return kmlStringExtended;
            }
            function _kmlRead(kmlDoc, features, process) {
                var root = kmlDoc.documentElement;
                var firstNodeLevel = root.childNodes;
                var nodes = firstNodeLevel;
                if (firstNodeLevel.length === 1 && firstNodeLevel[0].nodeName === 'Document') {
                    nodes = firstNodeLevel[0].childNodes;
                }
                var stylesUrl = {};
                var index = -1;
                for (var i = 0; i < nodes.length; i++) {
                    var node = nodes[i];
                    switch (node.nodeName) {
                    case 'Style':
                        var id = node.attributes[0];
                        if (id && id.nodeName === 'id') {
                            var _k = id.nodeValue;
                            var _v = node;
                            stylesUrl[_k] = _v;
                        }
                        break;
                    case 'Placemark':
                        index++;
                        var types = node.childNodes;
                        var point = false;
                        var styles = null;
                        var extend = null;
                        var name = node;
                        for (var j = 0; j < types.length; j++) {
                            switch (types[j].nodeName) {
                            case 'Point':
                                point = true;
                                break;
                            case 'Style':
                                styles = types[j].childNodes;
                                break;
                            case 'styleUrl':
                                var _idStyle = types[j].textContent.slice(1);
                                if (stylesUrl[_idStyle]) {
                                    styles = stylesUrl[_idStyle].childNodes;
                                }
                                break;
                            case 'ExtendedData':
                                extend = types[j].childNodes;
                                break;
                            case 'name':
                                name = null;
                                break;
                            default:
                            }
                        }
                        if (extend) {
                            logger.log('ExtendedData :', extend);
                            var fctExtend = process.extendedData;
                            if (fctExtend && typeof fctExtend === 'function') {
                                fctExtend(features[index], extend);
                            }
                        }
                        if (name) {
                            logger.log('Name :', name);
                            var fctName = process.nameData;
                            if (fctName && typeof fctName === 'function') {
                                fctName(features[index], name);
                            }
                        }
                        if (point && styles) {
                            if (styles.length) {
                                var labelStyle = null;
                                var iconStyle = null;
                                for (var k = 0; k < styles.length; k++) {
                                    switch (styles[k].nodeName) {
                                    case 'LabelStyle':
                                        labelStyle = styles[k];
                                        break;
                                    case 'IconStyle':
                                        iconStyle = styles[k];
                                        break;
                                    default:
                                    }
                                }
                                var labelName = features[index].getProperties().name;
                                var labelDescription = features[index].getProperties().description;
                                var value = labelName || labelDescription;
                                logger.trace(value);
                                if (!iconStyle && labelStyle) {
                                    var fctLabel = process.labelStyle;
                                    if (fctLabel && typeof fctLabel === 'function') {
                                        fctLabel(features[index], labelStyle);
                                    }
                                } else if (iconStyle && !labelStyle) {
                                    var fctIcon = process.iconStyle;
                                    if (fctIcon && typeof fctIcon === 'function') {
                                        fctIcon(features[index], iconStyle);
                                    }
                                } else if (iconStyle && labelStyle) {
                                    var fctIconLabel = process.iconLabelStyle;
                                    if (fctIconLabel && typeof fctIconLabel === 'function') {
                                        fctIconLabel(features[index], iconStyle, labelStyle);
                                    }
                                }
                            }
                        }
                        break;
                    default:
                        logger.trace('tag is not processing !');
                    }
                }
            }
            KML.prototype.writeFeatures = function (features, options) {
                logger.log('overload : ol.format.KML.writeFeatures');
                var kmlString = this._writeExtendStylesFeatures(features, options);
                return kmlString;
            };
            KML.prototype._writeExtendStylesFeatures = function (features, options) {
                var kmlString = _ol2.default.format.KML.prototype.writeFeatures.call(this, features, options);
                var kmlDoc = _kmlParse(kmlString);
                if (kmlDoc === null) {
                    return kmlString;
                }
                var __createExtensionStyleLabel = function __createExtensionStyleLabel(feature, style) {
                    logger.trace('label with style :', style);
                    if (!feature) {
                        return;
                    }
                    var labelName = feature.getProperties().name;
                    if (!labelName) {
                        return;
                    }
                    function __convertRGBColorsToKML(data) {
                        var strColor = data.toString(16);
                        if (strColor.charAt(0) === '#') {
                            strColor = strColor.slice(1);
                        }
                        var opacity = 1;
                        opacity = parseInt(opacity * 255, 10);
                        opacity = opacity.toString(16);
                        var color = opacity;
                        color = color + strColor.substr(4, 2);
                        color = color + strColor.substr(2, 2);
                        color = color + strColor.substr(0, 2);
                        return color.toLowerCase();
                    }
                    if (feature.getStyle() instanceof _ol2.default.style.Style) {
                        var fTextStyle = feature.getStyle().getText().getStroke();
                        if (!fTextStyle) {
                            return;
                        }
                        var _haloColor = __convertRGBColorsToKML(fTextStyle.getColor()) || __convertRGBColorsToKML('#FFFFFF');
                        var _haloRadius = fTextStyle.getWidth() || '0';
                        var _haloOpacity = '1';
                        var _font = 'Sans';
                        if (style && style.getElementsByTagName('LabelStyleSimpleExtensionGroup').length === 0) {
                            var labelextend = kmlDoc.createElement('LabelStyleSimpleExtensionGroup');
                            labelextend.setAttribute('fontFamily', _font);
                            labelextend.setAttribute('haloColor', _haloColor);
                            labelextend.setAttribute('haloRadius', _haloRadius);
                            labelextend.setAttribute('haloOpacity', _haloOpacity);
                            style.appendChild(labelextend);
                        }
                    }
                };
                var __createHotSpotStyleIcon = function __createHotSpotStyleIcon(feature, style) {
                    logger.trace('marker with style (hotspot):', style);
                    if (!feature) {
                        return;
                    }
                    if (feature.getStyle() instanceof _ol2.default.style.Style) {
                        var fImageStyle = feature.getStyle().getImage();
                        if (!fImageStyle) {
                            return;
                        }
                        var x = 0;
                        var y = 0;
                        var xunits = 'pixels';
                        var yunits = 'pixels';
                        var size = fImageStyle.getSize();
                        var anchor = fImageStyle.getAnchor();
                        if (anchor.length) {
                            x = anchor[0];
                            y = anchor[1];
                            if (yunits === 'fraction') {
                                y = anchor[1] === 1 ? 0 : 1 - anchor[1];
                            } else {
                                y = yunits === 'pixels' && anchor[1] === size[1] ? 0 : size[1] - anchor[1];
                            }
                        }
                        if (style && style.getElementsByTagName('hotSpot').length === 0) {
                            var hotspot = kmlDoc.createElement('hotSpot');
                            hotspot.setAttribute('x', x);
                            hotspot.setAttribute('y', y);
                            hotspot.setAttribute('xunits', xunits);
                            hotspot.setAttribute('yunits', yunits);
                            style.appendChild(hotspot);
                        }
                    }
                };
                var __createStyleToFeatureIconLabel = function __createStyleToFeatureIconLabel(feature, iconStyle, labelStyle) {
                    logger.trace('write an icon with a label');
                    __createHotSpotStyleIcon(feature, iconStyle);
                    __createExtensionStyleLabel(feature, labelStyle);
                };
                var __setNameData = function __setNameData(feature, tags) {
                    for (var i = 0; i < tags.length; i++) {
                        var tag = tags[i];
                        if (tag.nodeName === 'name') {
                            return;
                        }
                    }
                    var labelName = feature.getProperties().name;
                    if (labelName) {
                        var name = kmlDoc.createElement('name');
                        name.innerHTML = labelName;
                        tags.appendChild(name);
                    }
                };
                _kmlRead(kmlDoc, features, {
                    labelStyle: __createExtensionStyleLabel,
                    iconStyle: __createHotSpotStyleIcon,
                    iconLabelStyle: __createStyleToFeatureIconLabel,
                    nameData: __setNameData
                });
                var kmlStringExtended = _kmlToString(kmlDoc);
                if (kmlStringExtended === null) {
                    kmlStringExtended = kmlString;
                }
                var kmlStringFormatted = _kmlFormattedToString(kmlStringExtended);
                if (kmlStringFormatted === null) {
                    kmlStringFormatted = kmlString;
                }
                return kmlStringFormatted;
            };
            KML.prototype.readFeatures = function (source, options) {
                logger.log('overload : ol.format.KML.readFeatures');
                var features = this._readExtendStylesFeatures(source, options);
                logger.trace('Styles étendus', features);
                return features;
            };
            KML.prototype._readExtendStylesFeatures = function (source, options) {
                var features = _ol2.default.format.KML.prototype.readFeatures.call(this, source, options);
                var kmlDoc = null;
                var kmlString = '';
                if (typeof source === 'string') {
                    kmlString = source;
                } else {
                    kmlString = source.documentElement.outerHTML;
                }
                kmlString = kmlString.replace(/\n/g, '');
                kmlString = kmlString.replace(/(>)\s*(<)/g, '$1$2');
                kmlDoc = _kmlParse(kmlString);
                if (kmlDoc === null) {
                    return features;
                }
                var __getExtensionStyleToFeatureLabel = function __getExtensionStyleToFeatureLabel(feature, style) {
                    logger.trace('label with style :', style);
                    if (!feature) {
                        return;
                    }
                    function __convertKMLColorsToRGB(data) {
                        var color = '';
                        color = color + data.substr(6, 2);
                        color = color + data.substr(4, 2);
                        color = color + data.substr(2, 2);
                        var hex = parseInt(color, 16).toString(16);
                        var comp = '';
                        var len = hex.length || 0;
                        for (var i = 0; i < 6 - len; i++) {
                            comp += '0';
                        }
                        hex = '#' + comp + hex;
                        return hex.toString(16);
                    }
                    var _text = feature.getProperties().name || '---';
                    var _color = __convertKMLColorsToRGB('ff000000');
                    var _colorHalo = '#FFFFFF';
                    var _radiusHalo = 0;
                    var _font = 'Sans';
                    var _fontSize = '16px';
                    var bLabelStyleSimpleExtensionGroup = false;
                    var styles = style.childNodes;
                    for (var k = 0; k < styles.length; k++) {
                        switch (styles[k].nodeName) {
                        case 'scale':
                            break;
                        case 'colorMode':
                            break;
                        case 'color':
                            _color = __convertKMLColorsToRGB(styles[k].textContent);
                            break;
                        case 'LabelStyleSimpleExtensionGroup':
                            bLabelStyleSimpleExtensionGroup = true;
                            var attributs = styles[k].attributes;
                            for (var l = 0; l < attributs.length; l++) {
                                switch (attributs[l].nodeName) {
                                case 'fontFamily':
                                    break;
                                case 'haloColor':
                                    _colorHalo = __convertKMLColorsToRGB(attributs[l].nodeValue);
                                    break;
                                case 'haloRadius':
                                    _radiusHalo = parseInt(attributs[l].nodeValue, 10);
                                    break;
                                case 'haloOpacity':
                                    break;
                                default:
                                }
                            }
                            break;
                        default:
                        }
                    }
                    if (!bLabelStyleSimpleExtensionGroup) {
                        logger.trace('it\'s not a Label Style Simple Extension Group !');
                        return;
                    }
                    feature.setStyle(new _ol2.default.style.Style({
                        image: new _ol2.default.style.Icon({
                            src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=',
                            size: [
                                51,
                                38
                            ],
                            anchor: [
                                25.5,
                                38
                            ],
                            anchorOrigin: 'top-left',
                            anchorXUnits: 'pixels',
                            anchorYUnits: 'pixels'
                        }),
                        text: new _ol2.default.style.Text({
                            font: _fontSize + ' ' + _font,
                            textAlign: 'left',
                            text: _text,
                            fill: new _ol2.default.style.Fill({ color: _color }),
                            stroke: new _ol2.default.style.Stroke({
                                color: _colorHalo,
                                width: _radiusHalo
                            })
                        })
                    }));
                };
                var __getHotSpotStyleToFeatureIcon = function __getHotSpotStyleToFeatureIcon(feature, style) {
                    logger.trace('hotspot :', style);
                    var _src = null;
                    var _scale = null;
                    var _bSizeIcon = false;
                    var _sizeW = 51;
                    var _sizeH = 38;
                    var _bHotSpot = false;
                    var _anchorX = 25.5;
                    var _anchorXUnits = 'pixels';
                    var _anchorY = 38;
                    var _anchorYUnits = 'pixels';
                    var styles = style.childNodes;
                    for (var k = 0; k < styles.length; k++) {
                        switch (styles[k].nodeName) {
                        case 'Icon':
                            var nodes = styles[k].childNodes;
                            for (var i = 0; i < nodes.length; i++) {
                                switch (nodes[i].nodeName) {
                                case 'href':
                                    _src = nodes[i].textContent;
                                    break;
                                case 'gx:w':
                                    _bSizeIcon = true;
                                    _sizeW = parseFloat(nodes[i].textContent);
                                    break;
                                case 'gx:h':
                                    _bSizeIcon = true;
                                    _sizeH = parseFloat(nodes[i].textContent);
                                    break;
                                default:
                                }
                            }
                            break;
                        case 'hotSpot':
                            _bHotSpot = true;
                            var attributs = styles[k].attributes;
                            for (var l = 0; l < attributs.length; l++) {
                                switch (attributs[l].nodeName) {
                                case 'x':
                                    _anchorX = parseFloat(attributs[l].nodeValue);
                                    break;
                                case 'y':
                                    _anchorY = parseFloat(attributs[l].nodeValue);
                                    break;
                                case 'yunits':
                                    _anchorXUnits = attributs[l].nodeValue;
                                    break;
                                case 'xunits':
                                    _anchorYUnits = attributs[l].nodeValue;
                                    break;
                                default:
                                }
                            }
                            break;
                        case 'scale':
                            _scale = parseFloat(styles[k].textContent);
                            break;
                        default:
                        }
                    }
                    var _options = {
                        src: _src,
                        crossOrigin: 'anonymous',
                        scale: _scale || 1
                    };
                    if (_bSizeIcon) {
                        _Utils2.default.mergeParams(_options, {
                            size: [
                                _sizeW,
                                _sizeH
                            ]
                        });
                    }
                    if (_bHotSpot) {
                        _Utils2.default.mergeParams(_options, {
                            anchor: [
                                _anchorX,
                                _anchorY
                            ],
                            anchorOrigin: 'bottom-left',
                            anchorXUnits: _anchorXUnits || 'pixels',
                            anchorYUnits: _anchorYUnits || 'pixels'
                        });
                    }
                    var featureStyleFunction = feature.getStyleFunction();
                    if (featureStyleFunction) {
                        var _styles = featureStyleFunction.call(feature, 0);
                        if (_styles && _styles.length !== 0) {
                            var _style = _styles.length === 1 ? _styles[0] : _styles[_styles.length - 1];
                            feature.setStyle(new _ol2.default.style.Style({
                                image: new _ol2.default.style.Icon(_options),
                                text: _style.getText()
                            }));
                        }
                    }
                };
                var __getExtendedData = function __getExtendedData(feature, extend) {
                    logger.trace('extendData :', extend);
                    if (!feature) {
                        return;
                    }
                    var _fname = feature.getProperties().name || '';
                    var _fdescription = feature.getProperties().description || '';
                    var _ftitle = null;
                    for (var i = 0; i < extend.length; i++) {
                        var data = extend[i];
                        var name = data.attributes[0];
                        var nodes = data.childNodes;
                        if (name.nodeName === 'name') {
                            switch (name.nodeValue) {
                            case 'label':
                                _fname = data.textContent;
                                break;
                            case 'title':
                            case 'attributetitle':
                                for (var j = 0; j < nodes.length; j++) {
                                    if (nodes[j].nodeName === 'value') {
                                        _ftitle = nodes[j].textContent;
                                    }
                                }
                                break;
                            default:
                            }
                        }
                    }
                    if (_ftitle) {
                        _fdescription = _fdescription ? _ftitle + ' : ' + _fdescription : _ftitle;
                    }
                    feature.setProperties({
                        name: _fname,
                        description: _fdescription
                    });
                };
                var __getStyleToFeatureIconLabel = function __getStyleToFeatureIconLabel(feature, iconStyle, labelStyle) {
                    logger.trace('display icon and label');
                    __getExtensionStyleToFeatureLabel(feature, labelStyle);
                    __getHotSpotStyleToFeatureIcon(feature, iconStyle);
                };
                _kmlRead(kmlDoc, features, {
                    labelStyle: this.options.showPointNames ? __getExtensionStyleToFeatureLabel : null,
                    iconStyle: __getHotSpotStyleToFeatureIcon,
                    iconLabelStyle: this.options.showPointNames ? __getStyleToFeatureIconLabel : __getHotSpotStyleToFeatureIcon,
                    extendedData: __getExtendedData
                });
                return features;
            };
            exports.default = KML;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('interactions');
            var Interactions = {
                _extensions: [
                    'Measures',
                    'ElevationPath',
                    'Drawing'
                ],
                _options: {
                    current: null,
                    clean: null
                },
                unset: function unset(map, options) {
                    logger.trace('unset()');
                    var opts = {};
                    _Utils2.default.mergeParams(opts, this._options);
                    _Utils2.default.mergeParams(opts, options);
                    var interactions = map.getInteractions().getArray();
                    for (var i = 0; i < interactions.length; i++) {
                        if (interactions[i].getActive() && (interactions[i] instanceof _ol2.default.interaction.Draw || interactions[i] instanceof _ol2.default.interaction.Select || interactions[i] instanceof _ol2.default.interaction.Modify)) {
                            var prop = interactions[i].getProperties();
                            var name = prop.name;
                            if (typeof name !== 'undefined' && this._extensions.indexOf(name) > -1) {
                                if (opts.current && opts.current === name) {
                                    continue;
                                }
                                interactions[i].setActive(false);
                                var source = prop.source;
                                if (typeof source !== 'undefined' && source instanceof _ol2.default.control.Control) {
                                    for (var action in opts) {
                                        if (opts.hasOwnProperty(action)) {
                                            if (action === 'current') {
                                                continue;
                                            }
                                            if (typeof source[action] === 'function') {
                                                var args = Array.isArray(opts[action]) ? opts[action] : [opts[action]];
                                                source[action].apply(source, args);
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            };
            exports.default = Interactions;
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var MousePositionDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPmousePosition');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowMousePositionElement: function _createShowMousePositionElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowMousePosition');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowMousePositionPictoElement: function _createShowMousePositionPictoElement(isDesktop) {
                    var self = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowMousePositionPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowMousePosition');
                    label.title = 'Afficher les coordonnées du curseur';
                    label.addEventListener('click', function (e) {
                        var mapCenterClass = '';
                        if (!document.getElementById(self._addUID('GPshowMousePosition')).checked && !isDesktop) {
                            mapCenterClass = 'GPmapCenterVisible';
                        }
                        document.getElementById('GPmapCenter').className = mapCenterClass;
                        self.onShowMousePositionClick(e);
                    });
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowMousePositionOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                },
                _createMousePositionPanelElement: function _createMousePositionPanelElement(displayAltitude, displayCoordinates, editCoordinates, currentProjectionUnits) {
                    displayAltitude = typeof displayAltitude === 'undefined' ? true : displayAltitude;
                    displayCoordinates = typeof displayCoordinates === 'undefined' ? true : displayCoordinates;
                    editCoordinates = typeof editCoordinates === 'undefined' ? false : editCoordinates;
                    var div = document.createElement('div');
                    div.id = this._addUID('GPmousePositionPanel');
                    div.className = 'GPpanel';
                    div.appendChild(this._createMousePositionPanelHeaderElement());
                    div.appendChild(this._createMousePositionPanelBasicElement(displayAltitude, displayCoordinates, editCoordinates, currentProjectionUnits));
                    var arraySettings = this._createShowMousePositionSettingsElement(displayCoordinates);
                    for (var j = 0; j < arraySettings.length; j++) {
                        div.appendChild(arraySettings[j]);
                    }
                    return div;
                },
                _createMapCenter: function _createMapCenter() {
                    var div = document.createElement('div');
                    div.id = 'GPmapCenter';
                    div.className = '';
                    return div;
                },
                _createMousePositionPanelHeaderElement: function _createMousePositionPanelHeaderElement() {
                    var container = document.createElement('div');
                    container.className = 'GPpanelHeader';
                    var divTitle = document.createElement('div');
                    divTitle.className = 'GPpanelTitle';
                    divTitle.innerHTML = 'Coordonnées';
                    container.appendChild(divTitle);
                    var divClose = document.createElement('div');
                    divClose.id = 'GPmousePositionPanelClose';
                    divClose.className = 'GPpanelClose';
                    divClose.title = 'Fermer le panneau';
                    var self = this;
                    if (divClose.addEventListener) {
                        divClose.addEventListener('click', function () {
                            document.getElementById(self._addUID('GPshowMousePositionPicto')).click();
                        }, false);
                    } else if (divClose.attachEvent) {
                        divClose.attachEvent('onclick', function () {
                            document.getElementById(self._addUID('GPshowMousePositionPicto')).click();
                        });
                    }
                    container.appendChild(divClose);
                    return container;
                },
                _createMousePositionPanelBasicElement: function _createMousePositionPanelBasicElement(displayAltitude, displayCoordinates, editCoordinates, currentProjectionUnits) {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPmousePositionBasicPanel');
                    container.appendChild(this._createMousePositionPanelBasicCoordinateElement(displayCoordinates, editCoordinates, currentProjectionUnits));
                    container.appendChild(this._createMousePositionPanelEditToolsElement(editCoordinates));
                    container.appendChild(this._createMousePositionPanelBasicAltitudeElement(displayAltitude));
                    return container;
                },
                _createCoordinateElement: function _createCoordinateElement(coordType, editCoordinates) {
                    var context = this;
                    if ([
                            'Lon',
                            'Lat'
                        ].indexOf(coordType) === -1) {
                        return [];
                    }
                    var list = [];
                    var input = document.createElement('input');
                    input.id = this._addUID('GPmousePosition' + coordType);
                    input.title = editCoordinates === true ? 'Cliquer pour saisir des coordonnées' : '';
                    input.readOnly = true;
                    if (editCoordinates) {
                        input.addEventListener('click', function () {
                            context.onMousePositionEditModeClick(true);
                        });
                        input.addEventListener('change', function (e) {
                            this.classList.remove('error');
                            var valid = context.validateExtentCoordinate(coordType, this.value, e);
                            valid ? this.classList.remove('error') : this.classList.add('error');
                        });
                    }
                    list.push(input);
                    var span = document.createElement('span');
                    span.className = 'GPmousePositionUnits';
                    list.push(span);
                    return list;
                },
                _createDMSCoordinateElement: function _createDMSCoordinateElement(coordType, editCoordinates) {
                    if ([
                            'Lon',
                            'Lat'
                        ].indexOf(coordType) === -1) {
                        return [];
                    }
                    var context = this;
                    var list = [];
                    var input = document.createElement('input');
                    input.id = this._addUID('GPmousePosition' + coordType + 'Degrees');
                    input.className = 'GPSexagesimal';
                    input.setAttribute('name', 'degrees');
                    input.title = editCoordinates === true ? 'Cliquer pour saisir des coordonnées' : '';
                    input.readOnly = true;
                    input.dataset.min = 0;
                    input.dataset.max = coordType === 'Lon' ? 180 : 90;
                    if (editCoordinates) {
                        input.addEventListener('click', function () {
                            context.onMousePositionEditModeClick(true);
                        });
                        input.addEventListener('change', function () {
                            this.classList.remove('error');
                            var valid = context._checkDMSDegrees(coordType, this);
                            valid ? this.classList.remove('error') : this.classList.add('error');
                        });
                    }
                    list.push(input);
                    var span = document.createElement('span');
                    span.className = 'GPmousePositionSexagesimalLabel';
                    span.innerHTML = '\xB0';
                    list.push(span);
                    var input1 = document.createElement('input');
                    input1.id = this._addUID('GPmousePosition' + coordType + 'Minutes');
                    input1.className = 'GPSexagesimal';
                    input1.setAttribute('name', 'minutes');
                    input1.title = editCoordinates === true ? 'Cliquer pour saisir des coordonnées' : '';
                    input1.readOnly = true;
                    input1.dataset.min = 0;
                    input1.dataset.max = 59;
                    if (editCoordinates) {
                        input1.addEventListener('click', function () {
                            context.onMousePositionEditModeClick(true);
                        });
                        input1.addEventListener('change', function () {
                            this.classList.remove('error');
                            var valid = context._checkDMSElement(this);
                            valid ? this.classList.remove('error') : this.classList.add('error');
                        });
                    }
                    list.push(input1);
                    var span1 = document.createElement('span');
                    span1.className = 'GPmousePositionSexagesimalLabel';
                    span1.innerHTML = '\'';
                    list.push(span1);
                    var input2 = document.createElement('input');
                    input2.id = this._addUID('GPmousePosition' + coordType + 'Seconds');
                    input2.className = 'GPSexagesimalsec';
                    input2.setAttribute('name', 'seconds');
                    input2.title = editCoordinates === true ? 'Cliquer pour saisir des coordonnées' : '';
                    input2.readOnly = true;
                    input2.dataset.min = 0;
                    input2.dataset.max = 59;
                    if (editCoordinates) {
                        input2.addEventListener('click', function () {
                            context.onMousePositionEditModeClick(true);
                        });
                        input2.addEventListener('change', function () {
                            this.classList.remove('error');
                            var valid = context._checkDMSElement(this, true);
                            valid ? this.classList.remove('error') : this.classList.add('error');
                        });
                    }
                    list.push(input2);
                    var span2 = document.createElement('span');
                    span2.className = 'GPmousePositionSexagesimalLabel';
                    span2.innerHTML = '\'\'';
                    list.push(span2);
                    var select = document.createElement('select');
                    select.id = this._addUID('GPmousePosition' + coordType + 'Direction');
                    select.className = 'GPmousePositionDirection';
                    select.setAttribute('name', 'direction');
                    select.disabled = true;
                    var option = document.createElement('option');
                    option.value = coordType === 'Lon' ? 'E' : 'N';
                    option.innerHTML = coordType === 'Lon' ? 'E' : 'N';
                    select.appendChild(option);
                    var option1 = document.createElement('option');
                    option1.value = coordType === 'Lon' ? 'O' : 'S';
                    option1.innerHTML = coordType === 'Lon' ? 'O' : 'S';
                    select.appendChild(option1);
                    list.push(select);
                    return list;
                },
                _createMousePositionPanelBasicCoordinateElement: function _createMousePositionPanelBasicCoordinateElement(display, editCoordinates, currentProjectionUnits) {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPmousePositionCoordinate');
                    div.style.display = display ? 'block' : 'none';
                    var divLat = document.createElement('div');
                    var spanLat = document.createElement('span');
                    spanLat.className = 'GPmousePositionLabel';
                    spanLat.id = this._addUID('GPmousePositionLatLabel');
                    spanLat.innerHTML = 'Latitude : ';
                    divLat.appendChild(spanLat);
                    var span = document.createElement('span');
                    span.id = this._addUID('GPmousePositionLatCoordinate');
                    var arrayCoords;
                    if (currentProjectionUnits === 'DMS') {
                        arrayCoords = this._createDMSCoordinateElement('Lat', editCoordinates);
                    } else {
                        arrayCoords = this._createCoordinateElement('Lat', editCoordinates);
                    }
                    for (var i = 0; i < arrayCoords.length; i++) {
                        span.appendChild(arrayCoords[i]);
                    }
                    divLat.appendChild(span);
                    div.appendChild(divLat);
                    var divLon = document.createElement('div');
                    var spanLon = document.createElement('span');
                    spanLon.className = 'GPmousePositionLabel';
                    spanLon.id = this._addUID('GPmousePositionLonLabel');
                    spanLon.innerHTML = 'Longitude : ';
                    divLon.appendChild(spanLon);
                    var span1 = document.createElement('span');
                    span1.id = this._addUID('GPmousePositionLonCoordinate');
                    var arrayCoords1;
                    if (currentProjectionUnits === 'DMS') {
                        arrayCoords1 = this._createDMSCoordinateElement('Lon', editCoordinates);
                    } else {
                        arrayCoords1 = this._createCoordinateElement('Lon', editCoordinates);
                    }
                    for (var j = 0; j < arrayCoords1.length; j++) {
                        span1.appendChild(arrayCoords1[j]);
                    }
                    divLon.appendChild(span1);
                    div.appendChild(divLon);
                    return div;
                },
                _createMousePositionPanelBasicAltitudeElement: function _createMousePositionPanelBasicAltitudeElement(display) {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPmousePositionAltitude');
                    div.style.display = display ? 'block' : 'none';
                    var spanLabel = document.createElement('span');
                    spanLabel.className = 'GPmousePositionLabel';
                    spanLabel.innerHTML = 'Altitude : ';
                    div.appendChild(spanLabel);
                    var spanAlt = document.createElement('span');
                    spanAlt.className = 'GPmousePositionCoords';
                    spanAlt.id = this._addUID('GPmousePositionAlt');
                    spanAlt.innerHTML = '...';
                    div.appendChild(spanAlt);
                    var spanUnits = document.createElement('span');
                    spanUnits.className = 'GPmousePositionAltitudeUnits';
                    spanUnits.innerHTML = 'm';
                    div.appendChild(spanUnits);
                    return div;
                },
                _createMousePositionPanelEditToolsElement: function _createMousePositionPanelEditToolsElement(editCoordinates) {
                    var context = this;
                    var div = document.createElement('div');
                    div.className = 'GPmousePositionPanelEditTools';
                    div.id = this._addUID('GPmousePositionPanelEditTools');
                    if (!editCoordinates) {
                        div.style.display = 'none';
                    }
                    var span1 = document.createElement('span');
                    span1.className = 'GPmousePositionEditTool';
                    span1.id = this._addUID('GPmousePositionLocate');
                    span1.title = editCoordinates === true ? 'Cliquer pour saisir des coordonnées' : '';
                    if (editCoordinates) {
                        span1.addEventListener('click', function () {
                            context.onMousePositionEditModeLocateClick();
                        });
                    }
                    div.appendChild(span1);
                    var span2 = document.createElement('span');
                    span2.className = 'GPmousePositionEditTool';
                    span2.id = this._addUID('GPmousePositionCloseEdit');
                    span2.title = 'Quitter la saisie des coordonnées';
                    span2.style.display = 'none';
                    if (editCoordinates) {
                        span2.addEventListener('click', function () {
                            context.onMousePositionEditModeClick(false);
                        });
                    }
                    div.appendChild(span2);
                    return div;
                },
                _createShowMousePositionSettingsElement: function _createShowMousePositionSettingsElement(display) {
                    var list = [];
                    var input = document.createElement('input');
                    input.type = 'checkbox';
                    input.id = this._addUID('GPshowMousePositionSettings');
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowMousePositionSettingsPicto');
                    label.htmlFor = this._addUID('GPshowMousePositionSettings');
                    label.title = 'Réglages';
                    label.className = 'GPshowMoreOptions GPshowMousePositionSettingsPicto';
                    label.style.display = display ? 'block' : 'none';
                    list.push(input);
                    list.push(label);
                    return list;
                },
                _createMousePositionSettingsElement: function _createMousePositionSettingsElement(display) {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPmousePositionSettings');
                    container.style.display = display === undefined || display ? 'block' : 'none';
                    var span = document.createElement('span');
                    span.className = 'GPmousePositionSettingsLabel';
                    span.innerHTML = 'Système de référence';
                    container.appendChild(span);
                    return container;
                },
                _createMousePositionSettingsSystemsElement: function _createMousePositionSettingsSystemsElement(systems) {
                    var context = this;
                    var selectSystem = document.createElement('select');
                    selectSystem.id = this._addUID('GPmousePositionProjectionSystem');
                    selectSystem.className = 'GPinputSelect GPmousePositionSettingsSelect';
                    selectSystem.addEventListener('change', function (e) {
                        context.onMousePositionProjectionSystemChange(e);
                    });
                    selectSystem.addEventListener('mouseover', function (e) {
                        context.onMousePositionProjectionSystemMouseOver(e);
                    });
                    for (var i = 0; i < systems.length; i++) {
                        var obj = systems[i];
                        var option = document.createElement('option');
                        option.value = obj.code;
                        option.text = obj.label || i;
                        selectSystem.appendChild(option);
                    }
                    return selectSystem;
                },
                _createMousePositionSettingsUnitsElement: function _createMousePositionSettingsUnitsElement(units) {
                    var context = this;
                    var selectUnits = document.createElement('select');
                    selectUnits.id = this._addUID('GPmousePositionProjectionUnits');
                    selectUnits.className = 'GPinputSelect GPmousePositionSettingsSelect';
                    selectUnits.addEventListener('change', function (e) {
                        context.onMousePositionProjectionUnitsChange(e);
                    });
                    for (var j = 0; j < units.length; j++) {
                        var obj = units[j];
                        var option = document.createElement('option');
                        option.value = obj.code ? obj.code : j;
                        option.text = obj.label || j;
                        selectUnits.appendChild(option);
                    }
                    return selectUnits;
                },
                _resetLabelElements: function _resetLabelElements(currentProjectionType) {
                    var spanLat = document.getElementById(this._addUID('GPmousePositionLatLabel'));
                    spanLat.innerHTML = currentProjectionType === 'Geographical' ? 'Latitude :' : 'X :';
                    var spanLon = document.getElementById(this._addUID('GPmousePositionLonLabel'));
                    spanLon.innerHTML = currentProjectionType === 'Geographical' ? 'Longitude :' : 'Y :';
                },
                _resetUnitElements: function _resetUnitElements(currentProjectionUnits) {
                    var value = '';
                    if (currentProjectionUnits === 'M' || currentProjectionUnits === 'KM') {
                        value = currentProjectionUnits.toLowerCase();
                    }
                    var elts = document.getElementsByClassName('GPmousePositionUnits');
                    for (var e = 0; e < elts.length; e++) {
                        elts[e].innerHTML = value;
                    }
                },
                _resetCoordinateElements: function _resetCoordinateElements(editCoordinates, currentProjectionType, currentProjectionUnits) {
                    var latElt = document.getElementById(this._addUID('GPmousePositionLatCoordinate'));
                    while (latElt.firstChild) {
                        latElt.removeChild(latElt.firstChild);
                    }
                    var arrayCoords;
                    if (currentProjectionUnits === 'DMS') {
                        arrayCoords = this._createDMSCoordinateElement('Lat', editCoordinates);
                    } else {
                        arrayCoords = this._createCoordinateElement('Lat', editCoordinates);
                    }
                    for (var i = 0; i < arrayCoords.length; i++) {
                        latElt.appendChild(arrayCoords[i]);
                    }
                    var lonElt = document.getElementById(this._addUID('GPmousePositionLonCoordinate'));
                    while (lonElt.firstChild) {
                        lonElt.removeChild(lonElt.firstChild);
                    }
                    var arrayCoords1;
                    if (currentProjectionUnits === 'DMS') {
                        arrayCoords1 = this._createDMSCoordinateElement('Lon', editCoordinates);
                    } else {
                        arrayCoords1 = this._createCoordinateElement('Lon', editCoordinates);
                    }
                    for (var j = 0; j < arrayCoords1.length; j++) {
                        lonElt.appendChild(arrayCoords1[j]);
                    }
                    this.onMapMove();
                },
                _setEditMode: function _setEditMode(editing) {
                    var locateElt = document.getElementById(this._addUID('GPmousePositionLocate'));
                    locateElt.title = editing ? 'Aller à la position ...' : 'Cliquer pour saisir des coordonnées';
                    var closeEditElt = document.getElementById(this._addUID('GPmousePositionCloseEdit'));
                    closeEditElt.style.display = editing ? 'inline-block' : 'none';
                    var selector = 'div[id^=' + this._addUID('GPmousePositionCoordinate') + ']';
                    var inputs = document.querySelectorAll(selector + ' input');
                    for (var i = 0; i < inputs.length; i++) {
                        inputs[i].readOnly = !editing;
                        if (editing) {
                            inputs[i].value = '';
                            inputs[i].classList.remove('error');
                        }
                    }
                    var selects = document.querySelectorAll(selector + ' select');
                    for (var j = 0; j < selects.length; j++) {
                        selects[j].disabled = !editing;
                    }
                },
                _checkDMSElement: function _checkDMSElement(input, isFloat) {
                    var b = isFloat !== undefined;
                    var value = input.value;
                    if (b) {
                        value = value.replace(',', '.');
                    }
                    if (isNaN(value)) {
                        return false;
                    }
                    var v = parseFloat(value);
                    if (!b && (v | 0) !== v) {
                        return false;
                    }
                    var min = Number(input.dataset.min);
                    var max = Number(input.dataset.max);
                    return v >= min && v <= max;
                },
                _checkDMSDegrees: function _checkDMSDegrees(coordType, input) {
                    if (isNaN(input.value)) {
                        return false;
                    }
                    var v = parseFloat(input.value);
                    if ((v | 0) !== v) {
                        return false;
                    }
                    var min = Number(input.dataset.min);
                    var max = Number(input.dataset.max);
                    if (v < min || v > max) {
                        return false;
                    }
                    var inputMinutes = document.getElementById(this._addUID('GPmousePosition' + coordType + 'Minutes'));
                    var inputSeconds = document.getElementById(this._addUID('GPmousePosition' + coordType + 'Seconds'));
                    if (v >= max) {
                        inputMinutes.dataset.max = 0;
                        inputSeconds.dataset.max = 0;
                    } else {
                        inputMinutes.dataset.max = 59;
                        inputSeconds.dataset.max = 59.9999;
                    }
                    return true;
                },
                GPdisplayCoords: function GPdisplayCoords(coordinate) {
                    if (coordinate && coordinate != null) {
                        var labelLon = document.getElementById(this._addUID('GPmousePositionLonLabel'));
                        var labelLat = document.getElementById(this._addUID('GPmousePositionLatLabel'));
                        if (coordinate.x || coordinate.y) {
                            labelLat.innerHTML = 'X : ';
                            labelLon.innerHTML = 'Y : ';
                        } else if (coordinate.e || coordinate.n) {
                            labelLat.innerHTML = 'E : ';
                            labelLon.innerHTML = 'N : ';
                        } else {
                            labelLat.innerHTML = 'Latitude : ';
                            labelLon.innerHTML = 'Longitude : ';
                        }
                        if (_typeof(coordinate.lat) === 'object' && _typeof(coordinate.lng) === 'object') {
                            var parts = {
                                lng: 'Lon',
                                lat: 'Lat'
                            };
                            var units = [
                                'Degrees',
                                'Minutes',
                                'Seconds'
                            ];
                            for (var p in parts) {
                                for (var u = 0; u < units.length; ++u) {
                                    var selector = 'GPmousePosition' + parts[p] + units[u];
                                    var elt = document.getElementById(this._addUID(selector));
                                    var key = units[u].charAt(0).toLowerCase();
                                    elt.value = coordinate[p][key];
                                }
                            }
                            document.getElementById(this._addUID('GPmousePositionLonDirection')).value = coordinate.lng.direction;
                            document.getElementById(this._addUID('GPmousePositionLatDirection')).value = coordinate.lat.direction;
                        } else {
                            var elLat = document.getElementById(this._addUID('GPmousePositionLat'));
                            var elLon = document.getElementById(this._addUID('GPmousePositionLon'));
                            elLat.value = coordinate.x || coordinate.lat || coordinate.e || '0';
                            elLon.value = coordinate.y || coordinate.lng || coordinate.lon || coordinate.n || '0';
                            var unit = coordinate.unit === undefined ? '' : coordinate.unit;
                            var elements = document.getElementsByClassName('GPmousePositionUnits');
                            for (var n = 0; n < elements.length; ++n) {
                                elements[n].innerHTML = unit;
                            }
                        }
                    }
                },
                GPdisplayElevation: function GPdisplayElevation(coordinate, altitudeTimeoutDelay, noDataValue, noDataValueTolerance) {
                    var self = this;
                    var altitudeTimeout;
                    if (!altitudeTimeoutDelay) {
                        altitudeTimeoutDelay = 500;
                    }
                    clearTimeout(altitudeTimeout);
                    document.getElementById(this._addUID('GPmousePositionAlt')).innerHTML = '...';
                    if (noDataValue == null) {
                        noDataValue = -99999;
                    }
                    if (noDataValueTolerance == null) {
                        noDataValueTolerance = 99980;
                    }
                    var maxThreshold = noDataValue + noDataValueTolerance;
                    var minThreshold = noDataValue - noDataValueTolerance;
                    if (coordinate && coordinate != null) {
                        if (document.getElementById(this._addUID('GPmousePositionAltitude'))) {
                            altitudeTimeout = setTimeout(function () {
                                self.onRequestAltitude(coordinate, function (z) {
                                    if (minThreshold < z && z < maxThreshold) {
                                        self.GPresetElevation();
                                    } else {
                                        document.getElementById(self._addUID('GPmousePositionAlt')).innerHTML = z;
                                    }
                                });
                            }, altitudeTimeoutDelay);
                        }
                    }
                },
                GPresetElevation: function GPresetElevation() {
                    if (document.getElementById(this._addUID('GPmousePositionAltitude'))) {
                        document.getElementById(this._addUID('GPmousePositionAlt')).innerHTML = '---';
                    }
                }
            };
            exports.default = MousePositionDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _sortable = __webpack_require__(79);
            var _sortable2 = _interopRequireDefault(_sortable);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var LayerSwitcherDOM = {
                _createDraggableElement: function _createDraggableElement(elementDraggable, context) {
                    _sortable2.default.create(elementDraggable, {
                        handle: '.GPlayerName',
                        draggable: '.draggable-layer',
                        ghostClass: 'GPghostLayer',
                        animation: 200,
                        onEnd: function onEnd(e) {
                            context._onDragAndDropLayerClick(e);
                        }
                    });
                },
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPlayerSwitcher');
                    container.className = 'GPwidget';
                    return container;
                },
                _createMainLayersShowElement: function _createMainLayersShowElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowLayersList');
                    input.type = 'checkbox';
                    return input;
                },
                _createMainLayersElement: function _createMainLayersElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPlayersList');
                    div.className = 'GPpanel';
                    return div;
                },
                _createMainPictoElement: function _createMainPictoElement() {
                    var self = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowLayersListPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowLayersList');
                    label.title = 'Afficher/masquer le gestionnaire de couches';
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowLayersListOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    spanOpen.addEventListener('click', function () {
                        if (document.getElementById(self._addUID('GPshowLayersList')).checked) {
                            var layers = document.getElementsByClassName('GPlayerInfoOpened');
                            for (var i = 0; i < layers.length; i++) {
                                layers[i].className = 'GPlayerInfo';
                            }
                            document.getElementById(self._addUID('GPlayerInfoPanel')).className = 'GPlayerInfoPanelClosed';
                        }
                    });
                    label.appendChild(spanOpen);
                    var spanClose = document.createElement('span');
                    spanClose.addEventListener('click', function () {
                        if (document.getElementById(self._addUID('GPshowLayersList')).checked) {
                            var layers = document.getElementsByClassName('GPlayerInfoOpened');
                            for (var i = 0; i < layers.length; i++) {
                                layers[i].className = 'GPlayerInfo';
                            }
                            document.getElementById(self._addUID('GPlayerInfoPanel')).className = 'GPlayerInfoPanelClosed';
                        }
                    });
                    spanClose.id = self._addUID('GPshowLayersListClose');
                    label.appendChild(spanClose);
                    return label;
                },
                _createMainInfoElement: function _createMainInfoElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPlayerInfoPanel');
                    div.className = 'GPpanel GPlayerInfoPanelClosed';
                    return div;
                },
                _createContainerLayerElement: function _createContainerLayerElement(obj) {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPlayerSwitcher_ID_' + obj.id);
                    container.className = 'GPlayerSwitcher_layer draggable-layer';
                    container.appendChild(this._createBasicToolElement(obj));
                    var array = this._createAdvancedToolShowElement(obj);
                    for (var i = 0; i < array.length; i++) {
                        container.appendChild(array[i]);
                    }
                    container.appendChild(this._createAdvancedToolElement(obj));
                    return container;
                },
                _createBasicToolElement: function _createBasicToolElement(obj) {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPbasicTools_ID_' + obj.id);
                    div.className = 'GPlayerBasicTools';
                    div.appendChild(this._createBasicToolNameElement(obj));
                    var array = this._createBasicToolVisibilityElement(obj);
                    for (var i = 0; i < array.length; i++) {
                        div.appendChild(array[i]);
                    }
                    return div;
                },
                _createBasicToolNameElement: function _createBasicToolNameElement(obj) {
                    var span = document.createElement('span');
                    span.id = this._addUID('GPname_ID_' + obj.id);
                    span.className = 'GPlayerName';
                    span.title = obj.description || obj.title;
                    span.innerHTML = obj.title;
                    return span;
                },
                _createBasicToolVisibilityElement: function _createBasicToolVisibilityElement(obj) {
                    var list = [];
                    var checked = typeof obj.visibility !== 'undefined' ? obj.visibility : true;
                    var id = this._addUID('GPvisibility_ID_' + obj.id);
                    var input = document.createElement('input');
                    input.id = id;
                    input.type = 'checkbox';
                    input.checked = checked;
                    var label = document.createElement('label');
                    label.htmlFor = id;
                    label.id = this._addUID('GPvisibilityPicto_ID_' + obj.id);
                    label.className = 'GPlayerVisibility';
                    label.title = 'Afficher/masquer la couche';
                    var context = this;
                    if (input.addEventListener) {
                        input.addEventListener('click', function (e) {
                            context._onVisibilityLayerClick.call(context, e);
                        });
                    } else if (input.attachEvent) {
                        input.attachEvent('onclick', function (e) {
                            context._onVisibilityLayerClick.call(context, e);
                        });
                    }
                    list.push(input);
                    list.push(label);
                    return list;
                },
                _createAdvancedToolShowElement: function _createAdvancedToolShowElement(obj) {
                    var list = [];
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowAdvancedToolsPicto_ID_' + obj.id);
                    label.htmlFor = this._addUID('GPshowAdvancedTools_ID_' + obj.id);
                    label.title = 'Plus d\'outils';
                    label.className = 'GPshowMoreOptions GPshowLayerAdvancedTools';
                    var input = document.createElement('input');
                    input.type = 'checkbox';
                    input.id = this._addUID('GPshowAdvancedTools_ID_' + obj.id);
                    list.push(input);
                    list.push(label);
                    return list;
                },
                _createAdvancedToolElement: function _createAdvancedToolElement(obj) {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPadvancedTools_ID_' + obj.id);
                    container.className = 'GPlayerAdvancedTools';
                    container.appendChild(this._createAdvancedToolDeleteElement(obj));
                    if (obj.title && obj.description) {
                        container.appendChild(this._createAdvancedToolInformationElement(obj));
                    }
                    if (obj.type !== 'feature') {
                        var array = this._createAdvancedToolOpacityElement(obj);
                        for (var i = 0; i < array.length; i++) {
                            container.appendChild(array[i]);
                        }
                    }
                    return container;
                },
                _createAdvancedToolDeleteElement: function _createAdvancedToolDeleteElement(obj) {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPremove_ID_' + obj.id);
                    div.className = 'GPlayerRemove';
                    div.title = 'Supprimer la couche';
                    div.layerId = obj.id;
                    var context = this;
                    if (div.addEventListener) {
                        div.addEventListener('click', function (e) {
                            context._onDropLayerClick.call(context, e);
                        });
                    } else if (div.attachEvent) {
                        div.attachEvent('onclick', function (e) {
                            context._onDropLayerClick.call(context, e);
                        });
                    }
                    return div;
                },
                _createAdvancedToolInformationElement: function _createAdvancedToolInformationElement(obj) {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPinfo_ID_' + obj.id);
                    div.className = 'GPlayerInfo';
                    div.title = 'Informations/légende';
                    div.layerId = obj.id;
                    var context = this;
                    if (div.addEventListener) {
                        div.addEventListener('click', function (e) {
                            context._onOpenLayerInfoClick.call(context, e);
                        });
                    } else if (div.attachEvent) {
                        div.attachEvent('onclick', function (e) {
                            context._onOpenLayerInfoClick.call(context, e);
                        });
                    }
                    return div;
                },
                _createAdvancedToolOpacityElement: function _createAdvancedToolOpacityElement(obj) {
                    var list = [];
                    var divO = document.createElement('div');
                    divO.id = this._addUID('GPopacity_ID_' + obj.id);
                    divO.className = 'GPlayerOpacity';
                    divO.title = 'Opacité';
                    var opacity = typeof obj.opacity !== 'undefined' ? obj.opacity : 1;
                    opacity = Math.round(opacity * 100);
                    var input = document.createElement('input');
                    input.id = this._addUID('GPopacityValueDiv_ID_' + obj.id);
                    input.type = 'range';
                    input.value = opacity;
                    var context = this;
                    if (input.addEventListener) {
                        input.addEventListener('change', function (e) {
                            context._onChangeLayerOpacity.call(context, e);
                        });
                    } else if (input.attachEvent) {
                        input.attachEvent('onchange', function (e) {
                            context._onChangeLayerOpacity.call(context, e);
                        });
                    }
                    if (input.addEventListener) {
                        input.addEventListener('input', function (e) {
                            context._onChangeLayerOpacity.call(context, e);
                        });
                    } else if (input.attachEvent) {
                        input.attachEvent('oninput', function (e) {
                            context._onChangeLayerOpacity.call(context, e);
                        });
                    }
                    divO.appendChild(input);
                    var divC = document.createElement('div');
                    divC.id = this._addUID('GPopacityValueDiv_ID_' + obj.id);
                    divC.className = 'GPlayerOpacityValue';
                    var span = document.createElement('span');
                    span.id = this._addUID('GPopacityValue_ID_' + obj.id);
                    span.innerHTML = opacity + '%';
                    divC.appendChild(span);
                    list.push(divO);
                    list.push(divC);
                    return list;
                },
                _createContainerLayerInfoElement: function _createContainerLayerInfoElement(obj) {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPlayerInfoContent');
                    var title = document.createElement('div');
                    title.id = this._addUID('GPlayerInfoTitle');
                    title.innerHTML = obj.title;
                    container.appendChild(title);
                    if (obj.quicklookUrl) {
                        var quick = document.createElement('div');
                        quick.id = this._addUID('GPlayerInfoQuicklook');
                        quick.title = 'Afficher un aperçu de la couche';
                        var refquick = document.createElement('a');
                        refquick.href = obj.quicklookUrl;
                        refquick.appendChild(quick);
                        container.appendChild(refquick);
                    }
                    var close = document.createElement('div');
                    close.id = this._addUID('GPlayerInfoClose');
                    close.title = 'Fermer la fenêtre';
                    var self = this;
                    var onCloseClick = function onCloseClick() {
                        document.getElementById(self._addUID('GPlayerInfoPanel')).className = 'GPlayerInfoPanelClosed';
                        var layers = document.getElementsByClassName('GPlayerInfoOpened');
                        for (var i = 0; i < layers.length; i++) {
                            layers[i].className = 'GPlayerInfo';
                        }
                    };
                    if (close.addEventListener) {
                        close.addEventListener('click', onCloseClick);
                    } else if (close.attachEvent) {
                        close.attachEvent('onclick', onCloseClick);
                    }
                    container.appendChild(close);
                    var desc = document.createElement('div');
                    desc.id = this._addUID('GPlayerInfoDescription');
                    desc.innerHTML = obj.description;
                    container.appendChild(desc);
                    if (obj.metadata) {
                        var mtd = document.createElement('div');
                        mtd.id = this._addUID('GPlayerInfoMetadata');
                        var mtdtitle = document.createElement('div');
                        mtdtitle.className = 'GPlayerInfoSubtitle';
                        mtdtitle.innerHTML = 'Métadonnées';
                        mtd.appendChild(mtdtitle);
                        for (var i = 0; i < obj.metadata.length; i++) {
                            var urlmtd = obj.metadata[i].url;
                            var mtdlink = document.createElement('div');
                            mtdlink.className = 'GPlayerInfoLink';
                            var refmtd = document.createElement('a');
                            refmtd.href = urlmtd;
                            refmtd.innerHTML = urlmtd;
                            mtdlink.appendChild(refmtd);
                            mtd.appendChild(mtdlink);
                        }
                        if (obj.metadata.length !== 0) {
                            container.appendChild(mtd);
                        }
                    }
                    if (obj.legends) {
                        var lgd = document.createElement('div');
                        lgd.id = this._addUID('GPlayerInfoLegend');
                        var lgdtitle = document.createElement('div');
                        lgdtitle.className = 'GPlayerInfoSubtitle';
                        lgdtitle.innerHTML = 'Légende';
                        lgd.appendChild(lgdtitle);
                        var legends = {};
                        var maxScale = obj.maxScaleDenominator || 560000000;
                        for (var k = 0; k < obj.legends.length; k++) {
                            var minScale = obj.legends[k].minScaleDenominator;
                            if (minScale) {
                                var s = minScale.toString();
                                minScale = Math.round(parseInt(s.substring(0, 3), 10) / 10) * Math.pow(10, s.length - 2);
                            } else {
                                minScale = 270;
                            }
                            legends[minScale] = obj.legends[k];
                        }
                        for (var scale in legends) {
                            if (legends.hasOwnProperty(scale)) {
                                var urllgd = legends[scale].url;
                                if (typeof urllgd === 'string' && urllgd.toLowerCase().indexOf('nolegend.jpg') == -1) {
                                    var lgdlink = document.createElement('div');
                                    lgdlink.className = 'GPlayerInfoLink';
                                    maxScale = legends[scale].maxScaleDenominator || maxScale;
                                    var reflgd = document.createElement('a');
                                    reflgd.href = urllgd;
                                    reflgd.innerHTML = 'Du 1/' + scale + ' au 1/' + maxScale;
                                    lgdlink.appendChild(reflgd);
                                    lgd.appendChild(lgdlink);
                                } else {
                                    delete legends[scale];
                                }
                            }
                        }
                        if (Object.keys(legends).length !== 0) {
                            container.appendChild(lgd);
                        }
                    }
                    return container;
                }
            };
            exports.default = LayerSwitcherDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _proj = __webpack_require__(9);
            var _proj2 = _interopRequireDefault(_proj);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var Register = {
                isLoaded: false,
                get: function get(name) {
                    if (name === '' || name === null || typeof name === 'undefined') {
                        return;
                    }
                    var s = name.split(':');
                    if (s.length !== 2) {
                        return;
                    }
                    var register = s[0];
                    var code = s[1];
                    if (!this.hasOwnProperty(register)) {
                        return;
                    }
                    if (!this[register].hasOwnProperty(code)) {
                        return;
                    }
                    return this[register][code];
                },
                load: function load() {
                    if (!this.isLoaded) {
                        var registers = [
                            'IGNF',
                            'EPSG',
                            'CRS'
                        ];
                        for (var i = 0; i < registers.length; i++) {
                            var register = registers[i];
                            var codes = this[register];
                            for (var code in codes) {
                                if (codes.hasOwnProperty(code)) {
                                    var name = register + ':' + code;
                                    _proj2.default.defs(name, this.get(name));
                                }
                            }
                        }
                        this.isLoaded = true;
                    }
                },
                EPSG: {
                    4149: '+title=CH1903 +proj=longlat +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +no_defs ',
                    4150: '+title=CH1903plus +proj=longlat +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +no_defs ',
                    4151: '+title=CHTRF95 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ',
                    4171: '+title=RGF93 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ',
                    4230: '+title=ED50 +proj=longlat +ellps=intl +no_defs ',
                    4235: '+title=Guyane Francaise +proj=longlat +ellps=intl +no_defs ',
                    4258: '+title=ETRS89 +proj=longlat +ellps=GRS80 +no_defs ',
                    4275: '+title=NTF +proj=longlat +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +no_defs ',
                    4322: '+title=WGS 72 +proj=longlat +ellps=WGS72 +no_defs ',
                    4326: '+title=WGS 84 +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs ',
                    4467: '+proj=utm +zone=21 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    4470: '+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ',
                    4471: '+proj=utm +zone=38 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    4474: '+proj=utm +zone=38 +south +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +units=m +no_defs ',
                    4558: '+proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ',
                    4559: '+proj=utm +zone=20 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    4621: '+title=Fort Marigot +proj=longlat +ellps=intl +towgs84=137,248,-430,0,0,0,0 +no_defs ',
                    4622: '+title=Guadeloupe 1948 +proj=longlat +ellps=intl +no_defs ',
                    4623: '+title=CSG67 +proj=longlat +ellps=intl +towgs84=-186,230,110,0,0,0,0 +no_defs ',
                    4624: '+title=RGFG95 +proj=longlat +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +no_defs ',
                    4625: '+title=Martinique 1938 +proj=longlat +ellps=intl +no_defs ',
                    4626: '+title=Reunion 1947 +proj=longlat +ellps=intl +no_defs ',
                    4627: '+title=RGR92 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ',
                    4628: '+title=Tahiti 52 +proj=longlat +ellps=intl +towgs84=162,117,154,0,0,0,0 +no_defs ',
                    4629: '+title=Tahaa 54 +proj=longlat +ellps=intl +no_defs ',
                    4630: '+title=IGN72 Nuku Hiva +proj=longlat +ellps=intl +no_defs ',
                    4632: '+title=Combani 1950 +proj=longlat +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +no_defs ',
                    4633: '+title=IGN56 Lifou +proj=longlat +ellps=intl +no_defs ',
                    4634: '+title=IGN72 Grand Terre +proj=longlat +ellps=intl +no_defs ',
                    4637: '+title=Perroud 1950 +proj=longlat +ellps=intl +towgs84=325,154,172,0,0,0,0 +no_defs ',
                    4638: '+title=Saint Pierre et Miquelon 1950 +proj=longlat +ellps=clrk66 +towgs84=30,430,368,0,0,0,0 +no_defs ',
                    4640: '+title=RRAF 1991 +proj=longlat +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +no_defs ',
                    4641: '+title=IGN53 Mare +proj=longlat +ellps=intl +no_defs ',
                    4645: '+title=RGNC 1991 +proj=longlat +ellps=intl +towgs84=0,0,0,0,0,0,0 +no_defs ',
                    4687: '+proj=longlat +ellps=GRS80 +no_defs ',
                    4662: '+title=IGN72 Grande Terre +proj=longlat +ellps=intl +no_defs ',
                    4689: '+title=IGN63 Hiva Oa +proj=longlat +ellps=intl +no_defs ',
                    4690: '+title=Tahiti 79 +proj=longlat +ellps=intl +no_defs ',
                    4691: '+title=Moorea 87 +proj=longlat +ellps=intl +towgs84=215.525,149.593,176.229,-3.2624,-1.692,-1.1571,10.4773 +no_defs ',
                    4692: '+title=Maupiti 83 +proj=longlat +ellps=intl +towgs84=217.037,86.959,23.956,0,0,0,0 +no_defs ',
                    4698: '+title=IGN 1962 Kerguelen +proj=longlat +ellps=intl +towgs84=145,-187,103,0,0,0,0 +no_defs ',
                    4749: '+title=RGNC91-93 +proj=longlat +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +no_defs ',
                    4750: '+title=ST87 Ouvea +proj=longlat +ellps=WGS84 +towgs84=-56.263,16.136,-22.856,0,0,0,0 +no_defs ',
                    4807: '+title=NTF (Paris) +proj=longlat +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +no_defs ',
                    2056: '+title=CH1903+ / LV95 +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=2600000 +y_0=1200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs ',
                    2154: '+title=RGF93 / Lambert-93 +proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    2213: '+title=ETRS89 / TM 30 NE +proj=tmerc +lat_0=0 +lon_0=30 +k=0.9996 +x_0=500000 +y_0=0 +ellps=GRS80 +units=m +no_defs ',
                    2969: '+title=Fort Marigot / UTM zone 20N +proj=utm +zone=20 +ellps=intl +towgs84=137,248,-430,0,0,0,0 +units=m +no_defs ',
                    2970: '+title=Guadeloupe 1948 / UTM zone 20N +proj=utm +zone=20 +ellps=intl +units=m +no_defs ',
                    2971: '+title=CSG67 / UTM zone 22N +proj=utm +zone=22 +ellps=intl +towgs84=-186,230,110,0,0,0,0 +units=m +no_defs ',
                    2972: '+title=RGFG95 / UTM zone 22N +proj=utm +zone=22 +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +units=m +no_defs ',
                    2973: '+title=Martinique 1938 / UTM zone 20N +proj=utm +zone=20 +ellps=intl +units=m +no_defs ',
                    2975: '+title=RGR92 / UTM zone 40S +proj=utm +zone=40 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    2976: '+title=Tahiti 52 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +towgs84=162,117,154,0,0,0,0 +units=m +no_defs ',
                    2977: '+title=Tahaa 54 / UTM zone 5S +proj=utm +zone=5 +south +ellps=intl +units=m +no_defs ',
                    2978: '+title=IGN72 Nuku Hiva / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +units=m +no_defs ',
                    2980: '+title=Combani 1950 / UTM zone 38S +proj=utm +zone=38 +south +ellps=intl +towgs84=-382,-59,-262,0,0,0,0 +units=m +no_defs ',
                    2981: '+title=IGN56 Lifou / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ',
                    2982: '+title=IGN72 Grand Terre / UTM zone 58S (deprecated) +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ',
                    2984: '+title=RGNC 1991 / Lambert New Caledonia (deprecated) +proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=intl +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    2986: '+title=Terre Adelie 1950 +proj=stere +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-90.000000000 +lon_0=140.000000000 +lat_ts=-67.000000000 +k=0.96027295 +x_0=300000.000 +y_0=-2299363.482 +units=m +no_defs',
                    2987: '+title=Saint Pierre et Miquelon 1950 / UTM zone 21N +proj=utm +zone=21 +ellps=clrk66 +towgs84=30,430,368,0,0,0,0 +units=m +no_defs ',
                    2989: '+title=RRAF 1991 / UTM zone 20N +proj=utm +zone=20 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    2990: '+title=Reunion 1947 / TM Reunion (deprecated) +proj=tmerc +lat_0=-21.11666666666667 +lon_0=55.53333333333333 +k=1 +x_0=50000 +y_0=160000 +ellps=intl +units=m +no_defs ',
                    2995: '+title=IGN53 Mare / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ',
                    3038: '+proj=utm +zone=26 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3039: '+proj=utm +zone=27 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3040: '+proj=utm +zone=28 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3041: '+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3045: '+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3046: '+proj=utm +zone=34 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3047: '+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3048: '+proj=utm +zone=36 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3049: '+proj=utm +zone=37 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3050: '+proj=utm +zone=38 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3051: '+proj=utm +zone=39 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3034: '+title=ETRS89 / ETRS-LCC +proj=lcc +lat_1=35 +lat_2=65 +lat_0=52 +lon_0=10 +x_0=4000000 +y_0=2800000 +ellps=GRS80 +units=m +no_defs ',
                    3035: '+title=ETRS89 / ETRS-LAEA +proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs ',
                    3042: '+title=ETRS89 / ETRS-TM30 +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs ',
                    3043: '+title=ETRS89 / ETRS-TM31 +proj=utm +zone=31 +ellps=GRS80 +units=m +no_defs ',
                    3044: '+title=ETRS89 / ETRS-TM32 +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs ',
                    25828: '+proj=utm +zone=28 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    25829: '+proj=utm +zone=29 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    25833: '+proj=utm +zone=33 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    25834: '+proj=utm +zone=34 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    25835: '+proj=utm +zone=35 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    25836: '+proj=utm +zone=36 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    25837: '+proj=utm +zone=37 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    25838: '+proj=utm +zone=38 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3060: '+title=IGN72 Grande Terre / UTM zone 58S +proj=utm +zone=58 +south +ellps=intl +units=m +no_defs ',
                    3163: '+title=RGNC91-93 / Lambert New Caledonia +proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3164: '+title=ST87 Ouvea / UTM zone 58S +proj=utm +zone=58 +south +ellps=WGS84 +towgs84=-56.263,16.136,-22.856,0,0,0,0 +units=m +no_defs ',
                    3165: '+title=NEA74 Noumea / Noumea Lambert +proj=lcc +lat_1=-22.24469175 +lat_2=-22.29469175 +lat_0=-22.26969175 +lon_0=166.44242575 +x_0=0.66 +y_0=1.02 +ellps=intl +units=m +no_defs ',
                    3166: '+title=NEA74 Noumea / Noumea Lambert 2 +proj=lcc +lat_1=-22.24472222222222 +lat_2=-22.29472222222222 +lat_0=-22.26972222222222 +lon_0=166.4425 +x_0=8.313000000000001 +y_0=-2.354 +ellps=intl +units=m +no_defs ',
                    3169: '+title=RGNC91-93 / UTM zone 57S +proj=utm +zone=57 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3170: '+title=RGNC91-93 / UTM zone 58S +proj=utm +zone=58 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3171: '+title=RGNC91-93 / UTM zone 59S +proj=utm +zone=59 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs ',
                    3172: '+title=IGN53 Mare / UTM zone 59S +proj=utm +zone=59 +south +ellps=intl +units=m +no_defs ',
                    3296: '+title=RGPF / UTM zone 5S +proj=utm +zone=5 +south +ellps=GRS80 +units=m +no_defs ',
                    3297: '+title=RGPF / UTM zone 6S +proj=utm +zone=6 +south +ellps=GRS80 +units=m +no_defs ',
                    3298: '+title=RGPF / UTM zone 7S +proj=utm +zone=7 +south +ellps=GRS80 +units=m +no_defs ',
                    3299: '+title=RGPF / UTM zone 8S +proj=utm +zone=8 +south +ellps=GRS80 +units=m +no_defs ',
                    3302: '+title=IGN63 Hiva Oa / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +units=m +no_defs ',
                    3303: '+title=Fatu Iva 72 / UTM zone 7S +proj=utm +zone=7 +south +ellps=intl +towgs84=347.103,1078.12,2623.92,-33.8875,70.6773,-9.3943,186.074 +units=m +no_defs ',
                    3304: '+title=Tahiti 79 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +units=m +no_defs ',
                    3305: '+title=Moorea 87 / UTM zone 6S +proj=utm +zone=6 +south +ellps=intl +towgs84=215.525,149.593,176.229,-3.2624,-1.692,-1.1571,10.4773 +units=m +no_defs ',
                    3306: '+title=Maupiti 83 / UTM zone 5S +proj=utm +zone=5 +south +ellps=intl +towgs84=217.037,86.959,23.956,0,0,0,0 +units=m +no_defs ',
                    3312: '+title=CSG67 / UTM zone 21N +proj=utm +zone=21 +ellps=intl +towgs84=-186,230,110,0,0,0,0 +units=m +no_defs ',
                    3313: '+title=RGFG95 / UTM zone 21N +proj=utm +zone=21 +ellps=GRS80 +towgs84=2,2,-2,0,0,0,0 +units=m +no_defs ',
                    3336: '+title=IGN 1962 Kerguelen / UTM zone 42S +proj=utm +zone=42 +south +ellps=intl +towgs84=145,-187,103,0,0,0,0 +units=m +no_defs ',
                    3395: '+title=WGS 84 / World Mercator +proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    3727: '+title=Reunion 1947 / TM Reunion +proj=tmerc +lat_0=-21.11666666666667 +lon_0=55.53333333333333 +k=1 +x_0=160000 +y_0=50000 +ellps=intl +units=m +no_defs ',
                    21781: '+title=CH1903 / LV03 +proj=somerc +lat_0=46.95240555555556 +lon_0=7.439583333333333 +x_0=600000 +y_0=200000 +ellps=bessel +towgs84=674.374,15.056,405.346,0,0,0,0 +units=m +no_defs ',
                    25830: '+title=ETRS89 / UTM zone 30N +proj=utm +zone=30 +ellps=GRS80 +units=m +no_defs ',
                    25831: '+title=ETRS89 / UTM zone 31N +proj=utm +zone=31 +ellps=GRS80 +units=m +no_defs ',
                    25832: '+title=ETRS89 / UTM zone 32N +proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs ',
                    27561: '+title=NTF (Paris) / Lambert Nord France +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27562: '+title=NTF (Paris) / Lambert Centre France +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27563: '+title=NTF (Paris) / Lambert Sud France +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27564: '+title=NTF (Paris) / Lambert Corse +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27571: '+title=NTF (Paris) / Lambert zone I +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27572: '+title=NTF (Paris) / Lambert zone II +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27573: '+title=NTF (Paris) / Lambert zone III +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27574: '+title=NTF (Paris) / Lambert zone IV +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27581: '+title=NTF (Paris) / France I (deprecated) +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=1200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27582: '+title=NTF (Paris) / France II (deprecated) +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27583: '+title=NTF (Paris) / France III (deprecated) +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=3200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27584: '+title=NTF (Paris) / France IV (deprecated) +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=4185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27591: '+title=NTF (Paris) / Nord France (deprecated) +proj=lcc +lat_1=49.50000000000001 +lat_0=49.50000000000001 +lon_0=0 +k_0=0.999877341 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27592: '+title=NTF (Paris) / Centre France (deprecated) +proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27593: '+title=NTF (Paris) / Sud France (deprecated) +proj=lcc +lat_1=44.10000000000001 +lat_0=44.10000000000001 +lon_0=0 +k_0=0.9998774990000001 +x_0=600000 +y_0=200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    27594: '+title=NTF (Paris) / Corse (deprecated) +proj=lcc +lat_1=42.16500000000001 +lat_0=42.16500000000001 +lon_0=0 +k_0=0.9999447100000001 +x_0=234.358 +y_0=185861.369 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs ',
                    32601: '+proj=utm +zone=1 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32602: '+proj=utm +zone=2 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32603: '+proj=utm +zone=3 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32604: '+proj=utm +zone=4 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32605: '+proj=utm +zone=5 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32606: '+proj=utm +zone=6 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32607: '+proj=utm +zone=7 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32608: '+proj=utm +zone=8 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32609: '+proj=utm +zone=9 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32610: '+proj=utm +zone=10 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32611: '+proj=utm +zone=11 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32612: '+proj=utm +zone=12 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32613: '+proj=utm +zone=13 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32614: '+proj=utm +zone=14 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32615: '+proj=utm +zone=15 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32616: '+proj=utm +zone=16 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32617: '+proj=utm +zone=17 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32618: '+proj=utm +zone=18 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32619: '+proj=utm +zone=19 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32620: '+proj=utm +zone=20 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32621: '+proj=utm +zone=21 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32622: '+proj=utm +zone=22 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32623: '+proj=utm +zone=23 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32624: '+proj=utm +zone=24 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32625: '+proj=utm +zone=25 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32626: '+proj=utm +zone=26 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32627: '+proj=utm +zone=27 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32628: '+proj=utm +zone=28 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32629: '+proj=utm +zone=29 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32630: '+proj=utm +zone=30 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32631: '+proj=utm +zone=31 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32632: '+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32633: '+proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32634: '+proj=utm +zone=34 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32635: '+proj=utm +zone=35 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32636: '+proj=utm +zone=36 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32637: '+proj=utm +zone=37 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32638: '+proj=utm +zone=38 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32639: '+proj=utm +zone=39 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32640: '+proj=utm +zone=40 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32641: '+proj=utm +zone=41 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32642: '+proj=utm +zone=42 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32643: '+proj=utm +zone=43 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32644: '+proj=utm +zone=44 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32645: '+proj=utm +zone=45 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32646: '+proj=utm +zone=46 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32647: '+proj=utm +zone=47 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32648: '+proj=utm +zone=48 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32649: '+proj=utm +zone=49 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32650: '+proj=utm +zone=50 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32651: '+proj=utm +zone=51 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32652: '+proj=utm +zone=52 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32653: '+proj=utm +zone=53 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32654: '+proj=utm +zone=54 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32655: '+proj=utm +zone=55 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32656: '+proj=utm +zone=56 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32657: '+proj=utm +zone=57 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32658: '+proj=utm +zone=58 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32659: '+proj=utm +zone=59 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32660: '+proj=utm +zone=60 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32661: '+proj=stere +lat_0=90 +lat_ts=90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32662: '+title=WGS 84 / Plate Carree +proj=eqc +lat_ts=0 +lon_0=0 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32701: '+proj=utm +zone=1 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32702: '+proj=utm +zone=2 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32703: '+proj=utm +zone=3 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32704: '+proj=utm +zone=4 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32705: '+proj=utm +zone=5 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32706: '+proj=utm +zone=6 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32707: '+proj=utm +zone=7 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32708: '+proj=utm +zone=8 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32709: '+proj=utm +zone=9 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32710: '+proj=utm +zone=10 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32711: '+proj=utm +zone=11 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32712: '+proj=utm +zone=12 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32713: '+proj=utm +zone=13 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32714: '+proj=utm +zone=14 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32715: '+proj=utm +zone=15 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32716: '+proj=utm +zone=16 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32717: '+proj=utm +zone=17 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32718: '+proj=utm +zone=18 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32719: '+proj=utm +zone=19 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32720: '+proj=utm +zone=20 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32721: '+proj=utm +zone=21 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32722: '+proj=utm +zone=22 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32723: '+proj=utm +zone=23 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32724: '+proj=utm +zone=24 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32725: '+proj=utm +zone=25 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32726: '+proj=utm +zone=26 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32727: '+proj=utm +zone=27 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32728: '+proj=utm +zone=28 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32729: '+proj=utm +zone=29 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32730: '+proj=utm +zone=30 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32731: '+proj=utm +zone=31 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32732: '+proj=utm +zone=32 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32733: '+proj=utm +zone=33 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32734: '+proj=utm +zone=34 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32735: '+proj=utm +zone=35 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32736: '+proj=utm +zone=36 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32737: '+proj=utm +zone=37 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32738: '+proj=utm +zone=38 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32739: '+proj=utm +zone=39 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32740: '+proj=utm +zone=40 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32741: '+proj=utm +zone=41 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32742: '+proj=utm +zone=42 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32743: '+proj=utm +zone=43 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32744: '+proj=utm +zone=44 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32745: '+proj=utm +zone=45 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32746: '+proj=utm +zone=46 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32747: '+proj=utm +zone=47 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32748: '+proj=utm +zone=48 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32749: '+proj=utm +zone=49 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32750: '+proj=utm +zone=50 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32751: '+proj=utm +zone=51 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32752: '+proj=utm +zone=52 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32753: '+proj=utm +zone=53 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32754: '+proj=utm +zone=54 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32755: '+proj=utm +zone=55 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32756: '+proj=utm +zone=56 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32757: '+proj=utm +zone=57 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32758: '+proj=utm +zone=58 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32759: '+proj=utm +zone=59 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32760: '+proj=utm +zone=60 +south +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    32761: '+proj=stere +lat_0=-90 +lat_ts=-90 +lon_0=0 +k=0.994 +x_0=2000000 +y_0=2000000 +ellps=WGS84 +datum=WGS84 +units=m +no_defs ',
                    310024802: '+title=Geoportail - France metropolitaine +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=46.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310915814: '+title=Geoportail - Antilles francaises +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310486805: '+title=Geoportail - Guyane +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=4.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310700806: '+title=Geoportail - Reunion et dependances +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-21.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310702807: '+title=Geoportail - Mayotte +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-12.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310706808: '+title=Geoportail - Saint-Pierre et Miquelon +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=47.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310547809: '+title=Geoportail - Nouvelle-Caledonie +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-22.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310642810: '+title=Geoportail - Wallis et Futuna +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-14.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310032811: '+title=Geoportail - Polynesie francaise +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310642812: '+title=Geoportail - Kerguelen +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-49.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310642801: '+title=Geoportail - Crozet +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-46.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310642813: '+title=Geoportail - Amsterdam et Saint-Paul +proj=eqc +nadgrids=null +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-38.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    310642901: '+title=Geoportail - Monde +proj=mill +towgs84=0.0000,0.0000,0.0000,0.0000,0.0000,0.0000,0.000000 +a=6378137.0000 +rf=298.2572221010000 +lon_0=0.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    5489: '+title=RGAF09 geographiques (dms) +proj=longlat +nadgrids=@null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137 +rf=298.257222101 +units=m +no_defs',
                    5490: '+title=RGAF09 UTM Nord Fuseau 20 +proj=tmerc +nadgrids=@null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137 +rf=298.257222101 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs'
                },
                CRS: { 84: '+title=WGS 84 longitude-latitude +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs ' },
                IGNF: {
                    AMST63: '+title=Amsterdam 1963 +proj=geocent +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    CROZ63: '+title=Crozet 1963 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    CSG67: '+title=Guyane CSG67 +proj=geocent +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    ED50: '+title=ED50 +proj=geocent +towgs84=-84.0000,-97.0000,-117.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    ETRS89: '+title=Systeme de reference terrestre Europeen (1989) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    GUAD48: '+title=Guadeloupe Ste Anne +proj=geocent +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    GUADFM49: '+title=Guadeloupe Fort Marigot +proj=geocent +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    IGN63: '+title=IGN 1963 (Hiva Oa, Tahuata, Mohotani) +proj=geocent +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    IGN72: '+title=IGN 1972 Grande-Terre / Ile des Pins +proj=geocent +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    KERG62CAR: '+title=Kerguelen - K0 +proj=geocent +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    MART38: '+title=Martinique Fort-Desaix +proj=geocent +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    MAYO50: '+title=Mayotte Combani +proj=geocent +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    MOOREA87: '+title=Moorea 1987 +proj=geocent +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    NTF: '+title=Nouvelle Triangulation Francaise +proj=geocent +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +units=m +no_defs',
                    NUKU72: '+title=IGN 1972 Nuku Hiva +proj=geocent +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    REUN47: '+title=Reunion 1947 +proj=geocent +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    RGF93: '+title=Reseau geodesique francais 1993 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGFG95: '+title=Reseau geodesique francais de Guyane 1995 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGM04: '+title=RGM04 (Reseau Geodesique de Mayotte 2004) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGNC: '+title=Reseau Geodesique de Nouvelle-Caledonie +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGPF: '+title=RGPF (Reseau Geodesique de Polynesie Francaise) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGR92: '+title=Reseau geodesique Reunion 1992 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGSPM06: '+title=Reseau Geodesique Saint-Pierre-et-Miquelon (2006) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGTAAF07: '+title=Reseau Geodesique des TAAF (2007) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RRAF91: '+title=RRAF 1991 (Reseau de Reference des Antilles Francaises) +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    STPL69: '+title=Saint-Paul 1969 +proj=geocent +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    STPM50: '+title=St Pierre et Miquelon 1950 +proj=geocent +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +units=m +no_defs',
                    TAHAA: '+title=Raiatea - Tahaa 51-54 (Tahaa, Base Terme Est) +proj=geocent +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    TAHI79: '+title=IGN79 (Tahiti) Iles de la Societe +proj=geocent +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    TERA50: '+title=Pointe Geologie - Perroud 1950 +proj=geocent +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    WALL78: '+title=Wallis-Uvea 1978 (MOP78) +proj=geocent +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    WGS72: '+title=World Geodetic System 1972 +proj=geocent +towgs84=0.0000,12.0000,6.0000 +a=6378135.0000 +rf=298.2600000000000 +units=m +no_defs',
                    WGS84: '+title=World Geodetic System 1984 +proj=geocent +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    AMST63GEO: '+title=Amsterdam 1963 +proj=longlat +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    CROZ63GEO: '+title=Crozet 1963 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    CSG67GEO: '+title=Guyane CSG67 +proj=longlat +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    ED50G: '+title=ED50 +proj=longlat +towgs84=-84.0000,-97.0000,-117.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    GUAD48GEO: '+title=Guadeloupe Ste Anne +proj=longlat +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    GUADFM49GEO: '+title=Guadeloupe Fort Marigot +proj=longlat +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    IGN63GEO: '+title=IGN 1963 (Hiva Oa, Tahuata, Mohotani) +proj=longlat +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    IGN72GEO: '+title=IGN 1972 Grande-Terre / Ile des Pins +proj=longlat +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    KERG62GEO: '+title=Kerguelen - K0 +proj=longlat +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    MART38GEO: '+title=Martinique Fort-Desaix +proj=longlat +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    MAYO50GEO: '+title=Mayotte Combani +proj=longlat +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    MOOREA87GEO: '+title=Moorea 1987 +proj=longlat +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    NTFG: '+title=Nouvelle Triangulation Francaise Greenwich degres sexagesimaux +proj=longlat +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +units=m +no_defs',
                    NTFP: '+title=Nouvelle Triangulation Francaise Paris grades +proj=longlat +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +units=m +no_defs',
                    NUKU72GEO: '+title=IGN 1972 Nuku Hiva +proj=longlat +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    REUN47GEO: '+title=Reunion 1947 +proj=longlat +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    RGF93G: '+title=Reseau geodesique francais 1993 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGFG95GEO: '+title=Reseau geodesique francais de Guyane 1995 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGM04GEO: '+title=RGM04 (Reseau Geodesique de Mayotte 2004) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGNCGEO: '+title=Reseau Geodesique de Nouvelle-Caledonie +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGPFGEO: '+title=RGPF (Reseau Geodesique de Polynesie Francaise) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGR92GEO: '+title=Reseau geodesique de la Reunion 1992 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGSPM06GEO: '+title=Saint-Pierre-et-Miquelon (2006) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    RGTAAF07G: '+title=Reseau Geodesique des TAAF (2007) (dms) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    STPL69GEO: '+title=Saint-Paul 1969 +proj=longlat +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    STPM50GEO: '+title=St Pierre et Miquelon 1950  +proj=longlat +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +units=m +no_defs',
                    TAHAAGEO: '+title=Raiatea - Tahaa 51-54 (Tahaa, Base Terme Est) +proj=longlat +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    TAHI79GEO: '+title=IGN79 (Tahiti) Iles de la Societe +proj=longlat +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    TERA50G: '+title=Pointe Geologie - Perroud 1950 +proj=longlat +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    WALL78GEO: '+title=Wallis - Uvea 1978 (MOP78) +proj=longlat +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +units=m +no_defs',
                    WGS72G: '+title=WGS72 +proj=longlat +towgs84=0.0000,12.0000,6.0000 +a=6378135.0000 +rf=298.2600000000000 +units=m +no_defs',
                    WGS84G: '+title=World Geodetic System 1984 +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    WGS84RRAFGEO: '+title=Reseau de reference des Antilles francaises (1988-1991) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    XGEO: '+title=Systeme CIO-BIH +proj=longlat +towgs84=0.0000,0.0000,0.5000,0.0000,0.0000,0.0140,-0.100000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    AMST63UTM43S: '+title=Amsterdam 1963 UTM fuseau 43 Sud +proj=tmerc +towgs84=109.753,-528.133,-362.244,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    CROZ63UTM39S: '+title=Crozet 1963 +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    CSG67UTM21: '+title=Guyane CSG67 UTM fuseau 21 +proj=tmerc +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    CSG67UTM22: '+title=Guyane CSG67 UTM fuseau 22 +proj=tmerc +towgs84=-193.0660,236.9930,105.4470,0.4814,-0.8074,0.1276,1.564900 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALANF: '+title=Geoportail - Antilles francaises +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALASP: '+title=Geoportail - Amsterdam et Saint-Paul +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-38.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALCRZ: '+title=Geoportail - Crozet +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-46.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALFXX: '+title=Geoportail - France metropolitaine +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=46.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALGUF: '+title=Geoportail - Guyane +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=4.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALKER: '+title=Geoportail - Kerguelen +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-49.500000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALMYT: '+title=Geoportail - Mayotte +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-12.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALNCL: '+title=Geoportail - Nouvelle-Caledonie +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-22.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALPYF: '+title=Geoportail - Polynesie francaise +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-15.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALREU: '+title=Geoportail - Reunion et dependances +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-21.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALSPM: '+title=Geoportail - Saint-Pierre et Miquelon +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=47.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GEOPORTALWLF: '+title=Geoportail - Wallis et Futuna +proj=eqc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=0.000000000 +lat_ts=-14.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    GUAD48UTM20: '+title=Guadeloupe Ste Anne +proj=tmerc +towgs84=-472.2900,-5.6300,-304.1200,0.4362,-0.8374,0.2563,1.898400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    GUADFM49U20: '+title=Guadeloupe Fort Marigot  +proj=tmerc +towgs84=136.5960,248.1480,-429.7890 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    IGN63UTM7S: '+title=IGN 1963 - Hiva Oa, Tahuata, Mohotani - UTM fuseau 7 Sud +proj=tmerc +towgs84=410.7210,55.0490,80.7460,-2.5779,-2.3514,-0.6664,17.331100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    IGN72UTM58S: '+title=IGN 1972 - UTM fuseau 58 Sud +proj=tmerc +towgs84=-11.6400,-348.6000,291.6800 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=165.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    KERG62UTM42S: '+title=Kerguelen 1962 +proj=tmerc +towgs84=144.8990,-186.7700,100.9230 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=69.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    LAMB1: '+title=Lambert I +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=49.500000000 +lon_0=0.000000000 +k_0=0.99987734 +lat_1=49.500000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs',
                    LAMB1C: '+title=Lambert I Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=49.500000000 +lon_0=0.000000000 +k_0=0.99987734 +lat_1=49.500000000 +x_0=600000.000 +y_0=1200000.000 +units=m +no_defs',
                    LAMB2: '+title=Lambert II +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs',
                    LAMB2C: '+title=Lambert II Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=2200000.000 +units=m +no_defs',
                    LAMB3: '+title=Lambert III +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=44.100000000 +lon_0=0.000000000 +k_0=0.99987750 +lat_1=44.100000000 +x_0=600000.000 +y_0=200000.000 +units=m +no_defs',
                    LAMB3C: '+title=Lambert III Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=44.100000000 +lon_0=0.000000000 +k_0=0.99987750 +lat_1=44.100000000 +x_0=600000.000 +y_0=3200000.000 +units=m +no_defs',
                    LAMB4: '+title=Lambert IV +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=42.165000000 +lon_0=0.000000000 +k_0=0.99994471 +lat_1=42.165000000 +x_0=234.358 +y_0=185861.369 +units=m +no_defs',
                    LAMB4C: '+title=Lambert IV Carto +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=42.165000000 +lon_0=0.000000000 +k_0=0.99994471 +lat_1=42.165000000 +x_0=234.358 +y_0=4185861.369 +units=m +no_defs',
                    LAMB93: '+title=Lambert 93 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=46.500000000 +lon_0=3.000000000 +lat_1=44.000000000 +lat_2=49.000000000 +x_0=700000.000 +y_0=6600000.000 +units=m +no_defs',
                    RGF93CC42: '+title=Lambert conique conforme Zone 1 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=42.000000000 +lon_0=3.000000000 +lat_1=41.200000000 +lat_2=42.800000000 +x_0=1700000.000 +y_0=1200000.000 +units=m +no_defs',
                    RGF93CC43: '+title=Lambert conique conforme Zone 2 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=43.000000000 +lon_0=3.000000000 +lat_1=42.200000000 +lat_2=43.800000000 +x_0=1700000.000 +y_0=2200000.000 +units=m +no_defs',
                    RGF93CC44: '+title=Lambert conique conforme Zone 3 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=44.000000000 +lon_0=3.000000000 +lat_1=43.200000000 +lat_2=44.800000000 +x_0=1700000.000 +y_0=3200000.000 +units=m +no_defs',
                    RGF93CC45: '+title=Lambert conique conforme Zone 4 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=45.000000000 +lon_0=3.000000000 +lat_1=44.200000000 +lat_2=45.800000000 +x_0=1700000.000 +y_0=4200000.000 +units=m +no_defs',
                    RGF93CC46: '+title=Lambert conique conforme Zone 5 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=46.000000000 +lon_0=3.000000000 +lat_1=45.200000000 +lat_2=46.800000000 +x_0=1700000.000 +y_0=5200000.000 +units=m +no_defs',
                    RGF93CC47: '+title=Lambert conique conforme Zone 6 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=47.000000000 +lon_0=3.000000000 +lat_1=46.200000000 +lat_2=47.800000000 +x_0=1700000.000 +y_0=6200000.000 +units=m +no_defs',
                    RGF93CC48: '+title=Lambert conique conforme Zone 7 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=48.000000000 +lon_0=3.000000000 +lat_1=47.200000000 +lat_2=48.800000000 +x_0=1700000.000 +y_0=7200000.000 +units=m +no_defs',
                    RGF93CC49: '+title=Lambert conique conforme Zone 8 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=49.000000000 +lon_0=3.000000000 +lat_1=48.200000000 +lat_2=49.800000000 +x_0=1700000.000 +y_0=8200000.000 +units=m +no_defs',
                    RGF93CC50: '+title=Lambert conique conforme Zone 9 +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=50.000000000 +lon_0=3.000000000 +lat_1=49.200000000 +lat_2=50.800000000 +x_0=1700000.000 +y_0=9200000.000 +units=m +no_defs',
                    LAMBE: '+title=Lambert II etendu +proj=lcc +nadgrids=ntf_r93.gsb,null +wktext +towgs84=-168.0000,-60.0000,320.0000 +a=6378249.2000 +rf=293.4660210000000 +pm=2.337229167 +lat_0=46.800000000 +lon_0=0.000000000 +k_0=0.99987742 +lat_1=46.800000000 +x_0=600000.000 +y_0=2200000.000 +units=m +no_defs',
                    MART38UTM20: '+title=Martinique Fort-Desaix +proj=tmerc +towgs84=126.9260,547.9390,130.4090,-2.7867,5.1612,-0.8584,13.822650 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    MAYO50UTM38S: '+title=Mayotte Combani +proj=tmerc +towgs84=-599.9280,-275.5520,-195.6650,-0.0835,-0.4715,0.0602,49.281400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    MILLER: '+title=Geoportail - Monde +proj=mill +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lon_0=0.000000000 +x_0=0.000 +y_0=0.000 +units=m +no_defs',
                    MOOREA87U6S: '+title=Moorea 1987 - UTM fuseau 6 Sud +proj=tmerc +towgs84=215.9820,149.5930,176.2290,3.2624,1.6920,1.1571,10.477300 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    NUKU72U7S: '+title=IGN 1972 Nuku Hiva - UTM fuseau 7 Sud +proj=tmerc +towgs84=165.7320,216.7200,180.5050,-0.6434,-0.4512,-0.0791,7.420400 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    REUN47GAUSSL: '+title=Reunion Gauss Laborde +proj=gstmerc +towgs84=789.5240,-626.4860,-89.9040,0.6006,76.7946,-10.5788,-32.324100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-21.116666667 +lon_0=55.533333333 +k_0=1.00000000 +x_0=160000.000 +y_0=50000.000 +units=m +no_defs',
                    RGM04UTM38S: '+title=UTM fuseau 38 Sud (Reseau Geodesique de Mayotte 2004) +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    RGNCUTM57S: '+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 57 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=159.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    RGNCUTM58S: '+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 58 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=165.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    RGNCUTM59S: '+title=Reseau Geodesique de Nouvelle-Caledonie - UTM fuseau 59 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=171.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    RGPFUTM5S: '+title=RGPF - UTM fuseau 5 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-153.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    RGPFUTM6S: '+title=RGPF - UTM fuseau 6 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    RGPFUTM7S: '+title=RGPF - UTM fuseau 7 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-141.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    RGR92UTM40S: '+title=RGR92 UTM fuseau 40 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    RGSPM06U21: '+title=Saint-Pierre-et-Miquelon (2006) UTM Fuseau 21 Nord +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    STPL69UTM43S: '+title=Saint-Paul 1969 UTM fuseau 43 Sud +proj=tmerc +towgs84=225.571,-346.608,-46.567,0,0,0,0 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    STPM50UTM21: '+title=St Pierre et Miquelon 1950 +proj=tmerc +towgs84=-95.5930,573.7630,173.4420,-0.9602,1.2510,-1.3918,42.626500 +a=6378206.4000 +rf=294.9786982000000 +lat_0=0.000000000 +lon_0=-57.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    TAHAAUTM05S: '+title=Tahaa 1951 +proj=tmerc +towgs84=72.4380,345.9180,79.4860,-1.6045,-0.8823,-0.5565,1.374600 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-153.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    TAHI51UTM06S: '+title=Tahiti-Terme Nord UTM fuseau 6 Sud +proj=tmerc +towgs84=162.0000,117.0000,154.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    TAHI79UTM6S: '+title=Tahiti 1979 +proj=tmerc +towgs84=221.5250,152.9480,176.7680,2.3847,1.3896,0.8770,11.474100 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-147.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    TERA50STEREO: '+title=Terre Adelie 1950 +proj=stere +towgs84=324.9120,153.2820,172.0260 +a=6378388.0000 +rf=297.0000000000000 +lat_0=-90.000000000 +lon_0=140.000000000 +lat_ts=-67 +k=0.96027295 +x_0=300000.000 +y_0=-2299363.482 +units=m +no_defs',
                    UTM01SW84: '+title=World Geodetic System 1984 UTM fuseau 01 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-177.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    UTM20W84GUAD: '+title=World Geodetic System 1984 UTM fuseau 20 Nord-Guadeloupe +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM20W84MART: '+title=World Geodetic System 1984 UTM fuseau 20 Nord-Martinique +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-63.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM22RGFG95: '+title=RGFG95 UTM fuseau 22 Nord-Guyane +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM39SW84: '+title=World Geodetic System 1984 UTM fuseau 39 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=51.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    UTM42SW84: '+title=World Geodetic System 1984 UTM fuseau 42 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=69.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    UTM43SW84: '+title=World Geodetic System 1984 UTM fuseau 43 Sud +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=75.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    WALL78UTM1S: '+title=Wallis-Uvea 1978 (MOP78) UTM 1 SUD +proj=tmerc +towgs84=253.0000,-133.0000,-127.0000 +a=6378388.0000 +rf=297.0000000000000 +lat_0=0.000000000 +lon_0=-177.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=10000000.000 +units=m +no_defs',
                    ETRS89GEO: '+title=ETRS89 geographiques (dms) +proj=longlat +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +units=m +no_defs',
                    ETRS89LAEA: '+title=ETRS89 Lambert Azimutal Equal Area +proj=laea +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=52.000000000 +lon_0=10.000000000 +x_0=4321000.000 +y_0=3210000.000 +units=m +no_defs',
                    ETRS89LCC: '+title=ETRS89 Lambert Conformal Conic +proj=lcc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=52.000000000 +lon_0=9.999999995 +lat_1=35.000000000 +lat_2=65.000000000 +x_0=4000000.000 +y_0=2800000.000 +units=m +no_defs',
                    UTM26ETRS89: '+title=Europe - de 30d a 24d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-27.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM27ETRS89: '+title=Europe - de 24d a 18d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-21.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM28ETRS89: '+title=Europe - de 18d a 12d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-15.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM29ETRS89: '+title=Europe - de 12d a 6d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-9.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM30ETRS89: '+title=Europe - de -6d a 0d Ouest +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=-3.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM31ETRS89: '+title=Europe - de 0d a 6d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=3.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM32ETRS89: '+title=Europe - de 6d a 12d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=9.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM33ETRS89: '+title=Europe - de 12d a 18d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=15.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM34ETRS89: '+title=Europe - de 18d a 24d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=21.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM35ETRS89: '+title=Europe - de 24d a 30d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=27.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM36ETRS89: '+title=Europe - de 30d a 36d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=33.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM37ETRS89: '+title=Europe - de 36d a 42d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=39.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs',
                    UTM38ETRS89: '+title=Europe - de 42d a 48d Est +proj=tmerc +nadgrids=null +wktext +towgs84=0.0000,0.0000,0.0000 +a=6378137.0000 +rf=298.2572221010000 +lat_0=0.000000000 +lon_0=45.000000000 +k_0=0.99960000 +x_0=500000.000 +y_0=0.000 +units=m +no_defs'
                }
            };
            exports.default = Register;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function WMTS(options) {
                if (!(this instanceof WMTS)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                _ol2.default.source.WMTS.call(this, options);
            }
            _ol2.default.inherits(WMTS, _ol2.default.source.WMTS);
            WMTS.prototype = Object.create(_ol2.default.source.WMTS.prototype, {});
            WMTS.prototype.constructor = WMTS;
            WMTS.prototype.getGetFeatureInfoUrl = function (coordinate, resolution, projection, params) {
                var pixelRatio = this.option && this.options.tilePixelRatio ? this.options.tilePixelRatio : 1;
                var tileGrid = this.tileGrid;
                var tileCoord = this.tileGrid.getTileCoordForCoordAndResolution(coordinate, resolution);
                var getTransformedTileCoord = function getTransformedTileCoord(tileCoord, tileGrid, projection) {
                    var tmpTileCoord = [
                        0,
                        0,
                        0
                    ];
                    var tmpExtent = _ol2.default.extent.createEmpty();
                    var x = tileCoord[1];
                    var y = -tileCoord[2] - 1;
                    var tileExtent = tileGrid.getTileCoordExtent(tileCoord);
                    var projectionExtent = projection.getExtent();
                    var extent = projectionExtent;
                    if (extent != null && projection.isGlobal() && extent[0] === projectionExtent[0] && extent[2] === projectionExtent[2]) {
                        var numCols = Math.ceil(_ol2.default.extent.getWidth(extent) / _ol2.default.extent.getWidth(tileExtent));
                        x = x % numCols;
                        tmpTileCoord[0] = tileCoord[0];
                        tmpTileCoord[1] = x;
                        tmpTileCoord[2] = tileCoord[2];
                        tileExtent = tileGrid.getTileCoordExtent(tmpTileCoord, tmpExtent);
                    }
                    if (!_ol2.default.extent.intersects(tileExtent, extent)) {
                        return null;
                    }
                    return [
                        tileCoord[0],
                        x,
                        y
                    ];
                };
                var tileExtent = tileGrid.getTileCoordExtent(tileCoord);
                var transformedTileCoord = getTransformedTileCoord(tileCoord, tileGrid, projection);
                if (tileGrid.getResolutions().length <= tileCoord[0]) {
                    return undefined;
                }
                var tileResolution = tileGrid.getResolution(tileCoord[0]);
                var tileMatrix = tileGrid.getMatrixIds()[tileCoord[0]];
                var baseParams = {
                    SERVICE: 'WMTS',
                    VERSION: '1.0.0',
                    REQUEST: 'GetFeatureInfo',
                    LAYER: this.getLayer(),
                    TILECOL: transformedTileCoord[1],
                    TILEROW: transformedTileCoord[2],
                    TILEMATRIX: tileMatrix,
                    TILEMATRIXSET: this.getMatrixSet(),
                    FORMAT: this.getFormat() || 'image/png',
                    STYLE: this.getStyle() || 'normal'
                };
                _Utils2.default.assign(baseParams, params);
                var x = Math.floor((coordinate[0] - tileExtent[0]) / (tileResolution / pixelRatio));
                var y = Math.floor((tileExtent[3] - coordinate[1]) / (tileResolution / pixelRatio));
                baseParams['I'] = x;
                baseParams['J'] = y;
                var url = this.urls[0];
                var featureInfoUrl = _gp2.default.Helper.normalyzeUrl(url, baseParams);
                return featureInfoUrl;
            };
            exports.default = WMTS;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _proj = __webpack_require__(9);
            var _proj2 = _interopRequireDefault(_proj);
            var _Register = __webpack_require__(37);
            var _Register2 = _interopRequireDefault(_Register);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            (function () {
                _Register2.default.load();
                if (!_ol2.default.proj.proj4_ && _ol2.default.proj.setProj4) {
                    _ol2.default.proj.setProj4(_proj2.default);
                } else {
                    console.log('WARNING : OpenLayers library should manage proj4 dependency in order to add custom projections (Lambert 93 for instance)');
                }
            }());
            var CRS = {
                overloadTransformExtent: function overloadTransformExtent() {
                    _ol2.default.proj.transformExtent = function (extent, source, destination) {
                        if (destination === 'EPSG:2154') {
                            if (source === 'EPSG:4326') {
                                if (extent[0] < -9.62) {
                                    extent[0] = -9.62;
                                }
                                if (extent[1] < 41.18) {
                                    extent[1] = 41.18;
                                }
                                if (extent[2] > 10.3) {
                                    extent[2] = 10.3;
                                }
                                if (extent[3] > 51.54) {
                                    extent[3] = 51.54;
                                }
                            }
                        }
                        var transformFn = _ol2.default.proj.getTransform(source, destination);
                        var transformedExtent = _ol2.default.extent.applyTransform(extent, transformFn);
                        return transformedExtent;
                    };
                },
                overload: function overload() {
                    this.overloadTransformExtent();
                }
            };
            exports.default = CRS;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _WMTS = __webpack_require__(38);
            var _WMTS2 = _interopRequireDefault(_WMTS);
            var _GfiUtils = __webpack_require__(17);
            var _GfiUtils2 = _interopRequireDefault(_GfiUtils);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _Config = __webpack_require__(10);
            var _Config2 = _interopRequireDefault(_Config);
            var _LayerUtils = __webpack_require__(5);
            var _LayerUtils2 = _interopRequireDefault(_LayerUtils);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function SourceWMTS(options) {
                if (!(this instanceof SourceWMTS)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (!options.layer) {
                    throw new Error('ERROR PARAM_MISSING : layer');
                }
                if (typeof options.layer !== 'string') {
                    throw new Error('ERROR WRONG TYPE : layer');
                }
                if (typeof options.ssl === 'undefined') {
                    options.ssl = false;
                }
                if (!_Config2.default.isConfigLoaded()) {
                    throw new Error('ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html');
                }
                var layerId = _Config2.default.getLayerId(options.layer, 'WMTS');
                if (layerId && _Config2.default.configuration.getLayerConf(layerId)) {
                    var wmtsParams = _Config2.default.getLayerParams(options.layer, 'WMTS', options.apiKey);
                    var ctx = typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : null;
                    var protocol = ctx ? ctx.location && ctx.location.protocol && ctx.location.protocol.indexOf('https:') === 0 ? 'https://' : 'http://' : options.ssl ? 'https://' : 'http://';
                    this._originators = wmtsParams.originators;
                    this._legends = wmtsParams.legends;
                    this._metadata = wmtsParams.metadata;
                    var wmtsSourceOptions = {
                        url: _gp2.default.Helper.normalyzeUrl(wmtsParams.url.replace(/(http|https):\/\//, protocol), { 'gp-ol-ext': '2.0.0' }, false),
                        version: wmtsParams.version,
                        style: wmtsParams.styles,
                        format: wmtsParams.format,
                        projection: wmtsParams.projection,
                        maxZoom: _LayerUtils2.default.getZoomLevelFromScaleDenominator(wmtsParams.minScale),
                        layer: options.layer,
                        matrixSet: wmtsParams.TMSLink,
                        tileGrid: new _ol2.default.tilegrid.WMTS({
                            resolutions: wmtsParams.nativeResolutions,
                            matrixIds: wmtsParams.matrixIds,
                            origin: [
                                wmtsParams.matrixOrigin.x,
                                wmtsParams.matrixOrigin.y
                            ]
                        })
                    };
                    _Utils2.default.mergeParams(wmtsSourceOptions, options.olParams);
                    _WMTS2.default.call(this, wmtsSourceOptions);
                    this._originators = wmtsParams.originators;
                    this._legends = wmtsParams.legends;
                    this._metadata = wmtsParams.metadata;
                    this._description = wmtsParams.description;
                    this._title = wmtsParams.title;
                    this._quicklookUrl = wmtsParams.quicklookUrl;
                } else {
                    console.log('[source WMTS] ERROR : ' + options.layer + ' cannot be found in Geoportal Configuration. Make sure that this resource is included in your contract key.');
                    return new _WMTS2.default({});
                }
            }
            _ol2.default.inherits(SourceWMTS, _WMTS2.default);
            SourceWMTS.prototype = Object.create(_WMTS2.default.prototype, {});
            SourceWMTS.prototype.constructor = SourceWMTS;
            exports.default = SourceWMTS;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _Config = __webpack_require__(10);
            var _Config2 = _interopRequireDefault(_Config);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function SourceWMS(options) {
                if (!(this instanceof SourceWMS)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (!options.layer) {
                    throw new Error('ERROR PARAM_MISSING : layer');
                }
                if (typeof options.layer !== 'string') {
                    throw new Error('ERROR WRONG TYPE : layer');
                }
                if (typeof options.ssl === 'undefined') {
                    options.ssl = false;
                }
                if (!_Config2.default.isConfigLoaded()) {
                    throw new Error('ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html');
                }
                var layerId = _Config2.default.getLayerId(options.layer, 'WMS');
                if (layerId && _Config2.default.configuration.getLayerConf(layerId)) {
                    var wmsParams = _Config2.default.getLayerParams(options.layer, 'WMS', options.apiKey);
                    var ctx = typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : null;
                    var protocol = ctx ? ctx.location && ctx.location.protocol && ctx.location.protocol.indexOf('https:') === 0 ? 'https://' : 'http://' : options.ssl ? 'https://' : 'http://';
                    var wmsSourceOptions = {
                        url: _gp2.default.Helper.normalyzeUrl(wmsParams.url.replace(/(http|https):\/\//, protocol), { 'gp-ol-ext': '2.0.0' }, false),
                        params: {
                            SERVICE: 'WMS',
                            LAYERS: options.layer,
                            VERSION: wmsParams.version,
                            STYLES: wmsParams.styles,
                            FORMAT: wmsParams.format
                        }
                    };
                    _Utils2.default.mergeParams(wmsSourceOptions, options.olParams);
                    _ol2.default.source.TileWMS.call(this, wmsSourceOptions);
                    this._originators = wmsParams.originators;
                    this._legends = wmsParams.legends;
                    this._metadata = wmsParams.metadata;
                    this._title = wmsParams.title;
                    this._description = wmsParams.description;
                    this._quicklookUrl = wmsParams.quicklookUrl;
                } else {
                    console.log('[source WMS] ERROR : ' + options.layer + ' cannot be found in Geoportal Configuration. Make sure that this resource is included in your contract key.');
                    return new _ol2.default.source.TileWMS({});
                }
            }
            _ol2.default.inherits(SourceWMS, _ol2.default.source.TileWMS);
            SourceWMS.prototype = Object.create(_ol2.default.source.TileWMS.prototype, {});
            SourceWMS.prototype.constructor = SourceWMS;
            exports.default = SourceWMS;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _CheckRightManagement = __webpack_require__(6);
            var _CheckRightManagement2 = _interopRequireDefault(_CheckRightManagement);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _LocationSelectorDOM = __webpack_require__(99);
            var _LocationSelectorDOM2 = _interopRequireDefault(_LocationSelectorDOM);
            var _Markers = __webpack_require__(7);
            var _Markers2 = _interopRequireDefault(_Markers);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('locationselector');
            function LocationSelector(options) {
                options = options || {};
                if (!(this instanceof LocationSelector)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this.initialize(options);
                this._container = this._initContainer();
                if (options.element && options.element.appendChild) {
                    options.element.appendChild(this._container);
                    this._container = options.element;
                }
                _ol2.default.control.Control.call(this, {
                    element: this._container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(LocationSelector, _ol2.default.control.Control);
            LocationSelector.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(LocationSelector.prototype, _LocationSelectorDOM2.default);
            LocationSelector.prototype.constructor = LocationSelector;
            LocationSelector.prototype.initialize = function (options) {
                this.options = {
                    tag: {
                        id: 1,
                        groupId: null,
                        label: '>',
                        display: true,
                        addOption: false,
                        removeOption: false
                    },
                    displayInfo: true,
                    autocompleteOptions: {}
                };
                _Utils2.default.mergeParams(this.options, options);
                this._uid = this.options.tag.groupId || _SelectorID2.default.generate();
                this._map = null;
                this._inputsContainer = null;
                this._inputLabelContainer = null;
                this._inputAutoCompleteContainer = null;
                this._inputShowPointerContainer = null;
                this._inputShowPointer = null;
                this._inputCoordinateContainer = null;
                this._addPointElement = null;
                this._removePointElement = null;
                this._coordinate = null;
                this._suggestedContainer = null;
                this._suggestedLocations = [];
                this._currentLocation = null;
                this._initMarker();
                this._resources = {};
                this._noRightManagement = false;
                this._checkRightsManagement();
            };
            LocationSelector.prototype._initMarker = function () {
                this._marker = null;
                this._markerUrl = '';
                this._markerOffset = [
                    0,
                    0
                ];
                if (this.options.tag.markerOpts && this.options.tag.markerOpts.url) {
                    this._markerUrl = this.options.tag.markerOpts.url;
                    var offset = this.options.tag.markerOpts.offset;
                    if (offset) {
                        if (Array.isArray(offset) && offset.length === 2) {
                            this._markerOffset = offset;
                        } else {
                            console.log('markerOpts.offset should be an array. e.g. : [0,0]');
                        }
                    }
                } else {
                    this._markerUrl = _Markers2.default['lightOrange'];
                    this._markerOffset = _Markers2.default.defaultOffset;
                }
            };
            LocationSelector.prototype.getCoordinate = function () {
                return this._coordinate;
            };
            LocationSelector.prototype.clear = function () {
                this._clearResults();
                this._inputLabelContainer.click();
            };
            LocationSelector.prototype._checkRightsManagement = function () {
                var _opts = this.options.autocompleteOptions.filterOptions;
                var _res = _opts ? _opts.type : [];
                if (!_res || _res.length === 0) {
                    _res = [
                        'PositionOfInterest',
                        'StreetAddress'
                    ];
                }
                var rightManagement = _CheckRightManagement2.default.check({
                    key: this.options.apiKey,
                    resources: _res,
                    services: ['AutoCompletion']
                });
                if (!rightManagement) {
                    this._noRightManagement = true;
                }
                if (!this.options.apiKey) {
                    this.options.apiKey = rightManagement.key;
                }
                _Utils2.default.assign(this._resources, rightManagement);
            };
            LocationSelector.prototype._initContainer = function () {
                var id = this.options.tag.id;
                var container = this._createMainContainerElement();
                var inputs = this._inputsContainer = this._createLocationPointElement(id, this.options.tag.display);
                container.appendChild(inputs);
                var _inputLabel = this._inputLabelContainer = this._createLocationPointLabelElement(id, this.options.tag.label);
                inputs.appendChild(_inputLabel);
                var _inputAutoComplete = this._inputAutoCompleteContainer = this._createLocationAutoCompleteteInputElement(id);
                var context = this;
                if (_inputAutoComplete.addEventListener) {
                    _inputAutoComplete.addEventListener('click', function () {
                        context.onAutoCompleteInputClick();
                    });
                } else if (_inputAutoComplete.attachEvent) {
                    _inputAutoComplete.attachEvent('onclick', function () {
                        context.onAutoCompleteInputClick();
                    });
                }
                inputs.appendChild(_inputAutoComplete);
                var _inputCoordinate = this._inputCoordinateContainer = this._createLocationCoordinateInputElement(id);
                inputs.appendChild(_inputCoordinate);
                var _inputShowPointer = this._inputShowPointerContainer = this._createLocationPointerShowInputElement(id);
                inputs.appendChild(_inputShowPointer);
                var _inputPointer = this._inputShowPointer = this._createLocationPointerInputElement(id);
                inputs.appendChild(_inputPointer);
                if (this.options.tag.addOption) {
                    var _inputAddStage = this._addPointElement = this._createLocationAddPointElement();
                    inputs.appendChild(_inputAddStage);
                }
                if (this.options.tag.removeOption) {
                    var _inputRemoveStage = this._removePointElement = this._createLocationRemovePointElement(id);
                    inputs.appendChild(_inputRemoveStage);
                }
                var results = this._suggestedContainer = this._createLocationAutoCompleteResultElement(id);
                container.appendChild(results);
                return container;
            };
            LocationSelector.prototype.onAutoCompleteInputClick = function () {
                if (this._inputAutoCompleteContainer && this._inputAutoCompleteContainer.value.length > 2) {
                    this._displaySuggestedLocation();
                }
            };
            LocationSelector.prototype.onAutoCompleteSearchText = function (e) {
                var value = e.target.value;
                if (!value) {
                    return;
                }
                if (this._noRightManagement) {
                    console.log('no rights for this service !?');
                    return;
                }
                this._currentLocation = value;
                if (value.length < 3) {
                    this._clearSuggestedLocation();
                    return;
                }
                var context = this;
                this._requestAutoComplete({
                    text: value,
                    maximumResponses: 5,
                    onSuccess: function onSuccess(results) {
                        if (results) {
                            var locations = results.suggestedLocations;
                            context._fillAutoCompletedLocationListContainer(locations);
                        }
                    },
                    onFailure: function onFailure(error) {
                        context._clearSuggestedLocation();
                        logger.log(error.message);
                    }
                });
                var map = this.getMap();
                map.on('click', this._hideSuggestedLocation, this);
                map.on('pointerdrag', this._hideSuggestedLocation, this);
            };
            LocationSelector.prototype.onAutoCompletedResultsItemClick = function (e) {
                var idx = _SelectorID2.default.index(e.target.id);
                if (!idx) {
                    return;
                }
                var position = [
                    this._suggestedLocations[idx].position.x,
                    this._suggestedLocations[idx].position.y
                ];
                this._coordinate = position;
                var info = {
                    type: this._suggestedLocations[idx].type,
                    fields: this._suggestedLocations[idx]
                };
                var label = this._suggestedLocations[idx].fullText;
                this._setLabel(label);
                var view = this.getMap().getView();
                var mapProj = view.getProjection().getCode();
                if (mapProj !== 'EPSG:4326') {
                    position = _ol2.default.proj.transform(position, 'EPSG:4326', mapProj);
                }
                this._setPosition(position);
                this._setMarker(position, info, this.options.displayInfo);
            };
            LocationSelector.prototype.onActivateMapPointClick = function () {
                var map = this.getMap();
                if (this._inputShowPointerContainer.checked) {
                    this._clearResults();
                    map.on('click', this.onMouseMapClick, this);
                    this._setCursor('crosshair');
                } else {
                    map.un('click', this.onMouseMapClick, this);
                    this._setCursor();
                }
            };
            LocationSelector.prototype.onLocationClearPointClick = function () {
                this._setCursor();
                this._clearResults();
            };
            LocationSelector.prototype.onLocationRemovePointClick = function () {
                this._setCursor();
                this._clearResults();
            };
            LocationSelector.prototype.onLocationAddPointClick = function (e) {
                logger.log('onRouteAddPointClick', e);
            };
            LocationSelector.prototype.onMouseMapClick = function (e) {
                var coordinate = e.coordinate;
                if (!e.map || !e.map.getView()) {
                    return;
                }
                var crs = e.map.getView().getProjection();
                this._setCoordinate(coordinate, crs);
                this._setMarker([
                    coordinate[0],
                    coordinate[1]
                ], null, false);
                this.onActivateMapPointClick(e);
            };
            LocationSelector.prototype._setLabel = function (label) {
                this._inputAutoCompleteContainer.value = label;
            };
            LocationSelector.prototype._setCursor = function (cursor) {
                var map = this.getMap();
                var div = map.getTargetElement();
                if (cursor) {
                    div.style.cursor = cursor;
                } else {
                    div.style.cursor = null;
                }
            };
            LocationSelector.prototype._setCoordinate = function (olCoordinate, crs) {
                this._coordinate = _ol2.default.proj.transform(olCoordinate, crs, 'EPSG:4326');
                var lat = this._coordinate[0].toFixed(4);
                var lng = this._coordinate[1].toFixed(4);
                var value = lat + ' / ' + lng;
                this.GPdisplayCoordinate(value);
            };
            LocationSelector.prototype._setPosition = function (position) {
                var view = this.getMap().getView();
                view.setCenter(position);
            };
            LocationSelector.prototype._setMarker = function (position, information, display) {
                var map = this.getMap();
                if (this._marker != null) {
                    map.removeOverlay(this._marker);
                    this._marker = null;
                }
                if (position) {
                    var markerDiv = document.createElement('img');
                    markerDiv.src = this._markerUrl;
                    this._marker = new _ol2.default.Overlay({
                        position: position,
                        offset: this._markerOffset,
                        element: markerDiv,
                        stopEvent: false
                    });
                    map.addOverlay(this._marker);
                    if (display) {
                        logger.log('marker information : ', information);
                    }
                }
            };
            LocationSelector.prototype._clearResults = function () {
                var map = this.getMap();
                this._currentLocation = null;
                this._coordinate = null;
                this._hideSuggestedLocation();
                this._clearSuggestedLocation();
                this._setMarker();
                map.un('click', this.onMouseMapClick, this);
            };
            LocationSelector.prototype._clearSuggestedLocation = function () {
                this._suggestedLocations = [];
                if (this._suggestedContainer) {
                    while (this._suggestedContainer.firstChild) {
                        this._suggestedContainer.removeChild(this._suggestedContainer.firstChild);
                    }
                }
            };
            LocationSelector.prototype._hideSuggestedLocation = function () {
                if (this._suggestedContainer) {
                    this._suggestedContainer.style.display = 'none';
                }
            };
            LocationSelector.prototype._displaySuggestedLocation = function () {
                if (this._suggestedContainer) {
                    this._suggestedContainer.style.display = 'block';
                }
            };
            LocationSelector.prototype._requestAutoComplete = function (settings) {
                logger.log('_requestAutoComplete()', settings);
                if (!settings || Object.keys(settings).length === 0) {
                    return;
                }
                if (!settings.text) {
                    return;
                }
                logger.log(settings);
                var options = {};
                _Utils2.default.assign(options, this.options.autocompleteOptions);
                _Utils2.default.assign(options, settings);
                var resources = this._resources['AutoCompletion'] || null;
                if (resources && Array.isArray(resources)) {
                    if (!options.filterOptions) {
                        options.filterOptions = {};
                    }
                    options.filterOptions.type = resources;
                }
                options.apiKey = options.apiKey || this.options.apiKey;
                logger.log(options);
                _gp2.default.Services.autoComplete(options);
            };
            LocationSelector.prototype._fillAutoCompletedLocationListContainer = function (locations) {
                if (!locations || locations.length === 0) {
                    return;
                }
                var element = this._suggestedContainer;
                if (element.childElementCount) {
                    while (element.firstChild) {
                        element.removeChild(element.firstChild);
                    }
                }
                for (var i = 0; i < locations.length; i++) {
                    this._createLocationAutoCompletedLocationElement(this.options.tag.id, locations[i], i);
                }
                this._suggestedLocations = locations;
            };
            exports.default = LocationSelector;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            __webpack_require__(44);
            __webpack_require__(46);
            __webpack_require__(53);
            __webpack_require__(71);
            module.exports = __webpack_require__(86);
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            (function () {
                var scripts = document.getElementsByTagName('script');
                var key = scripts[scripts.length - 1].getAttribute('data-key');
                if (key) {
                    var splitKeys = key.split(/;|,|\|/);
                    if (key && splitKeys.length > 1) {
                        var keys = [];
                        for (var i = 0; i < splitKeys.length; i++) {
                            keys.push(splitKeys[i]);
                        }
                        key = keys;
                    }
                }
                var url = scripts[scripts.length - 1].getAttribute('data-url');
                var timeout = scripts[scripts.length - 1].getAttribute('data-timeout');
                var success = function success() {
                };
                var error = function error(e) {
                    throw new Error('Configuration load failed : ' + e.message);
                };
                if (!key && !url) {
                    return;
                }
                var options = {
                    apiKey: key,
                    onSuccess: success,
                    onFailure: error
                };
                if (url) {
                    options.serverUrl = url;
                    options.callbackSuffix = '';
                }
                if (timeout) {
                    options.timeOut = timeout;
                }
                if (!_gp2.default.Config) {
                    _gp2.default.Services.getConfig(options);
                }
            }());
            return exports;
        },
        function (module, exports) {
            module.exports = __WEBPACK_EXTERNAL_MODULE_45__;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            var _GPdrawing = __webpack_require__(20);
            var _GPdrawing2 = _interopRequireDefault(_GPdrawing);
            var _GPisochron = __webpack_require__(21);
            var _GPisochron2 = _interopRequireDefault(_GPisochron);
            var _GPmeasureAzimuth = __webpack_require__(22);
            var _GPmeasureAzimuth2 = _interopRequireDefault(_GPmeasureAzimuth);
            var _GPreverseGeocoding = __webpack_require__(23);
            var _GPreverseGeocoding2 = _interopRequireDefault(_GPreverseGeocoding);
            var _GPelevationPath = __webpack_require__(24);
            var _GPelevationPath2 = _interopRequireDefault(_GPelevationPath);
            var _GPlayerSwitcher = __webpack_require__(25);
            var _GPlayerSwitcher2 = _interopRequireDefault(_GPlayerSwitcher);
            var _GPmeasureLength = __webpack_require__(26);
            var _GPmeasureLength2 = _interopRequireDefault(_GPmeasureLength);
            var _GProute = __webpack_require__(27);
            var _GProute2 = _interopRequireDefault(_GProute);
            var _GPgeneralWidget = __webpack_require__(28);
            var _GPgeneralWidget2 = _interopRequireDefault(_GPgeneralWidget);
            var _GPlocation = __webpack_require__(29);
            var _GPlocation2 = _interopRequireDefault(_GPlocation);
            var _GPmeasureToolTip = __webpack_require__(30);
            var _GPmeasureToolTip2 = _interopRequireDefault(_GPmeasureToolTip);
            var _GPsearchEngine = __webpack_require__(31);
            var _GPsearchEngine2 = _interopRequireDefault(_GPsearchEngine);
            var _GPgetFeatureInfo = __webpack_require__(32);
            var _GPgetFeatureInfo2 = _interopRequireDefault(_GPgetFeatureInfo);
            var _GPmeasureArea = __webpack_require__(33);
            var _GPmeasureArea2 = _interopRequireDefault(_GPmeasureArea);
            var _GPmousePosition = __webpack_require__(34);
            var _GPmousePosition2 = _interopRequireDefault(_GPmousePosition);
            var _GPgeneralWidgetItowns = __webpack_require__(47);
            var _GPgeneralWidgetItowns2 = _interopRequireDefault(_GPgeneralWidgetItowns);
            var _GPattributionItowns = __webpack_require__(48);
            var _GPattributionItowns2 = _interopRequireDefault(_GPattributionItowns);
            var _GPlayerSwitcherItowns = __webpack_require__(49);
            var _GPlayerSwitcherItowns2 = _interopRequireDefault(_GPlayerSwitcherItowns);
            var _GPminiGlobeItowns = __webpack_require__(50);
            var _GPminiGlobeItowns2 = _interopRequireDefault(_GPminiGlobeItowns);
            var _GPmousePositionItowns = __webpack_require__(51);
            var _GPmousePositionItowns2 = _interopRequireDefault(_GPmousePositionItowns);
            var _GPscaleItowns = __webpack_require__(52);
            var _GPscaleItowns2 = _interopRequireDefault(_GPscaleItowns);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            var _GPgeneralWidget = __webpack_require__(28);
            var _GPgeneralWidget2 = _interopRequireDefault(_GPgeneralWidget);
            var _GPdrawing = __webpack_require__(20);
            var _GPdrawing2 = _interopRequireDefault(_GPdrawing);
            var _GPisochron = __webpack_require__(21);
            var _GPisochron2 = _interopRequireDefault(_GPisochron);
            var _GPmeasureAzimuth = __webpack_require__(22);
            var _GPmeasureAzimuth2 = _interopRequireDefault(_GPmeasureAzimuth);
            var _GPreverseGeocoding = __webpack_require__(23);
            var _GPreverseGeocoding2 = _interopRequireDefault(_GPreverseGeocoding);
            var _GPelevationPath = __webpack_require__(24);
            var _GPelevationPath2 = _interopRequireDefault(_GPelevationPath);
            var _GPlayerSwitcher = __webpack_require__(25);
            var _GPlayerSwitcher2 = _interopRequireDefault(_GPlayerSwitcher);
            var _GPmeasureLength = __webpack_require__(26);
            var _GPmeasureLength2 = _interopRequireDefault(_GPmeasureLength);
            var _GProute = __webpack_require__(27);
            var _GProute2 = _interopRequireDefault(_GProute);
            var _GPlocation = __webpack_require__(29);
            var _GPlocation2 = _interopRequireDefault(_GPlocation);
            var _GPmeasureToolTip = __webpack_require__(30);
            var _GPmeasureToolTip2 = _interopRequireDefault(_GPmeasureToolTip);
            var _GPsearchEngine = __webpack_require__(31);
            var _GPsearchEngine2 = _interopRequireDefault(_GPsearchEngine);
            var _GPgetFeatureInfo = __webpack_require__(32);
            var _GPgetFeatureInfo2 = _interopRequireDefault(_GPgetFeatureInfo);
            var _GPmeasureArea = __webpack_require__(33);
            var _GPmeasureArea2 = _interopRequireDefault(_GPmeasureArea);
            var _GPmousePosition = __webpack_require__(34);
            var _GPmousePosition2 = _interopRequireDefault(_GPmousePosition);
            var _GPgeneralWidgetOpenLayers = __webpack_require__(54);
            var _GPgeneralWidgetOpenLayers2 = _interopRequireDefault(_GPgeneralWidgetOpenLayers);
            var _GpattributionOpenLayers = __webpack_require__(55);
            var _GpattributionOpenLayers2 = _interopRequireDefault(_GpattributionOpenLayers);
            var _GPmeasureAreaOpenLayers = __webpack_require__(56);
            var _GPmeasureAreaOpenLayers2 = _interopRequireDefault(_GPmeasureAreaOpenLayers);
            var _GPdrawingOpenLayers = __webpack_require__(57);
            var _GPdrawingOpenLayers2 = _interopRequireDefault(_GPdrawingOpenLayers);
            var _GPmeasureAzimuthOpenLayers = __webpack_require__(58);
            var _GPmeasureAzimuthOpenLayers2 = _interopRequireDefault(_GPmeasureAzimuthOpenLayers);
            var _GPelevationPathOpenLayers = __webpack_require__(59);
            var _GPelevationPathOpenLayers2 = _interopRequireDefault(_GPelevationPathOpenLayers);
            var _GPmeasureLengthOpenLayers = __webpack_require__(60);
            var _GPmeasureLengthOpenLayers2 = _interopRequireDefault(_GPmeasureLengthOpenLayers);
            var _GPgetFeatureInfoOpenLayers = __webpack_require__(61);
            var _GPgetFeatureInfoOpenLayers2 = _interopRequireDefault(_GPgetFeatureInfoOpenLayers);
            var _GPmousePositionOpenLayers = __webpack_require__(62);
            var _GPmousePositionOpenLayers2 = _interopRequireDefault(_GPmousePositionOpenLayers);
            var _GPisochronOpenLayers = __webpack_require__(63);
            var _GPisochronOpenLayers2 = _interopRequireDefault(_GPisochronOpenLayers);
            var _GPreverseGeocodingOpenLayers = __webpack_require__(64);
            var _GPreverseGeocodingOpenLayers2 = _interopRequireDefault(_GPreverseGeocodingOpenLayers);
            var _GPimportOpenLayers = __webpack_require__(65);
            var _GPimportOpenLayers2 = _interopRequireDefault(_GPimportOpenLayers);
            var _GProuteOpenLayers = __webpack_require__(66);
            var _GProuteOpenLayers2 = _interopRequireDefault(_GProuteOpenLayers);
            var _GPlayerSwitcherOpenLayers = __webpack_require__(67);
            var _GPlayerSwitcherOpenLayers2 = _interopRequireDefault(_GPlayerSwitcherOpenLayers);
            var _GPsearchEngineOpenLayers = __webpack_require__(68);
            var _GPsearchEngineOpenLayers2 = _interopRequireDefault(_GPsearchEngineOpenLayers);
            var _GPlocationOpenLayers = __webpack_require__(69);
            var _GPlocationOpenLayers2 = _interopRequireDefault(_GPlocationOpenLayers);
            var _GPtoolBoxMeasureOpenLayers = __webpack_require__(70);
            var _GPtoolBoxMeasureOpenLayers2 = _interopRequireDefault(_GPtoolBoxMeasureOpenLayers);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports) {
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _itowns = __webpack_require__(72);
            var Itowns = _interopRequireWildcard(_itowns);
            var _LayerUtils = __webpack_require__(5);
            var _LayerUtils2 = _interopRequireDefault(_LayerUtils);
            var _MousePosition = __webpack_require__(73);
            var _MousePosition2 = _interopRequireDefault(_MousePosition);
            var _LayerSwitcher = __webpack_require__(78);
            var _LayerSwitcher2 = _interopRequireDefault(_LayerSwitcher);
            var _Attributions = __webpack_require__(80);
            var _Attributions2 = _interopRequireDefault(_Attributions);
            var _Scale = __webpack_require__(82);
            var _Scale2 = _interopRequireDefault(_Scale);
            var _MiniGlobe = __webpack_require__(84);
            var _MiniGlobe2 = _interopRequireDefault(_MiniGlobe);
            var _GlobeViewExtended = __webpack_require__(8);
            var _GlobeViewExtended2 = _interopRequireDefault(_GlobeViewExtended);
            function _interopRequireWildcard(obj) {
                if (obj && obj.__esModule) {
                    return obj;
                } else {
                    var newObj = {};
                    if (obj != null) {
                        for (var key in obj) {
                            if (Object.prototype.hasOwnProperty.call(obj, key))
                                newObj[key] = obj[key];
                        }
                    }
                    newObj.default = obj;
                    return newObj;
                }
            }
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            _gp2.default.LayerUtils = _LayerUtils2.default;
            _gp2.default.itownsExtVersion = '2.0.0';
            _gp2.default.itownsExtDate = '2018-05-04';
            var env = typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {};
            Itowns.control = {};
            Itowns.control.MousePosition = _MousePosition2.default;
            Itowns.control.LayerSwitcher = _LayerSwitcher2.default;
            Itowns.control.Attributions = _Attributions2.default;
            Itowns.control.Scale = _Scale2.default;
            Itowns.control.MiniGlobe = _MiniGlobe2.default;
            Itowns.GlobeViewExtended = _GlobeViewExtended2.default;
            if (!env.itowns) {
                env.itowns = {};
            }
            deepCopy(Itowns, env.itowns);
            function deepCopy(source, target) {
                for (var prop in source) {
                    if (source.hasOwnProperty(prop)) {
                        if (!target.hasOwnProperty(prop)) {
                            target[prop] = source[prop];
                        } else if (_typeof(source[prop]) === 'object') {
                            deepCopy(source[prop], target[prop]);
                        }
                    }
                }
            }
            exports.default = _gp2.default;
            return exports;
        },
        function (module, exports) {
            module.exports = __WEBPACK_EXTERNAL_MODULE_72__;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _proj = __webpack_require__(9);
            var _proj2 = _interopRequireDefault(_proj);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _GlobeViewExtended = __webpack_require__(8);
            var _GlobeViewExtended2 = _interopRequireDefault(_GlobeViewExtended);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _CheckRightManagement = __webpack_require__(6);
            var _CheckRightManagement2 = _interopRequireDefault(_CheckRightManagement);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _MousePositionDOM = __webpack_require__(35);
            var _MousePositionDOM2 = _interopRequireDefault(_MousePositionDOM);
            var _Widget = __webpack_require__(11);
            var _Widget2 = _interopRequireDefault(_Widget);
            var _PositionFormater = __webpack_require__(76);
            var _PositionFormater2 = _interopRequireDefault(_PositionFormater);
            var _CRS = __webpack_require__(77);
            var _CRS2 = _interopRequireDefault(_CRS);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('MousePosition');
            function MousePosition(options) {
                options = options || {};
                if (!(this instanceof MousePosition)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (options && (typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {
                    throw new Error('ERROR WRONG_TYPE : options should be an object');
                }
                this._initialize(options);
                this._callbacks = {};
                var container = this._initContainer(options);
                var targetDiv = document.getElementById(options.target) || null;
                _Widget2.default.call(this, {
                    name: 'MousePosition',
                    element: container,
                    target: targetDiv
                });
            }
            MousePosition.prototype = Object.create(_Widget2.default.prototype, {});
            _Utils2.default.assign(MousePosition.prototype, _MousePositionDOM2.default);
            MousePosition.prototype.constructor = MousePosition;
            MousePosition.prototype.setGlobe = function (globe) {
                if (globe) {
                    this._centerElement = this._createMapCenter();
                    globe.getTargetElement().appendChild(this._centerElement);
                    this._callbacks.mouseMove = this.onMouseMove.bind(this);
                    if (!this.collapsed) {
                        if (this._isDesktop) {
                            globe.listen(_GlobeViewExtended2.default.EVENTS.MOUSE_MOVE, this._callbacks.mouseMove);
                        } else {
                            globe.listen(_GlobeViewExtended2.default.EVENTS.CENTER_CHANGED, this.onGlobeMove);
                        }
                    }
                } else if (globe == null) {
                    this._globe.forget(_GlobeViewExtended2.default.EVENTS.MOUSE_MOVE, this._callbacks.mouseMove);
                    while (this.getElement().hasChildNodes()) {
                        this.getElement().removeChild(this.getElement().lastChild);
                    }
                    this.getElement().parentNode.removeChild(this.getElement());
                    this._globe.getTargetElement().removeChild(this._centerElement);
                }
                _Widget2.default.prototype.setGlobe.call(this, globe);
            };
            MousePosition.prototype.addSystem = function (system) {
                if ((typeof system === 'undefined' ? 'undefined' : _typeof(system)) !== 'object') {
                    console.log('[ERROR] MousePosition:addSystem - system parameter should be an object');
                    return;
                }
                if (!system.crs) {
                    logger.error('crs not defined !');
                    return;
                }
                if (!system.label) {
                    logger.warn('crs label not defined, use crs code by default.');
                    system.label = system.crs;
                }
                if (!system.type) {
                    logger.warn('type srs not defined, use \'Metric\' by default.');
                    system.type = 'Metric';
                }
                for (var j = 0; j < this._projectionSystems.length; j++) {
                    var obj = this._projectionSystems[j];
                    if (system.crs === obj.crs) {
                        console.log('crs \'{}\' already configured', obj.crs);
                    }
                }
                system.code = this._projectionSystems.length;
                this._projectionSystems.push(system);
                var selectSystem = document.getElementById(this._addUID('GPmousePositionProjectionSystem'));
                if (selectSystem) {
                    var option = document.createElement('option');
                    option.value = system.code;
                    option.text = system.label;
                    selectSystem.appendChild(option);
                }
            };
            MousePosition.prototype.addSystems = function (systems) {
                if (!systems) {
                    return;
                }
                if (!Array.isArray(systems)) {
                    console.log('[ERROR] MousePosition:addSystems - systems parameter should be an array');
                    return;
                }
                for (var i = 0; i < systems.length; i++) {
                    this.addSystem(systems[i]);
                }
            };
            MousePosition.prototype.removeSystem = function (systemCrs) {
                if (!systemCrs || typeof systemCrs !== 'string') {
                    console.log('[ERROR] MousePosition:removeSystem - systemCode parameter should be a string');
                    return;
                }
                var systemCode = null;
                for (var i = 0; i < this._projectionSystems.length; i++) {
                    var proj = this._projectionSystems[i];
                    if (systemCrs === proj.crs) {
                        systemCode = proj.code;
                        this._projectionSystems.splice(i, 1);
                        break;
                    }
                }
                if (systemCode == null) {
                    console.log('[WARN] MousePosition:removeSystem - system not found');
                    return;
                }
                var oldNewCodeGlobe = [];
                for (var ii = 0; ii < this._projectionSystems.length; ii++) {
                    oldNewCodeGlobe[Number(this._projectionSystems[ii].code)] = ii;
                    this._projectionSystems[ii].code = ii;
                }
                var indexChildToRemove = null;
                var systemList = document.getElementById(this._addUID('GPmousePositionProjectionSystem'));
                for (var j = 0; j < systemList.childNodes.length; j++) {
                    if (systemCode == systemList.childNodes[j].value) {
                        indexChildToRemove = j;
                        continue;
                    }
                    systemList.childNodes[j].value = oldNewCodeGlobe[Number(systemList.childNodes[j].value)];
                }
                if (indexChildToRemove != null) {
                    systemList.removeChild(systemList.childNodes[indexChildToRemove]);
                }
                if (this._currentProjectionSystems.code == systemCode) {
                    systemList.childNodes[0].setAttribute('selected', 'selected');
                    this._setCurrentSystem(systemList.childNodes[0].value);
                }
            };
            MousePosition.prototype.setUnits = function (units) {
                if (!units || !Array.isArray(units)) {
                    return;
                }
                this.options.units = units;
                this._projectionUnits = {};
                this._initProjectionUnits();
                if (this._currentProjectionType) {
                    this._setTypeUnitsPanel(this._currentProjectionType);
                }
            };
            MousePosition.prototype.setAltitudeOptions = function (options) {
                if (!options || (typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {
                    return;
                }
                this.options.altitude.triggerDelay = options.triggerDelay;
                this.options.altitude.responseDelay = options.responseDelay;
                if (options.serviceOptions) {
                    for (var opt in options.serviceOptions) {
                        if (options.serviceOptions.hasOwnProperty(opt)) {
                            this.options.altitude.serviceOptions[opt] = options.serviceOptions[opt];
                        }
                    }
                }
            };
            MousePosition.prototype.displayAltitude = function (displayAltitude) {
                if (displayAltitude === undefined) {
                    return;
                }
                if (typeof this._noRightManagement === 'undefined') {
                    this._checkRightsManagement();
                }
                this.options.displayAltitude = displayAltitude;
                this._setElevationPanel(displayAltitude);
            };
            MousePosition.prototype.displayCoordinates = function (displayCoordinates) {
                if (displayCoordinates === undefined) {
                    return;
                }
                this.options.displayCoordinates = displayCoordinates;
                this._setCoordinatesPanel(displayCoordinates);
                this._setSettingsPanel(displayCoordinates);
            };
            MousePosition.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] MousePosition:setCollapsed - missing collapsed parameter');
                    return;
                }
                if (collapsed && this.collapsed || !collapsed && !this.collapsed) {
                    return;
                }
                if (!this._isDesktop) {
                    document.getElementById(this._addUID('GPmapCenter')).className = collapsed ? '' : 'GPmapCenterVisible';
                }
                this.onShowMousePositionClick();
                this._showMousePositionContainer.checked = !collapsed;
            };
            MousePosition.prototype._initialize = function (options) {
                this.options = options || {};
                this.options.collapsed = options.collapsed !== undefined ? options.collapsed : true;
                this.collapsed = this.options.collapsed;
                this.options.units = options.units || [];
                this.options.displayAltitude = options.displayAltitude !== undefined ? options.displayAltitude : true;
                this.options.displayCoordinates = options.displayCoordinates !== undefined ? options.displayCoordinates : true;
                this.options.systems = options.systems || [];
                if (options.altitude) {
                    var altitude = options.altitude;
                    this.options.altitude = {
                        triggerDelay: altitude.triggerDelay !== undefined ? altitude.triggerDelay : 200,
                        responseDelay: altitude.responseDelay !== undefined ? altitude.responseDelay : 500,
                        serviceOptions: altitude.serviceOptions || {},
                        noDataValue: altitude.noDataValue !== undefined ? altitude.noDataValue : -99999,
                        noDataValueTolerance: altitude.noDataValueTolerance !== undefined ? altitude.noDataValueTolerance : 90000
                    };
                } else {
                    this.options.altitude = {
                        triggerDelay: 200,
                        responseDelay: 500,
                        serviceOptions: {}
                    };
                }
                this._uid = _SelectorID2.default.generate();
                this._projectionSystems = [];
                this._initProjectionSystems();
                this._projectionUnits = {};
                this._initProjectionUnits();
                this._isDesktop = _Utils2.default.detectSupport();
                if (this.options.altitude.triggerDelay < 100) {
                    this.options.altitude.triggerDelay = 100;
                }
                this._timer = this.options.altitude.triggerDelay;
                this._currentProjectionSystems = this._projectionSystems[0];
                this._currentProjectionType = this._projectionSystems[0].type;
                this._currentProjectionUnits = this._projectionUnits[this._currentProjectionType][0].code;
                this._projectionUnitsContainer = null;
                this._showMousePositionContainer = null;
                if (!this.options.displayAltitude && !this.options.displayCoordinates) {
                    this.options.displayCoordinates = true;
                }
                if (this.options.displayAltitude) {
                    this._checkRightsManagement();
                }
            };
            MousePosition.prototype._initProjectionSystems = function () {
                var projectionSystemsByDefault = [
                    {
                        label: 'Géographique',
                        crs: 'EPSG:4326',
                        type: 'Geographical'
                    },
                    {
                        label: 'Mercator',
                        crs: 'EPSG:3857',
                        type: 'Metric'
                    },
                    {
                        label: 'Lambert 93',
                        crs: 'EPSG:2154',
                        type: 'Metric',
                        geoBBox: {
                            left: -9.86,
                            bottom: 41.15,
                            right: 10.38,
                            top: 51.56
                        }
                    },
                    {
                        label: 'Lambert II étendu',
                        crs: 'EPSG:27572',
                        type: 'Metric',
                        geoBBox: {
                            left: -4.87,
                            bottom: 42.33,
                            right: 8.23,
                            top: 51.14
                        }
                    }
                ];
                var systems = this.options.systems;
                for (var i = 0; i < systems.length; i++) {
                    var sys = systems[i];
                    this.addSystem(sys);
                }
                if (this._projectionSystems.length === 0) {
                    for (var ii = 0; ii < projectionSystemsByDefault.length; ii++) {
                        this.addSystem(projectionSystemsByDefault[ii]);
                    }
                }
            };
            MousePosition.prototype._initProjectionUnits = function () {
                var projectionUnitsByDefault = {
                    Geographical: [
                        {
                            code: 'DEC',
                            label: 'degrés décimaux',
                            convert: this._displayDEC
                        },
                        {
                            code: 'DMS',
                            label: 'degrés sexagésimaux',
                            convert: this._displayDMS
                        },
                        {
                            code: 'RAD',
                            label: 'radians',
                            convert: this._displayRAD
                        },
                        {
                            code: 'GON',
                            label: 'grades',
                            convert: this._displayGON
                        }
                    ],
                    Metric: [
                        {
                            code: 'M',
                            label: 'mètres',
                            convert: this._displayMeter
                        },
                        {
                            code: 'KM',
                            label: 'kilomètres',
                            convert: this._displayKMeter
                        }
                    ]
                };
                var units = this.options.units;
                for (var type in projectionUnitsByDefault) {
                    if (projectionUnitsByDefault.hasOwnProperty(type)) {
                        var found = false;
                        for (var j = 0; j < projectionUnitsByDefault[type].length; j++) {
                            var obj = projectionUnitsByDefault[type][j];
                            for (var i = 0; i < units.length; i++) {
                                var unit = units[i];
                                if (obj.code === unit) {
                                    found = true;
                                    if (!this._projectionUnits[type]) {
                                        this._projectionUnits[type] = [];
                                    }
                                    this._projectionUnits[type].push(obj);
                                }
                            }
                        }
                        if (!found) {
                            this._projectionUnits[type] = projectionUnitsByDefault[type];
                        }
                    }
                }
                if (_typeof(this._projectionUnits) === 'object' && Object.keys(this._projectionUnits).length === 0) {
                    this._projectionUnits = projectionUnitsByDefault;
                }
            };
            MousePosition.prototype._checkRightsManagement = function () {
                var rightManagement = _CheckRightManagement2.default.check({
                    key: this.options.apiKey,
                    resources: ['SERVICE_CALCUL_ALTIMETRIQUE_RSC'],
                    services: ['Elevation']
                });
                this._noRightManagement = !rightManagement;
                if (!this.options.apiKey) {
                    this.options.apiKey = rightManagement.key;
                }
            };
            MousePosition.prototype._initContainer = function (options) {
                var container = this._createMainContainerElement();
                var inputShow = this._showMousePositionContainer = this._createShowMousePositionElement();
                if (!options.collapsed) {
                    inputShow.checked = 'checked';
                }
                container.appendChild(inputShow);
                var picto = this._createShowMousePositionPictoElement(this._isDesktop);
                container.appendChild(picto);
                var panel = this._createMousePositionPanelElement(options.displayAltitude, options.displayCoordinates);
                var settings = this._createMousePositionSettingsElement(options.displayCoordinates);
                var systems = this._projectionSystemsContainer = this._createMousePositionSettingsSystemsElement(this._projectionSystems);
                var units = this._projectionUnitsContainer = this._createMousePositionSettingsUnitsElement(this._projectionUnits[this._currentProjectionType]);
                settings.appendChild(systems);
                settings.appendChild(units);
                panel.appendChild(settings);
                container.appendChild(panel);
                return container;
            };
            MousePosition.prototype._setElevationPanel = function (active) {
                var div = null;
                if (!active) {
                    div = document.getElementById('GPmousePositionAltitude-' + this._uid);
                    div.style.display = 'none';
                } else {
                    if (this._noRightManagement) {
                        div = document.getElementById('GPmousePositionAlt-' + this._uid);
                        div.innerHTML = 'No rights!';
                    } else {
                        div = document.getElementById('GPmousePositionAltitude-' + this._uid);
                        div.style.display = '';
                    }
                }
            };
            MousePosition.prototype._setCoordinatesPanel = function (active) {
                var div = document.getElementById('GPmousePositionCoordinate-' + this._uid);
                if (!active) {
                    div.style.display = 'none';
                } else {
                    div.style.display = '';
                }
            };
            MousePosition.prototype._setSettingsPanel = function (active) {
                var divPicto = document.getElementById('GPshowMousePositionSettingsPicto-' + this._uid);
                var divPanel = document.getElementById('GPmousePositionSettings-' + this._uid);
                if (!active) {
                    divPicto.style.display = 'none';
                    divPanel.style.display = 'none';
                } else {
                    divPicto.style.display = '';
                    divPanel.style.display = '';
                }
            };
            MousePosition.prototype._setTypeUnitsPanel = function (type) {
                var container = this._projectionUnitsContainer;
                while (container.firstChild) {
                    container.removeChild(container.firstChild);
                }
                var units = this._projectionUnits[type];
                for (var j = 0; j < units.length; j++) {
                    var obj = units[j];
                    var option = document.createElement('option');
                    option.value = obj.code ? obj.code : j;
                    option.text = obj.label || j;
                    container.appendChild(option);
                }
                this._currentProjectionType = type;
                this._currentProjectionUnits = this._projectionUnits[type][0].code;
            };
            MousePosition.prototype._displayDEC = function (coords) {
                var coordinate = {};
                coordinate.lat = _PositionFormater2.default.roundToDecimal(coords.lat, 6);
                coordinate.lng = _PositionFormater2.default.roundToDecimal(coords.lon, 6);
                return coordinate;
            };
            MousePosition.prototype._displayDMS = function (coords) {
                var coordinate = {};
                coordinate.lat = _PositionFormater2.default.decimalLatToDMS(coords.lat);
                coordinate.lng = _PositionFormater2.default.decimalLongToDMS(coords.lon);
                return coordinate;
            };
            MousePosition.prototype._displayRAD = function (coords) {
                var coordinate = {};
                coordinate.lat = _PositionFormater2.default.decimalToRadian(coords.lat);
                coordinate.lng = _PositionFormater2.default.decimalToRadian(coords.lon);
                return coordinate;
            };
            MousePosition.prototype._displayGON = function (coords) {
                var coordinate = {};
                coordinate.lat = _PositionFormater2.default.decimalToGrade(coords.lat);
                coordinate.lng = _PositionFormater2.default.decimalToGrade(coords.lon);
                return coordinate;
            };
            MousePosition.prototype._displayMeter = function (coords) {
                var coordinate = {};
                coordinate.x = coords.lon.toFixed(2);
                coordinate.y = coords.lat.toFixed(2);
                coordinate.unit = 'm';
                return coordinate;
            };
            MousePosition.prototype._displayKMeter = function (coords) {
                var coordinate = {};
                coordinate.x = (coords.lon / 1000).toFixed(2);
                coordinate.y = (coords.lat / 1000).toFixed(2);
                coordinate.unit = 'km';
                return coordinate;
            };
            MousePosition.prototype._setCoordinate = function (coords) {
                var coord = [];
                var coordinates = {};
                var oSrs = this._currentProjectionSystems;
                var crsProp = oSrs.crs;
                if (!oSrs || !crsProp) {
                    console.log('ERROR : system crs not found');
                    return;
                }
                if (crsProp !== 'EPSG:4326') {
                    coord = (0, _proj2.default)(_CRS2.default[crsProp], [
                        coords.lon,
                        coords.lat
                    ]);
                    coordinates.lon = coord[0];
                    coordinates.lat = coord[1];
                } else {
                    coordinates = coords;
                }
                var type = this._currentProjectionSystems.type;
                var convert = null;
                var units = this._projectionUnits[type];
                for (var i = 0; i < units.length; i++) {
                    if (units[i].code === this._currentProjectionUnits) {
                        convert = units[i].convert;
                        break;
                    }
                }
                if (!convert || typeof convert !== 'function') {
                    console.log('WARNING : coordinates format function not found');
                    return;
                } else {
                    coord = convert(coordinates);
                }
                if (!coord || Object.keys(coord).length === 0) {
                    return;
                }
                this.GPdisplayCoords(coord);
            };
            MousePosition.prototype._setElevation = function (coords) {
                var delay = this.options.altitude.responseDelay;
                this.GPdisplayElevation(coords, delay);
            };
            MousePosition.prototype.onMoveStopped = function (coords) {
                this._setElevation(coords);
            };
            MousePosition.prototype.onMouseMove = function (e) {
                var self = this;
                var position = this.getGlobe().getCoordinateFromMouseEvent(e);
                if (!position) {
                    this.GPdisplayCoords({
                        lon: '---',
                        lat: '---'
                    });
                    this.GPresetElevation();
                    return;
                }
                var coordinate = {
                    lon: position.longitude(),
                    lat: position.latitude()
                };
                this._setCoordinate(coordinate);
                if (this.options.displayAltitude) {
                    clearTimeout(this._timer);
                    this._timer = setTimeout(function () {
                        self.onMoveStopped(coordinate);
                    }, this.options.altitude.triggerDelay);
                }
            };
            MousePosition.prototype.onGlobeMove = function () {
            };
            MousePosition.prototype.onRequestAltitude = function (coordinate, callback) {
                if (!coordinate || Object.keys(coordinate).length === 0) {
                    return;
                }
                if (!this.options.displayAltitude) {
                    return;
                }
                if (this._noRightManagement) {
                    console.log('[WARNING] contract key configuration has no rights to load geoportal elevation ');
                    document.getElementById(this._addUID('GPmousePositionAlt')).innerHTML = 'No rights!';
                    return;
                }
                var options = this.options.altitude.serviceOptions || {};
                options.zonly = true;
                options.positions = [{
                        lon: coordinate.lon,
                        lat: coordinate.lat
                    }];
                options.scope = this;
                if (!options.rawResponse) {
                    options.onSuccess = function (results) {
                        if (results && Object.keys(results)) {
                            callback.call(this, results.elevations[0].z);
                        }
                    };
                } else {
                    options.onSuccess = function (results) {
                        console.log('alti service raw response : ', results);
                    };
                }
                options.onFailure = function (error) {
                    console.log('[getAltitude] ERROR : ' + error.message);
                };
                options.apiKey = options.apiKey || this.options.apiKey;
                _gp2.default.Services.getAltitude(options);
            };
            MousePosition.prototype.onShowMousePositionClick = function () {
                var globe = this.getGlobe();
                this.collapsed = this._showMousePositionContainer.checked;
                if (this._showMousePositionContainer.checked) {
                    if (this._isDesktop) {
                        globe.forget(_GlobeViewExtended2.default.EVENTS.MOUSE_MOVE, this._callbacks.mouseMove);
                    } else {
                        globe.forget(_GlobeViewExtended2.default.EVENTS.CENTER_CHANGED, this.onGlobeMove);
                    }
                } else {
                    if (this._isDesktop) {
                        globe.listen(_GlobeViewExtended2.default.EVENTS.MOUSE_MOVE, this._callbacks.mouseMove);
                    } else {
                        globe.listen(_GlobeViewExtended2.default.EVENTS.CENTER_CHANGED, this.onGlobeMove);
                    }
                }
                this._setElevationPanel(this.options.displayAltitude);
                this._setCoordinatesPanel(this.options.displayCoordinates);
                if (!this.options.displayCoordinates) {
                    this._setSettingsPanel(false);
                }
            };
            MousePosition.prototype.onMousePositionProjectionSystemChange = function (e) {
                var idx = e.target.selectedIndex;
                var value = e.target.options[idx].value;
                this._setCurrentSystem(value);
            };
            MousePosition.prototype._setCurrentSystem = function (systemCode) {
                var type = null;
                for (var i = 0; i < this._projectionSystems.length; ++i) {
                    if (this._projectionSystems[i].code == systemCode) {
                        type = this._projectionSystems[i].type;
                        break;
                    }
                }
                if (!type) {
                    logger.log('system not found in projection systems container');
                    return;
                }
                if (type !== this._currentProjectionType) {
                    this._setTypeUnitsPanel(type);
                }
                this._currentProjectionSystems = this._projectionSystems[Number(systemCode)];
                if (!this._isDesktop) {
                    this.onGlobeMove();
                }
            };
            MousePosition.prototype.onMousePositionProjectionSystemMouseOver = function () {
                var globe = this.getGlobe();
                if (!globe) {
                    return;
                }
                var globeExtent = globe.getExtent();
                var systemList = document.getElementById(this._addUID('GPmousePositionProjectionSystem'));
                systemList.innerHTML = '';
                var option;
                for (var j = 0; j < this._projectionSystems.length; j++) {
                    var proj = this._projectionSystems[j];
                    if (proj.geoBBox) {
                        if (globeExtent.west() > proj.geoBBox.right || globeExtent.south() > proj.geoBBox.top || globeExtent.east() < proj.geoBBox.left || globeExtent.north() < proj.geoBBox.bottom) {
                            if (proj === this._currentProjectionSystems) {
                                option = document.createElement('option');
                                option.value = proj.code;
                                option.text = proj.label || j;
                                option.setAttribute('selected', 'selected');
                                option.setAttribute('disabled', 'disabled');
                                systemList.appendChild(option);
                            }
                            continue;
                        }
                    }
                    option = document.createElement('option');
                    option.value = proj.code;
                    option.text = proj.label || j;
                    if (proj === this._currentProjectionSystems) {
                        option.setAttribute('selected', 'selected');
                    }
                    systemList.appendChild(option);
                }
            };
            MousePosition.prototype.onMousePositionProjectionUnitsChange = function (e) {
                var idx = e.target.selectedIndex;
                var value = e.target.options[idx].value;
                this._currentProjectionUnits = value;
                if (!this._isDesktop) {
                    this.onGlobeMove();
                }
            };
            exports.default = MousePosition;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;
            (function (root, definition) {
                'use strict';
                if (true) {
                    !(__WEBPACK_AMD_DEFINE_FACTORY__ = definition, __WEBPACK_AMD_DEFINE_RESULT__ = typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? __WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module) : __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
                } else if (typeof module === 'object' && module.exports) {
                    module.exports = definition();
                } else {
                    root.log = definition();
                }
            }(this, function () {
                'use strict';
                var noop = function () {
                };
                var undefinedType = 'undefined';
                var logMethods = [
                    'trace',
                    'debug',
                    'info',
                    'warn',
                    'error'
                ];
                function bindMethod(obj, methodName) {
                    var method = obj[methodName];
                    if (typeof method.bind === 'function') {
                        return method.bind(obj);
                    } else {
                        try {
                            return Function.prototype.bind.call(method, obj);
                        } catch (e) {
                            return function () {
                                return Function.prototype.apply.apply(method, [
                                    obj,
                                    arguments
                                ]);
                            };
                        }
                    }
                }
                function realMethod(methodName) {
                    if (methodName === 'debug') {
                        methodName = 'log';
                    }
                    if (typeof console === undefinedType) {
                        return false;
                    } else if (console[methodName] !== undefined) {
                        return bindMethod(console, methodName);
                    } else if (console.log !== undefined) {
                        return bindMethod(console, 'log');
                    } else {
                        return noop;
                    }
                }
                function replaceLoggingMethods(level, loggerName) {
                    for (var i = 0; i < logMethods.length; i++) {
                        var methodName = logMethods[i];
                        this[methodName] = i < level ? noop : this.methodFactory(methodName, level, loggerName);
                    }
                    this.log = this.debug;
                }
                function enableLoggingWhenConsoleArrives(methodName, level, loggerName) {
                    return function () {
                        if (typeof console !== undefinedType) {
                            replaceLoggingMethods.call(this, level, loggerName);
                            this[methodName].apply(this, arguments);
                        }
                    };
                }
                function defaultMethodFactory(methodName, level, loggerName) {
                    return realMethod(methodName) || enableLoggingWhenConsoleArrives.apply(this, arguments);
                }
                function Logger(name, defaultLevel, factory) {
                    var self = this;
                    var currentLevel;
                    var storageKey = 'loglevel';
                    if (name) {
                        storageKey += ':' + name;
                    }
                    function persistLevelIfPossible(levelNum) {
                        var levelName = (logMethods[levelNum] || 'silent').toUpperCase();
                        if (typeof window === undefinedType)
                            return;
                        try {
                            window.localStorage[storageKey] = levelName;
                            return;
                        } catch (ignore) {
                        }
                        try {
                            window.document.cookie = encodeURIComponent(storageKey) + '=' + levelName + ';';
                        } catch (ignore) {
                        }
                    }
                    function getPersistedLevel() {
                        var storedLevel;
                        if (typeof window === undefinedType)
                            return;
                        try {
                            storedLevel = window.localStorage[storageKey];
                        } catch (ignore) {
                        }
                        if (typeof storedLevel === undefinedType) {
                            try {
                                var cookie = window.document.cookie;
                                var location = cookie.indexOf(encodeURIComponent(storageKey) + '=');
                                if (location !== -1) {
                                    storedLevel = /^([^;]+)/.exec(cookie.slice(location))[1];
                                }
                            } catch (ignore) {
                            }
                        }
                        if (self.levels[storedLevel] === undefined) {
                            storedLevel = undefined;
                        }
                        return storedLevel;
                    }
                    self.name = name;
                    self.levels = {
                        'TRACE': 0,
                        'DEBUG': 1,
                        'INFO': 2,
                        'WARN': 3,
                        'ERROR': 4,
                        'SILENT': 5
                    };
                    self.methodFactory = factory || defaultMethodFactory;
                    self.getLevel = function () {
                        return currentLevel;
                    };
                    self.setLevel = function (level, persist) {
                        if (typeof level === 'string' && self.levels[level.toUpperCase()] !== undefined) {
                            level = self.levels[level.toUpperCase()];
                        }
                        if (typeof level === 'number' && level >= 0 && level <= self.levels.SILENT) {
                            currentLevel = level;
                            if (persist !== false) {
                                persistLevelIfPossible(level);
                            }
                            replaceLoggingMethods.call(self, level, name);
                            if (typeof console === undefinedType && level < self.levels.SILENT) {
                                return 'No console available for logging';
                            }
                        } else {
                            throw 'log.setLevel() called with invalid level: ' + level;
                        }
                    };
                    self.setDefaultLevel = function (level) {
                        if (!getPersistedLevel()) {
                            self.setLevel(level, false);
                        }
                    };
                    self.enableAll = function (persist) {
                        self.setLevel(self.levels.TRACE, persist);
                    };
                    self.disableAll = function (persist) {
                        self.setLevel(self.levels.SILENT, persist);
                    };
                    var initialLevel = getPersistedLevel();
                    if (initialLevel == null) {
                        initialLevel = defaultLevel == null ? 'WARN' : defaultLevel;
                    }
                    self.setLevel(initialLevel, false);
                }
                var defaultLogger = new Logger();
                var _loggersByName = {};
                defaultLogger.getLogger = function getLogger(name) {
                    if (typeof name !== 'string' || name === '') {
                        throw new TypeError('You must supply a name when creating a logger.');
                    }
                    var logger = _loggersByName[name];
                    if (!logger) {
                        logger = _loggersByName[name] = new Logger(name, defaultLogger.getLevel(), defaultLogger.methodFactory);
                    }
                    return logger;
                };
                var _log = typeof window !== undefinedType ? window.log : undefined;
                defaultLogger.noConflict = function () {
                    if (typeof window !== undefinedType && window.log === defaultLogger) {
                        window.log = _log;
                    }
                    return defaultLogger;
                };
                defaultLogger.getLoggers = function getLoggers() {
                    return _loggersByName;
                };
                return defaultLogger;
            }));
            return exports;
        },
        function (module, exports) {
            var g;
            g = function () {
                return this;
            }();
            try {
                g = g || Function('return this')() || (1, eval)('this');
            } catch (e) {
                if (typeof window === 'object')
                    g = window;
            }
            module.exports = g;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var PositionFormater = {
                NORTH: 'N',
                SOUTH: 'S',
                EAST: 'E',
                WEST: 'W',
                digitSecond: 2,
                digitDecimal: 5,
                digitRadian: 8,
                roundToDecimal: function roundToDecimal(inputNum, numPoints) {
                    var multiplier = Math.pow(10, numPoints);
                    return Math.round(inputNum * multiplier) / multiplier;
                },
                decimalToRadian: function decimalToRadian(location) {
                    var d = 0.017453292519943295;
                    return this.roundToDecimal(location * d, this.digitRadian);
                },
                decimalToGrade: function decimalToGrade(location) {
                    var d = 1.1111111111111112;
                    return this.roundToDecimal(location * d, this.digitRadian);
                },
                decimalToDMS: function decimalToDMS(location, hemisphere) {
                    if (location < 0) {
                        location *= -1;
                    }
                    var degrees = Math.floor(location);
                    var minutesFromRemainder = (location - degrees) * 60;
                    var minutes = Math.floor(minutesFromRemainder);
                    var secondsFromRemainder = (minutesFromRemainder - minutes) * 60;
                    var seconds = this.roundToDecimal(secondsFromRemainder, this.digitSecond);
                    var dms = degrees + '\xB0 ' + minutes + '\' ' + seconds + '" ';
                    if (hemisphere) {
                        dms += hemisphere;
                    }
                    return dms;
                },
                decimalLatToDMS: function decimalLatToDMS(location) {
                    var hemisphere = location < 0 ? this.SOUTH : this.NORTH;
                    return this.decimalToDMS(location, hemisphere);
                },
                decimalLongToDMS: function decimalLongToDMS(location) {
                    var hemisphere = location < 0 ? this.WEST : this.EAST;
                    return this.decimalToDMS(location, hemisphere);
                },
                DMSToDecimal: function DMSToDecimal(degrees, minutes, seconds, hemisphere) {
                    var ddVal = degrees + minutes / 60 + seconds / 3600;
                    ddVal = hemisphere == this.SOUTH || hemisphere == this.WEST ? ddVal * -1 : ddVal;
                    var decimal = this.roundToDecimal(ddVal, this.digitDecimal);
                    return decimal;
                }
            };
            exports.default = PositionFormater;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var CRS = {
                'EPSG:4326': '+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +units=degrees',
                'EPSG:3857': '+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs',
                'EPSG:2154': '+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',
                'EPSG:27572': '+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs',
                'EPSG:32620': '+proj=utm +zone=20 +ellps=WGS84 +datum=WGS84 +units=m +no_defs',
                'EPSG:4467': '+proj=utm +zone=21 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',
                'EPSG:2972': '+proj=utm +zone=22 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',
                'EPSG:32630': '+proj=utm +zone=30 +datum=WGS84 +units=m +no_defs',
                'EPSG:32631': '+proj=utm +zone=31 +datum=WGS84 +units=m +no_defs',
                'EPSG:32632': '+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs',
                'EPSG:4471': '+proj=utm +zone=38 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',
                'EPSG:2975': '+proj=utm +zone=40 +south +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',
                'EPSG:3296': '+proj=utm +zone=5 +south +ellps=GRS80 +towgs84=0.072,-0.507,-0.245,-0.0183,0.0003,-0.007,-0.0093 +units=m +no_defs',
                'EPSG:3297': '+proj=utm +zone=6 +south +ellps=GRS80 +towgs84=0.072,-0.507,-0.245,-0.0183,0.0003,-0.007,-0.0093 +units=m +no_defs',
                'EPSG:32707': '+proj=utm +zone=7 +south +datum=WGS84 +units=m +no_defs',
                'EPSG:32708': '+proj=utm +zone=8 +south +datum=WGS84 +units=m +no_defs',
                'EPSG:26912': '+proj=utm +zone=12 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs',
                'EPSG:32742': '+proj=utm +zone=42 +south +datum=WGS84 +units=m +no_defs',
                'EPSG:32739': '+proj=utm +zone=39 +south +datum=WGS84 +units=m +no_defs',
                'EPSG:32743': '+proj=utm +zone=43 +south +datum=WGS84 +units=m +no_defs',
                'EPSG:2986': '',
                'EPSG:32737': '+proj=utm +zone=37 +south +datum=WGS84 +units=m +no_defs',
                'EPSG:32738': '+proj=utm +zone=38 +south +datum=WGS84 +units=m +no_defs',
                'EPSG:2988': '+proj=utm +zone=1 +south +ellps=intl +towgs84=253,-132,-127,0,0,0,0 +units=m +no_defs',
                'EPSG:3163': '+proj=lcc +lat_1=-20.66666666666667 +lat_2=-22.33333333333333 +lat_0=-21.5 +lon_0=166 +x_0=400000 +y_0=300000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs'
            };
            exports.default = CRS;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _GlobeViewExtended = __webpack_require__(8);
            var _GlobeViewExtended2 = _interopRequireDefault(_GlobeViewExtended);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _LayerUtils = __webpack_require__(5);
            var _LayerUtils2 = _interopRequireDefault(_LayerUtils);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _LayerSwitcherDOM = __webpack_require__(36);
            var _LayerSwitcherDOM2 = _interopRequireDefault(_LayerSwitcherDOM);
            var _Widget = __webpack_require__(11);
            var _Widget2 = _interopRequireDefault(_Widget);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function LayerSwitcher(lsOptions) {
                lsOptions = lsOptions || {};
                var options = lsOptions.options || {};
                var layers = lsOptions.layers || [];
                if (!(this instanceof LayerSwitcher)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (layers && !Array.isArray(layers)) {
                    throw new Error('ERROR WRONG_TYPE : layers should be an array');
                }
                if (options && (typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {
                    throw new Error('ERROR WRONG_TYPE : options should be an object');
                }
                this._initialize(options, layers);
                var container = this._initContainer(options);
                this._addedLayerConf = {};
                var targetDiv = document.getElementById(options.target) || null;
                _Widget2.default.call(this, {
                    name: 'LayerSwitcher',
                    element: container,
                    target: targetDiv
                });
            }
            LayerSwitcher.prototype = Object.create(_Widget2.default.prototype, {});
            _Utils2.default.assign(LayerSwitcher.prototype, _LayerSwitcherDOM2.default);
            LayerSwitcher.prototype.constructor = LayerSwitcher;
            LayerSwitcher.prototype.setGlobe = function (globe) {
                var layers;
                if (globe) {
                    var self = this;
                    for (var i = 0; i < this._initLayers.length; i++) {
                        var layer = null;
                        if (this._initLayers[i].id) {
                            layer = globe.getLayerById(this._initLayers[i].id);
                        }
                        if (layer && this._initLayers[i].displayed) {
                            var conf = this._initLayers[i].config || {};
                            var layerOptions = {
                                title: conf.title || layer.title || this._initLayers[i].id,
                                description: conf.description || null,
                                legends: conf.legends || [],
                                metadata: conf.metadata || [],
                                quicklookUrl: conf.quicklookUrl || null
                            };
                            if (typeof conf.ipr !== 'undefined') {
                                layerOptions.ipr = conf.ipr;
                            }
                            if (typeof conf.opacity !== 'undefined') {
                                layerOptions.opacity = conf.opacity;
                            }
                            if (typeof conf.visibility !== 'undefined') {
                                layerOptions.visibility = conf.visibility;
                            }
                            this._layers[layer.id] = layerOptions;
                        }
                    }
                    this._addGlobeLayers(globe);
                    this._callbacks.onOpacityLayerCallBack = function (e) {
                        self._updateLayerOpacity(e.target.id, e.new.opacity);
                    };
                    this._callbacks.onVisibilityLayerCallBack = function (e) {
                        self._updateLayerVisibility(e.target.id, e.new.visible);
                    };
                    this._callbacks.onChangedViewCallBack = function (e) {
                        self._inRangeUpdate(e.colorLayersId);
                    };
                    globe.listen(_GlobeViewExtended2.default.EVENTS.PRE_RENDER, this._callbacks.onChangedViewCallBack);
                    globe.preRenderEventFetchColorLayersDisplayed();
                    this._callbacks.onAddedLayerCallBack = function (e) {
                        var id = e.layerId;
                        if (self) {
                            if (!self._layerDisplayedInLayerSwitcher(id)) {
                                return;
                            }
                            var layer = self.getGlobe().getLayerById(id);
                            if (layer.type === 'elevation') {
                                return;
                            }
                            var layerConf = self._getLayerConf(id) || self._addedLayerConf[id];
                            if (layerConf) {
                                self.addLayer(layer, layerConf);
                            } else {
                                self.addLayer(layer);
                            }
                        }
                    };
                    globe.listen(_GlobeViewExtended2.default.EVENTS.LAYER_ADDED, this._callbacks.onAddedLayerCallBack);
                    this._callbacks.onRemovedLayerCallBack = function (e) {
                        var id = e.layerId;
                        if (self) {
                            self.removeLayer(id);
                        }
                    };
                    globe.listen(_GlobeViewExtended2.default.EVENTS.LAYER_REMOVED, this._callbacks.onRemovedLayerCallBack);
                    this._callbacks.onIndexLayerCallBack = function (e) {
                        var arraysEquals = function arraysEquals(a1, a2) {
                            if (a1.length !== a2.length) {
                                return false;
                            }
                            for (var i = 0; i < a1.length; ++i) {
                                if (a1[i] !== a2[i]) {
                                    return false;
                                }
                            }
                            return true;
                        };
                        if (!arraysEquals(e.new.sequence, e.previous.sequence)) {
                            self._updateLayerListContainer();
                        }
                    };
                    globe.listen(_GlobeViewExtended2.default.EVENTS.LAYERS_ORDER_CHANGED, this._callbacks.onIndexLayerCallBack);
                    layers = globe.getColorLayers();
                    for (var ii = 0; ii < layers.length; ++ii) {
                        globe.addLayerListener(layers[ii], _GlobeViewExtended2.default.EVENTS.OPACITY_PROPERTY_CHANGED, this._callbacks.onOpacityLayerCallBack);
                        globe.addLayerListener(layers[ii], _GlobeViewExtended2.default.EVENTS.VISIBLE_PROPERTY_CHANGED, this._callbacks.onVisibilityLayerCallBack);
                        self._updateLayerVisibility(layers[ii].id, layers[ii].visible);
                        self._updateLayerOpacity(layers[ii].id, layers[ii].opacity);
                    }
                } else {
                    this._globe.forget(_GlobeViewExtended2.default.EVENTS.PRE_RENDER, this._callbacks.onChangedViewCallBack);
                    this._globe.forget(_GlobeViewExtended2.default.EVENTS.LAYER_ADDED, this._callbacks.onAddedLayerCallBack);
                    this._globe.forget(_GlobeViewExtended2.default.EVENTS.LAYER_REMOVED, this._callbacks.onRemovedLayerCallBack);
                    this._globe.forget(_GlobeViewExtended2.default.EVENTS.LAYERS_ORDER_CHANGED, this._callbacks.onIndexLayerCallBack);
                    layers = this._globe.getColorLayers();
                    for (var j = 0; j < layers.length; ++j) {
                        this._globe.removeLayerListener(layers[j], _GlobeViewExtended2.default.EVENTS.OPACITY_PROPERTY_CHANGED, this._callbacks.onOpacityLayerCallBack);
                        this._globe.removeLayerListener(layers[j], _GlobeViewExtended2.default.EVENTS.VISIBLE_PROPERTY_CHANGED, this._callbacks.onVisibilityLayerCallBack);
                    }
                    while (this._element.hasChildNodes()) {
                        this._element.removeChild(this._element.lastChild);
                    }
                    this._element.parentNode.removeChild(this._element);
                }
                _Widget2.default.prototype.setGlobe.call(this, globe);
            };
            LayerSwitcher.prototype.addLayer = function (layer, config) {
                config = config || {};
                var globe = this.getGlobe();
                if (!layer) {
                    console.log('[ERROR] LayerSwitcher:addLayer - missing layer parameter');
                    return;
                }
                var id = layer.id;
                if (id === 'undefined') {
                    console.log('[ERROR] LayerSwitcher:addLayer - configuration cannot be set for ' + layer + ' layer (layer id not found)');
                    return;
                }
                globe.addLayerListener(layer, _GlobeViewExtended2.default.EVENTS.OPACITY_PROPERTY_CHANGED, this._callbacks.onOpacityLayerCallBack);
                globe.addLayerListener(layer, _GlobeViewExtended2.default.EVENTS.VISIBLE_PROPERTY_CHANGED, this._callbacks.onVisibilityLayerCallBack);
                var LayerInGlobe = globe.getLayerById(id);
                if (!LayerInGlobe) {
                    console.log('[ERROR] LayerSwitcher:addLayer - configuration cannot be set for ', layer, ' layer (layer is not in globe layers )');
                    return;
                }
                if (!this._layers[id]) {
                    var layerInfos = this._getLayerInfo(layer) || {};
                    var layerOptions = {
                        title: config.title || layerInfos._title || id,
                        description: config.description || layerInfos._description || null,
                        legends: config.legends || layerInfos._legends || [],
                        metadata: config.metadata || layerInfos._metadata || [],
                        quicklookUrl: config.quicklookUrl || layerInfos._quicklookUrl || null
                    };
                    if (typeof config.ipr !== 'undefined') {
                        layerOptions.ipr = config.ipr;
                        layer.attribution = layerOptions.ipr;
                    }
                    if (typeof config.opacity !== 'undefined') {
                        layerOptions.opacity = config.opacity;
                        layer.opacity = layerOptions.opacity;
                    }
                    if (typeof config.visibility !== 'undefined') {
                        layerOptions.visibility = config.visibility;
                        layer.visible = layerOptions.visibility;
                    }
                    this._layers[id] = layerOptions;
                    this._layers[id].div = this._createLayerDiv(id);
                    this._updateLayerListContainer();
                } else if (this._layers[id] && config) {
                    for (var prop in config) {
                        if (config.hasOwnProperty(prop)) {
                            this._layers[id][prop] = config[prop];
                        }
                    }
                    if (typeof config.ipr !== 'undefined') {
                        layer.attribution = config.ipr;
                    }
                    if (typeof config.opacity !== 'undefined') {
                        layer.opacity = config.opacity;
                    }
                    if (typeof config.visibility !== 'undefined') {
                        layer.visible = config.visibility;
                    }
                    if (config.title) {
                        var nameDiv = document.getElementById(this._addUID('GPname_ID_' + id));
                        if (nameDiv) {
                            nameDiv.innerHTML = config.title;
                        }
                    }
                    var infodiv = document.getElementById(this._addUID('GPinfo_ID_' + id));
                    if (!document.getElementById(this._addUID('GPinfo_ID_' + id)) && config.description && (config.legends || config.metadata || config.quicklookUrl)) {
                        var advancedTools = document.getElementById(this._addUID('GPadvancedTools_ID_' + id));
                        if (advancedTools) {
                            advancedTools.appendChild(this._createAdvancedToolInformationElement({ id: id }));
                        }
                    }
                    if (infodiv && infodiv.className === 'GPlayerInfoOpened') {
                        document.getElementById(this._addUID('GPlayerInfoPanel')).className = 'GPlayerInfoPanelClosed';
                        infodiv.className === 'GPlayerInfo';
                    }
                }
            };
            LayerSwitcher.prototype.removeLayer = function (layerId) {
                var layerList = document.getElementById(this._addUID('GPlayersList'));
                var infodiv = document.getElementById(this._addUID('GPinfo_ID_' + layerId));
                if (infodiv && infodiv.className === 'GPlayerInfoOpened') {
                    document.getElementById(this._addUID('GPlayerInfoPanel')).className = 'GPlayerInfoPanelClosed';
                    infodiv.className === 'GPlayerInfo';
                }
                var layerDiv = document.getElementById(this._addUID('GPlayerSwitcher_ID_' + layerId));
                layerList.removeChild(layerDiv);
                delete this._layers[layerId];
            };
            LayerSwitcher.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] LayerSwitcher:setCollapsed - missing collapsed parameter');
                    return;
                }
                var isCollapsed = this.getCollapsed();
                if (collapsed && isCollapsed || !collapsed && !isCollapsed) {
                    return;
                }
                if (!isCollapsed) {
                    var layers = document.getElementsByClassName('GPlayerInfoOpened');
                    for (var i = 0; i < layers.length; i++) {
                        layers[i].className = 'GPlayerInfo';
                    }
                    document.getElementById(this._addUID('GPlayerInfoPanel')).className = 'GPlayerInfoPanelClosed';
                }
                document.getElementById(this._addUID('GPshowLayersList')).checked = !collapsed;
            };
            LayerSwitcher.prototype.getCollapsed = function () {
                return !document.getElementById(this._addUID('GPshowLayersList')).checked;
            };
            LayerSwitcher.prototype._initialize = function (options, layers) {
                this._uid = _SelectorID2.default.generate();
                this._layers = {};
                this._layerListContainer = null;
                this._callbacks = {};
                this._options = options;
                this._initLayers = layers;
            };
            LayerSwitcher.prototype._getLayerConf = function (layerId) {
                for (var i = 0; i < this._initLayers.length; ++i) {
                    if (this._initLayers[i].id === layerId) {
                        return this._initLayers[i].config;
                    }
                }
                return null;
            };
            LayerSwitcher.prototype._layerDisplayedInLayerSwitcher = function (layerId) {
                for (var i = 0; i < this._initLayers.length; ++i) {
                    if (this._initLayers[i].id === layerId) {
                        return typeof this._initLayers[i].displayed === 'undefined' || this._initLayers[i].displayed;
                    }
                }
                return true;
            };
            LayerSwitcher.prototype._initContainer = function (options) {
                var container = this._createMainContainerElement();
                var input = this._createMainLayersShowElement();
                container.appendChild(input);
                if (!options.collapsed) {
                    input.checked = 'checked';
                }
                var divL = this._layerListContainer = this._createMainLayersElement();
                container.appendChild(divL);
                this._createDraggableElement(divL, this);
                var picto = this._createMainPictoElement();
                container.appendChild(picto);
                var divI = this._createMainInfoElement();
                container.appendChild(divI);
                return container;
            };
            LayerSwitcher.prototype._addGlobeLayers = function (globe) {
                var elementLayersList;
                var childNodes = this.getElement().childNodes;
                for (var i = 0; i < childNodes.length; i++) {
                    if (childNodes[i].id === this._addUID('GPlayersList')) {
                        elementLayersList = childNodes[i];
                        break;
                    }
                }
                var layers = globe.getColorLayers();
                var orderedLayers = layers.sort(function (a, b) {
                    return b.sequence - a.sequence;
                });
                orderedLayers.forEach(function (layer) {
                    var id;
                    id = layer.id;
                    if (!this._layerDisplayedInLayerSwitcher(id)) {
                        return;
                    }
                    var layerConf = this._getLayerConf(id) || this._addedLayerConf[id] || {};
                    var layerInfos = this._getLayerInfo(layer) || {};
                    if (!this._layers[id]) {
                        var layerOptions = {
                            title: layerConf.title || layerInfos._title || id,
                            description: layerConf.description || layerInfos._description || null,
                            legends: layerConf.legends || layerInfos._legends || [],
                            metadata: layerConf.metadata || layerInfos._metadata || [],
                            quicklookUrl: layerConf.quicklookUrl || layerInfos._quicklookUrl || null
                        };
                        this._layers[id] = layerOptions;
                    } else {
                        var lsLayerConf = this._layers[id];
                        if (typeof lsLayerConf.ipr !== 'undefined') {
                            layer.options.attribution = lsLayerConf.ipr;
                        }
                        if (typeof lsLayerConf.opacity !== 'undefined') {
                            layer.opacity = lsLayerConf.opacity;
                        }
                        if (typeof lsLayerConf.visibility !== 'undefined') {
                            layer.visible = lsLayerConf.visibility;
                        }
                    }
                    var layerDiv = this._createLayerDiv(id);
                    this._layers[id].div = layerDiv;
                    elementLayersList.appendChild(layerDiv);
                }, this);
            };
            LayerSwitcher.prototype._createLayerDiv = function (layerId) {
                var layerOptions = this._layers[layerId];
                var isLegends = layerOptions.legends && layerOptions.legends.length !== 0;
                var isMetadata = layerOptions.metadata && layerOptions.metadata.length !== 0;
                var isQuicklookUrl = layerOptions.quicklookUrl;
                if (isLegends || isMetadata || isQuicklookUrl) {
                    layerOptions.displayInformationElement = true;
                }
                layerOptions.id = layerId;
                var layerDiv = this._createContainerLayerElement(layerOptions);
                if (!layerOptions.inRange) {
                    layerDiv.classList.add('outOfRange');
                }
                return layerDiv;
            };
            LayerSwitcher.prototype._onChangeLayerOpacity = function (e) {
                var globe = this.getGlobe();
                var layerID = this._resolveLayerId(e.target.id);
                var opacityValue = e.target.value;
                var opacityId = document.getElementById(this._addUID('GPopacityValue_ID_' + layerID));
                opacityId.innerHTML = opacityValue + '%';
                globe.setLayerOpacity(layerID, opacityValue / 100);
            };
            LayerSwitcher.prototype._updateLayerOpacity = function (layerId, opacity) {
                if (opacity > 1) {
                    opacity = 1;
                }
                if (opacity < 0) {
                    opacity = 0;
                }
                var layerOpacityInput = document.getElementById(this._addUID('GPopacityValueDiv_ID_' + layerId));
                if (layerOpacityInput) {
                    layerOpacityInput.value = Math.round(opacity * 100);
                }
                var layerOpacitySpan = document.getElementById(this._addUID('GPopacityValue_ID_' + layerId));
                if (layerOpacitySpan) {
                    layerOpacitySpan.innerHTML = Math.round(opacity * 100) + '%';
                }
            };
            LayerSwitcher.prototype._onVisibilityLayerClick = function (e) {
                var globe = this.getGlobe();
                var layerID = this._resolveLayerId(e.target.id);
                globe.setLayerVisibility(layerID, e.target.checked);
            };
            LayerSwitcher.prototype._updateLayerVisibility = function (layerId, visibility) {
                var layerVisibilityInput = document.getElementById(this._addUID('GPvisibility_ID_' + layerId));
                if (layerVisibilityInput) {
                    layerVisibilityInput.checked = visibility;
                }
            };
            LayerSwitcher.prototype._onOpenLayerInfoClick = function (e) {
                var layerID = this._resolveLayerId(e.target.id);
                var layerOptions = this._layers[layerID];
                var panel;
                var info;
                var divId = document.getElementById(e.target.id);
                if (divId.className === 'GPlayerInfoOpened') {
                    if (divId.classList !== undefined) {
                        divId.classList.remove('GPlayerInfoOpened');
                        divId.classList.add('GPlayerInfo');
                    }
                    panel = document.getElementById(this._addUID('GPlayerInfoPanel'));
                    if (panel.classList !== undefined) {
                        panel.classList.remove('GPpanel');
                        panel.classList.remove('GPlayerInfoPanelOpened');
                        panel.classList.add('GPlayerInfoPanelClosed');
                    }
                    info = document.getElementById(this._addUID('GPlayerInfoContent'));
                    panel.removeChild(info);
                    return;
                }
                var layers = document.getElementsByClassName('GPlayerInfoOpened');
                for (var i = 0; i < layers.length; i++) {
                    layers[i].className = 'GPlayerInfo';
                }
                if (divId.classList !== undefined) {
                    divId.classList.remove('GPlayerInfo');
                    divId.classList.add('GPlayerInfoOpened');
                }
                panel = document.getElementById(this._addUID('GPlayerInfoPanel'));
                if (panel.classList !== undefined) {
                    panel.classList.add('GPpanel');
                    panel.classList.remove('GPlayerInfoPanelClosed');
                    panel.classList.add('GPlayerInfoPanelOpened');
                }
                info = document.getElementById(this._addUID('GPlayerInfoContent'));
                if (info) {
                    panel.removeChild(info);
                }
                var obj = {
                    title: layerOptions.title,
                    description: layerOptions.description,
                    quicklookUrl: layerOptions.quicklookUrl,
                    metadata: layerOptions.metadata,
                    legends: layerOptions.legends
                };
                var infoLayer = this._createContainerLayerInfoElement(obj);
                panel.appendChild(infoLayer);
            };
            LayerSwitcher.prototype._onDropLayerClick = function (e) {
                var globe = this.getGlobe();
                var layerID = this._resolveLayerId(e.target.id);
                globe.removeLayer(layerID);
                this._updateLayerListContainer();
            };
            LayerSwitcher.prototype._onDragAndDropLayerClick = function (e) {
                var globe = this.getGlobe();
                if (e.newIndex - e.oldIndex === 0) {
                    return;
                }
                var targetIndex = null;
                if (!e.newIndex || e.newIndex === 0) {
                    targetIndex = globe.getColorLayers().length - 1;
                } else {
                    var layerTargetID = this._resolveLayerId(e.from.childNodes[e.newIndex + (e.newIndex - e.oldIndex < 0 ? 1 : -1)].id);
                    targetIndex = globe.getLayerById(layerTargetID).sequence;
                }
                var layerID = this._resolveLayerId(e.item.id);
                globe.moveLayerToIndex(layerID, targetIndex);
            };
            LayerSwitcher.prototype._inRangeUpdate = function (layersDisplayed) {
                for (var layerKey in this._layers) {
                    var layer = this._layers[layerKey];
                    if (!layer) {
                        continue;
                    }
                    var layerDiv;
                    var bInRange = layersDisplayed.indexOf(layer.id) >= 0;
                    if (bInRange && !layer.inRange) {
                        layer.inRange = true;
                        layerDiv = document.getElementById(this._addUID('GPlayerSwitcher_ID_' + layer.id));
                        layerDiv.classList.remove('outOfRange');
                    } else if (!bInRange && layer.inRange) {
                        layer.inRange = false;
                        layerDiv = document.getElementById(this._addUID('GPlayerSwitcher_ID_' + layer.id));
                        layerDiv.classList.add('outOfRange');
                    }
                }
            };
            LayerSwitcher.prototype._updateLayerListContainer = function () {
                if (this._layerListContainer) {
                    var globe = this.getGlobe();
                    while (this._layerListContainer.firstChild) {
                        this._layerListContainer.removeChild(this._layerListContainer.firstChild);
                    }
                    var layers = globe.getColorLayers();
                    var orderedLayers = layers.sort(function (a, b) {
                        return b.sequence - a.sequence;
                    });
                    for (var j = 0; j < orderedLayers.length; j++) {
                        if (!this._layers[orderedLayers[j].id]) {
                            continue;
                        }
                        var layerDiv = this._layers[orderedLayers[j].id].div;
                        this._layerListContainer.appendChild(layerDiv);
                    }
                } else {
                    console.log('[Itowns.control.LayerSwitcher] _updateLayerListContainer : layer list container not found to update layers order ?!');
                }
            };
            LayerSwitcher.prototype._getLayerInfo = function (layer) {
                var layerInfo = {};
                if (layer) {
                    layerInfo._title = layer.title || null;
                    layerInfo._description = layer.description || null;
                    layerInfo._quicklookUrl = layer.quicklookUrl || null;
                    layerInfo._metadata = layer.metadata || null;
                    layerInfo._legends = layer.legends || null;
                }
                return layerInfo;
            };
            LayerSwitcher.prototype._resolveLayerId = function (divId) {
                var divName = _SelectorID2.default.name(divId);
                return divName.substring(divName.indexOf('_ID_') + 4);
            };
            exports.default = LayerSwitcher;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__;
            (function (factory) {
                'use strict';
                if (true) {
                    !(__WEBPACK_AMD_DEFINE_FACTORY__ = factory, __WEBPACK_AMD_DEFINE_RESULT__ = typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ? __WEBPACK_AMD_DEFINE_FACTORY__.call(exports, __webpack_require__, exports, module) : __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
                } else if (typeof module != 'undefined' && typeof module.exports != 'undefined') {
                    module.exports = factory();
                } else if (typeof Package !== 'undefined') {
                    Sortable = factory();
                } else {
                    window['Sortable'] = factory();
                }
            }(function () {
                'use strict';
                var dragEl, parentEl, ghostEl, cloneEl, rootEl, nextEl, scrollEl, scrollParentEl, lastEl, lastCSS, lastParentCSS, oldIndex, newIndex, activeGroup, autoScroll = {}, tapEvt, touchEvt, moved, RSPACE = /\s+/g, expando = 'Sortable' + new Date().getTime(), win = window, document = win.document, parseInt = win.parseInt, supportDraggable = !!('draggable' in document.createElement('div')), supportCssPointerEvents = function (el) {
                        el = document.createElement('x');
                        el.style.cssText = 'pointer-events:auto';
                        return el.style.pointerEvents === 'auto';
                    }(), _silent = false, abs = Math.abs, slice = [].slice, touchDragOverListeners = [], _autoScroll = _throttle(function (evt, options, rootEl) {
                        if (rootEl && options.scroll) {
                            var el, rect, sens = options.scrollSensitivity, speed = options.scrollSpeed, x = evt.clientX, y = evt.clientY, winWidth = window.innerWidth, winHeight = window.innerHeight, vx, vy;
                            if (scrollParentEl !== rootEl) {
                                scrollEl = options.scroll;
                                scrollParentEl = rootEl;
                                if (scrollEl === true) {
                                    scrollEl = rootEl;
                                    do {
                                        if (scrollEl.offsetWidth < scrollEl.scrollWidth || scrollEl.offsetHeight < scrollEl.scrollHeight) {
                                            break;
                                        }
                                    } while (scrollEl = scrollEl.parentNode);
                                }
                            }
                            if (scrollEl) {
                                el = scrollEl;
                                rect = scrollEl.getBoundingClientRect();
                                vx = (abs(rect.right - x) <= sens) - (abs(rect.left - x) <= sens);
                                vy = (abs(rect.bottom - y) <= sens) - (abs(rect.top - y) <= sens);
                            }
                            if (!(vx || vy)) {
                                vx = (winWidth - x <= sens) - (x <= sens);
                                vy = (winHeight - y <= sens) - (y <= sens);
                                (vx || vy) && (el = win);
                            }
                            if (autoScroll.vx !== vx || autoScroll.vy !== vy || autoScroll.el !== el) {
                                autoScroll.el = el;
                                autoScroll.vx = vx;
                                autoScroll.vy = vy;
                                clearInterval(autoScroll.pid);
                                if (el) {
                                    autoScroll.pid = setInterval(function () {
                                        if (el === win) {
                                            win.scrollTo(win.pageXOffset + vx * speed, win.pageYOffset + vy * speed);
                                        } else {
                                            vy && (el.scrollTop += vy * speed);
                                            vx && (el.scrollLeft += vx * speed);
                                        }
                                    }, 24);
                                }
                            }
                        }
                    }, 30), _prepareGroup = function (options) {
                        var group = options.group;
                        if (!group || typeof group != 'object') {
                            group = options.group = { name: group };
                        }
                        [
                            'pull',
                            'put'
                        ].forEach(function (key) {
                            if (!(key in group)) {
                                group[key] = true;
                            }
                        });
                        options.groups = ' ' + group.name + (group.put.join ? ' ' + group.put.join(' ') : '') + ' ';
                    };
                function Sortable(el, options) {
                    if (!(el && el.nodeType && el.nodeType === 1)) {
                        throw 'Sortable: `el` must be HTMLElement, and not ' + {}.toString.call(el);
                    }
                    this.el = el;
                    this.options = options = _extend({}, options);
                    el[expando] = this;
                    var defaults = {
                        group: Math.random(),
                        sort: true,
                        disabled: false,
                        store: null,
                        handle: null,
                        scroll: true,
                        scrollSensitivity: 30,
                        scrollSpeed: 10,
                        draggable: /[uo]l/i.test(el.nodeName) ? 'li' : '>*',
                        ghostClass: 'sortable-ghost',
                        chosenClass: 'sortable-chosen',
                        ignore: 'a, img',
                        filter: null,
                        animation: 0,
                        setData: function (dataTransfer, dragEl) {
                            dataTransfer.setData('Text', dragEl.textContent);
                        },
                        dropBubble: false,
                        dragoverBubble: false,
                        dataIdAttr: 'data-id',
                        delay: 0,
                        forceFallback: false,
                        fallbackClass: 'sortable-fallback',
                        fallbackOnBody: false
                    };
                    for (var name in defaults) {
                        !(name in options) && (options[name] = defaults[name]);
                    }
                    _prepareGroup(options);
                    for (var fn in this) {
                        if (fn.charAt(0) === '_') {
                            this[fn] = this[fn].bind(this);
                        }
                    }
                    this.nativeDraggable = options.forceFallback ? false : supportDraggable;
                    _on(el, 'mousedown', this._onTapStart);
                    _on(el, 'touchstart', this._onTapStart);
                    if (this.nativeDraggable) {
                        _on(el, 'dragover', this);
                        _on(el, 'dragenter', this);
                    }
                    touchDragOverListeners.push(this._onDragOver);
                    options.store && this.sort(options.store.get(this));
                }
                Sortable.prototype = {
                    constructor: Sortable,
                    _onTapStart: function (evt) {
                        var _this = this, el = this.el, options = this.options, type = evt.type, touch = evt.touches && evt.touches[0], target = (touch || evt).target, originalTarget = target, filter = options.filter;
                        if (type === 'mousedown' && evt.button !== 0 || options.disabled) {
                            return;
                        }
                        target = _closest(target, options.draggable, el);
                        if (!target) {
                            return;
                        }
                        oldIndex = _index(target);
                        if (typeof filter === 'function') {
                            if (filter.call(this, evt, target, this)) {
                                _dispatchEvent(_this, originalTarget, 'filter', target, el, oldIndex);
                                evt.preventDefault();
                                return;
                            }
                        } else if (filter) {
                            filter = filter.split(',').some(function (criteria) {
                                criteria = _closest(originalTarget, criteria.trim(), el);
                                if (criteria) {
                                    _dispatchEvent(_this, criteria, 'filter', target, el, oldIndex);
                                    return true;
                                }
                            });
                            if (filter) {
                                evt.preventDefault();
                                return;
                            }
                        }
                        if (options.handle && !_closest(originalTarget, options.handle, el)) {
                            return;
                        }
                        this._prepareDragStart(evt, touch, target);
                    },
                    _prepareDragStart: function (evt, touch, target) {
                        var _this = this, el = _this.el, options = _this.options, ownerDocument = el.ownerDocument, dragStartFn;
                        if (target && !dragEl && target.parentNode === el) {
                            tapEvt = evt;
                            rootEl = el;
                            dragEl = target;
                            parentEl = dragEl.parentNode;
                            nextEl = dragEl.nextSibling;
                            activeGroup = options.group;
                            dragStartFn = function () {
                                _this._disableDelayedDrag();
                                dragEl.draggable = true;
                                _toggleClass(dragEl, _this.options.chosenClass, true);
                                _this._triggerDragStart(touch);
                            };
                            options.ignore.split(',').forEach(function (criteria) {
                                _find(dragEl, criteria.trim(), _disableDraggable);
                            });
                            _on(ownerDocument, 'mouseup', _this._onDrop);
                            _on(ownerDocument, 'touchend', _this._onDrop);
                            _on(ownerDocument, 'touchcancel', _this._onDrop);
                            if (options.delay) {
                                _on(ownerDocument, 'mouseup', _this._disableDelayedDrag);
                                _on(ownerDocument, 'touchend', _this._disableDelayedDrag);
                                _on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);
                                _on(ownerDocument, 'mousemove', _this._disableDelayedDrag);
                                _on(ownerDocument, 'touchmove', _this._disableDelayedDrag);
                                _this._dragStartTimer = setTimeout(dragStartFn, options.delay);
                            } else {
                                dragStartFn();
                            }
                        }
                    },
                    _disableDelayedDrag: function () {
                        var ownerDocument = this.el.ownerDocument;
                        clearTimeout(this._dragStartTimer);
                        _off(ownerDocument, 'mouseup', this._disableDelayedDrag);
                        _off(ownerDocument, 'touchend', this._disableDelayedDrag);
                        _off(ownerDocument, 'touchcancel', this._disableDelayedDrag);
                        _off(ownerDocument, 'mousemove', this._disableDelayedDrag);
                        _off(ownerDocument, 'touchmove', this._disableDelayedDrag);
                    },
                    _triggerDragStart: function (touch) {
                        if (touch) {
                            tapEvt = {
                                target: dragEl,
                                clientX: touch.clientX,
                                clientY: touch.clientY
                            };
                            this._onDragStart(tapEvt, 'touch');
                        } else if (!this.nativeDraggable) {
                            this._onDragStart(tapEvt, true);
                        } else {
                            _on(dragEl, 'dragend', this);
                            _on(rootEl, 'dragstart', this._onDragStart);
                        }
                        try {
                            if (document.selection) {
                                document.selection.empty();
                            } else {
                                window.getSelection().removeAllRanges();
                            }
                        } catch (err) {
                        }
                    },
                    _dragStarted: function () {
                        if (rootEl && dragEl) {
                            _toggleClass(dragEl, this.options.ghostClass, true);
                            Sortable.active = this;
                            _dispatchEvent(this, rootEl, 'start', dragEl, rootEl, oldIndex);
                        }
                    },
                    _emulateDragOver: function () {
                        if (touchEvt) {
                            if (this._lastX === touchEvt.clientX && this._lastY === touchEvt.clientY) {
                                return;
                            }
                            this._lastX = touchEvt.clientX;
                            this._lastY = touchEvt.clientY;
                            if (!supportCssPointerEvents) {
                                _css(ghostEl, 'display', 'none');
                            }
                            var target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY), parent = target, groupName = ' ' + this.options.group.name + '', i = touchDragOverListeners.length;
                            if (parent) {
                                do {
                                    if (parent[expando] && parent[expando].options.groups.indexOf(groupName) > -1) {
                                        while (i--) {
                                            touchDragOverListeners[i]({
                                                clientX: touchEvt.clientX,
                                                clientY: touchEvt.clientY,
                                                target: target,
                                                rootEl: parent
                                            });
                                        }
                                        break;
                                    }
                                    target = parent;
                                } while (parent = parent.parentNode);
                            }
                            if (!supportCssPointerEvents) {
                                _css(ghostEl, 'display', '');
                            }
                        }
                    },
                    _onTouchMove: function (evt) {
                        if (tapEvt) {
                            if (!Sortable.active) {
                                this._dragStarted();
                            }
                            this._appendGhost();
                            var touch = evt.touches ? evt.touches[0] : evt, dx = touch.clientX - tapEvt.clientX, dy = touch.clientY - tapEvt.clientY, translate3d = evt.touches ? 'translate3d(' + dx + 'px,' + dy + 'px,0)' : 'translate(' + dx + 'px,' + dy + 'px)';
                            moved = true;
                            touchEvt = touch;
                            _css(ghostEl, 'webkitTransform', translate3d);
                            _css(ghostEl, 'mozTransform', translate3d);
                            _css(ghostEl, 'msTransform', translate3d);
                            _css(ghostEl, 'transform', translate3d);
                            evt.preventDefault();
                        }
                    },
                    _appendGhost: function () {
                        if (!ghostEl) {
                            var rect = dragEl.getBoundingClientRect(), css = _css(dragEl), options = this.options, ghostRect;
                            ghostEl = dragEl.cloneNode(true);
                            _toggleClass(ghostEl, options.ghostClass, false);
                            _toggleClass(ghostEl, options.fallbackClass, true);
                            _css(ghostEl, 'top', rect.top - parseInt(css.marginTop, 10));
                            _css(ghostEl, 'left', rect.left - parseInt(css.marginLeft, 10));
                            _css(ghostEl, 'width', rect.width);
                            _css(ghostEl, 'height', rect.height);
                            _css(ghostEl, 'opacity', '0.8');
                            _css(ghostEl, 'position', 'fixed');
                            _css(ghostEl, 'zIndex', '100000');
                            _css(ghostEl, 'pointerEvents', 'none');
                            options.fallbackOnBody && document.body.appendChild(ghostEl) || rootEl.appendChild(ghostEl);
                            ghostRect = ghostEl.getBoundingClientRect();
                            _css(ghostEl, 'width', rect.width * 2 - ghostRect.width);
                            _css(ghostEl, 'height', rect.height * 2 - ghostRect.height);
                        }
                    },
                    _onDragStart: function (evt, useFallback) {
                        var dataTransfer = evt.dataTransfer, options = this.options;
                        this._offUpEvents();
                        if (activeGroup.pull == 'clone') {
                            cloneEl = dragEl.cloneNode(true);
                            _css(cloneEl, 'display', 'none');
                            rootEl.insertBefore(cloneEl, dragEl);
                        }
                        if (useFallback) {
                            if (useFallback === 'touch') {
                                _on(document, 'touchmove', this._onTouchMove);
                                _on(document, 'touchend', this._onDrop);
                                _on(document, 'touchcancel', this._onDrop);
                            } else {
                                _on(document, 'mousemove', this._onTouchMove);
                                _on(document, 'mouseup', this._onDrop);
                            }
                            this._loopId = setInterval(this._emulateDragOver, 50);
                        } else {
                            if (dataTransfer) {
                                dataTransfer.effectAllowed = 'move';
                                options.setData && options.setData.call(this, dataTransfer, dragEl);
                            }
                            _on(document, 'drop', this);
                            setTimeout(this._dragStarted, 0);
                        }
                    },
                    _onDragOver: function (evt) {
                        var el = this.el, target, dragRect, revert, options = this.options, group = options.group, groupPut = group.put, isOwner = activeGroup === group, canSort = options.sort;
                        if (evt.preventDefault !== void 0) {
                            evt.preventDefault();
                            !options.dragoverBubble && evt.stopPropagation();
                        }
                        moved = true;
                        if (activeGroup && !options.disabled && (isOwner ? canSort || (revert = !rootEl.contains(dragEl)) : activeGroup.pull && groupPut && (activeGroup.name === group.name || groupPut.indexOf && ~groupPut.indexOf(activeGroup.name))) && (evt.rootEl === void 0 || evt.rootEl === this.el)) {
                            _autoScroll(evt, options, this.el);
                            if (_silent) {
                                return;
                            }
                            target = _closest(evt.target, options.draggable, el);
                            dragRect = dragEl.getBoundingClientRect();
                            if (revert) {
                                _cloneHide(true);
                                if (cloneEl || nextEl) {
                                    rootEl.insertBefore(dragEl, cloneEl || nextEl);
                                } else if (!canSort) {
                                    rootEl.appendChild(dragEl);
                                }
                                return;
                            }
                            if (el.children.length === 0 || el.children[0] === ghostEl || el === evt.target && (target = _ghostIsLast(el, evt))) {
                                if (target) {
                                    if (target.animated) {
                                        return;
                                    }
                                    targetRect = target.getBoundingClientRect();
                                }
                                _cloneHide(isOwner);
                                if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect) !== false) {
                                    if (!dragEl.contains(el)) {
                                        el.appendChild(dragEl);
                                        parentEl = el;
                                    }
                                    this._animate(dragRect, dragEl);
                                    target && this._animate(targetRect, target);
                                }
                            } else if (target && !target.animated && target !== dragEl && target.parentNode[expando] !== void 0) {
                                if (lastEl !== target) {
                                    lastEl = target;
                                    lastCSS = _css(target);
                                    lastParentCSS = _css(target.parentNode);
                                }
                                var targetRect = target.getBoundingClientRect(), width = targetRect.right - targetRect.left, height = targetRect.bottom - targetRect.top, floating = /left|right|inline/.test(lastCSS.cssFloat + lastCSS.display) || lastParentCSS.display == 'flex' && lastParentCSS['flex-direction'].indexOf('row') === 0, isWide = target.offsetWidth > dragEl.offsetWidth, isLong = target.offsetHeight > dragEl.offsetHeight, halfway = (floating ? (evt.clientX - targetRect.left) / width : (evt.clientY - targetRect.top) / height) > 0.5, nextSibling = target.nextElementSibling, moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect), after;
                                if (moveVector !== false) {
                                    _silent = true;
                                    setTimeout(_unsilent, 30);
                                    _cloneHide(isOwner);
                                    if (moveVector === 1 || moveVector === -1) {
                                        after = moveVector === 1;
                                    } else if (floating) {
                                        var elTop = dragEl.offsetTop, tgTop = target.offsetTop;
                                        if (elTop === tgTop) {
                                            after = target.previousElementSibling === dragEl && !isWide || halfway && isWide;
                                        } else {
                                            after = tgTop > elTop;
                                        }
                                    } else {
                                        after = nextSibling !== dragEl && !isLong || halfway && isLong;
                                    }
                                    if (!dragEl.contains(el)) {
                                        if (after && !nextSibling) {
                                            el.appendChild(dragEl);
                                        } else {
                                            target.parentNode.insertBefore(dragEl, after ? nextSibling : target);
                                        }
                                    }
                                    parentEl = dragEl.parentNode;
                                    this._animate(dragRect, dragEl);
                                    this._animate(targetRect, target);
                                }
                            }
                        }
                    },
                    _animate: function (prevRect, target) {
                        var ms = this.options.animation;
                        if (ms) {
                            var currentRect = target.getBoundingClientRect();
                            _css(target, 'transition', 'none');
                            _css(target, 'transform', 'translate3d(' + (prevRect.left - currentRect.left) + 'px,' + (prevRect.top - currentRect.top) + 'px,0)');
                            target.offsetWidth;
                            _css(target, 'transition', 'all ' + ms + 'ms');
                            _css(target, 'transform', 'translate3d(0,0,0)');
                            clearTimeout(target.animated);
                            target.animated = setTimeout(function () {
                                _css(target, 'transition', '');
                                _css(target, 'transform', '');
                                target.animated = false;
                            }, ms);
                        }
                    },
                    _offUpEvents: function () {
                        var ownerDocument = this.el.ownerDocument;
                        _off(document, 'touchmove', this._onTouchMove);
                        _off(ownerDocument, 'mouseup', this._onDrop);
                        _off(ownerDocument, 'touchend', this._onDrop);
                        _off(ownerDocument, 'touchcancel', this._onDrop);
                    },
                    _onDrop: function (evt) {
                        var el = this.el, options = this.options;
                        clearInterval(this._loopId);
                        clearInterval(autoScroll.pid);
                        clearTimeout(this._dragStartTimer);
                        _off(document, 'mousemove', this._onTouchMove);
                        if (this.nativeDraggable) {
                            _off(document, 'drop', this);
                            _off(el, 'dragstart', this._onDragStart);
                        }
                        this._offUpEvents();
                        if (evt) {
                            if (moved) {
                                evt.preventDefault();
                                !options.dropBubble && evt.stopPropagation();
                            }
                            ghostEl && ghostEl.parentNode.removeChild(ghostEl);
                            if (dragEl) {
                                if (this.nativeDraggable) {
                                    _off(dragEl, 'dragend', this);
                                }
                                _disableDraggable(dragEl);
                                _toggleClass(dragEl, this.options.ghostClass, false);
                                _toggleClass(dragEl, this.options.chosenClass, false);
                                if (rootEl !== parentEl) {
                                    newIndex = _index(dragEl);
                                    if (newIndex >= 0) {
                                        _dispatchEvent(null, parentEl, 'sort', dragEl, rootEl, oldIndex, newIndex);
                                        _dispatchEvent(this, rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);
                                        _dispatchEvent(null, parentEl, 'add', dragEl, rootEl, oldIndex, newIndex);
                                        _dispatchEvent(this, rootEl, 'remove', dragEl, rootEl, oldIndex, newIndex);
                                    }
                                } else {
                                    cloneEl && cloneEl.parentNode.removeChild(cloneEl);
                                    if (dragEl.nextSibling !== nextEl) {
                                        newIndex = _index(dragEl);
                                        if (newIndex >= 0) {
                                            _dispatchEvent(this, rootEl, 'update', dragEl, rootEl, oldIndex, newIndex);
                                            _dispatchEvent(this, rootEl, 'sort', dragEl, rootEl, oldIndex, newIndex);
                                        }
                                    }
                                }
                                if (Sortable.active) {
                                    if (newIndex === null || newIndex === -1) {
                                        newIndex = oldIndex;
                                    }
                                    _dispatchEvent(this, rootEl, 'end', dragEl, rootEl, oldIndex, newIndex);
                                    this.save();
                                }
                            }
                            rootEl = dragEl = parentEl = ghostEl = nextEl = cloneEl = scrollEl = scrollParentEl = tapEvt = touchEvt = moved = newIndex = lastEl = lastCSS = activeGroup = Sortable.active = null;
                        }
                    },
                    handleEvent: function (evt) {
                        var type = evt.type;
                        if (type === 'dragover' || type === 'dragenter') {
                            if (dragEl) {
                                this._onDragOver(evt);
                                _globalDragOver(evt);
                            }
                        } else if (type === 'drop' || type === 'dragend') {
                            this._onDrop(evt);
                        }
                    },
                    toArray: function () {
                        var order = [], el, children = this.el.children, i = 0, n = children.length, options = this.options;
                        for (; i < n; i++) {
                            el = children[i];
                            if (_closest(el, options.draggable, this.el)) {
                                order.push(el.getAttribute(options.dataIdAttr) || _generateId(el));
                            }
                        }
                        return order;
                    },
                    sort: function (order) {
                        var items = {}, rootEl = this.el;
                        this.toArray().forEach(function (id, i) {
                            var el = rootEl.children[i];
                            if (_closest(el, this.options.draggable, rootEl)) {
                                items[id] = el;
                            }
                        }, this);
                        order.forEach(function (id) {
                            if (items[id]) {
                                rootEl.removeChild(items[id]);
                                rootEl.appendChild(items[id]);
                            }
                        });
                    },
                    save: function () {
                        var store = this.options.store;
                        store && store.set(this);
                    },
                    closest: function (el, selector) {
                        return _closest(el, selector || this.options.draggable, this.el);
                    },
                    option: function (name, value) {
                        var options = this.options;
                        if (value === void 0) {
                            return options[name];
                        } else {
                            options[name] = value;
                            if (name === 'group') {
                                _prepareGroup(options);
                            }
                        }
                    },
                    destroy: function () {
                        var el = this.el;
                        el[expando] = null;
                        _off(el, 'mousedown', this._onTapStart);
                        _off(el, 'touchstart', this._onTapStart);
                        if (this.nativeDraggable) {
                            _off(el, 'dragover', this);
                            _off(el, 'dragenter', this);
                        }
                        Array.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {
                            el.removeAttribute('draggable');
                        });
                        touchDragOverListeners.splice(touchDragOverListeners.indexOf(this._onDragOver), 1);
                        this._onDrop();
                        this.el = el = null;
                    }
                };
                function _cloneHide(state) {
                    if (cloneEl && cloneEl.state !== state) {
                        _css(cloneEl, 'display', state ? 'none' : '');
                        !state && cloneEl.state && rootEl.insertBefore(cloneEl, dragEl);
                        cloneEl.state = state;
                    }
                }
                function _closest(el, selector, ctx) {
                    if (el) {
                        ctx = ctx || document;
                        selector = selector.split('.');
                        var tag = selector.shift().toUpperCase(), re = new RegExp('\\s(' + selector.join('|') + ')(?=\\s)', 'g');
                        do {
                            if (tag === '>*' && el.parentNode === ctx || (tag === '' || el.nodeName.toUpperCase() == tag) && (!selector.length || ((' ' + el.className + ' ').match(re) || []).length == selector.length)) {
                                return el;
                            }
                        } while (el !== ctx && (el = el.parentNode));
                    }
                    return null;
                }
                function _globalDragOver(evt) {
                    if (evt.dataTransfer) {
                        evt.dataTransfer.dropEffect = 'move';
                    }
                    evt.preventDefault();
                }
                function _on(el, event, fn) {
                    el.addEventListener(event, fn, false);
                }
                function _off(el, event, fn) {
                    el.removeEventListener(event, fn, false);
                }
                function _toggleClass(el, name, state) {
                    if (el) {
                        if (el.classList) {
                            el.classList[state ? 'add' : 'remove'](name);
                        } else {
                            var className = (' ' + el.className + ' ').replace(RSPACE, ' ').replace(' ' + name + ' ', ' ');
                            el.className = (className + (state ? ' ' + name : '')).replace(RSPACE, ' ');
                        }
                    }
                }
                function _css(el, prop, val) {
                    var style = el && el.style;
                    if (style) {
                        if (val === void 0) {
                            if (document.defaultView && document.defaultView.getComputedStyle) {
                                val = document.defaultView.getComputedStyle(el, '');
                            } else if (el.currentStyle) {
                                val = el.currentStyle;
                            }
                            return prop === void 0 ? val : val[prop];
                        } else {
                            if (!(prop in style)) {
                                prop = '-webkit-' + prop;
                            }
                            style[prop] = val + (typeof val === 'string' ? '' : 'px');
                        }
                    }
                }
                function _find(ctx, tagName, iterator) {
                    if (ctx) {
                        var list = ctx.getElementsByTagName(tagName), i = 0, n = list.length;
                        if (iterator) {
                            for (; i < n; i++) {
                                iterator(list[i], i);
                            }
                        }
                        return list;
                    }
                    return [];
                }
                function _dispatchEvent(sortable, rootEl, name, targetEl, fromEl, startIndex, newIndex) {
                    var evt = document.createEvent('Event'), options = (sortable || rootEl[expando]).options, onName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);
                    evt.initEvent(name, true, true);
                    evt.to = rootEl;
                    evt.from = fromEl || rootEl;
                    evt.item = targetEl || rootEl;
                    evt.clone = cloneEl;
                    evt.oldIndex = startIndex;
                    evt.newIndex = newIndex;
                    rootEl.dispatchEvent(evt);
                    if (options[onName]) {
                        options[onName].call(sortable, evt);
                    }
                }
                function _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect) {
                    var evt, sortable = fromEl[expando], onMoveFn = sortable.options.onMove, retVal;
                    evt = document.createEvent('Event');
                    evt.initEvent('move', true, true);
                    evt.to = toEl;
                    evt.from = fromEl;
                    evt.dragged = dragEl;
                    evt.draggedRect = dragRect;
                    evt.related = targetEl || toEl;
                    evt.relatedRect = targetRect || toEl.getBoundingClientRect();
                    fromEl.dispatchEvent(evt);
                    if (onMoveFn) {
                        retVal = onMoveFn.call(sortable, evt);
                    }
                    return retVal;
                }
                function _disableDraggable(el) {
                    el.draggable = false;
                }
                function _unsilent() {
                    _silent = false;
                }
                function _ghostIsLast(el, evt) {
                    var lastEl = el.lastElementChild, rect = lastEl.getBoundingClientRect();
                    return (evt.clientY - (rect.top + rect.height) > 5 || evt.clientX - (rect.right + rect.width) > 5) && lastEl;
                }
                function _generateId(el) {
                    var str = el.tagName + el.className + el.src + el.href + el.textContent, i = str.length, sum = 0;
                    while (i--) {
                        sum += str.charCodeAt(i);
                    }
                    return sum.toString(36);
                }
                function _index(el) {
                    var index = 0;
                    if (!el || !el.parentNode) {
                        return -1;
                    }
                    while (el && (el = el.previousElementSibling)) {
                        if (el.nodeName.toUpperCase() !== 'TEMPLATE') {
                            index++;
                        }
                    }
                    return index;
                }
                function _throttle(callback, ms) {
                    var args, _this;
                    return function () {
                        if (args === void 0) {
                            args = arguments;
                            _this = this;
                            setTimeout(function () {
                                if (args.length === 1) {
                                    callback.call(_this, args[0]);
                                } else {
                                    callback.apply(_this, args);
                                }
                                args = void 0;
                            }, ms);
                        }
                    };
                }
                function _extend(dst, src) {
                    if (dst && src) {
                        for (var key in src) {
                            if (src.hasOwnProperty(key)) {
                                dst[key] = src[key];
                            }
                        }
                    }
                    return dst;
                }
                Sortable.utils = {
                    on: _on,
                    off: _off,
                    css: _css,
                    find: _find,
                    is: function (el, selector) {
                        return !!_closest(el, selector, el);
                    },
                    extend: _extend,
                    throttle: _throttle,
                    closest: _closest,
                    toggleClass: _toggleClass,
                    index: _index
                };
                Sortable.create = function (el, options) {
                    return new Sortable(el, options);
                };
                Sortable.version = '1.3.0';
                return Sortable;
            }));
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _GlobeViewExtended = __webpack_require__(8);
            var _GlobeViewExtended2 = _interopRequireDefault(_GlobeViewExtended);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _LayerUtils = __webpack_require__(5);
            var _LayerUtils2 = _interopRequireDefault(_LayerUtils);
            var _AttributionDOM = __webpack_require__(81);
            var _AttributionDOM2 = _interopRequireDefault(_AttributionDOM);
            var _Widget = __webpack_require__(11);
            var _Widget2 = _interopRequireDefault(_Widget);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function Attributions(aOptions) {
                aOptions = aOptions || {};
                var options = aOptions.options || {};
                if (!(this instanceof Attributions)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (options && (typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {
                    throw new Error('ERROR WRONG_TYPE : options should be an object');
                }
                this._initialize(options);
                var container = this._initContainer(options);
                var targetDiv = document.getElementById(options.target) || null;
                _Widget2.default.call(this, {
                    name: 'Attributions',
                    element: container,
                    target: targetDiv
                });
            }
            Attributions.prototype = Object.create(_Widget2.default.prototype, {});
            _Utils2.default.assign(Attributions.prototype, _AttributionDOM2.default);
            Attributions.prototype.constructor = Attributions;
            Attributions.prototype.setGlobe = function (globe) {
                if (globe) {
                    var self = this;
                    this._callbacks.onPreRenderCallBack = function (e) {
                        var allLayers = e.colorLayersId.concat(e.elevationLayersId);
                        self._inRangeUpdate(allLayers, e.extent);
                    };
                    globe.listen(_GlobeViewExtended2.default.EVENTS.PRE_RENDER, this._callbacks.onPreRenderCallBack);
                    globe.preRenderEventFetchViewExtent();
                    globe.preRenderEventFetchLayersDisplayed();
                } else {
                    this._globe.forget(_GlobeViewExtended2.default.EVENTS.PRE_RENDER, this._callbacks.onPreRenderCallBack);
                    while (this._element.hasChildNodes()) {
                        this._element.removeChild(this._element.lastChild);
                    }
                    this._element.parentNode.removeChild(this._element);
                }
                _Widget2.default.prototype.setGlobe.call(this, globe);
            };
            Attributions.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] Attributions:setCollapsed - missing collapsed parameter');
                    return;
                }
                var isCollapsed = this.getCollapsed();
                if (collapsed && isCollapsed || !collapsed && !isCollapsed) {
                    return;
                }
                document.getElementById(this._addUID('GPshowAttributionsList')).checked = !collapsed;
            };
            Attributions.prototype.getCollapsed = function () {
                return !document.getElementById(this._addUID('GPshowAttributionsList')).checked;
            };
            Attributions.prototype._initialize = function (options) {
                this._uid = _SelectorID2.default.generate();
                this._AttributionContainer = null;
                this._callbacks = {};
                this._options = options;
            };
            Attributions.prototype._initContainer = function (options) {
                var container = this._createMainContainerElement();
                var inputShow = this._createMainAttributionsShowElement();
                container.appendChild(inputShow);
                if (!options.collapsed) {
                    inputShow.checked = 'checked';
                }
                var divA = this._attributionListContainer = this._createMainAttributionsListContainer();
                var ulA = this._createAttributionsList();
                divA.appendChild(ulA);
                container.appendChild(divA);
                var picto = this._createMainPictoElement(options.collapsed);
                container.appendChild(picto);
                return container;
            };
            Attributions.prototype._inRangeUpdate = function (layersDisplayed, extent) {
                var globe = this.getGlobe();
                var scaleDenominator = 1 / globe.getScale();
                var attributions = new window.Map();
                for (var h = 0; h < layersDisplayed.length; h++) {
                    var layer = globe.getLayerById(layersDisplayed[h]);
                    if (!layer.visible) {
                        continue;
                    }
                    var ori = layer.options.originators;
                    if (ori) {
                        for (var j = 0; j < ori.length; j++) {
                            if (attributions.has(ori[j].name)) {
                                continue;
                            }
                            if (!ori[j].constraints) {
                                attributions.set(ori[j].name, ori[j]);
                                continue;
                            }
                            if (ori[j].constraints[0].minScaleDenominator) {
                                if (ori[j].constraints[0].minScaleDenominator === ori[j].constraints[0].maxScaleDenominator) {
                                    var attributionZoomLevel = _LayerUtils2.default.getZoomLevelFromScaleDenominator(ori[j].constraints[0].minScaleDenominator);
                                    var maxAttributionScaleDenominator = (this._resolutionsWGS84[attributionZoomLevel] + this._resolutionsWGS84[attributionZoomLevel - 1]) / (0.00028 * 2);
                                    var minAttributionScaleDenominator = (this._resolutionsWGS84[attributionZoomLevel] + this._resolutionsWGS84[attributionZoomLevel + 1]) / (0.00028 * 2);
                                    if (!(maxAttributionScaleDenominator > scaleDenominator && scaleDenominator > minAttributionScaleDenominator)) {
                                        continue;
                                    }
                                } else if (!(ori[j].constraints[0].minScaleDenominator < scaleDenominator && scaleDenominator < ori[j].constraints[0].maxScaleDenominator)) {
                                    continue;
                                }
                            }
                            if (ori[j].constraints[0].bbox) {
                                if (ori[j].constraints[0].bbox.left < extent.west() && ori[j].constraints[0].bbox.right > extent.east() && ori[j].constraints[0].bbox.top > extent.north() && ori[j].constraints[0].bbox.bottom < extent.south()) {
                                    attributions.set(ori[j].name, ori[j]);
                                }
                            } else if (!ori[j].constraints[0].bbox) {
                                attributions.set(ori[j].name, ori[j]);
                            }
                        }
                    }
                }
                this._updateAttributionListContainer(attributions);
            };
            Attributions.prototype._updateAttributionListContainer = function (attributions) {
                var element = document.getElementById(this._addUID('GPAttributionsList'));
                document.getElementById(this._addUID('GPAttributionsList')).parentNode.removeChild(element);
                var ul = this._createAttributionsList();
                attributions.forEach(function (a) {
                    var li = document.createElement('li');
                    var link = document.createElement('a');
                    link.href = a.url;
                    link.innerHTML = a.name + '&nbsp';
                    link.target = '_blank';
                    li.id = a.name.replace(/\s/g, '');
                    li.appendChild(link);
                    ul.appendChild(li);
                });
                this._attributionListContainer.appendChild(ul);
            };
            Attributions.prototype._resolutionsWGS84 = {
                0: 156543.033928041,
                1: 78271.51696402048,
                2: 39135.758482010235,
                3: 19567.87924100512,
                4: 9783.93962050256,
                5: 4891.96981025128,
                6: 2445.98490512564,
                7: 1222.99245256282,
                8: 611.49622628141,
                9: 305.7481131407048,
                10: 152.8740565703525,
                11: 76.43702828517624,
                12: 38.21851414258813,
                13: 19.10925707129406,
                14: 9.554628535647032,
                15: 4.777314267823516,
                16: 2.388657133911758,
                17: 1.194328566955879,
                18: 0.5971642834779395,
                19: 0.2985821417389697,
                20: 0.1492910708694849,
                21: 0.0746455354347424
            };
            exports.default = Attributions;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var AttributionDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPAttribution');
                    container.className = 'GPwidget';
                    return container;
                },
                _createMainAttributionsShowElement: function _createMainAttributionsShowElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowAttributionsList');
                    input.type = 'checkbox';
                    return input;
                },
                _createAttributionsList: function _createAttributionsList() {
                    var ul = document.createElement('ul');
                    ul.id = this._addUID('GPAttributionsList');
                    return ul;
                },
                _createMainAttributionsListContainer: function _createMainAttributionsListContainer() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPAttributionsListContainer');
                    return div;
                },
                _createMainPictoElement: function _createMainPictoElement(collapsed) {
                    var self = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowAttributionsListPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowAttributionsList');
                    label.title = 'Afficher/masquer les attributions';
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowAttributionsListOpenClose');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    spanOpen.innerHTML = collapsed ? 'i' : '\xBB';
                    spanOpen.addEventListener('click', function () {
                        spanOpen.innerHTML = document.getElementById(self._addUID('GPshowAttributionsList')).checked ? 'i' : '\xBB';
                    });
                    label.appendChild(spanOpen);
                    return label;
                }
            };
            exports.default = AttributionDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _GlobeViewExtended = __webpack_require__(8);
            var _GlobeViewExtended2 = _interopRequireDefault(_GlobeViewExtended);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _ScaleDOM = __webpack_require__(83);
            var _ScaleDOM2 = _interopRequireDefault(_ScaleDOM);
            var _Widget = __webpack_require__(11);
            var _Widget2 = _interopRequireDefault(_Widget);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function Scale(options) {
                options = options || {};
                if (!(this instanceof Scale)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (options && (typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {
                    throw new Error('ERROR WRONG_TYPE : options should be an object');
                }
                this._initialize();
                var container = this._initContainer();
                var vDiv = document.getElementById('viewerDiv');
                var targetDiv = document.getElementById(options.target) || vDiv;
                _Widget2.default.call(this, {
                    name: 'GraphicScale',
                    element: container,
                    target: targetDiv,
                    position: options.position
                });
            }
            Scale.prototype = Object.create(_Widget2.default.prototype, {});
            _Utils2.default.assign(Scale.prototype, _ScaleDOM2.default);
            Scale.prototype.constructor = Scale;
            Scale.prototype.setGlobe = function (globe) {
                if (globe) {
                    var self = this;
                    this._callbacks.onChangedViewCallback = function () {
                        var value = globe.pixelsToMeters(200);
                        value = Math.floor(value);
                        var digit = Math.pow(10, value.toString().length - 1);
                        value = Math.round(value / digit) * digit;
                        var pix = globe.metersToPixels(value);
                        var unit = 'm';
                        if (value >= 1000) {
                            value /= 1000;
                            unit = 'km';
                        }
                        self.getElement().innerHTML = value + ' ' + unit;
                        self.getElement().style.width = pix + 'px';
                    };
                    if (globe.isInitialized()) {
                        this._callbacks.onChangedViewCallback();
                    } else {
                        globe.listen(_GlobeViewExtended2.default.EVENTS.GLOBE_INITIALIZED, this._callbacks.onChangedViewCallback);
                    }
                    globe.listen(_GlobeViewExtended2.default.EVENTS.RANGE_CHANGED, this._callbacks.onChangedViewCallback);
                } else if (globe == null) {
                    this._globe.forget(_GlobeViewExtended2.default.EVENTS.GLOBE_INITIALIZED, this._callbacks.onChangedViewCallback);
                    this._globe.forget(_GlobeViewExtended2.default.EVENTS.RANGE_CHANGED, this._callbacks.onChangedViewCallback);
                    while (this.getElement().hasChildNodes()) {
                        this.getElement().removeChild(this.getElement().lastChild);
                    }
                    this.getElement().parentNode.removeChild(this.getElement());
                }
                _Widget2.default.prototype.setGlobe.call(this, globe);
            };
            Scale.prototype._initialize = function () {
                this._uid = _SelectorID2.default.generate();
                this._ScaleContainer = null;
                this._callbacks = {};
            };
            Scale.prototype._initContainer = function () {
                var container = this._createMainContainerElement();
                return container;
            };
            exports.default = Scale;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var ScaleDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPscaleContainer');
                    container.className = 'GPwidget';
                    return container;
                }
            };
            exports.default = ScaleDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _GlobeViewExtended = __webpack_require__(8);
            var _GlobeViewExtended2 = _interopRequireDefault(_GlobeViewExtended);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _MiniGlobeDOM = __webpack_require__(85);
            var _MiniGlobeDOM2 = _interopRequireDefault(_MiniGlobeDOM);
            var _Widget = __webpack_require__(11);
            var _Widget2 = _interopRequireDefault(_Widget);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function MiniGlobe(options) {
                options = options || {};
                if (!(this instanceof MiniGlobe)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (options && (typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {
                    throw new Error('ERROR WRONG_TYPE : options should be an object');
                }
                this._initialize();
                var container = this._initContainer();
                var vDiv = document.getElementById('viewerDiv');
                this._options = options;
                var targetDiv = document.getElementById(options.target) || vDiv;
                _Widget2.default.call(this, {
                    name: 'Overview',
                    element: container,
                    target: targetDiv,
                    position: options.position
                });
            }
            MiniGlobe.prototype = Object.create(_Widget2.default.prototype, {});
            _Utils2.default.assign(MiniGlobe.prototype, _MiniGlobeDOM2.default);
            MiniGlobe.prototype.constructor = MiniGlobe;
            MiniGlobe.prototype.setGlobe = function (globe) {
                if (globe) {
                    var minDistance = 6650000;
                    var maxDistance = 30000000;
                    var positionOnGlobe = globe.getCenter();
                    var miniView = new _GlobeViewExtended2.default(this._element, positionOnGlobe, {
                        maxSubdivisionLevel: 6,
                        noControls: true,
                        position: 'absolute'
                    });
                    miniView.setBackground();
                    var updateMiniGlobeHandler = function updateMiniGlobeHandler() {
                        var range = globe.getRange();
                        var distance = Math.min(Math.max(range * 1.5, minDistance), maxDistance);
                        miniView.setCameraPosition(globe.moveTarget(), distance);
                        miniView.lookAt(globe.moveTarget());
                        miniView.notifyChange();
                    };
                    globe.listen(_GlobeViewExtended2.default.EVENTS.AFTER_RENDER, updateMiniGlobeHandler);
                    if (globe.isInitialized()) {
                        updateMiniGlobeHandler;
                    } else {
                        globe.listen(_GlobeViewExtended2.default.EVENTS.GLOBE_INITIALIZED, updateMiniGlobeHandler);
                    }
                    var miniGlobeLayer = this._options.layer || this._baseLayer;
                    miniView.addLayer(miniGlobeLayer);
                    this._globeObj = miniView;
                } else if (globe == null) {
                    while (this.getElement().hasChildNodes()) {
                        this.getElement().removeChild(this.getElement().lastChild);
                    }
                    this.getElement().parentNode.removeChild(this.getElement());
                }
                _Widget2.default.prototype.setGlobe.call(this, globe);
            };
            MiniGlobe.prototype._initialize = function () {
                this._uid = _SelectorID2.default.generate();
                this._MiniGlobeContainer = null;
                this._callbacks = {};
            };
            MiniGlobe.prototype._initContainer = function () {
                var container = this._createMainContainerElement();
                return container;
            };
            MiniGlobe.prototype._baseLayer = {
                type: 'color',
                protocol: 'wmts',
                id: 'Maps',
                url: 'https://wxs.ign.fr/an7nvfzojv5wa96dsga5nk8w/geoportail/wmts',
                updateStrategy: {
                    type: '0',
                    options: {}
                },
                networkOptions: { crossOrigin: 'omit' },
                options: {
                    name: 'GEOGRAPHICALGRIDSYSTEMS.MAPS',
                    mimetype: 'image/jpeg',
                    tileMatrixSet: 'PM',
                    tileMatrixSetLimits: {
                        0: {
                            minTileRow: '0',
                            maxTileRow: '0',
                            minTileCol: '0',
                            maxTileCol: '1'
                        },
                        1: {
                            minTileRow: '0',
                            maxTileRow: '1',
                            minTileCol: '0',
                            maxTileCol: '2'
                        },
                        2: {
                            minTileRow: '0',
                            maxTileRow: '2',
                            minTileCol: '0',
                            maxTileCol: '4'
                        },
                        3: {
                            minTileRow: '0',
                            maxTileRow: '5',
                            minTileCol: '0',
                            maxTileCol: '8'
                        },
                        4: {
                            minTileRow: '1',
                            maxTileRow: '11',
                            minTileCol: '0',
                            maxTileCol: '16'
                        },
                        5: {
                            minTileRow: '3',
                            maxTileRow: '22',
                            minTileCol: '0',
                            maxTileCol: '32'
                        },
                        6: {
                            minTileRow: '7',
                            maxTileRow: '45',
                            minTileCol: '0',
                            maxTileCol: '64'
                        },
                        7: {
                            minTileRow: '42',
                            maxTileRow: '97',
                            minTileCol: '0',
                            maxTileCol: '115'
                        },
                        8: {
                            minTileRow: '84',
                            maxTileRow: '195',
                            minTileCol: '1',
                            maxTileCol: '247'
                        },
                        9: {
                            minTileRow: '170',
                            maxTileRow: '390',
                            minTileCol: '2',
                            maxTileCol: '495'
                        },
                        10: {
                            minTileRow: '340',
                            maxTileRow: '780',
                            minTileCol: '5',
                            maxTileCol: '990'
                        },
                        11: {
                            minTileRow: '681',
                            maxTileRow: '1544',
                            minTileCol: '10',
                            maxTileCol: '1981'
                        },
                        12: {
                            minTileRow: '1363',
                            maxTileRow: '3088',
                            minTileCol: '20',
                            maxTileCol: '3962'
                        },
                        13: {
                            minTileRow: '2726',
                            maxTileRow: '6177',
                            minTileCol: '40',
                            maxTileCol: '7924'
                        },
                        14: {
                            minTileRow: '5452',
                            maxTileRow: '12355',
                            minTileCol: '81',
                            maxTileCol: '15847'
                        },
                        15: {
                            minTileRow: '10944',
                            maxTileRow: '21176',
                            minTileCol: '163',
                            maxTileCol: '31695'
                        },
                        16: {
                            minTileRow: '21889',
                            maxTileRow: '42353',
                            minTileCol: '326',
                            maxTileCol: '63382'
                        },
                        17: {
                            minTileRow: '43776',
                            maxTileRow: '73526',
                            minTileCol: '42528',
                            maxTileCol: '85869'
                        },
                        18: {
                            minTileRow: '87557',
                            maxTileRow: '147052',
                            minTileCol: '85058',
                            maxTileCol: '171738'
                        }
                    }
                }
            };
            exports.default = MiniGlobe;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var MiniGlobeDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPminiglobeContainer');
                    container.className = 'GPwidget';
                    return container;
                }
            };
            exports.default = MiniGlobeDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _LayerUtils = __webpack_require__(5);
            var _LayerUtils2 = _interopRequireDefault(_LayerUtils);
            var _Register = __webpack_require__(37);
            var _Register2 = _interopRequireDefault(_Register);
            var _ProxyUtils = __webpack_require__(16);
            var _ProxyUtils2 = _interopRequireDefault(_ProxyUtils);
            var _GfiUtils = __webpack_require__(17);
            var _GfiUtils2 = _interopRequireDefault(_GfiUtils);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _KML = __webpack_require__(18);
            var _KML2 = _interopRequireDefault(_KML);
            var _WMTS = __webpack_require__(38);
            var _WMTS2 = _interopRequireDefault(_WMTS);
            var _CRS = __webpack_require__(39);
            var _CRS2 = _interopRequireDefault(_CRS);
            var _SourceWMTS = __webpack_require__(40);
            var _SourceWMTS2 = _interopRequireDefault(_SourceWMTS);
            var _SourceWMS = __webpack_require__(41);
            var _SourceWMS2 = _interopRequireDefault(_SourceWMS);
            var _LayerWMTS = __webpack_require__(87);
            var _LayerWMTS2 = _interopRequireDefault(_LayerWMTS);
            var _LayerWMS = __webpack_require__(88);
            var _LayerWMS2 = _interopRequireDefault(_LayerWMS);
            var _LayerSwitcher = __webpack_require__(12);
            var _LayerSwitcher2 = _interopRequireDefault(_LayerSwitcher);
            var _GetFeatureInfo = __webpack_require__(89);
            var _GetFeatureInfo2 = _interopRequireDefault(_GetFeatureInfo);
            var _SearchEngine = __webpack_require__(91);
            var _SearchEngine2 = _interopRequireDefault(_SearchEngine);
            var _MousePosition = __webpack_require__(94);
            var _MousePosition2 = _interopRequireDefault(_MousePosition);
            var _Drawing = __webpack_require__(96);
            var _Drawing2 = _interopRequireDefault(_Drawing);
            var _Route = __webpack_require__(98);
            var _Route2 = _interopRequireDefault(_Route);
            var _Isocurve = __webpack_require__(101);
            var _Isocurve2 = _interopRequireDefault(_Isocurve);
            var _ReverseGeocode = __webpack_require__(103);
            var _ReverseGeocode2 = _interopRequireDefault(_ReverseGeocode);
            var _LayerImport = __webpack_require__(105);
            var _LayerImport2 = _interopRequireDefault(_LayerImport);
            var _GeoportalAttribution = __webpack_require__(107);
            var _GeoportalAttribution2 = _interopRequireDefault(_GeoportalAttribution);
            var _Markers = __webpack_require__(7);
            var _Markers2 = _interopRequireDefault(_Markers);
            var _ElevationPath = __webpack_require__(108);
            var _ElevationPath2 = _interopRequireDefault(_ElevationPath);
            var _MeasureLength = __webpack_require__(112);
            var _MeasureLength2 = _interopRequireDefault(_MeasureLength);
            var _MeasureArea = __webpack_require__(114);
            var _MeasureArea2 = _interopRequireDefault(_MeasureArea);
            var _MeasureAzimuth = __webpack_require__(116);
            var _MeasureAzimuth2 = _interopRequireDefault(_MeasureAzimuth);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            _gp2.default.olExtVersion = '2.0.0';
            _gp2.default.olExtDate = '2018-05-04';
            _gp2.default.olUtils = _Utils2.default;
            _gp2.default.LayerUtils = _LayerUtils2.default;
            _gp2.default.ProxyUtils = _ProxyUtils2.default;
            _ol2.default.gp = {};
            _ol2.default.gp.GfiUtils = _GfiUtils2.default;
            _ol2.default.format.KMLExtended = _KML2.default;
            _ol2.default.source.WMTSExtended = _WMTS2.default;
            _CRS2.default.overload();
            _ol2.default.source.GeoportalWMTS = _SourceWMTS2.default;
            _ol2.default.source.GeoportalWMS = _SourceWMS2.default;
            _ol2.default.layer.GeoportalWMTS = _LayerWMTS2.default;
            _ol2.default.layer.GeoportalWMS = _LayerWMS2.default;
            _ol2.default.control.GeoportalAttribution = _GeoportalAttribution2.default;
            _ol2.default.control.LayerSwitcher = _LayerSwitcher2.default;
            _ol2.default.control.GetFeatureInfo = _GetFeatureInfo2.default;
            _ol2.default.control.SearchEngine = _SearchEngine2.default;
            _ol2.default.control.Route = _Route2.default;
            _ol2.default.control.Isocurve = _Isocurve2.default;
            _ol2.default.control.GeoportalMousePosition = _MousePosition2.default;
            _ol2.default.control.Drawing = _Drawing2.default;
            _ol2.default.control.ReverseGeocode = _ReverseGeocode2.default;
            _ol2.default.control.LayerImport = _LayerImport2.default;
            _ol2.default.control.MeasureLength = _MeasureLength2.default;
            _ol2.default.control.MeasureArea = _MeasureArea2.default;
            _ol2.default.control.MeasureAzimuth = _MeasureAzimuth2.default;
            _ol2.default.control.DefaultMarkers = _Markers2.default;
            _ol2.default.control.ElevationPath = _ElevationPath2.default;
            exports.default = _gp2.default;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _Config = __webpack_require__(10);
            var _Config2 = _interopRequireDefault(_Config);
            var _LayerUtils = __webpack_require__(5);
            var _LayerUtils2 = _interopRequireDefault(_LayerUtils);
            var _SourceWMTS = __webpack_require__(40);
            var _SourceWMTS2 = _interopRequireDefault(_SourceWMTS);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function LayerWMTS(options) {
                if (!(this instanceof LayerWMTS)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (!options.layer) {
                    throw new Error('ERROR PARAM_MISSING : layer');
                }
                if (typeof options.layer !== 'string') {
                    throw new Error('ERROR WRONG TYPE : layer');
                }
                if (typeof options.ssl === 'undefined') {
                    options.ssl = false;
                }
                if (!_Config2.default.isConfigLoaded()) {
                    throw new Error('ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html');
                }
                var olSourceParams;
                if (options.olParams && options.olParams.sourceParams) {
                    olSourceParams = options.olParams.sourceParams;
                }
                var wmtsSource = new _SourceWMTS2.default({
                    layer: options.layer,
                    ssl: options.ssl,
                    apiKey: options.apiKey,
                    olParams: olSourceParams
                });
                var layerTileOptions = { source: wmtsSource };
                if (wmtsSource.getLayer() !== undefined) {
                    var layerId = _Config2.default.getLayerId(options.layer, 'WMTS');
                    var globalConstraints = _Config2.default.getGlobalConstraints(layerId);
                    if (globalConstraints && globalConstraints.projection) {
                        var p;
                        if (typeof globalConstraints.projection === 'string') {
                            p = _ol2.default.proj.get(globalConstraints.projection);
                        }
                        if (p && p.getUnits()) {
                            if (p.getUnits() === 'm') {
                                layerTileOptions.minResolution = (globalConstraints.minScale - 1) * 0.00028;
                                layerTileOptions.maxResolution = (globalConstraints.maxScale + 1) * 0.00028;
                            } else if (p.getUnits() === 'degrees') {
                                layerTileOptions.minResolution = (globalConstraints.minScale - 1) * 0.00028 * 180 / (Math.PI * 6378137);
                                layerTileOptions.maxResolution = (globalConstraints.maxScale + 1) * 0.00028 * 180 / (Math.PI * 6378137);
                            }
                        }
                    }
                }
                _Utils2.default.mergeParams(layerTileOptions, options.olParams);
                _ol2.default.layer.Tile.call(this, layerTileOptions);
            }
            _ol2.default.inherits(LayerWMTS, _ol2.default.layer.Tile);
            LayerWMTS.prototype = Object.create(_ol2.default.layer.Tile.prototype, {});
            LayerWMTS.prototype.constructor = LayerWMTS;
            exports.default = LayerWMTS;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _Config = __webpack_require__(10);
            var _Config2 = _interopRequireDefault(_Config);
            var _LayerUtils = __webpack_require__(5);
            var _LayerUtils2 = _interopRequireDefault(_LayerUtils);
            var _SourceWMS = __webpack_require__(41);
            var _SourceWMS2 = _interopRequireDefault(_SourceWMS);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function LayerWMS(options) {
                if (!(this instanceof LayerWMS)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (!options.layer) {
                    throw new Error('ERROR PARAM_MISSING : layer');
                }
                if (typeof options.layer !== 'string') {
                    throw new Error('ERROR WRONG TYPE : layer');
                }
                if (typeof options.ssl === 'undefined') {
                    options.ssl = false;
                }
                if (!_Config2.default.isConfigLoaded()) {
                    throw new Error('ERROR : contract key configuration has to be loaded to load Geoportal layers. See http://ignf.github.io/evolution-apigeoportail/ol3/ol3-autoconf.html');
                }
                var olSourceParams;
                if (options.olParams && options.olParams.sourceParams) {
                    olSourceParams = options.olParams.sourceParams;
                }
                var wmsSource = new _SourceWMS2.default({
                    layer: options.layer,
                    ssl: options.ssl,
                    apiKey: options.apiKey,
                    olParams: olSourceParams
                });
                var layerTileOptions = { source: wmsSource };
                if (wmsSource.getParams().LAYERS !== undefined) {
                    var layerId = _Config2.default.getLayerId(options.layer, 'WMS');
                    var globalConstraints = _Config2.default.getGlobalConstraints(layerId);
                    if (olSourceParams && olSourceParams.projection) {
                        var geobbox = [
                            globalConstraints.extent.left,
                            globalConstraints.extent.bottom,
                            globalConstraints.extent.right,
                            globalConstraints.extent.top
                        ];
                        layerTileOptions.extent = _ol2.default.proj.transformExtent(geobbox, 'EPSG:4326', olSourceParams.projection);
                        var p;
                        if (typeof olSourceParams.projection === 'string') {
                            p = _ol2.default.proj.get(olSourceParams.projection);
                        } else if (_typeof(olSourceParams.projection) === 'object' && olSourceParams.projection.getCode()) {
                            p = _ol2.default.proj.get(olSourceParams.projection.getCode());
                        }
                        if (p && p.getUnits()) {
                            if (p.getUnits() === 'm') {
                                layerTileOptions.minResolution = (globalConstraints.minScale - 1) * 0.00028;
                                layerTileOptions.maxResolution = (globalConstraints.maxScale + 1) * 0.00028;
                            } else if (p.getUnits() === 'degrees') {
                                layerTileOptions.minResolution = (globalConstraints.minScale - 1) * 0.00028 * 180 / (Math.PI * 6378137);
                                layerTileOptions.maxResolution = (globalConstraints.maxScale + 1) * 0.00028 * 180 / (Math.PI * 6378137);
                            }
                        }
                    }
                }
                _Utils2.default.mergeParams(layerTileOptions, options.olParams);
                _ol2.default.layer.Tile.call(this, layerTileOptions);
            }
            _ol2.default.inherits(LayerWMS, _ol2.default.layer.Tile);
            LayerWMS.prototype = Object.create(_ol2.default.layer.Tile.prototype, {});
            LayerWMS.prototype.constructor = LayerWMS;
            exports.default = LayerWMS;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _proj = __webpack_require__(9);
            var _proj2 = _interopRequireDefault(_proj);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _GfiUtils = __webpack_require__(17);
            var _GfiUtils2 = _interopRequireDefault(_GfiUtils);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _GetFeatureInfoDOM = __webpack_require__(90);
            var _GetFeatureInfoDOM2 = _interopRequireDefault(_GetFeatureInfoDOM);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function GetFeatureInfo(gfiOptions) {
                gfiOptions = gfiOptions || {};
                var options = gfiOptions.options || {};
                var layers = gfiOptions.layers || [];
                if (!(this instanceof GetFeatureInfo)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                if (layers && !Array.isArray(layers)) {
                    throw new Error('ERROR WRONG_TYPE : layers should be an array');
                }
                if (options && (typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {
                    throw new Error('ERROR WRONG_TYPE : options should be an object');
                }
                this._initialize(options, layers);
                var container = this._initContainer(options);
                _ol2.default.control.Control.call(this, {
                    element: container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(GetFeatureInfo, _ol2.default.control.Control);
            GetFeatureInfo.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(GetFeatureInfo.prototype, _GetFeatureInfoDOM2.default);
            GetFeatureInfo.prototype.constructor = GetFeatureInfo;
            GetFeatureInfo.prototype._initialize = function (options, layers) {
                this._uid = _SelectorID2.default.generate();
                this._events = {
                    dblclick: false,
                    singleclick: false,
                    contextmenu: false
                };
                this._eventsHandler = {};
                if (typeof options.auto !== 'undefined' && typeof options.auto !== 'boolean') {
                    console.log('[ERROR] GetFeatureInfo:_initialize - auto parameter should be a boolean');
                    return;
                }
                this._auto = options.auto || false;
                if (typeof options.active !== 'undefined' && typeof options.active !== 'boolean') {
                    console.log('[ERROR] GetFeatureInfo:_initialize - active parameter should be a boolean');
                    return;
                }
                this._active = typeof options.active === 'undefined' ? true : options.active;
                if (options.defaultEvent && typeof options.defaultEvent !== 'string') {
                    console.log('[ERROR] GetFeatureInfo:_initialize - defaultEvent parameter should be a string');
                    return;
                }
                this._defaultEvent = options.defaultEvent || 'singleclick';
                if (!this._isValidEvent(this._defaultEvent)) {
                    console.log('[ERROR] GetFeatureInfo:_initialize - _defaultEvent \'' + this._defaultEvent + '\' is not a valid event');
                    return;
                }
                if (options.defaultInfoFormat && typeof options.defaultInfoFormat !== 'string') {
                    console.log('[ERROR] GetFeatureInfo:_initialize - defaultInfoFormat parameter should be a string');
                    return;
                }
                this._defaultInfoFormat = options.defaultInfoFormat || 'text/html';
                if (options.cursorStyle && typeof options.cursorStyle !== 'string') {
                    console.log('[ERROR] GetFeatureInfo:_initialize - cursorStyle parameter should be a string');
                    return;
                }
                this._cursorStyle = options.cursorStyle || 'pointer';
                if (options.proxyUrl) {
                    if (typeof options.proxyUrl !== 'string') {
                        console.log('[ERROR] GetFeatureInfo:_initialize - proxyUrl parameter should be a string');
                        return;
                    }
                    this._proxyUrl = options.proxyUrl;
                }
                if (options.noProxyDomains) {
                    if (!Array.isArray(options.noProxyDomains)) {
                        console.log('[ERROR] GetFeatureInfo:_initialize - noProxyDomains parameter should be a array');
                        return;
                    }
                    this._noProxyDomains = options.noProxyDomains;
                }
                if (typeof options.autoPan !== 'undefined' && typeof options.autoPan !== 'boolean') {
                    console.log('[ERROR] GetFeatureInfo:_initialize - autoPan parameter should be a boolean');
                    return;
                }
                this._autoPan = typeof options.autoPan === 'undefined' ? true : options.autoPan;
                if (options.autoPanAnimation) {
                    if (options.autoPanAnimation.duration) {
                        if (typeof options.autoPanAnimation.duration !== 'number') {
                            console.log('[ERROR] GetFeatureInfo:_initialize - autoPanAnimation parameter is invalid : duration should be a number.');
                            return;
                        }
                    }
                    if (options.autoPanAnimation.easing) {
                        if (typeof options.autoPanAnimation.easing !== 'function') {
                            console.log('[ERROR] GetFeatureInfo:_initialize - autoPanAnimation parameter is invalid : easing should be a ol.easing function or a custom function.');
                            return;
                        }
                    }
                    this._autoPanAnimation = options.autoPanAnimation;
                }
                if (options.autoPanMargin) {
                    if (typeof options.autoPanMargin !== 'number') {
                        console.log('[ERROR] GetFeatureInfo:_initialize - autoPanMargin parameter should be a number');
                        return;
                    }
                    this._autoPanMargin = options.autoPanMargin;
                }
                if (!Array.isArray(layers)) {
                    console.log('[ERROR] GetFeatureInfo:_initialize - layers parameter should be an array');
                    return;
                }
                this._setLayers(layers);
                this._activateGetFeatureInfoContainer = null;
            };
            GetFeatureInfo.prototype.setMap = function (map) {
                if (map) {
                    this._updateEvents(map);
                    if (this._cursorStyle && this._active) {
                        this._activateCursor(true, map);
                    }
                    map.getLayers().on('remove', function (evt) {
                        for (var i = 0; i < this._layers.length; ++i) {
                            if (this._layers[i].obj === evt.element) {
                                this._layers.splice(i, 1);
                                break;
                            }
                        }
                        this._updateEvents(map);
                    }, this);
                    if (this._auto) {
                        var updated = false;
                        map.getLayers().forEach(function (olLayer) {
                            var layerFormat = _GfiUtils2.default.getLayerFormat(olLayer);
                            if (!this._hasLayer(olLayer) && layerFormat == 'vector') {
                                this._layers.push({ obj: olLayer });
                                updated = true;
                            }
                        }, this);
                        if (updated) {
                            this._updateEvents(map);
                        }
                        map.getLayers().on('add', function (evt) {
                            var layerFormat = _GfiUtils2.default.getLayerFormat(evt.element);
                            if (layerFormat == 'vector') {
                                this._layers.push({ obj: evt.element });
                            }
                            this._updateEvents(map);
                        }, this);
                    }
                } else {
                    this._clearEvents();
                    this._activateCursor(false);
                }
                _ol2.default.control.Control.prototype.setMap.call(this, map);
            };
            GetFeatureInfo.prototype.getLayers = function () {
                return this._layers;
            };
            GetFeatureInfo.prototype.setDefaultEvent = function (eventName) {
                if (typeof eventName !== 'string') {
                    console.log('[ERROR] GetFeatureInfo:setDefaultEvent - eventName parameter should be a string');
                    return;
                }
                if (!eventName || !this._isValidEvent(eventName)) {
                    console.log('[ERROR] GetFeatureInfo:setDefaultEvent - event \'' + eventName + '\' is not allowed.');
                    return;
                }
                this._defaultEvent = eventName;
                this._updateEvents();
            };
            GetFeatureInfo.prototype.setCursorStyle = function (cursorStyle) {
                if (typeof cursorStyle !== 'string') {
                    console.log('[ERROR] GetFeatureInfo:setCursorStyle - cursorStyle parameter should be a string');
                    return;
                }
                if (this._active) {
                    if (!this._cursorStyle && cursorStyle) {
                        this._activateCursor(true);
                    } else if (this._cursorStyle && !cursorStyle) {
                        this._activateCursor(false);
                    }
                }
                this._cursorStyle = cursorStyle;
            };
            GetFeatureInfo.prototype.setActive = function (active) {
                this._setActive(active);
                var element = document.getElementById(this._addUID('GPactivateGetFeatureInfo'));
                if (element) {
                    element.checked = active;
                }
            };
            GetFeatureInfo.prototype._setActive = function (active) {
                if (typeof active !== 'boolean') {
                    console.log('[ERROR] GetFeatureInfo:_setActive - active parameter should be a boolean');
                    return;
                }
                if (this._active === active) {
                    return;
                }
                this._active = active;
                if (this._cursorStyle) {
                    this._activateCursor(active);
                }
            };
            GetFeatureInfo.prototype.isActive = function () {
                return this._active;
            };
            GetFeatureInfo.prototype.setHidden = function (hidden) {
                this.element.style.visibility = hidden ? 'hidden' : '';
            };
            GetFeatureInfo.prototype.isHidden = function () {
                return this.element.style.visibility == 'hidden';
            };
            GetFeatureInfo.prototype.setLayers = function (gfiLayers) {
                this._setLayers(gfiLayers);
                this._updateEvents();
            };
            GetFeatureInfo.prototype._isValidEvent = function (eventName) {
                return Object.keys(this._events).indexOf(eventName) > -1;
            };
            GetFeatureInfo.prototype._activateEvent = function (eventName, map) {
                var gfiObj = this;
                var getFeatureInfoHandler = function getFeatureInfoHandler(e) {
                    _GfiUtils2.default.onDisplayFeatureInfo(e, gfiObj);
                };
                if (eventName == 'contextmenu') {
                    map.getViewport().addEventListener(eventName, getFeatureInfoHandler);
                } else {
                    map.on(eventName, getFeatureInfoHandler);
                }
                this._eventsHandler[eventName] = getFeatureInfoHandler;
                this._events[eventName] = true;
            };
            GetFeatureInfo.prototype._deactivateEvent = function (eventName, map) {
                if (eventName == 'contextmenu') {
                    map.getViewport().removeEventListener(eventName, this._eventsHandler[eventName]);
                } else {
                    map.un(eventName, this._eventsHandler[eventName]);
                }
                delete this._eventsHandler[eventName];
                this._events[eventName] = false;
            };
            GetFeatureInfo.prototype._updateEvents = function (map) {
                if (!map) {
                    map = this.getMap();
                }
                var sEvent = [];
                for (var i = 0; i < this._layers.length; ++i) {
                    var event = this._layers[i].event ? this._layers[i].event : this._defaultEvent;
                    if (sEvent.indexOf(event) < 0) {
                        sEvent.push(event);
                    }
                }
                for (var eventName in this._events) {
                    if (!this._events[eventName] && sEvent.indexOf(eventName) >= 0) {
                        this._activateEvent(eventName, map);
                    } else if (this._events[eventName] && sEvent.indexOf(eventName) < 0) {
                        this._deactivateEvent(eventName, map);
                    }
                }
            };
            GetFeatureInfo.prototype._clearEvents = function () {
                var map = this.getMap();
                for (var eventName in this._events) {
                    if (this._events[eventName]) {
                        this._deactivateEvent(eventName, map);
                    }
                }
            };
            GetFeatureInfo.prototype._hasLayer = function (olLayer) {
                for (var i = 0; i < this._layers.length; ++i) {
                    if (this._layers[i].obj === olLayer) {
                        return true;
                    }
                }
                return false;
            };
            GetFeatureInfo.prototype._activateCursor = function (activate, map) {
                if (!map) {
                    map = this.getMap();
                }
                if (activate) {
                    if (this._eventsHandler.hasOwnProperty('pointermove')) {
                        console.log('[ERROR] _activateCursor - inconsistent state: pointermove event handler already registered');
                        return;
                    }
                    var gfiObj = this;
                    var displayCursor = function displayCursor(evt) {
                        var hit = map.forEachFeatureAtPixel(evt.pixel, function (feature, layer) {
                            var gfiLayers = gfiObj.getLayers();
                            for (var m = 0; m < gfiLayers.length; ++m) {
                                if (gfiLayers[m].obj === layer) {
                                    return true;
                                }
                            }
                        });
                        if (hit) {
                            map.getTargetElement().style.cursor = gfiObj._cursorStyle;
                        } else {
                            map.getTargetElement().style.cursor = '';
                        }
                    };
                    this._eventsHandler['pointermove'] = displayCursor;
                    map.on('pointermove', displayCursor);
                } else {
                    map.un('pointermove', this._eventsHandler['pointermove']);
                    delete this._eventsHandler['pointermove'];
                    map.getTargetElement().style.cursor = '';
                }
            };
            GetFeatureInfo.prototype._setLayers = function (gfiLayers) {
                if (!gfiLayers || !Array.isArray(gfiLayers)) {
                    console.log('[ERROR] GetFeatureInfo:setLayers - gfiLayers parameter should be a array');
                    return;
                }
                this._layers = [];
                for (var i = 0; i < gfiLayers.length; ++i) {
                    var ind = this._layers.push({}) - 1;
                    if (gfiLayers[i].event) {
                        if (!this._isValidEvent(gfiLayers[i].event)) {
                            console.log('[ERROR] GetFeatureInfo:setLayers - layer event \'' + this._layers[i].event + '\' is not allowed.');
                        } else {
                            this._layers[ind].event = gfiLayers[i].event;
                        }
                    }
                    if (gfiLayers[i].infoFormat) {
                        this._layers[ind].infoFormat = gfiLayers[i].infoFormat;
                    }
                    this._layers[ind].obj = gfiLayers[i].obj;
                }
            };
            GetFeatureInfo.prototype.onActivateGetFeatureInfoElementChange = function (e) {
                this._setActive(e.target.checked);
            };
            GetFeatureInfo.prototype._initContainer = function (options) {
                var container = this._createMainContainerElement();
                var inputActivate = this._activateGetFeatureInfoContainer = this._createActivateGetFeatureInfoElement(this.isActive());
                container.appendChild(inputActivate);
                var picto = this._createMainPictoElement();
                container.appendChild(picto);
                if (typeof options.hidden !== 'undefined') {
                    if (typeof options.hidden !== 'boolean') {
                        console.log('[ERROR] GetFeatureInfo:_initContainer - hidden parameter should be a boolean');
                        return;
                    }
                    if (options.hidden) {
                        container.style.visibility = 'hidden';
                    }
                }
                return container;
            };
            exports.default = GetFeatureInfo;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var GetFeatureInfoDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPgetFeatureInfo');
                    container.className = 'GPwidget';
                    return container;
                },
                _createActivateGetFeatureInfoElement: function _createActivateGetFeatureInfoElement(activate) {
                    var context = this;
                    var input = document.createElement('input');
                    input.id = this._addUID('GPactivateGetFeatureInfo');
                    input.type = 'checkbox';
                    input.checked = activate;
                    input.addEventListener('change', function (e) {
                        context.onActivateGetFeatureInfoElementChange(e);
                    });
                    return input;
                },
                _createMainPictoElement: function _createMainPictoElement() {
                    var self = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPgetFeatureInfoPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPactivateGetFeatureInfo');
                    label.title = 'activer/desactiver l\'interrogation des couches';
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPgetFeatureInfoActivate');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    var spanClose = document.createElement('span');
                    spanClose.id = self._addUID('GPgetFeatureInfoDeactivate');
                    label.appendChild(spanClose);
                    return label;
                }
            };
            exports.default = GetFeatureInfoDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _Markers = __webpack_require__(7);
            var _Markers2 = _interopRequireDefault(_Markers);
            var _CheckRightManagement = __webpack_require__(6);
            var _CheckRightManagement2 = _interopRequireDefault(_CheckRightManagement);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _SearchEngineUtils = __webpack_require__(92);
            var _SearchEngineUtils2 = _interopRequireDefault(_SearchEngineUtils);
            var _SearchEngineDOM = __webpack_require__(93);
            var _SearchEngineDOM2 = _interopRequireDefault(_SearchEngineDOM);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('searchengine');
            function SearchEngine(options) {
                options = options || {};
                if (!(this instanceof SearchEngine)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this.initialize(options);
                this._container = this._initContainer();
                this._containerElement = null;
                if (options.element && options.element.appendChild) {
                    options.element.appendChild(this._container);
                    this._containerElement = options.element;
                }
                _ol2.default.control.Control.call(this, {
                    element: this._containerElement || this._container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(SearchEngine, _ol2.default.control.Control);
            SearchEngine.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(SearchEngine.prototype, _SearchEngineDOM2.default);
            SearchEngine.prototype.constructor = SearchEngine;
            SearchEngine.prototype.setMap = function (map) {
                if (!map) {
                    this._clearResults();
                }
                _ol2.default.control.Control.prototype.setMap.call(this, map);
            };
            SearchEngine.prototype.getCollapsed = function () {
                return this.collapsed;
            };
            SearchEngine.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] SearchEngine:setCollapsed - missing collapsed parameter');
                    return;
                }
                if (collapsed && this.collapsed || !collapsed && !this.collapsed) {
                    return;
                }
                if (collapsed) {
                    this._showSearchEngineInput.click();
                } else {
                    this._showSearchEngineInput.click();
                }
                this.collapsed = collapsed;
            };
            SearchEngine.prototype.initialize = function (options) {
                this._checkInputOptions(options);
                this.options = {
                    collapsed: true,
                    zoomTo: '',
                    resources: {
                        geocode: [],
                        autocomplete: []
                    },
                    displayAdvancedSearch: true,
                    advancedSearch: {},
                    geocodeOptions: {},
                    autocompleteOptions: {
                        serviceOptions: {},
                        triggerGeocode: false,
                        triggerDelay: 1000
                    },
                    displayMarker: true,
                    markerStyle: 'lightOrange',
                    placeholder: 'Rechercher un lieu, une adresse'
                };
                _Utils2.default.mergeParams(this.options, options);
                if (this.options.resources.geocode.length === 0) {
                    this.options.resources.geocode = [
                        'PositionOfInterest',
                        'StreetAddress'
                    ];
                }
                if (this.options.resources.autocomplete.length === 0) {
                    this.options.resources.autocomplete = [
                        'PositionOfInterest',
                        'StreetAddress'
                    ];
                }
                this.collapsed = this.options.collapsed;
                this._uid = _SelectorID2.default.generate();
                this._showSearchEngineInput = null;
                this._inputSearchContainer = null;
                this._autocompleteContainer = null;
                this._suggestedContainer = null;
                this._suggestedLocations = [];
                this._geocodedContainer = null;
                this._geocodedLocations = [];
                this._filterContainer = null;
                this._currentGeocodingCode = null;
                this._currentGeocodingLocation = null;
                this._advancedSearchFilters = {};
                this._initAdvancedSearchFilters();
                this._advancedSearchCodes = [];
                this._initAdvancedSearchCodes();
                this._marker = null;
                var _markerStyle = this.options.markerStyle;
                this._markerUrl = Object.keys(_Markers2.default).indexOf(_markerStyle) === -1 ? _Markers2.default['lightOrange'] : _Markers2.default[_markerStyle];
                this._displayMarker = this.options.displayMarker;
                this._popupContent = null;
                this._popupDiv = this._initPopupDiv();
                this._popupOverlay = null;
                this._servicesRightManagement = {};
                this._noRightManagement = false;
                this._checkRightsManagement();
                this._triggerHandler = null;
            };
            SearchEngine.prototype._checkInputOptions = function (options) {
                var i;
                if (options.resources) {
                    if (_typeof(options.resources) === 'object') {
                        var geocodeResources = options.resources.geocode;
                        if (geocodeResources) {
                            if (!Array.isArray(geocodeResources)) {
                                console.log('[SearchEngine] \'options.resources.geocode\' parameter should be an array');
                                geocodeResources = null;
                            }
                            var geocodeResourcesList = [
                                'StreetAddress',
                                'PositionOfInterest',
                                'CadastralParcel',
                                'Administratif'
                            ];
                            for (i = 0; i < geocodeResources.length; i++) {
                                if (geocodeResourcesList.indexOf(geocodeResources[i]) === -1) {
                                    console.log('[SearchEngine] options.resources.geocode : ' + geocodeResources[i] + ' is not a resource for geocode');
                                }
                            }
                        }
                        var autocompleteResources = options.resources.autocomplete;
                        if (autocompleteResources) {
                            if (!Array.isArray(autocompleteResources)) {
                                console.log('[SearchEngine] \'options.resources.autocomplete\' parameter should be an array');
                                autocompleteResources = null;
                            }
                            var autocompleteResourcesList = [
                                'StreetAddress',
                                'PositionOfInterest'
                            ];
                            for (i = 0; i < autocompleteResources.length; i++) {
                                if (autocompleteResourcesList.indexOf(autocompleteResources[i]) === -1) {
                                    console.log('[SearchEngine] options.resources.autocomplete : ' + autocompleteResources[i] + ' is not a resource for autocomplete');
                                }
                            }
                        }
                    } else {
                        console.log('[SearchEngine] \'resources\' parameter should be an object');
                        options.resources = null;
                    }
                }
            };
            SearchEngine.prototype._initAdvancedSearchCodes = function () {
                var geocodeResources = this.options.resources.geocode;
                for (var i = 0; i < geocodeResources.length; i++) {
                    switch (geocodeResources[i]) {
                    case 'PositionOfInterest':
                        this._advancedSearchCodes.push({
                            id: 'PositionOfInterest',
                            title: 'Lieux/toponymes'
                        });
                        break;
                    case 'StreetAddress':
                        this._advancedSearchCodes.push({
                            id: 'StreetAddress',
                            title: 'Adresses'
                        });
                        break;
                    case 'CadastralParcel':
                        this._advancedSearchCodes.push({
                            id: 'CadastralParcel',
                            title: 'Parcelles cadastrales'
                        });
                        break;
                    case 'Administratif':
                        this._advancedSearchCodes.push({
                            id: 'Administratif',
                            title: 'Administratif'
                        });
                        break;
                    default:
                        break;
                    }
                }
                if (this._advancedSearchCodes.length === 0) {
                    this._advancedSearchCodes = [
                        {
                            id: 'StreetAddress',
                            title: 'Adresses'
                        },
                        {
                            id: 'PositionOfInterest',
                            title: 'Lieux/toponymes'
                        }
                    ];
                }
                logger.log('advancedSearchCodes', this._advancedSearchCodes);
            };
            SearchEngine.prototype._initAdvancedSearchFilters = function () {
                this._advancedSearchFilters = _SearchEngineUtils2.default.advancedSearchFiltersByDefault;
                var advancedSearchFiltersCustom = this.options.advancedSearch;
                _Utils2.default.assign(this._advancedSearchFilters, advancedSearchFiltersCustom);
                logger.log('advancedSearchFilters', this._advancedSearchFilters);
            };
            SearchEngine.prototype._initPopupDiv = function () {
                var context = this;
                var element = document.createElement('div');
                element.className = 'gp-feature-info-div';
                var closer = document.createElement('input');
                closer.type = 'button';
                closer.className = 'gp-styling-button closer';
                closer.onclick = function () {
                    if (context._popupOverlay != null) {
                        context._popupOverlay.setPosition(undefined);
                    }
                    return false;
                };
                this._popupContent = document.createElement('div');
                this._popupContent.className = 'gp-features-content-div';
                this._popupContent.style['min-width'] = '200px';
                element.appendChild(this._popupContent);
                element.appendChild(closer);
                return element;
            };
            SearchEngine.prototype._initContainer = function () {
                var container = this._createMainContainerElement();
                var inputShow = this._showSearchEngineInput = this._createShowSearchEngineElement();
                container.appendChild(inputShow);
                if (!this.options.collapsed) {
                    inputShow.checked = true;
                }
                var picto = this._createShowSearchEnginePictoElement();
                container.appendChild(picto);
                var search = this._inputSearchContainer = this._createSearchInputElement(this.options.placeholder);
                var context = this;
                if (search.addEventListener) {
                    search.addEventListener('click', function () {
                        context.onAutoCompleteInputClick();
                    });
                } else if (search.attachEvent) {
                    search.attachEvent('onclick', function () {
                        context.onAutoCompleteInputClick();
                    });
                }
                container.appendChild(search);
                if (this.options.displayAdvancedSearch) {
                    var advancedShow = this._createShowAdvancedSearchElement();
                    container.appendChild(advancedShow);
                    var advancedPanel = this._createAdvancedSearchPanelElement();
                    var advancedHeader = this._createAdvancedSearchPanelHeaderElement();
                    var advancedForm = this._createAdvancedSearchPanelFormElement(this._advancedSearchCodes);
                    var advancedFormFilters = this._filterContainer = this._createAdvancedSearchFormFiltersElement();
                    this._setFilter(this._advancedSearchCodes[0].id);
                    var advancedFormInput = this._createAdvancedSearchFormInputElement();
                    advancedForm.appendChild(advancedFormFilters);
                    advancedForm.appendChild(advancedFormInput);
                    advancedPanel.appendChild(advancedHeader);
                    advancedPanel.appendChild(advancedForm);
                    container.appendChild(advancedPanel);
                }
                var autocomplete = this._autocompleteContainer = this._createAutoCompleteElement();
                var autocompleteList = this._suggestedContainer = this._createAutoCompleteListElement();
                autocomplete.appendChild(autocompleteList);
                container.appendChild(autocomplete);
                var geocode = this._createGeocodeResultsElement();
                var geocodeList = this._geocodedContainer = this._createGeocodeResultsListElement();
                geocode.appendChild(geocodeList);
                container.appendChild(geocode);
                return container;
            };
            SearchEngine.prototype._setFilter = function (code) {
                var container = this._filterContainer;
                var codeFound = false;
                for (var i = 0; i < this._advancedSearchCodes.length; i++) {
                    if (this._advancedSearchCodes[i].id === code) {
                        codeFound = true;
                        break;
                    }
                }
                if (!codeFound) {
                    while (container.firstChild) {
                        container.removeChild(container.firstChild);
                    }
                    return;
                }
                this._currentGeocodingCode = code;
                while (container.firstChild) {
                    container.removeChild(container.firstChild);
                }
                var lstAttributs = this._advancedSearchFilters[code];
                if (!lstAttributs || lstAttributs.length === 0) {
                    return;
                }
                var divTable = this._createAdvancedSearchFiltersTableElement(code, true);
                for (var j = 0; j < lstAttributs.length; j++) {
                    var divFilter = this._createAdvancedSearchFiltersAttributElement(lstAttributs[j]);
                    divTable.appendChild(divFilter);
                }
                container.appendChild(divTable);
                return container;
            };
            SearchEngine.prototype._checkRightsManagement = function () {
                var _resources = [];
                var _key;
                var _opts = null;
                _key = this.options.autocompleteOptions.apiKey;
                _opts = this.options.autocompleteOptions.filterOptions;
                _resources = _opts ? _opts.type : [];
                if (!_resources || _resources.length === 0) {
                    _resources = this.options.resources.autocomplete;
                }
                if (!_resources || _resources.length === 0) {
                    _resources = [
                        'StreetAddress',
                        'PositionOfInterest'
                    ];
                }
                var rightManagementAutoComplete = _CheckRightManagement2.default.check({
                    key: _key || this.options.apiKey,
                    resources: _resources,
                    services: ['AutoCompletion']
                });
                logger.log('rightManagementAutoComplete', rightManagementAutoComplete);
                _key = this.options.geocodeOptions.apiKey;
                _opts = this.options.geocodeOptions.filterOptions;
                _resources = _opts ? _opts.type : [];
                if (!_resources || _resources.length === 0) {
                    _resources = this.options.resources.geocode;
                }
                if (!_resources || _resources.length === 0) {
                    _resources = [
                        'StreetAddress',
                        'PositionOfInterest'
                    ];
                }
                var rightManagementGeocode = _CheckRightManagement2.default.check({
                    key: _key || this.options.apiKey,
                    resources: _resources,
                    services: ['Geocode']
                });
                logger.log('rightManagementGeocode', rightManagementGeocode);
                if (!rightManagementAutoComplete && !rightManagementGeocode) {
                    this._noRightManagement = true;
                    return;
                }
                if (!this.options.apiKey) {
                    if (rightManagementGeocode) {
                        this.options.apiKey = rightManagementGeocode.key;
                    } else {
                        this.options.apiKey = rightManagementAutoComplete.key;
                    }
                }
                if (rightManagementAutoComplete) {
                    this._servicesRightManagement['AutoCompletion'] = rightManagementAutoComplete['AutoCompletion'];
                }
                if (rightManagementGeocode) {
                    this._servicesRightManagement['Geocode'] = rightManagementGeocode['Geocode'];
                }
            };
            SearchEngine.prototype._requestAutoComplete = function (settings) {
                if (!settings || (typeof settings === 'undefined' ? 'undefined' : _typeof(settings)) === 'object' && Object.keys(settings).length === 0) {
                    return;
                }
                if (!settings.text) {
                    return;
                }
                logger.log(settings);
                var options = {};
                _Utils2.default.assign(options, this.options.autocompleteOptions.serviceOptions);
                _Utils2.default.assign(options, settings);
                var resources = this.options.resources.autocomplete;
                if (resources && Array.isArray(resources)) {
                    if (!options.filterOptions) {
                        options.filterOptions = {};
                    }
                    if (!options.filterOptions.type) {
                        options.filterOptions.type = resources;
                    }
                }
                options.apiKey = options.apiKey || this.options.apiKey;
                logger.log(options);
                _gp2.default.Services.autoComplete(options);
            };
            SearchEngine.prototype._fillAutoCompletedLocationListContainer = function (locations) {
                if (!locations || locations.length === 0) {
                    return;
                }
                var element = this._suggestedContainer;
                if (element.childElementCount) {
                    while (element.firstChild) {
                        element.removeChild(element.firstChild);
                    }
                }
                this._displaySuggestedLocation();
                for (var i = 0; i < locations.length; i++) {
                    this._createAutoCompletedLocationElement(locations[i], i);
                }
            };
            SearchEngine.prototype._requestGeocoding = function (settings) {
                if (!settings || (typeof settings === 'undefined' ? 'undefined' : _typeof(settings)) === 'object' && Object.keys(settings).length === 0) {
                    return;
                }
                if (!settings.location) {
                    return;
                }
                logger.log(settings);
                var options = {};
                options.returnFreeForm = true;
                _Utils2.default.assign(options, this.options.geocodeOptions);
                _Utils2.default.assign(options, settings);
                var resources = this.options.resources.geocode;
                if (resources && Array.isArray(resources)) {
                    if (!options.filterOptions) {
                        options.filterOptions = {};
                    }
                    if (!options.filterOptions.type) {
                        options.filterOptions.type = resources;
                    }
                }
                options.apiKey = options.apiKey || this.options.apiKey;
                logger.log(options);
                _gp2.default.Services.geocode(options);
            };
            SearchEngine.prototype._fillGeocodedLocationListContainer = function (locations) {
                if (!locations || locations.length === 0) {
                    this._clearGeocodedLocation();
                    return;
                }
                var element = this._geocodedContainer;
                if (element.childElementCount) {
                    while (element.firstChild) {
                        element.removeChild(element.firstChild);
                    }
                }
                for (var i = 0; i < locations.length; i++) {
                    logger.log(locations[i]);
                    this._createGeocodedLocationElement(locations[i], i);
                }
                this._geocodedLocations = locations;
            };
            SearchEngine.prototype._setLabel = function (label) {
                document.getElementById('GPsearchInputText-' + this._uid).value = label;
            };
            SearchEngine.prototype._setPosition = function (position, zoom) {
                var view = this.getMap().getView();
                view.setCenter(position);
                view.setZoom(zoom);
            };
            SearchEngine.prototype._setMarker = function (position, info) {
                var map = this.getMap();
                var context = this;
                if (this._marker != null) {
                    map.removeOverlay(this._marker);
                    this._marker = null;
                }
                if (position) {
                    var markerDiv = document.createElement('img');
                    markerDiv.src = this._markerUrl;
                    if (markerDiv.addEventListener) {
                        markerDiv.addEventListener('click', function () {
                            context._onResultMarkerSelect(info);
                        });
                    } else if (markerDiv.attachEvent) {
                        markerDiv.attachEvent('onclick', function () {
                            context._onResultMarkerSelect(info);
                        });
                    }
                    this._marker = new _ol2.default.Overlay({
                        position: position,
                        offset: [
                            -25.5,
                            -38
                        ],
                        element: markerDiv,
                        stopEvent: false
                    });
                    map.addOverlay(this._marker);
                }
            };
            SearchEngine.prototype._getZoom = function (info) {
                var map = this.getMap();
                var key = this.options.zoomTo;
                var zoom = null;
                if (typeof key === 'function') {
                    logger.trace('zoom function');
                    zoom = key.call(this, info);
                }
                if (typeof key === 'number') {
                    logger.trace('zoom level');
                    zoom = key;
                }
                if (typeof key === 'string') {
                    if (key === 'auto') {
                        logger.trace('zoom auto');
                        zoom = _SearchEngineUtils2.default.zoomToResultsByDefault(info);
                    } else {
                        logger.trace('zoom level parsing');
                        var value = parseInt(key, 10);
                        if (!isNaN(value)) {
                            logger.trace('zoom parsing');
                            zoom = value;
                        }
                    }
                }
                Number.isInteger = Number.isInteger || function (value) {
                    return typeof value === 'number' && isFinite(value) && Math.floor(value) === value;
                };
                if (!zoom || zoom === '' || !Number.isInteger(zoom)) {
                    logger.trace('zoom not found, current zoom...');
                    zoom = map.getView().getZoom();
                }
                var min = map.minZoom;
                var max = map.maxZoom;
                if (zoom < min) {
                    logger.trace('zoom level min...');
                    zoom = min;
                }
                if (zoom > max) {
                    logger.trace('zoom level max...');
                    zoom = max;
                }
                logger.trace('zoom', zoom);
                return zoom;
            };
            SearchEngine.prototype._onResultMarkerSelect = function (information) {
                var map = this.getMap();
                var popupContent = '';
                if (information.attributes) {
                    popupContent = '<ul>';
                    var attributes = information.attributes;
                    for (var attr in attributes) {
                        if (attributes.hasOwnProperty(attr)) {
                            if (attr !== 'bbox') {
                                popupContent += '<li>';
                                popupContent += '<span class="gp-attname-others-span">' + attr.toUpperCase() + ' : </span>';
                                popupContent += attributes[attr];
                                popupContent += ' </li>';
                            }
                        }
                    }
                    popupContent += ' </ul>';
                } else {
                    popupContent = information.label;
                }
                this._popupContent.innerHTML = popupContent;
                if (!this._popupOverlay) {
                    this._popupOverlay = new _ol2.default.Overlay({
                        element: this._popupDiv,
                        positioning: 'bottom-center',
                        position: this._marker.getPosition(),
                        offset: [
                            0,
                            -42
                        ]
                    });
                    map.addOverlay(this._popupOverlay);
                } else {
                    this._popupOverlay.setPosition(this._marker.getPosition());
                }
            };
            SearchEngine.prototype.onShowSearchEngineClick = function () {
                this.collapsed = this._showSearchEngineInput.checked;
                this.dispatchEvent('change:collapsed');
            };
            SearchEngine.prototype.onSearchResetClick = function () {
                this._clearResults();
            };
            SearchEngine.prototype.onAutoCompleteInputClick = function () {
                var inputSearchTextContainer = document.getElementById('GPsearchInputText-' + this._uid);
                if (inputSearchTextContainer && !inputSearchTextContainer.disabled && inputSearchTextContainer.value.length > 2) {
                    this._displaySuggestedLocation();
                }
            };
            SearchEngine.prototype.onAutoCompleteSearchText = function (e) {
                var value = e.target.value;
                if (!value) {
                    return;
                }
                if (this._noRightManagement) {
                    console.log('no rights for this service !');
                    return;
                }
                this._currentGeocodingLocation = value;
                if (value.length < 3) {
                    this._clearSuggestedLocation();
                    return;
                }
                var _triggerGeocode = this.options.autocompleteOptions.triggerGeocode;
                var _triggerDelay = this.options.autocompleteOptions.triggerDelay;
                var context = this;
                this._requestAutoComplete({
                    text: value,
                    onSuccess: function onSuccess(results) {
                        logger.log('request from AutoComplete', results);
                        if (results) {
                            context._suggestedLocations = results.suggestedLocations;
                            context._locationsToBeDisplayed = [];
                            for (var i = 0; i < context._suggestedLocations.length; i++) {
                                var ilocation = context._suggestedLocations[i];
                                if (ilocation.position && ilocation.position.x === 0 && ilocation.position.y === 0 && ilocation.fullText) {
                                    context._getGeocodeCoordinatesFromFullText(ilocation, i);
                                } else {
                                    context._locationsToBeDisplayed.push(ilocation);
                                }
                            }
                            context._fillAutoCompletedLocationListContainer(context._locationsToBeDisplayed);
                            if (context._triggerHandler) {
                                clearTimeout(context._triggerHandler);
                                context._triggerHandler = null;
                                logger.warn('Cancel a geocode request !');
                            }
                        }
                    },
                    onFailure: function onFailure(error) {
                        context._clearSuggestedLocation();
                        logger.log(error.message);
                        if (error.message === 'No suggestion matching the search' && _triggerGeocode) {
                            if (context._triggerHandler) {
                                clearTimeout(context._triggerHandler);
                                logger.warn('Cancel the last geocode request !');
                            }
                            context._triggerHandler = setTimeout(function () {
                                logger.warn('Launch a geocode request (code postal) !');
                                context._requestGeocoding({
                                    location: value,
                                    returnFreeForm: true,
                                    onSuccess: function onSuccess(results) {
                                        logger.log('request from Geocoding', results);
                                        if (results) {
                                            context._locationsToBeDisplayed = [];
                                            var locations = results.locations;
                                            for (var i = 0; i < locations.length; i++) {
                                                var location = locations[i];
                                                location.fullText = location.placeAttributes.freeform;
                                                location.position = {
                                                    x: location.position.y,
                                                    y: location.position.x
                                                };
                                                context._locationsToBeDisplayed.push(location);
                                            }
                                            context._fillAutoCompletedLocationListContainer(locations);
                                        }
                                    },
                                    onFailure: function onFailure(error) {
                                        logger.log(error.message);
                                    }
                                });
                            }, _triggerDelay);
                        }
                    }
                });
                var map = this.getMap();
                map.on('click', this._hideSuggestedLocation, this);
                map.on('pointerdrag', this._hideSuggestedLocation, this);
            };
            SearchEngine.prototype._getGeocodeCoordinatesFromFullText = function (suggestedLocation, i) {
                var context = this;
                _gp2.default.Services.geocode({
                    apiKey: this.options.apiKey,
                    location: suggestedLocation.fullText,
                    filterOptions: { type: suggestedLocation.type },
                    onSuccess: function onSuccess(response) {
                        logger.log('request from Geocoding (coordinates null)', response);
                        if (response.locations && response.locations.length !== 0 && response.locations[0].position) {
                            if (context._suggestedLocations && context._suggestedLocations[i]) {
                                context._suggestedLocations[i].position = {
                                    x: response.locations[0].position.y,
                                    y: response.locations[0].position.x
                                };
                                context._locationsToBeDisplayed.unshift(context._suggestedLocations[i]);
                                context._fillAutoCompletedLocationListContainer(context._locationsToBeDisplayed);
                            }
                        }
                    },
                    onFailure: function onFailure() {
                        if (context._suggestedLocations && context._suggestedLocations[i]) {
                            context._createAutoCompletedLocationElement(context._suggestedLocations[i], i);
                        }
                    }
                });
            };
            SearchEngine.prototype.onAutoCompletedResultsItemClick = function (e) {
                var idx = _SelectorID2.default.index(e.target.id);
                logger.log(idx);
                logger.log(this._locationsToBeDisplayed[idx]);
                if (!idx) {
                    return;
                }
                var position = [
                    this._locationsToBeDisplayed[idx].position.x,
                    this._locationsToBeDisplayed[idx].position.y
                ];
                var info = {
                    service: 'SuggestedLocation',
                    type: this._locationsToBeDisplayed[idx].type,
                    fields: this._locationsToBeDisplayed[idx]
                };
                var label = this._locationsToBeDisplayed[idx].fullText;
                this._setLabel(label);
                info.label = label;
                var view = this.getMap().getView();
                var mapProj = view.getProjection().getCode();
                if (mapProj !== 'EPSG:4326') {
                    position = _ol2.default.proj.transform(position, 'EPSG:4326', mapProj);
                }
                var zoom = this._getZoom(info);
                this._setPosition(position, zoom);
                if (this._displayMarker) {
                    this._setMarker(position, info);
                }
            };
            SearchEngine.prototype.onGeocodingSearchSubmit = function (e) {
                var value = e.target[0].value;
                if (!value) {
                    return;
                }
                if (this._noRightManagement) {
                    console.log('no rights for this service !');
                    return;
                }
                this._currentGeocodingLocation = value;
                var context = this;
                this._requestGeocoding({
                    location: value,
                    onSuccess: function onSuccess(results) {
                        logger.log('request from Geocoding', results);
                        if (results) {
                            var locations = results.locations;
                            context._fillGeocodedLocationListContainer(locations);
                        }
                    },
                    onFailure: function onFailure(error) {
                        context._clearGeocodedLocation();
                        logger.log(error.message);
                    }
                });
            };
            SearchEngine.prototype.onGeocodedResultsItemClick = function (e) {
                var idx = _SelectorID2.default.index(e.target.id);
                if (!idx) {
                    return;
                }
                var position = [
                    this._geocodedLocations[idx].position.y,
                    this._geocodedLocations[idx].position.x
                ];
                var attributes = this._geocodedLocations[idx].placeAttributes;
                var info = {
                    service: 'DirectGeocodedLocation',
                    type: this._geocodedLocations[idx].type,
                    fields: this._geocodedLocations[idx]
                };
                var label;
                if (attributes.freeform) {
                    label = attributes.freeform;
                } else if (attributes.postalCode) {
                    label = attributes.postalCode + ' ' + attributes.commune;
                    info.attributes = attributes;
                } else if (attributes.cadastralParcel) {
                    label = attributes.cadastralParcel;
                    info.attributes = attributes;
                } else {
                    label = '...';
                }
                this._setLabel(label);
                info.label = label;
                var view = this.getMap().getView();
                var mapProj = view.getProjection().getCode();
                if (mapProj !== 'EPSG:4326') {
                    position = _ol2.default.proj.transform(position, 'EPSG:4326', mapProj);
                }
                var zoom = this._getZoom(info);
                this._setPosition(position, zoom);
                if (this._displayMarker) {
                    this._setMarker(position, info);
                }
            };
            SearchEngine.prototype.onGeocodingAdvancedSearchCodeChange = function (e) {
                logger.log(e);
                var idx = e.target.selectedIndex;
                var value = e.target.options[idx].value;
                if (!value) {
                    return;
                }
                this._setFilter(value);
            };
            SearchEngine.prototype.onGeocodingAdvancedSearchSubmit = function (e, data) {
                logger.log(data);
                if (!data || data.length === 0) {
                    return;
                }
                var _location;
                var _filterOptions = {};
                var filter;
                _filterOptions.type = [this._currentGeocodingCode];
                for (var i = 0; i < data.length; i++) {
                    filter = data[i];
                    _filterOptions[filter.key] = filter.value;
                }
                if (this._currentGeocodingCode === 'CadastralParcel') {
                    _location = this._getCadastralParcelRequestParams(_filterOptions);
                    _filterOptions = { type: [this._currentGeocodingCode] };
                } else {
                    _location = this._currentGeocodingLocation;
                }
                var context = this;
                this._requestGeocoding({
                    location: _location,
                    filterOptions: _filterOptions,
                    onSuccess: function onSuccess(results) {
                        logger.log(results);
                        if (results) {
                            var locations = results.locations;
                            context._fillGeocodedLocationListContainer(locations);
                        }
                    },
                    onFailure: function onFailure(error) {
                        context._clearGeocodedLocation();
                        logger.log(error.message);
                    }
                });
            };
            SearchEngine.prototype._getCadastralParcelRequestParams = function (filterOptions) {
                var _location = '';
                var l;
                var dep = filterOptions.department;
                if (dep) {
                    l = dep.length;
                    if (l === 2) {
                        _location = dep;
                    } else if (l === 1) {
                        _location = '0' + dep;
                    } else {
                        _location = dep.substring(0, 2);
                    }
                } else {
                    _location = '__';
                }
                var commune = filterOptions.commune;
                if (commune) {
                    l = commune.length;
                    if (l === 3) {
                        _location += commune;
                    } else if (l == 2) {
                        _location += '_' + commune;
                    } else if (l == 1) {
                        _location += '__' + commune;
                    } else {
                        _location += commune.substring(0, 3);
                    }
                } else {
                    _location += '___';
                }
                var insee = filterOptions.insee;
                if (insee) {
                    if (insee.length === 5) {
                        _location = insee;
                    }
                }
                var absorbedCity = filterOptions.absorbedCity;
                if (absorbedCity) {
                    l = absorbedCity.length;
                    if (l === 3) {
                        _location += absorbedCity;
                    } else if (l < 3) {
                        if (l === 2) {
                            _location += '_' + absorbedCity;
                        } else if (l === 1) {
                            _location += '__' + absorbedCity;
                        }
                    } else {
                        _location += absorbedCity.substring(0, 3);
                    }
                } else {
                    _location += '___';
                }
                var section = filterOptions.section;
                if (section) {
                    l = section.length;
                    if (l === 2) {
                        _location += section;
                    } else if (l === 1) {
                        _location += '_' + section;
                    } else {
                        _location += section.substring(0, 2);
                    }
                } else {
                    _location += '__';
                }
                var number = filterOptions.number;
                if (number) {
                    l = number.length;
                    if (l === 4) {
                        _location += number;
                    } else if (l === 3) {
                        _location += '_' + number;
                    } else if (l === 2) {
                        _location += '__' + number;
                    } else if (l === 1) {
                        _location += '___' + number;
                    } else {
                        _location += number.substring(0, 4);
                    }
                } else {
                    _location += '___';
                }
                logger.log('location : ' + _location);
                return _location;
            };
            SearchEngine.prototype._clearResults = function () {
                var map = this.getMap();
                this._currentGeocodingLocation = null;
                this._clearSuggestedLocation();
                this._clearGeocodedLocation();
                this._setMarker();
                if (this._popupOverlay != null) {
                    map.removeOverlay(this._popupOverlay);
                    this._popupOverlay = null;
                }
            };
            SearchEngine.prototype._clearSuggestedLocation = function () {
                this._suggestedLocations = [];
                if (this._suggestedContainer) {
                    while (this._suggestedContainer.firstChild) {
                        this._suggestedContainer.removeChild(this._suggestedContainer.firstChild);
                    }
                }
            };
            SearchEngine.prototype._hideSuggestedLocation = function () {
                if (this._autocompleteContainer) {
                    this._autocompleteContainer.style.display = 'none';
                }
            };
            SearchEngine.prototype._displaySuggestedLocation = function () {
                if (this._autocompleteContainer) {
                    this._autocompleteContainer.style.display = 'block';
                }
            };
            SearchEngine.prototype._clearGeocodedLocation = function () {
                this._geocodedLocations = [];
                if (this._geocodedContainer) {
                    while (this._geocodedContainer.firstChild) {
                        this._geocodedContainer.removeChild(this._geocodedContainer.firstChild);
                    }
                }
            };
            exports.default = SearchEngine;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var SearchEngineUtils = {
                advancedSearchFiltersByDefault: {
                    PositionOfInterest: [
                        {
                            name: 'importance',
                            title: 'Importance'
                        },
                        {
                            name: 'nature',
                            title: 'Nature'
                        },
                        {
                            name: 'territory',
                            title: 'Territoire'
                        },
                        {
                            name: 'insee',
                            title: 'Code INSEE'
                        },
                        {
                            name: 'municipality',
                            title: 'Ville'
                        },
                        {
                            name: 'department',
                            title: 'Département'
                        }
                    ],
                    StreetAddress: [
                        {
                            name: 'territory',
                            title: 'Territoire'
                        },
                        {
                            name: 'insee',
                            title: 'Code INSEE'
                        },
                        {
                            name: 'municipality',
                            title: 'Ville'
                        },
                        {
                            name: 'department',
                            title: 'Département'
                        }
                    ],
                    CadastralParcel: [
                        {
                            name: 'department',
                            title: 'Département',
                            description: 'Numéro du département (ex: 01, 94)'
                        },
                        {
                            name: 'commune',
                            title: 'Code commune (INSEE)',
                            description: 'Code commune (INSEE) : 3 chiffres (ex: 067)'
                        },
                        {
                            name: 'absorbedCity',
                            title: 'Commune absorbée',
                            description: 'Commune absorbée : 3 chiffres (ex: 000, 001)'
                        },
                        {
                            name: 'section',
                            title: 'Section',
                            description: 'Section : 2 caractères (ex: AA, 0D)'
                        },
                        {
                            name: 'number',
                            title: 'Numéro',
                            description: 'Numéro de la parcelle : 4 chiffres (ex: 0041, 0250)'
                        }
                    ],
                    Administratif: [
                        {
                            name: 'prefecture',
                            title: 'Préfecture'
                        },
                        {
                            name: 'inseeRegion',
                            title: 'Code région (INSEE)'
                        },
                        {
                            name: 'inseeDepartment',
                            title: 'Code département (INSEE)'
                        },
                        {
                            name: 'municipality',
                            title: 'Ville'
                        }
                    ]
                },
                zoomToResultsByDefault: function zoomToResultsByDefault(info) {
                    var zoom = 15;
                    var service = info.service;
                    var fields = info.fields;
                    var type = info.type;
                    var importance = {
                        1: 11,
                        2: 12,
                        3: 13,
                        4: 14,
                        5: 15,
                        6: 16,
                        7: 17,
                        8: 17
                    };
                    if (service === 'SuggestedLocation') {
                        if (type === 'PositionOfInterest') {
                            zoom = importance[fields.classification];
                        }
                    }
                    if (service === 'DirectGeocodedLocation') {
                        if (type === 'PositionOfInterest') {
                            zoom = importance[fields.importance] || 14;
                        }
                    }
                    if (type === 'StreetAddress') {
                        zoom = 17;
                    }
                    if (type === 'CadastralParcel') {
                        zoom = 17;
                    }
                    if (type === 'Administratif') {
                        zoom = 12;
                    }
                    return zoom;
                }
            };
            exports.default = SearchEngineUtils;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var SearchEngineDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPsearchEngine');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowSearchEngineElement: function _createShowSearchEngineElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowSearchEngine');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowSearchEnginePictoElement: function _createShowSearchEnginePictoElement() {
                    var self = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowSearchEnginePicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowSearchEngine');
                    label.title = 'Afficher/masquer la recherche par lieux';
                    label.addEventListener('click', function () {
                        document.getElementById(self._addUID('GPautoCompleteList')).style.display = 'none';
                        document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'none';
                        var showAdvancedSearch = document.getElementById(self._addUID('GPshowAdvancedSearch'));
                        if (showAdvancedSearch) {
                            showAdvancedSearch.style.display = null;
                            document.getElementById(self._addUID('GPadvancedSearchPanel')).style.display = 'none';
                        }
                        var id = '#GPsearchInput-' + self._uid;
                        document.querySelector(id + ' input').disabled = false;
                        self.onShowSearchEngineClick();
                    });
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowSearchEngineOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                },
                _createSearchInputElement: function _createSearchInputElement(placeholder) {
                    var self = this;
                    var form = document.createElement('form');
                    form.id = this._addUID('GPsearchInput');
                    form.addEventListener('submit', function (e) {
                        e.preventDefault();
                        document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'block';
                        document.getElementById(self._addUID('GPautoCompleteList')).style.display = 'none';
                        self.onGeocodingSearchSubmit(e);
                        return false;
                    });
                    var input = document.createElement('input');
                    input.id = this._addUID('GPsearchInputText');
                    input.type = 'text';
                    input.placeholder = placeholder;
                    input.autocomplete = 'off';
                    input.addEventListener('keyup', function (e) {
                        var charCode = e.which || e.keyCode;
                        if (charCode === 13 || charCode === 10 || charCode === 38 || charCode === 40) {
                            return;
                        }
                        document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'none';
                        if (input.value.length > 2) {
                            document.getElementById(self._addUID('GPautoCompleteList')).style.display = 'block';
                        } else {
                            document.getElementById(self._addUID('GPautoCompleteList')).style.display = 'none';
                        }
                        self.onAutoCompleteSearchText(e);
                    });
                    input.addEventListener('keydown', function (e) {
                        var charCode = e.which || e.keyCode;
                        var container = document.getElementById(self._addUID('GPautocompleteResults'));
                        if (!container) {
                            return;
                        }
                        var curr = container.getElementsByClassName('GPautoCompleteProposal current');
                        var list = container.getElementsByClassName('GPautoCompleteProposal');
                        var length = list.length;
                        if (!length) {
                            return;
                        }
                        var current = null;
                        if (!curr.length) {
                            current = list[0];
                            current.className = 'GPautoCompleteProposal current';
                            current.style.color = '#000000';
                            current.style['background-color'] = '#CEDBEF';
                            return;
                        } else {
                            current = curr[0];
                        }
                        var index = parseInt(_SelectorID2.default.index(current.id), 10);
                        var next = index === length - 1 ? list[0] : list[index + 1];
                        var prev = index === 0 ? list[length - 1] : list[index - 1];
                        current.style['background-color'] = '';
                        current.style.color = '';
                        prev.style['background-color'] = '';
                        prev.style.color = '';
                        next.style['background-color'] = '';
                        next.style.color = '';
                        switch (charCode) {
                        case 38:
                            current.className = 'GPautoCompleteProposal';
                            prev.className = 'GPautoCompleteProposal current';
                            prev.style.color = '#000000';
                            prev.style['background-color'] = '#CEDBEF';
                            break;
                        case 40:
                            current.className = 'GPautoCompleteProposal';
                            next.className = 'GPautoCompleteProposal current';
                            next.style.color = '#000000';
                            next.style['background-color'] = '#CEDBEF';
                            break;
                        case 13:
                            e.preventDefault();
                            current.click(e);
                            break;
                        }
                        current.focus();
                    });
                    form.appendChild(input);
                    var div = document.createElement('div');
                    div.id = this._addUID('GPsearchInputReset');
                    div.addEventListener('click', function () {
                        document.getElementById(self._addUID('GPsearchInputText')).value = '';
                        document.getElementById(self._addUID('GPautoCompleteList')).style.display = 'none';
                        document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'none';
                        self.onSearchResetClick();
                    });
                    form.appendChild(div);
                    return form;
                },
                _createShowAdvancedSearchElement: function _createShowAdvancedSearchElement() {
                    var self = this;
                    var div = document.createElement('div');
                    div.id = this._addUID('GPshowAdvancedSearch');
                    div.className = 'GPshowAdvancedToolPicto';
                    div.title = 'Ouvrir la recherche avancée';
                    div.addEventListener('click', function () {
                        var id = '#GPsearchInput-' + self._uid;
                        document.querySelector(id + ' input').disabled = true;
                        document.getElementById(self._addUID('GPautoCompleteList')).style.display = 'none';
                        document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'none';
                        document.getElementById(self._addUID('GPshowAdvancedSearch')).style.display = 'none';
                        document.getElementById(self._addUID('GPadvancedSearchPanel')).style.display = 'inline-block';
                    });
                    var span = document.createElement('span');
                    span.id = this._addUID('GPshowAdvancedSearchOpen');
                    span.className = 'GPshowAdvancedToolOpen';
                    div.appendChild(span);
                    return div;
                },
                _createAdvancedSearchPanelElement: function _createAdvancedSearchPanelElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPadvancedSearchPanel');
                    div.className = 'GPpanel';
                    div.style.display = 'none';
                    return div;
                },
                _createGeocodeResultsElement: function _createGeocodeResultsElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPgeocodeResultsList');
                    div.className = 'GPpanel';
                    div.style.display = 'none';
                    div.appendChild(this._createGeocodeResultsHeaderElement());
                    return div;
                },
                _createAutoCompleteElement: function _createAutoCompleteElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPautoCompleteList');
                    div.className = 'GPautoCompleteList';
                    div.style.display = 'none';
                    return div;
                },
                _createAutoCompleteListElement: function _createAutoCompleteListElement() {
                    var self = this;
                    var container = document.createElement('div');
                    container.id = this._addUID('GPautocompleteResults');
                    if (container.addEventListener) {
                        container.addEventListener('click', function (e) {
                            self.onAutoCompletedResultsItemClick(e);
                            document.getElementById(self._addUID('GPautoCompleteList')).style.display = 'none';
                        }, false);
                    } else if (container.attachEvent) {
                        container.attachEvent('onclick', function (e) {
                            self.onAutoCompletedResultsItemClick(e);
                            document.getElementById(self._addUID('GPautoCompleteList')).style.display = 'none';
                        });
                    }
                    return container;
                },
                _createAutoCompletedLocationElement: function _createAutoCompletedLocationElement(location, id) {
                    var container = document.getElementById(this._addUID('GPautocompleteResults'));
                    var div = document.createElement('div');
                    div.id = this._addUID('AutoCompletedLocation_' + id);
                    div.className = 'GPautoCompleteProposal';
                    div.innerHTML = location.fullText;
                    if (div.addEventListener) {
                        div.addEventListener('click', function (e) {
                            container.click(e);
                        }, false);
                    } else if (div.attachEvent) {
                        div.attachEvent('onclick', function (e) {
                            container.click(e);
                        });
                    }
                    container.appendChild(div);
                },
                _createAdvancedSearchPanelHeaderElement: function _createAdvancedSearchPanelHeaderElement() {
                    var self = this;
                    var container = document.createElement('div');
                    container.className = 'GPpanelHeader';
                    var divTitle = document.createElement('div');
                    divTitle.className = 'GPpanelTitle';
                    divTitle.innerHTML = 'Recherche avancée';
                    container.appendChild(divTitle);
                    var divClose = document.createElement('div');
                    divClose.id = this._addUID('GPadvancedSearchClose');
                    divClose.className = 'GPpanelClose';
                    divClose.title = 'Fermer la recherche avancée';
                    if (divClose.addEventListener) {
                        divClose.addEventListener('click', function () {
                            var id = '#GPsearchInput-' + self._uid;
                            document.querySelector(id + ' input').disabled = false;
                            document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'none';
                            document.getElementById(self._addUID('GPshowAdvancedSearch')).style.display = 'inline-block';
                            document.getElementById(self._addUID('GPadvancedSearchPanel')).style.display = 'none';
                        }, false);
                    } else if (divClose.attachEvent) {
                        divClose.attachEvent('onclick', function () {
                            var id = '#GPsearchInput-' + self._uid;
                            document.querySelector(id + ' input').disabled = false;
                            document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'none';
                            document.getElementById(self._addUID('GPshowAdvancedSearch')).style.display = 'inline-block';
                            document.getElementById(self._addUID('GPadvancedSearchPanel')).style.display = 'none';
                        });
                    }
                    container.appendChild(divClose);
                    return container;
                },
                _createAdvancedSearchPanelFormElement: function _createAdvancedSearchPanelFormElement(advancedSearchCodes) {
                    var self = this;
                    var form = document.createElement('form');
                    form.id = this._addUID('GPadvancedSearchForm');
                    form.addEventListener('submit', function (e) {
                        e.preventDefault();
                        var data = [];
                        var id = '#GPadvancedSearchFilters-' + self._uid;
                        var matchesFilters = document.querySelectorAll(id + ' > div > div > input');
                        for (var i = 0; i < matchesFilters.length; i++) {
                            var element = matchesFilters[i];
                            data.push({
                                key: element.name,
                                value: element.value
                            });
                        }
                        self.onGeocodingAdvancedSearchSubmit(e, data);
                        document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'block';
                        return false;
                    });
                    var div = document.createElement('div');
                    div.className = 'GPflexInput';
                    var label = document.createElement('label');
                    label.className = 'GPadvancedSearchCodeLabel';
                    label.innerHTML = 'Recherche par';
                    div.appendChild(label);
                    var select = this._createAdvancedSearchFormCodeElement(advancedSearchCodes);
                    div.appendChild(select);
                    form.appendChild(div);
                    return form;
                },
                _createAdvancedSearchFormCodeElement: function _createAdvancedSearchFormCodeElement(codes) {
                    var self = this;
                    var select = document.createElement('select');
                    select.id = this._addUID('GPadvancedSearchCode');
                    select.className = 'GPadvancedSearchCode';
                    select.addEventListener('change', function (e) {
                        self.onGeocodingAdvancedSearchCodeChange(e);
                    }, false);
                    if (!codes) {
                        codes = [
                            {
                                id: 'PositionOfInterest',
                                title: 'Lieux/toponymes'
                            },
                            {
                                id: 'StreetAddress',
                                title: 'Adresses'
                            },
                            {
                                id: 'CadastralParcel',
                                title: 'Parcelles cadastrales'
                            },
                            {
                                id: 'Administratif',
                                title: 'Administratif'
                            }
                        ];
                    }
                    for (var i = 0; i < codes.length; i++) {
                        var option = document.createElement('option');
                        option.value = codes[i].id;
                        option.text = codes[i].title;
                        select.appendChild(option);
                    }
                    return select;
                },
                _createAdvancedSearchFormInputElement: function _createAdvancedSearchFormInputElement() {
                    var input = document.createElement('input');
                    input.type = 'submit';
                    input.id = this._addUID('GPadvancedSearchSubmit');
                    input.className = 'GPinputSubmit';
                    input.value = 'Chercher';
                    return input;
                },
                _createAdvancedSearchFormFiltersElement: function _createAdvancedSearchFormFiltersElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPadvancedSearchFilters');
                    return container;
                },
                _createAdvancedSearchFiltersTableElement: function _createAdvancedSearchFiltersTableElement(code, display) {
                    var container = document.createElement('div');
                    container.id = this._addUID(code);
                    if (!display) {
                        container.style.display = 'none';
                    }
                    return container;
                },
                _createAdvancedSearchFiltersAttributElement: function _createAdvancedSearchFiltersAttributElement(filterAttributes) {
                    var container = null;
                    var name = filterAttributes.name;
                    var title = filterAttributes.title;
                    var description = filterAttributes.description;
                    var code = filterAttributes.code;
                    var value = filterAttributes.value;
                    var div = document.createElement('div');
                    div.className = 'GPflexInput';
                    var label = document.createElement('label');
                    label.className = 'GPadvancedSearchFilterLabel';
                    label.htmlFor = name;
                    label.title = description || title;
                    label.innerHTML = title;
                    div.appendChild(label);
                    var input = document.createElement('input');
                    input.id = name;
                    input.className = 'GPadvancedSearchFilterInput';
                    input.type = 'text';
                    input.name = name;
                    if (value) {
                        input.value = value;
                    }
                    div.appendChild(input);
                    container = document.getElementById(this._addUID(code));
                    if (container) {
                        container.appendChild(div);
                    } else {
                        container = div;
                    }
                    return container;
                },
                _createGeocodeResultsHeaderElement: function _createGeocodeResultsHeaderElement() {
                    var self = this;
                    var container = document.createElement('div');
                    container.className = 'GPpanelHeader';
                    var divTitle = document.createElement('div');
                    divTitle.className = 'GPpanelTitle';
                    divTitle.innerHTML = 'Résultats de la recherche';
                    container.appendChild(divTitle);
                    var divClose = document.createElement('div');
                    divClose.id = this._addUID('GPgeocodeResultsClose');
                    divClose.className = 'GPpanelClose';
                    divClose.title = 'Fermer la fenêtre de résultats';
                    if (divClose.addEventListener) {
                        divClose.addEventListener('click', function () {
                            document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'none';
                        }, false);
                    } else if (divClose.attachEvent) {
                        divClose.attachEvent('onclick', function () {
                            document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'none';
                        });
                    }
                    container.appendChild(divClose);
                    return container;
                },
                _createGeocodeResultsListElement: function _createGeocodeResultsListElement() {
                    var self = this;
                    var container = document.createElement('div');
                    container.id = this._addUID('GPgeocodeResults');
                    if (container.addEventListener) {
                        container.addEventListener('click', function (e) {
                            if (!e.ctrlKey) {
                                document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'none';
                            }
                            self.onGeocodedResultsItemClick(e);
                        }, false);
                    } else if (container.attachEvent) {
                        container.attachEvent('onclick', function (e) {
                            if (!e.ctrlKey) {
                                document.getElementById(self._addUID('GPgeocodeResultsList')).style.display = 'none';
                            }
                            self.onGeocodedResultsItemClick(e);
                        });
                    }
                    return container;
                },
                _createGeocodedLocationElement: function _createGeocodedLocationElement(location, id) {
                    var container = document.getElementById(this._addUID('GPgeocodeResults'));
                    var div = document.createElement('div');
                    div.id = this._addUID('GeocodedLocation_' + id);
                    div.className = 'GPautoCompleteProposal';
                    if (typeof location === 'string') {
                        div.innerHTML = location;
                    } else {
                        var places = location.placeAttributes;
                        if (places.freeform) {
                            div.innerHTML = places.freeform;
                        } else if (places.postalCode) {
                            div.innerHTML = places.postalCode + ' ' + places.commune;
                        } else if (places.cadastralParcel) {
                            div.innerHTML = places.cadastralParcel;
                        } else {
                            div.innerHTML = '...';
                        }
                    }
                    container.appendChild(div);
                }
            };
            exports.default = SearchEngineDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _proj = __webpack_require__(9);
            var _proj2 = _interopRequireDefault(_proj);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _Markers = __webpack_require__(7);
            var _Markers2 = _interopRequireDefault(_Markers);
            var _CheckRightManagement = __webpack_require__(6);
            var _CheckRightManagement2 = _interopRequireDefault(_CheckRightManagement);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _MathUtils = __webpack_require__(95);
            var _MathUtils2 = _interopRequireDefault(_MathUtils);
            var _MousePositionDOM = __webpack_require__(35);
            var _MousePositionDOM2 = _interopRequireDefault(_MousePositionDOM);
            __webpack_require__(39);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('GeoportalMousePosition');
            function MousePosition(options) {
                options = options || {};
                if (!(this instanceof MousePosition)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this._initialize(options);
                var container = this._initContainer(options);
                _ol2.default.control.Control.call(this, {
                    element: container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(MousePosition, _ol2.default.control.Control);
            MousePosition.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(MousePosition.prototype, _MousePositionDOM2.default);
            MousePosition.prototype.constructor = MousePosition;
            MousePosition.prototype.setMap = function (map) {
                var context = this;
                if (map) {
                    var center = this._createMapCenter();
                    map.getViewport().appendChild(center);
                    if (!this.collapsed && !this._isDesktop) {
                        center.className = 'GPmapCenterVisible';
                    }
                    if (!this.collapsed) {
                        if (this._isDesktop) {
                            map.on('pointermove', this.onMouseMove, this);
                        } else {
                            map.on('moveend', this.onMapMove, this);
                        }
                    }
                    if (this.options.editCoordinates) {
                        var markerDiv = document.createElement('img');
                        markerDiv.id = this._addUID('GPmousePositionMarker');
                        markerDiv.src = this._markerUrl;
                        markerDiv.title = 'Cliquer pour supprimer';
                        markerDiv.addEventListener('click', function () {
                            context._markerOverlay.setPosition(undefined);
                        });
                        this._markerOverlay = new _ol2.default.Overlay({
                            offset: this._markerOffset,
                            element: markerDiv,
                            stopEvent: false
                        });
                        map.addOverlay(this._markerOverlay);
                    }
                }
                _ol2.default.control.Control.prototype.setMap.call(this, map);
                if (map == null) {
                    return;
                }
                if (!this.collapsed) {
                    var inputShow = document.getElementById('GPshowMousePosition-' + this._uid);
                    inputShow.checked = 'checked';
                    this._setElevationPanel(this.options.displayAltitude);
                    this._setCoordinatesPanel(this.options.displayCoordinates);
                    if (!this.options.displayCoordinates) {
                        this._setSettingsPanel(false);
                    }
                }
            };
            MousePosition.prototype.addSystem = function (system) {
                if ((typeof system === 'undefined' ? 'undefined' : _typeof(system)) !== 'object') {
                    console.log('[ERROR] MousePosition:addSystem - system parameter should be an object');
                    return;
                }
                if (!system.crs) {
                    logger.error('crs not defined !');
                    return;
                }
                if (!system.label) {
                    logger.warn('crs label not defined, use crs code by default.');
                    system.label = system.crs;
                }
                if (!system.type) {
                    logger.warn('type srs not defined, use \'Metric\' by default.');
                    system.type = 'Metric';
                }
                var found = false;
                for (var j = 0; j < this._projectionSystems.length; j++) {
                    var obj = this._projectionSystems[j];
                    if (system.crs === obj.crs) {
                        found = true;
                        logger.info('crs \'{}\' already configured', obj.crs);
                    }
                }
                system.code = this._projectionSystems.length;
                this._projectionSystems.push(system);
                var selectSystem = document.getElementById('GPmousePositionProjectionSystem-' + this._uid);
                if (selectSystem) {
                    var option = document.createElement('option');
                    option.value = system.code;
                    option.text = system.label;
                    selectSystem.appendChild(option);
                }
            };
            MousePosition.prototype.addSystems = function (systems) {
                if (!systems) {
                    return;
                }
                if (!Array.isArray(systems)) {
                    console.log('[ERROR] MousePosition:addSystems - systems parameter should be an array');
                    return;
                }
                for (var i = 0; i < systems.length; i++) {
                    this.addSystem(systems[i]);
                }
            };
            MousePosition.prototype.removeSystem = function (systemCrs) {
                if (!systemCrs || typeof systemCrs !== 'string') {
                    console.log('[ERROR] MousePosition:removeSystem - systemCode parameter should be a string');
                    return;
                }
                var systemList = document.getElementById('GPmousePositionProjectionSystem-' + this._uid);
                var systemCode = null;
                for (var i = 0; i < this._projectionSystems.length; i++) {
                    var proj = this._projectionSystems[i];
                    if (systemCrs === proj.crs) {
                        systemCode = proj.code;
                        this._projectionSystems.splice(i, 1);
                        break;
                    }
                }
                if (systemCode == null) {
                    console.log('[WARN] MousePosition:removeSystem - system not found');
                    return;
                }
                var oldNewCodeMap = [];
                for (var j = 0; j < this._projectionSystems.length; j++) {
                    oldNewCodeMap[Number(this._projectionSystems[j].code)] = j;
                    this._projectionSystems[j].code = j;
                }
                var indexChildToRemove = null;
                for (var k = 0; k < systemList.childNodes.length; k++) {
                    if (systemCode == systemList.childNodes[j].value) {
                        indexChildToRemove = k;
                        continue;
                    }
                    systemList.childNodes[j].value = oldNewCodeMap[Number(systemList.childNodes[j].value)];
                }
                if (indexChildToRemove != null) {
                    systemList.removeChild(systemList.childNodes[indexChildToRemove]);
                }
                if (this._currentProjectionSystems.code == systemCode) {
                    systemList.childNodes[0].setAttribute('selected', 'selected');
                    this._setCurrentSystem(systemList.childNodes[0].value);
                }
            };
            MousePosition.prototype.setUnits = function (units) {
                if (!units || !Array.isArray(units)) {
                    return;
                }
                this.options.units = units;
                this._projectionUnits = [];
                this._initProjectionUnits();
                if (this._currentProjectionType) {
                    this._setTypeUnitsPanel(this._currentProjectionType);
                }
            };
            MousePosition.prototype.setAltitudeOptions = function (options) {
                if (!options || (typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {
                    return;
                }
                this.options.altitude.triggerDelay = options.triggerDelay;
                this.options.altitude.responseDelay = options.responseDelay;
                if (options.serviceOptions) {
                    for (var opt in options.serviceOptions) {
                        if (options.serviceOptions.hasOwnProperty(opt)) {
                            this.options.altitude.serviceOptions[opt] = options.serviceOptions[opt];
                        }
                    }
                }
            };
            MousePosition.prototype.displayAltitude = function (displayAltitude) {
                if (displayAltitude === undefined) {
                    return;
                }
                if (typeof this._noRightManagement === 'undefined') {
                    this._checkRightsManagement();
                }
                this.options.displayAltitude = displayAltitude;
                this._setElevationPanel(displayAltitude);
            };
            MousePosition.prototype.displayCoordinates = function (displayCoordinates) {
                if (displayCoordinates === undefined) {
                    return;
                }
                this.options.displayCoordinates = displayCoordinates;
                this._setCoordinatesPanel(displayCoordinates);
                this._setSettingsPanel(displayCoordinates);
            };
            MousePosition.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] MousePosition:setCollapsed - missing collapsed parameter');
                    return;
                }
                if (collapsed && this.collapsed || !collapsed && !this.collapsed) {
                    return;
                }
                if (!this._isDesktop) {
                    document.getElementById('GPmapCenter').className = collapsed ? '' : 'GPmapCenterVisible';
                }
                this.onShowMousePositionClick();
                this._showMousePositionContainer.checked = !collapsed;
            };
            MousePosition.prototype._initialize = function (options) {
                this.options = options || {};
                this.options.collapsed = options.collapsed !== undefined ? options.collapsed : true;
                this.collapsed = this.options.collapsed;
                this._markerOverlay = null;
                this._markerUrl = null;
                this._markerOffset = [
                    0,
                    0
                ];
                this._hideMarker = false;
                this._initMarker(options.positionMarker);
                this.options.units = options.units || [];
                this.options.displayAltitude = options.displayAltitude !== undefined ? options.displayAltitude : true;
                this.options.displayCoordinates = options.displayCoordinates !== undefined ? options.displayCoordinates : true;
                if (this.options.displayCoordinates) {
                    this.options.editCoordinates = options.editCoordinates !== undefined ? options.editCoordinates : false;
                } else {
                    this.options.editCoordinates = false;
                }
                this.editing = false;
                this.options.systems = options.systems || [];
                if (options.altitude) {
                    var altitude = options.altitude;
                    this.options.altitude = {
                        triggerDelay: altitude.triggerDelay !== undefined ? altitude.triggerDelay : 200,
                        responseDelay: altitude.responseDelay !== undefined ? altitude.responseDelay : 500,
                        serviceOptions: altitude.serviceOptions || {},
                        noDataValue: altitude.noDataValue !== undefined ? altitude.noDataValue : -99999,
                        noDataValueTolerance: altitude.noDataValueTolerance !== undefined ? altitude.noDataValueTolerance : 90000
                    };
                } else {
                    this.options.altitude = {
                        triggerDelay: 200,
                        responseDelay: 500,
                        serviceOptions: {}
                    };
                }
                this._uid = _SelectorID2.default.generate();
                this._projectionSystems = [];
                this._initProjectionSystems();
                this._projectionUnits = {};
                this._initProjectionUnits();
                this._isDesktop = _Utils2.default.detectSupport();
                if (this.options.altitude.triggerDelay < 100) {
                    this.options.altitude.triggerDelay = 100;
                }
                this._timer = this.options.altitude.triggerDelay;
                this._currentProjectionSystems = this._projectionSystems[0];
                this._currentProjectionType = this._projectionSystems[0].type;
                this._currentProjectionUnits = this._projectionUnits[this._currentProjectionType][0].code;
                this._projectionUnitsContainer = null;
                this._showMousePositionContainer = null;
                if (!this.options.displayAltitude && !this.options.displayCoordinates) {
                    this.options.displayCoordinates = true;
                }
                if (this.options.displayAltitude) {
                    this._checkRightsManagement();
                }
            };
            MousePosition.prototype._initMarker = function (option) {
                if (!this.options.editCoordinates) {
                    return;
                }
                if (!option) {
                    this._markerUrl = _Markers2.default['lightOrange'];
                    this._markerOffset = _Markers2.default.defaultOffset;
                    return;
                }
                this._hideMarker = option.hide !== undefined ? option.hide : false;
                if (option.offset) {
                    if (Array.isArray(option.offset) && option.offset.length === 2) {
                        this._markerOffset = option.offset;
                    } else {
                        console.log('positionMarker.offset should be an array. e.g. : [0,0]');
                        this._markerOffset = _Markers2.default.defaultOffset;
                    }
                } else {
                    this._markerOffset = _Markers2.default.defaultOffset;
                }
                var url = option.url;
                if (!url) {
                    this._markerUrl = _Markers2.default['lightOrange'];
                } else if (url.match(/^[a-zA-Z]+$/)) {
                    this._markerUrl = _Markers2.default[url] !== undefined ? _Markers2.default[url] : _Markers2.default['lightOrange'];
                } else {
                    this._markerUrl = url;
                }
            };
            MousePosition.prototype._initProjectionSystems = function () {
                var projectionSystemsByDefault = [
                    {
                        label: 'Géographique',
                        crs: _ol2.default.proj.get('EPSG:4326').getCode(),
                        type: 'Geographical'
                    },
                    {
                        label: 'Web Mercator',
                        crs: _ol2.default.proj.get('EPSG:3857').getCode(),
                        type: 'Metric'
                    },
                    {
                        label: 'Lambert 93',
                        crs: _ol2.default.proj.get('EPSG:2154').getCode(),
                        type: 'Metric',
                        geoBBox: {
                            left: -9.86,
                            bottom: 41.15,
                            right: 10.38,
                            top: 51.56
                        }
                    },
                    {
                        label: 'Lambert II étendu',
                        crs: _ol2.default.proj.get('EPSG:27572'),
                        type: 'Metric',
                        geoBBox: {
                            left: -4.87,
                            bottom: 42.33,
                            right: 8.23,
                            top: 51.14
                        }
                    }
                ];
                var systems = this.options.systems;
                for (var i = 0; i < systems.length; i++) {
                    var sys = systems[i];
                    this.addSystem(sys);
                }
                if (this._projectionSystems.length === 0) {
                    for (var j = 0; j < projectionSystemsByDefault.length; j++) {
                        this.addSystem(projectionSystemsByDefault[j]);
                    }
                }
            };
            MousePosition.prototype._initProjectionUnits = function () {
                var projectionUnitsByDefault = {
                    Geographical: [
                        {
                            code: 'DEC',
                            label: 'degrés décimaux',
                            format: this._displayDEC
                        },
                        {
                            code: 'DMS',
                            label: 'degrés sexagésimaux',
                            format: this._displayDMS
                        },
                        {
                            code: 'RAD',
                            label: 'radians',
                            format: this._displayRAD
                        },
                        {
                            code: 'GON',
                            label: 'grades',
                            format: this._displayGON
                        }
                    ],
                    Metric: [
                        {
                            code: 'M',
                            label: 'mètres',
                            format: this._displayMeter
                        },
                        {
                            code: 'KM',
                            label: 'kilomètres',
                            format: this._displayKMeter
                        }
                    ]
                };
                var units = this.options.units;
                for (var type in projectionUnitsByDefault) {
                    if (projectionUnitsByDefault.hasOwnProperty(type)) {
                        var found = false;
                        for (var j = 0; j < projectionUnitsByDefault[type].length; j++) {
                            var obj = projectionUnitsByDefault[type][j];
                            for (var i = 0; i < units.length; i++) {
                                var unit = units[i];
                                if (obj.code === unit) {
                                    found = true;
                                    if (!this._projectionUnits[type]) {
                                        this._projectionUnits[type] = [];
                                    }
                                    this._projectionUnits[type].push(obj);
                                }
                            }
                        }
                        if (!found) {
                            this._projectionUnits[type] = projectionUnitsByDefault[type];
                        }
                    }
                }
                if (_typeof(this._projectionUnits) === 'object' && Object.keys(this._projectionUnits).length === 0) {
                    this._projectionUnits = projectionUnitsByDefault;
                }
            };
            MousePosition.prototype._getCurrentProjectionInformation = function () {
                var systemInfo = [
                    this._currentProjectionSystems.label,
                    'en'
                ];
                var units = this._projectionUnits[this._currentProjectionType];
                for (var u = 0; u < units.length; ++u) {
                    if (units[u].code === this._currentProjectionUnits) {
                        systemInfo.push(units[u].label);
                        break;
                    }
                }
                return systemInfo.join(' ');
            };
            MousePosition.prototype._checkRightsManagement = function () {
                var rightManagement = _CheckRightManagement2.default.check({
                    key: this.options.apiKey,
                    resources: ['SERVICE_CALCUL_ALTIMETRIQUE_RSC'],
                    services: ['Elevation']
                });
                this._noRightManagement = !rightManagement;
                if (!this.options.apiKey) {
                    this.options.apiKey = rightManagement.key;
                }
            };
            MousePosition.prototype._initContainer = function () {
                var container = this._createMainContainerElement();
                var inputShow = this._showMousePositionContainer = this._createShowMousePositionElement();
                container.appendChild(inputShow);
                var picto = this._createShowMousePositionPictoElement(this._isDesktop);
                container.appendChild(picto);
                var panel = this._createMousePositionPanelElement(this.options.displayAltitude, this.options.displayCoordinates, this.options.editCoordinates, this._currentProjectionUnits);
                var settings = this._createMousePositionSettingsElement();
                var systems = this._projectionSystemsContainer = this._createMousePositionSettingsSystemsElement(this._projectionSystems);
                var units = this._projectionUnitsContainer = this._createMousePositionSettingsUnitsElement(this._projectionUnits[this._currentProjectionType]);
                settings.appendChild(systems);
                settings.appendChild(units);
                panel.appendChild(settings);
                container.appendChild(panel);
                return container;
            };
            MousePosition.prototype._setElevationPanel = function (active) {
                var div = null;
                if (!active) {
                    div = document.getElementById('GPmousePositionAltitude-' + this._uid);
                    div.style.display = 'none';
                } else {
                    if (this._noRightManagement) {
                        div = document.getElementById('GPmousePositionAlt-' + this._uid);
                        div.innerHTML = 'No rights!';
                    } else {
                        div = document.getElementById('GPmousePositionAltitude-' + this._uid);
                        div.style.display = '';
                    }
                }
            };
            MousePosition.prototype._setCoordinatesPanel = function (active) {
                var div = document.getElementById('GPmousePositionCoordinate-' + this._uid);
                if (!active) {
                    div.style.display = 'none';
                } else {
                    div.style.display = '';
                }
            };
            MousePosition.prototype._setSettingsPanel = function (active) {
                var divPicto = document.getElementById('GPshowMousePositionSettingsPicto-' + this._uid);
                var divPanel = document.getElementById('GPmousePositionSettings-' + this._uid);
                if (!active) {
                    divPicto.style.display = 'none';
                    divPanel.style.display = 'none';
                } else {
                    divPicto.style.display = '';
                    divPanel.style.display = '';
                }
            };
            MousePosition.prototype._setTypeUnitsPanel = function (type) {
                var container = this._projectionUnitsContainer;
                while (container.firstChild) {
                    container.removeChild(container.firstChild);
                }
                var units = this._projectionUnits[type];
                for (var j = 0; j < units.length; j++) {
                    var obj = units[j];
                    var option = document.createElement('option');
                    option.value = obj.code ? obj.code : j;
                    option.text = obj.label || j;
                    container.appendChild(option);
                }
                var projectionUnits = this._projectionUnits[type][0].code;
                if (this._currentProjectionUnits === 'DMS' || projectionUnits === 'DMS') {
                    this._resetCoordinateElements(this.options.editCoordinates, type, projectionUnits);
                    this._setEditMode(this.editing);
                }
                this._currentProjectionType = type;
                this._resetLabelElements(type);
                this._resetUnitElements(projectionUnits);
                this._currentProjectionUnits = projectionUnits;
            };
            MousePosition.prototype._displayDEC = function (olCoordinate) {
                var coordinate = {};
                coordinate.lat = olCoordinate[1].toFixed(6);
                coordinate.lng = olCoordinate[0].toFixed(6);
                coordinate.unit = '\xB0';
                return coordinate;
            };
            MousePosition.prototype._displayDMS = function (olCoordinate) {
                return {
                    lng: _MathUtils2.default.decimalToDMS(olCoordinate[0], 'EO', 2),
                    lat: _MathUtils2.default.decimalToDMS(olCoordinate[1], 'NS', 2),
                    unit: 'DMS'
                };
            };
            MousePosition.prototype._displayRAD = function (olCoordinate) {
                var coordinate = {};
                var d = 0.017453292519943295;
                coordinate.lng = olCoordinate[0] * d;
                coordinate.lng = coordinate.lng.toFixed(8);
                coordinate.lat = olCoordinate[1] * d;
                coordinate.lat = coordinate.lat.toFixed(8);
                coordinate.unit = 'rad';
                return coordinate;
            };
            MousePosition.prototype._displayGON = function (olCoordinate) {
                var coordinate = {};
                var d = 1.1111111111111112;
                coordinate.lng = olCoordinate[0] * d;
                coordinate.lng = coordinate.lng.toFixed(8);
                coordinate.lat = olCoordinate[1] * d;
                coordinate.lat = coordinate.lat.toFixed(8);
                coordinate.unit = 'gon';
                return coordinate;
            };
            MousePosition.prototype._displayMeter = function (olCoordinate) {
                var coordinate = {};
                coordinate.x = olCoordinate[0].toFixed(2);
                coordinate.y = olCoordinate[1].toFixed(2);
                coordinate.unit = 'm';
                return coordinate;
            };
            MousePosition.prototype._displayKMeter = function (olCoordinate) {
                var coordinate = {};
                coordinate.x = (olCoordinate[0] / 1000).toFixed(2);
                coordinate.y = (olCoordinate[1] / 1000).toFixed(2);
                coordinate.unit = 'km';
                return coordinate;
            };
            MousePosition.prototype._setCoordinate = function (olCoordinate, crs) {
                var coordinate = {};
                var oSrs = this._currentProjectionSystems.crs;
                if (!oSrs) {
                    console.log('ERROR : system crs not found');
                    return;
                }
                olCoordinate = _ol2.default.proj.transform(olCoordinate, crs, oSrs);
                var type = this._currentProjectionSystems.type;
                var format = null;
                var units = this._projectionUnits[type];
                for (var i = 0; i < units.length; i++) {
                    if (units[i].code === this._currentProjectionUnits) {
                        format = units[i].format;
                        break;
                    }
                }
                if (!format || typeof format !== 'function') {
                    console.log('WARNING : coordinates format function not found');
                    return;
                } else {
                    coordinate = format(olCoordinate);
                }
                if (!coordinate || Object.keys(coordinate).length === 0) {
                    return;
                }
                this.GPdisplayCoords(coordinate);
            };
            MousePosition.prototype._setElevation = function (olCoordinate) {
                var delay = this.options.altitude.responseDelay;
                var noDataValue = this.options.altitude.noDataValue;
                var noDataValueTolerance = this.options.altitude.noDataValueTolerance;
                this.GPdisplayElevation(olCoordinate, delay, noDataValue, noDataValueTolerance);
            };
            MousePosition.prototype.onMoveStopped = function (olCoordinate, crs) {
                var oLatLng = _ol2.default.proj.transform(olCoordinate, crs, 'EPSG:4326');
                this._setElevation(oLatLng);
            };
            MousePosition.prototype.onMouseMove = function (e) {
                var self = this;
                var coordinate = e.coordinate;
                if (!e.map || !e.map.getView()) {
                    return;
                }
                var crs = e.map.getView().getProjection();
                this._setCoordinate(coordinate, crs);
                clearTimeout(this._timer);
                this._timer = setTimeout(function () {
                    self.onMoveStopped(coordinate, crs);
                }, this.options.altitude.triggerDelay);
            };
            MousePosition.prototype.onMapMove = function () {
                var self = this;
                var map = this.getMap();
                if (!map || !map.getView()) {
                    return;
                }
                var view = map.getView();
                var coordinate = view.getCenter();
                var crs = view.getProjection();
                this._setCoordinate(coordinate, crs);
                clearTimeout(this._timer);
                this._timer = setTimeout(function () {
                    self.onMoveStopped(coordinate, crs);
                }, this.options.altitude.triggerDelay);
            };
            MousePosition.prototype.onRequestAltitude = function (coordinate, callback) {
                if (!coordinate || Object.keys(coordinate).length === 0) {
                    return;
                }
                if (!this.options.displayAltitude) {
                    return;
                }
                if (this._noRightManagement) {
                    console.log('[WARNING] contract key configuration has no rights to load geoportal elevation ');
                    document.getElementById('GPmousePositionAlt-' + this._uid).innerHTML = 'No rights!';
                    return;
                }
                var options = this.options.altitude.serviceOptions || {};
                var _protocol = options.protocol || 'XHR';
                var _timeout = options.timeOut || 0;
                if (_protocol === 'JSONP' && _timeout === 0) {
                    _timeout = 15000;
                }
                var _zonly = true;
                var _positions = [{
                        lon: coordinate[0],
                        lat: coordinate[1]
                    }];
                var _scope = this;
                var _rawResponse = options.rawResponse || false;
                var _onSuccess = null;
                var _onFailure = null;
                if (!_rawResponse) {
                    _onSuccess = function _onSuccess(results) {
                        if (results && Object.keys(results)) {
                            callback.call(this, results.elevations[0].z);
                        }
                    };
                } else {
                    _onSuccess = function _onSuccess(results) {
                        console.log('alti service raw response : ', results);
                    };
                }
                _onFailure = function _onFailure(error) {
                    console.log('[getAltitude] ERROR : ' + error.message);
                };
                var _apiKey = options.apiKey || this.options.apiKey;
                _gp2.default.Services.getAltitude({
                    apiKey: _apiKey,
                    protocol: _protocol,
                    timeOut: _timeout,
                    scope: _scope,
                    rawResponse: _rawResponse,
                    onSuccess: _onSuccess,
                    onFailure: _onFailure,
                    zonly: _zonly,
                    positions: _positions
                });
            };
            MousePosition.prototype.onShowMousePositionClick = function () {
                var map = this.getMap();
                this.collapsed = this._showMousePositionContainer.checked;
                this.dispatchEvent('change:collapsed');
                if (this._showMousePositionContainer.checked) {
                    if (this._isDesktop) {
                        map.un('pointermove', this.onMouseMove, this);
                    } else {
                        map.un('moveend', this.onMapMove, this);
                    }
                } else if (!this.editing) {
                    if (this._isDesktop) {
                        map.on('pointermove', this.onMouseMove, this);
                    } else {
                        map.on('moveend', this.onMapMove, this);
                        this.onMapMove();
                    }
                }
                this._setElevationPanel(this.options.displayAltitude);
                this._setCoordinatesPanel(this.options.displayCoordinates);
                if (!this.options.displayCoordinates) {
                    this._setSettingsPanel(false);
                }
            };
            MousePosition.prototype.onMousePositionEditModeClick = function (editing) {
                if (!this.options.editCoordinates) {
                    return;
                }
                if (this.editing === editing) {
                    return;
                }
                this.editing = editing;
                this._setEditMode(this.editing);
                var map = this.getMap();
                if (this._isDesktop) {
                    if (this.editing) {
                        map.un('pointermove', this.onMouseMove, this);
                    } else {
                        map.on('pointermove', this.onMouseMove, this);
                        this.onMapMove();
                    }
                } else {
                    if (this.editing) {
                        map.un('moveend', this.onMapMove, this);
                    } else {
                        map.on('moveend', this.onMapMove, this);
                        this.onMapMove();
                    }
                }
                if (!this.editing && this._markerOverlay) {
                    this._markerOverlay.setPosition(undefined);
                }
            };
            MousePosition.prototype.getCoordinate = function (coordType) {
                var inputDegrees = document.getElementById(this._addUID('GPmousePosition' + coordType + 'Degrees'));
                var degrees = inputDegrees.value;
                if (!degrees) {
                    return null;
                }
                degrees = degrees.replace(',', '.');
                if (!_MathUtils2.default.isInteger(degrees)) {
                    return null;
                }
                var result = _MathUtils2.default.toInteger(degrees);
                if (result < Number(inputDegrees.dataset.min) || result > Number(inputDegrees.dataset.max)) {
                    return null;
                }
                var direction = document.getElementById(this._addUID('GPmousePosition' + coordType + 'Direction')).value;
                var inputMinutes = document.getElementById(this._addUID('GPmousePosition' + coordType + 'Minutes'));
                var minutes = inputMinutes.value;
                if (minutes) {
                    minutes = minutes.replace(',', '.');
                    if (_MathUtils2.default.isInteger(minutes)) {
                        var mins = _MathUtils2.default.toInteger(minutes);
                        if (mins >= Number(inputMinutes.dataset.min) && mins <= Number(inputMinutes.dataset.max)) {
                            result += mins / 60;
                        }
                    }
                }
                var inputSeconds = document.getElementById(this._addUID('GPmousePosition' + coordType + 'Seconds'));
                var seconds = inputSeconds.value;
                if (seconds) {
                    seconds = seconds.replace(',', '.');
                    var secs = _MathUtils2.default.toFloat(seconds);
                    if (secs && secs >= Number(inputSeconds.dataset.min) && secs <= Number(inputSeconds.dataset.max)) {
                        result += secs / 3600;
                    }
                }
                if (direction === 'O' || direction === 'S') {
                    result = -result;
                }
                return result;
            };
            MousePosition.prototype.locateDMSCoordinates = function () {
                var lonlat = [
                    this.getCoordinate('Lon'),
                    this.getCoordinate('Lat')
                ];
                if (lonlat[0] === null || lonlat[1] === null) {
                    return;
                }
                var oSrs = this._currentProjectionSystems.crs;
                if (!oSrs) {
                    console.log('ERROR : system crs not found');
                    return;
                }
                var view = this.getMap().getView();
                var coordinate = _ol2.default.proj.transform(lonlat, oSrs, view.getProjection());
                view.setCenter(coordinate);
                if (this._markerOverlay && !this._hideMarker) {
                    this._markerOverlay.setPosition(coordinate);
                }
            };
            MousePosition.prototype.locateCoordinates = function () {
                var lon = document.getElementById(this._addUID('GPmousePositionLon')).value;
                lon = lon.replace(',', '.');
                lon = _MathUtils2.default.toFloat(lon);
                if (lon === null) {
                    return;
                }
                var lat = document.getElementById(this._addUID('GPmousePositionLat')).value;
                lat = lat.replace(',', '.');
                lat = _MathUtils2.default.toFloat(lat);
                if (lat === null) {
                    return;
                }
                var oSrs = this._currentProjectionSystems.crs;
                if (!oSrs) {
                    console.log('ERROR : system crs not found');
                    return;
                }
                var xy;
                if (this._currentProjectionSystems.type === 'Geographical') {
                    xy = [
                        this.convert(lon),
                        this.convert(lat)
                    ];
                } else {
                    xy = [
                        this.convert(lat),
                        this.convert(lon)
                    ];
                }
                var xyWGS84 = _ol2.default.proj.transform(xy, this._currentProjectionSystems.crs, 'EPSG:4326');
                var geoBBox = this._currentProjectionSystems.geoBBox;
                if (geoBBox) {
                    var extent = [
                        geoBBox.left,
                        geoBBox.bottom,
                        geoBBox.right,
                        geoBBox.top
                    ];
                    if (xyWGS84[0] < extent[0] || xyWGS84[0] > extent[2]) {
                        return;
                    }
                    if (xyWGS84[1] < extent[1] || xyWGS84[1] > extent[3]) {
                        return;
                    }
                }
                var view = this.getMap().getView();
                var coordinate = _ol2.default.proj.transform(xy, oSrs, view.getProjection());
                view.setCenter(coordinate);
                if (this._markerOverlay && !this._hideMarker) {
                    this._markerOverlay.setPosition(coordinate);
                }
            };
            MousePosition.prototype.onMousePositionEditModeLocateClick = function () {
                if (!this.options.editCoordinates) {
                    return;
                }
                if (!this.editing) {
                    this.onMousePositionEditModeClick(true);
                    return;
                }
                if (this._currentProjectionUnits === 'DMS') {
                    this.locateDMSCoordinates();
                } else {
                    this.locateCoordinates();
                }
            };
            MousePosition.prototype.onMousePositionProjectionSystemChange = function (e) {
                var idx = e.target.selectedIndex;
                var value = e.target.options[idx].value;
                this._setCurrentSystem(value);
            };
            MousePosition.prototype._setCurrentSystem = function (systemCode) {
                var type = null;
                for (var i = 0; i < this._projectionSystems.length; ++i) {
                    if (this._projectionSystems[i].code == systemCode) {
                        type = this._projectionSystems[i].type;
                        break;
                    }
                }
                if (!type) {
                    logger.log('system not found in projection systems container');
                    return;
                }
                this._currentProjectionSystems = this._projectionSystems[Number(systemCode)];
                if (type !== this._currentProjectionType) {
                    this._setTypeUnitsPanel(type);
                }
                if (!this._isDesktop) {
                    this.onMapMove();
                }
            };
            MousePosition.prototype.onMousePositionProjectionSystemMouseOver = function (e) {
                logger.trace(e);
                var map = this.getMap();
                if (!map || !map.getView()) {
                    return;
                }
                var view = map.getView();
                var crs = view.getProjection();
                var mapExtent = view.calculateExtent(map.getSize());
                mapExtent = _ol2.default.proj.transformExtent(mapExtent, crs, 'EPSG:4326');
                var systemList = document.getElementById(this._addUID('GPmousePositionProjectionSystem'));
                systemList.innerHTML = '';
                for (var j = 0; j < this._projectionSystems.length; j++) {
                    var proj = this._projectionSystems[j];
                    var option = null;
                    if (proj.geoBBox) {
                        if (mapExtent[0] > proj.geoBBox.right || mapExtent[1] > proj.geoBBox.top || mapExtent[2] < proj.geoBBox.left || mapExtent[3] < proj.geoBBox.bottom) {
                            if (proj === this._currentProjectionSystems) {
                                option = document.createElement('option');
                                option.value = proj.code;
                                option.text = proj.label || j;
                                option.setAttribute('selected', 'selected');
                                option.setAttribute('disabled', 'disabled');
                                systemList.appendChild(option);
                            }
                            continue;
                        }
                    }
                    var optionElement = document.createElement('option');
                    optionElement.value = proj.code;
                    optionElement.text = proj.label || j;
                    if (proj === this._currentProjectionSystems) {
                        optionElement.setAttribute('selected', 'selected');
                    }
                    systemList.appendChild(optionElement);
                }
            };
            MousePosition.prototype.onMousePositionProjectionUnitsChange = function (e) {
                var idx = e.target.selectedIndex;
                var value = e.target.options[idx].value;
                var oldProjectionUnits = this._currentProjectionUnits;
                this._currentProjectionUnits = value;
                this._resetLabelElements(this._currentProjectionType);
                this._resetUnitElements(this._currentProjectionUnits);
                if (oldProjectionUnits === 'DMS' || this._currentProjectionUnits === 'DMS') {
                    this._resetCoordinateElements(this.options.editCoordinates, this._currentProjectionType, this._currentProjectionUnits);
                    this._setEditMode(this.editing);
                }
                if (!this._isDesktop) {
                    this.onMapMove();
                }
            };
            MousePosition.prototype.convert = function (value) {
                var result;
                if (this._currentProjectionUnits === 'M' || this._currentProjectionUnits === 'DEC') {
                    result = value;
                } else if (this._currentProjectionUnits === 'KM') {
                    result = value * 1000;
                } else if (this._currentProjectionUnits === 'RAD') {
                    var rd = (180 / Math.PI).toFixed(20);
                    result = (value * rd).toFixed(20);
                } else if (this._currentProjectionUnits === 'GON') {
                    var d = (9 / 10).toFixed(20);
                    result = (value * d).toFixed(20);
                }
                return result;
            };
            MousePosition.prototype.validateExtentCoordinate = function (coordType, value) {
                if ([
                        'Lon',
                        'Lat'
                    ].indexOf(coordType) === -1) {
                    return false;
                }
                var coord = value.replace(',', '.');
                coord = _MathUtils2.default.toFloat(coord);
                if (coord === null) {
                    return false;
                }
                coord = this.convert(coord);
                var geoBBox = this._currentProjectionSystems.geoBBox;
                if (geoBBox === undefined) {
                    return true;
                }
                var extent = [
                    geoBBox.left,
                    geoBBox.bottom,
                    geoBBox.right,
                    geoBBox.top
                ];
                extent = _ol2.default.proj.transformExtent(extent, 'EPSG:4326', this._currentProjectionSystems.crs);
                if (coordType === 'Lat' && (coord < extent[0] || coord > extent[2])) {
                    return false;
                }
                if (coordType === 'Lon' && (coord < extent[1] || coord > extent[3])) {
                    return false;
                }
                return true;
            };
            exports.default = MousePosition;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var MathUtils = {
                modulo: function modulo(a, b) {
                    var r = a % b;
                    return r * b < 0 ? r + b : r;
                },
                decimalToDMS: function decimalToDMS(degrees, hemispheres, numDigits) {
                    var normalizedDegrees = this.modulo(degrees + 180, 360) - 180;
                    var x = Math.abs(3600 * normalizedDegrees);
                    var dflPrecision = numDigits || 0;
                    var precision = Math.pow(10, dflPrecision);
                    var deg = Math.floor(x / 3600);
                    var min = Math.floor((x - deg * 3600) / 60);
                    var sec = x - deg * 3600 - min * 60;
                    sec = Math.ceil(sec * precision) / precision;
                    if (sec >= 60) {
                        sec = 0;
                        min += 1;
                    }
                    if (min >= 60) {
                        min = 0;
                        deg += 1;
                    }
                    var direction = hemispheres.charAt(normalizedDegrees < 0 ? 1 : 0);
                    return {
                        d: deg,
                        m: min,
                        s: sec,
                        direction: direction
                    };
                },
                toInteger: function toInteger(s, base) {
                    var _base = base || 10;
                    var n = parseInt(s, _base);
                    if (!isNaN(n) && isFinite(n)) {
                        return n;
                    }
                    return null;
                },
                isInteger: function isInteger(s) {
                    if (isNaN(s)) {
                        return false;
                    }
                    var v = parseFloat(s);
                    return (v | 0) === v;
                },
                toFloat: function toFloat(s) {
                    var n = parseFloat(s);
                    if (!isNaN(n) && isFinite(n)) {
                        return n;
                    }
                    return null;
                }
            };
            exports.default = MathUtils;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _Interactions = __webpack_require__(19);
            var _Interactions2 = _interopRequireDefault(_Interactions);
            var _DrawingDOM = __webpack_require__(97);
            var _DrawingDOM2 = _interopRequireDefault(_DrawingDOM);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _KML = __webpack_require__(18);
            var _KML2 = _interopRequireDefault(_KML);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('Drawing');
            function Drawing(options) {
                options = options || {};
                if (!(this instanceof Drawing)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this._initialize(options);
                var container = this._initContainer();
                _ol2.default.control.Control.call(this, {
                    element: container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(Drawing, _ol2.default.control.Control);
            Drawing.DefaultTools = {
                points: true,
                lines: true,
                polygons: true,
                text: true,
                remove: true,
                display: true,
                tooltip: true,
                edit: true,
                export: true,
                measure: false
            };
            Drawing.DefaultLabels = {
                control: 'Annoter la carte',
                creatingTools: 'Outils de création',
                points: 'Placer des points',
                lines: 'Dessiner des lignes',
                polygons: 'Dessiner des polygones',
                text: 'Ecrire sur la carte',
                editingTools: 'Outils d\'édition',
                edit: 'Editer les tracés',
                display: 'Modifier l\'apparence des objets',
                tooltip: 'Modifier les textes / infos-bulles',
                remove: 'Supprimer des objets',
                export: 'Exporter',
                exportTitle: 'Exporter en KML',
                applyToObject: 'Appliquer à l\'objet',
                saveDescription: 'Enregistrer',
                setAsDefault: 'Définir par défaut',
                strokeColor: 'Couleur du trait : ',
                strokeWidth: 'Epaisseur du trait : ',
                fillColor: 'Couleur de remplissage : ',
                fillOpacity: 'Opacité du remplissage : '
            };
            Drawing.DefaultStyles = {
                textFillColor: '#000000',
                textStrokeColor: '#FFFFFF',
                textIcon1x1: {
                    src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=',
                    anchor: [
                        0,
                        0
                    ]
                },
                polyFillColor: '#ffffff',
                polyFillOpacity: 0.4,
                polyStrokeColor: '#ffcc33',
                polyStrokeWidth: 4,
                strokeColor: '#ffcc33',
                strokeWidth: 4
            };
            Drawing.DefaultCursorStyle = {
                radius: 6,
                strokeColor: '#FFF',
                strokeWidth: 1,
                fillColor: 'rgba(0, 153, 255, 1)'
            };
            Drawing.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            Drawing.prototype.assign = function (source) {
                for (var prop in source) {
                    if (source.hasOwnProperty(prop)) {
                        this[prop] = source[prop];
                    }
                }
            };
            Drawing.prototype.assign(_DrawingDOM2.default);
            Drawing.prototype.constructor = Drawing;
            Drawing.prototype.setMap = function (map) {
                _ol2.default.control.Control.prototype.setMap.call(this, map);
                if (this.getMap() && this.eventKey) {
                    _ol2.default.Observable.unByKey(this.eventKey);
                }
                if (map == null) {
                    return;
                }
                if (!this.collapsed) {
                    var inputShow = document.getElementById(this._addUID('GPshowDrawing'));
                    inputShow.checked = 'checked';
                }
                if (this.layer) {
                    this.setLayer(this.layer);
                }
                this.eventKey = this.getMap().getLayers().on('remove', function (evtRm) {
                    if (evtRm.element == this.layer) {
                        this.layer = null;
                        if (this.interactionCurrent) {
                            this.getMap().removeInteraction(this.interactionCurrent);
                            this.interactionCurrent = null;
                        }
                    }
                }, this);
            };
            Drawing.prototype.exportFeatures = function () {
                var result = null;
                if (_ol2.default.control.Control.prototype.getMap.call(this) == null) {
                    console.log('Impossible to export : control isn\'t attached to any map.');
                    return result;
                }
                if (!this.layer) {
                    console.log('Impossible to export : no layer is hosting features.');
                    return result;
                }
                if (!this.layer.getSource() || !this.layer.getSource().getFeatures() || !this.layer.getSource().getFeatures().length) {
                    console.log('Impossible to export : no features found.');
                    return result;
                }
                var featProj = this.layer.getSource().getProjection();
                featProj = featProj || this.getMap().getView().getProjection();
                var kmlFormat = new _KML2.default({ writeStyles: true });
                result = kmlFormat.writeFeatures(this.layer.getSource().getFeatures(), {
                    dataProjection: 'EPSG:4326',
                    featureProjection: featProj
                });
                return result;
            };
            Drawing.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] Drawing:setCollapsed - missing collapsed parameter');
                    return;
                }
                if (collapsed && this.collapsed || !collapsed && !this.collapsed) {
                    return;
                }
                this.onShowDrawingClick();
                this._showDrawingContainer.checked = !collapsed;
            };
            Drawing.prototype.setExportName = function (name) {
                this._exportName = name;
            };
            Drawing.prototype.getExportName = function () {
                return this._exportName;
            };
            Drawing.prototype._getsMarkersOptionsFromSrc = function (src) {
                var markerOptions = null;
                for (var i = 0; i < this.options.markersList.length; i++) {
                    if (this.options.markersList[i].src == src) {
                        markerOptions = this.options.markersList[i];
                        return markerOptions;
                    }
                }
                return markerOptions;
            };
            Drawing.prototype._getIconStyleOptions = function (markerElement) {
                var iconOptions = {};
                Object.keys(markerElement).forEach(function (key) {
                    switch (key) {
                    case 'src':
                    case 'size':
                    case 'anchor':
                    case 'anchorOrigin':
                    case 'anchorXUnits':
                    case 'anchorYUnits':
                        iconOptions[key] = markerElement[key];
                        break;
                    }
                }, this);
                return iconOptions;
            };
            Drawing.prototype._initialize = function (options) {
                this._uid = _SelectorID2.default.generate();
                this._exportName = 'Croquis';
                this._exportFormat = '.kml';
                this.options = options || {};
                if (!this.options.tools) {
                    this.options.tools = {};
                }
                Object.keys(Drawing.DefaultTools).forEach(function (key) {
                    if (!this.options.tools.hasOwnProperty(key)) {
                        this.options.tools[key] = Drawing.DefaultTools[key];
                    }
                }, this);
                if (!this.options.cursorStyle) {
                    this.options.cursorStyle = {};
                }
                Object.keys(Drawing.DefaultCursorStyle).forEach(function (key) {
                    if (!this.options.cursorStyle.hasOwnProperty(key)) {
                        this.options.cursorStyle[key] = Drawing.DefaultCursorStyle[key];
                    }
                }, this);
                this.options.collapsed = options.collapsed !== undefined ? options.collapsed : true;
                this.collapsed = this.options.collapsed;
                this.options.markersList = options.markersList || [
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARfSURBVFiF3ZhfbBRVGMV/d2Z3212tbSkCbuNaqzaRiL6QyAMPjSFoYqgx4oOiRmMFUzQG479o2lQ0QXk1EhYFgmlD2mIRkYhRwqLEaA2GiKWV7rZLQ0sLwbZId7t/Zq4PFK1125m5s/vCedz7nXO+M9/N3jsD1xFEvgXlTkrI8hBQBywFbgEqgEvAMHAayZcYHBYbuZJP77yFkdsoR+ct4GXAb4OSQPARXj4QzzGejx7yEkZuZy2CMLBAgf4nkhfEi3S67UNzQ5YSIXfQhKAdtSAACxDsk2EapXT3cF2FYQdNSN7F/YQFsJkw77gVUcL01mp3o5EDJoK1Yj37VchKjcjdlJEmhvrWmg9jGNwhGhhzSlTbZmnepjBBAMrReF2F6Hgy0+fIKPb+flWRIMtip+eQ88lcPRCtg3gCCVZ3RqhPDbJepqlPDbJ6XwSvP2nDJYCXB522prLN6iwrPIEETw33U/VoLZovBPjQfCGqHqtl3XDUZiBrn1lQCXO3ZcUDLV34Su/JueYrW0btnp8tNSRLnTamEiZoWRF6uHre9dseuT0vPrOgEqbCWtW3xNX6VSy02c+/sk4JwF+WFWZ6xGL9vA2fyzb7+QcqYUYtKwYP9s+7PrA/bsNn/geSA87DSLosa44+fT/p8VM511Jjp4g8u8KGk7XPLKhM5qhlRSbppzV4JwMdEcz0WSCNmT5LrC1CS/AujKliSw1BxGljzm8AH3MjHs4BpU65DjCBn0rxDJNOSI4nM33F2O2U58yEnU6DgOpF02AzcEGJa40LZHlfhagUZvp6vkmFawObVK7/4PLFSoZpBZ50ozEThsne6i2hjZqmFRVJ6U8JUeSVUmQNzQvg0c1MVtNMIUTSl0pNLhsaGu8A4xrfbZhS4CRQ5SoFcCWtja/5NBg+N+GZsu0vhSEkcY8mf+iNx+OuX3llmJVABNCVNUA2fl3xWdvJkriqRBb2uPugAYgNHEey1Y3Gt3/ccNxFEAChm2al6zAAjNAEWF/rc1Ev6+ffOLTwmBt7E0xD02J5CSOayQLrsHMJnYGMITJvHrr588mUMKyr54CUaaHrnfF4fCQ/kwHEBmLAa044rb+WHP4xXnxJ0VJK6CkyjO2xWOx3KMSH8zDtwONWdb2jvt41u4JtChZJKeVveDwnYrHYfw5uj4KYFRpSWbGqyCPL5ypIpMTkKwcWfWVXUEqRRcio1LTuUCjUE4lEsrnq8j4ZgKEP9bpgmfHFHPpyy3fle3f9Uto3n4aUIqNhDghN6zZ1vTcajaasfAsSBmBwq7f11tLM/24Hx2L+n+rbF38zBy2JEP0anPEGAj3d3d1pJ56F2GYAGInM82M+bWW53wxd++3ipH7x1QMLj8ysk5BAyj6Ppp2+d/nyaEdHh/I/W8EmA3Ci2b/iviVT3+tCerMmxkudiz450hcYBSYQIqrDmScGBvqawSxkH3lDV2Pxe6ltItnWcFNLTXX1qpqamkoK/BCvC/wNB+l5MdQKNHsAAAAASUVORK5CYII=',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAS7SURBVFiF3VhNTFxVFP7OfTNvOjMtM9AoJSSYEEVMCv6kJi5NoCa1TRqNxDTaFhcWNSmxaaxNQ0w3mqgLdGeRhKFYXVC7qDU2BhVt/YdqEQRhRgYTKD8VZqAMzM+7xwVCcIR58+6b2fRb3nO+853v3fvuu+8CtxEo1wX5pTu2IpasBfEeSFSCUAygCMAsgEkAQyD6DClXF3VMLeZSO2dmuN7vB+MYiBsAbDEn8BIIZ6BrzdQyF81FDzkxw8/594P5HQCFCvQ5QDRSYO4Tu30IO2QGiA/5XgVzAGpGsMKTZ/mw7wTbfLi2yFzvOwngpJ0aaXidAtG3VcnKZv5dWgE7Nf5fFBJCHqK2hUsqdKVG+EihDwn5K9SXViZEAHqAApGIVaLaO5Pg48iPEQDwg2WjCtHyzKx8RxJBZLP9qoJ5CdJ9t9XvkPWZiSVrkY0R3b2MxnM9aJ2Ooi3iRut0FEc/6IHuiZtyidwQ8RqrrVk3Q7zHNEd3L6N5eAYP7q2BppcB0KHpZXhoXw2aB6eyM8SPW23NuhnGvaY5L7T2w7Nt54Yxj68KDS19WSiZ66RBZQPYYZpRvfuejPH7H8scX0FJlv2sQcVMkWmGpmc2bBbPVicNKsvslmmOkZg0id/IQmkhy47WoLABYNo05/rnIxnjv1wOmtbgLHTSoDIz10xzzhypQiz624axWLQPLQ3V5kLUa7U1la35G9OcRMyFY/cV49qlLhiJMQAJGIkx9FzswsuVO5BccpnryKuWW7NK4IPFXmjLgwAKrHItYB66t5JaJmJWSJZnhjqmFiFxzirPIjqsGgFUD5qC3gRjRolrBsYMQEr/NEpmKBCJgHBKhWteHKdUjv8rVBvgw773QaizU2M9DMb58q98rwghXC5md5zI5WSmlCGcAODQZDIlhCSiJT0eX6waH490AsYq356ZZ4oK4DSuAihT4UuGYIaQILGQ4vknen2BibhYzlqfySBG2CH4ylA4HLb9y8v1BY8A9CkAzVwcZDA0BgkG0+oFBjP49Ij3o48n9b9U20gB7bZuZwCAAvM/gPndTDmSIZKS9CRDNwCHBIv1NzFdfzu/t2EEAEiTstS2GQDA2PwbAHrSh9ebSDewihtxMdn0h/dbO/ISkIYQoZyYoW6kYOD59YdQg8mRYjgleFONpKRk07D34qJBxmY5pmBOkKZdCIfDk7mZGQDUER0FUROwaoQdZpd6H07oXT/OOWYVJZmBQZdhvBcKhfqBfFyc1xcEEpKeNjMytOgYfqp32wUFiSVm7oPD0RsKhf5zsnYoFMsMyccTUtvtFHL7ZimxFC2eGPJezrYkM6VAHGQhBsrKyga7u7tTG+XlfGYAIFxXuLfEzZ288fvCb4U858+Ou0KZajBTUkCOkhADUtOGgsGg6SVIXswAQKiuqK3UbRxIH78yq//8Yr/3i01oSyD6UwDDTo9ncGBgIGFFM29mRh/FFm+J/3qBk+9aHbsZFzf39WwN3DK0tWXCQAzMIw4hfq/etSvY2dmpvLPlzQwA/PTk9od3eowvhWCnZEodHfC2fz3rnAEQBVFQA4YPjI6OnAZkPvvIGb7bX/Ta/LP+SEftne0V5eW1FRUVpcjzQ7wt8A+9at5zXMB2DQAAAABJRU5ErkJggg==',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAP0SURBVFiF3ZnLbxtVFIe/e8eOPU5DapI2whEWyiILJGDTBQuWSGTTSkVlQRGs2MGSh4RoQWLB4x/gpVIViNokJUV0U4RQXKgQr0ookCYkdjONSJtQJTGltjO2Zw6LJlEbkszLTgQ/6Ww859xzPt97556Zgf+RVKMHFGgD+oADwP3APUAHsABcBS4BXwDnFNxsdP6GSCAt8LZAWUB8WEngLYHdO137HRI4JLDgE2K9LQg8vtMMCCiBowJuSJBVcwWOSBOWfRCY1yJCrLdXdwrkUANmZL05Age3G2R3hD3iZYsC6TB16ZA8rwB3h4z1Uhp4MUxg4A23co7MA2aYhD5VBrqCnkNhZqYPPyCpVJnh4Ry2PYNIFdue4fTpHKZZ8ZEjBTwWorZgEvjEc92nUiUpFn+VjbS0NCqm6edgPbEdMD97FjI8PLIhyKoGB0d8wPy0HTBXPQux7Stbwti25QNmNmhtYW4ANtCytZNUPXxslEp4pKoq8PK5Q2FuAH97elSrcx7Xr/nIc8NnPWsKAzPv6XH27OUtr585Y/nIs/Uf0ggJHPdc76ZZlqWl0Q33y+LiqCSTFR975th2wDzjqy0xzbIMDo6IbVsiYottW3Lq1IhPEBF4ejtgdgkUm9SXrVpRoDVobYH3zEqLcTxoXEAdU1Bqco5bkluPyPNNmpV5Cdk1RwE63CSYw2FrivSYKtBPhOTr5cDJnmz2Oa11IiFi2kol4iKq7ug4QMxwa3WtXaVUpcW2Sw/MzhaHwFmNjwrTDvwC3BeJAripdXF/JvP+H7HYsu/8ohwlWDEt305YlhX5BYLAI0AOMCKMIUc6Oj4eaGuzwg5RhxNhnzTXpOAC8E6UMb5qbb0QAQRAGa7bHRlmRUeBH8IEzhnGtZc6O89HSe6C62hdaAiMgjrwFH6a0NtUU6r28p49n5WUcry9N5FIVRnGsGVZc42aGRQUgBeCxPS3tZ37LplcCJlSBMYTjvNeoVD4baWGxkpgEHjCy2+ipWVifyYzECJFRURGicUuFgqFP2+/0AyYTlupyYTIpqd4WanSwe7udy/HYr5aFhFVR0letB7LZrPjuVyuvpFfU97tzhrGgYzjfL7J+PJmOn3yo/b2qa3GEFE1jTuttB5zDWMin8/bXnmb9qJ6Jh7vv7dW+1d3cN40v3+2q+vLTcIqKHVZw2Q8lRofGxurBsnZNJhpSLZr/XvadbOrv103jOt9mcwHNwxjbZkIlBGZiml96cF9+/JDQ0Oh72xN/YRw0TQffmh5+RtDJF4H5/m9ez/8OpWaB/5CqbwBk09OT0+9Dm4z62iYfkwm37CVqgzsuuvT3p6eR3t7e7vZye8w/xX9A0ynxee2hlfFAAAAAElFTkSuQmCC',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASKSURBVFiF3ZhdbBRVHMV/9+5uPwikFExEiCtWbSKCCEsCiU1EJIEXeMIHxZgYPzBUYzB+RUPlwwTl1UhYFIiGhrQVFCMRAoQFidGaEgIuVLrbLgSkhWBb2N3uzs7M3weBILadnZndF87j3P8553/m3ty5c+Eugiq1oDy5dRw5czGKpQjTgPuAicBV4C+E02j5gSFrn4o3pkvpXbIwMmNTLaHAByjeBKqLoGRBfY4V+lSdeGmgFD2UJIzM2bwMUVFgggf634i8qo6/vttvH9oPWRAlkS1NiGrFWxCACSj1rUSiqwXx9XJ9hWH2liaQtfifYQWsIxL9yK+IJ9xYWq1+NIaBjahl6vhr33khe2pEntg+noCRxPvSGg39GNZD6tTKfrdEb8ssaHxIeYIA1FKh3/VCdD0zN74jfRS3/XpFlpx5r9vvUNC1Tc5cTDFBqoJZ1i9opyFcR0hPomD3cvR8N02H55IvOPHHUB1aBOxy05r7ZaZY6lhTFcyy74Vunp46n5AOAxWEdJhnps5n//IElaEhRw0pwucOuA8jPOpYs35BO2Mrpg87NrZiBmvn/+aooWSa29a8bACTHSsawnWjjj/1wIOOGlKEzx3wEmaiY0VIT/I1/i/uKbKfW/AS5rpjRcHudRi/VITPtSL7uQUvYfocK46e7x51PNaTKsJn9BcyDDyEkXbHkqbDc0kbp4Ydu54/xcexec42OPvcAS9b82HHmnyhmkXND3OwJ0bBPgcYFOxzHEjGWLTjEQyryrkzFXPfmkvIY1+MpSp4Aahxy3WBQQrVU9TJFzNuSK5nRsUb0yi2u+W5dNnqNgh4PWjmrXXAZU9cZ1zGMD/xQvQU5sbxfJUXbhFY5eX4Dz5/rCQSbQae96NxOyzsnXVXNjRqrSsrRarzSlWGRJRp6RBAMGAXTK1tpdRQRT6fmXHx4kAbWDf5fsPUACeAqb5SAGkxBpYMfBW9YA/mivYXZSkhFdTyc2cqlfL9yyuRaAMQAwKeNUBWZ376piV3IuVVwoSv/V1oAKpjxTGQjX40Dhh/HvMRBEAFbHuK7zAAjOttApyP9cOg17526b303iN+7G2wLa2TJQmjYmtMYDnFHEJvQwGr8H5m766M5C3n6hEgYqhAYHcqleotzcwAqmNFEuEdN5zm3PF9vxipqx4tReBMpWVtTiaTf0A5Ls4j0VbgWae6TrOvc8ngthYPFkMicpJgsCOZTP7nw+3+QsMZK/NiLqxUwdqRCrJ2PvNWes+PxQqKKBMlCdE6Hg6Hz8RiMXO4upLPDMDFWZ8tnazHfz+CvmzIHNy5Lfd712gaIqqgsXuU1nE7EOhMJBJ5J9+yhAE4P2tj8/265n+ngyNG8tdXrrfuH4E2hFLdGs6Gxow5E4/HDTee5VhmAFj92Zf7J1Q01Krq8M1nV+zMlbfTew7dXieQRaQrqPXpx+fMSbS1tXne2co2MwAds9fMm6kmHQ2gQia29ca13V8eKnT1AYMolQjA2ed6errWgF3OPkqG9pmr1+cjm4ZapjfuqK+rW1hfXz+FMr/EuwL/AGOdsbn1H7gQAAAAAElFTkSuQmCC',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATNSURBVFiF3VhZTFxlFP7Of+8Mi12Eot2Sia36IIJCIWmT0lhSK30wfaoaNcampBhrfGhSl5hIW9HE5VFTpWilNpUI0hrTh1YwjJSkthFEcABhBoZ0YekCFGa72/FBSLAF7jY86Pc453znO9/9//nvuT/wPwIlu2DLns1Lo3J8hwDtZHA2gNUAVgC4SYRrzNxFJH6UpNjZ4iOBqWRqJ83MmVdzM7y6520CvQ4gzQIlSoxPJVX/sLi6fTwZPSTFTOMrhbuYuRJApgP6LRDv3V7ZdsptH8INmQH6aW9BOTPXwpkRAMgE0/eNZQXvssuHK7khF5VtOEhEh+F+hQlAcX/hGu1E61CzmyKOML21at3UmAMGM+96qqrttBOyo0aadufdq3mlEJxvrXlBwFhcUh58+vPOMbtcR/8ZzSu/g0UwAgAMZHgN7xtOuLZXpmXP5qUxOT4Ca8evU0RlOb7S7ntItq8S30EWjEje1GhOacWlrNyi9SR5VrGuDo92NPd3HSvfqCsJM366pqaVAKi305vtbSZAO81yJG9qdMsnZ/vvyyveSpLHB8BLkse3Mn/b1i0fnQtK3pSYuRKb6tzdm10QP2KWklNacUlOXZIzV0xOX5KbvfvwRXMdyrbbmm0zzFhjlpOVW7R+ofj9eU+ss6BkqnMnnJxmK8wSSPKschOfRpbljqbhxMykWQLr6rBJfMiCzm3LHU3DiZkRs4TRjub+BeO/+8MWdBZ8IHPBthkiXDLL6TpWvlGLTnXOFVOjk52B6oObzJXYVOdO2D8AQE1mObqSSDv/VslDI62NftbVQQAK6+rgyG8N/vNvljxsqEqqqQ4Lv93ebE8ATfseXaJpqVcALLfLtYEJI6auLTnREbFDsr0y/4wY9LVdnh0w4yu7RgCHg2ZCSrwHYNQJ1wJGFVl53wnRkZnp8Xy/E64F7Hcy/gMuP6waygpOAnjBTY3Z0Bk1ZeeuvyaESElhTksQpXiYSdOFBwBkyVA1IQwiinkTiUju1avjdYA+w3drZjkB7Qw84NIH4hqPV1wYr7wVM+JWOcykEyMsCz7fEw6HXX/yNpQVFAHww819AoNP9kS+abkcDzutoAHHXd3OAMD2o60tTPjYTY3260qLCyMAQJJhrHVtBgA8q5eWAzAf6+fAeNwYqu6c+sWNvgEYuhChpJgpPuTXBPAiLAyhs6Ez1ONdkfqEzrp59jxgVkiSToXD4eGkmAGAbUdbQ0R8wA7Hfzl+tueGctOhJDPQnaLrX4RCoT+BRbg4bywrqGXgGbO8K5NazwcXJr5zIBFj5g7IcmsoFPrXi9v2hYYZJGBfzOAnPYIy5stJaEbky86pM1ZrMpMG4iALEfD5fN1+v1+bKy/pKwMAtS/n78xIET/MU5/r/4rUNA7G+xaqwUyqgDFAQgQMSeoJBoMJM91FMQMANS/ln8xKE3dNB4Ebyq+ftU2em4cWA1G/AHo96endgUBAsaOZ9G02g7g0VhpRMovu8ZJv5rcJxbh+rHPq59l5DETB3CcL0fVYYWGwrq7O8cm2aCsDAFXPbdjkW0bNguDRDehV7ber/rihjgCYAFFQAnqfHxjoOwQYydBbVDMAcOTZxyvWLZMPXBxS6r/tjlRDlrt7e3uvAeDF1v5P42/pFun0pc2xBwAAAABJRU5ErkJggg==',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARrSURBVFiF3ZhNbFRVFMd/985H26m1VEoL0zj0Ayqi6IZElpiQ2MSgIeJCDZGFuEEXJH4bG9QN6spoImiMIaExbREEYoIxhgEb1CZNjFg6lHnTacNHW8QW7Mx0pjPvuKDVprR9X1MX/Jfvnv/5n/89N++d++AOgip2QolRQZAWhCeA9cAqYDlwHbiCcB7NcTKcVA8wUUztopmRQarI8wbwMlBmg5IGPkGzTzUwXowaimJGEmxHOADc44L+F7BLNXHEax3aC1kEJQatCB24M8I077DEeUfE2+Z6MkOCVuBdvHdYoXgPg7e9JXGJ6aPV4SXHPDARtqs1HHVDdlWIDLAMEwP3R2sxjOGnSa1mzCnR3TET3mJpjABUkedVN0THnZEYFQQYwd7r1y3STFLr9DvkvDNBWrBjRIfS1B6J0pAdolFyNGSHqD0cRZVlbKiEKOUxp6U5N3Pry26RNZRm9ZUE5ds2o4IRIIgKRih/ajOrr8RtGVI2dObKOiUA91tGrDjUjap8cH7FZRuoOfirZQ5hvdPC3JgJW0aEHm9cfP3JBsscYkNnDtyYWW4ZoYIrPa0DKKptVzQN52YUf1vGSG548YDcVRtKN+0V9B/cvABGLGPSJxKLrqeOJm0oWWzI7XBzzLotI0Z3PII5fm7eNXPsHKM7NxVFZw7cdOaUdUymjMHwGlKdUSQ3COSQ3CCp9iiD4bXIZKllDkXUaWnOJ4Be7qKUS0ClU64D3KCcOrWSlBOS485MjxhfOeU5xJdOjYDbqfnWFTkG1LjhW2AUP+v+t6l5WmiPG64N7HFjBDxerMSgDXjWS47ZKBT4unFLZLfWuqREpCyrVElAROULOgDg95lTea1NpVQmmM2mNly+PN4JhRm+VzOVwG9AvScXwERaj2/dFT5wadg/aVtfVEEJSb+Wn2LJZNLTPwDVxA1gB7N2xw1EkH37q445MQKglPjQ0pSH5+vr6+u9/dAAVBNdwIdecvzQVd7V/l1F0ksZPtOs82wGgCFaAeuxfh4MX/Ndfe2D6tNe5E0wC1obRTGjHiWPyXNgYwidhakpNfX6Ryu+SWWU+2MqklM+35FkMjlcnM4Aai0GwitOOG0nKk6e7Sm97lJSBPpKCoX9hmH8AUvx49ygA3jaKi5mBGNbXwy3u5DIiMjv+P09hmGMzl4ovpkLVGcLqr+kRKoWikmnVWrb7rrPEkN+WyOLiMqjJC5a90Yikb5oNJqfL87vtuiFoO7jz8s/653hmsK3zL9Z8vHBZcesjIioKY05oLTuNf2+WDwezwIkEgtflYremRkMdQXa7l01ddt0cLq77JcX3qz9fgFaBqUSGvoDoVBfb29vzonmkpkZOEVpZaW+UFVpRmaeXRvzXWvZGf785oTv32MikEbkol/r8w9t3Bjv7Ox0/WZbMjMAPcfLNj28bvKMzyeBfIHCS3trvvjxbGgEuIFScR/0PzMwcHEvmEtZR9HQfaz0/WxMZdo/vftQc2Pjlubm5jqWeBPvCPwD/KOH+jnO5aMAAAAASUVORK5CYII=',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASxSURBVFiF3ZhdbBRVGIafc2Z2210hbeWnpcQVUC8kwBUJXJBIgwkgBEPEC1GMxhgE4gUJJsYERMWI3orYaiqgrYSWH/mvMaQLciE1RAKUkrLbbhMobQ20/LT7N3OOF0CC0O7szGwv9L3c73u/93vnnD3zzYH/EUTBKx6sHUvQWgR6GTAdmASMA26A6AYuofUhQnYTVevuFlK6cGaObC9DGh8i9PtAKA/GEIKvSRZtZfnbA4VooTBmjlWvQFADPOmBfRN4l8Xv7ffbhvTF1lpwrHoTgga8GeE+by9NNRvR2tfDNfyQmVv5MYJP8L/CAqgidtai/sgpP0W84d7WavBV43Eo0CtYvOaAF7K3Rg7sKKU4Hcf71sqFfmz1DEvX9rslevvPFKc/YnSMAJRhyA+8EN2vzMHasQSzveR3/HrFEMV2udv3kOlaJmgtIg8jYcMcqpu1oGXJhMi0oJQVGaV6Dvd1day62DwnaWWd+GHSciGwz01rHraZXuaUETbMoe6qVR3Ly6fMD0oZAYJBKSOvVEyd3z3/jVjIDCSddYSjzqPwYEY875RRN2tBS4kZnDFcrNQMztw144UzjjKa6W4787IylU4ZSyZEpuWKv1w+dWohdB6Fl9NsnFNCUMqKnHGRO34PYnz+Ld2DFzN3nBIySvXkjGt1PQ+d23l3dB9ezPQ6JRzu6+rIFT/Q25lwVNHkfCDDwYuZFqeEVReb5wxYmQvDxfqz6QtvnW+e69yZcNR5jOKWgKbZKSVpZUOV0bpnG3vi0YxWXUAmo1XXnp54tLL5p+dSyi52FlJRt625nwCavxlDyrgKlLjm5o9byPBkFr456IbkfmWq1t1FsMM1zx1q3RoBr4OmpT4F+jxxndGHrbZ4IXozs3RtP0Ks98R1ghDrvYz/4PfD6ti39Qix0leNh6H07siaL9ZJKYuKtA6lhSgKaC0sWwYATENlLSmVECIZTKcHZ167NtAI9gO6PzO/1ZRg6XPAFF91AJnKDES21NaYN26l8uVoLWyhSZhS/345kUj4/+Q9XjMPdBR/9wl6Qn3TjyWnzyW88i3Y5e92BmDx6tPAV35KjDnXftqHEQBhKDXZvxmA4p5NCJzH+mFg3rxzvXzn0ZN+5BUoW8p4YcxUbbZQ4nXyGEIfhrDt7MS6o/tEOm07Z48ArTPCMPYnEomewpgBeGl1HMQGN5SSk381hdsSNzwqag1tRbZdHY/HL8JoXJwfr24AXnVKK7rae/mpz3fs8aCQ1FqfxzTPxuPxf7243V9oOMESa4XOvqgDZtlIKTKVHpz4w6Ej+ZbUWlgIHdNStkYikbZoNGoNl1f4lQGM3V8us0tLfhmhvh6/98Tu0hN/XslVQ2uRlahOIWWrMozLsVgs7aQ7KmYAAnVb67PjSh+bDsKtHX9Ubmv4dQRaEiE6JLQHwuG21tbWjBvNwm+z+8hmU+/Iu8l5akwo8uA34/bg3+W1B088nKdhCK2vmFJemjV7dqyxsdHzyTZqKwMQ2r55bmpK+SktRABb2ZO+2//9E+djvcAthIgZ0P5aZ+eVzaAKoTeqZgCKt238LP10xYaxZy7tq/j5+E5Ms629vb0b0KOt/Z/GP4jqqfL5oxVsAAAAAElFTkSuQmCC',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAS8SURBVFiF3VhdTBxVGD3f3Rl2oRAstZXaBGxpoxaxhSVpE0ha0ib0qU/1QX009UHjQ5Oa+BO3pdTEn0QffNDGGH+SprGUqlUTSGtcKfGHBELALYTuwGJsSyEVKLuz87Mzny80sQjMzp3lQc/j3O+c8525N3fuXOB/BCq0YNNoU5lRZBwipsMM3glgM4ANAO4AuMnM14QQl7LZbFeiNpEupHfBwtRN1q1Xc+orBHoJQHEeFB3AB45w3hrcOjhXiB4KEqZxvPEIM58BUCFB/4vBRwdqBi4G7UMEYjMoqkVjzHweckEAoIJAF6LJ6BvgYC83UJiG8YYYgDYEn2EC4VRUi74eTEQSi0vrfBCNZeAy85GB7QNfyZClGtk9sfuBkBvSIL+0VsOspVg1w9XDs36JUstMYeU1rE0QAFhflCt6WYboe2aaRpvKDNW4jfy2X1nohmE85Pc7pPh1MYqMQ2DvIBER0ds3tvc1lzRvU0mttNme6tF7xmPTsT0mm178kuJIcSuATj+9+V5mxHTYqyYiInpXddd4y7qW/SqpVQCKVFKrDqw7sL+7ujsZpnDWS4OJPX2WwncYBj/uVdO+sb2vlEqfWG6sVJTWtW1q+81Lg5h2+u1NZgN42KuguaR522rj+0r2bfXSYGZPn6WQCbPBq0AltTLIOACA8KCPngDIhCEseJXYbE+tOg77Vh5Od/PuaRH+wzBue5X06D3jq43HM/FUHk6rvpDlILPM+rwKYtOxPWk3Pbzc2IK7MHxi+sReLw0Ge/oshczW/KNXjclmcetk6/YrmStxm+1JAJbN9uTlzOV462TrDoutiGdjJOK+e/NLqE3UlkYikT8BlPvl+sC8vc7eMlQ5lPFD8j0zidpEmkCf+uX5xCd+gwCSB01TMU8BmJbh5oFpS7FOyxClwiwez4/JcPPAMZnjPxDwxyqqRc8CeCaIxn1wcG7m4MyLQohwmLnYJAqrzJRzhAoASsi1c0K4RJQtMs1M3Y0bcx2Ac48eNEw5gEEAjwQKAYB1nksfnTvjTrlG3hwmhxgpRfDV0VQqFfiXN6pFmwHEAYSkRRisv5/5wv7eSMkq5IDPg93OAOiv6e8F8E4QDbvX6g0QBAAo5LpbAocBgLI/ymIAPI/1y4Fn3FvZt9M/BfF3AdcRQitImHhLPAcXzwLeh9D7YMPW3810cpYd7+IVwGxRKHQxlUpNFSQMAPTv6NeY+bgfjvmt0ZXrt+5IWjIDI2HH+UjTtN+BNbg4j2rR8wCe8qpztdzowvPzX0pYZJl5CIrSr2nafR9u3xcansjhBXb4IIVp/UolrLuZ9On0d/lKMlMOxEkWIlFVVTUSj8dzy9UVfGYAoP6X+sNik/h6BX02PsycMy8Y11fTYCZbwJ0gIRJuKDSaTCZNL981CQMA9b31Z8Vm8a/Tgd1n/aq/utC9Ai0LonEBjKklJSOJRMLy41n4ZbaIWXv2uYr5imYqp6p7z9xZdyb7ZvqHf9YxoIP5uiLEtScbG5MdHR3SO9uazQwANFxq2EuPUQ9CUOHA0U/e/dj+2b4NYB5EyRAw9vTExPWTgFsIvzUNAwC7vtnVrjyqHLeuWJ3me5nPoCgjY2NjNwHwWnv/p/E3iQfm3w9KV7kAAAAASUVORK5CYII=',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATaSURBVFiF3VhbbBRVGP7+M9NddtmyvcYKSbGoAYn4REJNIGmRpMREfMEH5YEYY6ptfCCBxEgEvMR4eeCBtBYa1EIIsbVAFAIIsis0og1GpJbWdrdsiUBLuXQp3e3MzpzfB23Cpe3pzGwf9Huc83/f939z5nLOAf5HoGwL7m4ryjWssdVgWkPEi5npURAKwbgJ4CoYF5n4WyBwrLZy6G42vbMWpv5MOJ9s+TYz3gIQUDtzCkw7DGgfb6gcHs5GD1kJUxcJrSWinWAUuOjgFkt+vXbl3QNe+xBeyMyg+lOhLQRqdhUEABgFRPTN59HQu8zebq7mhVxSEdoKovfgfYYJoMpzCZ91pMk87UHEHeoiobUEavai8RAYkgTWvlkxctAN3VUj2yN5eX6y464fralxG7p4vGZF8rZToqt3xs/2OzMUBADykZGb3BAdz8zutqJcI2MMYjqfX7cgTjEHHnH6H9Kd+hjW2GqAlEF0PZhataixfX5h1QJBvhLJ5kD/jaN9J7url1l2amo+U1BwugpAq5PenD9mTGtUJboeTK0v7+0rK3qhQpCvFIBPkK+0rPjFivXP/hnTtWBaaSPUPg/CzTvzlKpg1aLGdp+e+/REYz49vGTlooZfVBrMWOy0MTdh5qoK5hdWLZhqvKzo+TKVBpHa50E4D0MoVIqSr8TL+L8omnZP47pOCWCMqEokmwOK8WvT8LnjoCsA7mZmUFXSf+No31TjfTeOJKbhNOUNmQiOwxCjXVVzsrt6mWklOyYaMzLDHae63ihXaTCpfR6E4zCSKaKqsexUoOnswifiQ4eiks1+AKZksz82dDDadHbhk7ZMz1I3RlGnvTleAdRFikOEsb8AhJ1yHSA5agbnbaoaHHVCcjwz/ywx+EunPEcg7HYaBHC7OdO190G47oqrAuE6NPGhG6qrMDUrkrchaYMbrhKSNrhZ/gMeN1b10dA+ML3iReNe2JL3f/ZqQa0Qwu9nDhhE/hxmsmyRAwC6JjOWEJKI0j7DGF1y5cpwC2CP8z2F2XkiP2zr1nkAj3mLAZhpMbx3a3hnckiMTZfDTDYxErrgM92JRMLzlrcukrucgCi8nCcw+MSe2Xs6orMSbhUsoMnT6QwA1FaOtIHxqReN2G/+Ng9BAIA0Ked5DgMA12lkCwDlsn4ijNyia8d3zf7Ri78EpC1EPCthtlXC0qRYB6gXofc1YSNz/Is5rYZBtrp6EjCbpGkHEonEQFbCAED1c8k4GBudcM6fmnXscqd+06UlM9Dlt+2GeDz+BzADB+f1kTnNAL+kqhu6rHfv3Rr+2oVFmpkvQNd/jcfj9/24HR9oqKCBawyTVuk+zp+sxhyj0cMNocPT1WQmC8QxFqKztLS0KxqNWhPVZX1mAOCT1rw1uQX2oUn0+fT+4P5z3wd6p9JgpoyAvERCdEpN647FYobKd0bCAMBHzeF9ecXyodVB4kLOzwe2zzk+CS0Noj4B9OQEg12dnZ2mE8+sP2bjMEeTr6UD4eWBkCwdvzZ6Rwwd2TX7h3vrGEiBuVcX4uIzS5fGWlpaXH/ZZmxmAGBzY0H53AXWaRKcI23Y3+0INcZ/9w8CSIIopgE9L1+61LsNkNnwm9EwALB5V8EHJWWZjV0/BVpPNoW+gq539fT0XAXAM+39n8bfE7XcWzV66JYAAAAASUVORK5CYII=',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAR4SURBVFiF3ZhbbBRVGMd/58x2u7vQbmtvssSNAjaRiE8k8oAPBowkVTAGTVAJJMYXiTGYNFxisHiJ7ZMPQiIxxhRLCG1tjSBRubiAJEhiNDaFSlu6baRQELsI7e7sZY4PlKT2sjNzZvvC/3HO9//+33++M2e+GbiPIAqesYkSLNYgWAssBRYAFcBNYBjFBSTfkuR7GrhTSOnCmfmYcgTbgbeAoAPGOIJP8dPIVhKFKKEwZppYj2If8IAG+x8Eb7CNDq9lGJ7YCkGQXcBeIKSZJQi8zDNYHOMMu/XL8WYmxHvAbrx3WABPc5YsxzntJYke7m6tVk85psNCsZ4ddOqQ9Qr5hDJM+tF7RuwwimIxOxh1S5Racml2MjdGAMqBeh2i+840UYJiBGfHry7GSVHj9j3kvjMWa3BgJOQPjXe82BEz680htU2lzXpzqP2F9ljQF0w6UAlRzLNuS3PfmUa+Al7LW4k/ND68Zfhy2B9+fOpawkx0RfZEliSzSbsbsp/tbHJTms4z85hdQMtzLednMgJQVly2rLmu+RcHOkvdFqZjJmIXULe4blG+9XW16x4phM5U6JipsAvwS/+DXtYnUOm4ognomLltF5C20tds1q860PnXcUUT0DEzYhdwuPfw5XzrnZc647Yqgrw3ZCbomDlvF7DxyMYnE2aia6a10dRo1+bvNq+wVVH2OlOhY+Ynu4BkNhmM7Iksaetpi6Wt9CCQTlvpwUM9h2KRvZFHU9lUwFZFEHNbmPv3TAPzCfAXEHbNdY5bGCyknjE3JPeduTtifOma5w5fuDUCuoOm4n3guhbXHtdRfKhD1DNzdzzfqsW1x1ad8R+8flg1cgB4xVOOybA4GP0sukVKWVysVNAUorhIKZHNySIAn2FlslJaQoik3zTHll25kmiD3D26VzNh4HfgYU95AJmRiWhrZJ/vti/llKOUyAlF3CfVmZ54PO79k7eRlUAMb/8TVNWpiv3hiyVxXX4Wmr390AA4zhCrCCB4SjfF/IF5P1eeK//NQxVCWNYNvQNgKkx2AU7G+mnw3TGu1pysPOVF3gIrJ2V/Ycw0kEXyKg6G0MkQlshUn6r6WmREzj56FiiVFobREY/Hr3nfZvdwjFFWcRPB804pZV2lR8PdJXmH0jxQCnoCuVzrn4ODgzA3P85bUbxkF1b8t7/nofbIIQ2FpFLqD3y+X/v7+//34vZpJMsPgzeFKVYrQ5XPFiIzYqz6ZPURpymVElmE6lNSdkej0YuxWCw7U1zhOwMY7xprc/Nz38ySX1WeLT9Y1hXuzZdDKZGRWANCym7LMHr6+vpMO905MQNQtLPoQKY0M206CA0Fz0WO1vwwCy2JEJclXCoKhS52d3en3WgWfptNIOPPvC5TcqUVsKL3rhnjxo2aE5UnJscpGEepXp+UF55Yvryvra1N+2Sbs84ABN8JrkhVpU4roYqwyC34sfrzefHQCHALIfoMuLRhYKC3Aay5rKNgCLwd+EB8JJKlm0pbahctWl1bW7uQOb6J9wX+A8zucxGCTS9IAAAAAElFTkSuQmCC',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARZSURBVFiF3ZhbbFRVFIa/vedSZkTbClJow1irNpGIvpDIAw+NIYghqTHig6JGIoLSGEK8xEhoKpKovBoJg1aCaVNpsYhIRINh1D5oDYaIvUhn2qGhNwi2RabtXM7ZPrQk0Ns5Z5+ZF/7Hs9e//vXvtXP2OgduI4isZ1S1d0JmPVAJrACWAYuAq0A/0A7qWzBOIaquZ1M6e2bU/kLwvAu8AQRsMMZAfAK+jxCbR7JRQnbMqAMbQYSBuzXY/4J6FfFas9sypCu2UgJ1sBpEI3pGmOSJo6jwbpRytbnuzHCwGtT7uO+wAPZAeJfbJHqYPFqNrnLMhAliI2LrMR2yXiHqUAGkYugfrfkwDMb9iO3DTomaxyz1HrkxAlAI8m0dovPOTN4jQ9h7/epiDDJFTu8hjc5k1mPDSBDvWDPrIkm29Cq2ppJs6T3KukgA37gNkSD4nnBamc4xq7SuxDvWzwvdT1Na4UeGAL8fGXqG0op+NkVtGrLUmQ4dMw9ZBdTxeGs+/odnWyvAv/IwFb9by6gVTgvTMVNsFbCBUNl8609x733Z0JkOHTOLrAL8yKVu1qew2HZFU9Ax859VQApz0GJ9wIbONdsVTUHHzJBVwAl6u+dbP0ZP3IbOvBsyGzTMqFariBc589gIqfOzrQ2TPP8ykdU2hCx1pkOnM2esAsZJB4qpf6CJnkgK8yKQSmFePEIsUkzdgxMYC6xlRMRpYRoTwKcLwXsJyHfMtY9RCJQgXko4ITnvzOSIccgxz5lIrVMjoD1oGnuAy3pcS1yGzF4dop6ZyfF8pxbXGjt1xn9w+2GlwvXA865y3AzDbAiVfVglpczLUyqQFCLPp5TIGNIH4PWY6YyUphBi3J9MJlb29Y00gXGD7tZMPnAOKHWVB5DXUyOhJz8Pey+NTtiWV8IQirhXql874/G4+09eFV4DRACPfg7UPbu+/zK/4VxcN0MGDrv8oQGIbS2g9rlJsfDHf1pcGAEQHtMscW8GgMFqwMZYPxPegWsDRW+e/NmNugmmIWUsO2ZETQbYhI0h9BZa2kgveefk1yKRNKyj54BSKeHxNMfj8cEsdQYQ22LAW04o+XV/ngq2xK9qKioFHXmGcSAWi/0NOflxHm4EnrUKy2sf6ly+4YsjGgrjSqm/8HrPxmKxWy5ur0YyK2wXycxalectnCtAJpKJJTuOf2c3oVIig1BRJWVbKBTqiEQimdnist8ZwNP3caVRXPDNHPnV4r2nGwpq/+iaL4dSIi0xe4SUbabH0xmNRpNWujkxA+Dr3VefXp4/YzoIRmK/FW9u/GEO2jhCdEu44AsGO9ra2lJONHNxzABIG2OvyGH/GrMwELrxzHMlcaVox/Gfbo5TMIZSXV4p2x9ZtSra1NSk/WbLWWcAAmdrVk88uvQX5RE+Mqax7PXmz+443TUEjCJE1AMXnuvp6aoBM5d1ZA0LWnd/IJL7x+/6qqquvKxsbXl5eQk53sTbAv8DzFJ5Mvw8/r8AAAAASUVORK5CYII=',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAQLSURBVFiF3ZnPT1xVHMU/983QYcbqlNZoCmEkqCxMtJsm+gfQ2KaJqaYurDHaZeO2dmH8lZg06qZLtYY0RhqkKFrd1KYJE2VhqiQG5YftDAwEShFpARmGN8y84wIxhQLvx8xA0pPczbzv955z7u97B+4hmLLXKN0PHASeA54A9gJ7gGngBtAPfAdcwpj5svOXBVIN0odIC0jyULJIHyDt2m7pqyEdRZr2aGJtmUZ6YbstgGSQ3kFyAhpZKQ7S20jlH/Y+zLxboom15a3tMnK0DD2ythSRnt9qI7tKmCNu5RZSTRBZVkA7bwK7A+a6oQZ4I0ii/wm3vI9MAtEghB6xADzsdx8K0jMH8WAkBgudkLRhVJC3YfQrSEYh54EjBjwbQJtPSF+4jfuYlJ2Rftc6uC31Rr1trJ9vhZlf3YR0Sl3rGVnBBanLg5lftsLMDTchtjSymRlbyngwM+5XWpAFwAZ2bBoCeZcY20DEhSmPMW4xqxBkAfjHLSAPN12+T3jgmfOs6D8EMTPpFvA9DG32/RvIeODZtEHKA+mc23iPSgu3pd715sstqbdaynmYMy1+pQXpmS63gBxEa+GxDkjmYQTI52GkHZK18PgiVHvgSfoVFmQB2AmMAXHfud4xC9RhTNZPkv+eWT5inPOd5w8tfo0Ex/IVebJCp+bJoKfmUgwdq5CZY0EllXZNlc4DgcnvQrHYlmhsfN2yrEhEitrGRKokUyhaVQDhkLNUsCzHGJPbYdvZJ8fHZzqguJJeqpk48BvQUFI9gDU/P5M4dOjT8NjYond6UzQiE7b002Amkwl6OVuGMbPAK9zROoEgac/p0xf9GFmmVwhLjxbg1YaGhobSzCzX2A18VEoVOy9f7o63tWVKURFynLryPO1IYaAbeNpvanhiYuKRAwdaTDYbuHcdcBw4W3rPABhTAF7GwyF0VdrS0tJDp059XYoRpLwJhTozmczN8pgBMCYNnPSTEm9tvRTr7p4OyCjBQKRY/CSdTv8BlXk4vwC86BYW6e8frD98uD0AQ05SL+FwTzqd/uvOD5Uw86Cx7WuKRDbcxa1sNlt35MjHkVTK05FFMgWMUrKsvkQiMZBMJgvrxYWDat4QxvxtjY+/Vqyt/Zb1G0u7z5y56GZEMksWzrCxrD4nHBpMpVI2wNDQxlelij1UV42Onl+qr7/rdBBLJn+uPX78hw3SchgzZMG1qlhsoK+vL++Hs3Kv7sPD1VY8/qdTU5NY+Sk0NTWVaG4+G5qb+3+YCBaQroctq/+p/ftTHR0dgVe2iv6FEO3peWZx374fFQpVUSgU95448dl9V65MArMYkwrBtZeGh6+/B04ldZQN1Vevvm9sO/fAl+2tTY2NzU1NTXVUuBHvCfwLna16k1MlopgAAAAASUVORK5CYII=',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATaSURBVFiF3VhdbBRVFP7Ondlddvqz/aERARtFMUos4YFIH3iAxESICfCABtqkCRiJtjGRBBODivhH1PigEovFGKhJXWktpdgQfDCugEFrCEhbitvdditSKIhtge52d3bu8YE2AWx7d2a2D/o97jnf+c43996Zsxf4H4GyXXD25ta8MSOxiiWvAWERCPeCUQzCNYAGwHyOGIf90I5erX3mZja1s2Ym8EJDYZq0V0D8IgB/BpQ4gN0ez9h7wx9tGs5GD1kxk1sdXM+EOgBFDuh/E9NzN2s3HHTbh3BHZzJqvt7BhEY4MwIARUz8jVEdfB1gVw9Xc0M2qh95gwhvwv0KExFWeh7vTJu/Nh9zXMQpcXxrNbqpMQmkBNYnPt3Y4oTsqJGCl/YVmOasKJxvrekwpEv54MieyiG7REdnxjR92zEzRgCgMC3Ey06Itldm9ubWvIQ/PojMXr9OETdYu8fud0i3qzJmJFaB1UZyvHp8b1V5++qyuQu8mpiTsuTlIx0DvVvqTy6Lm5aKbyRE+kkAzXZ6s73NWPIaVU6OV4+Hd63tXbtk/gqvJkoBeL2aKF23ZP6K8LvrIoZHSyh1AKXO3bB/ZgQ9qkrZW1XeHpjleWyyWIHhKaurKv9FqcO0yHZrdgkAz1VlrC6bu2C6+FOL5z2QgZBS527YN8MoVqV4NTHHTXwcszPuaRxOXs03VAkpS15WxC9loHM9447G4WSbDaoyjnQM9E4X//bMhZhShjDtA5kMDsxQuypjS/3JZcNxs2Oy2HA81fF8Q3u5Uoah1LkbDs4M/aBKiZuW/+FXDz3UcvpCKGXJfgCplCX7m0/1hxa+1rowkbJmZaAUstua7QmgpLoxN07WnwACdrk2MDLqN+fhw6pROyTbK3NrxKB9dnn2wF/YNQI4HDR1ab0F4IoTbga4okt+xwnRkZmRPZVDIGx1wlWCsNXJ+H+L6gI5NcEGABVuatwBtoLFbdtrhBA+H7M/SeTzMFPaEh4A0DVppoWQRJTwJpOjZRcvDjcB1gTdlZnCLY2BlMc6A+B+dy4AkU4Olxz7uE4khsYy5TCTRYyYLvj4+Vgs5vovb171V8slUQhu7hMYHOhs+dL4oz3mtEIaqHd5OwPcqK04AeADNzX8g10nXBgBANKknOfaDACMlszZAUA91k8CbWzkUuBs049u9CUgLSGiWTGDnSvTuqBKgJVD6O0gaZmB35qbyUxa6uwpwJwiTTsYi8UuZ8cMgJHdG6JMYpsdjr//5FHfXz3XHEoyA90+y/osGo12AjNwcZ5TE2wE8LQqz3v90vni458ccCCRYOaz0PVT0Wj0jg+37QsNFYTJ1axZT7DQC6fOSY7mnw62ZVqTmdIgjrAQXaWlpd2hUCg9WV7WVwYA8jbXrpH+wkNT1Of8c23BnL6feqarwUymgOwjIbqkpp2PRCJJle6MmAGA/E21DZZR+K/pwHf195+L2vd/NwUtAaJeAYQ9htHd1dWVsqOZ9W02gevsfzY3NbqcvTmlE7+J5M2rgdMHvr89j4E4mHt0Ic4tXro00tTU5PjNNmMrAwBFle+XpwLzjzEJD6RlFZ1q+Nx3pXsQwAiIIhoQ3tjX17MTkNnQm1EzAFBQsettM3DfNv/FM81FnS37oevd4XB4AADPtPZ/Gv8AkvXQkIP4nXQAAAAASUVORK5CYII=',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASpSURBVFiF3ZhbbBRlFMd/3ze7bXdp0yKlQI2NIqZlK8YHjDxgFEIikVhKAibeooH4otFIosFLgvdEn9QQHojxAkoIFChRMWBCXC5GxRgb6sJSWrrlDgXbUrrbndmZ44Mlwdru7MxsH/T/ON/5n//5z5n55swH/yOoomesb6rAMBaDNAExYAYwBbiC4hxwFORrKNlDouVaMaWLZ2bOksk44VeA5xEiBTDSiFpHqbxP267+YpRQHDONS5cjagNwkw/2n2j1DH+07gxahhGQr2hcthZhPRD1mSOC8Ag1DQ69yYNBiglmJtb8BvAWwTusgAVUN+S4nDzgN4l/M41Ll4NaTzHfO8UDVNe3c/l40h/dD+5ursKkC3/viBv6MKzbad/d55WofclZ8hoTYwRgMnb4ZT9E752pb6ogpC8WuP36RRoVnub1O+S9M4axuBAj0bLS9M6P18SzbdtPSaLVzLZtP7X9ozXxSKQkU4BKFKwHvZbmvTOx5i+BJ/JWUlaaPrf/s5OV5dE7R6/1Dw611y5YOSuTMfPfEKU2kWh9yktp3jujmO0W8tUHLx4eywhAVcWkORvfe+EXVx1HYl5L825GqHULWXL/PTPzrS9dOO82Vx3lrjMafnazKW4BJWFjepD1EVQXXNEI/JgZdAswLfuCy/r5AnSuFlzRCPyYuegW8E3815P51lv3/ZQqQCfvDRkLfswcdgt48tUP7+0fHGofa61v4Fr706+vm1cMndHwsQHID24hmYwZqV2wclbL3h/jpmX3AKZp2T1b9xyK1y5cdcfwsFnmrkPca2nevzONK8rBOoNQ6ZlbKBQDGOmbOfL9kBea9878PWJ87pnnBcKnXo2A30FTW28Dl3xx3XEJw3rXD9GfmfbdfShZ7YvrBiWr/Yz/EPTHKta8GXgsUI4bIc6WuqG257TWpaUikaxSpWERlbN1GCBkOFZOa0cplSnJZofmnD3b3wL2dXowMzNXVFJmtQG3BsoDaJz+uuHkhpBjDhfKEVG2ElIhLQeTqVQq+C9v47L5IHEkyHmCyFTrzKZK60rKb4IcbAx6OgO9yVNMbSgD7vObotweOFRtnv89QBVKOU6vvw1gNGr61wLuY/0YCIl5fpp5en8QeQccW+uu4piJx3NoHqeAIfRGKLBqzNM7lNi2e/Q4EDGVYexMpVIXgj9m13Ep2UdNwxXg4UIpVVbvd5W5y3mH0jwQgWSZbW873tPTAxNxcB5r3gascAsrdTLJW4aPb/WhkBGRI4RCv3V1df3jwx3ykSw/cvazKqQWCXryeCFa7KEaq+fbQlOKqBxKOkXrRF1d3bF4PJ4bK674nQGM+iVNthHeNU5+qTbPbqnK9Z7Il0NEWRqnW2mdcAwj2dnZmXXTnRAzAOHYQ5stSv41HURzgz/Xml17x6FlUOqkho5wNHoskUiYXjSL/5iNwEqnV+mInu+oUN31a4bkeqdlU/tuvIUCaUROhLQ+etfcuZ0tLS2+d7YJ6wxAZPaiecO6/IAIYUTsGWb3J5PsqxeBAZTqNKDj0e7uE2+CUwy9CTUDUFa/6J2sEX2pwurfMd0+8wWh0LGOjo5zgEy09n8afwEcs7T5cvn0GwAAAABJRU5ErkJggg==',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAS2SURBVFiF3VhbTBxVGP7+szPscmkq1FZqE2pvUYvYwpK0SUla0ib0iaf6oD6a+qDxoUlNvMTthZp4ifHBB22M8ZI0jVCqVk0gbeOKxAsJpAG3ENiBxdiWSypQdmd3Znbm9wGaCAKzc2b3Qb/HOf/3ff835+TMmQP8j0D5FjxwYGhdJlN0lIibmbEbwGYAGwDcBXCbmW8KIa6k0+mOWKw6mU/vvIWpqRkvV9XsK0R4CUBxDhQdwAe2Ld66cWPbbD56yEuY+vrRY8x8HkCFBP0vZhzv69tx2W8fwh+dKRzWIszcCrkgAFBBhEvhcPwNgH29XF9h6upGIwDOwP8ME0Bnw2HtdZ8iclhcWq1+NFaAw8zH+vp2fiVDlmpk796xBwIBR4P80loLM6ap7BgY2DrjlSi1zBSFX0NhggBAeVFR9mUZoueZWfiOqJPIbfuVhZ7JZB7y+h1SvLpkMkVHAXYNEgoJvaVlY09DQ8l2VaVKy+KJri59NBKZ2mcYrvyS4uJQE4B2L715XmZE3OxWEwoJvaNj62hjY+khVaUqAEWqSlWHD5ce6uzcGg8GKe2mwUyuPsvhOQwzHneraWnZ2FNWRk+sNFZWJmrOnNn0m5sGEe/22pvMBvCwW0FDQ8n2tcYPHizZ5qbBzK4+yyETZoNbgapSpZ/xBdCDube0AIkwNO9WYVk8sfY47uRgdC/nlhYhEYYn3Sq6uvTRtcaj0VQiB6M1X8hKkFlmPW4FkcjUvmTSGVhpbH7eGTh1amq/mwazu89yyGzNP7jVGAYXNzWN77x2LRW1LB4HYFoWj1+9moo2NY3vMk0OuTYmKOq5N6+E6upYWSgU+hPAeq9cD5izrNIt/f2VKS8kzzMTi1UnifCpV55HfOI1CCB50DQM5SyAKRluDpgyTeWcDFEqzOLx/IQMNweckDn+Az5/rMJh7QKAZ/xoLIV9cXr6yItCiGCQudggCqrMlLWFCgBKwLGyQjhElC4yjFTNrVuzbYB9n+03zHoANwA84isDAGZ9Njl7/LzjTGRy55BNjIQi+KehRCLh+5c3HNYaAEQBBORVmPXU+19Yme8TsgJZ4HOftzNAb++ObgDv+NGwzO5uH0EAgAKOs8V3GABYt+6PCADXY/1KYGf6Tjr59o9+/B3AsYXQ8hImGm3MAs6zAFwPoUthWXrq3XbmtO1euwqYTQoELicSiYm8hAGA3t5dGjOf9MIxMt92ZM3eu5KWzMBg0LY/0jTtd6AAF+fhsNYK4Cm3OierDc3PPf+lhEWamfuhKL2api35cHu+0HBH9gVm+whRsHy1Cnb0VDJ57rtcFZkpC+I4CxGrqqoajEaj2ZXq8j4zAFBb+0uzEJu+XkWfM6kPLxqZSyNraTCTJeCMkRAxJxAYisfjhptvQcIAQG1t9wUhNv/rdGCZPb/q8692rkJLg2hUAMNqSclgLBYzvXgWYJktYGbGeq6iYq6BaH3V/WeOMzOdTr55/Z91DOhgHlGEuPlkfX28ra1Nemcr2MwAQF3dlf1Ej3UBARWwbf3e6Y8t6+dJAHMgigeA4afHxkZOA04+/AoaBgD27PmmRVEePWka19sN/b3PoCiDw8PDtwFwob3/0/gbh/Lm30zcQi4AAAAASUVORK5CYII=',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASdSURBVFiF3ZhbbBRVHMZ/58xeSgNCqRegsamt1EhEXwjw4AMmJGpAEhNoVOItxgdFQ1C5qqQiKiVRHtQIGuKDXNItFJGSoFFYpIltExIj9EK7WxbTUi7BFqHbTndm/r60CWDp7MxsX/ge9/y/7/t/55ydOXPgDoLKtWDVQZnkDPGUgiUIs4DpQCFwBTgv0KLhpwE4UlmhrufSO2dhPtstBSrEOhRvAxOyoKSV4stIiC2rnlV9ueghJ2GqYrJUYAcw1Qf9H6V4fe0yVRu0Dx2ELCJqS0w2CsTwFwRgqgj7qqrlQxEJNLmBwmzdx0bgI4KvsBLFpqp9vB9IxC9xeGvFgmiMAkdg6foKdcAP2Vcj2w7IFDNDEv9bayz0Soay9ctVr1eir202lGED4xMEoIAQq/0QPa9M1UGZJCYXye7x6xfpQbjP63so5NVl+IXoGiQSIr14Lk1l0ynVmmmOw4WOHjrrGpln2a78/KjwJLDfS2+et5mCJW41kRDpFYvpnFnEAq0pBiJaU/xQEQveeoZEyGAgFz63wvt/RnjYrWTxXJoiYR4ZbSwaZvaiuTS6+ihmeW3NzwNghltB2XRKxxovn8EDufC5FX7CFLqKaqYFGR/G3Vl3NKLrlQBccytwHC6MOS70ZOHzb9YdDcNPmItuBR09dI413t5Nyk1DMfaEjAY/YZrcCuoamWdmODXa2OAQpw43Md9NQ5S7z63wHkZxzK3Espnw1SEebOsi7jicA4Ych3NtXcS/rmOmZZPnaiPEvbfmEZUxmZgHXcBkr1wPuGoMUrT6JdXvheR5ZSor1HWE773yPGKn1yDg86ApFpuAS364WeCSZNjsh+grzPDxfJUfbhZY5ef4DwE/rLbEZDfwQhCNG+HY9t7ta0tXaK2jUZEJplLRsIiybB0GCBlOxtLaUUoNREyzf3Z3d18N2CP8oGEmA38CJYFSABnzel/tF0/vuNbbNZgtR0TZSkiFtJxoS6VSge4A1lWoq8CL3DA7/iDScPjTg16CACglBlrKLHi5pKSkJFAYgHUVql6ErUE0Uqd/qT/TsDcVQEIZjlMUOAyAeS8bIYtj/Sjo7+vpOV797vEg/g44ttbJnISpfEJZ2mE5WRxCb2rCzmSO16zZnzH7/W9TkSFlGLWpVOpCTsIArHlOJQXe88Jp+WPXkfMd9Vd8WopAa9S2tyeTydMwHhfnMYkJLHOru9LT0nZg26JqHxYDIvIXodDJZDJ504vb84WGGwyLN00xFxrhaMHtaiyzv//onpV12WqKKAslCdG6ubi4uDUej1uj1eV8ZQA++LZ7ycQpM368jb40HNq89/SJnR1jaYiojMY5q7RudgyjLZFImG6+4xIGYMM3f+++q/D+/50Ous7EG47sfPXn29AGUKpTQ3s4P7+1ubl5yItnzrfZCCJ59muD6d7H8/ILikd+S1+7fPnYnpW/3VgnkEakI6R1y6Nz5iRqamp8P9nGbWUA3vn85Px7ih77XWkj7NiWffSHN75Ltfx6EbiKUgkD2p8/e7ajEpzx7CNnWLm16eNP9pgDr6yu3lVeWrqwvLy8iHGexDsC/wHqq7fSQTg4DwAAAABJRU5ErkJggg==',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARmSURBVFiF3ZhfbBRVFMZ/d2Z3y1aatoCAbVyxahON6AuJPPDQGIIakhojPihqJCIoxBDinxgJTUUSlVcjYTENYNo0UCiKRKrRdFUetJGEWAuE7rZLA+VPg22Fbdk/M8cHtkmtbWfmzu4L3+Pc833nfPfczD0zcAdBFVqwCSnLwdNAPfAIcA8wH7gODAJnBI5Z0LEZdbOQuQtmZjdSacIHwNtA2AVlTMHnQfh0HWqkEDUUxMweZI2CKDBPg/63wBtvotr91mH4IQui9iINCg6hZwRgnoLDUWS7IL4215eZvdAg8BH+O6yAHVHY5ldEC/mjdciPxjSwFazZgDqqQ9YqZB9SkYEE+kdrNgxb8MAm1LBXotYxy8CHFMcIQKUB7+kQPXcmf49cxd3rVxdjOVjk9R7y3Jn8hehoJFDK2Kp2YuvTDGwQMuvTDKw6TCwYZtxFmtIgPOW1Np1jVu8UEChl7OVB+pY8R50RIgKEjBCRJc9Tt3aQuEtDjnmmQsfMw04BTzbTFSrn0enWQhUsrTvA704acnsU8gQdM1VOAZHV1My2ft+z3F+IPFOhY2a+o2iIxX7W81jguqIJXa8E4IZTgJ3hisP6ZRd5/nFdUR46Zq46BQx8S99s6/1HSbrIM+uGTAfPZgS6nGI6X+GJzAjd062lh+mOvcZyF6kc80yFTmc6nQKy44Rbqniwv42YneECkLEzXEgcJNZcxUPWLeY4aSiIeS3M8wTwBTI3ABeBcq9cDxgNQ/WrqJQXkufO5EeMfV55XqCgyasR0Bw0LdgBXNPhusC1HOzUIWqZyY/nW3W4LrBVZ/wHnx9WUaQFeMmPxmTYWK2fRGo2G4ZRUiISTitVEhRROcsIAgRMO5szDFspNR5Kp1NLL10aaQNrgu/XTDlwGljiywWQMW6O7K96JjoauHjLLUdEWUpIBgz59VwymfT9yRtFVnD7NWrqq4h0zN/2VXdZa1JXIAcHfP3QANiIOimwy49G710/nPRhBECZtl3t2wzAFWgA57F+OtwwL18+seCdn/3kt8G2DCNREDONqBywFhdD6GRYKpv97u73j6RVynKOngEiGWWa7clk8kpBzABsRCWAd71wTpc1dwzMOXldM6UInC2xrD2JROIvKMKP8yhyCHjBKW4odObc/qrVBzVSjIvInwQCpxKJxH8u7oCGmBM25VR6ZUBKKmcKyKhU6puFW467FRRROZTExTB6IpHI2VgslpsuruCdAfjMvFRfYVV9PYO+dFbubP2jvKl3Ng0RlTWw+5Vh9NimeS4ej6ed8hbFDMCu4EBLefbe/00HfeHYb0cWrft+Bto4SvUZcD5YWnq2p6cn4yVnMY4ZAGNZ6/WQMbwibFdGJp6lzKGh4wu2/DQ5TmAMkd6AYZx5bNmyeFtbm/abrWidAWgMn1q++NbjvygxgzY569jCt77sLf3xKjCKUnETzr/Y39/bCHYx6ygYts/p+ni3So9vnnuwubamZmVtbW01Rd7EOwL/Ai1BeTIkgAbWAAAAAElFTkSuQmCC',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAQMSURBVFiF3ZnLT1xlGIef78zAMFgCeGscLCGoLEy0myb6B9SIMTXW1IU1Rk3cGF16SYy3xMRUN8aVWkMaY0lDUbS6qbcwKjGmSmKwXKQzMBAoINICMgxnLufnoqWhCJzLzEDSX/Ju5rzved/nu39n4BqSKfULhWqAVuAh4E7gFuAGYA44DwwAXwGnDWap1PlLIqF6oXeEloXkwdJCR4Tqdrr2qyR0SGjOI8R6mxN6ZKcZEDJCrws5AUFWzRF6Tajkw94PzBtFQqy3V3cK5FAJemS9FYQObjdIXRFzxM0uCNUHqcsKyPMKcH3AWDfVAy8GCfQ94S7vIzNANEhCj1oGdvvdh4L0TCteQKpZpos4NuOILDbjfEacKBkPOaqB+wPU5k9Cn7qO+2qlNa8/tZEuqk9RTxvrJ9sB87trIV3q3hBkVSfV7QHmt+2AOe9aiK2xLWFspTzATPqtLcgCYAOVLk5ZFx8bQ8QlVdZg3HyuUpAF4F9XjyzTLs+nPORZ9FjPFQWBmXH1+JqRLZ9/QcpDnq0bpBQSOuY63qNa1kX1bThfLqhPVcp4mDNtfmsL0jPdrh4ZosS4nU7iZBkDsmQZo4M4Me5ghSoPeeJ+CwuyAOwCJoBav7E+tAA0GEzaT5Dvnrl8xDjmN86n2vyCBJYuXZFnynRqngl6ai4G6HCZYA4Hramoa6pQOxA4+XoVKJxobmx+zrKsSESK2sZEKiSTL1gVAOGQk8tblmOMyVTadvquycn5TiisxhcLUwv8ATQVRQEsWUvzB2IPfDQRnljxnF+mYEQqbOnnoVQqFfRyBoDBLABPsKZ1gkhIR+rfPuUHBMAYhbB0Wx6ebGpqaioKBsBgeoB3i3nHd9d929NRcyJVTBkhx2koyacdoTDQA9zjN3Y6NDXVeut9bWmTDty7DjgOHC26ZwAMJg88jpdD6BrlTC738k0vfV4MCFLWhEJdqVRquiQwAAaTBF7wE9Nec/z0L1U9cwFTSjAYKRQ+TCaTZy/VUGIJnQQedfMbqhwYOhB7sCNAioykPsLh3mQy+ffaB+WAudE29nBEkU138WWTTh9sePiDkXDC05FFMnmMErKs/sbGxsF4PJ7fyC8ctOjNZDD/TFqTT8UKsS/ZuLH0ft17p9xAJJOzcEaNZfU74dBQIpGwAUZGNr8qle1D9XjFePue3J7/nQ5+jMZ/fWb3099sEpbBmBELhiuqqwf7+/uzfnKWDWaU0apaq/aveqe+cfW32dDsbGts/9HF0OKVYSJYRjoXtqyBu/ftS3R2dgZe2cr6F0JvtPfevSt7fwopVJEnX3j+5mc//qH6+xlgAWMSIRh+bHT03JvglLOOkulM1Zm3bGNnOnZ1HG9pbt7f0tLSQJkb8ZrQf5kyepAtajIBAAAAAElFTkSuQmCC',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAASoSURBVFiF3VhNbFRVFP7OffMY6EjnvYGMrW2atmijRNyUBJcsTGRFQkJTKwpuXBliSDQxGolVEo0rjAuBhLCRGFuL4AoXTauWaBtNTHHoD/NHImXoOH2vY9+Uzvs5blpSoO37m7rgW777feec794zb867wGMEqnXAYrG4XQhxgIgOAtgNoBHADgAlADMAbjDzD7ZtX00mkwu1zF0zM7quq47jvAfgOIBtHiQVAF8S0Weqquq1qKEmZkql0mEiOgsgEUA+R0Rvqqp6KWwdIoyYmUnTtJNE1IdgRgAgwczfaZr2ITOH2txQZnRdP8nMvQh/wsTMH+u6/kGoIEGFy63VFybGGnCI6LCqqt8HEQcqRNM0hZkzCN5aG4YXQuxSFEXzKwzUZsz8PjbHCACojuO8G0To+2SKxeJ2SZLuwtvrNygqlmU96fd/KOI3ixDiADwYIaJKLBYbk2W5HUADgIJpmlnDMPYxs5u+TpKklwEM+KrND3m5yIMeOJV4PJ6VZXk/gBYAWwC0yLK8Px6Pp4losRZ5HkaQ38xzboRYLDZGRM+vtUZEe2Kx2KhbDGbe7bewIGaeciMst9ZG621uMYjINc/DCGJmhwdOQ8h1ANjpgfMAgpj51wOn4LJ+x0OMsgfOAwhi5q4bwTTNrMt63kMetw15BL7NMPOYG2f59Xt9Hf31SqXyolsMInLN8zB8mxFCDLlxmHnb/Pz806ZpDgO4BaAK4JZpmsPlcvkZx3G2ekg17Lc23xPA7OzsE5FI5G8Acb9aH5ivVqtNDQ0Nhh+R75NJJpMLzHzBr84PiOi8XyNAwKlZ13XVtu1JIkoG0W8EZp6VJOnZ/21qVhRFI6ITQbRuIKITQYwAIT+s5ubmLgJ4NUyM1bBt+5vOzs63hBDRKPO2JaKozEyWLWQAiEiOaQnhENHilqUlY8/t23o/YK/ow5qJA/gTQGsoFwAMw9CPdHefnZmZuedVw0w2MfIRwb9M5vP5UHcAiURiHsDrWLU7QcDM/MXp01f8GAEAIpYgeJcFHGttbW0NZQYAEonECIDPw8T4aWho5PLAQD5ECJIcp6kmlxHMHNE0bQTAPr/au4XCnVe6us4bhhH4dB3AcYBzoU8GAIjIEkIcgbch9D4syzJ7e3sHwhgBc5Uk6VI+ny/UxAwAKIqSAfCOH01/X9/V30dHSwFTMgMTUds+k8lk/gI24eJc07Q+Zu5y401PTU2+1tPzbYAUi8w8jkjkj0wmM7t6oeZmyuXyTsMwpqPRqLpuNZWKcezo0a/y2aynkYWZLBCnWYhUS0vLxPDwsLUWz/ftjBvq6+v/SaVSbzQ2Nl7G2pvF586cueJmhJlMASdHQqSciDSZTqeXACCbXf9TqeYns4Lx8fGLzc3Nj0wHv1679tvbx4//uI5sEURZAUzLdXUTqVSq6ifnppnJ5XJbmXlKUZSWlWelUqnYdejQuYWFhfttwkAFzDcjQtx4Ye/edH9/f+A3W83bbAVtbW33hoaGuuvr638WQsiWZdmfnjo1sGxkHkRpCZjuyeVufgQ4ADCVy21WObXB4ODgJ4VCYfHC+Qtfd7S3v9TR0dGETeyIxwb/Abxf6DIUZxAeAAAAAElFTkSuQmCC',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAS9SURBVFiF3VhNbFRVFP7Ond9OlBnApihJM1N0EqltQzoJLFxAQiKrruhCjXFh3GhcEGowGomiJEhYUJtUiTFCGEJsBX9CU2pQqzZB6WtLOgw0MNN5TUSggtNp6Tw6fe8dNyWp0Pa9d9/Mhm8593zfOd+9J/educAjBCq34MDAwOPBYHAHM7cQ0UYATwJYC+AOgL+J6LJpmj+EQqGz9fX1d8uZu2xmRkdHV8/Pz7/DzG8BqLJBKQLo8Hg8BzZt2jRVjhrKYmZwcHAnER0BsEaC/i8Rvd7c3HzabR3CDZmZSVGUvUTUBTkjALCGmb9RFOV9Zna1ua7MDA8P7wXwIdyfMAHYNzQ09J5bESkstFaXG40lYBLRzubm5m9lyFKFjIyMRAzDyEK+tVZC3u/3b2hsbMw7JUq1ma7r76IyRgBgdalUeluG6PhkFr4jt2Dv+pVFsaqqqsbpd8jrNEswGNwBG0aEEMVYLHYhHA7XEdE6Zr5ZKBTGc7ncZtM0rfihYrH4AoBTTmpz3GbM3GIpKkSxqalpPBKJbCWiWgB+IqqNRCJbGxoaMkIIzUqDiCzzPJTXKYGInrWKicViF4QQzy215vV6G6LR6J9WGsy80WltMhfAU1YB4XC4bqX1SCQSs9IgIss8D0LGzFobhaxzs76AJ2xXtAAZMzNWAcx802L9ho0807YrWoCMmVtWAYVCYXyl9ampKdVGnhU3ZCnImLlgFZDL5Tbrup5aak3X9ZSqqlusNIjIMs+DkLmaf7GKMU2zKpVKPZ3P5/uZeQJAiZkn8vl8fyqVesY0zaANjX6ntTmeANLp9GOapv0FIOyU6wAFn8+3vqmpadYJyfHJ1NfX32Xmr5zyHOJLp0YAyUEzEAjsAzApw7WBSb/f/7EMUcrMwni+S4ZrA7tkxn/A5R8rRVFOAHjJjcZiGIZxsrW19U0hRCDAXDVHFPAxk24IHwB4Pea8LoRJRJp/bm624fr1qW7AuM93ayYM4CKAqCsXADRNm9qze/eRycnJe3Y5zGQQQ/UK/n1MVVVXbwCJRKIA4BUs2h0ZMDMfP3bseydGAICIPRC8QQdejUajUVdmACCRSAwAOOhGQxkcHPj53DnVhQR5THO9azMAMDMzsxeA5Vi/FO7cvn2js6PjVzf5TcA0hMiWxcy2bdt0AC/DxhC6GLquz3/W2XlK0zT5NmUukcdzWlXVm2UxAwCJRCJLRG1OOD/29Z29NDp6RzIlM3AlYBifZ7PZS0AFHs4VRekC0GoVN6GqY3va2r6WSKEx8yi83qFsNvu/D7fjBw0beKNUKm33+/2rlwu4p2mz7e3tZ+wKMpMO4gwLka6trb3S39+vLxVX9pMBgN7e3pbq6urvltHn40ePnuw5c+baShrMNC9g5kiItOnxjGUymTmrvBUxAwA9PT0nampqHpoOLo6M/HFg//6+ZWgaiMYFcNUXCl1Jp9MlJzkr0WYAgFAo9Nr09PTzq1atqr3/W6FQ+OfTw4d/WhzHQBHM17xCXG5MJDLd3d3SN1vFTgYAksnklng8/psQwqfrunH40KEvFEW5BaAAoowHuPpiLnftA8CsZB1lQzKZ/Oj8+fPawU8OJuN1ddvj8fh6VHgTHwn8B/S71Ufd4vUbAAAAAElFTkSuQmCC',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATTSURBVFiF3VhPTBRXHP7e2xmBTYwgDXVdQ6m2hxrsyaweeoCkSXtQExOZ0JLSQ9NLmx5MbGya1P49NCRoQg9UG1MTA5RZEbegsYemVE1gMU1JBRZhF9dkccHGAkUXZmfe/HooJJTCzs6b5dB+yV7m/b7v9/veezvvNw/4H4EVWjASiWzNZrOvAjhCRHsBBACUA3gE4AGAUQDfA7iuadrjQuYumJm2trYyRVE+YIy9B6AkD0qGMfaVoihfHj16dK4QNRTEjK7rxwCcBbBdgv4HY+zturq6y17r4F7IRMR0XT8FQIecEQDYTkSXOjs7PyIiT5Pr80Kurq7+GMCn8L7CjDFWG4vFrHA4fENaRJa4vLV0LxrrwAZwTNO0bhmyVCHd3d2lpmkmIL+1cmHWNM09DQ0Ns26JUv8Z0zQ/xOYYAYAyRVHelyG6XplIJLLVMIwZ5Pf6lUUGwNNuzyHFbZblA9HRiKIomVAoNBgIBHZzznfYtj2dTqcno9HoASGEE99PRK8A6HJTm8w2O+IUoChK5tChQ5PBYLCGc14JYAvnvDIYDNYcPnw47vP5FguRZy1cmyGiF5xiQqHQoKqq1euNqaq6LxQKRZ00GGN73dYmszI7nQICgcDunAI7dz5biDxrIWOm3FGU8x1expfxVN4Vrei6JQBYcAqwbXs61zgRpfPI82feFS1DxsyMU0A6nZ7MNT41NZXMI0/OCVkPMmYGnQKi0egB0zTvrDeWzWbvDA4OHnTSYIw55lkL12YYYz85xQghSnp6ep5LpVJ9tm3fB5C1bft+KpXq6+3tfV4IUeykQUR9bmtzfWgS0WUALQC25YoTQpT09/fXrHr0zPIvH8wvLS25/r5xvTKapj0mom/d8lzifGNj4xO3JKlG07KszwA8lOHmgYemaX4hQ5Qys9yeH5fh5oHjMu0/4PHDStf1NgCve9FYDSFEx8mTJ9/lnBcVEZUYjBWpRMwSXAUAxWebFuc2Y2xxi2E82Tc1NRcGxArfq5ltAIYAVHlyAcAwjLmW06fPzs7OLuXLIWKCEZIKp5tjyWTS04WGpmnzAN7AqtmRBF27ejXixggAMEY+cNpjAW9WVVVVeTIDAJqm3SKiJi8ao8PDt24PDCQ9SDCfbQc9mwGAioqKUwAc2/r1MD83lw53dv7sJb8N2ILzREHM1NbWWrZtNyCPJnQ1hBDmpXC4yzAM+W1KlGU+3+VkMjldEDMAUF9fnwBwwg0n2t9/PTEx8UgyJREQKxLi60QiMQxswsW5rus6gDqnuOl0eqzlzJlOiRSLRPQbFOWXRCLxj4PbdW/mBMuy3iGil1VVLdsoJmsYTzra23vz1SRiFhjFifORysrKWF9fn7VeXMFXBgDOnTt3pLS09MoG+nStp6fj1s2bE7k0iJjJYd9jnI/YPt9YPB43nPJuihkAaG1tbSsvL/9XdzB+9+7AhfPnf9iAtgjGJjkwrvr9sZGRkaybnAXfZisoLi5+K5PJvOT3+ytXni0sLPz+XXv7j6vjCMiAaELhfPTF/fvj4XBY+s22aSsDAM3NzQeDweANzrkqhBAdFy9+Mzo6OgNgHozFfcD4a/fuTXzy94W5Z2yqGQBoamr6fNeuXSeGfh3qutJ16QIUJTY+Pv4AAG127v80/gIGr+iWe+FGsAAAAABJRU5ErkJggg==',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAToSURBVFiF3VhdbFNlGH7ec05/F6IUE9GLIYgXXYpXJBBZE0xM9EausIl6ObzBGSHRdnEJ1p+RhnBBNF4YY/xJFigNaIwxLpFYB2WwMWCW0bG1W7eEdUBwQ0fb7fy83nQJjK3nnO90F/okvTnf+7zP+/Q75/ve7wP+R6BGJ4xGo+skSXqFmfcAaAHwFIANAO4CmCai64Zh/OT3+3+Nx+PzjdRumJmOjo71zNwB4B0APguUMjN/vri4mDh27NhcI2poiJloNLqXiL4EEBCg/8XMbx05cuS00zpkh3yKxWKHiOgLAH7BHD4iiuzatcvIZDJnnRTjyEw0Gv2QiD6C8xkmInqxtbVVy2QyvcJJRIm1V+ukkxwrwCCivYlE4gcRslAhBw4ceNzj8RQg9o2YYZaInk0kErN2iZKImtvt/gBrYwQA1gN4X4Roe2ai0eg6IroFa8uvKMo+n+9Ju/uQYleltiGaGnG73eVIJNIfDAa3yLK8Udf1mVwuN55MJneoqmrG91er1ZcBnLJVm51gAKjt7HXhdrvLnZ2d46FQaLcsy80A3LIsN4dCod2dnZ15l8tVaYTOcoh8M0GzgEgk0u/xeEIrjXm93m2RSOSiBZ0Wu4WJmHnaLCAYDG6pN97S0rK5ETrLIWJmg1mALMsbnYzX8ITlimoQMfOPWYCu6zMm4yULOn9brqgGETO3zAJyudx4vfFr164VzXIwc90/ZCWImOk3C0gmkzuq1Wp2pbFyuZxNpVI7zXIQkanOcoiY+d0sQFVVX1dX19ZsNpvWdX0SwKKu65NDQ0Ppw4cPP6dpmtcsBzOn7RZme9P0+XynK5XKZwAeqxenqqqvu7t79wOPNtV+VnDPMAzb5xvbM1NrMb6xy7OJr48ePXrfLkmo0SSijwHcFuFawG0i+lSEKGSm1p4fFOFawEGR9h9weLCKxWLdAN5wkuNBMPPxEydOvC1JksfD7Fsg8riYSdMlFwAosqFqkmQQUcW9sHB/282bcylAX+LbXgCWYT+AFwA84zAPVFWdO9PTM+WWpHcBQCeCAoCJICsMAGAQZGaAGZrLhcubNutbGUVF4rMjxWLR8ZE3Fou1AkjDwX0CM/OVwcHvJwqFomgKDfjO6e0MMpnMVDgc9gIIi+YoTU+fyw4NXXFQBpFh3BFaAJbD6/UeAmClrX8ElXK5dOnixT+c6BuAoUtSoSFm4vG4ZhjGm7DQhD5UhGGoAwMDp1RV1c2jVwHzIsny6WKxOOP4NVvC+fPnZ8Ph8F0Ar1rlFPL5X8bHxuo2pXXADIx4df3kjcnJSWANLs5jsdhJAK+Zxd2bmxv5racnKSBRYeY/oSiDhULhoY3b6dL8CDRN209EL8myvH7VGFW9f6Gv72erOZlJA3GeJWm4ubk5l06ntZXiGj4zANDe3r6nqanpx1Xyc/bq1eOjN26M1cvBTKoEY4IkadiQ5ZF8Pr9gprsmZgCgvb29u6mp6ZHuYKZUupDp7e1ZhVYB0bgEjLr8/tzw8PCiHc2Gv2ZLmJ+fb1MUpdXj8TQvPatWq3f6+/rOPBjHQBnMY4okXX9++/Z8KpUSXtnWbGYAYN++fTsDgUAvEbkMw9AvnDv3ValUugXgHojyMjD6+sTEWBwwGqG3pmYAoK2t7ZNAIPDe1OTUqSuXBr6FouRGR0enAfBaa/+n8S8PPeWMetb8+wAAAABJRU5ErkJggg==',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAATISURBVFiF3VhNbBtFGH0z3vXGbqpSikQBKSIOHKgop0quYtMadSsqVfRCoQo9IjiAuAXJ4lB+D0Q5Ig4VQvxIVZREKQhRRNoiNi2VcBECUaUNjmM7VRPHcdP81HGc/ZmPSyKVNMnuzjoHeEfPe9/73s54dnaA/xFYowsmEont0Wj0iBDiGGNsD4BHAOwCMANgEsB1IvrOcZwfDcOoNtK7YWGOHj260zTNNBG9BSDiQVID8Ilt2x8bhjHXiB4aEubQoUPHGWOnATwoIb8D4LWLFy+eDdpHKKCeHT58+BSATwFEJWtEALzc2toqCoXC5SDNBAqj6/q7AN5H8BlmjLHnYrGYnc/nL0kXkRWuLK2+IDXWgWCMHb9w4cI3MmKpRlKp1AOKooxB7j/ihllN09rOnTs361fIZdwURXkHWxMEAHaapvm2jND3zCQSie2RSKQMb9uvLGq2bT/s9z2k+HWJRqNHiMg1iKZptXQ6fTUej8dUVd1tWdZUJpPJd3V1xev1ups+qijK8wAG/PTme5kJIY65cTRNq/X29uaTyWRKVdUWAGFVVVuSyWSqp6cn19TUtOTBytVnLXyHYYw95cZJp9NXt23b9vR6Y83NzXs7OzszHqz2+O1NZgN41I0Qj8djm423t7e3NsJnLWTC7HIjqKq6O8j4Ch7y3NEKZMLcdSNYljXlMl7y4LPguaMVyIQpuxEymUx+s/ErV64UPfhs+kDWg+8wRHTVjdPV1RWvVqvX1hurVqvXuru793uwcvVZC5nd7Gc3Tr1ej3R0dDwxNDRkWJY1DsC0LGvcMAzjxIkTT5qm2eTBx/Ddm19BKpVqVhTlFoAdfrU+MM85f+z8+fOLfkS+Z2bliPGFX50fMMY+9xsEkDxoapr2AYBpGa0HTIfD4Y9khFIfZ6Ojo/VYLDYJ4EUZvQteHxwc/E1GGOjDStf1MwBeCVJjDXqy2eybnHNNI4osM6apRMx2uAoASkhYNueCMbYUXl5e3DsxMdcPOKvioGF2ENGfjLHHg2UAhBBzpVu3TlumWfeqIWIOIxQVTpdHisVi4E9eXdeTAAwEuE8gIpqpVL6uLiwUZUvYwFdBb2eQz+dvtrW1NQF4VrbGUq32y+zMzB8B2mBMiIrUbrYWlmWdAuDlWH8fbMsqzUxPDwXxF4BwOB9rSBjDMGwhxEl4OITeCyKyKpXKgOM4jjt7wyImC4XOFovFqcDLbBWFQmE2FovNAHjBq+buwsIP1fn5TQ+lm4AIGGlynL6/x8fHgS24ONd1vQ/AS248yzRHJm7e7JWwWCKiv6Aov4+Njf3rxe37QsMNtm2/wTnXOec7N+KQEIvlcvl7rzWJmA1GOeJ8uKWl5YZhGPZ6vIbPDAAcOHDgWDgc/naD+jR7+3bP/Nzc6GY1iJjFIQqM82ERCo3kcrllN98tCQMABw8ePKOq6n2ng6Va7dfy5OTgBrIlMJbnQFaNRm8MDw+bfjwbvsxWwRh71XGcZCgUaln9zXGcynSp9NO9PAJqIBpVOL/+zL59uf7+fumdbctmBgASicT+SCRyCYBKRE6lVPqsVquVAcyDsVwIyHYUCqPvAaIRflsaBgCSyeSHmqZ1Lt5dHLhze/pLKMqNbDY7CYC22vs/jX8A/Nff8x41WYEAAAAASUVORK5CYII=',
                        anchor: [
                            0.5,
                            1
                        ]
                    },
                    {
                        src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAPjSURBVFiF3ZlNbxtVFIafe2cceyZxEitfqiMs1EUWSLDqggXskOiGSqCyoAj+AH8BChISAv5ABahCBaoGJziISAhWMR8LECBQUNo0cZpJpLQNVWMDTZxre+ayMIGQOp7J2DMFXuls5p57zvver7lzBv5HEBHETAMngVPAA8AxYAi4DVwHLgOfAJ8BdyLI3xVkgDeAHUAHsG3gdWDwXpBth9M0Rz6IiIN2G3gqfsp3QwBnAY9wQvbMA14immUfGC/TmYiD9mK89P/GaTqfkYPmAk/GKQKamzbsHvGzLZqHSWx4MwIR++21uISkCX78hrVtoO+oxGQIMScBy8/Jtu2dQqFQVEqta61rSqn16enpomVZ1QA5bODxENyOjPfxGVnbtrcrlcrPugXK5fK8ZVlBZvZCHGK+9yNSKBTmWgnZQz6fnwsg5rs4xFz3I6KUWmsnRinlBBCzcVRiYd64Cuhp56C1rvn4KCFE0idPDfDz+QfCHAC/+znUarWbPu03AuT5LTCjPxFGzKafw+zs7LV27TMzM06APG0HpFt4F5/1blnWTrlcnm+1X7a2tuZTqVTVLwZwPg4xzwcgoi3L2snn83NKKae555UzOTk5F1CIBp6LQ0wfUAlIKKxVgN6jEguzZ+7QXGpR4jzNK00syNA8CKKYlU1ivjUDnOkC8VZ2JiyhTj9TL3aSvAUu5XK5F6SUyaTWlhIimdBaNFyZADANr96Q0hNCVHuU2n5wY6My1fygAzoXMwD8BNzfYRyklJVcNvuWaZq7QftoLVyhcUypv1p0HKcbBYRHgCJgdBBDjwwNvTeQTjth+zfgQicE9rAOpIBHwwbo6+39ejiT+bEDDkJ43q0wR3MrnAW+DdPRNIwbY8PDX3SS3APPlXKlW2IawLMEuITuhxCiPjoy8pEQwvX3PgRa14RhFBzHudmNZbaHMs2KzRNBOwz29386kE63vZS2gdawmHLd/NW1tTWIpoKYB572c0r29Czel81+GCJ+VWs9j2n+sLKy8sv+hijEDAshlrTWh77FpRDb4+Pj55KmGejKorVoIHRJS7mQy+WuFIvFRiu/SGq7hmGccl3340Pi6+FM5tLgwMByuxhai7rEWxVSLniGsVgqlZRf3sgK1YlE4mK9Xr/rdmBb1jfZsbHPD+lWRYhrEpYStn1lYWGhdpScUVbdU1LKq57n5fYeGIZxK5fNvm0Yxl/LRMMOWi+bUl5+6MSJ0tTUVOiTLdJfCJZlPby7u/ul1joBuMdGR9/pte1N4FeEKBmw9Mzq6vIrzQL8vx+pVOpVIUS1v6//g4njxx+bmJgY5x7/h/lP4A+AJ7grnrOyCgAAAABJRU5ErkJggg==',
                        anchor: [
                            0.5,
                            1
                        ]
                    }
                ];
                if (!this.options.labels) {
                    this.options.labels = {};
                }
                Object.keys(Drawing.DefaultLabels).forEach(function (key) {
                    if (!this.options.labels.hasOwnProperty(key)) {
                        this.options.labels[key] = Drawing.DefaultLabels[key];
                    }
                }, this);
                if (!this.options.defaultStyles) {
                    this.options.defaultStyles = {};
                }
                Object.keys(Drawing.DefaultStyles).forEach(function (key) {
                    if (!options.defaultStyles.hasOwnProperty(key)) {
                        this.options.defaultStyles[key] = Drawing.DefaultStyles[key];
                        return;
                    }
                    if (key == 'polyFillOpacity' && (options.defaultStyles[key] < 0 || options.defaultStyles[key] > 1)) {
                        console.log('Wrong value (' + options.defaultStyles[key] + ') for defaultStyles.polyFillOpactity. Must be between 0 and 1');
                        this.options.defaultStyles[key] = Drawing.DefaultStyles[key];
                        return;
                    }
                    if (key == 'strokeWidth' || key == 'polyStrokeWidth') {
                        var intValue = parseInt(options.defaultStyles[key], 10);
                        if (isNaN(intValue) || intValue < 0) {
                            console.log('Wrong value (' + options.defaultStyles[key] + ') for defaultStyles.strokeWidth. Must be a positive interger value.');
                            this.options.defaultStyles[key] = Drawing.DefaultStyles[key];
                            return;
                        }
                        this.options.defaultStyles[key] = intValue;
                    }
                }, this);
                this.interactionCurrent = null;
                this.interactionSelectEdit = null;
                this.stylingOvl = null;
                this.layer = null;
                if (this.options.layer && this.options.layer instanceof _ol2.default.layer.Vector) {
                    this.layer = this.options.layer;
                }
                this._isDesktop = this._detectSupport();
            };
            Drawing.prototype._createEmptyLayer = function () {
                var features = new _ol2.default.Collection();
                var layer = new _ol2.default.layer.Vector({ source: new _ol2.default.source.Vector({ features: features }) });
                layer.gpResultLayerId = 'drawing';
                this.setLayer(layer);
            };
            Drawing.prototype.setLayer = function (vlayer) {
                if (!vlayer) {
                    this.layer = null;
                    return;
                }
                if (!(vlayer instanceof _ol2.default.layer.Vector)) {
                    console.log('no valid layer given for hosting drawn features.');
                    return;
                }
                var layers = this.getMap().getLayers();
                if (layers) {
                    var found = false;
                    layers.forEach(function (mapLayer) {
                        if (mapLayer == vlayer) {
                            logger.trace('layer already in map. Not adding.');
                            found = true;
                        }
                    }, this);
                    if (!found) {
                        this.getMap().addLayer(vlayer);
                    }
                    vlayer.getSource().getFeatures().forEach(function (feature) {
                        var featureStyleFunction = feature.getStyleFunction();
                        if (featureStyleFunction) {
                            var styles = featureStyleFunction.call(feature, 0);
                            if (styles && styles.length !== 0) {
                                feature.setStyle(styles[0]);
                            }
                        }
                    });
                }
                this.layer = vlayer;
            };
            Drawing.prototype._detectSupport = function () {
                var isDesktop = true;
                var userAgent = window.navigator.userAgent.toLowerCase();
                if (userAgent.indexOf('iphone') !== -1 || userAgent.indexOf('ipod') !== -1 || userAgent.indexOf('ipad') !== -1 || userAgent.indexOf('android') !== -1 || userAgent.indexOf('mobile') !== -1 || userAgent.indexOf('blackberry') !== -1 || userAgent.indexOf('tablet') !== -1 || userAgent.indexOf('phone') !== -1 || userAgent.indexOf('touch') !== -1) {
                    isDesktop = false;
                }
                if (userAgent.indexOf('msie') !== -1 || userAgent.indexOf('trident') !== -1) {
                    isDesktop = true;
                }
                return isDesktop;
            };
            Drawing.prototype._initContainer = function () {
                var container = this._createMainContainerElement();
                var inputShow = this._showDrawingContainer = this._createShowDrawingElement();
                container.appendChild(inputShow);
                var picto = this._createShowDrawingPictoElement();
                container.appendChild(picto);
                var panel = this._createDrawingPanelElement();
                container.appendChild(panel);
                return container;
            };
            Drawing.prototype._drawEndFeature = function (feature, geomType) {
                var style = null;
                switch (geomType) {
                case 'Point':
                    style = new _ol2.default.style.Style({ image: new _ol2.default.style.Icon(this._getIconStyleOptions(this.options.markersList[0])) });
                    break;
                case 'LineString':
                    style = new _ol2.default.style.Style({
                        stroke: new _ol2.default.style.Stroke({
                            color: this.options.defaultStyles.strokeColor,
                            width: this.options.defaultStyles.strokeWidth
                        })
                    });
                    break;
                case 'Polygon':
                    style = new _ol2.default.style.Style({
                        fill: new _ol2.default.style.Fill({ color: this.hexToRgba(this.options.defaultStyles.polyFillColor, this.options.defaultStyles.polyFillOpacity) }),
                        stroke: new _ol2.default.style.Stroke({
                            color: this.options.defaultStyles.polyStrokeColor,
                            width: this.options.defaultStyles.polyStrokeWidth
                        })
                    });
                    break;
                }
                feature.setStyle(style);
                this._updateMeasure(feature, geomType);
                var popupOvl = null;
                var context = this;
                var setAttValue = function setAttValue(value, save) {
                    context.getMap().removeOverlay(popupOvl);
                    if (save && value && value.trim().length > 0) {
                        var formated = value.replace(/\n/g, '<br>');
                        feature.setProperties({ description: formated });
                    }
                };
                var popup = this._createLabelDiv({
                    applyFunc: setAttValue,
                    inputId: this._addUID('att-input'),
                    placeholder: 'Saisir une description...',
                    measure: this.options.tools.measure ? feature.getProperties().measure : null,
                    geomType: geomType
                });
                popupOvl = new _ol2.default.Overlay({
                    element: popup,
                    positioning: 'top-center'
                });
                this.getMap().addOverlay(popupOvl);
                var geomExtent = feature.getGeometry().getExtent();
                popupOvl.setPosition([
                    (geomExtent[0] + geomExtent[2]) / 2,
                    (geomExtent[1] + geomExtent[3]) / 2
                ]);
                document.getElementById(this._addUID('att-input')).focus();
            };
            Drawing.prototype._createRemoveInteraction = function () {
                var interaction = new _ol2.default.interaction.Select({ layers: [this.layer] });
                interaction.on('select', function (seEv) {
                    if (!seEv || !seEv.selected || seEv.selected.length == 0) {
                        return;
                    }
                    this.layer.getSource().removeFeature(seEv.selected[0]);
                    this.getMap().removeInteraction(this.interactionCurrent);
                    this.interactionCurrent = this._createRemoveInteraction();
                    this.getMap().addInteraction(this.interactionCurrent);
                }, this);
                return interaction;
            };
            Drawing.prototype._createStylingInteraction = function () {
                var interaction = new _ol2.default.interaction.Select({ layers: [this.layer] });
                interaction.on('select', function (seEv) {
                    if (this.stylingOvl) {
                        this.getMap().removeOverlay(this.stylingOvl);
                    }
                    if (!seEv || !seEv.selected || seEv.selected.length == 0) {
                        return;
                    }
                    var valuesColor = null;
                    var hexColor = null;
                    var popupOvl = null;
                    var geomType = null;
                    var initValues = {};
                    if (seEv.selected[0].getGeometry() instanceof _ol2.default.geom.Point) {
                        var _label = seEv.selected[0].getProperties().name;
                        if (seEv.selected[0].getStyle().getText() && _label) {
                            geomType = 'Text';
                            if (seEv.selected[0].getStyle().getText().getStroke() && seEv.selected[0].getStyle().getText().getStroke().getColor()) {
                                valuesColor = seEv.selected[0].getStyle().getText().getStroke().getColor();
                                if (Array.isArray(valuesColor)) {
                                    valuesColor = 'rgba(' + valuesColor.join() + ')';
                                    hexColor = this.rgbaToHex(valuesColor);
                                    initValues.strokeColor = hexColor.hex;
                                    initValues.strokeOpacity = hexColor.opacity;
                                } else {
                                    initValues.strokeColor = valuesColor;
                                }
                            }
                            if (seEv.selected[0].getStyle().getText().getFill() && seEv.selected[0].getStyle().getText().getFill().getColor()) {
                                valuesColor = seEv.selected[0].getStyle().getText().getFill().getColor();
                                if (Array.isArray(valuesColor)) {
                                    valuesColor = 'rgba(' + valuesColor.join() + ')';
                                    hexColor = this.rgbaToHex(valuesColor);
                                    initValues.fillColor = hexColor.hex;
                                    initValues.fillOpacity = hexColor.opacity;
                                } else {
                                    initValues.fillColor = valuesColor;
                                }
                            }
                            initValues.strokeColor = initValues.hasOwnProperty('strokeColor') ? initValues.strokeColor : this.options.defaultStyles.textStrokeColor;
                            initValues.fillColor = initValues.hasOwnProperty('fillColor') ? initValues.fillColor : this.options.defaultStyles.textFillColor;
                        } else if (seEv.selected[0].getStyle() && seEv.selected[0].getStyle().getImage()) {
                            geomType = 'Point';
                            if (seEv.selected[0].getStyle().getImage().getSrc()) {
                                initValues.markerSrc = seEv.selected[0].getStyle().getImage().getSrc();
                            } else {
                                initValues.markerSrc = this.options.markersList[0].src;
                            }
                        }
                    } else if (seEv.selected[0].getGeometry() instanceof _ol2.default.geom.LineString) {
                        geomType = 'Line';
                        if (seEv.selected[0].getStyle() && seEv.selected[0].getStyle().getStroke()) {
                            if (seEv.selected[0].getStyle().getStroke().getWidth()) {
                                initValues.strokeWidth = seEv.selected[0].getStyle().getStroke().getWidth();
                            }
                            if (seEv.selected[0].getStyle().getStroke().getColor()) {
                                valuesColor = seEv.selected[0].getStyle().getStroke().getColor();
                                if (Array.isArray(valuesColor)) {
                                    valuesColor = 'rgba(' + valuesColor.join() + ')';
                                    hexColor = this.rgbaToHex(valuesColor);
                                    initValues.strokeColor = hexColor.hex;
                                    initValues.fillOpacity = hexColor.opacity;
                                } else {
                                    initValues.strokeColor = valuesColor;
                                }
                            }
                        }
                        initValues.strokeWidth = initValues.hasOwnProperty('strokeWidth') ? initValues.strokeWidth : this.options.defaultStyles.strokeWidth;
                        initValues.strokeColor = initValues.hasOwnProperty('strokeColor') ? initValues.strokeColor : this.options.defaultStyles.strokeColor;
                    } else if (seEv.selected[0].getGeometry() instanceof _ol2.default.geom.Polygon) {
                        geomType = 'Polygon';
                        if (seEv.selected[0].getStyle() && seEv.selected[0].getStyle().getStroke()) {
                            if (seEv.selected[0].getStyle().getStroke().getWidth()) {
                                initValues.strokeWidth = seEv.selected[0].getStyle().getStroke().getWidth();
                            }
                            if (seEv.selected[0].getStyle().getStroke().getColor()) {
                                valuesColor = seEv.selected[0].getStyle().getStroke().getColor();
                                if (Array.isArray(valuesColor)) {
                                    valuesColor = 'rgba(' + valuesColor.join() + ')';
                                    hexColor = this.rgbaToHex(valuesColor);
                                    initValues.strokeColor = hexColor.hex;
                                    initValues.strokeOpacity = hexColor.opacity;
                                } else {
                                    initValues.strokeColor = valuesColor;
                                }
                            }
                        }
                        if (seEv.selected[0].getStyle() && seEv.selected[0].getStyle().getFill()) {
                            if (seEv.selected[0].getStyle().getFill().getColor()) {
                                valuesColor = seEv.selected[0].getStyle().getFill().getColor();
                                if (Array.isArray(valuesColor)) {
                                    valuesColor = 'rgba(' + valuesColor.join() + ')';
                                }
                                hexColor = this.rgbaToHex(valuesColor);
                                initValues.fillColor = hexColor.hex;
                                initValues.fillOpacity = hexColor.opacity;
                            }
                        }
                        initValues.strokeWidth = initValues.hasOwnProperty('strokeWidth') ? initValues.strokeWidth : this.options.defaultStyles.polyStrokeWidth;
                        initValues.strokeColor = initValues.hasOwnProperty('strokeColor') ? initValues.strokeColor : this.options.defaultStyles.polyStrokeColor;
                        initValues.fillColor = initValues.hasOwnProperty('fillColor') ? initValues.fillColor : this.options.defaultStyles.polyFillColor;
                        initValues.fillOpacity = initValues.hasOwnProperty('fillOpacity') ? initValues.fillOpacity : this.options.defaultStyles.polyFillOpacity;
                    }
                    if (!geomType) {
                        console.log('Unhandled geometry type for styling.');
                        return;
                    }
                    var dtObj = this;
                    var applyStyle = function applyStyle(action) {
                        if (action == 'cancel') {
                            dtObj.getMap().removeOverlay(popupOvl);
                            return;
                        }
                        var setDefault = action != 'apply';
                        var fillColorElem = document.getElementById(dtObj._addUID('fillColor'));
                        var fillOpacityElem = document.getElementById(dtObj._addUID('fillOpacity'));
                        var strokeColorElem = document.getElementById(dtObj._addUID('strokeColor'));
                        var strokeWidthElem = document.getElementById(dtObj._addUID('strokeWidth'));
                        switch (geomType.toLowerCase()) {
                        case 'text':
                            if (setDefault) {
                                dtObj.options.defaultStyles.textStrokeColor = strokeColorElem.value;
                                dtObj.options.defaultStyles.textFillColor = fillColorElem.value;
                            } else {
                                seEv.selected[0].setStyle(new _ol2.default.style.Style({
                                    text: new _ol2.default.style.Text({
                                        font: '16px sans',
                                        textAlign: 'left',
                                        text: seEv.selected[0].getStyle().getText().getText(),
                                        fill: new _ol2.default.style.Fill({ color: fillColorElem.value }),
                                        stroke: new _ol2.default.style.Stroke({
                                            color: strokeColorElem.value,
                                            width: 3
                                        })
                                    })
                                }));
                            }
                            break;
                        case 'point':
                            var markerSelected = dtObj._getsMarkersOptionsFromSrc(document.querySelector('input[name=\'marker\']:checked').value);
                            if (setDefault) {
                                if (dtObj.options.markersList.length > 1) {
                                    var idxMarker = dtObj.options.markersList.findIndex(function (mrk) {
                                        if (mrk == markerSelected) {
                                            return true;
                                        }
                                        return false;
                                    });
                                    if (idxMarker > 0) {
                                        dtObj.options.markersList.splice(idxMarker, 1);
                                        dtObj.options.markersList.splice(0, 0, markerSelected);
                                    }
                                }
                            } else {
                                seEv.selected[0].setStyle(new _ol2.default.style.Style({ image: new _ol2.default.style.Icon(dtObj._getIconStyleOptions(markerSelected)) }));
                            }
                            break;
                        case 'line':
                            if (setDefault) {
                                dtObj.options.defaultStyles.strokeColor = strokeColorElem.value;
                                dtObj.options.defaultStyles.strokeWidth = parseInt(strokeWidthElem.value, 10);
                            } else {
                                seEv.selected[0].setStyle(new _ol2.default.style.Style({
                                    stroke: new _ol2.default.style.Stroke({
                                        width: parseInt(strokeWidthElem.value, 10),
                                        color: strokeColorElem.value
                                    })
                                }));
                            }
                            break;
                        case 'polygon':
                            var opacity = parseInt(fillOpacityElem.value, 10) / 10;
                            if (setDefault) {
                                dtObj.options.defaultStyles.polyStrokeColor = strokeColorElem.value;
                                dtObj.options.defaultStyles.polyFillColor = fillColorElem.value;
                                dtObj.options.defaultStyles.polyFillOpacity = opacity;
                                dtObj.options.defaultStyles.polyStrokeWidth = parseInt(strokeWidthElem.value, 10);
                            } else {
                                seEv.selected[0].setStyle(new _ol2.default.style.Style({
                                    stroke: new _ol2.default.style.Stroke({
                                        width: parseInt(strokeWidthElem.value, 10),
                                        color: strokeColorElem.value
                                    }),
                                    fill: new _ol2.default.style.Fill({ color: dtObj.hexToRgba(fillColorElem.value, opacity) })
                                }));
                            }
                            break;
                        }
                        if (!setDefault) {
                            dtObj.getMap().removeOverlay(popupOvl);
                        }
                    };
                    var popupDiv = this._createStylingDiv({
                        geomType: geomType,
                        initValues: initValues,
                        applyFunc: applyStyle
                    });
                    popupOvl = new _ol2.default.Overlay({
                        element: popupDiv,
                        positioning: 'top-center'
                    });
                    this.getMap().addOverlay(popupOvl);
                    popupOvl.setPosition(seEv.mapBrowserEvent.coordinate);
                    this.stylingOvl = popupOvl;
                    this.getMap().removeInteraction(this.interactionCurrent);
                    this.interactionCurrent = this._createStylingInteraction();
                    this.getMap().addInteraction(this.interactionCurrent);
                }, this);
                return interaction;
            };
            Drawing.prototype._createLabelInteraction = function () {
                var interaction = new _ol2.default.interaction.Select({ layers: [this.layer] });
                interaction.on('select', function (seEv) {
                    if (this.labelOvl) {
                        this.getMap().removeOverlay(this.labelOvl);
                    }
                    if (!seEv || !seEv.selected || seEv.selected.length == 0) {
                        return;
                    }
                    var popupOvl = null;
                    var geomType = null;
                    var _textValue = null;
                    var _measure = null;
                    if (seEv.selected[0].getGeometry() instanceof _ol2.default.geom.Point) {
                        var _label = seEv.selected[0].getProperties().name;
                        if (seEv.selected[0].getStyle() && seEv.selected[0].getStyle().getText() && _label) {
                            geomType = 'Text';
                        } else if (seEv.selected[0].getStyle() && seEv.selected[0].getStyle().getImage()) {
                            geomType = 'Point';
                        }
                    } else if (seEv.selected[0].getGeometry() instanceof _ol2.default.geom.LineString) {
                        geomType = 'Line';
                    } else if (seEv.selected[0].getGeometry() instanceof _ol2.default.geom.Polygon) {
                        geomType = 'Polygon';
                    }
                    if (!geomType) {
                        console.log('Unhandled geometry type for styling.');
                        return;
                    }
                    if (geomType == 'Text') {
                        _textValue = seEv.selected[0].getStyle().getText().getText();
                    } else {
                        var featProps = seEv.selected[0].getProperties();
                        if (featProps && featProps.hasOwnProperty('description')) {
                            _textValue = featProps['description'];
                        }
                        if (featProps && featProps.hasOwnProperty('measure')) {
                            _measure = featProps['measure'];
                        }
                    }
                    var context = this;
                    var setTextValue = function setTextValue(value, save) {
                        context.getMap().removeOverlay(popupOvl);
                        if (!save) {
                            return;
                        }
                        var feature = seEv.selected[0];
                        if (geomType == 'Text') {
                            var style = feature.getStyle();
                            style.getText().setText(value);
                            feature.setProperties({ name: value });
                            feature.setStyle(style);
                            return;
                        }
                        var _formated = value.replace(/\n/g, '<br>');
                        feature.setProperties({ description: _formated });
                    };
                    var popupDiv = this._createLabelDiv({
                        applyFunc: setTextValue,
                        inputId: this._addUID('label-input'),
                        placeholder: geomType == 'Text' ? 'Saisir un label...' : 'Saisir une description...',
                        text: _textValue,
                        measure: this.options.tools.measure ? _measure : null,
                        geomType: geomType
                    });
                    popupOvl = new _ol2.default.Overlay({
                        element: popupDiv,
                        positioning: 'top-center'
                    });
                    this.getMap().addOverlay(popupOvl);
                    popupOvl.setPosition(seEv.mapBrowserEvent.coordinate);
                    document.getElementById(this._addUID('label-input')).focus();
                    this.labelOvl = popupOvl;
                    this.getMap().removeInteraction(this.interactionCurrent);
                    this.interactionCurrent = this._createLabelInteraction();
                    this.getMap().addInteraction(this.interactionCurrent);
                }, this);
                return interaction;
            };
            Drawing.prototype._updateMeasure = function (feature, geomType) {
                logger.log(feature);
                var measure = null;
                var wgs84Sphere = new _ol2.default.Sphere(6378137);
                var projection = this.getMap().getView().getProjection();
                function __roundDecimal(nombre, precision) {
                    precision = precision || 2;
                    var factor = Math.pow(10, precision);
                    return Math.round(nombre * factor) / factor;
                }
                var type = geomType || feature.getProperties().type;
                switch (type) {
                case 'Point':
                    var coordinatesPoint = feature.getGeometry().getCoordinates();
                    var c = _ol2.default.proj.transform(coordinatesPoint, projection, 'EPSG:4326');
                    measure = 'lon : ';
                    measure += __roundDecimal(c[0], 4) + '\xB0';
                    measure += ' / ';
                    measure += 'lat : ';
                    measure += __roundDecimal(c[1], 4) + '\xB0';
                    break;
                case 'LineString':
                    var measureLength = 0;
                    var coordinatesLine = feature.getGeometry().getCoordinates();
                    for (var i = 0, ii = coordinatesLine.length - 1; i < ii; ++i) {
                        var c1 = _ol2.default.proj.transform(coordinatesLine[i], projection, 'EPSG:4326');
                        var c2 = _ol2.default.proj.transform(coordinatesLine[i + 1], projection, 'EPSG:4326');
                        measureLength += wgs84Sphere.haversineDistance(c1, c2);
                    }
                    measure = measureLength > 1000 ? __roundDecimal(measureLength / 1000, 3) + ' km' : __roundDecimal(measureLength, 3) + ' m';
                    break;
                case 'Polygon':
                    var measureArea = 0;
                    var coordinatesAera = feature.getGeometry().clone().transform(projection, 'EPSG:4326').getLinearRing(0).getCoordinates();
                    measureArea = Math.abs(wgs84Sphere.geodesicArea(coordinatesAera));
                    measure = measureArea > 1000000 ? __roundDecimal(measureArea / 1000000, 3) + ' km^2' : __roundDecimal(measureArea, 2) + ' m^2';
                    break;
                }
                feature.setProperties({
                    measure: measure,
                    type: type
                });
            };
            Drawing.prototype._handleToolClick = function (clickEvent, toolId, context) {
                var map = context.getMap();
                if (!map) {
                    logger.trace('Drawing control not attached to any map.');
                    return;
                }
                _Interactions2.default.unset(map, { current: 'Drawing' });
                if (context.interactionCurrent) {
                    map.removeInteraction(context.interactionCurrent);
                    context.interactionCurrent = null;
                }
                if (context.interactionSelectEdit) {
                    map.removeInteraction(context.interactionSelectEdit);
                    context.interactionSelectEdit = null;
                }
                if (!this.layer) {
                    this._createEmptyLayer();
                }
                switch (toolId) {
                case this._addUID('drawing-tool-point'):
                    if (context.dtOptions['points'].active) {
                        context.interactionCurrent = new _ol2.default.interaction.Draw({
                            features: context.layer.getSource().getFeaturesCollection(),
                            style: new _ol2.default.style.Style({ image: new _ol2.default.style.Icon(this._getIconStyleOptions(this.options.markersList[0])) }),
                            type: 'Point'
                        });
                        context.interactionCurrent.on('drawend', function (deEv) {
                            context._drawEndFeature(deEv.feature, 'Point');
                        }, context);
                    }
                    break;
                case this._addUID('drawing-tool-line'):
                    if (context.dtOptions['lines'].active) {
                        context.interactionCurrent = new _ol2.default.interaction.Draw({
                            features: context.layer.getSource().getFeaturesCollection(),
                            style: new _ol2.default.style.Style({
                                image: new _ol2.default.style.Circle({
                                    radius: this.options.cursorStyle.radius,
                                    stroke: new _ol2.default.style.Stroke({
                                        color: this.options.cursorStyle.strokeColor,
                                        width: this.options.cursorStyle.strokeWidth
                                    }),
                                    fill: new _ol2.default.style.Fill({ color: this.options.cursorStyle.fillColor })
                                }),
                                stroke: new _ol2.default.style.Stroke({
                                    color: this.options.defaultStyles.strokeColor,
                                    width: this.options.defaultStyles.strokeWidth
                                })
                            }),
                            type: 'LineString'
                        });
                        context.interactionCurrent.on('drawend', function (deEv) {
                            context._drawEndFeature(deEv.feature, 'LineString');
                        }, context);
                    }
                    break;
                case this._addUID('drawing-tool-polygon'):
                    if (context.dtOptions['polygons'].active) {
                        context.interactionCurrent = new _ol2.default.interaction.Draw({
                            features: context.layer.getSource().getFeaturesCollection(),
                            style: new _ol2.default.style.Style({
                                image: new _ol2.default.style.Circle({
                                    radius: this.options.cursorStyle.radius,
                                    stroke: new _ol2.default.style.Stroke({
                                        color: this.options.cursorStyle.strokeColor,
                                        width: this.options.cursorStyle.strokeWidth
                                    }),
                                    fill: new _ol2.default.style.Fill({ color: this.options.cursorStyle.fillColor })
                                }),
                                stroke: new _ol2.default.style.Stroke({
                                    color: this.options.defaultStyles.polyStrokeColor,
                                    width: this.options.defaultStyles.polyStrokeWidth
                                }),
                                fill: new _ol2.default.style.Fill({ color: this.hexToRgba(this.options.defaultStyles.polyFillColor, this.options.defaultStyles.polyFillOpacity) })
                            }),
                            type: 'Polygon'
                        });
                        context.interactionCurrent.on('drawend', function (deEv) {
                            context._drawEndFeature(deEv.feature, 'Polygon');
                        }, context);
                    }
                    break;
                case this._addUID('drawing-tool-text'):
                    if (context.dtOptions['text'].active) {
                        context.interactionCurrent = new _ol2.default.interaction.Draw({
                            features: context.layer.getSource().getFeaturesCollection(),
                            style: new _ol2.default.style.Style({
                                image: new _ol2.default.style.Circle({
                                    radius: this.options.cursorStyle.radius,
                                    stroke: new _ol2.default.style.Stroke({
                                        color: this.options.cursorStyle.strokeColor,
                                        width: this.options.cursorStyle.strokeWidth
                                    }),
                                    fill: new _ol2.default.style.Fill({ color: this.options.cursorStyle.fillColor })
                                })
                            }),
                            type: 'Point'
                        });
                        context.interactionCurrent.on('drawend', function (deEv) {
                            var popupOvl = null;
                            var setTextValue = function setTextValue(value, save) {
                                context.getMap().removeOverlay(popupOvl);
                                if (!save) {
                                    context.layer.getSource().removeFeature(deEv.feature);
                                    return;
                                }
                                deEv.feature.setProperties({ name: value });
                                deEv.feature.setStyle(new _ol2.default.style.Style({
                                    image: new _ol2.default.style.Icon(context._getIconStyleOptions(context.options.defaultStyles.textIcon1x1)),
                                    text: new _ol2.default.style.Text({
                                        textAlign: 'left',
                                        font: '16px sans',
                                        text: value,
                                        fill: new _ol2.default.style.Fill({ color: context.options.defaultStyles.textFillColor }),
                                        stroke: new _ol2.default.style.Stroke({
                                            color: context.options.defaultStyles.textStrokeColor,
                                            width: 3
                                        })
                                    })
                                }));
                            };
                            var popup = this._createLabelDiv({
                                applyFunc: setTextValue,
                                inputId: context._addUID('label-input'),
                                geomType: 'Text',
                                placeholder: 'Saisir un label...'
                            });
                            popupOvl = new _ol2.default.Overlay({
                                element: popup,
                                positioning: 'top-center'
                            });
                            context.getMap().addOverlay(popupOvl);
                            popupOvl.setPosition(deEv.feature.getGeometry().getCoordinates());
                            document.getElementById(this._addUID('label-input')).focus();
                        }, context);
                    }
                    break;
                case this._addUID('drawing-tool-edit'):
                    if (context.dtOptions['edit'].active) {
                        context.interactionSelectEdit = new _ol2.default.interaction.Select({
                            condition: _ol2.default.events.condition.singleClick,
                            layers: [this.layer]
                        });
                        context.interactionSelectEdit.setProperties({
                            name: 'Drawing',
                            source: context
                        });
                        map.addInteraction(context.interactionSelectEdit);
                        context.interactionCurrent = new _ol2.default.interaction.Modify({
                            features: this.interactionSelectEdit.getFeatures(),
                            style: new _ol2.default.style.Style({
                                image: new _ol2.default.style.Circle({
                                    radius: this.options.cursorStyle.radius,
                                    stroke: new _ol2.default.style.Stroke({
                                        color: this.options.cursorStyle.strokeColor,
                                        width: this.options.cursorStyle.strokeWidth
                                    }),
                                    fill: new _ol2.default.style.Fill({ color: this.options.cursorStyle.fillColor })
                                })
                            }),
                            deleteCondition: function deleteCondition() {
                                return false;
                            }
                        });
                        context.interactionCurrent.on('modifyend', function (deEv) {
                            var feature = deEv.features.item(0);
                            context._updateMeasure(feature);
                        }, context);
                    }
                    break;
                case this._addUID('drawing-tool-display'):
                    if (context.dtOptions['display'].active) {
                        context.interactionCurrent = this._createStylingInteraction();
                    }
                    break;
                case this._addUID('drawing-tool-tooltip'):
                    if (context.dtOptions['tooltip'].active) {
                        context.interactionCurrent = this._createLabelInteraction();
                    }
                    break;
                case this._addUID('drawing-tool-remove'):
                    if (context.dtOptions['remove'].active) {
                        context.interactionCurrent = context._createRemoveInteraction();
                    }
                    break;
                default:
                    logger.trace('unhandled tool type');
                }
                if (context.interactionCurrent) {
                    context.interactionCurrent.setProperties({
                        name: 'Drawing',
                        source: this
                    });
                    map.addInteraction(context.interactionCurrent);
                }
                logger.log('interactions', map.getInteractions());
            };
            Drawing.prototype.onShowDrawingClick = function () {
                var map = this.getMap();
                _Interactions2.default.unset(map);
                this.collapsed = this._showDrawingContainer.checked;
                this.dispatchEvent('change:collapsed');
                for (var toolsType in this.dtOptions) {
                    if (this.dtOptions.hasOwnProperty(toolsType)) {
                        if (this.dtOptions[toolsType].active) {
                            var toolsId = this._addUID('drawing-tool-' + this.dtOptions[toolsType].id);
                            document.getElementById(toolsId).className = 'drawing-tool';
                            this.dtOptions[toolsType].active = false;
                        }
                    }
                }
            };
            Drawing.prototype.onExportFeatureClick = function () {
                var content = this.exportFeatures();
                if (!content) {
                    return;
                }
                var link = document.createElement('a');
                var charset = 'utf-8';
                link.setAttribute('href', 'data:application/vnd.google-earth.kml+xml;charset=' + charset + ',' + encodeURIComponent(content));
                link.setAttribute('download', this.getExportName() + '.kml');
                if (document.createEvent) {
                    var event = document.createEvent('MouseEvents');
                    event.initEvent('click', true, true);
                    link.dispatchEvent(event);
                } else {
                    link.click();
                }
            };
            exports.default = Drawing;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var DrawingDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPdrawing');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowDrawingElement: function _createShowDrawingElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowDrawing');
                    input.className = 'GPshowDrawing';
                    input.type = 'checkbox';
                    return input;
                },
                _createShowDrawingPictoElement: function _createShowDrawingPictoElement() {
                    var self = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowDrawingPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowDrawing');
                    label.title = this.options.labels.control;
                    if (label.addEventListener) {
                        label.addEventListener('click', function (e) {
                            self.onShowDrawingClick(e);
                        });
                    } else if (label.attachEvent) {
                        label.attachEvent('onclick', function (e) {
                            self.onShowDrawingClick(e);
                        });
                    }
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowDrawingOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                },
                _createDrawingPanelElement: function _createDrawingPanelElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPdrawingPanel');
                    div.className = 'GPpanel';
                    div.appendChild(this._createDrawingPanelHeaderElement());
                    this.dtOptions = {};
                    if (this.options.tools.points) {
                        this.dtOptions.points = {
                            label: this.options.labels.points,
                            active: false,
                            panel: 'draw',
                            id: 'point'
                        };
                    }
                    if (this.options.tools.lines) {
                        this.dtOptions.lines = {
                            label: this.options.labels.lines,
                            active: false,
                            panel: 'draw',
                            id: 'line'
                        };
                    }
                    if (this.options.tools.polygons) {
                        this.dtOptions.polygons = {
                            label: this.options.labels.polygons,
                            active: false,
                            panel: 'draw',
                            id: 'polygon'
                        };
                    }
                    if (this.options.tools.text) {
                        this.dtOptions.text = {
                            label: this.options.labels.text,
                            active: false,
                            panel: 'draw',
                            id: 'text'
                        };
                    }
                    if (this.options.tools.edit) {
                        this.dtOptions.edit = {
                            label: this.options.labels.edit,
                            active: false,
                            panel: 'edit',
                            id: 'edit'
                        };
                    }
                    if (this.options.tools.display) {
                        this.dtOptions.display = {
                            label: this.options.labels.display,
                            active: false,
                            panel: 'edit',
                            id: 'display'
                        };
                    }
                    if (this.options.tools.tooltip) {
                        this.dtOptions.tooltip = {
                            label: this.options.labels.tooltip,
                            active: false,
                            panel: 'edit',
                            id: 'tooltip'
                        };
                    }
                    if (this.options.tools.remove) {
                        this.dtOptions.remove = {
                            label: this.options.labels.remove,
                            active: false,
                            panel: 'edit',
                            id: 'remove'
                        };
                    }
                    if (this.dtOptions.points || this.dtOptions.lines || this.dtOptions.polygons || this.dtOptions.text) {
                        div.appendChild(this._createDrawingToolSection(this.options.labels.creatingTools, 'draw'));
                    }
                    if (this.dtOptions.edit || this.dtOptions.display || this.dtOptions.tooltip || this.dtOptions.remove) {
                        div.appendChild(this._createDrawingToolSection(this.options.labels.editingTools, 'edit'));
                    }
                    if (this.options.tools.export) {
                        div.appendChild(this._createSavingSection(this.options.labels.export, this.options.labels.exportTitle));
                    }
                    return div;
                },
                _createDrawingPanelHeaderElement: function _createDrawingPanelHeaderElement() {
                    var container = document.createElement('div');
                    container.className = 'GPpanelHeader';
                    var divTitle = document.createElement('div');
                    divTitle.className = 'GPpanelTitle';
                    divTitle.innerHTML = this.options.controlLabel || 'Annoter la carte';
                    container.appendChild(divTitle);
                    var divClose = document.createElement('div');
                    divClose.id = this._addUID('GPdrawingPanelClose');
                    divClose.className = 'GPpanelClose';
                    divClose.title = 'Fermer le panneau';
                    var dtObj = this;
                    if (divClose.addEventListener) {
                        divClose.addEventListener('click', function () {
                            document.getElementById(dtObj._addUID('GPshowDrawingPicto')).click();
                        }, false);
                    } else if (divClose.attachEvent) {
                        divClose.attachEvent('onclick', function () {
                            document.getElementById(dtObj._addUID('GPshowDrawingPicto')).click();
                        });
                    }
                    container.appendChild(divClose);
                    return container;
                },
                _createDrawingToolSection: function _createDrawingToolSection(sectionLabel, panelType) {
                    var container = document.createElement('div');
                    container.className = 'drawing-tool-section';
                    var p = document.createElement('p');
                    p.className = 'drawing-tool-section-title';
                    p.innerHTML = sectionLabel;
                    container.appendChild(p);
                    var ul = document.createElement('ul');
                    ul.className = 'drawing-tools-flex-display';
                    var context = this;
                    function liClickHandler(e) {
                        context._handleDOMToolClick(e, this.id, context);
                        context._handleToolClick(e, this.id, context);
                    }
                    for (var type in this.dtOptions) {
                        if (this.dtOptions[type].panel !== panelType) {
                            continue;
                        }
                        var li = document.createElement('li');
                        li.className = 'drawing-tool';
                        li.id = this._addUID('drawing-tool-' + this.dtOptions[type].id);
                        li.title = this.dtOptions[type].label;
                        li.addEventListener('click', liClickHandler);
                        ul.appendChild(li);
                    }
                    container.appendChild(ul);
                    return container;
                },
                _createSavingSection: function _createSavingSection(buttonLabel, buttonTitle) {
                    var container = document.createElement('div');
                    container.className = 'drawing-tool-section drawing-tools-flex-display';
                    var button = document.createElement('button');
                    button.title = buttonTitle;
                    button.className = 'tool-form-submit drawing-button';
                    button.id = this._addUID('drawing-export');
                    button.type = 'button';
                    button.textContent = buttonLabel;
                    var context = this;
                    button.onclick = function () {
                        context.onExportFeatureClick();
                    };
                    container.appendChild(button);
                    return container;
                },
                rgbaToHex: function rgbaToHex(rgba) {
                    function hex(number) {
                        if (number > 255) {
                            throw '\'' + number + '\'\' is greater than 255(0xff);';
                        }
                        var str = Number(number).toString(16);
                        return ('0' + str).slice(-2);
                    }
                    var regex = /rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(0?.?\d+)\s*)?\)/;
                    var parsed = regex.exec(rgba);
                    if (!parsed) {
                        throw 'Invalid format: ' + rgba;
                    }
                    var red = parsed[1];
                    var green = parsed[2];
                    var blue = parsed[3];
                    var alpha = parsed[4];
                    var elems = [
                        hex(red),
                        hex(green),
                        hex(blue)
                    ];
                    var result = {};
                    result.hex = '#' + elems.join('');
                    if (alpha) {
                        result.opacity = parseFloat(alpha);
                    }
                    return result;
                },
                hexToRgba: function hexToRgba(hex, opacity) {
                    var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
                    if (!hex) {
                        throw 'Invalid format';
                    }
                    hex = hex.replace(shorthandRegex, function (m, r, g, b) {
                        return r + r + g + g + b + b;
                    });
                    var rgb = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
                    rgb = rgb ? {
                        r: parseInt(rgb[1], 16),
                        g: parseInt(rgb[2], 16),
                        b: parseInt(rgb[3], 16)
                    } : null;
                    var result = rgb ? 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', ' + opacity + ')' : null;
                    return result;
                },
                _createMarkersChooser: function _createMarkersChooser(options) {
                    var li = document.createElement('li');
                    li.className = options.className;
                    for (var i = 0; i < this.options.markersList.length; i++) {
                        var inputElem = document.createElement('input');
                        inputElem.type = 'radio';
                        inputElem.name = 'marker';
                        inputElem.id = this._addUID('marker-' + i);
                        inputElem.value = this.options.markersList[i].src;
                        inputElem.className = 'marker-input-radio';
                        if (options.defaultValue === inputElem.value) {
                            inputElem.checked = true;
                        }
                        li.appendChild(inputElem);
                        var labelElem = document.createElement('label');
                        labelElem.className = 'marker-label';
                        labelElem.setAttribute('for', inputElem.id);
                        var imgElem = document.createElement('img');
                        imgElem.src = inputElem.value;
                        labelElem.appendChild(imgElem);
                        li.appendChild(labelElem);
                    }
                    return li;
                },
                _createStylingElement: function _createStylingElement(options) {
                    var li = document.createElement('li');
                    li.className = options.className;
                    var textNode = document.createTextNode(options.label);
                    li.appendChild(textNode);
                    var inputElem = document.createElement('input');
                    try {
                        inputElem.type = options.type;
                    } catch (e) {
                        inputElem.type = 'text';
                    }
                    inputElem.id = options.id;
                    inputElem.value = options.defaultValue;
                    if (options.title) {
                        inputElem.title = options.title;
                    }
                    if (options.min !== undefined) {
                        inputElem.min = options.min;
                    }
                    if (options.max !== undefined) {
                        inputElem.max = options.max;
                    }
                    if (options.step !== undefined) {
                        inputElem.step = options.step;
                    }
                    li.appendChild(inputElem);
                    return li;
                },
                _createStylingDiv: function _createStylingDiv(options) {
                    var div = document.createElement('div');
                    div.className = 'gp-styling-div';
                    var ul = document.createElement('ul');
                    var li = null;
                    switch (options.geomType.toLowerCase()) {
                    case 'point':
                        li = this._createMarkersChooser({
                            className: 'gp-styling-option',
                            defaultValue: options.initValues.markerSrc
                        });
                        ul.appendChild(li);
                        break;
                    case 'text':
                        li = this._createStylingElement({
                            type: 'color',
                            className: 'gp-styling-option',
                            label: this.options.labels.fillColor,
                            id: this._addUID('fillColor'),
                            defaultValue: options.initValues.fillColor
                        });
                        ul.appendChild(li);
                        li = this._createStylingElement({
                            type: 'color',
                            className: 'gp-styling-option',
                            label: this.options.labels.strokeColor,
                            id: this._addUID('strokeColor'),
                            defaultValue: options.initValues.strokeColor
                        });
                        ul.appendChild(li);
                        break;
                    case 'line':
                        li = this._createStylingElement({
                            type: 'color',
                            className: 'gp-styling-option',
                            label: this.options.labels.strokeColor,
                            id: this._addUID('strokeColor'),
                            defaultValue: options.initValues.strokeColor
                        });
                        ul.appendChild(li);
                        li = this._createStylingElement({
                            type: 'range',
                            className: 'gp-styling-option',
                            label: this.options.labels.strokeWidth,
                            title: '1 à 10 pixels',
                            id: this._addUID('strokeWidth'),
                            min: 1,
                            max: 10,
                            step: 1,
                            defaultValue: options.initValues.strokeWidth
                        });
                        ul.appendChild(li);
                        break;
                    case 'polygon':
                        li = this._createStylingElement({
                            type: 'color',
                            className: 'gp-styling-option',
                            label: this.options.labels.strokeColor,
                            id: this._addUID('strokeColor'),
                            defaultValue: options.initValues.strokeColor
                        });
                        ul.appendChild(li);
                        li = this._createStylingElement({
                            type: 'range',
                            className: 'gp-styling-option',
                            label: this.options.labels.strokeWidth,
                            title: '1 à 10 pixels',
                            id: this._addUID('strokeWidth'),
                            min: 1,
                            max: 10,
                            step: 1,
                            defaultValue: options.initValues.strokeWidth
                        });
                        ul.appendChild(li);
                        li = this._createStylingElement({
                            type: 'color',
                            className: 'gp-styling-option',
                            label: this.options.labels.fillColor,
                            id: this._addUID('fillColor'),
                            defaultValue: options.initValues.fillColor
                        });
                        ul.appendChild(li);
                        li = this._createStylingElement({
                            type: 'range',
                            className: 'gp-styling-option',
                            label: this.options.labels.fillOpacity,
                            title: '0 (transparent) à 100% (opaque)',
                            id: this._addUID('fillOpacity'),
                            min: 0,
                            max: 10,
                            step: 1,
                            defaultValue: options.initValues.fillOpacity * 10
                        });
                        ul.appendChild(li);
                        break;
                    default:
                        console.log('Unhandled geometry type for styling.');
                    }
                    div.appendChild(ul);
                    var applyButton = document.createElement('input');
                    applyButton.type = 'button';
                    applyButton.className = 'gp-styling-button';
                    applyButton.value = this.options.labels.applyToObject;
                    applyButton.onclick = function () {
                        options.applyFunc.call(this, 'apply');
                    };
                    div.appendChild(applyButton);
                    var setDefaultButton = document.createElement('input');
                    setDefaultButton.type = 'button';
                    setDefaultButton.value = this.options.labels.setAsDefault;
                    setDefaultButton.className = 'gp-styling-button';
                    setDefaultButton.onclick = function () {
                        options.applyFunc.call(this, 'default');
                    };
                    div.appendChild(setDefaultButton);
                    var cancelButton = document.createElement('input');
                    cancelButton.type = 'button';
                    cancelButton.className = 'gp-styling-button closer';
                    cancelButton.onclick = function () {
                        options.applyFunc.call(this, 'cancel');
                    };
                    div.appendChild(cancelButton);
                    return div;
                },
                _createLabelDiv: function _createLabelDiv(options) {
                    var popup = document.createElement('div');
                    popup.className = 'gp-label-div';
                    var inputLabel = null;
                    if (options.geomType === 'Text') {
                        inputLabel = document.createElement('input');
                        inputLabel.type = 'text';
                        inputLabel.className = 'gp-input-label-style';
                    } else {
                        inputLabel = document.createElement('textArea');
                        inputLabel.rows = 2;
                        inputLabel.cols = 40;
                        inputLabel.className = 'gp-textarea-att-label-style';
                    }
                    if (options.text) {
                        inputLabel.value = options.text;
                    }
                    inputLabel.autocomplete = 'off';
                    inputLabel.placeholder = options.placeholder;
                    inputLabel.id = options.inputId;
                    popup.appendChild(inputLabel);
                    inputLabel.onblur = function () {
                        options.applyFunc.call(this, inputLabel.value, true);
                    };
                    inputLabel.onkeyup = function (evtk) {
                        if (options.geomType === 'Text' && evtk.keyCode === 13) {
                            options.applyFunc.call(this, inputLabel.value, true);
                        }
                        if (evtk.keyCode === 27) {
                            options.applyFunc.call(this, inputLabel.value, false);
                        }
                    };
                    if (options.measure && options.geomType !== 'Text') {
                        var inputMeasure = document.createElement('input');
                        inputMeasure.type = 'text';
                        inputMeasure.readonly = true;
                        inputMeasure.className = 'gp-input-measure-style';
                        inputMeasure.value = options.measure;
                        popup.appendChild(inputMeasure);
                    }
                    if (options.geomType !== 'Text') {
                        var applyButton = document.createElement('input');
                        applyButton.type = 'button';
                        applyButton.className = 'gp-styling-button';
                        applyButton.value = this.options.labels.saveDescription;
                        applyButton.onclick = function () {
                            options.applyFunc.call(this, inputLabel.value, true);
                        };
                        popup.appendChild(applyButton);
                        var cancelButton = document.createElement('input');
                        cancelButton.type = 'button';
                        cancelButton.className = 'gp-styling-button closer';
                        cancelButton.onclick = function () {
                            options.applyFunc.call(this, inputLabel.value, false);
                        };
                        popup.appendChild(cancelButton);
                    }
                    return popup;
                },
                _handleDOMToolClick: function _handleDOMToolClick(e, toolId, context) {
                    for (var availType in context.dtOptions) {
                        var availToolId = context._addUID('drawing-tool-' + context.dtOptions[availType].id);
                        var li = document.getElementById(availToolId);
                        if (availToolId !== toolId) {
                            li.className = 'drawing-tool';
                            context.dtOptions[availType].active = false;
                            continue;
                        }
                        if (context.dtOptions[availType].active) {
                            li.className = 'drawing-tool';
                        } else {
                            li.className = 'drawing-tool drawing-tool-active';
                        }
                        context.dtOptions[availType].active = !context.dtOptions[availType].active;
                    }
                }
            };
            exports.default = DrawingDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _CheckRightManagement = __webpack_require__(6);
            var _CheckRightManagement2 = _interopRequireDefault(_CheckRightManagement);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _LocationSelector = __webpack_require__(42);
            var _LocationSelector2 = _interopRequireDefault(_LocationSelector);
            var _LayerSwitcher = __webpack_require__(12);
            var _LayerSwitcher2 = _interopRequireDefault(_LayerSwitcher);
            var _Markers = __webpack_require__(7);
            var _Markers2 = _interopRequireDefault(_Markers);
            var _RouteDOM = __webpack_require__(100);
            var _RouteDOM2 = _interopRequireDefault(_RouteDOM);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('route');
            function Route(options) {
                options = options || {};
                if (!(this instanceof Route)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this.initialize(options);
                this._container = this._createMainContainerElement();
                this._containerElement = null;
                if (options.element && options.element.appendChild) {
                    options.element.appendChild(this._container);
                    this._containerElement = options.element;
                }
                _ol2.default.control.Control.call(this, {
                    element: this._containerElement || this._container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(Route, _ol2.default.control.Control);
            Route.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(Route.prototype, _RouteDOM2.default);
            Route.prototype.constructor = Route;
            Route.prototype.getCollapsed = function () {
                return this.collapsed;
            };
            Route.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] Route:setCollapsed - missing collapsed parameter');
                    return;
                }
                if (collapsed && this.collapsed || !collapsed && !this.collapsed) {
                    return;
                }
                if (collapsed) {
                    document.getElementById('GProutePanelClose-' + this._uid).click();
                } else {
                    document.getElementById('GPshowRoute-' + this._uid).click();
                }
                this.collapsed = collapsed;
            };
            Route.prototype.getLayer = function () {
                return this._geojsonSections;
            };
            Route.prototype.setMap = function (map) {
                if (map) {
                    this._container = this._initContainer(map);
                }
                _ol2.default.control.Control.prototype.setMap.call(this, map);
            };
            Route.prototype.initialize = function (options) {
                this._checkInputOptions(options);
                this.options = {
                    collapsed: true,
                    graphs: [
                        'Voiture',
                        'Pieton'
                    ],
                    exclusions: {
                        toll: false,
                        tunnel: false,
                        bridge: false
                    },
                    routeOptions: {},
                    autocompleteOptions: {}
                };
                _Utils2.default.assign(this.options, options);
                var defaultMarkersOpts = {
                    departure: {
                        url: _Markers2.default['red'],
                        offset: _Markers2.default.defaultOffset
                    },
                    stages: {
                        url: _Markers2.default['lightOrange'],
                        offset: _Markers2.default.defaultOffset
                    },
                    arrival: {
                        url: _Markers2.default['darkOrange'],
                        offset: _Markers2.default.defaultOffset
                    }
                };
                this.options.markersOpts = _Utils2.default.assign(defaultMarkersOpts, options.markersOpts);
                this.collapsed = this.options.collapsed;
                this._uid = _SelectorID2.default.generate();
                this._waitingContainer = null;
                this._formRouteContainer = null;
                this._resultsRouteContainer = null;
                this._showRouteExclusionsElement = null;
                this._currentPoints = [];
                this._currentTransport = null;
                this._initTransport();
                this._currentComputation = null;
                this._initComputation();
                this._currentExclusions = [];
                this._initExclusions();
                this._waiting = false;
                this._timer = null;
                this._geojsonRoute = null;
                this._geojsonSections = null;
                this._popupContent = null;
                this._popupDiv = this._initPopupDiv();
                this._popupOverlay = null;
                this._resultsSelectInteraction = null;
                this._resultsHoverInteraction = null;
                this._defaultFeatureStyle = new _ol2.default.style.Style({
                    stroke: new _ol2.default.style.Stroke({
                        color: 'rgba(0,183,152,0.9)',
                        width: 12
                    })
                });
                this._selectedFeatureStyle = new _ol2.default.style.Style({
                    stroke: new _ol2.default.style.Stroke({
                        color: 'rgba(255,102,0,0.9)',
                        width: 12
                    })
                });
                this._currentRouteInformations = null;
                this._resources = {};
                this._noRightManagement = false;
                this._checkRightsManagement();
            };
            Route.prototype._checkInputOptions = function (options) {
                if (options.graphs) {
                    if (Array.isArray(options.graphs)) {
                        if (options.graphs.length === 0) {
                            options.graphs = null;
                        } else {
                            for (var i = 0; i < options.graphs.length; i++) {
                                if (typeof options.graphs[i] !== 'string') {
                                    console.log('[ol.control.Route] ERROR : parameter \'graphs\' elements should be of type \'string\'');
                                    options.graphs = null;
                                } else {
                                    if (options.graphs[i].toLowerCase() === 'pieton') {
                                        options.graphs[i] = 'Pieton';
                                    }
                                    if (options.graphs[i].toLowerCase() === 'voiture') {
                                        options.graphs[i] = 'Voiture';
                                    }
                                }
                            }
                        }
                    } else {
                        logger.warn('\'graphs\' parameter should be an array');
                        options.graphs = null;
                    }
                }
                if (options.collapsed === 'true') {
                    options.collapsed = true;
                }
                if (options.collapsed === 'false') {
                    options.collapsed = false;
                }
            };
            Route.prototype._checkRightsManagement = function () {
                var _opts = null;
                var _res = [];
                var _key = null;
                _key = this.options.routeOptions.apiKey;
                _opts = this.options.routeOptions.filterOptions;
                _res = _opts ? _opts.type : [];
                if (!_res || _res.length === 0) {
                    _res = [
                        'Voiture',
                        'Pieton'
                    ];
                }
                var rightManagementRoute = _CheckRightManagement2.default.check({
                    key: _key || this.options.apiKey,
                    resources: _res,
                    services: ['Itineraire']
                });
                logger.log('rightManagementRoute', rightManagementRoute);
                _key = this.options.autocompleteOptions.apiKey;
                _opts = this.options.autocompleteOptions.filterOptions;
                _res = _opts ? _opts.type : [];
                if (!_res || _res.length === 0) {
                    _res = [
                        'PositionOfInterest',
                        'StreetAddress'
                    ];
                }
                var rightManagementAutoComplete = _CheckRightManagement2.default.check({
                    key: _key || this.options.apiKey,
                    resources: _res,
                    services: ['AutoCompletion']
                });
                logger.log('rightManagementAutoComplete', rightManagementAutoComplete);
                if (!rightManagementRoute && !rightManagementAutoComplete) {
                    this._noRightManagement = true;
                }
                if (rightManagementAutoComplete) {
                    this._resources['AutoCompletion'] = {};
                    this._resources['AutoCompletion']['resources'] = rightManagementAutoComplete['AutoCompletion'];
                    this._resources['AutoCompletion']['key'] = rightManagementAutoComplete['key'];
                }
                if (rightManagementRoute) {
                    this._resources['Itineraire'] = {};
                    this._resources['Itineraire']['resources'] = rightManagementRoute['Itineraire'];
                    this._resources['Itineraire']['key'] = rightManagementRoute['key'];
                }
            };
            Route.prototype._initContainer = function (map) {
                var container = this._container;
                var inputShow = this._showRouteContainer = this._createShowRouteElement();
                container.appendChild(inputShow);
                if (!this.collapsed) {
                    inputShow.checked = true;
                }
                var picto = this._createShowRoutePictoElement();
                container.appendChild(picto);
                var routePanel = this._createRoutePanelElement();
                var routeHeader = this._createRoutePanelHeaderElement();
                routePanel.appendChild(routeHeader);
                var routeForm = this._formRouteContainer = this._createRoutePanelFormElement();
                var points = this._createRoutePanelFormPointsElement(map);
                for (var i = 0; i < points.length; i++) {
                    routeForm.appendChild(points[i]);
                }
                var choice = this._createRoutePanelFormModeChoiceElement();
                choice.appendChild(this._createRoutePanelFormModeChoiceTransportElement(this.options.graphs));
                choice.appendChild(this._createRoutePanelFormModeChoiceComputeElement());
                routeForm.appendChild(choice);
                routeForm.appendChild(this._createShowRouteExclusionsElement());
                this._showRouteExclusionsElement = this._createShowRouteExclusionsPictoElement();
                routeForm.appendChild(this._showRouteExclusionsElement);
                var exclusion = this._createRoutePanelFormExclusionsElement();
                exclusion.appendChild(this._createRoutePanelFormExclusionOptionsElement(this.options.exclusions));
                routeForm.appendChild(exclusion);
                var divReset = this._createRouteFormResetElement();
                routeForm.appendChild(divReset);
                var submit = this._createRouteSubmitFormElement();
                routeForm.appendChild(submit);
                routePanel.appendChild(routeForm);
                var routeResults = this._resultsRouteContainer = this._createRoutePanelResultsElement();
                routePanel.appendChild(routeResults);
                var waiting = this._waitingContainer = this._createRouteWaitingElement();
                routePanel.appendChild(waiting);
                container.appendChild(routePanel);
                var context = this;
                if (container.addEventListener) {
                    container.addEventListener('click', function (e) {
                        context._hideRouteSuggestedLocations.call(context, e);
                    });
                }
                return container;
            };
            Route.prototype._initTransport = function () {
                this._currentTransport = 'Voiture';
                var transport = this.options.graphs;
                if (!transport || transport.length === 0) {
                    this.options.graphs = [
                        'Voiture',
                        'Pieton'
                    ];
                }
                if (Array.isArray(transport) && transport.length) {
                    if (transport[0] === 'Voiture' || transport[0] === 'Pieton') {
                        this._currentTransport = transport[0];
                    }
                }
                var serviceOptions = this.options.routeOptions;
                if (serviceOptions.graph) {
                    this._currentTransport = serviceOptions.graph;
                }
            };
            Route.prototype._initComputation = function () {
                this._currentComputation = 'fastest';
                var serviceOptions = this.options.routeOptions;
                if (serviceOptions.routePreference) {
                    this._currentComputation = serviceOptions.routePreference;
                }
            };
            Route.prototype._initExclusions = function () {
                this._currentExclusions = [];
                var exclusion = this.options.exclusions;
                if (!exclusion || (typeof exclusion === 'undefined' ? 'undefined' : _typeof(exclusion)) === 'object' && Object.keys(exclusion).length === 0) {
                    this.options.exclusions = {
                        toll: false,
                        tunnel: false,
                        bridge: false
                    };
                }
                if (exclusion && (typeof exclusion === 'undefined' ? 'undefined' : _typeof(exclusion)) === 'object' && Object.keys(exclusion).length) {
                    for (var k in exclusion) {
                        if (exclusion.hasOwnProperty(k)) {
                            if (exclusion[k]) {
                                this._currentExclusions.push(k);
                            }
                        }
                    }
                }
                var serviceOptions = this.options.routeOptions;
                if (Array.isArray(serviceOptions.exclusions)) {
                    this._currentExclusions = serviceOptions.exclusions;
                }
            };
            Route.prototype._initPopupDiv = function () {
                var context = this;
                var element = document.createElement('div');
                element.className = 'gp-feature-info-div';
                var closer = document.createElement('input');
                closer.type = 'button';
                closer.className = 'gp-styling-button closer';
                closer.onclick = function () {
                    if (context._popupOverlay != null) {
                        context._popupOverlay.setPosition(undefined);
                    }
                    return false;
                };
                this._popupContent = document.createElement('div');
                this._popupContent.className = 'gp-features-content-div';
                element.appendChild(this._popupContent);
                element.appendChild(closer);
                return element;
            };
            Route.prototype._createRoutePanelFormPointsElement = function (map) {
                var points = [];
                var count = 1;
                var start = new _LocationSelector2.default({
                    apiKey: this.options.apiKey || null,
                    tag: {
                        id: count,
                        groupId: this._uid,
                        markerOpts: this.options.markersOpts['departure'],
                        label: 'Départ',
                        display: true
                    },
                    autocompleteOptions: this.options.autocompleteOptions || null
                });
                start.setMap(map);
                this._addFormPointsEventListeners(start);
                points.push(start._container);
                this._currentPoints.push(start);
                for (count = 2; count < 7; count++) {
                    var step = new _LocationSelector2.default({
                        apiKey: this.options.apiKey || null,
                        tag: {
                            id: count,
                            groupId: this._uid,
                            label: 'Etape',
                            markerOpts: this.options.markersOpts['stages'],
                            display: false,
                            removeOption: true
                        },
                        autocompleteOptions: this.options.autocompleteOptions || null
                    });
                    step.setMap(map);
                    this._addFormPointsEventListeners(step);
                    points.push(step._container);
                    this._currentPoints.push(step);
                }
                var end = new _LocationSelector2.default({
                    apiKey: this.options.apiKey || null,
                    tag: {
                        id: count,
                        groupId: this._uid,
                        markerOpts: this.options.markersOpts['arrival'],
                        label: 'Arrivée',
                        display: true,
                        addOption: true
                    },
                    autocompleteOptions: this.options.autocompleteOptions || null
                });
                end.setMap(map);
                this._addFormPointsEventListeners(end);
                points.push(end._container);
                this._currentPoints.push(end);
                return points;
            };
            Route.prototype._addFormPointsEventListeners = function (formPoint) {
                if (!formPoint) {
                    return;
                }
                var context = this;
                if (formPoint._inputLabelContainer.addEventListener) {
                    formPoint._inputLabelContainer.addEventListener('click', function () {
                        context.onRouteOriginLabelClick.call(this, context);
                    });
                    formPoint._inputShowPointer.addEventListener('click', function () {
                        context.onRouteOriginPointerClick.call(this, context, formPoint);
                    });
                    if (formPoint._removePointElement) {
                        formPoint._removePointElement.addEventListener('click', function () {
                            var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;
                            context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) - 33).toString() + 'px';
                        });
                    }
                    if (formPoint._addPointElement) {
                        formPoint._addPointElement.addEventListener('click', function () {
                            var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;
                            context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) + 33).toString() + 'px';
                        });
                    }
                } else if (formPoint._inputLabelContainer.attachEvent) {
                    formPoint._inputLabelContainer.attachEvent('onclick', function () {
                        context.onRouteOriginLabelClick.call(this, context);
                    });
                    formPoint._inputShowPointer.attachEvent('onclick', function () {
                        context.onRouteOriginPointerClick.call(this, context, formPoint);
                    });
                    if (formPoint._removePointElement) {
                        formPoint._removePointElement.attachEvent('onclick', function () {
                            var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;
                            context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) - 33).toString() + 'px';
                        });
                    }
                    if (formPoint._addPointElement) {
                        formPoint._addPointElement.attachEvent('onclick', function () {
                            var exclusionsPictoTop = context._showRouteExclusionsElement.style.top;
                            context._showRouteExclusionsElement.style.top = (parseInt(exclusionsPictoTop, 10) + 33).toString() + 'px';
                        });
                    }
                }
            };
            Route.prototype.onRouteComputationSubmit = function (options) {
                logger.log('onRouteComputationSubmit', options);
                var points = this._currentPoints;
                var start;
                if (points[0] && points[0].getCoordinate) {
                    var startCoordinate = points[0].getCoordinate();
                    start = {
                        x: startCoordinate[0],
                        y: startCoordinate[1]
                    };
                    logger.log('start', start);
                }
                var end;
                var endPoint = points[points.length - 1];
                if (endPoint && endPoint.getCoordinate) {
                    var endCoordinate = endPoint.getCoordinate();
                    end = {
                        x: endCoordinate[0],
                        y: endCoordinate[1]
                    };
                    logger.log('end', end);
                }
                var step = [];
                for (var i = 1; i < points.length - 1; i++) {
                    if (points[i] && points[i].getCoordinate) {
                        var iCoordinate = points[i].getCoordinate();
                        if (iCoordinate) {
                            var coordinate = {
                                x: iCoordinate[0],
                                y: iCoordinate[1]
                            };
                            logger.log('step', coordinate);
                            step.push(coordinate);
                        }
                    }
                }
                if (this._noRightManagement) {
                    return;
                }
                this._currentTransport = options.transport;
                this._currentComputation = options.computation;
                this._currentExclusions = options.exclusions;
                var routeOptions = this.options.routeOptions;
                var _protocol = routeOptions.protocol || 'XHR';
                var _timeout = routeOptions.timeOut || 0;
                if (_protocol === 'JSONP' && _timeout === 0) {
                    _timeout = 15000;
                }
                var context = this;
                this._requestRouting({
                    startPoint: start,
                    endPoint: end,
                    viaPoints: step,
                    graph: routeOptions.graph || this._currentTransport,
                    routePreference: routeOptions.routePreference || this._currentComputation,
                    exclusions: routeOptions.exclusions || this._currentExclusions,
                    geometryInInstructions: true,
                    distanceUnit: 'm',
                    timeOut: _timeout,
                    protocol: _protocol,
                    onSuccess: function onSuccess(results) {
                        logger.log(results);
                        if (results) {
                            context._fillRouteResultsDetails(results);
                        }
                    },
                    onFailure: function onFailure(error) {
                        context._hideWaitingContainer();
                        context._clearRouteResultsDetails();
                        logger.log(error.message);
                    }
                });
            };
            Route.prototype.onRouteOriginLabelClick = function (routeControl) {
                var map = routeControl.getMap();
                routeControl._formRouteContainer.className = '';
                map.un('click', function () {
                    if (routeControl._formRouteContainer.className === 'GProuteFormMini') {
                        routeControl._formRouteContainer.className = '';
                    }
                });
            };
            Route.prototype.onRouteOriginPointerClick = function (routeControl, locationSelector) {
                var map = routeControl.getMap();
                if (locationSelector._inputShowPointerContainer.checked) {
                    routeControl._formRouteContainer.className = 'GProuteFormMini';
                    map.on('click', function () {
                        if (routeControl._formRouteContainer.className === 'GProuteFormMini') {
                            routeControl._formRouteContainer.className = '';
                        }
                    });
                } else {
                    routeControl._formRouteContainer.className = '';
                    map.un('click', function () {
                        if (routeControl._formRouteContainer.className === 'GProuteFormMini') {
                            routeControl._formRouteContainer.className = '';
                        }
                    });
                }
            };
            Route.prototype.onShowRoutePanelClick = function () {
                if (!this._geojsonSections && !this._waiting) {
                    this._clear();
                }
                this.collapsed = document.getElementById('GPshowRoute-' + this._uid).checked;
                this.dispatchEvent('change:collapsed');
            };
            Route.prototype.onRouteModeComputationChange = function (e) {
                var idx = e.target.selectedIndex;
                var value = e.target.options[idx].value;
                if (!value) {
                    return;
                }
                logger.log(value);
                this._currentComputation = value;
            };
            Route.prototype.onRouteModeComputationChangeAndRun = function (e) {
                this.onRouteModeComputationChange(e);
                this._clearRouteResultsDetails();
                this._clearRouteResultsGeometry();
                this._clearRouteResultsFeatureGeometry();
                this.onRouteComputationSubmit({
                    computation: this._currentComputation,
                    transport: this._currentTransport,
                    exclusions: this._currentExclusions
                });
            };
            Route.prototype.onRouteModeTransportChange = function (e) {
                var value = e.target.value;
                if (!value) {
                    return;
                }
                this._currentTransport = value;
            };
            Route.prototype.onShowRouteExclusionsClick = function (e) {
                logger.log('onShowRouteExclusionsClick', e);
            };
            Route.prototype.onRouteExclusionsChange = function (e) {
                var value = e.target.value;
                var checked = e.target.checked;
                if (!value || typeof value !== 'string') {
                    return;
                }
                value = value.toLowerCase();
                var bFound = false;
                var iFound = null;
                for (var i = 0; i < this._currentExclusions.length; i++) {
                    if (this._currentExclusions[i] === value) {
                        iFound = i;
                        bFound = true;
                    }
                }
                if (!bFound && !checked) {
                    this._currentExclusions.push(value);
                }
                if (bFound && checked) {
                    this._currentExclusions.splice(iFound, 1);
                }
            };
            Route.prototype.onRouteResetClick = function () {
                var currentPoints = this._currentPoints;
                for (var i = 0; i < currentPoints.length; i++) {
                    currentPoints[i].clear();
                }
                this._clear();
                this._clearRouteInputOptions();
            };
            Route.prototype.onShowRouteResultsNewClick = function () {
                this._clearRouteResultsDetails();
                this._clearRouteResultsGeometry();
                this._clearRouteResultsFeatureGeometry();
            };
            Route.prototype.onRouteResultsDetailsMouseOver = function (e) {
                var tagid = e.target.id;
                var idx = tagid.substring(tagid.indexOf('_') + 1);
                if (e.target.classList) {
                    e.target.classList.add('GProuteResultsDetailsInstructionHighlight');
                }
                if (!this._geojsonSections) {
                    return;
                }
                var f = this._geojsonSections.getSource().getFeatureById(parseInt(idx, 10));
                f.setStyle(this._selectedFeatureStyle);
            };
            Route.prototype.onRouteResultsDetailsMouseOut = function (e) {
                var tagid = e.target.id;
                var idx = tagid.substring(tagid.indexOf('_') + 1);
                if (e.target.classList) {
                    e.target.classList.remove('GProuteResultsDetailsInstructionHighlight');
                }
                if (!this._geojsonSections) {
                    return;
                }
                var f = this._geojsonSections.getSource().getFeatureById(parseInt(idx, 10));
                f.setStyle(null);
            };
            Route.prototype._requestRouting = function (options) {
                if (!options || (typeof options === 'undefined' ? 'undefined' : _typeof(options)) === 'object' && Object.keys(options).length === 0) {
                    return;
                }
                if (!options.startPoint) {
                    return;
                }
                if (!options.endPoint) {
                    return;
                }
                if (this._noRightManagement || !this._resources['Itineraire']) {
                    return;
                }
                var resources = this._resources['Itineraire'].resources;
                if (!resources || (typeof resources === 'undefined' ? 'undefined' : _typeof(resources)) === 'object' && Object.keys(resources).length === 0) {
                    return;
                }
                var key = this._resources['Itineraire']['key'];
                var bFound = false;
                for (var i = 0; i < resources.length; i++) {
                    if (resources[i] === options.graph) {
                        bFound = true;
                    }
                }
                if (!bFound) {
                    console.log('no rights for this service !?');
                    return;
                }
                options.apiKey = this.options.routeOptions.apiKey || this.options.apiKey || key;
                logger.log(options);
                this._displayWaitingContainer();
                _gp2.default.Services.route(options);
            };
            Route.prototype._fillRouteResultsDetails = function (results) {
                var distance = results.totalDistance;
                var duration = results.totalTime;
                var instructions = this._simplifiedInstructions(results.routeInstructions);
                if (instructions) {
                    this._fillRouteResultsDetailsContainer(distance, duration, instructions);
                }
                var geometry = results.routeGeometry;
                if (geometry) {
                    this._fillRouteResultsDetailsGeometry(geometry, this._defaultFeatureStyle);
                }
                if (instructions && instructions[0].geometry) {
                    this._fillRouteResultsDetailsFeatureGeometry(instructions, this._defaultFeatureStyle);
                }
                var bbox = results.bbox;
                if (bbox) {
                    var map = this.getMap();
                    var bounds = [
                        bbox.left,
                        bbox.bottom,
                        bbox.right,
                        bbox.top
                    ];
                    var mapProj = map.getView().getProjection().getCode();
                    if (mapProj !== 'EPSG:4326') {
                        bounds = _ol2.default.proj.transformExtent(bounds, 'EPSG:4326', mapProj);
                    }
                    map.getView().fit(bounds, map.getSize());
                }
                this._currentRouteInformations = results;
                this._formRouteContainer.className = 'GProuteComponentHidden';
                this._hideWaitingContainer();
                this._resultsRouteContainer.className = '';
            };
            Route.prototype._fillRouteResultsDetailsContainer = function (distance, duration, instructions) {
                this._resultsRouteValuesContainer = this._addRouteResultsValuesElement(distance, duration, this._convertSecondsToTime);
                this._resultsRouteDetailsContainer = this._addRouteResultsDetailsElement(instructions, this._convertSecondsToTime);
            };
            Route.prototype._fillRouteResultsDetailsGeometry = function (geometry, style) {
                this._clearRouteResultsGeometry();
                var map = this.getMap();
                if (!geometry) {
                    return;
                }
                var geojsonObject = {
                    type: 'Feature',
                    crs: {
                        type: 'name',
                        properties: { name: 'EPSG:4326' }
                    },
                    geometry: geometry
                };
                var geojsonformat = new _ol2.default.format.GeoJSON({ defaultDataProjection: 'EPSG:4326' });
                var features = geojsonformat.readFeatures(geojsonObject, {
                    dataProjection: 'EPSG:4326',
                    featureProjection: 'EPSG:3857'
                });
                this._geojsonRoute = new _ol2.default.layer.Vector({
                    source: new _ol2.default.source.Vector({ features: features }),
                    style: style
                });
                map.addLayer(this._geojsonRoute);
            };
            Route.prototype._fillRouteResultsDetailsFeatureGeometry = function (instructions, style) {
                this._clearRouteResultsFeatureGeometry();
                var map = this.getMap();
                var geojsonObject = {
                    type: 'FeatureCollection',
                    crs: {
                        type: 'name',
                        properties: { name: 'EPSG:4326' }
                    },
                    features: []
                };
                for (var i = 0; i < instructions.length; i++) {
                    var o = instructions[i];
                    var id = i + 1;
                    var coords = o.geometry.coordinates;
                    for (var j = 0; j < coords.length; j++) {
                        if (typeof coords[j][0] === 'string') {
                            coords[j][0] = parseFloat(coords[j][0]);
                            coords[j][1] = parseFloat(coords[j][1]);
                        }
                    }
                    geojsonObject.features.push({
                        type: 'Feature',
                        geometry: o.geometry,
                        properties: { popupContent: '(' + id + ') distance : ' + this._convertDistance(o.distance) + ' / temps : ' + this._convertSecondsToTime(o.duration) },
                        id: id
                    });
                }
                logger.log(geojsonObject);
                var geojsonformat = new _ol2.default.format.GeoJSON({ defaultDataProjection: 'EPSG:4326' });
                var mapProj = this.getMap().getView().getProjection().getCode();
                var features = geojsonformat.readFeatures(geojsonObject, {
                    dataProjection: 'EPSG:4326',
                    featureProjection: mapProj
                });
                this._geojsonSections = new _ol2.default.layer.Vector({
                    source: new _ol2.default.source.Vector({ features: features }),
                    style: style,
                    opacity: 0.9
                });
                var graph;
                if (this._currentTransport === 'Pieton') {
                    graph = 'piéton';
                    this._geojsonSections.gpResultLayerId = 'Pieton$OGC:OPENLS;Itineraire';
                } else {
                    graph = 'voiture';
                    this._geojsonSections.gpResultLayerId = 'Voiture$OGC:OPENLS;Itineraire';
                }
                map.addLayer(this._geojsonSections);
                map.getControls().forEach(function (control) {
                    if (control instanceof _LayerSwitcher2.default) {
                        var layerId = this._geojsonSections.gpLayerId;
                        if (control._layers[layerId].title === layerId) {
                            control.addLayer(this._geojsonSections, {
                                title: ' Itinéraire ' + graph,
                                description: ' Itinéraire basé sur un graphe ' + graph
                            });
                        }
                    }
                }, this);
                this._resultsHoverInteraction = new _ol2.default.interaction.Select({
                    condition: _ol2.default.events.condition.pointerMove,
                    layers: [this._geojsonSections],
                    style: this._selectedFeatureStyle
                });
                this._resultsHoverInteraction.on('select', this._onResultsFeatureMouseOver, this);
                map.addInteraction(this._resultsHoverInteraction);
                this._resultsSelectInteraction = new _ol2.default.interaction.Select({
                    layers: [this._geojsonSections],
                    style: this._selectedFeatureStyle
                });
                this._resultsSelectInteraction.on('select', this._onResultsFeatureSelect, this);
                map.addInteraction(this._resultsSelectInteraction);
            };
            Route.prototype._onResultsFeatureMouseOver = function (e) {
                if (e.selected.length !== 0) {
                    var f = e.selected[0];
                    var selectedInstruction = document.getElementById('GProuteResultsDetailsInstruction_' + f.getId() + '-' + this._uid);
                    if (selectedInstruction && selectedInstruction.classList) {
                        selectedInstruction.classList.add('GProuteResultsDetailsInstructionHighlight');
                    }
                }
                if (e.deselected.length !== 0) {
                    var deselectedFeature = e.deselected[0];
                    var deSelectedInstruction = document.getElementById('GProuteResultsDetailsInstruction_' + deselectedFeature.getId() + '-' + this._uid);
                    if (deSelectedInstruction && deSelectedInstruction.classList) {
                        deSelectedInstruction.classList.remove('GProuteResultsDetailsInstructionHighlight');
                    }
                }
            };
            Route.prototype._onResultsFeatureSelect = function (e) {
                var map = this.getMap();
                if (e.selected.length !== 0) {
                    var f = e.selected[0];
                    this._popupContent.innerHTML = f.getProperties().popupContent;
                    if (!this._popupOverlay) {
                        this._popupOverlay = new _ol2.default.Overlay({
                            element: this._popupDiv,
                            positioning: 'bottom-center',
                            position: e.mapBrowserEvent.coordinate
                        });
                        map.addOverlay(this._popupOverlay);
                    } else {
                        this._popupOverlay.setPosition(e.mapBrowserEvent.coordinate);
                    }
                } else {
                    if (this._popupOverlay != null) {
                        this._popupOverlay.setPosition(undefined);
                    }
                }
            };
            Route.prototype._clear = function () {
                this._currentTransport = null;
                this._currentExclusions = [];
                this._currentComputation = null;
                this._clearRouteResultsDetails();
                this._clearRouteResultsGeometry();
                this._clearRouteResultsFeatureGeometry();
                for (var i = 0; i < this._currentPoints.length; i++) {
                    this._currentPoints[i].clear();
                }
                this._removeRouteStepLocations();
            };
            Route.prototype._clearRouteInputOptions = function () {
                this._initTransport();
                this._initComputation();
                this._initExclusions();
                var transportdiv;
                if (this._currentTransport === 'Pieton') {
                    transportdiv = document.getElementById('GProuteTransportPedestrian-' + this._uid);
                    if (transportdiv) {
                        transportdiv.checked = 'true';
                    }
                } else {
                    transportdiv = document.getElementById('GProuteTransportCar-' + this._uid);
                    if (transportdiv) {
                        transportdiv.checked = 'true';
                    }
                }
                var computationdiv = document.getElementById('GProuteComputationSelect-' + this._uid);
                if (computationdiv) {
                    computationdiv.value = this._currentComputation;
                }
                var tollInput = document.getElementById('GProuteExclusionsToll-' + this._uid);
                if (tollInput) {
                    if (this._currentExclusions.indexOf('toll') !== -1) {
                        tollInput.checked = false;
                    } else {
                        tollInput.checked = true;
                    }
                }
                var tunnelInput = document.getElementById('GProuteExclusionsTunnel-' + this._uid);
                if (tunnelInput) {
                    if (this._currentExclusions.indexOf('tunnel') !== -1) {
                        tunnelInput.checked = false;
                    } else {
                        tunnelInput.checked = true;
                    }
                }
                var bridgeInput = document.getElementById('GProuteExclusionsBridge-' + this._uid);
                if (bridgeInput) {
                    if (this._currentExclusions.indexOf('bridge') !== -1 && bridgeInput) {
                        bridgeInput.checked = false;
                    } else {
                        bridgeInput.checked = true;
                    }
                }
            };
            Route.prototype._removeRouteStepLocations = function () {
                var points = document.querySelectorAll('div[id^="GPlocationPoint"]');
                var stepPoints = 0;
                if (points.length !== 0) {
                    for (var i = 1; i < points.length - 1; i++) {
                        var classList = points[i].classList;
                        if (classList.length !== 0) {
                            for (var j = 0; j < classList.length; j++) {
                                if (classList[j] === 'GPlocationStageFlexInput') {
                                    document.getElementById(this._addUID('GPlocationStageRemove_' + (i + 1))).click();
                                    stepPoints += 1;
                                }
                            }
                        }
                    }
                }
            };
            Route.prototype._clearRouteResultsDetails = function () {
                this._currentRouteInformations = null;
                if (this._resultsRouteDetailsContainer) {
                    var detailsDiv = this._resultsRouteDetailsContainer;
                    if (detailsDiv.childElementCount) {
                        while (detailsDiv.firstChild) {
                            detailsDiv.removeChild(detailsDiv.firstChild);
                        }
                    }
                }
                if (this._resultsRouteValuesContainer) {
                    var valuesDiv = this._resultsRouteValuesContainer;
                    if (valuesDiv.childElementCount) {
                        while (valuesDiv.firstChild) {
                            valuesDiv.removeChild(valuesDiv.firstChild);
                        }
                    }
                }
            };
            Route.prototype._clearRouteResultsGeometry = function () {
                var map = this.getMap();
                if (this._geojsonRoute != null) {
                    map.removeLayer(this._geojsonRoute);
                    this._geojsonRoute = null;
                }
            };
            Route.prototype._clearRouteResultsFeatureGeometry = function () {
                var map = this.getMap();
                if (this._geojsonSections != null) {
                    map.removeLayer(this._geojsonSections);
                    this._geojsonSections = null;
                }
                if (this._popupOverlay != null) {
                    map.removeOverlay(this._popupOverlay);
                    this._popupOverlay = null;
                }
                if (this._resultsSelectInteraction != null) {
                    map.removeInteraction(this._resultsSelectInteraction);
                    this._resultsSelectInteraction = null;
                }
                if (this._resultsHoverInteraction != null) {
                    map.removeInteraction(this._resultsHoverInteraction);
                    this._resultsHoverInteraction = null;
                }
            };
            Route.prototype._hideRouteSuggestedLocations = function (e) {
                if (e.target && e.target.id && e.target.id.indexOf('GPlocationOrigin_') !== -1) {
                    var pointId = parseInt(e.target.id.split('_')[1][0], 10) - 1;
                    for (var j = 0; j < this._currentPoints.length; j++) {
                        if (j !== parseInt(pointId, 10)) {
                            this._currentPoints[j]._hideSuggestedLocation();
                        }
                    }
                } else {
                    for (var i = 0; i < this._currentPoints.length; i++) {
                        this._currentPoints[i]._hideSuggestedLocation();
                    }
                }
            };
            Route.prototype._displayWaitingContainer = function () {
                this._waitingContainer.className = 'GProuteCalcWaitingContainerVisible';
                this._waiting = true;
                var opts = this.options.routeOptions;
                if (opts && opts.timeOut) {
                    if (this._timer) {
                        clearTimeout(this._timer);
                        this._timer = null;
                    }
                    var context = this;
                    this._timer = setTimeout(function () {
                        if (context._waiting === true) {
                            context._hideWaitingContainer();
                        } else {
                            if (context._timer) {
                                clearTimeout(context._timer);
                            }
                        }
                    }, 16000);
                }
            };
            Route.prototype._hideWaitingContainer = function () {
                if (this._waiting) {
                    this._waitingContainer.className = 'GProuteCalcWaitingContainerHidden';
                    this._waiting = false;
                    var opts = this.options.routeOptions;
                    if (opts && opts.timeOut) {
                        clearTimeout(this._timer);
                        this._timer = null;
                    }
                }
            };
            Route.prototype._simplifiedInstructions = function (instructions) {
                var newInstructions = [];
                var current = instructions[0];
                if (instructions.length === 1) {
                    newInstructions.push(current);
                }
                for (var i = 1; i < instructions.length; i++) {
                    var o = instructions[i];
                    if (o.instruction === current.instruction) {
                        current.distance = (parseFloat(o.distance) + parseFloat(current.distance)).toString();
                        current.duration = (parseFloat(o.duration) + parseFloat(current.duration)).toString();
                        for (var j = 1; j < o.geometry.coordinates.length; j++) {
                            current.geometry.coordinates.push(o.geometry.coordinates[j]);
                        }
                    } else {
                        newInstructions.push(current);
                        current = o;
                        if (i === instructions.length - 1) {
                            newInstructions.push(o);
                            current = null;
                        }
                    }
                }
                logger.log(newInstructions);
                return newInstructions;
            };
            Route.prototype._convertSecondsToTime = function (duration) {
                var time = '';
                duration = Math.round(duration);
                var hours = Math.floor(duration / (60 * 60));
                var divisor4minutes = duration % (60 * 60);
                var minutes = Math.floor(divisor4minutes / 60);
                if (hours) {
                    time = hours + 'h ';
                }
                time += minutes + ' min';
                return time;
            };
            Route.prototype._convertDistance = function (distance) {
                var d = '';
                var distanceKm = parseInt(distance / 1000, 10);
                if (!distanceKm) {
                    d = parseInt(distance, 10) + ' m';
                } else {
                    d = distanceKm + ' km';
                }
                return d;
            };
            exports.default = Route;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var LocationSelectorDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.className = this._addUID('GPlocationPoint');
                    container.className += ' GPwidget';
                    return container;
                },
                _createLocationPointElement: function _createLocationPointElement(id, display) {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPlocationPoint_' + id);
                    div.className = display ? 'GPflexInput GPlocationStageFlexInput' : 'GPflexInput GPlocationStageFlexInputHidden';
                    div.style.cssText = '';
                    return div;
                },
                _createLocationPointLabelElement: function _createLocationPointLabelElement(id, text) {
                    var self = this;
                    var labelOrigin = document.createElement('label');
                    labelOrigin.id = this._addUID('GPlocationOriginLabel_' + id);
                    labelOrigin.htmlFor = 'GPlocationOrigin_' + id;
                    labelOrigin.innerHTML = text;
                    labelOrigin.addEventListener('click', function (e) {
                        var i = _SelectorID2.default.index(this.id);
                        var points = document.getElementsByClassName(self._addUID('GPlocationPoint'));
                        for (var j = 0; j < points.length; j++) {
                            var tag = points[j].childNodes[0].id;
                            var id = _SelectorID2.default.index(tag);
                            document.getElementById(self._addUID('GPlocationPoint_' + id)).style.cssText = '';
                        }
                        document.getElementById(self._addUID('GPlocationOriginCoords_' + i)).value = '';
                        document.getElementById(self._addUID('GPlocationOrigin_' + i)).value = '';
                        document.getElementById(self._addUID('GPlocationPoint_' + i)).style.cssText = '';
                        document.getElementById(self._addUID('GPlocationOriginPointer_' + i)).checked = false;
                        document.getElementById(self._addUID('GPlocationOrigin_' + i)).className = 'GPlocationOriginVisible';
                        document.getElementById(self._addUID('GPlocationOriginCoords_' + i)).className = 'GPlocationOriginHidden';
                        if (document.getElementById(self._addUID('GPlocationStageRemove_' + i))) {
                            document.getElementById(self._addUID('GPlocationStageRemove_' + i)).className = 'GPlocationStageRemove';
                        }
                        if (document.getElementById(self._addUID('GPlocationStageAdd'))) {
                            document.getElementById(self._addUID('GPlocationStageAdd')).className = '';
                        }
                        self.onLocationClearPointClick(e);
                    });
                    return labelOrigin;
                },
                _createLocationAutoCompleteteInputElement: function _createLocationAutoCompleteteInputElement(id) {
                    var self = this;
                    var inputOrigin = document.createElement('input');
                    inputOrigin.id = this._addUID('GPlocationOrigin_' + id);
                    inputOrigin.className = 'GPlocationOriginVisible';
                    inputOrigin.type = 'text';
                    inputOrigin.placeholder = 'Saisir une adresse';
                    inputOrigin.autocomplete = 'off';
                    inputOrigin.addEventListener('keyup', function (e) {
                        var charCode = e.which || e.keyCode;
                        if (charCode === 13 || charCode === 10 || charCode === 38 || charCode === 40) {
                            return;
                        }
                        var i = _SelectorID2.default.index(this.id);
                        if (document.getElementById(self._addUID('GPlocationOrigin_' + i)).value.length > 2) {
                            document.getElementById(self._addUID('GPlocationAutoCompleteList_' + i)).style.display = 'block';
                        } else {
                            document.getElementById(self._addUID('GPlocationAutoCompleteList_' + i)).style.display = 'none';
                        }
                        self.onAutoCompleteSearchText(e);
                    });
                    inputOrigin.addEventListener('keydown', function (e) {
                        var charCode = e.which || e.keyCode;
                        var container = document.getElementById(self._addUID('GPlocationAutoCompleteList_' + id));
                        if (!container) {
                            return;
                        }
                        var curr = container.getElementsByClassName('GPautoCompleteProposal current');
                        var list = container.getElementsByClassName('GPautoCompleteProposal');
                        var length = list.length;
                        if (!length) {
                            return;
                        }
                        var current = null;
                        if (!curr.length) {
                            current = list[0];
                            current.className = 'GPautoCompleteProposal current';
                            current.style.color = '#000000';
                            current.style['background-color'] = '#CEDBEF';
                            return;
                        } else {
                            current = curr[0];
                        }
                        var index = parseInt(_SelectorID2.default.index(current.id), 10);
                        var next = index === length - 1 ? list[0] : list[index + 1];
                        var prev = index === 0 ? list[length - 1] : list[index - 1];
                        current.style['background-color'] = '';
                        current.style.color = '';
                        prev.style['background-color'] = '';
                        prev.style.color = '';
                        next.style['background-color'] = '';
                        next.style.color = '';
                        switch (charCode) {
                        case 38:
                            console.log('arrow up');
                            current.className = 'GPautoCompleteProposal';
                            prev.className = 'GPautoCompleteProposal current';
                            prev.style.color = '#000000';
                            prev.style['background-color'] = '#CEDBEF';
                            break;
                        case 40:
                            console.log('arrow down');
                            current.className = 'GPautoCompleteProposal';
                            next.className = 'GPautoCompleteProposal current';
                            next.style.color = '#000000';
                            next.style['background-color'] = '#CEDBEF';
                            break;
                        case 13:
                            console.log('enter');
                            current.click(e);
                            break;
                        }
                        current.focus();
                    });
                    return inputOrigin;
                },
                _createLocationCoordinateInputElement: function _createLocationCoordinateInputElement(id) {
                    var self = this;
                    var inputOriginCoord = document.createElement('input');
                    inputOriginCoord.id = this._addUID('GPlocationOriginCoords_' + id);
                    inputOriginCoord.className = 'GPlocationOriginHidden';
                    inputOriginCoord.type = 'text';
                    inputOriginCoord.disabled = false;
                    inputOriginCoord.addEventListener('click', function () {
                        var i = _SelectorID2.default.index(this.id);
                        document.getElementById(self._addUID('GPlocationOriginLabel_' + i)).click();
                    });
                    return inputOriginCoord;
                },
                _createLocationPointerShowInputElement: function _createLocationPointerShowInputElement(id) {
                    var inputOriginPointer = document.createElement('input');
                    inputOriginPointer.id = this._addUID('GPlocationOriginPointer_' + id);
                    inputOriginPointer.type = 'checkbox';
                    return inputOriginPointer;
                },
                _createLocationPointerInputElement: function _createLocationPointerInputElement(id) {
                    var self = this;
                    var labelOriginPointer = document.createElement('label');
                    labelOriginPointer.id = this._addUID('GPlocationOriginPointerImg_' + id);
                    labelOriginPointer.htmlFor = 'GPlocationOriginPointer_' + id;
                    labelOriginPointer.className = 'GPlocationOriginPointerImg';
                    labelOriginPointer.title = 'Pointer un lieu sur la carte';
                    labelOriginPointer.addEventListener('click', function (e) {
                        e.preventDefault();
                        e.stopPropagation();
                        var i = _SelectorID2.default.index(this.id);
                        var points = document.getElementsByClassName(self._addUID('GPlocationPoint'));
                        var j;
                        var tag;
                        var id;
                        for (j = 0; j < points.length; j++) {
                            tag = points[j].childNodes[0].id;
                            id = _SelectorID2.default.index(tag);
                            if (i !== id) {
                                document.getElementById(self._addUID('GPlocationOriginPointer_' + id)).checked = false;
                                if (document.getElementById(self._addUID('GPlocationOriginCoords_' + id)).value === 'Pointer un lieu sur la carte') {
                                    document.getElementById(self._addUID('GPlocationOriginCoords_' + id)).value = '';
                                    document.getElementById(self._addUID('GPlocationOrigin_' + id)).className = 'GPlocationOriginVisible';
                                    document.getElementById(self._addUID('GPlocationOriginCoords_' + id)).className = 'GPlocationOriginHidden';
                                }
                            }
                        }
                        if (document.getElementById(self._addUID('GPlocationOriginPointer_' + i)).checked) {
                            document.getElementById(self._addUID('GPlocationOriginCoords_' + i)).value = '';
                            for (j = 0; j < points.length; j++) {
                                tag = points[j].childNodes[0].id;
                                id = _SelectorID2.default.index(tag);
                                document.getElementById(self._addUID('GPlocationPoint_' + id)).style.cssText = '';
                            }
                            if (document.getElementById(self._addUID('GPlocationStageRemove_' + i))) {
                                document.getElementById(self._addUID('GPlocationStageRemove_' + i)).className = 'GPlocationStageRemove';
                            }
                            if (document.getElementById(self._addUID('GPlocationStageAdd'))) {
                                document.getElementById(self._addUID('GPlocationStageAdd')).className = '';
                            }
                            document.getElementById(self._addUID('GPlocationOriginPointer_' + i)).checked = false;
                            document.getElementById(self._addUID('GPlocationOrigin_' + i)).className = 'GPlocationOriginVisible';
                            document.getElementById(self._addUID('GPlocationOriginCoords_' + i)).className = 'GPlocationOriginHidden';
                        } else {
                            document.getElementById(self._addUID('GPlocationOriginCoords_' + i)).value = 'Pointer un lieu sur la carte';
                            for (j = 0; j < points.length; j++) {
                                tag = points[j].childNodes[0].id;
                                id = _SelectorID2.default.index(tag);
                                if (i === id) {
                                    document.getElementById(self._addUID('GPlocationPoint_' + id)).style.cssText = '';
                                } else {
                                    document.getElementById(self._addUID('GPlocationPoint_' + id)).style.display = 'none';
                                }
                            }
                            if (document.getElementById(self._addUID('GPlocationStageRemove_' + i))) {
                                document.getElementById(self._addUID('GPlocationStageRemove_' + i)).className = 'GPlocationOriginHidden';
                            }
                            if (document.getElementById(self._addUID('GPlocationStageAdd'))) {
                                document.getElementById(self._addUID('GPlocationStageAdd')).className = 'GPlocationOriginHidden';
                            }
                            document.getElementById(self._addUID('GPlocationOriginPointer_' + i)).checked = true;
                            document.getElementById(self._addUID('GPlocationOrigin_' + i)).className = 'GPlocationOriginHidden';
                            document.getElementById(self._addUID('GPlocationOriginCoords_' + i)).className = 'GPlocationOriginVisible';
                            document.getElementById(self._addUID('GPlocationOriginCoords_' + i)).disabled = true;
                        }
                        self.onActivateMapPointClick(e);
                    });
                    return labelOriginPointer;
                },
                _createLocationRemovePointElement: function _createLocationRemovePointElement(id) {
                    var self = this;
                    var divRm = document.createElement('div');
                    divRm.id = this._addUID('GPlocationStageRemove_' + id);
                    divRm.className = 'GPlocationStageRemove';
                    divRm.title = 'Supprimer l\'étape';
                    divRm.addEventListener('click', function (e) {
                        var points = document.getElementsByClassName(self._addUID('GPlocationPoint'));
                        var last = points.length - 1;
                        var start = points[0].childNodes[0].id;
                        var end = points[last].childNodes[0].id;
                        var startID = _SelectorID2.default.index(start);
                        var endID = _SelectorID2.default.index(end);
                        if (id !== startID && id !== endID) {
                            var i = _SelectorID2.default.index(this.id);
                            document.getElementById(self._addUID('GPlocationPoint_' + i)).className = 'GPflexInput GPlocationStageFlexInputHidden';
                            document.getElementById(self._addUID('GPlocationOrigin_' + i)).value = '';
                            document.getElementById(self._addUID('GPlocationOrigin_' + i)).className = 'GPlocationOriginVisible';
                            document.getElementById(self._addUID('GPlocationOriginCoords_' + i)).value = '';
                            document.getElementById(self._addUID('GPlocationOriginCoords_' + i)).className = 'GPlocationOriginHidden';
                            document.getElementById(self._addUID('GPlocationStageAdd')).style.display = '';
                            self.onLocationRemovePointClick(e);
                        }
                    });
                    return divRm;
                },
                _createLocationAddPointElement: function _createLocationAddPointElement() {
                    var self = this;
                    var divAdd = document.createElement('div');
                    divAdd.id = this._addUID('GPlocationStageAdd');
                    divAdd.title = 'Ajouter une étape';
                    divAdd.addEventListener('click', function (e) {
                        var lastStage = 1;
                        var nbStages = 0;
                        var points = document.getElementsByClassName(self._addUID('GPlocationPoint'));
                        for (var i = 1; i < points.length - 1; i++) {
                            var tag = points[i].childNodes[0].id;
                            var id = _SelectorID2.default.index(tag);
                            if (document.getElementById(self._addUID('GPlocationPoint_' + id))) {
                                if (document.getElementById(self._addUID('GPlocationPoint_' + id)).className === 'GPflexInput GPlocationStageFlexInputHidden') {
                                    if (lastStage === 1) {
                                        lastStage = id;
                                    }
                                } else {
                                    nbStages++;
                                }
                            }
                        }
                        if (lastStage < points.length) {
                            document.getElementById(self._addUID('GPlocationPoint_' + lastStage)).className = 'GPflexInput GPlocationStageFlexInput';
                        }
                        if (nbStages === 4) {
                            document.getElementById(self._addUID('GPlocationStageAdd')).style.display = 'none';
                        }
                        self.onLocationAddPointClick(e);
                    });
                    return divAdd;
                },
                _createLocationAutoCompleteResultElement: function _createLocationAutoCompleteResultElement(id) {
                    var self = this;
                    var div = document.createElement('div');
                    div.id = this._addUID('GPlocationAutoCompleteList_' + id);
                    div.className = 'GPadvancedAutoCompleteList';
                    if (div.addEventListener) {
                        div.addEventListener('click', function (e) {
                            self.onAutoCompletedResultsItemClick(e);
                            document.getElementById(self._addUID('GPlocationAutoCompleteList_' + id)).style.display = 'none';
                        }, false);
                    } else if (div.attachEvent) {
                        div.attachEvent('onclick', function (e) {
                            self.onAutoCompletedResultsItemClick(e);
                            document.getElementById(self._addUID('GPlocationAutoCompleteList_' + id)).style.display = 'none';
                        });
                    }
                    return div;
                },
                _createLocationAutoCompletedLocationElement: function _createLocationAutoCompletedLocationElement(id, location, n) {
                    var container = document.getElementById(this._addUID('GPlocationAutoCompleteList_' + id));
                    var div = document.createElement('div');
                    div.id = this._addUID('AutoCompletedLocation_' + n);
                    div.className = 'GPautoCompleteProposal';
                    div.innerHTML = location.fullText;
                    container.appendChild(div);
                },
                GPdisplayCoordinate: function GPdisplayCoordinate(value) {
                    var points = document.getElementsByClassName(this._addUID('GPlocationPoint'));
                    for (var i = 0; i < points.length; i++) {
                        var tag = points[i].childNodes[0].id;
                        var id1 = _SelectorID2.default.index(tag);
                        if (document.getElementById(this._addUID('GPlocationOriginPointer_' + id1)).checked) {
                            document.getElementById(this._addUID('GPlocationOriginCoords_' + id1)).value = value;
                            document.getElementById(this._addUID('GPlocationOriginCoords_' + id1)).disabled = false;
                            for (var j = 0; j < points.length; j++) {
                                tag = points[j].childNodes[0].id;
                                var id2 = _SelectorID2.default.index(tag);
                                document.getElementById(this._addUID('GPlocationPoint_' + id2)).style.cssText = '';
                                if (document.getElementById(this._addUID('GPlocationStageRemove_' + id2))) {
                                    document.getElementById(this._addUID('GPlocationStageRemove_' + id2)).className = 'GPlocationStageRemove';
                                }
                            }
                            document.getElementById(this._addUID('GPlocationOriginPointer_' + id1)).checked = false;
                            if (document.getElementById(this._addUID('GPlocationStageAdd'))) {
                                document.getElementById(this._addUID('GPlocationStageAdd')).className = '';
                            }
                            return;
                        }
                    }
                }
            };
            exports.default = LocationSelectorDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var RouteDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GProute');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowRouteElement: function _createShowRouteElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowRoute');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowRoutePictoElement: function _createShowRoutePictoElement() {
                    var context = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowRoutePicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowRoute');
                    label.title = 'Ouvrir le calcul d\'itinéraire';
                    if (label.addEventListener) {
                        label.addEventListener('click', function (e) {
                            context.onShowRoutePanelClick(e);
                        });
                    } else if (label.attachEvent) {
                        label.attachEvent('onclick', function (e) {
                            context.onShowRoutePanelClick(e);
                        });
                    }
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowRouteOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                },
                _createRoutePanelElement: function _createRoutePanelElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GProutePanel');
                    div.className = 'GPpanel';
                    return div;
                },
                _createRoutePanelHeaderElement: function _createRoutePanelHeaderElement() {
                    var self = this;
                    var container = document.createElement('div');
                    container.className = 'GPpanelHeader';
                    var div = document.createElement('div');
                    div.className = 'GPpanelTitle';
                    div.innerHTML = 'Calcul d\'itinéraire';
                    container.appendChild(div);
                    var divClose = document.createElement('div');
                    divClose.id = this._addUID('GProutePanelClose');
                    divClose.className = 'GPpanelClose';
                    divClose.title = 'Masquer le panneau';
                    if (divClose.addEventListener) {
                        divClose.addEventListener('click', function () {
                            document.getElementById(self._addUID('GPshowRoutePicto')).click();
                        }, false);
                    } else if (divClose.attachEvent) {
                        divClose.attachEvent('onclick', function () {
                            document.getElementById(self._addUID('GPshowRoutePicto')).click();
                        });
                    }
                    container.appendChild(divClose);
                    return container;
                },
                _createRoutePanelFormElement: function _createRoutePanelFormElement() {
                    var self = this;
                    var form = document.createElement('form');
                    form.id = this._addUID('GProuteForm');
                    form.setAttribute('onkeypress', 'return event.keyCode != 13;');
                    form.addEventListener('submit', function (e) {
                        console.log(e);
                        e.preventDefault();
                        var points = document.getElementsByClassName(self._addUID('GPlocationPoint'));
                        var start = points[0].childNodes[0].id;
                        var end = points[points.length - 1].childNodes[0].id;
                        var startID = _SelectorID2.default.index(start);
                        var endID = _SelectorID2.default.index(end);
                        if (document.getElementById(self._addUID('GPlocationOrigin_' + startID)).value == '' && document.getElementById(self._addUID('GPlocationOriginCoords_' + startID)).value == '' || document.getElementById(self._addUID('GPlocationOrigin_' + endID)).value == '' && document.getElementById(self._addUID('GPlocationOriginCoords_' + endID)).value == '') {
                            return false;
                        }
                        var id;
                        document.getElementById(self._addUID('GProuteResultsStages')).innerHTML = '';
                        for (var i = 0; i < points.length; i++) {
                            var tag = points[i].childNodes[0].id;
                            id = _SelectorID2.default.index(tag);
                            if (document.getElementById(self._addUID('GPlocationPoint_' + id)).className == 'GPflexInput GPlocationStageFlexInput') {
                                var resultStage = document.createElement('div');
                                resultStage.className = 'GProuteResultsStages';
                                var resultStageLabel = document.createElement('div');
                                resultStageLabel.className = 'GProuteResultStageLabel';
                                resultStageLabel.innerHTML = document.getElementById(self._addUID('GPlocationOriginLabel_' + id)).innerHTML + ' :';
                                resultStage.appendChild(resultStageLabel);
                                var resultStageValue = document.createElement('div');
                                resultStageValue.className = 'GProuteResultStageValue';
                                var elementCoords = document.getElementById(self._addUID('GPlocationOriginCoords_' + id));
                                var stageCoords = elementCoords.value;
                                var visible = elementCoords.className === 'GPlocationOriginVisible';
                                if (stageCoords != null && stageCoords != '' && visible) {
                                    resultStageValue.innerHTML = stageCoords;
                                } else {
                                    resultStageValue.innerHTML = document.getElementById(self._addUID('GPlocationOrigin_' + id)).value;
                                }
                                resultStage.appendChild(resultStageValue);
                                if (resultStageValue.innerHTML != '') {
                                    document.getElementById(self._addUID('GProuteResultsStages')).appendChild(resultStage);
                                }
                            }
                        }
                        var modeComputation = null;
                        if (document.getElementById(self._addUID('GProuteComputationSelect'))) {
                            var select = document.getElementById(self._addUID('GProuteResultsComputationSelect'));
                            select.selectedIndex = document.getElementById(self._addUID('GProuteComputationSelect')).selectedIndex;
                            modeComputation = select.options[select.selectedIndex].value;
                        }
                        var modeTransport = null;
                        if (document.getElementById(self._addUID('GProuteTransportCar'))) {
                            if (document.getElementById(self._addUID('GProuteTransportCar')).checked) {
                                modeTransport = document.getElementById(self._addUID('GProuteTransportCar')).value;
                            }
                        }
                        if (document.getElementById(self._addUID('GProuteTransportPedestrian'))) {
                            if (document.getElementById(self._addUID('GProuteTransportPedestrian')).checked) {
                                modeTransport = document.getElementById(self._addUID('GProuteTransportPedestrian')).value;
                            }
                        }
                        var exclusions = [];
                        var exclusionsElement = document.getElementsByClassName('GProuteExclusionsOption');
                        for (var j = 0; j < exclusionsElement.length; j++) {
                            id = exclusionsElement[j].htmlFor;
                            var el = document.getElementById(id);
                            if (!el.checked) {
                                exclusions.push(el.value);
                            }
                        }
                        self.onRouteComputationSubmit({
                            computation: modeComputation,
                            transport: modeTransport,
                            exclusions: exclusions
                        });
                        return false;
                    });
                    return form;
                },
                _createRoutePanelResultsElement: function _createRoutePanelResultsElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GProuteResultsPanel');
                    container.className = 'GProuteComponentHidden';
                    container.appendChild(this._createRouteResultsStagesElement());
                    container.appendChild(this._createRouteResultsElement());
                    var divBorderUp = document.createElement('div');
                    divBorderUp.className = 'GPfakeBorder GPfakeBorderLeft';
                    container.appendChild(divBorderUp);
                    container.appendChild(this._createRouteShowResultsDetailsElement());
                    var labelShow = document.createElement('label');
                    labelShow.htmlFor = this._addUID('GProuteResultsShowDetails');
                    labelShow.innerHTML = 'Afficher le détail';
                    container.appendChild(labelShow);
                    var labelHide = document.createElement('label');
                    labelHide.htmlFor = this._addUID('GProuteResultsShowDetails');
                    labelHide.innerHTML = 'Masquer le détail';
                    container.appendChild(labelHide);
                    var divBorderDown = document.createElement('div');
                    divBorderDown.className = 'GPfakeBorder';
                    container.appendChild(divBorderDown);
                    container.appendChild(this._createRouteResultsDetailsElement());
                    return container;
                },
                _createRouteWaitingElement: function _createRouteWaitingElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GProuteCalcWaitingContainer');
                    div.className = 'GProuteCalcWaitingContainerHidden';
                    var p = document.createElement('p');
                    p.className = 'GProuteCalcWaiting';
                    p.innerHTML = 'Calcul en cours...';
                    div.appendChild(p);
                    return div;
                },
                _createRouteResultsStagesElement: function _createRouteResultsStagesElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GProuteResultsStages');
                    return div;
                },
                _createRouteResultsElement: function _createRouteResultsElement() {
                    var self = this;
                    var container = document.createElement('div');
                    container.id = this._addUID('GProuteResults');
                    var divValue = document.createElement('div');
                    divValue.id = this._addUID('GProuteResultsValues');
                    container.appendChild(divValue);
                    var divMode = document.createElement('div');
                    divMode.id = this._addUID('GProuteResultsMode');
                    var select = document.createElement('select');
                    select.id = this._addUID('GProuteResultsComputationSelect');
                    select.className = 'GPinputSelect';
                    select.addEventListener('change', function (e) {
                        self.onRouteModeComputationChangeAndRun(e);
                    });
                    var computes = [
                        {
                            code: 'fastest',
                            label: 'Plus rapide'
                        },
                        {
                            code: 'shortest',
                            label: 'Plus court'
                        }
                    ];
                    for (var i = 0; i < computes.length; i++) {
                        var option = document.createElement('option');
                        option.value = computes[i].code;
                        option.text = computes[i].label;
                        select.appendChild(option);
                    }
                    divMode.appendChild(select);
                    container.appendChild(divMode);
                    var divNew = document.createElement('div');
                    divNew.id = this._addUID('GProuteResultsNew');
                    divNew.title = 'Modifier le calcul';
                    divNew.addEventListener('click', function (e) {
                        document.getElementById(self._addUID('GProuteResultsPanel')).className = 'GProuteComponentHidden';
                        document.getElementById(self._addUID('GProuteForm')).className = '';
                        self.onShowRouteResultsNewClick(e);
                    });
                    container.appendChild(divNew);
                    return container;
                },
                _addRouteResultsValuesElement: function _addRouteResultsValuesElement(distance, duration, fconvert) {
                    var div = document.getElementById(this._addUID('GProuteResultsValues'));
                    if (div.childElementCount) {
                        while (div.firstChild) {
                            div.removeChild(div.firstChild);
                        }
                    }
                    var containerDistance = document.createElement('div');
                    containerDistance.className = 'GProuteResultsValue';
                    var labelDistance = document.createElement('label');
                    labelDistance.className = 'GProuteResultsValueLabel';
                    labelDistance.innerHTML = 'Distance :';
                    containerDistance.appendChild(labelDistance);
                    var distanceLabel = 0;
                    var isKm = parseInt(distance / 1000, 10);
                    if (!isKm) {
                        distanceLabel = Math.round(distance) + ' m';
                    } else {
                        var distanceArrondi = Math.round(distance);
                        distanceArrondi = distanceArrondi / 1000;
                        distanceLabel = distanceArrondi + ' km';
                    }
                    var divDistance = document.createElement('div');
                    divDistance.id = this._addUID('GProuteResultsValueDist');
                    divDistance.innerHTML = distanceLabel;
                    containerDistance.appendChild(divDistance);
                    div.appendChild(containerDistance);
                    var containerDuration = document.createElement('div');
                    containerDuration.className = 'GProuteResultsValue';
                    var labelDuration = document.createElement('label');
                    labelDuration.className = 'GProuteResultsValueLabel';
                    labelDuration.innerHTML = 'Durée :';
                    containerDuration.appendChild(labelDuration);
                    var divDuration = document.createElement('div');
                    divDuration.id = this._addUID('GProuteResultsValueDist');
                    divDuration.innerHTML = fconvert(duration);
                    containerDuration.appendChild(divDuration);
                    div.appendChild(containerDuration);
                    return div;
                },
                _createRouteShowResultsDetailsElement: function _createRouteShowResultsDetailsElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GProuteResultsShowDetails');
                    input.type = 'checkbox';
                    return input;
                },
                _createRouteResultsDetailsElement: function _createRouteResultsDetailsElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GProuteResultsDetails');
                    return div;
                },
                _addRouteResultsDetailsElement: function _addRouteResultsDetailsElement(instructions, fconvert) {
                    var context = this;
                    var div = document.getElementById(this._addUID('GProuteResultsDetails'));
                    if (div.childElementCount) {
                        while (div.firstChild) {
                            div.removeChild(div.firstChild);
                        }
                    }
                    var distanceCumul = 0;
                    var durationCumul = 0;
                    for (var i = 0; i < instructions.length; i++) {
                        var id = i + 1;
                        var o = instructions[i];
                        var divNum = document.createElement('div');
                        divNum.className = 'GProuteResultsDetailsNumber';
                        divNum.innerHTML = id + '.';
                        div.appendChild(divNum);
                        durationCumul += parseFloat(o.duration);
                        distanceCumul += parseFloat(o.distance);
                        var distance = 0;
                        var isCumulKm = parseInt(distanceCumul / 1000, 10);
                        if (!isCumulKm) {
                            distance = Math.round(distanceCumul) + ' m';
                        } else {
                            var distanceArrondi = Math.round(distanceCumul);
                            distanceArrondi = distanceArrondi / 1000;
                            distance = distanceArrondi + ' km';
                        }
                        var divIns = document.createElement('div');
                        divIns.className = 'GProuteResultsDetailsInstruction';
                        divIns.id = this._addUID('GProuteResultsDetailsInstruction_' + id);
                        divIns.title = 'distance : ' + distance + ' / ' + 'temps : ' + fconvert(durationCumul);
                        divIns.innerHTML = o.instruction;
                        divIns.addEventListener('mouseover', function (e) {
                            context.onRouteResultsDetailsMouseOver(e);
                        });
                        divIns.addEventListener('mouseout', function (e) {
                            context.onRouteResultsDetailsMouseOut(e);
                        });
                        divIns.addEventListener('click', function (e) {
                            if (typeof context.onRouteResultsDetailsClick === 'function') {
                                context.onRouteResultsDetailsClick(e);
                            }
                        });
                        div.appendChild(divIns);
                    }
                    return div;
                },
                _createRoutePanelFormPointElement: function _createRoutePanelFormPointElement(n, text, visibility) {
                    var context = this;
                    var div = document.createElement('div');
                    div.id = 'GProutePoint' + n;
                    div.className = visibility ? 'GPflexInput GProuteStageFlexInput' : 'GPflexInput GProuteStageFlexInputHidden';
                    var labelOrigin = document.createElement('label');
                    labelOrigin.id = 'GProuteOriginLabel' + n;
                    labelOrigin.htmlFor = 'GProuteOrigin' + n;
                    labelOrigin.innerHTML = text;
                    labelOrigin.addEventListener('click', function () {
                        var i = this.id.charAt(this.id.length - 1);
                        document.getElementById('GProuteOriginCoords' + i).value = '';
                        for (var j = 1; j < 8; j++) {
                            document.getElementById('GProutePoint' + j).style.display = 'flex';
                        }
                        document.getElementById('GProuteForm').className = '';
                        document.getElementById('GProuteOriginPointer' + i).checked = false;
                        document.getElementById('GProuteOrigin' + i).className = 'GProuteOriginVisible';
                        document.getElementById('GProuteOriginCoords' + i).className = 'GProuteOriginHidden';
                    });
                    div.appendChild(labelOrigin);
                    var inputOrigin = document.createElement('input');
                    inputOrigin.id = 'GProuteOrigin' + n;
                    inputOrigin.className = 'GProuteOriginVisible';
                    inputOrigin.type = 'text';
                    inputOrigin.placeholder = 'Saisir une adresse';
                    inputOrigin.addEventListener('keyup', function (e) {
                        var charCode = e.which || e.keyCode;
                        if (charCode === 13 || charCode === 10) {
                            return;
                        }
                        var i = this.id.charAt(this.id.length - 1);
                        if (document.getElementById('GProuteOrigin' + i).value.length > 2) {
                            document.getElementById('GProuteAutoCompleteList' + i).style.display = 'block';
                        } else {
                            document.getElementById('GProuteAutoCompleteList' + i).style.display = 'none';
                        }
                        context.onAutoCompleteSearchText(e);
                    });
                    inputOrigin.addEventListener('blur', function () {
                        var i = this.id.charAt(this.id.length - 1);
                        document.getElementById('GProuteAutoCompleteList' + i).style.display = 'none';
                    });
                    div.appendChild(inputOrigin);
                    var inputOriginCoord = document.createElement('input');
                    inputOriginCoord.id = 'GProuteOriginCoords' + n;
                    inputOriginCoord.className = 'GProuteOriginHidden';
                    inputOriginCoord.type = 'text';
                    inputOriginCoord.disabled = true;
                    div.appendChild(inputOriginCoord);
                    var inputOriginPointer = document.createElement('input');
                    inputOriginPointer.id = 'GProuteOriginPointer' + n;
                    inputOriginPointer.type = 'checkbox';
                    div.appendChild(inputOriginPointer);
                    var labelOriginPointer = document.createElement('label');
                    labelOriginPointer.id = 'GProuteOriginPointerImg' + n;
                    labelOriginPointer.htmlFor = 'GProuteOriginPointer' + n;
                    labelOriginPointer.className = 'GProuteOriginPointerImg';
                    labelOriginPointer.title = 'Pointer un lieu sur la carte';
                    labelOriginPointer.addEventListener('click', function (evt) {
                        evt.preventDefault();
                        evt.stopPropagation();
                        var i = this.id.charAt(this.id.length - 1);
                        var j;
                        for (j = 1; j < 8; j++) {
                            if (i != j) {
                                document.getElementById('GProuteOriginPointer' + j).checked = false;
                                if (document.getElementById('GProuteOriginCoords' + j).value == 'Pointer un lieu sur la carte') {
                                    document.getElementById('GProuteOriginCoords' + j).value = '';
                                    document.getElementById('GProuteOrigin' + j).className = 'GProuteOriginVisible';
                                    document.getElementById('GProuteOriginCoords' + j).className = 'GProuteOriginHidden';
                                }
                            }
                        }
                        if (document.getElementById('GProuteOriginPointer' + i).checked) {
                            document.getElementById('GProuteOriginCoords' + i).value = '';
                            for (j = 1; j < 8; j++) {
                                document.getElementById('GProutePoint' + j).style.display = 'flex';
                            }
                            document.getElementById('GProuteForm').className = '';
                            document.getElementById('GProuteOriginPointer' + i).checked = false;
                            document.getElementById('GProuteOrigin' + i).className = 'GProuteOriginVisible';
                            document.getElementById('GProuteOriginCoords' + i).className = 'GProuteOriginHidden';
                        } else {
                            document.getElementById('GProuteOriginCoords' + i).value = 'Pointer un lieu sur la carte';
                            for (j = 1; j < 8; j++) {
                                if (i == j) {
                                    document.getElementById('GProutePoint' + j).style.display = 'flex';
                                } else {
                                    document.getElementById('GProutePoint' + j).style.display = 'none';
                                }
                            }
                            document.getElementById('GProuteForm').className = 'GProuteFormMini';
                            document.getElementById('GProuteOriginPointer' + i).checked = true;
                            document.getElementById('GProuteOrigin' + i).className = 'GProuteOriginHidden';
                            document.getElementById('GProuteOriginCoords' + i).className = 'GProuteOriginVisible';
                        }
                        context.onRouteMapPointClick(evt);
                    });
                    div.appendChild(labelOriginPointer);
                    return div;
                },
                _createRoutePanelFormRemoveStageElement: function _createRoutePanelFormRemoveStageElement(n) {
                    var context = this;
                    var divRm = document.createElement('div');
                    divRm.id = 'GProuteStageRemove' + n;
                    divRm.className = 'GProuteStageRemove';
                    divRm.title = 'Supprimer l\'étape';
                    if (n != 1 && n != 7) {
                        divRm.addEventListener('click', function (e) {
                            var i = this.id.charAt(this.id.length - 1);
                            document.getElementById('GProutePoint' + i).className = 'GPflexInput GProuteStageFlexInputHidden';
                            document.getElementById('GProuteOrigin' + i).value = '';
                            document.getElementById('GProuteOrigin' + i).className = 'GProuteOriginVisible';
                            document.getElementById('GProuteOriginCoords' + i).value = '';
                            document.getElementById('GProuteOriginCoords' + i).className = 'GProuteOriginHidden';
                            document.getElementById('GProuteStageAdd').style.display = '';
                            var exclusionsPictoTop = document.getElementById('GPshowRouteExclusionsPicto').style.top;
                            document.getElementById('GPshowRouteExclusionsPicto').style.top = (parseInt(exclusionsPictoTop, 10) - 33).toString() + 'px';
                            context.onRouteRemovePointClick(e);
                        });
                    }
                    return divRm;
                },
                _createRoutePanelFormAddStageElement: function _createRoutePanelFormAddStageElement() {
                    var context = this;
                    var divAdd = document.createElement('div');
                    divAdd.id = 'GProuteStageAdd';
                    divAdd.title = 'Ajouter une étape';
                    divAdd.addEventListener('click', function (e) {
                        var lastStage = 1;
                        var nbStages = 0;
                        for (var i = 2; i < 7; i++) {
                            if (document.getElementById('GProutePoint' + i).className == 'GPflexInput GProuteStageFlexInputHidden') {
                                if (lastStage == 1) {
                                    lastStage = i;
                                }
                            } else {
                                nbStages++;
                            }
                        }
                        if (lastStage < 7) {
                            document.getElementById('GProutePoint' + lastStage).className = 'GPflexInput GProuteStageFlexInput';
                            var exclusionsPictoTop = document.getElementById('GPshowRouteExclusionsPicto').style.top;
                            document.getElementById('GPshowRouteExclusionsPicto').style.top = (parseInt(exclusionsPictoTop, 10) + 33).toString() + 'px';
                        }
                        if (nbStages == 4) {
                            document.getElementById('GProuteStageAdd').style.display = 'none';
                        }
                        context.onRouteAddPointClick(e);
                    });
                    return divAdd;
                },
                _createRoutePanelFormAutoCompleteListElement: function _createRoutePanelFormAutoCompleteListElement(n) {
                    var context = this;
                    var div = document.createElement('div');
                    div.id = 'GProuteAutoCompleteList' + n;
                    div.className = 'GPadvancedAutoCompleteList';
                    if (div.addEventListener) {
                        div.addEventListener('click', function (e) {
                            context.onAutoCompletedResultsItemClick(e);
                            document.getElementById('GProuteAutoCompleteList' + n).style.display = 'none';
                        }, false);
                    } else if (div.attachEvent) {
                        div.attachEvent('onclick', function (e) {
                            context.onAutoCompletedResultsItemClick(e);
                            document.getElementById('GProuteAutoCompleteList' + n).style.display = 'none';
                        });
                    }
                    return div;
                },
                _createRouteAutoCompletedLocationElement: function _createRouteAutoCompletedLocationElement(location, n, id) {
                    var container = document.getElementById('GProuteAutoCompleteList' + n);
                    var div = document.createElement('div');
                    div.id = 'AutoCompletedLocation' + id;
                    div.className = 'GPautoCompleteProposal';
                    div.innerHTML = location.fullText;
                    container.appendChild(div);
                },
                _createRoutePanelFormModeChoiceElement: function _createRoutePanelFormModeChoiceElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GProuteModeChoice');
                    return div;
                },
                _createRoutePanelFormModeChoiceTransportElement: function _createRoutePanelFormModeChoiceTransportElement(transports) {
                    var context = this;
                    var div = document.createElement('div');
                    div.id = this._addUID('GProuteTransportChoice');
                    var span = document.createElement('span');
                    span.className = 'GProuteModeLabel';
                    span.innerHTML = 'Mode de transport';
                    div.appendChild(span);
                    for (var i = 0; i < transports.length; i++) {
                        var transport = transports[i];
                        if (transport === 'Voiture') {
                            var inputCar = document.createElement('input');
                            inputCar.id = this._addUID('GProuteTransportCar');
                            inputCar.type = 'radio';
                            inputCar.name = 'GProuteTransport';
                            inputCar.value = 'Voiture';
                            if (i === 0) {
                                inputCar.checked = true;
                            }
                            if (inputCar.addEventListener) {
                                inputCar.addEventListener('change', function (e) {
                                    context.onRouteModeTransportChange(e);
                                });
                            } else if (inputCar.attachEvent) {
                                inputCar.attachEvent('onchange', function (e) {
                                    context.onRouteModeTransportChange(e);
                                });
                            }
                            div.appendChild(inputCar);
                            var labelCar = document.createElement('label');
                            labelCar.className = 'GProuteTransportImg';
                            labelCar.htmlFor = this._addUID('GProuteTransportCar');
                            labelCar.title = 'Voiture';
                            div.appendChild(labelCar);
                        }
                        if (transport === 'Pieton') {
                            var inputPedestrian = document.createElement('input');
                            inputPedestrian.id = this._addUID('GProuteTransportPedestrian');
                            inputPedestrian.type = 'radio';
                            inputPedestrian.name = 'GProuteTransport';
                            inputPedestrian.value = 'Pieton';
                            if (i === 0) {
                                inputPedestrian.checked = true;
                            }
                            if (inputPedestrian.addEventListener) {
                                inputPedestrian.addEventListener('change', function (e) {
                                    context.onRouteModeTransportChange(e);
                                });
                            } else if (inputPedestrian.attachEvent) {
                                inputPedestrian.attachEvent('onchange', function (e) {
                                    context.onRouteModeTransportChange(e);
                                });
                            }
                            div.appendChild(inputPedestrian);
                            var labelPedestrian = document.createElement('label');
                            labelPedestrian.className = 'GProuteTransportImg';
                            labelPedestrian.htmlFor = this._addUID('GProuteTransportPedestrian');
                            labelPedestrian.title = 'Piéton';
                            div.appendChild(labelPedestrian);
                        }
                    }
                    return div;
                },
                _createRoutePanelFormModeChoiceComputeElement: function _createRoutePanelFormModeChoiceComputeElement() {
                    var context = this;
                    var div = document.createElement('div');
                    div.id = this._addUID('GProuteComputationChoice');
                    var span = document.createElement('span');
                    span.className = 'GProuteModeLabel';
                    span.innerHTML = 'Mode de calcul';
                    div.appendChild(span);
                    var select = document.createElement('select');
                    select.id = this._addUID('GProuteComputationSelect');
                    select.className = 'GPinputSelect';
                    select.addEventListener('change', function (e) {
                        context.onRouteModeComputationChange(e);
                    });
                    var computes = [
                        {
                            code: 'fastest',
                            label: 'Plus rapide'
                        },
                        {
                            code: 'shortest',
                            label: 'Plus court'
                        }
                    ];
                    for (var i = 0; i < computes.length; i++) {
                        var option = document.createElement('option');
                        option.value = computes[i].code;
                        option.text = computes[i].label;
                        select.appendChild(option);
                    }
                    div.appendChild(select);
                    return div;
                },
                _createShowRouteExclusionsElement: function _createShowRouteExclusionsElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowRouteExclusions');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowRouteExclusionsPictoElement: function _createShowRouteExclusionsPictoElement() {
                    var context = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowRouteExclusionsPicto');
                    label.className = 'GPshowMoreOptions GPshowRouteExclusionsPicto';
                    label.htmlFor = this._addUID('GPshowRouteExclusions');
                    label.title = 'Exclusions';
                    label.style.top = '185px';
                    if (label.addEventListener) {
                        label.addEventListener('click', function (e) {
                            context.onShowRouteExclusionsClick(e);
                        });
                    } else if (label.attachEvent) {
                        label.attachEvent('onclick', function (e) {
                            context.onShowRouteExclusionsClick(e);
                        });
                    }
                    return label;
                },
                _createRoutePanelFormExclusionsElement: function _createRoutePanelFormExclusionsElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GProuteExclusions');
                    var span = document.createElement('span');
                    span.className = 'GProuteExclusionsLabel';
                    span.innerHTML = 'Passages autorisés';
                    div.appendChild(span);
                    return div;
                },
                _createRoutePanelFormExclusionOptionsElement: function _createRoutePanelFormExclusionOptionsElement(exclusions) {
                    var context = this;
                    var div = document.createElement('div');
                    div.className = 'GProuteExclusionsOptions';
                    for (var value in exclusions) {
                        if (exclusions.hasOwnProperty(value)) {
                            var status = exclusions[value];
                            switch (value) {
                            case 'toll':
                                var inputToll = document.createElement('input');
                                inputToll.id = this._addUID('GProuteExclusionsToll');
                                inputToll.type = 'checkbox';
                                inputToll.value = 'Toll';
                                inputToll.checked = !status;
                                if (inputToll.addEventListener) {
                                    inputToll.addEventListener('change', function (e) {
                                        context.onRouteExclusionsChange(e);
                                    });
                                } else if (inputToll.attachEvent) {
                                    inputToll.attachEvent('onchange', function (e) {
                                        context.onRouteExclusionsChange(e);
                                    });
                                }
                                div.appendChild(inputToll);
                                var labelToll = document.createElement('label');
                                labelToll.className = 'GProuteExclusionsOption';
                                labelToll.htmlFor = this._addUID('GProuteExclusionsToll');
                                labelToll.innerHTML = 'Péages';
                                div.appendChild(labelToll);
                                break;
                            case 'tunnel':
                                var inputTunnel = document.createElement('input');
                                inputTunnel.id = this._addUID('GProuteExclusionsTunnel');
                                inputTunnel.type = 'checkbox';
                                inputTunnel.value = 'Tunnel';
                                inputTunnel.checked = !status;
                                if (inputTunnel.addEventListener) {
                                    inputTunnel.addEventListener('change', function (e) {
                                        context.onRouteExclusionsChange(e);
                                    });
                                } else if (inputTunnel.attachEvent) {
                                    inputTunnel.attachEvent('onchange', function (e) {
                                        context.onRouteExclusionsChange(e);
                                    });
                                }
                                div.appendChild(inputTunnel);
                                var labelTunnel = document.createElement('label');
                                labelTunnel.className = 'GProuteExclusionsOption';
                                labelTunnel.htmlFor = this._addUID('GProuteExclusionsTunnel');
                                labelTunnel.innerHTML = 'Tunnels';
                                div.appendChild(labelTunnel);
                                break;
                            case 'bridge':
                                var inputBridge = document.createElement('input');
                                inputBridge.id = this._addUID('GProuteExclusionsBridge');
                                inputBridge.type = 'checkbox';
                                inputBridge.value = 'Bridge';
                                inputBridge.checked = !status;
                                if (inputBridge.addEventListener) {
                                    inputBridge.addEventListener('change', function (e) {
                                        context.onRouteExclusionsChange(e);
                                    });
                                } else if (inputBridge.attachEvent) {
                                    inputBridge.attachEvent('onchange', function (e) {
                                        context.onRouteExclusionsChange(e);
                                    });
                                }
                                div.appendChild(inputBridge);
                                var labelBridge = document.createElement('label');
                                labelBridge.className = 'GProuteExclusionsOption';
                                labelBridge.htmlFor = this._addUID('GProuteExclusionsBridge');
                                labelBridge.innerHTML = 'Ponts';
                                div.appendChild(labelBridge);
                                break;
                            }
                        }
                    }
                    return div;
                },
                _createRouteSubmitFormElement: function _createRouteSubmitFormElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GProuteSubmit');
                    input.className = 'GPinputSubmit';
                    input.type = 'submit';
                    input.value = 'Calculer';
                    return input;
                },
                _createRouteFormResetElement: function _createRouteFormResetElement() {
                    var self = this;
                    var divReset = document.createElement('div');
                    divReset.id = this._addUID('GProuteReset');
                    divReset.title = 'Réinitialiser les paramètres';
                    divReset.addEventListener('click', function (e) {
                        self.onRouteResetClick(e);
                    });
                    return divReset;
                }
            };
            exports.default = RouteDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _CheckRightManagement = __webpack_require__(6);
            var _CheckRightManagement2 = _interopRequireDefault(_CheckRightManagement);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _LocationSelector = __webpack_require__(42);
            var _LocationSelector2 = _interopRequireDefault(_LocationSelector);
            var _LayerSwitcher = __webpack_require__(12);
            var _LayerSwitcher2 = _interopRequireDefault(_LayerSwitcher);
            var _Markers = __webpack_require__(7);
            var _Markers2 = _interopRequireDefault(_Markers);
            var _IsoDOM = __webpack_require__(102);
            var _IsoDOM2 = _interopRequireDefault(_IsoDOM);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('isocurve');
            function Isocurve(options) {
                options = options || {};
                if (!(this instanceof Isocurve)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this.initialize(options);
                this._container = this._createMainContainerElement();
                this._containerElement = null;
                if (options.element && options.element.appendChild) {
                    options.element.appendChild(this._container);
                    this._containerElement = options.element;
                }
                _ol2.default.control.Control.call(this, {
                    element: this._containerElement || this._container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(Isocurve, _ol2.default.control.Control);
            Isocurve.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(Isocurve.prototype, _IsoDOM2.default);
            Isocurve.prototype.constructor = Isocurve;
            Isocurve.prototype.getCollapsed = function () {
                return this.collapsed;
            };
            Isocurve.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] Isocurve:setCollapsed - missing collapsed parameter');
                    return;
                }
                if (collapsed && this.collapsed || !collapsed && !this.collapsed) {
                    return;
                }
                if (collapsed) {
                    document.getElementById('GPisochronPanelClose-' + this._uid).click();
                } else {
                    document.getElementById('GPshowIsochronPicto-' + this._uid).click();
                }
                this.collapsed = collapsed;
            };
            Isocurve.prototype.getLayer = function () {
                return this._geojsonLayer;
            };
            Isocurve.prototype.setMap = function (map) {
                if (map) {
                    this._container = this._initContainer(map);
                }
                _ol2.default.control.Control.prototype.setMap.call(this, map);
            };
            Isocurve.prototype.initialize = function (options) {
                this._checkInputOptions(options);
                this.options = {
                    collapsed: true,
                    methods: [
                        'time',
                        'distance'
                    ],
                    graphs: [
                        'Voiture',
                        'Pieton'
                    ],
                    exclusions: {
                        toll: false,
                        tunnel: false,
                        bridge: false
                    },
                    directions: [
                        'departure',
                        'arrival'
                    ],
                    markerOpts: {
                        url: _Markers2.default['lightOrange'],
                        offset: _Markers2.default.defaultOffset
                    },
                    isocurveOptions: {},
                    autocompleteOptions: {}
                };
                _Utils2.default.assign(this.options, options);
                this.collapsed = this.options.collapsed;
                this._uid = _SelectorID2.default.generate();
                this._currentTransport = null;
                this._initTransport();
                this._currentComputation = null;
                this._initComputation();
                this._currentExclusions = [];
                this._initExclusions();
                this._currentDirection = null;
                this._initDirection();
                this._originPoint = null;
                this._showIsoContainer = null;
                this._waitingContainer = null;
                this._formContainer = null;
                this._currentIsoResults = null;
                this._geojsonLayer = null;
                this._waiting = false;
                this._timer = null;
                this._defaultFeatureStyle = new _ol2.default.style.Style({ fill: new _ol2.default.style.Fill({ color: 'rgba(0, 183, 152, 0.7)' }) });
                this._resources = {};
                this._noRightManagement = false;
                this._checkRightsManagement();
            };
            Isocurve.prototype._checkInputOptions = function (options) {
                var i;
                if (options.methods) {
                    if (Array.isArray(options.methods)) {
                        if (options.methods.length === 0) {
                            options.methods = null;
                        } else {
                            for (i = 0; i < options.methods.length; i++) {
                                if (typeof options.methods[i] !== 'string') {
                                    console.log('[ol.control.Isocurve] ERROR : parameter \'methods\' elements should be of type \'string\'');
                                }
                            }
                        }
                    } else {
                        logger.warn('\'methods\' parameter should be an array');
                        options.methods = null;
                    }
                }
                if (options.graphs) {
                    if (Array.isArray(options.graphs)) {
                        if (options.graphs.length === 0) {
                            options.graphs = null;
                        } else {
                            for (i = 0; i < options.graphs.length; i++) {
                                if (typeof options.graphs[i] !== 'string') {
                                    console.log('[ol.control.Isocurve] ERROR : parameter \'graphs\' elements should be of type \'string\'');
                                } else {
                                    if (options.graphs[i].toLowerCase() === 'pieton') {
                                        options.graphs[i] = 'Pieton';
                                    }
                                    if (options.graphs[i].toLowerCase() === 'voiture') {
                                        options.graphs[i] = 'Voiture';
                                    }
                                }
                            }
                        }
                    } else {
                        logger.warn('\'graphs\' parameter should be an array');
                        options.graphs = null;
                    }
                }
                if (options.directions) {
                    if (Array.isArray(options.directions)) {
                        if (options.directions.length === 0) {
                            options.directions = null;
                        } else {
                            for (i = 0; i < options.directions.length; i++) {
                                if (typeof options.directions[i] !== 'string') {
                                    console.log('[ol.control.Isocurve] ERROR : parameter \'directions\' elements should be of type \'string\'');
                                }
                            }
                        }
                    } else {
                        logger.warn('\'directions\' parameter should be an array');
                        options.directions = null;
                    }
                }
                if (options.collapsed === 'true') {
                    options.collapsed = true;
                }
                if (options.collapsed === 'false') {
                    options.collapsed = false;
                }
            };
            Isocurve.prototype._initTransport = function () {
                this._currentTransport = 'Voiture';
                var transports = this.options.graphs;
                if (!transports || transports.length === 0) {
                    this.options.graphs = [
                        'Voiture',
                        'Pieton'
                    ];
                }
                if (Array.isArray(transports) && transports.length) {
                    if (transports[0] === 'Voiture' || transports[0] === 'Pieton') {
                        this._currentTransport = transports[0];
                    }
                }
                var serviceOptions = this.options.isocurveOptions;
                if (serviceOptions.graph) {
                    this._currentTransport = serviceOptions.graph;
                }
            };
            Isocurve.prototype._initComputation = function () {
                this._currentComputation = 'time';
                var methods = this.options.methods;
                if (!methods || methods.length === 0) {
                    this.options.methods = [
                        'time',
                        'distance'
                    ];
                }
                if (Array.isArray(methods) && methods.length) {
                    if (methods[0] === 'time' || methods[0] === 'distance') {
                        this._currentComputation = methods[0];
                    }
                }
                var serviceOptions = this.options.isocurveOptions;
                if (serviceOptions.method) {
                    this._currentComputation = serviceOptions.method;
                }
                if (serviceOptions.time) {
                    this._currentComputation = 'time';
                }
                if (serviceOptions.distance) {
                    this._currentComputation = 'distance';
                }
            };
            Isocurve.prototype._initDirection = function () {
                this._currentDirection = 'departure';
                var directions = this.options.directions;
                if (!directions || directions.length === 0) {
                    this.options.directions = [
                        'departure',
                        'arrival'
                    ];
                }
                if (Array.isArray(directions) && directions.length) {
                    if (directions[0] === 'departure' || directions[0] === 'arrival') {
                        this._currentDirection = directions[0];
                    }
                }
                var serviceOptions = this.options.isocurveOptions;
                if (!serviceOptions.reverse) {
                    this._currentDirection = 'departure';
                }
                if (serviceOptions.reverse === true) {
                    this._currentDirection = 'arrival';
                    this.options.directions = [
                        'arrival',
                        'departure'
                    ];
                }
            };
            Isocurve.prototype._initExclusions = function () {
                this._currentExclusions = [];
                var exclusion = this.options.exclusions;
                if (!exclusion || (typeof exclusion === 'undefined' ? 'undefined' : _typeof(exclusion)) === 'object' && Object.keys(exclusion).length === 0) {
                    this.options.exclusions = {
                        toll: false,
                        tunnel: false,
                        bridge: false
                    };
                }
                if (exclusion && (typeof exclusion === 'undefined' ? 'undefined' : _typeof(exclusion)) === 'object' && Object.keys(exclusion).length) {
                    for (var k in exclusion) {
                        if (exclusion.hasOwnProperty(k)) {
                            if (exclusion.k) {
                                this._currentExclusions.push(k);
                            }
                        }
                    }
                }
                var serviceOptions = this.options.isocurveOptions;
                if (Array.isArray(serviceOptions.exclusions)) {
                    this._currentExclusions = serviceOptions.exclusions;
                }
            };
            Isocurve.prototype._checkRightsManagement = function () {
                var _opts = null;
                var _res = [];
                var _key = null;
                _key = this.options.isocurveOptions.apiKey;
                _opts = this.options.isocurveOptions.filterOptions;
                _res = _opts ? _opts.type : [];
                if (!_res || _res.length === 0) {
                    _res = [
                        'Voiture',
                        'Pieton'
                    ];
                }
                var rightManagementIsocurve = _CheckRightManagement2.default.check({
                    key: _key || this.options.apiKey,
                    resources: _res,
                    services: ['Isochrone']
                });
                logger.log('rightManagementIsocurve', rightManagementIsocurve);
                _key = this.options.autocompleteOptions.apiKey;
                _opts = this.options.autocompleteOptions.filterOptions;
                _res = _opts ? _opts.type : [];
                if (!_res || _res.length === 0) {
                    _res = [
                        'PositionOfInterest',
                        'StreetAddress'
                    ];
                }
                var rightManagementAutoComplete = _CheckRightManagement2.default.check({
                    key: _key || this.options.apiKey,
                    resources: _res,
                    services: ['AutoCompletion']
                });
                logger.log('rightManagementAutoComplete', rightManagementAutoComplete);
                if (!rightManagementIsocurve && !rightManagementAutoComplete) {
                    this._noRightManagement = true;
                }
                if (rightManagementAutoComplete) {
                    this._resources['AutoCompletion'] = {};
                    this._resources['AutoCompletion']['resources'] = rightManagementAutoComplete['AutoCompletion'];
                    this._resources['AutoCompletion']['key'] = rightManagementAutoComplete['key'];
                }
                if (rightManagementIsocurve) {
                    this._resources['Isocurve'] = {};
                    this._resources['Isocurve']['resources'] = rightManagementIsocurve['Isochrone'];
                    this._resources['Isocurve']['key'] = rightManagementIsocurve['key'];
                }
            };
            Isocurve.prototype._initContainer = function (map) {
                var container = this._container;
                var inputShow = this._showIsoContainer = this._createShowIsoElement();
                container.appendChild(inputShow);
                if (!this.collapsed) {
                    inputShow.checked = true;
                }
                var picto = this._createShowIsoPictoElement();
                container.appendChild(picto);
                var panel = this._createIsoPanelElement();
                var header = this._createIsoPanelHeaderElement();
                panel.appendChild(header);
                var form = this._formContainer = this._createIsoPanelFormElement();
                var point = this._createIsoPanelFormPointElement(map);
                form.appendChild(point);
                var isoChronChecked = false;
                var isoDistChecked = false;
                var typeChoice = this._createIsoPanelFormTypeChoiceElement();
                for (var i = 0; i < this.options.methods.length; i++) {
                    if (this.options.methods[i] === 'time') {
                        isoChronChecked = i === 0;
                        typeChoice.appendChild(this._createIsoPanelFormTypeChoiceChronElement(isoChronChecked));
                    }
                    if (this.options.methods[i] === 'distance') {
                        isoDistChecked = i === 0;
                        typeChoice.appendChild(this._createIsoPanelFormTypeChoiceDistElement(isoDistChecked));
                    }
                }
                form.appendChild(typeChoice);
                form.appendChild(this._createIsoPanelFormValueIsochronElement(isoChronChecked));
                form.appendChild(this._createIsoPanelFormValueIsodistanceElement(isoDistChecked));
                var modeChoice = this._createIsoPanelFormModeChoiceElement();
                modeChoice.appendChild(this._createIsoPanelFormModeChoiceTransportElement(this.options.graphs));
                modeChoice.appendChild(this._createIsoPanelFormModeChoiceDirectionElement(this.options.directions));
                form.appendChild(modeChoice);
                if (this.options.exclusions && _typeof(this.options.exclusions) === 'object' && Object.keys(this.options.exclusions).length !== 0) {
                    form.appendChild(this._createShowIsoExclusionsElement());
                    form.appendChild(this._createShowIsoExclusionsPictoElement());
                    var exclusion = this._createIsoPanelFormExclusionsElement();
                    exclusion.appendChild(this._createIsoPanelFormExclusionOptionsElement(this.options.exclusions));
                    form.appendChild(exclusion);
                }
                var divReset = this._createIsoFormResetElement();
                form.appendChild(divReset);
                var submit = this._submitContainer = this._createIsoSubmitFormElement();
                form.appendChild(submit);
                panel.appendChild(form);
                var waiting = this._waitingContainer = this._createIsoWaitingElement();
                panel.appendChild(waiting);
                container.appendChild(panel);
                var context = this;
                if (container.addEventListener) {
                    container.addEventListener('click', function (e) {
                        context._hideIsoSuggestedLocations.call(context, e);
                    });
                }
                return container;
            };
            Isocurve.prototype._createIsoPanelFormPointElement = function (map) {
                this._originPoint = new _LocationSelector2.default({
                    apiKey: this.options.apiKey || null,
                    tag: {
                        id: 1,
                        groupId: this._uid,
                        markerOpts: this.options.markerOpts,
                        label: 'Départ',
                        display: true
                    },
                    autocompleteOptions: this.options.autocompleteOptions || null
                });
                this._originPoint.setMap(map);
                var self = this;
                document.getElementById('GPlocationOriginPointerImg_1-' + this._uid).onclick = function () {
                    self._clearGeojsonLayer();
                    var map = self.getMap();
                    if (self._originPoint._inputShowPointerContainer.checked) {
                        self._formContainer.className = 'GPisochronFormMini';
                        map.on('click', function () {
                            self._formContainer.className = '';
                        });
                    } else {
                        self._formContainer.className = '';
                        map.un('click', function () {
                            self._formContainer.className = '';
                        });
                    }
                };
                document.getElementById('GPlocationOriginLabel_1-' + this._uid).onclick = function () {
                    self._clearGeojsonLayer();
                    self._formContainer.className = '';
                    map.un('click', function () {
                        self._formContainer.className = '';
                    });
                };
                document.getElementById('GPlocationOrigin_1-' + this._uid).onclick = function () {
                    self._clearGeojsonLayer();
                };
                return this._originPoint._container;
            };
            Isocurve.prototype.onIsoComputationSubmit = function () {
                if (!this._originPoint || !this._originPoint.getCoordinate || !this._originPoint.getCoordinate()) {
                    console.log('[Isocurve] Missing position parameter to submit isocurve request');
                    return;
                }
                var positionCoordinates = this._originPoint.getCoordinate();
                var position = {
                    x: positionCoordinates[0],
                    y: positionCoordinates[1]
                };
                logger.log('origin : ', position);
                var time;
                var distance;
                if (this._currentComputation.toLowerCase() === 'time') {
                    var timeHourInput = document.getElementById('GPisochronValueChronInput1-' + this._uid);
                    var hours = parseInt(timeHourInput.value, 10);
                    if (isNaN && isNaN(hours)) {
                        hours = 0;
                    }
                    var timeMinutesInput = document.getElementById('GPisochronValueChronInput2-' + this._uid);
                    var minutes = parseInt(timeMinutesInput.value, 10);
                    if (isNaN && isNaN(minutes)) {
                        minutes = 0;
                    }
                    time = hours * 3600 + minutes * 60;
                    logger.log('time : ' + time);
                }
                if (this._currentComputation.toLowerCase() === 'distance') {
                    var distInput = document.getElementById('GPisochronValueDistInput-' + this._uid);
                    distance = parseFloat(distInput.value) * 1000;
                    logger.log('distance : ' + distance);
                }
                if (!time && !distance) {
                    console.log('[Isocurve] Missing time or distance parameter to submit isocurve request');
                    return;
                }
                if (this._noRightManagement) {
                    console.log('[Isocurve] no rights for this service');
                    return;
                }
                var options = this.options.isocurveOptions || {};
                var _protocol = options.protocol || 'XHR';
                var _timeout = options.timeOut || 0;
                if (_protocol === 'JSONP' && _timeout === 0) {
                    _timeout = 15000;
                }
                var context = this;
                var isoRequestOptions = {
                    position: position,
                    graph: options.graph || this._currentTransport,
                    exclusions: options.exclusions || this._currentExclusions,
                    method: options.method || this._currentComputation,
                    smoothing: options.smoothing || true,
                    timeOut: _timeout,
                    protocol: _protocol,
                    onSuccess: function onSuccess(results) {
                        logger.log(results);
                        if (results) {
                            context._drawIsoResults(results);
                        }
                    },
                    onFailure: function onFailure(error) {
                        context._hideWaitingContainer();
                        logger.log(error.message);
                    }
                };
                if (this._currentDirection.toLowerCase() === 'arrival' || options.reverse) {
                    isoRequestOptions.reverse = true;
                }
                if (time) {
                    isoRequestOptions.time = time;
                }
                if (distance) {
                    isoRequestOptions.distance = distance;
                }
                this._requestIsoCurve(isoRequestOptions);
            };
            Isocurve.prototype.onShowIsoPanelClick = function () {
                this.collapsed = this._showIsoContainer.checked;
                this.dispatchEvent('change:collapsed');
            };
            Isocurve.prototype.onIsoTypeChoiceChange = function (e) {
                var value = e.target.value;
                if (!value) {
                    return;
                }
                if (value === 'isodistance') {
                    this._currentComputation = 'distance';
                }
                if (value === 'isochron') {
                    this._currentComputation = 'time';
                }
            };
            Isocurve.prototype.onIsoModeTransportChange = function (e) {
                var value = e.target.value;
                if (!value) {
                    return;
                }
                this._currentTransport = value;
            };
            Isocurve.prototype.onIsoModeDirectionChange = function (e) {
                var value = e.target.value;
                if (!value) {
                    return;
                }
                if (value.toLowerCase() === 'arrival') {
                    this._originPoint._inputLabelContainer.innerHTML = 'Arrivée';
                } else {
                    this._originPoint._inputLabelContainer.innerHTML = 'Départ';
                }
                this._currentDirection = value;
            };
            Isocurve.prototype.onIsoExclusionsChange = function (e) {
                var value = e.target.value;
                var checked = e.target.checked;
                if (!value) {
                    return;
                }
                var bFound = false;
                var iFound = null;
                for (var i = 0; i < this._currentExclusions.length; i++) {
                    if (this._currentExclusions[i] === value) {
                        iFound = i;
                        bFound = true;
                    }
                }
                if (!bFound && !checked) {
                    this._currentExclusions.push(value);
                }
                if (bFound && checked) {
                    this._currentExclusions[iFound] = null;
                }
            };
            Isocurve.prototype.onIsoResetClick = function () {
                this._clear();
            };
            Isocurve.prototype._requestIsoCurve = function (options) {
                if (!options || (typeof options === 'undefined' ? 'undefined' : _typeof(options)) === 'object' && Object.keys(options).length === 0) {
                    return;
                }
                if (!options.position) {
                    return;
                }
                if (this._noRightManagement || !this._resources['Isocurve']) {
                    console.log('no rights for this service');
                    return;
                }
                var resources = this._resources['Isocurve'].resources;
                if (!resources || (typeof resources === 'undefined' ? 'undefined' : _typeof(resources)) === 'object' && Object.keys(resources).length === 0) {
                    console.log('no rights for this service');
                    return;
                }
                var bFound = false;
                for (var i = 0; i < resources.length; i++) {
                    if (resources[i] === options.graph) {
                        bFound = true;
                    }
                }
                if (!bFound) {
                    console.log('no rights for this service !?');
                    return;
                }
                var key = this._resources['Isocurve']['key'];
                options.apiKey = this.options.isocurveOptions.apiKey || this.options.apiKey || key;
                logger.log(options);
                this._clearGeojsonLayer();
                this._displayWaitingContainer();
                _gp2.default.Services.isoCurve(options);
            };
            Isocurve.prototype._drawIsoResults = function (results) {
                this._currentIsoResults = results;
                this._hideWaitingContainer();
                if (!results.geometry) {
                    return;
                }
                var map = this.getMap();
                var geojsonObject = {
                    type: 'Feature',
                    crs: {
                        type: 'name',
                        properties: { name: 'EPSG:4326' }
                    },
                    geometry: results.geometry
                };
                var geojsonformat = new _ol2.default.format.GeoJSON({ defaultDataProjection: 'EPSG:4326' });
                var mapProj = map.getView().getProjection().getCode();
                var features = geojsonformat.readFeatures(geojsonObject, {
                    dataProjection: 'EPSG:4326',
                    featureProjection: mapProj
                });
                this._geojsonLayer = new _ol2.default.layer.Vector({
                    source: new _ol2.default.source.Vector({ features: features }),
                    style: this._defaultFeatureStyle,
                    opacity: 0.9
                });
                var graph;
                if (this._currentTransport === 'Pieton') {
                    graph = 'piéton';
                    this._geojsonLayer.gpResultLayerId = 'Pieton$GEOPORTAIL:GPP:Isocurve';
                } else {
                    graph = 'voiture';
                    this._geojsonLayer.gpResultLayerId = 'Voiture$GEOPORTAIL:GPP:Isocurve';
                }
                map.addLayer(this._geojsonLayer);
                if (features[0] && features[0].getGeometry() && features[0].getGeometry().getExtent()) {
                    var extent = features[0].getGeometry().getExtent();
                    map.getView().fit(extent, map.getSize());
                }
                var method = this._currentComputation === 'time' ? 'Isochrone' : 'Isodistance';
                map.getControls().forEach(function (control) {
                    if (control instanceof _LayerSwitcher2.default) {
                        var layerId = this._geojsonLayer.gpLayerId;
                        if (control._layers[layerId].title === layerId) {
                            control.addLayer(this._geojsonLayer, {
                                title: method + ' ' + graph,
                                description: method + ' basé sur un graphe ' + graph
                            });
                        }
                    }
                }, this);
            };
            Isocurve.prototype._clear = function () {
                this._clearIsoInputs();
                this._originPoint.clear();
                this._clearGeojsonLayer();
                this._currentIsoResults = null;
            };
            Isocurve.prototype._clearIsoInputs = function () {
                var timeHourInput = document.getElementById('GPisochronValueChronInput1-' + this._uid);
                if (timeHourInput) {
                    timeHourInput.value = '0';
                }
                var timeMinutesInput = document.getElementById('GPisochronValueChronInput2-' + this._uid);
                if (timeMinutesInput) {
                    timeMinutesInput.value = '0';
                }
                var distInput = document.getElementById('GPisochronValueDistInput-' + this._uid);
                if (distInput) {
                    distInput.value = '0';
                }
                this._initTransport();
                this._initComputation();
                this._initDirection();
                this._initExclusions();
                var transportdiv;
                if (this._currentTransport === 'Pieton') {
                    transportdiv = document.getElementById('GPisochronTransportPedestrian-' + this._uid);
                    if (transportdiv) {
                        transportdiv.checked = 'true';
                    }
                } else {
                    transportdiv = document.getElementById('GPisochronTransportCar-' + this._uid);
                    if (transportdiv) {
                        transportdiv.checked = 'true';
                    }
                }
                var computationdiv;
                if (this._currentComputation.toLowerCase() === 'distance') {
                    computationdiv = document.getElementById('GPisochronChoiceAltDist-' + this._uid);
                    if (computationdiv) {
                        computationdiv.checked = 'true';
                    }
                    if (document.getElementById('GPisochronValueDist-' + this._uid)) {
                        document.getElementById('GPisochronValueDist-' + this._uid).className = 'GPflexInput';
                    }
                    if (document.getElementById('GPisochronValueChron-' + this._uid)) {
                        document.getElementById('GPisochronValueChron-' + this._uid).className = 'GPisochronValueHidden';
                    }
                } else {
                    computationdiv = document.getElementById('GPisochronChoiceAltChron-' + this._uid);
                    if (computationdiv) {
                        computationdiv.checked = 'true';
                    }
                    if (document.getElementById('GPisochronValueChron-' + this._uid)) {
                        document.getElementById('GPisochronValueChron-' + this._uid).className = 'GPflexInput';
                    }
                    if (document.getElementById('GPisochronValueDist-' + this._uid)) {
                        document.getElementById('GPisochronValueDist-' + this._uid).className = 'GPisochronValueHidden';
                    }
                }
                var directionSelect = document.getElementById('GPisochronDirectionSelect-' + this._uid);
                if (directionSelect) {
                    directionSelect.value = this._currentDirection;
                }
                if (this._currentDirection === 'arrival') {
                    this._originPoint._inputLabelContainer.innerHTML = 'Arrivée';
                } else {
                    this._originPoint._inputLabelContainer.innerHTML = 'Départ';
                }
                var tollInput = document.getElementById('GPisoExclusionsToll-' + this._uid);
                if (tollInput) {
                    if (this._currentExclusions.indexOf('toll') !== -1) {
                        tollInput.checked = false;
                    } else {
                        tollInput.checked = true;
                    }
                }
                var tunnelInput = document.getElementById('GPisoExclusionsTunnel-' + this._uid);
                if (tunnelInput) {
                    if (this._currentExclusions.indexOf('tunnel') !== -1) {
                        tunnelInput.checked = false;
                    } else {
                        tunnelInput.checked = true;
                    }
                }
                var bridgeInput = document.getElementById('GPisoExclusionsBridge-' + this._uid);
                if (bridgeInput) {
                    if (this._currentExclusions.indexOf('bridge') !== -1 && bridgeInput) {
                        bridgeInput.checked = false;
                    } else {
                        bridgeInput.checked = true;
                    }
                }
            };
            Isocurve.prototype._clearGeojsonLayer = function () {
                var map = this.getMap();
                if (this._geojsonLayer) {
                    map.removeLayer(this._geojsonLayer);
                    this._geojsonLayer = null;
                }
            };
            Isocurve.prototype._hideIsoSuggestedLocations = function (e) {
                if (e.target && e.target.id && e.target.id.indexOf('GPlocationOrigin_') !== -1) {
                } else {
                    this._originPoint._hideSuggestedLocation();
                }
            };
            Isocurve.prototype._displayWaitingContainer = function () {
                this._waitingContainer.className = 'GPisochronCalcWaitingContainerVisible';
                this._waiting = true;
                var opts = this.options.isocurveOptions;
                if (opts && opts.timeOut) {
                    if (this._timer) {
                        clearTimeout(this._timer);
                        this._timer = null;
                    }
                    var context = this;
                    this._timer = setTimeout(function () {
                        if (context._waiting === true) {
                            context._hideWaitingContainer();
                        } else {
                            if (context._timer) {
                                clearTimeout(context._timer);
                            }
                        }
                    }, 16000);
                }
            };
            Isocurve.prototype._hideWaitingContainer = function () {
                if (this._waiting) {
                    this._waitingContainer.className = 'GPisochronCalcWaitingContainerHidden';
                    this._waiting = false;
                    var opts = this.options.isocurveOptions;
                    if (opts && opts.timeOut) {
                        clearTimeout(this._timer);
                        this._timer = null;
                    }
                }
            };
            exports.default = Isocurve;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var IsoDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPisochron');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowIsoElement: function _createShowIsoElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowIsochron');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowIsoPictoElement: function _createShowIsoPictoElement() {
                    var context = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowIsochronPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowIsochron');
                    label.title = 'Calculer une isochrone';
                    if (label.addEventListener) {
                        label.addEventListener('click', function (e) {
                            context.onShowIsoPanelClick(e);
                        });
                    } else if (label.attachEvent) {
                        label.attachEvent('onclick', function (e) {
                            context.onShowIsoPanelClick(e);
                        });
                    }
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowIsochronOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                },
                _createIsoPanelElement: function _createIsoPanelElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPisochronPanel');
                    div.className = 'GPpanel';
                    return div;
                },
                _createIsoPanelHeaderElement: function _createIsoPanelHeaderElement() {
                    var self = this;
                    var container = document.createElement('div');
                    container.className = 'GPpanelHeader';
                    var div = document.createElement('div');
                    div.className = 'GPpanelTitle';
                    div.innerHTML = 'Calcul d\'isochrone';
                    container.appendChild(div);
                    var divClose = document.createElement('div');
                    divClose.id = this._addUID('GPisochronPanelClose');
                    divClose.className = 'GPpanelClose';
                    divClose.title = 'Fermer le panneau';
                    if (divClose.addEventListener) {
                        divClose.addEventListener('click', function () {
                            document.getElementById(self._addUID('GPshowIsochronPicto')).click();
                        }, false);
                    } else if (divClose.attachEvent) {
                        divClose.attachEvent('onclick', function () {
                            document.getElementById(self._addUID('GPshowIsochronPicto')).click();
                        });
                    }
                    container.appendChild(divClose);
                    return container;
                },
                _createIsoPanelFormElement: function _createIsoPanelFormElement() {
                    var self = this;
                    var form = document.createElement('form');
                    form.id = this._addUID('GPisochronForm');
                    form.addEventListener('submit', function (e) {
                        e.preventDefault();
                        self.onIsoComputationSubmit(e);
                        return false;
                    });
                    return form;
                },
                _createIsoWaitingElement: function _createIsoWaitingElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPisochronCalcWaitingContainer');
                    div.className = 'GPisochronCalcWaitingContainerHidden';
                    var p = document.createElement('p');
                    p.className = 'GPisochronCalcWaiting';
                    p.innerHTML = 'Calcul en cours...';
                    div.appendChild(p);
                    return div;
                },
                _createIsoPanelFormTypeChoiceElement: function _createIsoPanelFormTypeChoiceElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPisochronChoice');
                    return div;
                },
                _createIsoPanelFormTypeChoiceChronElement: function _createIsoPanelFormTypeChoiceChronElement(checked) {
                    var self = this;
                    var div = document.createElement('div');
                    div.className = 'GPisochronChoiceAlt';
                    var input = document.createElement('input');
                    input.id = this._addUID('GPisochronChoiceAltChron');
                    input.name = 'GPisochronChoiceMode';
                    input.type = 'radio';
                    input.checked = !!checked;
                    if (input.addEventListener) {
                        input.addEventListener('change', function (e) {
                            document.getElementById(self._addUID('GPisochronValueChron')).className = 'GPflexInput';
                            document.getElementById(self._addUID('GPisochronValueDist')).className = 'GPisochronValueHidden';
                            self.onIsoTypeChoiceChange(e);
                        }, false);
                    } else if (input.attachEvent) {
                        input.attachEvent('onchange', function () {
                            document.getElementById(self._addUID('GPisochronValueChron')).className = 'GPflexInput';
                            document.getElementById(self._addUID('GPisochronValueDist')).className = 'GPisochronValueHidden';
                            self.onIsoTypeChoiceChange();
                        });
                    }
                    input.value = 'isochron';
                    div.appendChild(input);
                    var label = document.createElement('label');
                    label.className = 'GPisochronChoiceAltImg';
                    label.htmlFor = this._addUID('GPisochronChoiceAltChron');
                    div.appendChild(label);
                    var span = document.createElement('span');
                    span.id = this._addUID('GPisochronChoiceAltChronTxt');
                    span.innerHTML = 'isochrone';
                    if (span.addEventListener) {
                        span.addEventListener('click', function () {
                            document.getElementById(self._addUID('GPisochronChoiceAltChron')).click();
                        }, false);
                    } else if (span.attachEvent) {
                        span.attachEvent('onclick', function () {
                            document.getElementById(self._addUID('GPisochronChoiceAltChron')).click();
                        });
                    }
                    div.appendChild(span);
                    return div;
                },
                _createIsoPanelFormTypeChoiceDistElement: function _createIsoPanelFormTypeChoiceDistElement(checked) {
                    var self = this;
                    var div = document.createElement('div');
                    div.className = 'GPisochronChoiceAlt';
                    var input = document.createElement('input');
                    input.id = this._addUID('GPisochronChoiceAltDist');
                    input.name = 'GPisochronChoiceMode';
                    input.type = 'radio';
                    input.checked = !!checked;
                    if (input.addEventListener) {
                        input.addEventListener('change', function (e) {
                            document.getElementById(self._addUID('GPisochronValueDist')).className = 'GPflexInput';
                            document.getElementById(self._addUID('GPisochronValueChron')).className = 'GPisochronValueHidden';
                            self.onIsoTypeChoiceChange(e);
                        }, false);
                    } else if (input.attachEvent) {
                        input.attachEvent('onchange', function () {
                            document.getElementById(self._addUID('GPisochronValueDist')).className = 'GPflexInput';
                            document.getElementById(self._addUID('GPisochronValueChron')).className = 'GPisochronValueHidden';
                            self.onIsoTypeChoiceChange();
                        });
                    }
                    input.value = 'isodistance';
                    div.appendChild(input);
                    var label = document.createElement('label');
                    label.className = 'GPisochronChoiceAltImg';
                    label.htmlFor = this._addUID('GPisochronChoiceAltDist');
                    div.appendChild(label);
                    var span = document.createElement('span');
                    span.id = this._addUID('GPisochronChoiceAltDistTxt');
                    span.innerHTML = 'isodistance';
                    if (span.addEventListener) {
                        span.addEventListener('click', function () {
                            document.getElementById(self._addUID('GPisochronChoiceAltDist')).click();
                        }, false);
                    } else if (span.attachEvent) {
                        span.attachEvent('onclick', function () {
                            document.getElementById(self._addUID('GPisochronChoiceAltDist')).click();
                        });
                    }
                    div.appendChild(span);
                    return div;
                },
                _createIsoPanelFormValueIsochronElement: function _createIsoPanelFormValueIsochronElement(checked) {
                    var context = this;
                    var div = document.createElement('div');
                    div.id = this._addUID('GPisochronValueChron');
                    div.className = checked ? 'GPflexInput' : 'GPisochronValueHidden';
                    var label = document.createElement('label');
                    label.id = this._addUID('GPisochronValueChronLabel');
                    label.htmlFor = this._addUID('GPisochronValueChronInput');
                    label.innerHTML = 'Temps';
                    div.appendChild(label);
                    var input1 = document.createElement('input');
                    input1.id = this._addUID('GPisochronValueChronInput1');
                    input1.min = '0';
                    input1.step = '1';
                    input1.value = '0';
                    input1.type = 'number';
                    if (input1.addEventListener) {
                        input1.addEventListener('change', function (e) {
                            if (typeof context.onIsoValueChronTimeMinuteChange === 'function') {
                                context.onIsoValueChronTimeHourChange(e);
                            }
                        });
                    } else if (input1.attachEvent) {
                        input1.attachEvent('onchange', function (e) {
                            if (typeof context.onIsoValueChronTimeMinuteChange === 'function') {
                                context.onIsoValueChronTimeHourChange(e);
                            }
                        });
                    }
                    div.appendChild(input1);
                    var label1 = document.createElement('label');
                    label1.innerHTML = 'h';
                    div.appendChild(label1);
                    var input2 = document.createElement('input');
                    input2.id = this._addUID('GPisochronValueChronInput2');
                    input2.min = '0';
                    input2.max = '59';
                    input2.step = '1';
                    input2.value = '0';
                    input2.type = 'number';
                    if (input2.addEventListener) {
                        input2.addEventListener('change', function (e) {
                            if (typeof context.onIsoValueChronTimeMinuteChange === 'function') {
                                context.onIsoValueChronTimeMinuteChange(e);
                            }
                        });
                    } else if (input2.attachEvent) {
                        input2.attachEvent('onchange', function (e) {
                            if (typeof context.onIsoValueChronTimeMinuteChange === 'function') {
                                context.onIsoValueChronTimeMinuteChange(e);
                            }
                        });
                    }
                    div.appendChild(input2);
                    var label2 = document.createElement('label');
                    label2.innerHTML = 'min';
                    div.appendChild(label2);
                    return div;
                },
                _createIsoPanelFormValueIsodistanceElement: function _createIsoPanelFormValueIsodistanceElement(checked) {
                    var context = this;
                    var div = document.createElement('div');
                    div.id = this._addUID('GPisochronValueDist');
                    div.className = checked ? 'GPflexInput' : 'GPisochronValueHidden';
                    var label = document.createElement('label');
                    label.id = this._addUID('GPisochronValueDistLabel');
                    label.htmlFor = this._addUID('GPisochronValueDistInput');
                    label.innerHTML = 'Distance';
                    div.appendChild(label);
                    var input1 = document.createElement('input');
                    input1.id = this._addUID('GPisochronValueDistInput');
                    input1.min = '0';
                    input1.step = 'any';
                    input1.value = '0';
                    input1.type = 'number';
                    if (input1.addEventListener) {
                        input1.addEventListener('change', function (e) {
                            if (typeof context.onIsoValueDistChange === 'function') {
                                context.onIsoValueDistChange(e);
                            }
                        });
                    } else if (input1.attachEvent) {
                        input1.attachEvent('onchange', function (e) {
                            if (typeof context.onIsoValueDistChange === 'function') {
                                context.onIsoValueDistChange(e);
                            }
                        });
                    }
                    div.appendChild(input1);
                    var label1 = document.createElement('label');
                    label1.innerHTML = 'km';
                    div.appendChild(label1);
                    return div;
                },
                _createIsoPanelFormModeChoiceElement: function _createIsoPanelFormModeChoiceElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPisochronModeChoice');
                    return div;
                },
                _createIsoPanelFormModeChoiceTransportElement: function _createIsoPanelFormModeChoiceTransportElement(transports) {
                    var context = this;
                    var div = document.createElement('div');
                    div.id = this._addUID('GPisochronTransportChoice');
                    var span = document.createElement('span');
                    span.className = 'GPisochronModeLabel';
                    span.innerHTML = 'Mode de transport';
                    div.appendChild(span);
                    for (var i = 0; i < transports.length; i++) {
                        var transport = transports[i];
                        if (transport === 'Voiture') {
                            var inputCar = document.createElement('input');
                            inputCar.id = this._addUID('GPisochronTransportCar');
                            inputCar.type = 'radio';
                            inputCar.name = 'GPisochronTransport';
                            if (i === 0) {
                                inputCar.checked = true;
                            }
                            if (inputCar.addEventListener) {
                                inputCar.addEventListener('change', function (e) {
                                    context.onIsoModeTransportChange(e);
                                });
                            } else if (inputCar.attachEvent) {
                                inputCar.attachEvent('onchange', function (e) {
                                    context.onIsoModeTransportChange(e);
                                });
                            }
                            inputCar.value = 'Voiture';
                            div.appendChild(inputCar);
                            var labelCar = document.createElement('label');
                            labelCar.className = 'GPisochronTransportImg';
                            labelCar.htmlFor = this._addUID('GPisochronTransportCar');
                            labelCar.title = 'Voiture';
                            div.appendChild(labelCar);
                        }
                        if (transport === 'Pieton') {
                            var inputPedestrian = document.createElement('input');
                            inputPedestrian.id = this._addUID('GPisochronTransportPedestrian');
                            inputPedestrian.type = 'radio';
                            inputPedestrian.name = 'GPisochronTransport';
                            if (i === 0) {
                                inputPedestrian.checked = true;
                            }
                            if (inputPedestrian.addEventListener) {
                                inputPedestrian.addEventListener('change', function (e) {
                                    context.onIsoModeTransportChange(e);
                                });
                            } else if (inputPedestrian.attachEvent) {
                                inputPedestrian.attachEvent('onchange', function (e) {
                                    context.onIsoModeTransportChange(e);
                                });
                            }
                            inputPedestrian.value = 'Pieton';
                            div.appendChild(inputPedestrian);
                            var labelPedestrian = document.createElement('label');
                            labelPedestrian.className = 'GPisochronTransportImg';
                            labelPedestrian.htmlFor = this._addUID('GPisochronTransportPedestrian');
                            labelPedestrian.title = 'Piéton';
                            div.appendChild(labelPedestrian);
                        }
                    }
                    return div;
                },
                _createIsoPanelFormModeChoiceDirectionElement: function _createIsoPanelFormModeChoiceDirectionElement(directions) {
                    var self = this;
                    var div = document.createElement('div');
                    div.id = this._addUID('GPisochronDirectionChoice');
                    var span = document.createElement('span');
                    span.className = 'GPisochronModeLabel';
                    span.innerHTML = 'Sens de parcours';
                    div.appendChild(span);
                    var select = document.createElement('select');
                    select.id = this._addUID('GPisochronDirectionSelect');
                    select.className = 'GPinputSelect';
                    select.addEventListener('change', function (e) {
                        self.onIsoModeDirectionChange(e);
                    });
                    for (var i = 0; i < directions.length; i++) {
                        var direction = directions[i];
                        if (direction.toLowerCase() === 'departure') {
                            var departureOption = document.createElement('option');
                            if (i === 0) {
                                departureOption.selected = 'selected';
                            }
                            departureOption.value = 'departure';
                            departureOption.text = 'Départ';
                            select.appendChild(departureOption);
                        }
                        if (direction.toLowerCase() === 'arrival') {
                            var arrivalOption = document.createElement('option');
                            if (i === 0) {
                                arrivalOption.selected = 'selected';
                            }
                            arrivalOption.value = 'arrival';
                            arrivalOption.text = 'Arrivée';
                            select.appendChild(arrivalOption);
                        }
                    }
                    div.appendChild(select);
                    return div;
                },
                _createShowIsoExclusionsElement: function _createShowIsoExclusionsElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowIsoExclusions');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowIsoExclusionsPictoElement: function _createShowIsoExclusionsPictoElement() {
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowIsoExclusionsPicto');
                    label.className = 'GPshowMoreOptions GPshowIsoExclusionsPicto';
                    label.htmlFor = this._addUID('GPshowIsoExclusions');
                    label.title = 'Exclusions';
                    label.style.top = '240px';
                    return label;
                },
                _createIsoPanelFormExclusionsElement: function _createIsoPanelFormExclusionsElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPisoExclusions');
                    var span = document.createElement('span');
                    span.className = 'GPisoExclusionsLabel';
                    span.innerHTML = 'Passages autorisés';
                    div.appendChild(span);
                    return div;
                },
                _createIsoPanelFormExclusionOptionsElement: function _createIsoPanelFormExclusionOptionsElement(exclusions) {
                    var context = this;
                    var div = document.createElement('div');
                    div.className = 'GPisoExclusionsOptions';
                    for (var value in exclusions) {
                        if (exclusions.hasOwnProperty(value)) {
                            var status = exclusions[value];
                            switch (value) {
                            case 'toll':
                                var inputToll = document.createElement('input');
                                inputToll.id = this._addUID('GPisoExclusionsToll');
                                inputToll.type = 'checkbox';
                                inputToll.checked = !status;
                                if (inputToll.addEventListener) {
                                    inputToll.addEventListener('change', function (e) {
                                        context.onIsoExclusionsChange(e);
                                    });
                                } else if (inputToll.attachEvent) {
                                    inputToll.attachEvent('onchange', function (e) {
                                        context.onIsoExclusionsChange(e);
                                    });
                                }
                                inputToll.value = 'Toll';
                                div.appendChild(inputToll);
                                var labelToll = document.createElement('label');
                                labelToll.className = 'GPisoExclusionsOption';
                                labelToll.htmlFor = this._addUID('GPisoExclusionsToll');
                                labelToll.innerHTML = 'Péages';
                                div.appendChild(labelToll);
                                break;
                            case 'tunnel':
                                var inputTunnel = document.createElement('input');
                                inputTunnel.id = this._addUID('GPisoExclusionsTunnel');
                                inputTunnel.type = 'checkbox';
                                inputTunnel.checked = !status;
                                if (inputTunnel.addEventListener) {
                                    inputTunnel.addEventListener('change', function (e) {
                                        context.onIsoExclusionsChange(e);
                                    });
                                } else if (inputTunnel.attachEvent) {
                                    inputTunnel.attachEvent('onchange', function (e) {
                                        context.onIsoExclusionsChange(e);
                                    });
                                }
                                inputTunnel.value = 'Tunnel';
                                div.appendChild(inputTunnel);
                                var labelTunnel = document.createElement('label');
                                labelTunnel.className = 'GPisoExclusionsOption';
                                labelTunnel.htmlFor = this._addUID('GPisoExclusionsTunnel');
                                labelTunnel.innerHTML = 'Tunnels';
                                div.appendChild(labelTunnel);
                                break;
                            case 'bridge':
                                var inputBridge = document.createElement('input');
                                inputBridge.id = this._addUID('GPisoExclusionsBridge');
                                inputBridge.type = 'checkbox';
                                inputBridge.checked = !status;
                                if (inputBridge.addEventListener) {
                                    inputBridge.addEventListener('change', function (e) {
                                        context.onIsoExclusionsChange(e);
                                    });
                                } else if (inputBridge.attachEvent) {
                                    inputBridge.attachEvent('onchange', function (e) {
                                        context.onIsoExclusionsChange(e);
                                    });
                                }
                                inputBridge.value = 'Bridge';
                                div.appendChild(inputBridge);
                                var labelBridge = document.createElement('label');
                                labelBridge.className = 'GPisoExclusionsOption';
                                labelBridge.htmlFor = this._addUID('GPisoExclusionsBridge');
                                labelBridge.innerHTML = 'Ponts';
                                div.appendChild(labelBridge);
                                break;
                            }
                        }
                    }
                    return div;
                },
                _createIsoSubmitFormElement: function _createIsoSubmitFormElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPisochronSubmit');
                    input.className = 'GPinputSubmit';
                    input.type = 'submit';
                    input.value = 'Calculer';
                    return input;
                },
                _createIsoFormResetElement: function _createIsoFormResetElement() {
                    var self = this;
                    var divReset = document.createElement('div');
                    divReset.id = this._addUID('GPisochronReset');
                    divReset.title = 'Réinitialiser les paramètres';
                    divReset.addEventListener('click', function (e) {
                        self.onIsoResetClick(e);
                    });
                    return divReset;
                }
            };
            exports.default = IsoDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _Markers = __webpack_require__(7);
            var _Markers2 = _interopRequireDefault(_Markers);
            var _LayerSwitcher = __webpack_require__(12);
            var _LayerSwitcher2 = _interopRequireDefault(_LayerSwitcher);
            var _CheckRightManagement = __webpack_require__(6);
            var _CheckRightManagement2 = _interopRequireDefault(_CheckRightManagement);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _ReverseGeocodingDOM = __webpack_require__(104);
            var _ReverseGeocodingDOM2 = _interopRequireDefault(_ReverseGeocodingDOM);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('reversegeocoding');
            function ReverseGeocode(options) {
                options = options || {};
                if (!(this instanceof ReverseGeocode)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this.initialize(options);
                this._container = this._initContainer();
                this._containerElement = null;
                if (options.element && options.element.appendChild) {
                    options.element.appendChild(this._container);
                    this._containerElement = options.element;
                }
                _ol2.default.control.Control.call(this, {
                    element: this._containerElement || this._container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(ReverseGeocode, _ol2.default.control.Control);
            ReverseGeocode.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(ReverseGeocode.prototype, _ReverseGeocodingDOM2.default);
            ReverseGeocode.prototype.constructor = ReverseGeocode;
            ReverseGeocode.prototype.getCollapsed = function () {
                return this.collapsed;
            };
            ReverseGeocode.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] ReverseGeocode:setCollapsed - missing collapsed parameter');
                    return;
                }
                if (collapsed && this.collapsed || !collapsed && !this.collapsed) {
                    return;
                }
                if (collapsed) {
                    document.getElementById('GPreverseGeocodingPanelClose-' + this._uid).click();
                } else {
                    document.getElementById('GPshowReverseGeocoding-' + this._uid).click();
                }
                this.collapsed = collapsed;
            };
            ReverseGeocode.prototype.setMap = function (map) {
                if (map) {
                    this._activateMapInteraction(map);
                } else {
                    var _map = this.getMap();
                    this._clearResults();
                    this._clearInputFeatures();
                    this._removeMapInteraction(_map);
                    if (this._inputFeaturesLayer != null) {
                        _map.removeLayer(this._inputFeaturesLayer);
                        this._inputFeaturesLayer = null;
                        this._inputFeaturesSources = null;
                        this._inputFeatures = null;
                    }
                }
                _ol2.default.control.Control.prototype.setMap.call(this, map);
            };
            ReverseGeocode.prototype.initialize = function (options) {
                this._checkInputOptions(options);
                this.options = {
                    collapsed: true,
                    resources: [
                        'StreetAddress',
                        'PositionOfInterest',
                        'CadastralParcel'
                    ],
                    delimitations: [
                        'Point',
                        'Circle',
                        'Extent'
                    ],
                    reverseGeocodeOptions: {}
                };
                _Utils2.default.assign(this.options, options);
                this.collapsed = this.options.collapsed;
                this._uid = _SelectorID2.default.generate();
                this._servicesRightManagement = {};
                this._noRightManagement = false;
                this._checkRightsManagement();
                this._currentGeocodingType = null;
                this._initGeocodingType();
                this._currentGeocodingDelimitation = null;
                this._initGeocodingDelimitation();
                this._showReverseGeocodingInput = null;
                this._panelHeaderContainer = null;
                this._panelTitleContainer = null;
                this._returnPictoContainer = null;
                this._formContainer = null;
                this._resultsContainer = null;
                this._resultsListContainer = null;
                this._waitingContainer = null;
                this._inputFeatures = null;
                this._inputFeaturesSource = null;
                this._inputFeaturesLayer = null;
                this._mapInteraction = null;
                this._requestOptions = null;
                this._requestPosition = null;
                this._requestCircleFilter = null;
                this._requestBboxFilter = null;
                this._waiting = false;
                this._timer = null;
                this._reverseGeocodingLocations = [];
                this._reverseGeocodingLocationsMarkers = [];
                this._resultsDefaultStyle = new _ol2.default.style.Style({
                    image: new _ol2.default.style.Icon({
                        src: _Markers2.default['lightOrange'],
                        anchor: [
                            0.5,
                            1
                        ]
                    })
                });
                this._resultsSelectedStyle = new _ol2.default.style.Style({
                    image: new _ol2.default.style.Icon({
                        src: _Markers2.default['red'],
                        anchor: [
                            0.5,
                            1
                        ]
                    })
                });
                this._resultsHoverInteraction = null;
                this._resultsSelectInteraction = null;
                this._popupContent = null;
                this._popupDiv = this._initPopupDiv();
                this._popupOverlay = null;
            };
            ReverseGeocode.prototype._checkInputOptions = function (options) {
                var i;
                var j;
                if (options.resources) {
                    var resources = options.resources;
                    if (!Array.isArray(resources)) {
                        console.log('[ReverseGeocode] \'options.resources\' parameter should be an array');
                        resources = null;
                    }
                    var resourcesList = [
                        'StreetAddress',
                        'PositionOfInterest',
                        'CadastralParcel',
                        'Administratif'
                    ];
                    var wrongResourcesIndexes = [];
                    for (i = 0; i < resources.length; i++) {
                        if (resourcesList.indexOf(resources[i]) === -1) {
                            wrongResourcesIndexes.push(i);
                            console.log('[ReverseGeocode] options.resources : ' + resources[i] + ' is not a resource for reverse geocode');
                        }
                    }
                    if (wrongResourcesIndexes.length !== 0) {
                        for (j = 0; j < wrongResourcesIndexes.length; j++) {
                            resources.splice(wrongResourcesIndexes[j], 1);
                        }
                    }
                }
                if (options.delimitations) {
                    var delimitations = options.delimitations;
                    if (!Array.isArray(delimitations)) {
                        console.log('[ReverseGeocode] \'options.delimitations\' parameter should be an array');
                        delimitations = null;
                    }
                    var delimitationsList = [
                        'Circle',
                        'Point',
                        'Extent'
                    ];
                    var wrongDelimitationsIndexes = [];
                    for (i = 0; i < delimitations.length; i++) {
                        if (delimitationsList.indexOf(delimitations[i]) === -1) {
                            wrongDelimitationsIndexes.push(i);
                            console.log('[ReverseGeocode] options.delimitations : ' + delimitations[i] + ' is not a delimitation for reverse geocode');
                        }
                    }
                    if (wrongDelimitationsIndexes.length !== 0) {
                        for (j = 0; j < wrongDelimitationsIndexes.length; j++) {
                            delimitations.splice(wrongDelimitationsIndexes[j], 1);
                        }
                    }
                }
            };
            ReverseGeocode.prototype._initGeocodingType = function () {
                this._currentGeocodingType = 'StreetAddress';
                var resources = this.options.resources;
                if (!resources || resources.length === 0) {
                    this.options.resources = [
                        'StreetAddress',
                        'PositionOfInterest',
                        'CadastralParcel'
                    ];
                }
                if (Array.isArray(resources) && resources.length) {
                    var noRightsIndexes = [];
                    for (var i = 0; i < resources.length; i++) {
                        if (this._servicesRightManagement['Geocode'].indexOf(resources[i]) < 0) {
                            noRightsIndexes.push(i);
                            console.log('[ReverseGeocode] no rights for options.resources : ' + resources[i]);
                        }
                    }
                    if (noRightsIndexes.length !== 0) {
                        for (var j = 0; j < noRightsIndexes.length; j++) {
                            resources.splice(noRightsIndexes[j], 1);
                        }
                    }
                    if (resources[0] === 'StreetAddress' || resources[0] === 'PositionOfInterest' || resources[0] === 'CadastralParcel' || resources[0] === 'Administratif') {
                        this._currentGeocodingType = resources[0];
                    }
                }
                var serviceOptions = this.options.reverseGeocodeOptions;
                if (serviceOptions.filterOptions && Array.isArray(serviceOptions.filterOptions.type) && serviceOptions.filterOptions.type.length !== 0) {
                    this._currentGeocodingType = serviceOptions.filterOptions.type[0];
                }
            };
            ReverseGeocode.prototype._initGeocodingDelimitation = function () {
                this._currentGeocodingDelimitation = 'Point';
                var delimitations = this.options.delimitations;
                if (!delimitations || delimitations.length === 0) {
                    this.options.delimitations = [
                        'Point',
                        'Circle',
                        'Extent'
                    ];
                }
                if (Array.isArray(delimitations) && delimitations.length) {
                    var d = delimitations[0].toLowerCase();
                    if (d === 'point' || d === 'circle' || d === 'extent') {
                        this._currentGeocodingDelimitation = delimitations[0];
                    }
                }
            };
            ReverseGeocode.prototype._initPopupDiv = function () {
                var context = this;
                var element = document.createElement('div');
                element.className = 'gp-feature-info-div';
                var closer = document.createElement('input');
                closer.type = 'button';
                closer.className = 'gp-styling-button closer';
                closer.onclick = function () {
                    if (context._popupOverlay != null) {
                        context._popupOverlay.setPosition(undefined);
                    }
                    return false;
                };
                this._popupContent = document.createElement('div');
                this._popupContent.className = 'gp-features-content-div';
                element.appendChild(this._popupContent);
                element.appendChild(closer);
                return element;
            };
            ReverseGeocode.prototype._checkRightsManagement = function () {
                var _resources = [];
                var _key;
                var _opts = null;
                _key = this.options.reverseGeocodeOptions.apiKey;
                _opts = this.options.reverseGeocodeOptions.filterOptions;
                _resources = _opts ? _opts.type : [];
                if (!_resources || _resources.length === 0) {
                    _resources = this.options.resources;
                }
                if (!_resources || _resources.length === 0) {
                    _resources = [
                        'StreetAddress',
                        'PositionOfInterest'
                    ];
                }
                var rightManagementGeocode = _CheckRightManagement2.default.check({
                    key: _key || this.options.apiKey,
                    resources: _resources,
                    services: ['Geocode']
                });
                logger.log('rightManagementGeocode', rightManagementGeocode);
                if (!rightManagementGeocode) {
                    this._noRightManagement = true;
                    return;
                }
                if (!this.options.apiKey) {
                    this.options.apiKey = rightManagementGeocode.key;
                }
                if (rightManagementGeocode) {
                    this._servicesRightManagement['Geocode'] = rightManagementGeocode['Geocode'];
                }
            };
            ReverseGeocode.prototype._initContainer = function () {
                var container = this._createMainContainerElement();
                var inputShow = this._showReverseGeocodingInput = this._createShowReverseGeocodingElement();
                container.appendChild(inputShow);
                if (!this.collapsed) {
                    inputShow.checked = true;
                }
                var picto = this._createShowReverseGeocodingPictoElement();
                container.appendChild(picto);
                var reverseGeocodingPanel = this._createReverseGeocodingPanelElement();
                var panelHeader = this._panelHeaderContainer = this._createReverseGeocodingPanelHeaderElement();
                var returnPicto = this._returnPictoContainer = this._createReverseGeocodingPanelReturnPictoElement();
                panelHeader.appendChild(returnPicto);
                var panelTitle = this._panelTitleContainer = this._createReverseGeocodingPanelTitleElement();
                panelHeader.appendChild(panelTitle);
                var closeDiv = this._createReverseGeocodingPanelCloseElement();
                panelHeader.appendChild(closeDiv);
                reverseGeocodingPanel.appendChild(panelHeader);
                var reverseGeocodingForm = this._formContainer = this._createReverseGeocodingPanelFormElement();
                reverseGeocodingForm.appendChild(this._createReverseGeocodingFormModeChoiceGeocodingTypeElement(this.options.resources));
                reverseGeocodingForm.appendChild(this._createReverseGeocodingFormModeChoiceGeocodingDelimitationElement(this.options.delimitations));
                var submit = this._createReverseGeocodingSubmitFormElement();
                reverseGeocodingForm.appendChild(submit);
                reverseGeocodingPanel.appendChild(reverseGeocodingForm);
                var waiting = this._waitingContainer = this._createReverseGeocodingWaitingElement();
                reverseGeocodingPanel.appendChild(waiting);
                var resultsPanel = this._resultsContainer = this._createReverseGeocodingResultsPanelElement();
                var reverseGeocodingResultsList = this._resultsListContainer = this._createReverseGeocodingResultsListElement();
                resultsPanel.appendChild(reverseGeocodingResultsList);
                reverseGeocodingPanel.appendChild(resultsPanel);
                container.appendChild(reverseGeocodingPanel);
                logger.log(container);
                return container;
            };
            ReverseGeocode.prototype._activateMapInteraction = function (map) {
                if (!this.collapsed) {
                    if (this._inputFeaturesLayer == null) {
                        this._inputFeatures = new _ol2.default.Collection();
                        this._inputFeaturesSource = new _ol2.default.source.Vector({ features: this._inputFeatures });
                        this._inputFeaturesLayer = new _ol2.default.layer.Vector({
                            source: this._inputFeaturesSource,
                            style: new _ol2.default.style.Style({
                                fill: new _ol2.default.style.Fill({ color: 'rgba(0, 183, 152, 0.3)' }),
                                stroke: new _ol2.default.style.Stroke({
                                    color: 'rgba(0, 183, 152, 0.8)',
                                    width: 3
                                }),
                                image: new _ol2.default.style.Icon({
                                    src: _Markers2.default['turquoiseBlue'],
                                    anchor: [
                                        0.5,
                                        1
                                    ]
                                })
                            })
                        });
                        this._inputFeaturesLayer.gpResultLayerId = 'reverseGeocoding';
                        map.addLayer(this._inputFeaturesLayer);
                    }
                    var delimitation = this._currentGeocodingDelimitation.toLowerCase();
                    switch (delimitation) {
                    case 'point':
                        this._activatePointInteraction(map);
                        break;
                    case 'circle':
                        this._activateCircleInteraction(map);
                        break;
                    case 'extent':
                        this._activateBoxInteraction(map);
                        break;
                    default:
                        break;
                    }
                    map.getControls().forEach(function (control) {
                        if (control instanceof _LayerSwitcher2.default) {
                            var layerId = this._inputFeaturesLayer.gpLayerId;
                            if (control._layers[layerId].title === layerId) {
                                control.addLayer(this._inputFeaturesLayer, {
                                    title: 'Saisie (recherche inverse)',
                                    description: 'Couche de saisie d\'une zone de recherche pour la recherche inverse'
                                });
                                control.setRemovable(this._inputFeaturesLayer, false);
                            }
                        }
                    }, this);
                }
            };
            ReverseGeocode.prototype._activatePointInteraction = function (map) {
                this._mapInteraction = new _ol2.default.interaction.Draw({
                    style: new _ol2.default.style.Style({
                        image: new _ol2.default.style.Circle({
                            radius: 0,
                            fill: new _ol2.default.style.Fill({ color: 'rgba(0, 183, 152, 0.8)' })
                        })
                    }),
                    type: 'Point',
                    source: this._inputFeaturesSource
                });
                this._mapInteraction.on('drawstart', function (e) {
                    logger.log('on drawstart ', e);
                    this._inputFeatures.clear();
                    this._onDrawStart(e, 'point');
                }, this);
                map.addInteraction(this._mapInteraction);
                this._setCursor('crosshair', map);
            };
            ReverseGeocode.prototype._activateCircleInteraction = function (map) {
                this._mapInteraction = new _ol2.default.interaction.Draw({
                    style: new _ol2.default.style.Style({
                        fill: new _ol2.default.style.Fill({ color: 'rgba(0, 183, 152, 0.3)' }),
                        stroke: new _ol2.default.style.Stroke({
                            color: 'rgba(0, 183, 152, 0.8)',
                            width: 3
                        }),
                        image: new _ol2.default.style.Circle({
                            radius: 4,
                            fill: new _ol2.default.style.Fill({ color: 'rgba(0, 183, 152, 0.8)' })
                        })
                    }),
                    type: 'Circle',
                    source: this._inputFeaturesSource
                });
                this._mapInteraction.on('drawstart', function (e) {
                    logger.log('on drawstart ', e);
                    this._inputFeatures.clear();
                    this._onDrawStart(e, 'circle');
                }, this);
                this._mapInteraction.on('drawend', function (e) {
                    logger.log('on drawend', e);
                    if (e.feature && e.feature.getGeometry) {
                        var radius = e.feature.getGeometry().getRadius();
                        this._requestCircleFilter = {};
                        this._requestCircleFilter.radius = radius;
                        if (this._requestPosition) {
                            this._requestCircleFilter.x = this._requestPosition.x;
                            this._requestCircleFilter.y = this._requestPosition.y;
                        }
                        logger.log('circle radius : ', radius);
                    }
                }, this);
                map.addInteraction(this._mapInteraction);
            };
            ReverseGeocode.prototype._activateBoxInteraction = function (map) {
                var geometryFunction = function geometryFunction(coordinates, geometry) {
                    if (!geometry) {
                        geometry = new _ol2.default.geom.Polygon(null);
                    }
                    var start = coordinates[0];
                    var end = coordinates[1];
                    geometry.setCoordinates([[
                            start,
                            [
                                start[0],
                                end[1]
                            ],
                            end,
                            [
                                end[0],
                                start[1]
                            ],
                            start
                        ]]);
                    return geometry;
                };
                this._mapInteraction = new _ol2.default.interaction.Draw({
                    style: new _ol2.default.style.Style({
                        fill: new _ol2.default.style.Fill({ color: 'rgba(0, 183, 152, 0.3)' }),
                        stroke: new _ol2.default.style.Stroke({
                            color: 'rgba(0, 183, 152, 0.8)',
                            width: 3
                        }),
                        image: new _ol2.default.style.Circle({
                            radius: 4,
                            fill: new _ol2.default.style.Fill({ color: 'rgba(0, 183, 152, 0.8)' })
                        })
                    }),
                    type: 'LineString',
                    source: this._inputFeaturesSource,
                    maxPoints: 2,
                    geometryFunction: geometryFunction
                });
                this._mapInteraction.on('drawstart', function (e) {
                    logger.log('on drawstart', e);
                    this._inputFeatures.clear();
                }, this);
                this._mapInteraction.on('drawend', function (e) {
                    logger.log('on drawend', e);
                    this._onBoxDrawEnd(e);
                }, this);
                map.addInteraction(this._mapInteraction);
            };
            ReverseGeocode.prototype._removeMapInteraction = function (map) {
                if (this._mapInteraction != null) {
                    map.removeInteraction(this._mapInteraction);
                    this._mapInteraction = null;
                }
                this._setCursor();
            };
            ReverseGeocode.prototype._onDrawStart = function (e, type) {
                var coordinate;
                if (e.feature && e.feature.getGeometry) {
                    var geometry = e.feature.getGeometry();
                    if (type === 'point') {
                        coordinate = geometry.getCoordinates();
                    }
                    if (type === 'circle') {
                        coordinate = geometry.getCenter();
                    }
                }
                if (!coordinate) {
                    return;
                }
                var crs;
                if (this.options.reverseGeocodeOptions && this.options.reverseGeocodeOptions.srs) {
                    crs = this.options.reverseGeocodeOptions.srs;
                } else {
                    var map = this.getMap();
                    if (!map || !map.getView()) {
                        return;
                    }
                    crs = map.getView().getProjection();
                }
                var geoCoordinate = _ol2.default.proj.transform(coordinate, crs, 'EPSG:4326');
                this._requestPosition = {
                    x: geoCoordinate[0],
                    y: geoCoordinate[1]
                };
                logger.log('position coordinates : ', this._requestPosition);
            };
            ReverseGeocode.prototype._onBoxDrawEnd = function (e) {
                if (e.feature && e.feature.getGeometry) {
                    var coordinates = e.feature.getGeometry().getCoordinates()[0];
                    var start = coordinates[0];
                    var end = coordinates[2];
                    var crs;
                    if (this.options.reverseGeocodeOptions && this.options.reverseGeocodeOptions.srs) {
                        crs = this.options.reverseGeocodeOptions.srs;
                    } else {
                        var map = this.getMap();
                        if (!map || !map.getView()) {
                            return;
                        }
                        crs = map.getView().getProjection();
                    }
                    var startGeoCoordinate = _ol2.default.proj.transform(start, crs, 'EPSG:4326');
                    var endGeoCoordinate = _ol2.default.proj.transform(end, crs, 'EPSG:4326');
                    this._requestPosition = {};
                    this._requestBboxFilter = {};
                    if (startGeoCoordinate[0] < endGeoCoordinate[0]) {
                        this._requestBboxFilter.left = startGeoCoordinate[0];
                        this._requestBboxFilter.right = endGeoCoordinate[0];
                    } else {
                        this._requestBboxFilter.left = endGeoCoordinate[0];
                        this._requestBboxFilter.right = startGeoCoordinate[0];
                    }
                    if (startGeoCoordinate[1] < endGeoCoordinate[1]) {
                        this._requestBboxFilter.bottom = startGeoCoordinate[1];
                        this._requestBboxFilter.top = endGeoCoordinate[1];
                    } else {
                        this._requestBboxFilter.bottom = endGeoCoordinate[1];
                        this._requestBboxFilter.top = startGeoCoordinate[1];
                    }
                    this._requestPosition.x = (startGeoCoordinate[0] + endGeoCoordinate[0]) / 2;
                    this._requestPosition.y = (startGeoCoordinate[1] + endGeoCoordinate[1]) / 2;
                    logger.log('bbox filter : ', this._requestBboxFilter);
                    logger.log('center coordinates : ', this._requestPosition);
                }
            };
            ReverseGeocode.prototype._setCursor = function (cursor, map) {
                map = map || this.getMap();
                if (!map) {
                    return;
                }
                var div = map.getTargetElement();
                if (cursor) {
                    div.style.cursor = cursor;
                } else {
                    div.style.cursor = null;
                }
            };
            ReverseGeocode.prototype._reverseGeocodingRequest = function () {
                var map = this.getMap();
                this._requestOptions = this._getReverseGeocodingRequestOptions();
                this._removeMapInteraction(map);
                this._displayWaitingContainer();
                _gp2.default.Services.reverseGeocode(this._requestOptions);
            };
            ReverseGeocode.prototype._getReverseGeocodingRequestOptions = function () {
                var map = this.getMap();
                var reverseGeocodeOptions = this.options.reverseGeocodeOptions;
                var context = this;
                var requestOptions = {
                    apiKey: reverseGeocodeOptions.apiKey || this.options.apiKey,
                    position: this._requestPosition,
                    filterOptions: { type: [this._currentGeocodingType] },
                    srs: 'CRS:84',
                    returnFreeForm: false,
                    maximumResponses: reverseGeocodeOptions.maximumResponses || 25,
                    timeOut: reverseGeocodeOptions.timeOut || 30000,
                    protocol: reverseGeocodeOptions.protocol || 'XHR',
                    onSuccess: function onSuccess(response) {
                        if (response.locations) {
                            logger.log('reverseGeocode results : ', response.locations);
                            context._displayGeocodedLocations(response.locations);
                        }
                    },
                    onFailure: function onFailure(error) {
                        context._hideWaitingContainer();
                        context._clearResults();
                        context._clearInputFeatures();
                        context._activateMapInteraction(map);
                        logger.log(error.message);
                    }
                };
                if (this._currentGeocodingDelimitation.toLowerCase() === 'circle' && this._requestCircleFilter) {
                    if (this._requestCircleFilter.radius > 1000) {
                        console.log('INFO : initial circle radius (' + this._requestCircleFilter.radius + ') limited to 1000m.');
                        this._requestCircleFilter.radius = 1000;
                    }
                    requestOptions.filterOptions.circle = this._requestCircleFilter;
                }
                if (this._currentGeocodingDelimitation.toLowerCase() === 'extent' && this._requestBboxFilter) {
                    requestOptions.filterOptions.bbox = this._requestBboxFilter;
                }
                logger.log('reverseGeocode request options : ', requestOptions);
                return requestOptions;
            };
            ReverseGeocode.prototype._displayGeocodedLocations = function (locations) {
                this._clearResults();
                this._reverseGeocodingLocations = locations;
                this._formContainer.className = 'GPreverseGeocodingComponentHidden';
                this._hideWaitingContainer();
                this._panelTitleContainer.innerHTML = 'Résultats de la recherche';
                this._returnPictoContainer.className = '';
                this._resultsContainer.className = 'GPpanel';
                this._fillGeocodedLocationListContainer(locations);
                this._displayGeocodedLocationsOnMap(locations);
            };
            ReverseGeocode.prototype._fillGeocodedLocationListContainer = function (locations) {
                for (var i = 0; i < locations.length; i++) {
                    var location = locations[i];
                    logger.log(location);
                    var locationDescription = this._fillGeocodedLocationDescription(location);
                    if (locationDescription.length !== 0) {
                        this._createReverseGeocodingResultElement(locationDescription, i);
                    }
                }
            };
            ReverseGeocode.prototype._fillGeocodedLocationDescription = function (location) {
                if (!location || !location.placeAttributes) {
                    return;
                }
                var attr = location.placeAttributes;
                var locationDescription = '';
                switch (location.type) {
                case 'StreetAddress':
                    if (attr.street) {
                        locationDescription += attr.number ? attr.number + ' ' : '';
                        locationDescription += attr.street + ', ';
                    }
                    locationDescription += attr.postalCode + ' ' + attr.commune;
                    break;
                case 'PositionOfInterest':
                    if (location.matchType === 'City' && attr.commune) {
                        locationDescription += attr.commune;
                        locationDescription += attr.postalCode ? ', ' + attr.postalCode : '';
                    } else if (location.matchType === 'Département' && attr.municipality) {
                        locationDescription += attr.municipality;
                        locationDescription += attr.postalCode ? ', ' + attr.postalCode : '';
                    } else if (location.matchType === 'Toponym' && attr.municipality) {
                        locationDescription += attr.municipality;
                        locationDescription += attr.postalCode ? ', ' + attr.postalCode : '';
                        locationDescription += attr.commune ? ' ' + attr.commune : '';
                    } else {
                        locationDescription += attr.municipality ? attr.municipality : '';
                    }
                    locationDescription += attr.nature ? ' (' + attr.nature + ') ' : '';
                    break;
                case 'CadastralParcel':
                    locationDescription += attr.cadastralParcel ? attr.cadastralParcel : '';
                    locationDescription += attr.municipality ? ' (' + attr.municipality + ')' : '';
                    break;
                case 'Administratif':
                    locationDescription += attr.municipality ? attr.municipality : '';
                    if (attr.inseeDepartment) {
                        locationDescription += '(Département)';
                    } else if (attr.inseeRegion) {
                        locationDescription += '(Région)';
                    }
                    break;
                default:
                    locationDescription += attr.municipality ? attr.municipality : '';
                    break;
                }
                return locationDescription;
            };
            ReverseGeocode.prototype._displayGeocodedLocationsOnMap = function (locations) {
                if (this._reverseGeocodingLocations.length !== 0) {
                    var map = this.getMap();
                    this._createResultsLayer();
                    for (var i = 0; i < locations.length; i++) {
                        this._addResultFeature(locations[i], i);
                    }
                    if (this._resultsFeatures.getLength() > 1) {
                        if (this._resultsFeaturesSource && this._resultsFeaturesSource.getExtent) {
                            var extent = this._resultsFeaturesSource.getExtent();
                            map.getView().fit(extent, map.getSize());
                        }
                    } else {
                        var feature = this._resultsFeatures.item(0);
                        var coords = feature.getGeometry().getCoordinates();
                        map.getView().setCenter(coords);
                        map.getView().setZoom(17);
                    }
                    this._resultsHoverInteraction = new _ol2.default.interaction.Select({
                        condition: _ol2.default.events.condition.pointerMove,
                        layers: [this._resultsFeaturesLayer]
                    });
                    this._resultsHoverInteraction.on('select', this._onResultsFeatureMouseOver, this);
                    map.addInteraction(this._resultsHoverInteraction);
                    this._resultsSelectInteraction = new _ol2.default.interaction.Select({ layers: [this._resultsFeaturesLayer] });
                    this._resultsSelectInteraction.on('select', this._onResultsFeatureSelect, this);
                    map.addInteraction(this._resultsSelectInteraction);
                    var geocodeType = '';
                    switch (this._currentGeocodingType) {
                    case 'StreetAddress':
                        geocodeType = 'adresses';
                        break;
                    case 'PositionOfInterest':
                        geocodeType = 'toponymes';
                        break;
                    case 'CadastralParcel':
                        geocodeType = 'parcelles cadastrales';
                        break;
                    case 'Administratif':
                        geocodeType = 'unités administratives';
                        break;
                    default:
                        break;
                    }
                    map.getControls().forEach(function (control) {
                        if (control instanceof _LayerSwitcher2.default) {
                            var layerId = this._resultsFeaturesLayer.gpLayerId;
                            if (control._layers[layerId].title === layerId) {
                                control.addLayer(this._resultsFeaturesLayer, {
                                    title: 'Résultats de la recherche inverse',
                                    description: 'Résultats de la recherche inverse sur les ' + geocodeType
                                });
                                control.setRemovable(this._resultsFeaturesLayer, false);
                            }
                        }
                    }, this);
                }
            };
            ReverseGeocode.prototype._createResultsLayer = function () {
                var map = this.getMap();
                this._resultsFeatures = new _ol2.default.Collection();
                this._resultsFeaturesSource = new _ol2.default.source.Vector({ features: this._resultsFeatures });
                this._resultsFeaturesLayer = new _ol2.default.layer.Vector({ source: this._resultsFeaturesSource });
                this._resultsFeaturesLayer.gpResultLayerId = 'reverseGeocodingResults';
                map.addLayer(this._resultsFeaturesLayer);
            };
            ReverseGeocode.prototype._addResultFeature = function (location, i) {
                var map = this.getMap();
                var position = [
                    location.position.x,
                    location.position.y
                ];
                if (!position) {
                    return;
                }
                var view = map.getView();
                var mapProj = view.getProjection().getCode();
                if (mapProj !== 'EPSG:4326') {
                    position = _ol2.default.proj.transform(position, 'EPSG:4326', mapProj);
                }
                var feature = new _ol2.default.Feature({ geometry: new _ol2.default.geom.Point(position) });
                feature.setStyle(this._resultsDefaultStyle);
                feature.setId(i);
                feature.setProperties({ popupContent: this._fillPopupContent(location) });
                this._resultsFeatures.push(feature);
            };
            ReverseGeocode.prototype._fillPopupContent = function (location) {
                var popupContent = '<ul>';
                var attributes = location.placeAttributes;
                for (var attr in attributes) {
                    if (attributes.hasOwnProperty(attr)) {
                        if (attr !== 'bbox') {
                            popupContent += '<li>';
                            popupContent += '<span class="gp-attname-others-span">' + attr.toUpperCase() + ' : </span>';
                            popupContent += attributes[attr];
                            popupContent += ' </li>';
                        }
                    }
                }
                popupContent += ' </ul>';
                return popupContent;
            };
            ReverseGeocode.prototype._onResultsFeatureMouseOver = function (e) {
                var f;
                if (e.selected.length !== 0) {
                    f = e.selected[0];
                    f.setStyle(this._resultsSelectedStyle);
                    if (f.getId() != null) {
                        var selectedResultDiv = document.getElementById('ReverseGeocodedLocation_' + f.getId() + '-' + this._uid);
                        if (selectedResultDiv && selectedResultDiv.classList) {
                            selectedResultDiv.classList.add('GPreverseGeocodedLocationHighlight');
                        }
                    }
                    document.getElementById('ReverseGeocodedLocation_' + f.getId() + '-' + this._uid);
                }
                if (e.deselected.length !== 0) {
                    f = e.deselected[0];
                    f.setStyle(this._resultsDefaultStyle);
                    var deSelectedResultDiv = document.getElementById('ReverseGeocodedLocation_' + f.getId() + '-' + this._uid);
                    if (deSelectedResultDiv && deSelectedResultDiv.classList) {
                        deSelectedResultDiv.classList.remove('GPreverseGeocodedLocationHighlight');
                    }
                }
            };
            ReverseGeocode.prototype._onResultsFeatureSelect = function (e) {
                var map = this.getMap();
                if (e.selected.length !== 0) {
                    var f = e.selected[0];
                    this._popupContent.innerHTML = f.getProperties().popupContent;
                    if (!this._popupOverlay) {
                        this._popupOverlay = new _ol2.default.Overlay({
                            element: this._popupDiv,
                            positioning: 'bottom-center',
                            position: e.mapBrowserEvent.coordinate
                        });
                        map.addOverlay(this._popupOverlay);
                    } else {
                        this._popupOverlay.setPosition(e.mapBrowserEvent.coordinate);
                    }
                } else {
                    if (this._popupOverlay != null) {
                        this._popupOverlay.setPosition(undefined);
                    }
                }
            };
            ReverseGeocode.prototype.onShowReverseGeocodingClick = function () {
                this.collapsed = this._showReverseGeocodingInput.checked;
                this.dispatchEvent('change:collapsed');
                var map = this.getMap();
                if (!this._waiting && !this._reverseGeocodingLocations.length) {
                    if (this.collapsed) {
                        this._clearResults();
                        this._clearInputFeatures();
                        this._removeMapInteraction(map);
                        if (this._inputFeaturesLayer != null) {
                            map.removeLayer(this._inputFeaturesLayer);
                            this._inputFeaturesLayer = null;
                            this._inputFeaturesSources = null;
                            this._inputFeatures = null;
                        }
                    } else {
                        this._activateMapInteraction(map);
                    }
                }
            };
            ReverseGeocode.prototype.onReverseGeocodingTypeChange = function (e) {
                var idx = e.target.selectedIndex;
                var value = e.target.options[idx].value;
                if (!value) {
                    return;
                }
                logger.log(value);
                this._currentGeocodingType = value;
            };
            ReverseGeocode.prototype.onReverseGeocodingDelimitationChange = function (e) {
                var idx = e.target.selectedIndex;
                var value = e.target.options[idx].value;
                if (!value) {
                    return;
                }
                logger.log(value);
                this._currentGeocodingDelimitation = value;
                var map = this.getMap();
                this._clearInputFeatures();
                this._removeMapInteraction(map);
                this._activateMapInteraction(map);
            };
            ReverseGeocode.prototype.onGPreverseGeocodingReturnPictoClick = function () {
                this._clearResults();
                this._clearInputFeatures();
                this._activateMapInteraction(this.getMap());
            };
            ReverseGeocode.prototype.onReverseGeocodingSubmit = function () {
                if (!this._requestPosition) {
                    logger.log('missing position');
                    return;
                }
                if (this._noRightManagement) {
                    return;
                }
                this._reverseGeocodingRequest();
            };
            ReverseGeocode.prototype.onReverseGeocodingResultClick = function (e) {
                logger.log('onReverseGeocodingResultClick', e);
            };
            ReverseGeocode.prototype.onReverseGeocodingResultMouseOver = function (e) {
                var tagid = e.target.id;
                var idx = tagid.substring(tagid.indexOf('_') + 1);
                if (e.target.classList) {
                    e.target.classList.add('GPreverseGeocodedLocationHighlight');
                }
                if (!this._resultsFeaturesSource) {
                    return;
                }
                var f = this._resultsFeaturesSource.getFeatureById(parseInt(idx, 10));
                f.setStyle(this._resultsSelectedStyle);
            };
            ReverseGeocode.prototype.onReverseGeocodingResultMouseOut = function (e) {
                var tagid = e.target.id;
                var idx = tagid.substring(tagid.indexOf('_') + 1);
                if (e.target.classList) {
                    e.target.classList.remove('GPreverseGeocodedLocationHighlight');
                }
                if (!this._resultsFeaturesSource) {
                    return;
                }
                var f = this._resultsFeaturesSource.getFeatureById(parseInt(idx, 10));
                f.setStyle(this._resultsDefaultStyle);
            };
            ReverseGeocode.prototype._clearResults = function () {
                var map = this.getMap();
                this._reverseGeocodingLocations = [];
                if (this._resultsListContainer) {
                    while (this._resultsListContainer.firstChild) {
                        this._resultsListContainer.removeChild(this._resultsListContainer.firstChild);
                    }
                }
                if (this._resultsFeaturesLayer) {
                    map.removeLayer(this._resultsFeaturesLayer);
                    this._resultsFeaturesLayer = null;
                }
                if (this._popupOverlay != null) {
                    map.removeOverlay(this._popupOverlay);
                    this._popupOverlay = null;
                }
                if (this._resultsSelectInteraction != null) {
                    map.removeInteraction(this._resultsSelectInteraction);
                    this._resultsSelectInteraction = null;
                }
                if (this._resultsHoverInteraction != null) {
                    map.removeInteraction(this._resultsHoverInteraction);
                    this._resultsHoverInteraction = null;
                }
            };
            ReverseGeocode.prototype._clearInputFeatures = function () {
                if (this._inputFeatures) {
                    this._inputFeatures.clear();
                }
                this._requestPosition = null;
                this._requestCircleFilter = null;
                this._requestBboxFilter = null;
            };
            ReverseGeocode.prototype._displayWaitingContainer = function () {
                this._waitingContainer.className = 'GProuteCalcWaitingContainerVisible';
                this._waiting = true;
                if (this._timer) {
                    clearTimeout(this._timer);
                    this._timer = null;
                }
                var context = this;
                this._timer = setTimeout(function () {
                    if (context._waiting === true) {
                        context._hideWaitingContainer();
                    } else {
                        if (context._timer) {
                            clearTimeout(context._timer);
                        }
                    }
                }, 16000);
            };
            ReverseGeocode.prototype._hideWaitingContainer = function () {
                if (this._waiting) {
                    this._waitingContainer.className = 'GProuteCalcWaitingContainerHidden';
                    this._waiting = false;
                    clearTimeout(this._timer);
                    this._timer = null;
                }
            };
            exports.default = ReverseGeocode;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var ReverseGeocodingDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPreverseGeocoding');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowReverseGeocodingElement: function _createShowReverseGeocodingElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowReverseGeocoding');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowReverseGeocodingPictoElement: function _createShowReverseGeocodingPictoElement() {
                    var self = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowReverseGeocodingPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowReverseGeocoding');
                    label.title = 'Ouvrir la recherche inverse';
                    if (label.addEventListener) {
                        label.addEventListener('click', function () {
                            self.onShowReverseGeocodingClick();
                        });
                    } else if (label.attachEvent) {
                        label.attachEvent('onclick', function () {
                            self.onShowReverseGeocodingClick();
                        });
                    }
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowReverseGeocodingOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                },
                _createReverseGeocodingWaitingElement: function _createReverseGeocodingWaitingElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPreverseGeocodingCalcWaitingContainer');
                    div.className = 'GPreverseGeocodingCalcWaitingContainerHidden';
                    var p = document.createElement('p');
                    p.className = 'GPreverseGeocodingCalcWaiting';
                    p.innerHTML = 'Recherche en cours...';
                    div.appendChild(p);
                    return div;
                },
                _createReverseGeocodingResultsPanelElement: function _createReverseGeocodingResultsPanelElement() {
                    var resultsPanelDiv = document.createElement('div');
                    resultsPanelDiv.id = this._addUID('GPreverseGeocodingResultsPanel');
                    resultsPanelDiv.className = 'GPpanel GPreverseGeocodingComponentHidden';
                    return resultsPanelDiv;
                },
                _createReverseGeocodingResultsListElement: function _createReverseGeocodingResultsListElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPreverseGeocodingResultsList');
                    return container;
                },
                _createReverseGeocodingResultElement: function _createReverseGeocodingResultElement(locationDescription, id) {
                    var context = this;
                    var container = document.getElementById(this._addUID('GPreverseGeocodingResultsList'));
                    var div = document.createElement('div');
                    div.id = this._addUID('ReverseGeocodedLocation_' + id);
                    div.className = 'GPautoCompleteProposal';
                    div.innerHTML = locationDescription;
                    div.title = locationDescription;
                    if (div.addEventListener) {
                        div.addEventListener('mouseover', function (e) {
                            context.onReverseGeocodingResultMouseOver(e);
                        });
                        div.addEventListener('mouseout', function (e) {
                            context.onReverseGeocodingResultMouseOut(e);
                        });
                        div.addEventListener('click', function (e) {
                            if (typeof context.onReverseGeocodingResultClick === 'function') {
                                context.onReverseGeocodingResultClick(e);
                            }
                        });
                    } else if (div.attachEvent) {
                        div.attachEvent('onmouseover', function (e) {
                            context.onReverseGeocodingResultMouseOver(e);
                        });
                        div.attachEvent('onmouseout', function (e) {
                            context.onReverseGeocodingResultMouseOut(e);
                        });
                        div.attachEvent('onclick', function (e) {
                            if (typeof context.onReverseGeocodingResultClick === 'function') {
                                context.onReverseGeocodingResultClick(e);
                            }
                        });
                    }
                    container.appendChild(div);
                },
                _createReverseGeocodingPanelElement: function _createReverseGeocodingPanelElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPreverseGeocodingPanel');
                    div.className = 'GPpanel';
                    return div;
                },
                _createReverseGeocodingPanelHeaderElement: function _createReverseGeocodingPanelHeaderElement() {
                    var container = document.createElement('div');
                    container.className = 'GPpanelHeader';
                    return container;
                },
                _createReverseGeocodingPanelReturnPictoElement: function _createReverseGeocodingPanelReturnPictoElement() {
                    var self = this;
                    var divNew = document.createElement('div');
                    divNew.id = this._addUID('GPreverseGeocodingReturnPicto');
                    divNew.title = 'Nouvelle recherche';
                    divNew.className = 'GPreverseGeocodingReturnPictoHidden';
                    if (divNew.addEventListener) {
                        divNew.addEventListener('click', function (e) {
                            document.getElementById(self._addUID('GPreverseGeocodingResultsPanel')).className = 'GProuteComponentHidden';
                            document.getElementById(self._addUID('GPreverseGeocodingForm')).className = '';
                            document.getElementById(self._addUID('GPreverseGeocodingHeaderTitle')).innerHTML = 'Recherche inverse';
                            document.getElementById(self._addUID('GPreverseGeocodingReturnPicto')).className = 'GPreverseGeocodingReturnPictoHidden';
                            self.onGPreverseGeocodingReturnPictoClick(e);
                        });
                    } else if (divNew.attachEvent) {
                        divNew.attachEvent('onclick', function (e) {
                            document.getElementById(self._addUID('GPreverseGeocodingResultsPanel')).className = 'GProuteComponentHidden';
                            document.getElementById(self._addUID('GPreverseGeocodingForm')).className = '';
                            document.getElementById(self._addUID('GPreverseGeocodingHeaderTitle')).innerHTML = 'Recherche inverse';
                            document.getElementById(self._addUID('GPreverseGeocodingReturnPicto')).className = 'GPreverseGeocodingReturnPictoHidden';
                            self.onGPreverseGeocodingReturnPictoClick(e);
                        });
                    }
                    return divNew;
                },
                _createReverseGeocodingPanelTitleElement: function _createReverseGeocodingPanelTitleElement() {
                    var div = document.createElement('div');
                    div.className = 'GPpanelTitle';
                    div.id = this._addUID('GPreverseGeocodingHeaderTitle');
                    div.innerHTML = 'Recherche inverse';
                    return div;
                },
                _createReverseGeocodingPanelCloseElement: function _createReverseGeocodingPanelCloseElement() {
                    var self = this;
                    var divClose = document.createElement('div');
                    divClose.id = this._addUID('GPreverseGeocodingPanelClose');
                    divClose.className = 'GPpanelClose';
                    divClose.title = 'Fermer le panneau';
                    if (divClose.addEventListener) {
                        divClose.addEventListener('click', function () {
                            document.getElementById(self._addUID('GPshowReverseGeocodingPicto')).click();
                        }, false);
                    } else if (divClose.attachEvent) {
                        divClose.attachEvent('onclick', function () {
                            document.getElementById(self._addUID('GPshowReverseGeocodingPicto')).click();
                        });
                    }
                    return divClose;
                },
                _createReverseGeocodingPanelFormElement: function _createReverseGeocodingPanelFormElement() {
                    var self = this;
                    var form = document.createElement('form');
                    form.id = this._addUID('GPreverseGeocodingForm');
                    if (form.addEventListener) {
                        form.addEventListener('submit', function (e) {
                            e.preventDefault();
                            self.onReverseGeocodingSubmit();
                        });
                    } else if (form.attachEvent) {
                        form.attachEvent('onsubmit', function (e) {
                            e.preventDefault();
                            self.onReverseGeocodingSubmit();
                        });
                    }
                    return form;
                },
                _createReverseGeocodingFormModeChoiceGeocodingTypeElement: function _createReverseGeocodingFormModeChoiceGeocodingTypeElement(resources) {
                    var context = this;
                    var div = document.createElement('div');
                    div.className = 'GPflexInput';
                    var label = document.createElement('label');
                    label.className = 'GPreverseGeocodingCodeLabel';
                    label.innerHTML = 'Recherche par';
                    label.title = 'Recherche par';
                    div.appendChild(label);
                    var select = document.createElement('select');
                    select.className = 'GPreverseGeocodingCode';
                    if (select.addEventListener) {
                        select.addEventListener('change', function (e) {
                            context.onReverseGeocodingTypeChange(e);
                        });
                    } else if (select.attachEvent) {
                        select.attachEvent('onchange', function (e) {
                            context.onReverseGeocodingTypeChange(e);
                        });
                    }
                    if (!resources || !Array.isArray(resources)) {
                        resources = [
                            'StreetAddress',
                            'PositionOfInterest',
                            'CadastralParcel'
                        ];
                    }
                    for (var i = 0; i < resources.length; i++) {
                        switch (resources[i]) {
                        case 'PositionOfInterest':
                            var POIOption = document.createElement('option');
                            POIOption.value = 'PositionOfInterest';
                            POIOption.text = 'Lieux/toponymes';
                            select.appendChild(POIOption);
                            break;
                        case 'StreetAddress':
                            var SAOption = document.createElement('option');
                            SAOption.value = 'StreetAddress';
                            SAOption.text = 'Adresses';
                            select.appendChild(SAOption);
                            break;
                        case 'CadastralParcel':
                            var CPOption = document.createElement('option');
                            CPOption.value = 'CadastralParcel';
                            CPOption.text = 'Parcelles cadastrales';
                            select.appendChild(CPOption);
                            break;
                        case 'Administratif':
                            var adminOption = document.createElement('option');
                            adminOption.value = 'Administratif';
                            adminOption.text = 'Unités administratives';
                            select.appendChild(adminOption);
                            break;
                        default:
                            break;
                        }
                    }
                    div.appendChild(select);
                    return div;
                },
                _createReverseGeocodingFormModeChoiceGeocodingDelimitationElement: function _createReverseGeocodingFormModeChoiceGeocodingDelimitationElement(delimitations) {
                    var context = this;
                    var div = document.createElement('div');
                    div.className = 'GPflexInput';
                    var label = document.createElement('label');
                    label.className = 'GPreverseGeocodingCodeLabel';
                    label.innerHTML = 'Délimitation';
                    label.title = 'Délimitation';
                    div.appendChild(label);
                    var select = document.createElement('select');
                    select.className = 'GPreverseGeocodingCode';
                    if (select.addEventListener) {
                        select.addEventListener('change', function (e) {
                            context.onReverseGeocodingDelimitationChange(e);
                        });
                    } else if (select.attachEvent) {
                        select.attachEvent('onchange', function (e) {
                            context.onReverseGeocodingDelimitationChange(e);
                        });
                    }
                    if (!delimitations || !Array.isArray(delimitations)) {
                        delimitations = [
                            'Point',
                            'Circle',
                            'Extent'
                        ];
                    }
                    for (var i = 0; i < delimitations.length; i++) {
                        switch (delimitations[i].toLowerCase()) {
                        case 'point':
                            var pointOption = document.createElement('option');
                            pointOption.value = 'point';
                            pointOption.text = 'Pointer un lieu';
                            select.appendChild(pointOption);
                            break;
                        case 'circle':
                            var circleOption = document.createElement('option');
                            circleOption.value = 'circle';
                            circleOption.text = 'Dessiner un cercle';
                            select.appendChild(circleOption);
                            break;
                        case 'extent':
                            var extentOption = document.createElement('option');
                            extentOption.value = 'extent';
                            extentOption.text = 'Dessiner une emprise';
                            select.appendChild(extentOption);
                            break;
                        default:
                            break;
                        }
                    }
                    div.appendChild(select);
                    return div;
                },
                _createReverseGeocodingSubmitFormElement: function _createReverseGeocodingSubmitFormElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPreverseGeocodingSubmit');
                    input.className = 'GPinputSubmit';
                    input.type = 'submit';
                    input.value = 'Rechercher';
                    return input;
                }
            };
            exports.default = ReverseGeocodingDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _Markers = __webpack_require__(7);
            var _Markers2 = _interopRequireDefault(_Markers);
            var _LayerImportDOM = __webpack_require__(106);
            var _LayerImportDOM2 = _interopRequireDefault(_LayerImportDOM);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            var _ProxyUtils = __webpack_require__(16);
            var _ProxyUtils2 = _interopRequireDefault(_ProxyUtils);
            var _KML = __webpack_require__(18);
            var _KML2 = _interopRequireDefault(_KML);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('layerimport');
            function LayerImport(options) {
                options = options || {};
                if (!(this instanceof LayerImport)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this._initialize(options);
                var container = this._initContainer(options);
                _ol2.default.control.Control.call(this, {
                    element: container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(LayerImport, _ol2.default.control.Control);
            LayerImport.DefaultStyles = {
                image: new _ol2.default.style.Icon({
                    src: _Markers2.default['lightOrange'],
                    anchor: [
                        25.5,
                        38
                    ],
                    anchorOrigin: 'top-left',
                    anchorXUnits: 'pixels',
                    anchorYUnits: 'pixels'
                }),
                stroke: new _ol2.default.style.Stroke({
                    color: 'rgba(0,42,80,0.8)',
                    width: 4
                }),
                fill: new _ol2.default.style.Fill({ color: 'rgba(0, 183, 152, 0.5)' }),
                text: new _ol2.default.style.Text({
                    font: '16px Sans',
                    textAlign: 'left',
                    fill: new _ol2.default.style.Fill({ color: 'rgba(255, 255, 255, 1)' }),
                    stroke: new _ol2.default.style.Stroke({
                        color: 'rgba(0, 0, 0, 1)',
                        width: 2
                    })
                })
            };
            LayerImport.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(LayerImport.prototype, _LayerImportDOM2.default);
            LayerImport.prototype.constructor = LayerImport;
            LayerImport.prototype.getCollapsed = function () {
                return this.collapsed;
            };
            LayerImport.prototype.setCollapsed = function (collapsed) {
                if (collapsed === undefined) {
                    console.log('[ERROR] LayerImport:setCollapsed - missing collapsed parameter');
                    return;
                }
                if (collapsed && this.collapsed || !collapsed && !this.collapsed) {
                    return;
                }
                if (collapsed) {
                    document.getElementById('GPimportPanelClose-' + this._uid).click();
                } else {
                    document.getElementById('GPshowImport-' + this._uid).click();
                }
                this.collapsed = collapsed;
            };
            LayerImport.prototype.getStaticImportContent = function () {
                return this.contentStatic;
            };
            LayerImport.prototype.getServiceImportContent = function () {
                return this.contentService;
            };
            LayerImport.prototype._initialize = function (options) {
                this._checkInputOptions(options);
                this.options = {
                    collapsed: true,
                    layerTypes: [
                        'KML',
                        'GPX',
                        'GeoJSON',
                        'WMS',
                        'WMTS'
                    ],
                    webServicesOptions: {},
                    vectorStyleOptions: {
                        KML: {
                            extractStyles: true,
                            showPointNames: true,
                            defaultStyle: {}
                        },
                        GPX: { defaultStyle: {} },
                        GeoJSON: { defaultStyle: {} }
                    }
                };
                if (options.vectorStyleOptions && options.vectorStyleOptions.KML && options.vectorStyleOptions.KML.extractStyles) {
                    this.options.vectorStyleOptions.KML.extractStyles = options.vectorStyleOptions.KML.extractStyles;
                }
                if (options.vectorStyleOptions && options.vectorStyleOptions.KML && options.vectorStyleOptions.KML.showPointNames) {
                    this.options.vectorStyleOptions.KML.showPointNames = options.vectorStyleOptions.KML.showPointNames;
                }
                if (options.vectorStyleOptions && options.vectorStyleOptions.KML && options.vectorStyleOptions.KML.defaultStyle) {
                    this.options.vectorStyleOptions.KML.defaultStyle = options.vectorStyleOptions.KML.defaultStyle;
                } else {
                    this.options.vectorStyleOptions.KML.defaultStyle = new _ol2.default.style.Style({
                        image: LayerImport.DefaultStyles.image,
                        stroke: LayerImport.DefaultStyles.stroke,
                        fill: LayerImport.DefaultStyles.fill,
                        text: LayerImport.DefaultStyles.text
                    });
                }
                if (options.vectorStyleOptions && options.vectorStyleOptions.GPX && options.vectorStyleOptions.GPX.defaultStyle) {
                    this.options.vectorStyleOptions.GPX.defaultStyle = options.vectorStyleOptions.GPX.defaultStyle;
                } else {
                    this.options.vectorStyleOptions.GPX.defaultStyle = new _ol2.default.style.Style({
                        image: LayerImport.DefaultStyles.image,
                        stroke: LayerImport.DefaultStyles.stroke,
                        fill: LayerImport.DefaultStyles.fill
                    });
                }
                if (options.vectorStyleOptions && options.vectorStyleOptions.GeoJSON && options.vectorStyleOptions.GeoJSON.defaultStyle) {
                    this.options.vectorStyleOptions.GeoJSON.defaultStyle = options.vectorStyleOptions.GeoJSON.defaultStyle;
                } else {
                    this.options.vectorStyleOptions.GeoJSON.defaultStyle = new _ol2.default.style.Style({
                        image: LayerImport.DefaultStyles.image,
                        stroke: LayerImport.DefaultStyles.stroke,
                        fill: LayerImport.DefaultStyles.fill
                    });
                }
                if (Array.isArray(options.layerTypes)) {
                    var layerTypes = [];
                    for (var i = 0; i < options.layerTypes.length; i++) {
                        layerTypes.push(options.layerTypes[i]);
                    }
                    this.options.layerTypes = layerTypes;
                }
                _Utils2.default.mergeParams(this.options, options);
                this.collapsed = this.options.collapsed;
                this._uid = _SelectorID2.default.generate();
                this._waiting = false;
                this._timer = null;
                this._initImportTypes();
                this._initDefaultStyles();
                this._showImportInput = null;
                this._importPanel = null;
                this._formContainer = null;
                this._staticLocalImportInput = null;
                this._staticUrlImportInput = null;
                this._serviceUrlImportInput = null;
                this._getCapPanel = null;
                this._getCapResultsListContainer = null;
                this._waitingContainer = null;
                this._getCapRequestUrl = null;
                this._getCapResponseWMS = null;
                this._getCapResponseWMSLayers = [];
                this._getCapResponseWMTS = null;
                this._getCapResponseWMTSLayers = [];
            };
            LayerImport.prototype._checkInputOptions = function (options) {
                if (options.layerTypes) {
                    var layerTypes = options.layerTypes;
                    if (!Array.isArray(layerTypes)) {
                        console.log('[ol.control.LayerImport] \'options.layerTypes\' parameter should be an array. Set default values ["KML", "GPX", "GeoJSON", "WMS", "WMTS"]');
                        options.layerTypes = [
                            'KML',
                            'GPX',
                            'GeoJSON',
                            'WMS',
                            'WMTS'
                        ];
                    } else {
                        var typesList = [
                            'KML',
                            'GPX',
                            'GEOJSON',
                            'WMS',
                            'WMTS',
                            'WFS'
                        ];
                        var wrongTypesIndexes = [];
                        for (var i = 0; i < layerTypes.length; i++) {
                            if (typeof layerTypes[i] !== 'string') {
                                wrongTypesIndexes.push(i);
                                console.log('[ol.control.LayerImport] \'options.layerTypes\' elements should be of type string (' + layerTypes[i] + ')');
                            } else {
                                layerTypes[i] = layerTypes[i].toUpperCase();
                                if (typesList.indexOf(layerTypes[i]) === -1) {
                                    wrongTypesIndexes.push(i);
                                    console.log('[ol.control.LayerImport] options.layerTypes : ' + layerTypes[i] + ' is not a supported type');
                                }
                                if (layerTypes[i] === 'GEOJSON') {
                                    layerTypes[i] = 'GeoJSON';
                                }
                            }
                        }
                        if (wrongTypesIndexes.length !== 0) {
                            for (var j = wrongTypesIndexes.length - 1; j >= 0; j--) {
                                layerTypes.splice(wrongTypesIndexes[j], 1);
                            }
                        }
                    }
                }
            };
            LayerImport.prototype._initDefaultStyles = function () {
                var kmlDefaultStyles = this.options.vectorStyleOptions.KML.defaultStyle;
                this._defaultKMLStyle = new _ol2.default.style.Style({
                    image: kmlDefaultStyles.image,
                    stroke: kmlDefaultStyles.stroke,
                    fill: kmlDefaultStyles.fill,
                    text: kmlDefaultStyles.text
                });
                var gpxDefaultStyles = this.options.vectorStyleOptions.GPX.defaultStyle;
                this._defaultGPXStyle = new _ol2.default.style.Style({
                    image: gpxDefaultStyles.image,
                    stroke: gpxDefaultStyles.stroke,
                    fill: gpxDefaultStyles.fill
                });
                var geoJSONDefaultStyles = this.options.vectorStyleOptions.GeoJSON.defaultStyle;
                this._defaultGeoJSONStyle = new _ol2.default.style.Style({
                    image: geoJSONDefaultStyles.image,
                    stroke: geoJSONDefaultStyles.stroke,
                    fill: geoJSONDefaultStyles.fill
                });
            };
            LayerImport.prototype._initImportTypes = function () {
                this._currentImportType = this.options.layerTypes[0] || 'KML';
                if (this._currentImportType === 'KML' || this._currentImportType === 'GPX' || this._currentImportType === 'GeoJSON') {
                    this._isCurrentImportTypeStatic = true;
                } else if (this._currentImportType === 'WMS' || this._currentImportType === 'WMTS' || this._currentImportType === 'WFS') {
                    this._isCurrentImportTypeStatic = false;
                }
                this._currentStaticImportType = 'local';
            };
            LayerImport.prototype._initContainer = function () {
                var container = this._createMainContainerElement();
                var inputShow = this._showImportInput = this._createShowImportElement();
                container.appendChild(inputShow);
                if (!this.collapsed) {
                    inputShow.checked = true;
                }
                var picto = this._createShowImportPictoElement();
                container.appendChild(picto);
                var importPanel = this._importPanel = this._createImportPanelElement();
                var panelHeader = this._createImportPanelHeaderElement();
                importPanel.appendChild(panelHeader);
                var importForm = this._formContainer = this._initInputFormElement();
                importPanel.appendChild(importForm);
                container.appendChild(importPanel);
                var getCapPanel = this._getCapPanel = this._createImportGetCapPanelElement();
                getCapPanel.appendChild(this._createImportGetCapPanelHeaderElement());
                var importGetCapResultsList = this._getCapResultsListContainer = this._createImportGetCapResultsListElement();
                getCapPanel.appendChild(importGetCapResultsList);
                container.appendChild(getCapPanel);
                var waiting = this._waitingContainer = this._createImportWaitingElement();
                container.appendChild(waiting);
                return container;
            };
            LayerImport.prototype._initInputFormElement = function () {
                var importForm = this._createImportPanelFormElement();
                var importTypeChoiceDiv = this._createImportTypeLineElement(this.options.layerTypes);
                importForm.appendChild(importTypeChoiceDiv);
                var importStaticParamsContainer = this._createImportStaticParamsContainer(this.options.layerTypes[0]);
                var staticNameLabel = this._createStaticNameLabel();
                importStaticParamsContainer.appendChild(staticNameLabel);
                var staticImportChoice = this._createStaticModeChoiceDiv();
                var staticLocalImportChoice = this._createStaticLocalChoiceDiv();
                staticImportChoice.appendChild(staticLocalImportChoice);
                var staticUrlImportChoice = this._createStaticUrlChoiceDiv();
                staticImportChoice.appendChild(staticUrlImportChoice);
                importStaticParamsContainer.appendChild(staticImportChoice);
                var staticLocalInputDiv = this._createStaticLocalInputDiv();
                staticLocalInputDiv.appendChild(this._createStaticLocalInputLabel());
                this._staticLocalImportInput = this._createStaticLocalInput();
                staticLocalInputDiv.appendChild(this._staticLocalImportInput);
                importStaticParamsContainer.appendChild(staticLocalInputDiv);
                var staticUrlInputDiv = this._createStaticUrlInputDiv();
                staticUrlInputDiv.appendChild(this._createStaticUrlInputLabel());
                this._staticUrlImportInput = this._createStaticUrlInput();
                staticUrlInputDiv.appendChild(this._staticUrlImportInput);
                importStaticParamsContainer.appendChild(staticUrlInputDiv);
                importForm.appendChild(importStaticParamsContainer);
                var importServiceParamsContainer = this._createServiceParamsContainer(this.options.layerTypes[0]);
                var importServiceUrlDiv = this._createServiceUrlDiv();
                importServiceUrlDiv.appendChild(this._createServiceUrlInputLabel());
                this._serviceUrlImportInput = this._createServiceUrlInput();
                importServiceUrlDiv.appendChild(this._serviceUrlImportInput);
                importServiceParamsContainer.appendChild(importServiceUrlDiv);
                importForm.appendChild(importServiceParamsContainer);
                var submit = this._createImportSubmitFormElement();
                importForm.appendChild(submit);
                return importForm;
            };
            LayerImport.prototype._onShowImportClick = function () {
                this.collapsed = this._showImportInput.checked;
                this.dispatchEvent('change:collapsed');
            };
            LayerImport.prototype._onImportTypeChange = function (e) {
                this._currentImportType = e.target.value;
                if (this._currentImportType === 'KML' || this._currentImportType === 'GPX' || this._currentImportType === 'GeoJSON') {
                    this._isCurrentImportTypeStatic = true;
                } else if (this._currentImportType === 'WMS' || this._currentImportType === 'WMTS' || this._currentImportType === 'WFS') {
                    this._isCurrentImportTypeStatic = false;
                }
            };
            LayerImport.prototype._onStaticImportTypeChange = function (e) {
                this._currentStaticImportType = e.target.value;
            };
            LayerImport.prototype._onGetCapPanelClose = function () {
                this._clearGetCapParams();
                this._emptyGetCapResultsList();
            };
            LayerImport.prototype._onImportSubmit = function () {
                logger.log('import d\'une couche de type : ' + this._currentImportType);
                this.contentStatic = null;
                this.contentService = null;
                if (this._isCurrentImportTypeStatic) {
                    this._importStaticLayer();
                } else {
                    this._importServiceLayers();
                }
            };
            LayerImport.prototype._importStaticLayer = function () {
                var layerName;
                var staticImportNameInput = document.getElementById(this._addUID('GPimportName'));
                if (staticImportNameInput) {
                    layerName = staticImportNameInput.value;
                    logger.log('import layer name : ' + layerName);
                }
                if (this._currentStaticImportType === 'local') {
                    logger.log('import static layer from local file');
                    this._importStaticLayerFromLocalFile(layerName);
                } else if (this._currentStaticImportType === 'url') {
                    logger.log('import static layer from url');
                    this._importStaticLayerFromUrl(layerName);
                }
            };
            LayerImport.prototype._importStaticLayerFromUrl = function (layerName) {
                layerName = layerName || '';
                var url = this._staticUrlImportInput.value;
                logger.log('url : ', url);
                if (url.length === 0) {
                    console.log('[ol.control.LayerImport] url parameter is mandatory');
                    return;
                }
                if (url.trim) {
                    url = url.trim();
                }
                if (!this.options.webServicesOptions || !this.options.webServicesOptions.proxyUrl && !this.options.webServicesOptions.noProxyDomains) {
                    console.log('[ol.control.LayerImport] options.webServicesOptions.proxyUrl parameter is mandatory to request resources on another domain (cross-domain)');
                    return;
                }
                url = _ProxyUtils2.default.proxifyUrl(url, this.options.webServicesOptions);
                var context = this;
                _gp2.default.Protocols.XHR.call({
                    url: url,
                    method: 'GET',
                    timeOut: 15000,
                    onResponse: function onResponse(response) {
                        context._hideWaitingContainer();
                        context._addFeaturesFromImportStaticLayer(response, layerName);
                    },
                    onFailure: function onFailure(error) {
                        context._hideWaitingContainer();
                        console.log('[ol.control.LayerImport] KML/GPX/GeoJSON request failed : ', error);
                    }
                });
            };
            LayerImport.prototype._importStaticLayerFromLocalFile = function (layerName) {
                var file = this._staticLocalImportInput.files[0];
                if (!file) {
                    console.log('[ol.control.LayerImport] missing file');
                    return;
                }
                var fReader = new FileReader();
                var context = this;
                fReader.onerror = function (e) {
                    context._hideWaitingContainer();
                    logger.log('error fileReader : ', e);
                };
                fReader.onprogress = function () {
                    logger.log('onprogress');
                };
                fReader.onloadstart = function () {
                    context._displayWaitingContainer();
                    logger.log('onloadstart');
                };
                fReader.onabort = function () {
                    context._hideWaitingContainer();
                    logger.log('onabort');
                };
                fReader.onloadend = function (e) {
                    logger.log('onloadend : ', e);
                };
                fReader.onload = function (e) {
                    logger.log('fileReader onload - file content : ', e.target.result);
                    context._hideWaitingContainer();
                    context._addFeaturesFromImportStaticLayer(e.target.result, layerName);
                };
                fReader.readAsText(file);
            };
            LayerImport.prototype._addFeaturesFromImportStaticLayer = function (fileContent, layerName) {
                var map = this.getMap();
                if (!map || !fileContent) {
                    return;
                }
                this.contentStatic = fileContent;
                var format;
                var vectorStyle;
                if (this._currentImportType === 'KML') {
                    format = new _KML2.default({
                        showPointNames: this.options.vectorStyleOptions.KML.showPointNames,
                        extractStyles: this.options.vectorStyleOptions.KML.extractStyles,
                        defaultStyle: [this.options.vectorStyleOptions.KML.defaultStyle]
                    });
                    vectorStyle = this.options.vectorStyleOptions.KML.defaultStyle;
                } else if (this._currentImportType === 'GPX') {
                    format = new _ol2.default.format.GPX();
                    vectorStyle = this.options.vectorStyleOptions.GPX.defaultStyle;
                } else if (this._currentImportType === 'GeoJSON') {
                    format = new _ol2.default.format.GeoJSON();
                    vectorStyle = this.options.vectorStyleOptions.GeoJSON.defaultStyle;
                }
                var fileProj = format.readProjection(fileContent);
                var mapProj = this._getMapProjectionCode();
                var features = null;
                features = format.readFeatures(fileContent, {
                    dataProjection: fileProj,
                    featureProjection: mapProj
                });
                logger.log('loaded features : ', features);
                var vectorSource = new _ol2.default.source.Vector({ features: new _ol2.default.Collection() });
                vectorSource.addFeatures(features);
                logger.trace(vectorSource);
                if (layerName) {
                    vectorSource._title = vectorSource._description = layerName;
                } else {
                    if (format.readName && format.readName(fileContent)) {
                        vectorSource._title = vectorSource._description = format.readName(fileContent);
                    } else {
                        vectorSource._title = vectorSource._description = 'Import ' + this._currentImportType;
                        logger.log('[ol.control.LayerImport] set default name "Import ' + this._currentImportType + '"');
                    }
                }
                var vectorLayer = new _ol2.default.layer.Vector({
                    source: vectorSource,
                    style: vectorStyle
                });
                vectorLayer.gpResultLayerId = 'layerimport:' + this._currentImportType;
                map.addLayer(vectorLayer);
                if (map.getView() && map.getSize() && vectorSource.getExtent) {
                    var sourceExtent = vectorSource.getExtent();
                    if (sourceExtent && sourceExtent[0] !== Infinity) {
                        map.getView().fit(vectorSource.getExtent(), map.getSize());
                    }
                }
            };
            LayerImport.prototype._addFeaturesFromImportStaticLayerUrl = function (url, layerName) {
                var map = this.getMap();
                if (!map || !url) {
                    return;
                }
                var format;
                if (this._currentImportType === 'KML') {
                    format = new _KML2.default({
                        showPointNames: true,
                        extractStyles: this.options.vectorStyleOptions.KML.extractStyles,
                        defaultStyle: [this.options.vectorStyleOptions.KML.defaultStyle]
                    });
                } else if (this._currentImportType === 'GPX') {
                    format = new _ol2.default.format.GPX();
                } else if (this._currentImportType === 'GeoJSON') {
                    format = new _ol2.default.format.GeoJSON();
                }
                var vectorSource = new _ol2.default.source.Vector({
                    url: url,
                    format: format
                });
                if (this._currentImportType === 'GPX') {
                    vectorSource.forEachFeature(function (feature) {
                        if (feature.getStyle() == null) {
                            logger.log('[ol.control.LayerImport] set default style for GPX feature');
                            feature.setStyle(this.options.vectorStyleOptions.GPX.defaultStyle);
                        }
                    });
                }
                if (this._currentImportType === 'GeoJSON') {
                    vectorSource.forEachFeature(function (feature) {
                        if (feature.getStyle() == null) {
                            logger.log('[ol.control.LayerImport] set default style for GeoJSON feature');
                            feature.setStyle(this.options.vectorStyleOptions.GeoJSON.defaultStyle);
                        }
                    });
                }
                if (layerName) {
                    vectorSource._title = vectorSource._description = layerName;
                } else {
                    vectorSource._title = vectorSource._description = 'Import ' + this._currentImportType;
                }
                var vectorLayer = new _ol2.default.layer.Vector({ source: vectorSource });
                vectorLayer.gpResultLayerId = 'layerimport:' + this._currentImportType;
                map.addLayer(vectorLayer);
                if (map.getView() && map.getSize() && vectorSource.getExtent) {
                    var sourceExtent = vectorSource.getExtent();
                    if (sourceExtent && sourceExtent[0] !== Infinity) {
                        map.getView().fit(vectorSource.getExtent(), map.getSize());
                    }
                }
            };
            LayerImport.prototype._importServiceLayers = function () {
                if (this._currentImportType === 'WFS') {
                    console.log('[ol.control.LayerImport] WFS layer import is not implemented yet');
                    return;
                }
                this._emptyGetCapResultsList();
                var url = this._getCapRequestUrl = this._serviceUrlImportInput.value;
                if (!url) {
                    console.log('[ol.control.LayerImport] url parameter is mandatory');
                    return;
                }
                logger.log('url : ', url);
                if (url.trim) {
                    url = url.trim();
                }
                var questionMarkIndex = url.indexOf('?');
                if (questionMarkIndex < 0) {
                    url += '?SERVICE=' + this._currentImportType + '&REQUEST=GetCapabilities';
                } else if (questionMarkIndex === url.length - 1) {
                    url += 'SERVICE=' + this._currentImportType + '&REQUEST=GetCapabilities';
                }
                if (!this.options.webServicesOptions || !this.options.webServicesOptions.proxyUrl && !this.options.webServicesOptions.noProxyDomains) {
                    console.log('[ol.control.LayerImport] options.webServicesOptions.proxyUrl parameter is mandatory to request web service layers (getcapabilities request)');
                    return;
                }
                var proxyUrl = this.options.webServicesOptions.proxyUrl;
                var noProxyDomains = this.options.webServicesOptions.noProxyDomains;
                var bfound = false;
                if (noProxyDomains && Array.isArray(noProxyDomains) && noProxyDomains.length > 0) {
                    for (var i in noProxyDomains) {
                        logger.log('analyzing ' + noProxyDomains[i]);
                        if (url.indexOf(noProxyDomains[i]) !== -1) {
                            logger.log(url + ' found in noProxyDomains list (' + noProxyDomains[i] + ').');
                            bfound = true;
                        }
                    }
                }
                if (bfound === false) {
                    url = proxyUrl + encodeURIComponent(url);
                }
                this._displayWaitingContainer();
                var context = this;
                _gp2.default.Protocols.XHR.call({
                    url: url,
                    method: 'GET',
                    timeOut: 15000,
                    onResponse: function onResponse(response) {
                        context._hideWaitingContainer();
                        context._displayGetCapResponseLayers.call(context, response);
                    },
                    onFailure: function onFailure(error) {
                        context._hideWaitingContainer();
                        console.log('[ol.control.LayerImport] getCapabilities request failed : ', error);
                    }
                });
            };
            LayerImport.prototype._displayGetCapResponseLayers = function (xmlResponse) {
                var parser;
                var layers;
                var layerDescription;
                var projection;
                this._getCapResponseWMSLayers = [];
                this.contentService = xmlResponse;
                this._importPanel.style.display = 'none';
                this._getCapPanel.style.display = 'block';
                if (this._currentImportType === 'WMS') {
                    parser = new _ol2.default.format.WMSCapabilities();
                    if (!parser) {
                        return;
                    }
                    var getCapResponseWMS = this._getCapResponseWMS = parser.read(xmlResponse);
                    logger.log('getCapabilities response : ', getCapResponseWMS);
                    if (getCapResponseWMS && getCapResponseWMS.Capability && getCapResponseWMS.Capability.Layer) {
                        var getCapLayer = getCapResponseWMS.Capability.Layer;
                        if (Array.isArray(getCapLayer)) {
                            for (var i = 0; i < getCapLayer.length; i++) {
                                this._displayGetCapResponseWMSLayer(getCapLayer[i]);
                            }
                        } else {
                            this._displayGetCapResponseWMSLayer(getCapLayer);
                        }
                    }
                } else if (this._currentImportType === 'WMTS') {
                    parser = new _ol2.default.format.WMTSCapabilities();
                    if (!parser) {
                        return;
                    }
                    var getCapResponseWMTS = this._getCapResponseWMTS = parser.read(xmlResponse);
                    logger.log('getCapabilities response : ', getCapResponseWMTS);
                    if (getCapResponseWMTS && getCapResponseWMTS.Contents && getCapResponseWMTS.Contents.Layer) {
                        layers = getCapResponseWMTS.Contents.Layer;
                        if (Array.isArray(layers)) {
                            this._getCapResponseWMTSLayers = layers;
                            for (var j = 0; j < layers.length; j++) {
                                projection = this._getWMTSLayerProjection(layers[j], getCapResponseWMTS);
                                if (projection && typeof projection === 'string') {
                                    if (_ol2.default.proj.get(projection) || _ol2.default.proj.get(projection.toUpperCase())) {
                                        layerDescription = layers[j].Title;
                                        if (this._getCapResultsListContainer) {
                                            this._getCapResultsListContainer.appendChild(this._createImportGetCapResultElement(layerDescription, j));
                                        }
                                    } else {
                                        console.log('[ol.control.LayerImport] wmts layer cannot be added to map : unknown projection', layers[j]);
                                        continue;
                                    }
                                }
                            }
                        }
                    }
                }
            };
            LayerImport.prototype._displayGetCapResponseWMSLayer = function (layerObj, parentLayersInfos) {
                if (!layerObj) {
                    console.log('[ol.control.LayerImport] _displayGetCapResponseWMSLayer : getCapabilities layer object not found');
                } else {
                    logger.log('[ol.control.LayerImport] _displayGetCapResponseWMSLayer - layerObj : ', layerObj);
                }
                var mapProjCode = this._getMapProjectionCode();
                var projection;
                var layerDescription;
                if (parentLayersInfos) {
                    var key;
                    var i;
                    var addKeys = [
                        'CRS',
                        'Style'
                    ];
                    for (i = 0; i < addKeys.length; i++) {
                        key = addKeys[i];
                        if (Array.isArray(parentLayersInfos[key]) && parentLayersInfos[key].length !== 0) {
                            if (Array.isArray(layerObj[key]) && layerObj[key].length !== 0) {
                                for (var n = 0; n < parentLayersInfos[key]; n++) {
                                    if (layerObj[key].indexOf(parentLayersInfos[key][n]) === -1) {
                                        layerObj[key].push(parentLayersInfos[key][n]);
                                    }
                                }
                            } else {
                                layerObj[key] = parentLayersInfos[key];
                            }
                        }
                    }
                    var replaceKeys = [
                        'BoundingBox',
                        'EX_GeographicBoundingBox',
                        'MaxScaleDenominator',
                        'MinScaleDenominator',
                        'Attribution',
                        'Dimension',
                        'queryable',
                        'cascaded',
                        'opaque',
                        'noSubsets',
                        'fixedWidth',
                        'fixedHeight'
                    ];
                    for (i = 0; i < replaceKeys.length; i++) {
                        key = replaceKeys[i];
                        if (parentLayersInfos[key] && !layerObj[key]) {
                            layerObj[key] = parentLayersInfos[key];
                        }
                    }
                    if (!parentLayersInfos._isRootLayer && parentLayersInfos.Title) {
                        layerObj.Title = parentLayersInfos.Title + ' > ' + layerObj.Title;
                    }
                } else {
                    layerObj._isRootLayer = true;
                }
                if (layerObj.Layer) {
                    if (Array.isArray(layerObj.Layer)) {
                        for (var j = 0; j < layerObj.Layer.length; j++) {
                            this._displayGetCapResponseWMSLayer(layerObj.Layer[j], layerObj);
                        }
                    }
                } else {
                    var lastIndex = this._getCapResponseWMSLayers.length;
                    projection = this._getWMSLayerProjection(layerObj, mapProjCode);
                    if (!projection) {
                        console.log('[ol.control.LayerImport] wms layer cannot be added to map : unknown projection', layerObj);
                    } else {
                        layerObj._projection = projection;
                        layerDescription = layerObj.Title;
                        if (this._getCapResultsListContainer) {
                            this._getCapResultsListContainer.appendChild(this._createImportGetCapResultElement(layerDescription, lastIndex));
                        }
                        this._getCapResponseWMSLayers[lastIndex] = layerObj;
                    }
                }
            };
            LayerImport.prototype._onGetCapResponseLayerClick = function (e) {
                if (e.target && e.target.id) {
                    var proposalId = parseInt(e.target.id.substr(23), 10);
                    if (proposalId == null) {
                        return;
                    }
                    var layerInfo;
                    if (this._currentImportType === 'WMS') {
                        layerInfo = this._getCapResponseWMSLayers[proposalId];
                        this._addGetCapWMSLayer(layerInfo);
                    } else if (this._currentImportType === 'WMTS') {
                        layerInfo = this._getCapResponseWMTSLayers[proposalId];
                        this._addGetCapWMTSLayer(layerInfo);
                    }
                }
            };
            LayerImport.prototype._addGetCapWMSLayer = function (layerInfo) {
                var map = this.getMap();
                if (!map) {
                    console.log('[ol.control.LayerImport] _addGetCapWMSLayer error : map is not defined');
                    return;
                }
                if (!layerInfo) {
                    console.log('[ol.control.LayerImport] _addGetCapWMSLayer error : layerInfo is not defined');
                    return;
                }
                var mapProjCode = this._getMapProjectionCode();
                var wmsSourceOptions = {};
                var getMapUrl = this._getWMSLayerGetMapUrl();
                if (getMapUrl) {
                    wmsSourceOptions.url = getMapUrl;
                } else {
                    var questionMarkIndex = this._getCapRequestUrl.indexOf('?');
                    if (questionMarkIndex !== -1) {
                        wmsSourceOptions.url = this._getCapRequestUrl.substring(0, questionMarkIndex);
                    } else {
                        wmsSourceOptions.url = this._getCapRequestUrl;
                    }
                }
                wmsSourceOptions.params = {};
                if (layerInfo.Name) {
                    wmsSourceOptions.params['LAYERS'] = layerInfo.Name;
                } else {
                    console.log('[ol.control.LayerImport] unable to add wms layer : mandatory layer \'name\' parameter cannot be found', layerInfo);
                    return;
                }
                wmsSourceOptions.params['SERVICE'] = 'WMS';
                if (this._getCapResponseWMS.version) {
                    wmsSourceOptions.params['VERSION'] = this._getCapResponseWMS.version;
                }
                var projection = layerInfo._projection;
                if (!projection) {
                    console.log('[ol.control.LayerImport] wms layer cannot be added to map : unknown projection');
                    return;
                } else if (projection !== mapProjCode) {
                    wmsSourceOptions.projection = projection;
                }
                var legend;
                if (layerInfo.Style && Array.isArray(layerInfo.Style)) {
                    var style = layerInfo.Style[0];
                    wmsSourceOptions.params['STYLES'] = style.Name;
                    if (style.LegendURL && Array.isArray(style.LegendURL) && style.LegendURL.length !== 0) {
                        legend = style.LegendURL[0].OnlineResource;
                    }
                }
                var wmsSource = new _ol2.default.source.TileWMS(wmsSourceOptions);
                this._getWMSLayerInfoForLayerSwitcher(layerInfo, legend, wmsSource);
                var layerTileOptions = {};
                layerTileOptions['source'] = wmsSource;
                this._getWMSLayerMinMaxResolution(layerInfo, mapProjCode, layerTileOptions);
                this._getWMSLayerExtent(layerInfo, mapProjCode, layerTileOptions);
                var wmsLayer = new _ol2.default.layer.Tile(layerTileOptions);
                wmsLayer.gpResultLayerId = 'layerimport:WMS';
                if (layerInfo.queryable) {
                    wmsLayer.gpGFIparams = { queryable: true };
                    if (this._getCapResponseWMS && this._getCapResponseWMS.Capability && this._getCapResponseWMS.Capability.Request && this._getCapResponseWMS.Capability.Request.GetFeatureInfo && this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format && Array.isArray(this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format)) {
                        wmsLayer.gpGFIparams.formats = this._getCapResponseWMS.Capability.Request.GetFeatureInfo.Format;
                    }
                }
                map.addLayer(wmsLayer);
            };
            LayerImport.prototype._getWMSLayerGetMapUrl = function () {
                var getmapurl;
                if (this._getCapResponseWMS && this._getCapResponseWMS.Capability && this._getCapResponseWMS.Capability.Request && this._getCapResponseWMS.Capability.Request.GetMap) {
                    var getmap = this._getCapResponseWMS.Capability.Request.GetMap;
                    if (getmap.DCPType && Array.isArray(getmap.DCPType) && getmap.DCPType.length !== 0) {
                        var url = getmap.DCPType[0];
                        if (url && url.HTTP && url.HTTP.Get) {
                            getmapurl = url.HTTP.Get.OnlineResource;
                        }
                    }
                }
                return getmapurl;
            };
            LayerImport.prototype._getWMSLayerProjection = function (layerInfo, mapProjCode) {
                var projection;
                if (!layerInfo || (typeof layerInfo === 'undefined' ? 'undefined' : _typeof(layerInfo)) !== 'object') {
                    logger.log('missing layer information (from getCapabilities)');
                    return;
                }
                var CRSList = layerInfo.CRS;
                if (Array.isArray(CRSList)) {
                    for (var i = 0; i < CRSList.length; i++) {
                        var layerCRS = CRSList[i];
                        if (layerCRS === mapProjCode) {
                            projection = layerCRS;
                            break;
                        } else {
                            if (layerCRS && typeof layerCRS === 'string') {
                                if (_ol2.default.proj.get(layerCRS) || _ol2.default.proj.get(layerCRS.toUpperCase())) {
                                    projection = layerCRS;
                                    break;
                                }
                            }
                        }
                    }
                }
                return projection;
            };
            LayerImport.prototype._getWMSLayerMinMaxResolution = function (layerInfo, mapProjCode, layerTileOptions) {
                var mapUnits = _ol2.default.proj.get(mapProjCode).getUnits();
                if (mapUnits === 'm') {
                    if (layerInfo.MinScaleDenominator) {
                        layerTileOptions.minResolution = layerInfo.MinScaleDenominator * 0.00028;
                    }
                    if (layerInfo.MaxScaleDenominator) {
                        layerTileOptions.maxResolution = layerInfo.MaxScaleDenominator * 0.00028;
                    }
                } else if (mapUnits === 'degrees') {
                    var cste = 0.00028 * 180 / (Math.PI * 6378137);
                    if (layerInfo.MinScaleDenominator) {
                        layerTileOptions.minResolution = layerInfo.MinScaleDenominator * cste;
                    }
                    if (layerInfo.MaxScaleDenominator) {
                        layerTileOptions.maxResolution = layerInfo.MaxScaleDenominator * cste;
                    }
                }
            };
            LayerImport.prototype._getWMSLayerExtent = function (layerInfo, mapProjCode, layerTileOptions) {
                if (!layerInfo) {
                    console.log('[ol.control.LayerImport] _getWMSLayerExtent error : layerInfo is not defined');
                    return;
                }
                var exGeographicBoundingBox = layerInfo['EX_GeographicBoundingBox'];
                var boundingBox = layerInfo.BoundingBox;
                if (exGeographicBoundingBox && Array.isArray(exGeographicBoundingBox)) {
                    if (mapProjCode === 'EPSG:4326') {
                        layerTileOptions.extent = exGeographicBoundingBox;
                    } else {
                        layerTileOptions.extent = _ol2.default.proj.transformExtent(exGeographicBoundingBox, 'EPSG:4326', mapProjCode);
                    }
                } else if (boundingBox && Array.isArray(boundingBox)) {
                    var crs;
                    var extent;
                    for (var i = 0; i < boundingBox.length; i++) {
                        crs = boundingBox[i].crs;
                        extent = boundingBox[i].extent;
                        if (crs) {
                            if (crs === mapProjCode) {
                                layerTileOptions.extent = extent;
                                break;
                            } else {
                                if (crs && typeof crs === 'string') {
                                    var olProj = _ol2.default.proj.get(crs) ? _ol2.default.proj.get(crs) : _ol2.default.proj.get(crs.toUpperCase());
                                    if (olProj) {
                                        if (olProj.getUnits() === 'degrees' && crs.toUpperCase().indexOf('EPSG') === 0) {
                                            var reversedExtent = [
                                                extent[1],
                                                extent[0],
                                                extent[3],
                                                extent[2]
                                            ];
                                            layerTileOptions.extent = _ol2.default.proj.transformExtent(reversedExtent, olProj, mapProjCode);
                                        } else {
                                            layerTileOptions.extent = _ol2.default.proj.transformExtent(extent, olProj, mapProjCode);
                                        }
                                        break;
                                    }
                                }
                            }
                        }
                    }
                }
            };
            LayerImport.prototype._getWMSLayerInfoForLayerSwitcher = function (layerInfo, legend, wmsSource) {
                if (layerInfo.Title) {
                    wmsSource._title = layerInfo.Title;
                    wmsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Title;
                } else {
                    wmsSource._title = layerInfo.Name;
                    wmsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Name;
                }
                if (legend) {
                    wmsSource._legends = [{ url: legend }];
                }
                if (layerInfo.MetadataURL && Array.isArray(layerInfo.MetadataURL)) {
                    wmsSource._metadata = [];
                    for (var i = 0; i < layerInfo.MetadataURL.length; i++) {
                        var metadata = layerInfo.MetadataURL[i].OnlineResource;
                        if (metadata) {
                            wmsSource._metadata.push({ url: metadata });
                        }
                    }
                }
                if (layerInfo.Attribution) {
                    var attribution = layerInfo.Attribution;
                    wmsSource._originators = {};
                    if (attribution.OnlineResource) {
                        wmsSource._originators.url = attribution.OnlineResource;
                    }
                    if (attribution.Title) {
                        wmsSource._originators.name = wmsSource._originators.attribution = attribution.Title;
                    }
                    if (attribution.LogoURL && attribution.LogoURL.OnlineResource) {
                        wmsSource._originators.logo = attribution.LogoURL.OnlineResource;
                    }
                }
            };
            LayerImport.prototype._addGetCapWMTSLayer = function (layerInfo) {
                if (!layerInfo || !layerInfo.Identifier) {
                    console.log('[ol.control.LayerImport] layer information not found in getCapabilities response for layer ');
                    return;
                }
                var map = this.getMap();
                if (!map) {
                    return;
                }
                var wmtsSourceOptions = {};
                wmtsSourceOptions.layer = layerInfo.Identifier;
                if (this._getCapResponseWMTS.version) {
                    wmtsSourceOptions.version = this._getCapResponseWMTS.version;
                }
                var getMapUrl = this._getWMTSLayerGetTileUrl();
                if (getMapUrl) {
                    wmtsSourceOptions.url = getMapUrl;
                } else {
                    var questionMarkIndex = this._getCapRequestUrl.indexOf('?');
                    if (questionMarkIndex !== -1) {
                        wmtsSourceOptions.url = this._getCapRequestUrl.substring(0, questionMarkIndex);
                    } else {
                        wmtsSourceOptions.url = this._getCapRequestUrl;
                    }
                }
                var tmsOptions = this._getTMSParams(layerInfo);
                wmtsSourceOptions.matrixSet = tmsOptions.tms;
                wmtsSourceOptions.projection = tmsOptions.projCode;
                wmtsSourceOptions.tileGrid = new _ol2.default.tilegrid.WMTS({
                    resolutions: tmsOptions.resolutions,
                    matrixIds: tmsOptions.matrixIds,
                    origin: tmsOptions.origin
                });
                var defaultStyle;
                var legend;
                if (layerInfo.Style && Array.isArray(layerInfo.Style)) {
                    var style;
                    for (var s = 0; s < layerInfo.Style.length; s++) {
                        style = layerInfo.Style[s];
                        defaultStyle = style.Identifier;
                        if (style.isDefault) {
                            break;
                        }
                        if (style.LegendURL && Array.isArray(style.LegendURL) && style.LegendURL.length !== 0) {
                            legend = style.LegendURL[0].href;
                        }
                    }
                }
                if (defaultStyle == null) {
                    console.log('[ol.control.LayerImport] style information not found in getCapabilities response for layer ' + layerInfo.Identifier);
                }
                wmtsSourceOptions.style = defaultStyle;
                var format;
                if (layerInfo.Format && Array.isArray(layerInfo.Format)) {
                    format = layerInfo.Format[0];
                }
                if (format == null) {
                    console.log('[ol.control.LayerImport] format information not found in getCapabilities response for layer ' + layerInfo.Identifier);
                }
                wmtsSourceOptions.format = format;
                var wmtsSource = new _ol2.default.source.WMTS(wmtsSourceOptions);
                if (layerInfo.Title) {
                    wmtsSource._title = layerInfo.Title;
                    wmtsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Title;
                } else {
                    wmtsSource._title = layerInfo.Identifier;
                    wmtsSource._description = layerInfo.Abstract ? layerInfo.Abstract : layerInfo.Identifier;
                }
                if (legend) {
                    wmtsSource._legends = [{ url: legend }];
                }
                var layerTileOptions = {};
                layerTileOptions.source = wmtsSource;
                layerTileOptions.extent = this._getWMTSLayerExtent(layerInfo);
                var wmtsLayer;
                try {
                    wmtsLayer = new _ol2.default.layer.Tile(layerTileOptions);
                } catch (e) {
                    console.log('[ol.control.LayerImport] an error occured while trying to create ol.layer.Tile from getCapabilities information. error : ', e);
                    return;
                }
                wmtsLayer.gpResultLayerId = 'layerimport:WMTS';
                map.addLayer(wmtsLayer);
            };
            LayerImport.prototype._getWMTSLayerGetTileUrl = function () {
                var gettileurl;
                if (this._getCapResponseWMTS && this._getCapResponseWMTS.OperationsMetadata && this._getCapResponseWMTS.OperationsMetadata.GetTile) {
                    var gettile = this._getCapResponseWMTS.OperationsMetadata.GetTile;
                    if (gettile.DCP && gettile.DCP.HTTP && gettile.DCP.HTTP.Get && Array.isArray(gettile.DCP.HTTP.Get) && gettile.DCP.HTTP.Get.length !== 0) {
                        gettileurl = gettile.DCP.HTTP.Get[0].href;
                    }
                }
                return gettileurl;
            };
            LayerImport.prototype._getWMTSLayerProjection = function (layerInfo, getCapResponseWMTS) {
                var projection;
                if (!layerInfo || (typeof layerInfo === 'undefined' ? 'undefined' : _typeof(layerInfo)) !== 'object') {
                    logger.log('missing layer information (from getCapabilities)');
                    return;
                }
                if (!getCapResponseWMTS || (typeof getCapResponseWMTS === 'undefined' ? 'undefined' : _typeof(getCapResponseWMTS)) !== 'object') {
                    logger.log('missing getCapabilities response');
                    return;
                }
                if (layerInfo.TileMatrixSetLink && Array.isArray(layerInfo.TileMatrixSetLink)) {
                    var tms = layerInfo.TileMatrixSetLink[0].TileMatrixSet;
                    var crs;
                    if (getCapResponseWMTS.Contents && Array.isArray(getCapResponseWMTS.Contents.TileMatrixSet)) {
                        var tileMatrixSets = getCapResponseWMTS.Contents.TileMatrixSet;
                        for (var i = 0; i < tileMatrixSets.length; i++) {
                            if (tileMatrixSets[i].Identifier === tms && tileMatrixSets[i].TileMatrix) {
                                var tileMatrixSet = tileMatrixSets[i];
                                crs = tileMatrixSet.SupportedCRS;
                                if (crs && typeof crs === 'string') {
                                    if (_ol2.default.proj.get(crs) || _ol2.default.proj.get(crs.toUpperCase())) {
                                        projection = crs;
                                    }
                                }
                                break;
                            }
                        }
                    }
                }
                return projection;
            };
            LayerImport.prototype._getTMSParams = function (layerInfo) {
                var tmsOptions = {};
                var matrixIds = [];
                var resolutions = [];
                var origin = [];
                var tms;
                var projCode;
                var projection;
                var map = this.getMap();
                if (!map) {
                    return;
                }
                if (layerInfo.TileMatrixSetLink && Array.isArray(layerInfo.TileMatrixSetLink)) {
                    tms = layerInfo.TileMatrixSetLink[0].TileMatrixSet;
                    if (this._getCapResponseWMTS.Contents && Array.isArray(this._getCapResponseWMTS.Contents.TileMatrixSet)) {
                        var tileMatrixSets = this._getCapResponseWMTS.Contents.TileMatrixSet;
                        for (var i = 0; i < tileMatrixSets.length; i++) {
                            if (tileMatrixSets[i].Identifier === tms && tileMatrixSets[i].TileMatrix) {
                                var tileMatrixSet = tileMatrixSets[i];
                                var tilematrix;
                                var id;
                                var scaledenominator;
                                var resolution;
                                var units;
                                if (tileMatrixSet.SupportedCRS) {
                                    projCode = tileMatrixSet.SupportedCRS;
                                    projection = _ol2.default.proj.get(projCode);
                                }
                                if (projection && projection.getUnits) {
                                    units = projection.getUnits();
                                }
                                if (Array.isArray(tileMatrixSet.TileMatrix)) {
                                    for (var j = 0; j < tileMatrixSet.TileMatrix.length; j++) {
                                        tilematrix = tileMatrixSet.TileMatrix[j];
                                        if (tilematrix.Identifier != null) {
                                            id = parseInt(tilematrix.Identifier, 10);
                                            matrixIds.push(id);
                                        }
                                        scaledenominator = tilematrix.ScaleDenominator;
                                        if (units === 'degrees') {
                                            resolution = scaledenominator * 0.00028 * 180 / (Math.PI * 6378137);
                                        } else {
                                            resolution = scaledenominator * 0.00028;
                                        }
                                        resolutions.push(resolution);
                                        origin = tilematrix.TopLeftCorner;
                                    }
                                }
                                if (Array.isArray(resolutions) && resolutions.sort !== undefined) {
                                    resolutions.sort(function (x, y) {
                                        return y - x;
                                    });
                                }
                                if (Array.isArray(matrixIds) && matrixIds.sort !== undefined) {
                                    matrixIds.sort(function (x, y) {
                                        return x - y;
                                    });
                                }
                            }
                        }
                    } else {
                        console.log('[ol.control.LayerImport] TileMatrixSet data not found in getCapabilities response for layer ' + layerInfo.Identifier);
                    }
                } else {
                    return;
                }
                tmsOptions.tms = tms;
                tmsOptions.projCode = projCode;
                tmsOptions.matrixIds = matrixIds;
                tmsOptions.resolutions = resolutions;
                tmsOptions.origin = origin;
                return tmsOptions;
            };
            LayerImport.prototype._getWMTSLayerExtent = function (layerInfo) {
                var extent;
                var mapProjCode = this._getMapProjectionCode();
                if (layerInfo.WGS84BoundingBox && Array.isArray(layerInfo.WGS84BoundingBox)) {
                    extent = _ol2.default.proj.transformExtent(layerInfo.WGS84BoundingBox, 'EPSG:4326', mapProjCode);
                }
                return extent;
            };
            LayerImport.prototype._getMapProjectionCode = function () {
                var map = this.getMap();
                if (!map || !map.getView || !map.getView().getProjection) {
                    logger.log('unable to get layerimport\'s map');
                    return;
                }
                var mapProjCode = map.getView().getProjection().getCode();
                return mapProjCode;
            };
            LayerImport.prototype._displayWaitingContainer = function () {
                this._waitingContainer.className = 'GPimportWaitingContainerVisible';
                this._waiting = true;
                if (this._timer) {
                    clearTimeout(this._timer);
                    this._timer = null;
                }
                var context = this;
                this._timer = setTimeout(function () {
                    if (context._waiting === true) {
                        context._hideWaitingContainer();
                    } else {
                        if (context._timer) {
                            clearTimeout(context._timer);
                        }
                    }
                }, 16000);
            };
            LayerImport.prototype._hideWaitingContainer = function () {
                if (this._waiting) {
                    this._waitingContainer.className = 'GPimportWaitingContainerHidden';
                    this._waiting = false;
                    clearTimeout(this._timer);
                    this._timer = null;
                }
            };
            LayerImport.prototype._clearGetCapParams = function () {
                this._getCapRequestUrl = null;
                this._getCapResponseWMS = null;
                this._getCapResponseWMTS = null;
                this._getCapResponseWMSLayers = null;
                this._getCapResponseWMTSLayers = null;
            };
            LayerImport.prototype._emptyGetCapResultsList = function () {
                if (this._getCapResultsListContainer) {
                    while (this._getCapResultsListContainer.firstChild) {
                        this._getCapResultsListContainer.removeChild(this._getCapResultsListContainer.firstChild);
                    }
                }
            };
            exports.default = LayerImport;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var LayerImportDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPimport');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowImportElement: function _createShowImportElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowImport');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowImportPictoElement: function _createShowImportPictoElement() {
                    var self = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowImportPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowImport');
                    label.title = 'Ouvrir l\'import de couches';
                    if (label.addEventListener) {
                        label.addEventListener('click', function () {
                            self._onShowImportClick();
                        });
                    } else if (label.attachEvent) {
                        label.attachEvent('onclick', function () {
                            self._onShowImportClick();
                        });
                    }
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowImportOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                },
                _createImportPanelElement: function _createImportPanelElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPimportPanel');
                    div.className = 'GPpanel';
                    return div;
                },
                _createImportPanelHeaderElement: function _createImportPanelHeaderElement() {
                    var container = document.createElement('div');
                    container.className = 'GPpanelHeader';
                    var panelTitle = this._createImportPanelTitleElement();
                    container.appendChild(panelTitle);
                    var closeDiv = this._createImportPanelCloseElement();
                    container.appendChild(closeDiv);
                    return container;
                },
                _createImportPanelTitleElement: function _createImportPanelTitleElement() {
                    var div = document.createElement('div');
                    div.className = 'GPpanelTitle';
                    div.innerHTML = 'Import de données';
                    return div;
                },
                _createImportPanelCloseElement: function _createImportPanelCloseElement() {
                    var self = this;
                    var divClose = document.createElement('div');
                    divClose.id = this._addUID('GPimportPanelClose');
                    divClose.className = 'GPpanelClose';
                    divClose.title = 'Fermer le panneau';
                    if (divClose.addEventListener) {
                        divClose.addEventListener('click', function () {
                            document.getElementById(self._addUID('GPshowImportPicto')).click();
                        }, false);
                    } else if (divClose.attachEvent) {
                        divClose.attachEvent('onclick', function () {
                            document.getElementById(self._addUID('GPshowImportPicto')).click();
                        });
                    }
                    return divClose;
                },
                _createImportPanelFormElement: function _createImportPanelFormElement() {
                    var self = this;
                    var form = document.createElement('form');
                    form.id = this._addUID('GPimportForm');
                    form.className = 'map-tool-box';
                    if (form.addEventListener) {
                        form.addEventListener('submit', function (e) {
                            e.preventDefault();
                            self._onImportSubmit();
                        });
                    } else if (form.attachEvent) {
                        form.attachEvent('onsubmit', function (e) {
                            e.preventDefault();
                            self._onImportSubmit();
                        });
                    }
                    return form;
                },
                _createImportTypeLineElement: function _createImportTypeLineElement(importTypes) {
                    var context = this;
                    var div = document.createElement('div');
                    div.id = this._addUID('GPimportTypeLine');
                    div.className = 'GPimportInputLine';
                    var label = document.createElement('label');
                    label.htmlFor = this._addUID('GPimportType');
                    label.className = 'GPimportLabel';
                    label.innerHTML = 'Type de donnée';
                    label.title = 'Type de donnée';
                    div.appendChild(label);
                    var select = document.createElement('select');
                    select.className = 'GPimportSelect';
                    if (select.addEventListener) {
                        select.addEventListener('change', function (e) {
                            if (this.value === 'KML' || this.value === 'GPX' || this.value === 'GeoJSON') {
                                document.getElementById(context._addUID('GPimportStaticParams')).className = 'GPimportVisibleParams';
                                document.getElementById(context._addUID('GPimportServiceParams')).className = 'GPimportHiddenParams';
                            } else if (this.value === 'WMS' || this.value === 'WMTS' || this.value === 'WFS') {
                                document.getElementById(context._addUID('GPimportServiceParams')).className = 'GPimportVisibleParams';
                                document.getElementById(context._addUID('GPimportStaticParams')).className = 'GPimportHiddenParams';
                            }
                            context._onImportTypeChange(e);
                        });
                    } else if (select.attachEvent) {
                        select.attachEvent('onchange', function () {
                            if (this.value === 'KML' || this.value === 'GPX' || this.value === 'GeoJSON') {
                                document.getElementById(context._addUID('GPimportStaticParams')).className = 'GPimportVisibleParams';
                                document.getElementById(context._addUID('GPimportServiceParams')).className = 'GPimportHiddenParams';
                            } else if (this.value === 'WMS' || this.value === 'WMTS' || this.value === 'WFS') {
                                document.getElementById(context._addUID('GPimportServiceParams')).className = 'GPimportVisibleParams';
                                document.getElementById(context._addUID('GPimportStaticParams')).className = 'GPimportHiddenParams';
                            }
                            context._onImportTypeChange();
                        });
                    }
                    select.id = this._addUID('GPimportType');
                    if (!importTypes || !Array.isArray(importTypes)) {
                        importTypes = [
                            'KML',
                            'GPX',
                            'GeoJSON',
                            'WMS',
                            'WMTS',
                            'WFS'
                        ];
                    }
                    var option;
                    for (var i = 0; i < importTypes.length; i++) {
                        option = document.createElement('option');
                        option.value = importTypes[i];
                        option.text = importTypes[i];
                        select.appendChild(option);
                    }
                    div.appendChild(select);
                    return div;
                },
                _createImportWaitingElement: function _createImportWaitingElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPimportWaitingContainer');
                    div.className = 'GPimportWaitingContainerHidden';
                    var p = document.createElement('p');
                    p.className = 'GPimportWaiting';
                    p.innerHTML = 'Recherche en cours...';
                    div.appendChild(p);
                    return div;
                },
                _createImportStaticParamsContainer: function _createImportStaticParamsContainer(currentType) {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPimportStaticParams');
                    if (currentType === 'KML' || currentType === 'GPX' || currentType === 'GeoJSON') {
                        div.className = 'GPimportVisibleParams';
                    } else {
                        div.className = 'GPimportHiddenParams';
                    }
                    return div;
                },
                _createStaticNameLabel: function _createStaticNameLabel() {
                    var div = document.createElement('div');
                    div.className = 'GPimportInputLine';
                    var label = document.createElement('label');
                    label.className = 'GPimportLabel';
                    label.htmlFor = this._addUID('GPimportName');
                    label.innerHTML = 'Nom';
                    label.title = 'Nom';
                    div.appendChild(label);
                    var input = document.createElement('input');
                    input.type = 'text';
                    input.id = this._addUID('GPimportName');
                    input.className = 'GPimportInput';
                    div.appendChild(input);
                    return div;
                },
                _createStaticModeChoiceDiv: function _createStaticModeChoiceDiv() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPimportChoice');
                    return div;
                },
                _createStaticLocalChoiceDiv: function _createStaticLocalChoiceDiv() {
                    var context = this;
                    var div = document.createElement('div');
                    div.className = 'GPimportChoiceAlt';
                    var input = document.createElement('input');
                    input.type = 'radio';
                    if (input.addEventListener) {
                        input.addEventListener('change', function (e) {
                            document.getElementById(context._addUID('GPimportValueLocal')).className = 'GPimportInputLine';
                            document.getElementById(context._addUID('GPimportValueUrl')).className = 'GPimportValueHidden';
                            context._onStaticImportTypeChange(e);
                        });
                    } else if (input.appendChild) {
                        input.appendChild('onchange', function () {
                            document.getElementById(context._addUID('GPimportValueLocal')).className = 'GPimportInputLine';
                            document.getElementById(context._addUID('GPimportValueUrl')).className = 'GPimportValueHidden';
                            context._onStaticImportTypeChange();
                        });
                    }
                    input.name = 'GPimportChoiceMode';
                    input.value = 'local';
                    input.checked = true;
                    input.id = this._addUID('GPimportChoiceAltLocal');
                    div.appendChild(input);
                    var label = document.createElement('label');
                    label.className = 'GPimportChoiceAltTxt';
                    label.htmlFor = this._addUID('GPimportChoiceAltLocal');
                    label.innerHTML = 'par fichier local';
                    label.title = 'par fichier local';
                    div.appendChild(label);
                    return div;
                },
                _createStaticUrlChoiceDiv: function _createStaticUrlChoiceDiv() {
                    var context = this;
                    var div = document.createElement('div');
                    div.className = 'GPimportChoiceAlt';
                    var input = document.createElement('input');
                    input.type = 'radio';
                    if (input.addEventListener) {
                        input.addEventListener('change', function (e) {
                            document.getElementById(context._addUID('GPimportValueUrl')).className = 'GPimportInputLine';
                            document.getElementById(context._addUID('GPimportValueLocal')).className = 'GPimportValueHidden';
                            context._onStaticImportTypeChange(e);
                        });
                    } else if (input.appendChild) {
                        input.appendChild('onchange', function () {
                            document.getElementById(context._addUID('GPimportValueUrl')).className = 'GPimportInputLine';
                            document.getElementById(context._addUID('GPimportValueLocal')).className = 'GPimportValueHidden';
                            context._onStaticImportTypeChange();
                        });
                    }
                    input.id = this._addUID('GPimportChoiceAltUrl');
                    input.name = 'GPimportChoiceMode';
                    input.value = 'url';
                    input.checked = false;
                    div.appendChild(input);
                    var label = document.createElement('label');
                    label.className = 'GPimportChoiceAltTxt';
                    label.htmlFor = this._addUID('GPimportChoiceAltUrl');
                    label.innerHTML = 'par URL';
                    label.title = 'par URL';
                    div.appendChild(label);
                    return div;
                },
                _createStaticLocalInputDiv: function _createStaticLocalInputDiv() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPimportValueLocal');
                    div.className = 'GPimportInputLine';
                    return div;
                },
                _createStaticLocalInputLabel: function _createStaticLocalInputLabel() {
                    var label = document.createElement('label');
                    label.className = 'GPimportLabel';
                    label.htmlFor = this._addUID('GPimportFile');
                    label.innerHTML = 'Fichier local';
                    label.title = 'Fichier local';
                    return label;
                },
                _createStaticLocalInput: function _createStaticLocalInput() {
                    var input = document.createElement('input');
                    input.type = 'file';
                    input.id = this._addUID('GPimportFile');
                    input.className = 'GPimportInputFile';
                    return input;
                },
                _createStaticUrlInputDiv: function _createStaticUrlInputDiv() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPimportValueUrl');
                    div.className = 'GPimportValueHidden';
                    return div;
                },
                _createStaticUrlInputLabel: function _createStaticUrlInputLabel() {
                    var label = document.createElement('label');
                    label.className = 'GPimportLabel';
                    label.htmlFor = this._addUID('GPimportUrl');
                    label.innerHTML = 'URL';
                    label.title = 'URL';
                    return label;
                },
                _createStaticUrlInput: function _createStaticUrlInput() {
                    var input = document.createElement('input');
                    input.type = 'text';
                    input.id = this._addUID('GPimportUrl');
                    input.className = 'GPimportInput';
                    return input;
                },
                _createServiceParamsContainer: function _createServiceParamsContainer(currentType) {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPimportServiceParams');
                    if (currentType === 'WMS' || currentType === 'WMTS' || currentType === 'WFS') {
                        div.className = 'GPimportVisibleParams';
                    } else {
                        div.className = 'GPimportHiddenParams';
                    }
                    return div;
                },
                _createServiceUrlDiv: function _createServiceUrlDiv() {
                    var div = document.createElement('div');
                    div.className = 'GPimportInputLine';
                    return div;
                },
                _createServiceUrlInputLabel: function _createServiceUrlInputLabel() {
                    var label = document.createElement('label');
                    label.className = 'GPimportLabel';
                    label.htmlFor = this._addUID('GPimportServiceUrl');
                    label.innerHTML = 'URL du service';
                    label.title = 'URL du service';
                    return label;
                },
                _createServiceUrlInput: function _createServiceUrlInput() {
                    var input = document.createElement('input');
                    input.type = 'text';
                    input.id = this._addUID('GPimportServiceUrl');
                    input.className = 'GPimportInput';
                    return input;
                },
                _createImportSubmitFormElement: function _createImportSubmitFormElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPimportSubmit');
                    input.className = 'GPinputSubmit tool-form-submit';
                    input.type = 'submit';
                    input.value = 'Importer';
                    return input;
                },
                _createImportGetCapPanelElement: function _createImportGetCapPanelElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPimportGetCapPanel');
                    div.className = 'GPpanel';
                    return div;
                },
                _createImportGetCapPanelHeaderElement: function _createImportGetCapPanelHeaderElement() {
                    var context = this;
                    var container = document.createElement('div');
                    container.className = 'GPpanelHeader';
                    var panelTitle = document.createElement('div');
                    panelTitle.className = 'GPpanelTitle';
                    panelTitle.innerHTML = 'Couches accessibles';
                    panelTitle.title = 'Couches accessibles';
                    container.appendChild(panelTitle);
                    var closeDiv = document.createElement('div');
                    if (closeDiv.addEventListener) {
                        closeDiv.addEventListener('click', function () {
                            document.getElementById(context._addUID('GPimportGetCapPanel')).style.display = 'none';
                            document.getElementById(context._addUID('GPimportPanel')).style.display = '';
                            context._onGetCapPanelClose();
                        });
                    } else if (closeDiv.attachEvent) {
                        closeDiv.attachEvent('click', function () {
                            document.getElementById(context._addUID('GPimportGetCapPanel')).style.display = 'none';
                            document.getElementById(context._addUID('GPimportPanel')).style.display = '';
                            context._onGetCapPanelClose();
                        });
                    }
                    closeDiv.className = 'GPpanelClose';
                    closeDiv.title = 'Fermer le panneau';
                    closeDiv.id = this._addUID('GPimportGetCapPanelClose');
                    container.appendChild(closeDiv);
                    return container;
                },
                _createImportGetCapResultsListElement: function _createImportGetCapResultsListElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPimportGetCapResults');
                    return container;
                },
                _createImportGetCapResultElement: function _createImportGetCapResultElement(layerDescription, id) {
                    var div = document.createElement('div');
                    div.className = 'GPimportGetCapProposal';
                    div.innerHTML = layerDescription;
                    div.title = layerDescription;
                    var context = this;
                    if (div.addEventListener) {
                        div.addEventListener('click', function (e) {
                            context._onGetCapResponseLayerClick(e);
                        });
                    } else if (div.attachEvent) {
                        div.attachEvent('onclick', function () {
                            context._onGetCapResponseLayerClick();
                        });
                    }
                    div.id = 'GPimportGetCapProposal_' + id;
                    return div;
                }
            };
            exports.default = LayerImportDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _LayerUtils = __webpack_require__(5);
            var _LayerUtils2 = _interopRequireDefault(_LayerUtils);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            function GeoportalAttribution(options) {
                if (!(this instanceof GeoportalAttribution)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                _ol2.default.control.Attribution.call(this, options);
            }
            _ol2.default.inherits(GeoportalAttribution, _ol2.default.control.Attribution);
            GeoportalAttribution.prototype = Object.create(_ol2.default.control.Attribution.prototype, {});
            GeoportalAttribution.prototype.constructor = GeoportalAttribution;
            GeoportalAttribution.prototype.setMap = function (map) {
                if (map != null) {
                    var ctrls = map.getControls();
                    ctrls.forEach(function (element) {
                        if (element instanceof _ol2.default.control.Attribution && !(element instanceof GeoportalAttribution)) {
                            this.remove(element);
                        }
                    }, ctrls);
                    this._updateAttributions(map);
                    var context = this;
                    map.on('moveend', function () {
                        context._updateAttributions(map);
                    }, this);
                    map.getLayers().on('add', function () {
                        context._updateAttributions(map);
                    }, this);
                    map.getLayers().on('remove', function () {
                        context._updateAttributions(map);
                    }, this);
                }
                _ol2.default.control.Attribution.prototype.setMap.call(this, map);
            };
            GeoportalAttribution.prototype._updateAttributions = function (map) {
                var mapAttributions = {};
                var view = map.getView();
                var extent = view.calculateExtent(map.getSize());
                var mapProjection = view.getProjection().getCode();
                var geoExtent = _ol2.default.proj.transformExtent(extent, mapProjection, 'EPSG:4326');
                var standardExtent = [
                    geoExtent[3],
                    geoExtent[0],
                    geoExtent[1],
                    geoExtent[2]
                ];
                var zoom = view.getZoom();
                var layers = map.getLayers().getArray();
                for (var i = 0; i < layers.length; i++) {
                    if (layers[i].getSource) {
                        this._updateLayerAttributions(layers[i], mapAttributions, standardExtent, mapProjection, zoom);
                    } else if (layers[i].getLayers) {
                        var lyrs = layers[i].getLayers();
                        var context = this;
                        lyrs.forEach(function (lyr) {
                            if (lyr.getSource) {
                                context._updateLayerAttributions(lyr, mapAttributions, standardExtent, mapProjection, zoom);
                            } else {
                                console.log('cannot find layer source in layergroup ', layers[i]);
                            }
                        });
                    }
                }
            };
            GeoportalAttribution.prototype._updateLayerAttributions = function (layer, mapAttributions, mapExtent, mapCrs, mapZoom) {
                var src = layer.getSource();
                var attributions = [];
                var visibility = layer.getVisible();
                var originators = src._originators;
                if (typeof originators !== 'undefined') {
                    src.setAttributions();
                }
                if (originators && visibility) {
                    var layerAttributions = _LayerUtils2.default.getAttributions({
                        extent: mapExtent,
                        crs: mapCrs,
                        zoom: mapZoom,
                        visibility: visibility,
                        originators: originators
                    });
                    for (var j = 0; j < layerAttributions.length; j++) {
                        var attributionj = layerAttributions[j];
                        if (!mapAttributions || !mapAttributions[attributionj]) {
                            attributions.push(new _ol2.default.Attribution({ html: attributionj }));
                            mapAttributions[attributionj] = true;
                        }
                    }
                    if (attributions.length !== 0) {
                        src.setAttributions(attributions);
                    }
                }
            };
            exports.default = GeoportalAttribution;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) {
                return typeof obj;
            } : function (obj) {
                return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj;
            };
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _gp = __webpack_require__(4);
            var _gp2 = _interopRequireDefault(_gp);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _CheckRightManagement = __webpack_require__(6);
            var _CheckRightManagement2 = _interopRequireDefault(_CheckRightManagement);
            var _Measures = __webpack_require__(13);
            var _Measures2 = _interopRequireDefault(_Measures);
            var _MeasureToolBox = __webpack_require__(14);
            var _MeasureToolBox2 = _interopRequireDefault(_MeasureToolBox);
            var _Interactions = __webpack_require__(19);
            var _Interactions2 = _interopRequireDefault(_Interactions);
            var _ElevationPathDOM = __webpack_require__(110);
            var _ElevationPathDOM2 = _interopRequireDefault(_ElevationPathDOM);
            var _ProfileElevationPathDOM = __webpack_require__(111);
            var _ProfileElevationPathDOM2 = _interopRequireDefault(_ProfileElevationPathDOM);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('elevationpath');
            function ElevationPath(options) {
                logger.trace('ElevationPath()');
                options = options || {};
                if (!(this instanceof ElevationPath)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this.CLASSNAME = 'ElevationPath';
                this._uid = _SelectorID2.default.generate();
                this._showContainer = null;
                this._pictoContainer = null;
                this._panelContainer = null;
                this._profileContainer = null;
                this._waitingContainer = null;
                this._infoContainer = null;
                this._timerHdlr = null;
                this._drawStyleStart = null;
                this._drawStyleFinish = null;
                this._markerStyle = null;
                this._profile = null;
                this._data = {};
                this._measureSource = null;
                this._measureVector = null;
                this._measureDraw = null;
                this._lastSketch = null;
                this._currentSketch = null;
                this._marker = null;
                this._noRightManagement = false;
                this._initialize(options);
                this._checkRightsManagement();
                var container = options.element ? options.element : this._initializeContainer();
                _ol2.default.control.Control.call(this, {
                    element: container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(ElevationPath, _ol2.default.control.Control);
            ElevationPath.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(ElevationPath.prototype, _ElevationPathDOM2.default);
            ElevationPath.__removeProfileMarker = function (context) {
                var self = context;
                if (self._marker) {
                    self._measureSource.removeFeature(self._marker);
                    self._marker = null;
                }
            };
            ElevationPath.__createProfileMarker = function (context, d) {
                var self = context;
                var map = self.getMap();
                var proj = map.getView().getProjection();
                var _coordinate = _ol2.default.proj.transform([
                    d.lon,
                    d.lat
                ], 'EPSG:4326', proj);
                var _coordinateProj = self._measureSource.getFeatures()[0].getGeometry().getClosestPoint(_coordinate);
                var _geometry = new _ol2.default.geom.Point(_coordinateProj);
                self._marker = new _ol2.default.Feature({ geometry: _geometry });
                logger.trace(_geometry);
                self._marker.setStyle(self._markerStyle);
                self._measureSource.addFeature(self._marker);
            };
            ElevationPath.__updateProfileMarker = function (context, d) {
                var self = context;
                ElevationPath.__removeProfileMarker(self);
                ElevationPath.__createProfileMarker(self, d);
            };
            ElevationPath.__customRawProfileOperation = function (context, d) {
                logger.log('__customRawProfileOperation');
                var self = context;
                var _pts = d.points;
                var _proj = self.getMap().getView().getProjection();
                for (var i = 0; i < _pts.length; i++) {
                    var obj = _pts[i];
                    var _coordinate = _ol2.default.proj.transform([
                        obj.lon,
                        obj.lat
                    ], 'EPSG:4326', _proj);
                    var _geometry = new _ol2.default.geom.Point(_coordinate);
                    self._marker = new _ol2.default.Feature({ geometry: _geometry });
                    logger.trace(_geometry);
                    var styles = ElevationPath.DEFAULT_STYLES.RESULTS;
                    var _image = new _ol2.default.style.Circle({
                        radius: styles.imageRadius,
                        stroke: new _ol2.default.style.Stroke({
                            color: styles.imageStrokeColor,
                            width: styles.imageStrokeWidth
                        }),
                        fill: new _ol2.default.style.Fill({ color: styles.imageFillColor })
                    });
                    self._marker.setStyle(new _ol2.default.style.Style({ image: _image }));
                    self._measureSource.addFeature(self._marker);
                }
            };
            ElevationPath.__customRawProfileMouseOverEvent = function (context, e) {
                logger.log('__customRawProfileMouseOverEvent', context, e);
            };
            ElevationPath.DISPLAY_PROFILE_LIB_AMCHARTS = function (data, container, context) {
                logger.trace('ElevationPath.DISPLAY_PROFILE_LIB_AMCHARTS');
                if (typeof AmCharts === 'undefined') {
                    console.log('Lib. AmCharts is not loaded !');
                    return;
                }
                var profile = _ProfileElevationPathDOM2.default.displayProfileLibAmCharts(data, container, context, ElevationPath);
                if (profile) {
                    this._profile = profile;
                }
            };
            ElevationPath.DISPLAY_PROFILE_LIB_D3 = function (data, container, context) {
                logger.trace('ElevationPath.DISPLAY_PROFILE_LIB_D3');
                if (typeof d3 === 'undefined') {
                    console.log('Lib. D3 is not loaded !');
                    return;
                }
                var profile = _ProfileElevationPathDOM2.default.displayProfileLibD3(data, container, context, ElevationPath);
                if (profile) {
                    this._profile = profile;
                }
            };
            ElevationPath.DISPLAY_PROFILE_RAW = function (data, container, context) {
                logger.trace('ElevationPath.DISPLAY_PROFILE_RAW');
                var profile = _ProfileElevationPathDOM2.default.displayProfileRaw(data, container, context, ElevationPath);
                if (profile) {
                    this._profile = profile;
                }
            };
            ElevationPath.DISPLAY_PROFILE_BY_DEFAULT = function (data, container, context) {
                logger.trace('ElevationPath.DISPLAY_PROFILE_BY_DEFAULT');
                var profile = _ProfileElevationPathDOM2.default.displayProfileByDefault(data, container, context, ElevationPath);
                if (profile) {
                    this._profile = profile;
                }
            };
            ElevationPath.DEFAULT_STYLES = {
                MARKER: new _ol2.default.style.Icon({
                    src: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACIAAAAsCAYAAAAATWqyAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABTtJREFUeNq8WGtsFUUU/rb3gtdCAykFG9AUDTQUKimhxUewEusrJYoBo4FfEgoqotHERH6oP9TGmJhIrIlWAf9hjAaEiME2pgFfVVpFii8sWqIQLLSx3EJLW7p+Z2Z2b2l7d/b23vZLTmZ2duacb2fmnDk7DlKA67rXs1hJKacsohRQppjXFygnKT9TDlH2O47zFzIFGnco91EOuqnjoBnr2Ow4FhIlLN6m3DykFTh3BGj/Doj/CfSe082xPCDnBmDWTUBeyXDVjZTHOUNHUiZCEs+weI0ySTV0/w0c2wa07gIungn+vOx8YN46oPhpYOp1Xms/5TmSeSMUERKImFnYqBoGuPRNL5LEW8BgX2rrmjWZZLYApS8BUW8r4T0zO5eTEjFr+S6lSjV0HgPqVwNdf6S30abNB+7aDeQWey3bKZtIxvU5DxvyrE/izJfAvuXpkxCIDtElOjWqjK2RM8LZWMbiG0oEnUc5kB7a14WMYvI04H56du5ieZKluZWz8r0/IyQh5TuKRH8cqFuTeRIC0Sm6xYbYok1j21+ahyhLVO3wC8D5VowbRLfY0FhibOulIavDLEoRZyD8sJDeMWBXKG5ZsIobsdDsg+OMq3u1m1u9KQo8zP45EqjRxOUpk6i50IRl4FuGjpZtwUoiMYa314GFj/EzIsN8n8v+C1e4kfvwcm+wnhsZY27xQ8oiWZpKrWRQB6tAElfxpKnjsCdGklDzG9HvpI/0DYLYEpsalVnmAAM6fgR62oMHl70C5N9mn3rpI32DILbEpkZ5ljlFgbPNFtebzij5VPhNKX1lTBASNtXSzPZ3cxCuvVOH7FTCu4yxeZDGbCES0z5+PniQ3uGpwTYmYTOWCPGTpgYP6u9OnYhtzBCbQkSH0NiM4EEdP6VOxDYmYbNLiJxQ1elFwYPaG3XQCn3QHddjgpCweUKI6K2bvzw4YROf//rJob6fZl/H2FRoFiINfqo3qyzYwD8MVIeYLw32J+8j76SP9A2C2BKbGg1CZL+EF/W4YKP9a3/fCeyhkrY9DOOXEu1SlzZ5J31sSNjqURm/OfQkY9qgvkYOvXhbuH0g505Oga7HT9rPF9+t5+pDL0ulwzt46FV5ROax+JUSRRtP0LoHMK64+xNg7iqVEVOKSKRVxRGpsKhRnaRD4SPjR0J0axKCGmP7ilQxm4X8d8xXmfvHJZlPkCR3WfODl9FLMlxCIhevSJ5Nwzo1XdKxYpe3hpmB6BKdmoS43VqPxIgsni+aWOg8biZ3f+nLmSMiuvKWek/P01az7QdLyNVT7lC/l59WAKcb0iMxhzpW1nvmvpDtSiKD1l9OkpnDgv8UyMWFU9wvTP8vdY6NhJwnD1JVtso2OiiLSeL0iJUbNfg6zikVVwRTyOn2HWOfjfLtHgnBhtFIJCViyNDZUatdmnGlaFPqJIoe1WM1aqlz71ivJbLNobgAA9zgu7nZ/vstHAk5WVdzaPRqmGC5lER6kjpV4OWJdq+1kkshSk4VH9izcy/bV66qSPQZV+0J9G7rTY6+XNmqHmYwyJVV24kse1X31dhKHdasygkzy+a64oC4nWr47F4e858nSbLv4V/KAe9JKpVDrx/SImLIXMOiRUKdujESl+49O8xVZxpXzVc/C/I/RxL/hgq8YYkYhev9q6kVO4d9B+sr3vdICNaHJTHWW8Ya/87wqy2uWwstUk/gTYw3aCRGOarMDfS67kfFWqSuIe9imAjQEC272nJHixYNaSvGRIIGN49ywbsZEw1zI11N6TZSHeaGORn+F2AAJtRIMx4t+hUAAAAASUVORK5CYII=',
                    anchor: [
                        0.5,
                        1
                    ],
                    snapToPixel: true
                }),
                RESULTS: {
                    imageRadius: 5,
                    imageFillColor: 'rgba(128, 128, 128, 0.2)',
                    imageStrokeColor: 'rgba(0, 0, 0, 0.7)',
                    imageStrokeWidth: 2
                }
            };
            ElevationPath.prototype.constructor = ElevationPath;
            ElevationPath.prototype.setMap = function (map) {
                logger.trace('ElevationPath::setMap');
                if (map) {
                    if (this.options.active) {
                        if (this._profile === null) {
                            this._panelContainer.style.display = 'none';
                        }
                        this._initMeasureInteraction(map);
                        this._addMeasureInteraction(map);
                    }
                    if (!this.options.target) {
                        _MeasureToolBox2.default.add(map, this);
                    }
                }
                _ol2.default.control.Control.prototype.setMap.call(this, map);
            };
            ElevationPath.prototype.getActive = function () {
                logger.trace('ElevationPath::getActive');
                return this.options.active;
            };
            ElevationPath.prototype.setActive = function (active) {
                logger.trace('ElevationPath::setActive');
                this.options.active = active;
            };
            ElevationPath.prototype.clean = function () {
                logger.trace('ElevationPath::clean');
                var map = this.getMap();
                this._panelContainer.style.display = 'none';
                this._showContainer.checked = false;
                this._removeProfile();
                this._removeMeasure();
                this._removeMeasureInteraction(map);
            };
            ElevationPath.prototype._removeMeasure = function () {
                this._lastSketch = null;
                this._currentSketch = null;
                if (this._measureSource) {
                    if (this._marker) {
                        this._measureSource.removeFeature(this._marker);
                        this._marker = null;
                    }
                    var _features = this._measureSource.getFeatures();
                    for (var i = 0; i < _features.length; i++) {
                        this._measureSource.removeFeature(_features[i]);
                    }
                }
            };
            ElevationPath.prototype._removeProfile = function () {
                this._profile = null;
                if (this._profileContainer) {
                    while (this._profileContainer.firstChild) {
                        this._profileContainer.removeChild(this._profileContainer.firstChild);
                    }
                }
            };
            ElevationPath.prototype._initialize = function (options) {
                logger.trace('ElevationPath::_initialize : ', options);
                this.options = {
                    target: null,
                    render: null,
                    active: false,
                    apiKey: null,
                    elevationOptions: {},
                    displayProfileOptions: {
                        greaterSlope: true,
                        meanSlope: true,
                        ascendingElevation: true,
                        descendingElevation: true,
                        currentSlope: true,
                        apply: null,
                        target: null
                    },
                    stylesOptions: {
                        profile: null,
                        draw: null,
                        marker: null
                    }
                };
                _Utils2.default.mergeParams(this.options, options);
                this.options.apiKey = options.apiKey;
                var _profile = options.displayProfileOptions || {};
                var displayFunction = _profile.apply;
                this.options.displayProfileOptions.apply = typeof displayFunction === 'function' ? displayFunction : ElevationPath.DISPLAY_PROFILE_BY_DEFAULT;
                var displayContainer = _profile.target;
                this.options.displayProfileOptions.target = typeof displayContainer !== 'undefined' ? displayContainer : null;
                var _styles = options.stylesOptions || {};
                this.options.stylesOptions.draw = _styles.draw || {};
                this._createStylingDraw();
                this.options.stylesOptions.marker = _styles.marker || {};
                this._createStylingMarker();
            };
            ElevationPath.prototype._initializeContainer = function () {
                logger.trace('ElevationPath::_initializeContainer : ', this._uid);
                var container = this._createMainContainerElement();
                var inputShow = this._showContainer = this._createShowElevationPathElement();
                container.appendChild(inputShow);
                var picto = this._pictoContainer = this._createShowElevationPathPictoElement();
                container.appendChild(picto);
                if (this.options.active) {
                    this._showContainer.checked = true;
                }
                var panel = this._panelContainer = this._createElevationPathPanelElement();
                var header = this._createElevationPathPanelHeaderElement();
                panel.appendChild(header);
                var profile = this._profileContainer = this._createElevationPathPanelProfilElement();
                panel.appendChild(profile);
                var waiting = this._waitingContainer = this._createElevationPathWaitingElement();
                panel.appendChild(waiting);
                var info = this._infoContainer = this._createElevationPathInformationsElement();
                panel.appendChild(info);
                if (this.options.displayProfileOptions.target === null) {
                    container.appendChild(panel);
                }
                return container;
            };
            ElevationPath.prototype._checkRightsManagement = function () {
                logger.trace('ElevationPath::_checkRightsManagement');
                var rightManagement = _CheckRightManagement2.default.check({
                    key: this.options.apiKey,
                    resources: ['SERVICE_CALCUL_ALTIMETRIQUE_RSC'],
                    services: ['Elevation']
                });
                if (!rightManagement) {
                    this._noRightManagement = true;
                }
                if (!this.options.apiKey) {
                    this.options.apiKey = rightManagement.key;
                }
            };
            ElevationPath.prototype._createStylingMarker = function () {
                logger.trace('ElevationPath::_createStylingMarker ');
                var marker = ElevationPath.DEFAULT_STYLES.MARKER;
                logger.trace('style marker', marker);
                if (this.options.stylesOptions.marker instanceof _ol2.default.style.Image) {
                    marker = this.options.stylesOptions.marker;
                }
                this._markerStyle = new _ol2.default.style.Style({ image: marker });
            };
            ElevationPath.prototype._createStylingDraw = function () {
                logger.trace('ElevationPath::_createStylingDraw');
                var styles = this.options.stylesOptions.draw;
                logger.trace('style start', styles.start);
                var startStyleOpts = {
                    image: _Measures2.default.DEFAULT_POINTER_STYLE,
                    stroke: _Measures2.default.DEFAULT_DRAW_START_STYLE.getStroke()
                };
                if (styles.hasOwnProperty('pointer') && styles.pointer instanceof _ol2.default.style.Image) {
                    startStyleOpts.image = styles.pointer;
                }
                if (styles.hasOwnProperty('start') && styles.start instanceof _ol2.default.style.Stroke) {
                    startStyleOpts.stroke = styles.start;
                }
                this._drawStyleStart = new _ol2.default.style.Style(startStyleOpts);
                logger.trace('style finish', styles.finish);
                var finishStyleOpts = { stroke: _Measures2.default.DEFAULT_DRAW_FINISH_STYLE.getStroke() };
                if (styles.hasOwnProperty('finish') && styles.finish instanceof _ol2.default.style.Stroke) {
                    finishStyleOpts.stroke = styles.finish;
                }
                this._drawStyleFinish = new _ol2.default.style.Style(finishStyleOpts);
            };
            ElevationPath.prototype._createStylingProfile = function () {
                logger.trace('ElevationPath::_createStylingProfile');
                var userStyles = this.options.stylesOptions.profile;
                logger.trace('style profile', userStyles);
                var defaultStyle = ElevationPath.DEFAULT_STYLES.PROFILE;
                Object.keys(defaultStyle).forEach(function (key) {
                    if (!userStyles.hasOwnProperty(key)) {
                        userStyles[key] = defaultStyle[key];
                    } else {
                        var _defaultStyle = defaultStyle[key];
                        if ((typeof _defaultStyle === 'undefined' ? 'undefined' : _typeof(_defaultStyle)) === 'object') {
                            _Utils2.default.mergeParams(_defaultStyle, userStyles[key]);
                            userStyles[key] = _defaultStyle;
                        }
                    }
                }, this);
            };
            ElevationPath.prototype._initMeasureInteraction = function (map) {
                logger.trace('ElevationPath::_initMeasureInteraction()');
                if (!map) {
                    return;
                }
                this._measureSource = new _ol2.default.source.Vector();
                this._measureVector = new _ol2.default.layer.Vector({
                    source: this._measureSource,
                    style: this._drawStyleFinish
                });
                map.addLayer(this._measureVector);
            };
            ElevationPath.prototype._addMeasureInteraction = function (map) {
                logger.trace('ElevationPath::_addMeasureInteraction()');
                if (!map) {
                    return;
                }
                this._measureDraw = new _ol2.default.interaction.Draw({
                    source: this._measureSource,
                    type: 'LineString',
                    style: this._drawStyleStart
                });
                this._measureDraw.setProperties({
                    name: 'ElevationPath',
                    source: this
                });
                map.addInteraction(this._measureDraw);
                var self = this;
                this._measureDraw.on('drawstart', function (evt) {
                    logger.trace('drawstart', evt);
                    if (self._marker !== null) {
                        self._measureSource.removeFeature(self._marker);
                        self._marker = null;
                    }
                    if (self._lastSketch !== null) {
                        self._measureSource.removeFeature(self._lastSketch);
                        self._lastSketch = null;
                    }
                    self._currentSketch = evt.feature;
                    var _features = self._measureSource.getFeatures();
                    for (var i = 0; i < _features.length; i++) {
                        self._measureSource.removeFeature(_features[i]);
                    }
                }, this);
                this._measureDraw.on('drawend', function (evt) {
                    logger.trace('drawend', evt);
                    self._lastSketch = self._currentSketch;
                    if (typeof self.options.elevationOptions.onSuccess === 'undefined' && self.options.displayProfileOptions.target === null) {
                        self._panelContainer.style.display = 'block';
                    }
                    self._requestService();
                }, this);
            };
            ElevationPath.prototype._removeMeasureInteraction = function (map) {
                logger.trace('ElevationPath::_removeMeasureInteraction()');
                if (!map) {
                    return;
                }
                if (this._measureVector) {
                    map.removeLayer(this._measureVector);
                    this._measureVector = null;
                }
                if (this._measureDraw) {
                    map.removeInteraction(this._measureDraw);
                    this._measureDraw = null;
                }
            };
            ElevationPath.prototype._getGeometry = function () {
                if (this._currentSketch === null) {
                    logger.warn('Current Feature undefined !?');
                    return;
                }
                var geometry = [];
                var map = this.getMap();
                var projSrc = map.getView().getProjection();
                var projDest = 'EPSG:4326';
                var coordinates = this._currentSketch.getGeometry().getCoordinates();
                for (var i = 0; i < coordinates.length; i++) {
                    var xy = coordinates[i];
                    var ll = xy;
                    if (projSrc !== projDest) {
                        ll = _ol2.default.proj.transform(xy, projSrc, projDest);
                    }
                    geometry.push({
                        lon: ll[0],
                        lat: ll[1]
                    });
                }
                return geometry;
            };
            ElevationPath.prototype._getLength = function () {
                if (this._currentSketch === null) {
                    logger.warn('Current Feature undefined !?');
                    return;
                }
                var length = 0;
                var wgs84Sphere = new _ol2.default.Sphere(6378137);
                var map = this.getMap();
                var projSrc = map.getView().getProjection();
                var projDest = 'EPSG:4326';
                var coordinates = this._currentSketch.getGeometry().getCoordinates();
                for (var i = 0, ii = coordinates.length - 1; i < ii; ++i) {
                    var c1 = _ol2.default.proj.transform(coordinates[i], projSrc, projDest);
                    var c2 = _ol2.default.proj.transform(coordinates[i + 1], projSrc, projDest);
                    length += wgs84Sphere.haversineDistance(c1, c2);
                }
                return length;
            };
            ElevationPath.prototype._requestService = function () {
                logger.trace('ElevationPath::_requestService');
                var geometry = this._getGeometry();
                logger.trace('geometry', geometry);
                if (!geometry) {
                    logger.warn('missing geometry !?');
                    return;
                }
                if (this._noRightManagement) {
                    logger.warn('no rights to this service !');
                    return;
                }
                var options = {};
                _Utils2.default.mergeParams(options, this.options.elevationOptions);
                _Utils2.default.mergeParams(options, { apiKey: this.options.apiKey });
                var self = this;
                var _requestServiceOnSuccess = function _requestServiceOnSuccess(result) {
                    logger.trace(result);
                    if (result) {
                        self._panelContainer.style.display = 'block';
                        self._displayProfile(result.elevations);
                        self._waitingContainer.className = 'GPelevationPathCalcWaitingContainerHidden';
                        self._waiting = false;
                    }
                };
                var _requestServiceOnFailure = function _requestServiceOnFailure(error) {
                    self._panelContainer.style.display = 'none';
                    logger.error(error.message);
                    self._waitingContainer.className = 'GPelevationPathCalcWaitingContainerHidden';
                    self._waiting = false;
                };
                _Utils2.default.mergeParams(options, {
                    onSuccess: this.options.elevationOptions.onSuccess || _requestServiceOnSuccess,
                    onFailure: this.options.elevationOptions.onFailure || _requestServiceOnFailure
                });
                var sampling = options.sampling;
                if (!sampling) {
                    var _sampling = 50;
                    var _length = this._getLength();
                    logger.trace('length', _length);
                    var p = Math.floor(_length) / 5;
                    if (p >= 200) {
                        _sampling = 200;
                    } else {
                        _sampling = Math.floor(p);
                    }
                    _Utils2.default.mergeParams(options, { sampling: _sampling || 50 });
                }
                _Utils2.default.mergeParams(options, { positions: geometry });
                logger.trace('options du service', options);
                this._waitingContainer.className = 'GPelevationPathCalcWaitingContainerVisible';
                _gp2.default.Services.getAltitude(options);
            };
            ElevationPath.prototype._computeElevationMeasure = function (elevations) {
                logger.trace('ElevationPath::_computeElevationMeasure', elevations);
                var _data = elevations;
                var _limite = 2000;
                var _unit = 'km';
                var _factor = 1000;
                var _length = this._getLength();
                if (_length < _limite) {
                    _factor = 1;
                    _unit = 'm';
                }
                _data[0].dist = 0;
                _data[0].slope = 0;
                var _distanceMinus = 0;
                var _distancePlus = 0;
                var _ascendingElevation = 0;
                var _descendingElevation = 0;
                var _distance = 0;
                var _slopes = 0;
                var wgs84Sphere = new _ol2.default.Sphere(6378137);
                for (var i = 1; i < _data.length; i++) {
                    var a = [
                        _data[i].lon,
                        _data[i].lat
                    ];
                    var b = [
                        _data[i - 1].lon,
                        _data[i - 1].lat
                    ];
                    var dist = wgs84Sphere.haversineDistance(a, b);
                    var za = _data[i].z;
                    var zb = _data[i - 1].z;
                    if (za < 0) {
                        za = 0;
                    }
                    if (zb < 0) {
                        zb = 0;
                    }
                    var slope = za - zb;
                    if (slope < 0) {
                        _distanceMinus += dist;
                        _descendingElevation += slope;
                    } else if (slope > 0) {
                        _distancePlus += dist;
                        _ascendingElevation += slope;
                    }
                    _distance += dist / _factor;
                    _data[i].dist = _distance;
                    _slopes += slope ? Math.abs(Math.round(slope / dist * 100)) : 0;
                    _data[i].slope = slope ? Math.abs(Math.round(slope / dist * 100)) : 0;
                    var value = _data[i].slope;
                    if (value > 15 && value < 30) {
                        _data[i].color = '#005b4c';
                    } else if (value > 30 && value < 45) {
                        _data[i].color = '#00362d';
                    } else if (value > 45) {
                        _data[i].color = '#00120f';
                    } else {
                        _data[i].color = '#00B798';
                    }
                    _data[i].lat = Math.round(_data[i].lat * 10000) / 10000;
                    _data[i].lon = Math.round(_data[i].lon * 10000) / 10000;
                }
                var coeffArrond = 100;
                if (_distance > 100) {
                    coeffArrond = 1;
                } else if (_distance > 10) {
                    coeffArrond = 10;
                }
                _distance = Math.round(_distance * coeffArrond) / coeffArrond;
                _distanceMinus = Math.round(_distanceMinus * coeffArrond) / coeffArrond;
                _distancePlus = Math.round(_distancePlus * coeffArrond) / coeffArrond;
                var _altMin = _data[0].z;
                var _altMax = _data[0].z;
                var _greaterSlope = _data[0].slope;
                for (var ji = 0; ji < _data.length; ji++) {
                    var d = _data[ji];
                    if (d.z < 0) {
                        d.z = 0;
                    }
                    if (d.z >= _altMax) {
                        _altMax = d.z;
                    }
                    if (d.z <= _altMin) {
                        _altMin = d.z;
                    }
                    d.dist = Math.round(d.dist * coeffArrond) / coeffArrond;
                    if (d.slope > _greaterSlope) {
                        _greaterSlope = d.slope;
                    }
                }
                return {
                    greaterSlope: _greaterSlope,
                    meanSlope: Math.round(_slopes / _data.length),
                    distancePlus: _distancePlus.toLocaleString(),
                    distanceMinus: _distanceMinus.toLocaleString(),
                    ascendingElevation: _ascendingElevation,
                    descendingElevation: _descendingElevation,
                    altMin: _altMin.toLocaleString(),
                    altMax: _altMax.toLocaleString(),
                    distance: _distance.toLocaleString(),
                    unit: _unit,
                    points: _data
                };
            };
            ElevationPath.prototype._displayProfile = function (elevations) {
                logger.trace('ElevationPath::_displayProfile', elevations);
                if (this._data) {
                    this._data = {};
                }
                var data = this._data = this._computeElevationMeasure(elevations);
                var container = this.options.displayProfileOptions.target;
                if (container) {
                    container.appendChild(this._panelContainer);
                }
                container = this._profileContainer;
                var context = this;
                var displayFunction = this.options.displayProfileOptions.apply;
                displayFunction.call(this, data, container, context);
                var opts = this.options.displayProfileOptions;
                var element = document.getElementById('GPelevationPathPanelInfo-' + this._uid);
                if (element) {
                    if (opts.greaterSlope || opts.meanSlope || opts.ascendingElevation || opts.descendingElevation) {
                        element.style.display = 'block';
                    }
                }
            };
            ElevationPath.prototype.onShowElevationPathClick = function () {
                var map = this.getMap();
                _Interactions2.default.unset(map, { current: 'ElevationPath' });
                if (!this._showContainer.checked) {
                    if (this._profile === null) {
                        this._panelContainer.style.display = 'none';
                    }
                    this._initMeasureInteraction(map);
                    this._addMeasureInteraction(map);
                } else {
                    this._panelContainer.style.display = 'none';
                    this._removeMeasure();
                    this._removeProfile();
                    this._removeMeasureInteraction(map);
                }
            };
            ElevationPath.prototype.onOpenElevationPathInfoClick = function () {
                var meanSlope = this.options.displayProfileOptions.meanSlope;
                var greaterSlope = this.options.displayProfileOptions.greaterSlope;
                var ascendingElevation = this.options.displayProfileOptions.ascendingElevation;
                var descendingElevation = this.options.displayProfileOptions.descendingElevation;
                var div = this._infoContainer;
                if (div.childElementCount) {
                    while (div.firstChild) {
                        div.removeChild(div.firstChild);
                    }
                }
                if (ascendingElevation) {
                    this._addElevationPathInformationsItem('Dénivelé positif : ' + this._data.ascendingElevation.toLocaleString() + ' m');
                }
                if (descendingElevation) {
                    this._addElevationPathInformationsItem('Dénivelé négatif : ' + this._data.descendingElevation.toLocaleString() + ' m');
                }
                if (meanSlope) {
                    this._addElevationPathInformationsItem('Pente moyenne : ' + this._data.meanSlope.toLocaleString() + ' %');
                }
                if (greaterSlope) {
                    this._addElevationPathInformationsItem('Plus forte pente : ' + this._data.greaterSlope.toLocaleString() + ' %');
                }
                if (div.className === 'GPelevationPathInformationsContainerVisible') {
                    clearTimeout(this._timerHdlr);
                    div.className = 'GPelevationPathInformationsContainerHidden';
                } else {
                    div.className = 'GPelevationPathInformationsContainerVisible';
                }
                this._timerHdlr = setTimeout(function () {
                    div.className = 'GPelevationPathInformationsContainerHidden';
                }, 4000);
            };
            exports.default = ElevationPath;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var MeasureToolBoxDOM = {
                _toolboxId: 'GPtoolbox-measure-main',
                _buttonId: 'GPtoolbox-measure-button',
                _widgetId: 'GPtoolbox-measure-widget',
                getToolBoxID: function getToolBoxID(uid) {
                    return uid ? this._toolboxId + '-' + uid : this._toolboxId;
                },
                getButtonID: function getButtonID(uid) {
                    return uid ? this._buttonId + '-' + uid : this._buttonId;
                },
                getWidgetID: function getWidgetID(uid) {
                    return uid ? this._widgetId + '-' + uid : this._widgetId;
                },
                _createToolBoxContainerElement: function _createToolBoxContainerElement(uid) {
                    var container = document.createElement('div');
                    container.id = this.getToolBoxID(uid);
                    container.className = 'GPshowAdvancedToolPicto';
                    var button = document.createElement('button');
                    button.id = this.getButtonID(uid);
                    var self = this;
                    button.addEventListener('click', function () {
                        this.blur();
                        var widget = document.getElementById(self.getWidgetID(uid));
                        if (widget.style.display === 'block') {
                            widget.style.display = 'none';
                        } else {
                            widget.style.display = 'block';
                        }
                    });
                    container.appendChild(button);
                    var widget = document.createElement('div');
                    widget.id = this.getWidgetID(uid);
                    widget.addEventListener('click', function () {
                    }, false);
                    container.appendChild(widget);
                    return container;
                }
            };
            exports.default = MeasureToolBoxDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var ElevationPathDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPelevationPath');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowElevationPathElement: function _createShowElevationPathElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowElevationPath');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowElevationPathPictoElement: function _createShowElevationPathPictoElement() {
                    var context = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowElevationPathPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowElevationPath');
                    label.title = 'Calculer un profil';
                    if (label.addEventListener) {
                        label.addEventListener('click', function (e) {
                            context.onShowElevationPathClick(e);
                        });
                    } else if (label.attachEvent) {
                        label.attachEvent('onclick', function (e) {
                            context.onShowElevationPathClick(e);
                        });
                    }
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowElevationPathOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                },
                _createElevationPathPanelElement: function _createElevationPathPanelElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPelevationPathPanel');
                    div.className = 'GPpanel';
                    return div;
                },
                _createElevationPathPanelHeaderElement: function _createElevationPathPanelHeaderElement() {
                    var self = this;
                    var container = document.createElement('div');
                    container.className = 'GPpanelHeader';
                    var divInfo = document.createElement('div');
                    divInfo.id = this._addUID('GPelevationPathPanelInfo');
                    divInfo.className = 'GPpanelInfo';
                    divInfo.title = 'Informations';
                    if (divInfo.addEventListener) {
                        divInfo.addEventListener('click', function () {
                            self.onOpenElevationPathInfoClick();
                        });
                    } else if (divInfo.attachEvent) {
                        divInfo.attachEvent('onclick', function () {
                            self.onOpenElevationPathInfoClick();
                        });
                    }
                    container.appendChild(divInfo);
                    var divTitle = document.createElement('div');
                    divTitle.className = 'GPpanelTitle';
                    divTitle.innerHTML = 'Profil Altimétrique';
                    container.appendChild(divTitle);
                    var divReduce = document.createElement('div');
                    divReduce.id = this._addUID('GPelevationPathPanelReduce');
                    divReduce.className = 'GPpanelReduce';
                    divReduce.title = 'Masquer le panneau';
                    if (divReduce.addEventListener) {
                        divReduce.addEventListener('click', function () {
                            if (typeof self.onReduceElevationPathPanelClick === 'function') {
                                document.getElementById(self._addUID('GPshowElevationPath')).checked = false;
                                self.onReduceElevationPathPanelClick();
                            }
                        }, false);
                    } else if (divReduce.attachEvent) {
                        divReduce.attachEvent('onclick', function () {
                            if (typeof self.onReduceElevationPathPanelClick === 'function') {
                                document.getElementById(self._addUID('GPshowElevationPath')).checked = false;
                                self.onReduceElevationPathPanelClick();
                            }
                        });
                    }
                    container.appendChild(divReduce);
                    var divClose = document.createElement('div');
                    divClose.id = this._addUID('GPelevationPathPanelClose');
                    divClose.className = 'GPpanelClose';
                    divClose.title = 'Fermer le panneau';
                    if (divClose.addEventListener) {
                        divClose.addEventListener('click', function () {
                            document.getElementById(self._addUID('GPshowElevationPathPicto')).click();
                        }, false);
                    } else if (divClose.attachEvent) {
                        divClose.attachEvent('onclick', function () {
                            document.getElementById(self._addUID('GPshowElevationPathPicto')).click();
                        });
                    }
                    container.appendChild(divClose);
                    return container;
                },
                _createElevationPathPanelProfilElement: function _createElevationPathPanelProfilElement() {
                    var div = document.createElement('div');
                    div.id = 'GPelevationPathProfil';
                    return div;
                },
                _createElevationPathWaitingElement: function _createElevationPathWaitingElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPelevationPathCalcWaitingContainer');
                    div.className = 'GPelevationPathCalcWaitingContainerHidden';
                    var p = document.createElement('p');
                    p.className = 'GPelevationPathCalcWaiting';
                    p.innerHTML = 'Calcul en cours...';
                    div.appendChild(p);
                    return div;
                },
                _createElevationPathInformationsElement: function _createElevationPathInformationsElement() {
                    var div = document.createElement('div');
                    div.id = this._addUID('GPelevationPathInformationsContainer');
                    div.className = 'GPelevationPathInformationsContainerHidden';
                    var p = document.createElement('p');
                    p.className = 'GPelevationPathInformations';
                    p.innerHTML = 'Aucune information...';
                    div.appendChild(p);
                    return div;
                },
                _addElevationPathInformationsItem: function _addElevationPathInformationsItem(value) {
                    var div = document.getElementById(this._addUID('GPelevationPathInformationsContainer'));
                    if (div) {
                        var p = document.createElement('p');
                        p.className = 'GPelevationPathInformations';
                        p.innerHTML = value;
                        div.appendChild(p);
                    }
                    return div;
                }
            };
            exports.default = ElevationPathDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var ProfileElevationPathDOM = {
                displayProfileByDefault: function displayProfileByDefault(data, container, context, className) {
                    var self = context;
                    if (container) {
                        while (container.firstChild) {
                            container.removeChild(container.firstChild);
                        }
                    }
                    if (!data) {
                        return;
                    }
                    var _displayProfileOptions = self.options.displayProfileOptions;
                    var _points = data.points;
                    var sortedElev = JSON.parse(JSON.stringify(_points));
                    sortedElev.sort(function (e1, e2) {
                        return e1.z - e2.z;
                    });
                    var minZ = sortedElev[0].z;
                    var maxZ = sortedElev[sortedElev.length - 1].z;
                    var diff = maxZ - minZ;
                    var dist = data.distance;
                    var unit = data.unit;
                    var barwidth = 100 / _points.length;
                    var div = document.createElement('div');
                    div.id = 'profileElevationByDefault';
                    container.appendChild(div);
                    var divBox = document.createElement('div');
                    divBox.className = 'profile-box';
                    var divZ = document.createElement('div');
                    divZ.className = 'profile-z-vertical';
                    var ulZ = document.createElement('ul');
                    var liZmin = document.createElement('li');
                    liZmin.setAttribute('class', 'profile-min-z');
                    liZmin.innerHTML = minZ + ' m';
                    var liZmax = document.createElement('li');
                    liZmax.setAttribute('class', 'profile-max-z');
                    liZmax.innerHTML = maxZ + ' m';
                    ulZ.appendChild(liZmax);
                    ulZ.appendChild(liZmin);
                    divZ.appendChild(ulZ);
                    divBox.appendChild(divZ);
                    var divData = document.createElement('div');
                    divData.className = 'profile-content';
                    divData.addEventListener('mouseover', function (e) {
                        var _lon = parseFloat(e.target.dataset['lon']);
                        var _lat = parseFloat(e.target.dataset['lat']);
                        if (_lon && _lat) {
                            className.__createProfileMarker(self, {
                                lat: _lat,
                                lon: _lon
                            });
                        }
                    });
                    divData.addEventListener('mousemove', function (e) {
                        var _lon = parseFloat(e.target.dataset['lon']);
                        var _lat = parseFloat(e.target.dataset['lat']);
                        if (_lon && _lat) {
                            className.__updateProfileMarker(self, {
                                lat: _lat,
                                lon: _lon
                            });
                        }
                    });
                    divData.addEventListener('mouseout', function () {
                        className.__removeProfileMarker(self);
                    });
                    var ulData = document.createElement('ul');
                    ulData.id = 'profile-data';
                    ulData.className = 'profile-z-axis profile-x-axis';
                    divData.appendChild(ulData);
                    for (var i = 0; i < _points.length; i++) {
                        var d = _points[i];
                        var li = document.createElement('li');
                        li.setAttribute('data-z', d.z);
                        li.setAttribute('data-lon', d.lon);
                        li.setAttribute('data-lat', d.lat);
                        li.setAttribute('data-dist', d.dist);
                        var pct = Math.floor((d.z - minZ) * 100 / diff);
                        li.setAttribute('class', 'percent v' + pct);
                        li.title = 'Altitude : ' + d.z + 'm';
                        if (_displayProfileOptions.currentSlope) {
                            li.title += ' - Pente : ' + d.slope + '%';
                        }
                        li.title += ' (Lat : ' + d.lat + ' / Lon : ' + d.lon + ')';
                        li.setAttribute('style', 'width: ' + barwidth + '%');
                        ulData.appendChild(li);
                    }
                    divBox.appendChild(divData);
                    div.appendChild(divBox);
                    var divX = document.createElement('div');
                    divX.className = 'profile-x-horizontal';
                    var ulX = document.createElement('ul');
                    var liXmin = document.createElement('li');
                    liXmin.setAttribute('class', 'profile-min-x');
                    liXmin.innerHTML = '';
                    var liXmax = document.createElement('li');
                    liXmax.setAttribute('class', 'profile-max-x');
                    liXmax.innerHTML = dist + ' ' + unit;
                    ulX.appendChild(liXmin);
                    ulX.appendChild(liXmax);
                    divX.appendChild(ulX);
                    div.appendChild(divX);
                    return container;
                },
                displayProfileRaw: function displayProfileRaw(data, container, context, className) {
                    if (container) {
                        while (container.firstChild) {
                            container.removeChild(container.firstChild);
                        }
                    }
                    var _points = data.points;
                    var div = document.createElement('textarea');
                    div.id = 'profilElevationResults';
                    div.rows = 10;
                    div.cols = 50;
                    div.style.width = '100%';
                    div.innerHTML = JSON.stringify(_points, undefined, 4);
                    div.addEventListener('mouseover', function (e) {
                        className.__customRawProfileMouseOverEvent(context, e);
                    });
                    container.appendChild(div);
                    return container;
                },
                displayProfileLibD3: function displayProfileLibD3(data, container, context, className) {
                    var self = context;
                    if (container) {
                        while (container.firstChild) {
                            container.removeChild(container.firstChild);
                        }
                    }
                    var _points = data.points;
                    var _displayProfileOptions = self.options.displayProfileOptions;
                    var margin = {
                        top: 20,
                        right: 20,
                        bottom: 30,
                        left: 40
                    };
                    var width = container.clientWidth - margin.left - margin.right;
                    var height = container.clientHeight - margin.top - margin.bottom;
                    var x = d3.scale.linear().range([
                        0,
                        width
                    ]);
                    var y = d3.scale.linear().range([
                        height,
                        0
                    ]);
                    var xAxis = d3.svg.axis().scale(x).orient('bottom').ticks(5);
                    var yAxis = d3.svg.axis().scale(y).orient('left').ticks(5);
                    var line = d3.svg.line().interpolate('basis').x(function (d) {
                        return x(d.dist);
                    }).y(function (d) {
                        return y(d.z);
                    });
                    var area = d3.svg.area().interpolate('basis').x(function (d) {
                        return x(d.dist);
                    }).y0(height).y1(function (d) {
                        return y(d.z);
                    });
                    var svg = d3.select(container).append('svg').attr('width', width + margin.left + margin.right).attr('height', height + margin.top + margin.bottom).append('g').attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');
                    var xDomain = d3.extent(_points, function (d) {
                        return d.dist;
                    });
                    x.domain(xDomain);
                    var yDomain = [
                        0,
                        d3.max(_points, function (d) {
                            return d.z;
                        })
                    ];
                    y.domain(yDomain);
                    svg.append('path').datum(_points).attr('class', 'area-d3').attr('d', area);
                    svg.append('g').attr('class', 'x axis-d3').attr('transform', 'translate(0,' + height + ')').call(xAxis).append('text').attr('y', -15).attr('dy', '.71em').attr('x', width).text('Distance (' + data.unit + ')');
                    svg.append('g').attr('class', 'y axis-d3').call(yAxis).append('text').attr('transform', 'rotate(-90)').attr('y', 6).attr('dy', '.71em').text('Altitude (m)');
                    svg.append('g').attr('class', 'grid-d3 vertical').attr('transform', 'translate(0,' + height + ')').call(xAxis.orient('bottom').tickSize(-height, 0, 0).tickFormat(''));
                    svg.append('g').attr('class', 'grid-d3 horizontal').call(yAxis.orient('left').tickSize(-width, 0, 0).tickFormat(''));
                    svg.append('path').datum(_points).attr('class', 'line-d3').attr('d', line);
                    svg.selectAll('circle').data(_points).enter().append('circle').attr('cx', function (d) {
                        return x(d.dist);
                    }).attr('cy', function (d) {
                        return y(d.z);
                    }).attr('r', 0).attr('class', 'circle-d3');
                    var focus = svg.append('g').style('display', 'none');
                    focus.append('line').attr('id', 'focusLineX').attr('class', 'focusLine-d3');
                    focus.append('line').attr('id', 'focusLineY').attr('class', 'focusLine-d3');
                    focus.append('circle').attr('id', 'focusCircle').attr('r', 4).attr('class', 'circle-d3 focusCircle-d3');
                    var div = d3.select(container).append('div').attr('class', 'tooltip-d3').style('opacity', 0);
                    var bisectDist = d3.bisector(function (d) {
                        return d.dist;
                    }).left;
                    svg.append('rect').attr('class', 'overlay-d3').attr('width', width).attr('height', height).on('mouseover', function () {
                        focus.style('display', null);
                        className.__createProfileMarker(self, _points[0]);
                    }).on('mouseout', function () {
                        focus.style('display', 'none');
                        className.__removeProfileMarker(self);
                        div.transition().duration(500).style('opacity', 0);
                    }).on('mousemove', function () {
                        var m = d3.mouse(this);
                        var distance = x.invert(m[0]);
                        var i = bisectDist(_points, distance);
                        var d0 = _points[i - 1];
                        var d1 = _points[i];
                        var d = distance - d0[0] > d1[0] - distance ? d1 : d0;
                        var xc = x(d.dist);
                        var yc = y(d.z);
                        focus.select('#focusCircle').attr('cx', xc).attr('cy', yc);
                        focus.select('#focusLineX').attr('x1', xc).attr('y1', y(yDomain[0])).attr('x2', xc).attr('y2', y(yDomain[1]));
                        focus.select('#focusLineY').attr('x1', x(xDomain[0])).attr('y1', yc).attr('x2', x(xDomain[1])).attr('y2', yc);
                        className.__updateProfileMarker(self, d);
                        div.transition().duration(200).style('opacity', 0.9);
                        var _message = '';
                        _message += ' Altitude : ' + d.z + ' m';
                        if (_displayProfileOptions.currentSlope) {
                            _message += '<br/> Pente : ' + d.slope + ' %';
                        }
                        _message += '<br/> (Lat : ' + d.lat + '/ Lon : ' + d.lon + ')';
                        div.html(_message).style('left', d3.event.pageX + 'px').style('top', d3.event.pageY - 28 + 'px');
                    });
                    return svg;
                },
                displayProfileLibAmCharts: function displayProfileLibAmCharts(data, container, context, className) {
                    var self = context;
                    var _points = data.points;
                    var ballonText = '<span class=\'altiPathValue\'>[[title]] : [[value]]m</span><br/>';
                    var currentSlope = self.options.displayProfileOptions.currentSlope;
                    if (currentSlope) {
                        ballonText += '<span class=\'altiPathValue\'>Pente : [[slope]] %</span><br/>';
                    }
                    ballonText += '<span class=\'altiPathCoords\'>(Lat: [[lat]] / Lon:[[lon]])</span>';
                    AmCharts.addInitHandler(function () {
                    });
                    var settings = {
                        type: 'serial',
                        pathToImages: 'http://cdn.amcharts.com/lib/3/images/',
                        categoryField: 'dist',
                        autoMarginOffset: 0,
                        marginRight: 10,
                        marginTop: 10,
                        startDuration: 0,
                        color: '#5E5E5E',
                        fontSize: 8,
                        theme: 'light',
                        thousandsSeparator: '',
                        numberFormatter: {
                            precision: -1,
                            decimalSeparator: ',',
                            thousandsSeparato: ' '
                        },
                        categoryAxis: {
                            color: '#5E5E5E',
                            gridPosition: 'start',
                            minHorizontalGap: 40,
                            tickPosition: 'start',
                            title: 'Distance (' + data.unit + ')',
                            titleColor: '#5E5E5E',
                            labelOffset: 0,
                            startOnAxis: true
                        },
                        chartCursor: {
                            animationDuration: 0,
                            bulletsEnabled: true,
                            bulletSize: 10,
                            categoryBalloonEnabled: false,
                            cursorColor: '#F90',
                            graphBulletAlpha: 1,
                            graphBulletSize: 1,
                            zoomable: false
                        },
                        trendLines: [],
                        graphs: [{
                                balloonColor: '#CCCCCC',
                                balloonText: ballonText,
                                bullet: 'round',
                                bulletAlpha: 0,
                                bulletBorderColor: '#FFF',
                                bulletBorderThickness: 2,
                                bulletColor: '#F90',
                                bulletSize: 6,
                                hidden: false,
                                id: 'AmGraph-1',
                                fillAlphas: 0.4,
                                fillColors: '#C77A04',
                                lineAlpha: 1,
                                lineColor: '#C77A04',
                                lineThickness: 1,
                                title: 'Altitude',
                                valueField: 'z'
                            }],
                        guides: [],
                        valueAxes: [{
                                id: 'ValueAxis-1',
                                minVerticalGap: 20,
                                title: 'Altitude (m)'
                            }],
                        balloon: {
                            borderColor: '#CCCCCC',
                            borderThickness: 1,
                            fillColor: '#FFFFFF',
                            showBullet: true
                        },
                        titles: [],
                        allLabels: [],
                        dataProvider: _points
                    };
                    var _containerProfile = AmCharts.makeChart(container, settings);
                    _containerProfile.addListener('changed', function (e) {
                        var obj = e.chart.dataProvider[e.index];
                        className.__updateProfileMarker(self, obj);
                    });
                    return _containerProfile;
                }
            };
            exports.default = ProfileElevationPathDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _MeasureToolBox = __webpack_require__(14);
            var _MeasureToolBox2 = _interopRequireDefault(_MeasureToolBox);
            var _Measures = __webpack_require__(13);
            var _Measures2 = _interopRequireDefault(_Measures);
            var _MeasureLengthDOM = __webpack_require__(113);
            var _MeasureLengthDOM2 = _interopRequireDefault(_MeasureLengthDOM);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('measurelength');
            function MeasureLength(options) {
                options = options || {};
                if (!(this instanceof MeasureLength)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this.CLASSNAME = 'MeasureLength';
                this._uid = _SelectorID2.default.generate();
                this._showContainer = null;
                this._pictoContainer = null;
                this._initialize(options);
                var container = options.element ? options.element : this._initializeContainer();
                _ol2.default.control.Control.call(this, {
                    element: container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(MeasureLength, _ol2.default.control.Control);
            MeasureLength.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(MeasureLength.prototype, _Measures2.default);
            _Utils2.default.assign(MeasureLength.prototype, _MeasureLengthDOM2.default);
            MeasureLength.prototype.constructor = MeasureLength;
            MeasureLength.prototype.setMap = function (map) {
                logger.trace('setMap()');
                var className = this.CLASSNAME;
                if (map) {
                    if (!this.options.target) {
                        _MeasureToolBox2.default.add(map, this);
                    }
                } else {
                    this.clean();
                }
                this.tools[className].instance = map ? this : null;
                _ol2.default.control.Control.prototype.setMap.call(this, map);
            };
            MeasureLength.prototype._initialize = function (options) {
                logger.trace('call MeasureLength::_initialize() : ', options);
                this.options = {};
                this.options.geodesic = typeof options.geodesic !== 'undefined' ? options.geodesic : true;
                this.options.target = typeof options.target !== 'undefined' ? options.target : null;
                this.options.render = typeof options.render !== 'undefined' ? options.render : null;
                this.createStylingMeasureInteraction(options.styles);
            };
            MeasureLength.prototype._initializeContainer = function () {
                logger.trace('call MeasureLength::_initializeContainer() : ', this._uid);
                var container = this._createMainContainerElement();
                var show = this._showContainer = this._createShowMeasureLengthElement();
                container.appendChild(show);
                this._showContainer.checked = false;
                var picto = this._pictoContainer = this._createShowMeasureLengthPictoElement();
                container.appendChild(picto);
                return container;
            };
            MeasureLength.prototype.addMeasureEvents = function () {
                logger.trace('call MeasureLength::addMeasureEvents()');
                var map = this.getMap();
                map.on('singleclick', this.onPointerMoveHandler, this);
                map.on('pointermove', this.onPointerMoveHandler, this);
            };
            MeasureLength.prototype.removeMeasureEvents = function () {
                logger.trace('call MeasureLength::removeMeasureEvents()');
                var map = this.getMap();
                map.un('singleclick', this.onPointerMoveHandler, this);
                map.un('pointermove', this.onPointerMoveHandler, this);
            };
            MeasureLength.prototype.format = function (line) {
                logger.trace('call MeasureLength::format()');
                var map = this.getMap();
                var measure;
                if (this.options.geodesic) {
                    var wgs84Sphere = new _ol2.default.Sphere(6378137);
                    var coordinates = line.getCoordinates();
                    measure = 0;
                    var sourceProj = map.getView().getProjection();
                    for (var i = 0, ii = coordinates.length - 1; i < ii; ++i) {
                        var c1 = _ol2.default.proj.transform(coordinates[i], sourceProj, 'EPSG:4326');
                        var c2 = _ol2.default.proj.transform(coordinates[i + 1], sourceProj, 'EPSG:4326');
                        measure += wgs84Sphere.haversineDistance(c1, c2);
                    }
                } else {
                    measure = Math.round(line.getLength() * 100) / 100;
                }
                var output;
                if (measure > 1000) {
                    output = Math.round(measure / 1000 * 100) / 100 + ' ' + 'km';
                } else {
                    output = Math.round(measure * 100) / 100 + ' ' + 'm';
                }
                return output;
            };
            MeasureLength.prototype.onShowMeasureLengthClick = function (e) {
                logger.trace('call MeasureLength::onShowMeasureLengthClick()', e);
                this.onShowMeasureClick(e, 'LineString');
            };
            exports.default = MeasureLength;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var MeasureLengthDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPmeasureLength');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowMeasureLengthElement: function _createShowMeasureLengthElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowMeasureLength');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowMeasureLengthPictoElement: function _createShowMeasureLengthPictoElement() {
                    var context = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowMeasureLengthPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowMeasureLength');
                    label.title = 'Mesurer une distance';
                    if (label.addEventListener) {
                        label.addEventListener('click', function (e) {
                            context.onShowMeasureLengthClick(e);
                        });
                    } else if (label.attachEvent) {
                        label.attachEvent('onclick', function (e) {
                            context.onShowMeasureLengthClick(e);
                        });
                    }
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowMeasureLengthOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                }
            };
            exports.default = MeasureLengthDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _MeasureToolBox = __webpack_require__(14);
            var _MeasureToolBox2 = _interopRequireDefault(_MeasureToolBox);
            var _Measures = __webpack_require__(13);
            var _Measures2 = _interopRequireDefault(_Measures);
            var _MeasureAreaDOM = __webpack_require__(115);
            var _MeasureAreaDOM2 = _interopRequireDefault(_MeasureAreaDOM);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('measurearea');
            function MeasureArea(options) {
                options = options || {};
                if (!(this instanceof MeasureArea)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this.CLASSNAME = 'MeasureArea';
                this._uid = _SelectorID2.default.generate();
                this._showContainer = null;
                this._pictoContainer = null;
                this._initialize(options);
                var container = options.element ? options.element : this._initializeContainer();
                _ol2.default.control.Control.call(this, {
                    element: container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(MeasureArea, _ol2.default.control.Control);
            MeasureArea.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(MeasureArea.prototype, _Measures2.default);
            _Utils2.default.assign(MeasureArea.prototype, _MeasureAreaDOM2.default);
            MeasureArea.prototype.constructor = MeasureArea;
            MeasureArea.prototype.setMap = function (map) {
                logger.trace('setMap()');
                var className = this.CLASSNAME;
                if (map) {
                    if (!this.options.target) {
                        _MeasureToolBox2.default.add(map, this);
                    }
                } else {
                    this.clean();
                }
                this.tools[className].instance = map ? this : null;
                _ol2.default.control.Control.prototype.setMap.call(this, map);
            };
            MeasureArea.prototype._initialize = function (options) {
                logger.trace('call MeasureArea::_initialize() : ', options);
                this.options = {};
                this.options.geodesic = typeof options.geodesic !== 'undefined' ? options.geodesic : true;
                this.options.target = typeof options.target !== 'undefined' ? options.target : null;
                this.options.render = typeof options.render !== 'undefined' ? options.render : null;
                this.createStylingMeasureInteraction(options.styles);
            };
            MeasureArea.prototype._initializeContainer = function () {
                logger.trace('call MeasureArea::_initializeContainer() : ', this._uid);
                var container = this._createMainContainerElement();
                var show = this._showContainer = this._createShowMeasureAreaElement();
                container.appendChild(show);
                this._showContainer.checked = false;
                var picto = this._pictoContainer = this._createShowMeasureAreaPictoElement();
                container.appendChild(picto);
                return container;
            };
            MeasureArea.prototype.addMeasureEvents = function () {
                logger.trace('call MeasureArea::addMeasureEvents()');
                var map = this.getMap();
                map.on('singleclick', this.onPointerMoveHandler, this);
                map.on('pointermove', this.onPointerMoveHandler, this);
            };
            MeasureArea.prototype.removeMeasureEvents = function () {
                logger.trace('call MeasureArea::removeMeasureEvents()');
                var map = this.getMap();
                map.un('singleclick', this.onPointerMoveHandler, this);
                map.un('pointermove', this.onPointerMoveHandler, this);
            };
            MeasureArea.prototype.format = function (polygon) {
                logger.trace('call MeasureArea::format()');
                var map = this.getMap();
                var measure;
                if (this.options.geodesic) {
                    var wgs84Sphere = new _ol2.default.Sphere(6378137);
                    var sourceProj = map.getView().getProjection();
                    var geom = polygon.clone().transform(sourceProj, 'EPSG:4326');
                    var coordinates = geom.getLinearRing(0).getCoordinates();
                    measure = Math.abs(wgs84Sphere.geodesicArea(coordinates));
                } else {
                    measure = polygon.getArea();
                }
                var output;
                if (measure > 1000000) {
                    output = Math.round(measure / 1000000 * 100) / 100 + ' ' + 'km<sup>2</sup>';
                } else if (measure > 100000) {
                    output = Math.round(measure / 1000000 * 1000) / 1000 + ' ' + 'km<sup>2</sup>';
                } else if (measure > 1000) {
                    output = Math.round(measure / 10) * 10 + ' ' + 'm<sup>2</sup>';
                } else {
                    output = Math.round(measure * 100) / 100 + ' ' + 'm<sup>2</sup>';
                }
                return output;
            };
            MeasureArea.prototype.onShowMeasureAreaClick = function (e) {
                logger.trace('call MeasureArea::onShowMeasureAreaClick()', e);
                this.onShowMeasureClick(e, 'Polygon');
            };
            exports.default = MeasureArea;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var MeasureAreaDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPmeasureArea');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowMeasureAreaElement: function _createShowMeasureAreaElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowMeasureArea');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowMeasureAreaPictoElement: function _createShowMeasureAreaPictoElement() {
                    var context = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowMeasureAreaPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowMeasureArea');
                    label.title = 'Mesurer une surface';
                    if (label.addEventListener) {
                        label.addEventListener('click', function (e) {
                            context.onShowMeasureAreaClick(e);
                        });
                    } else if (label.attachEvent) {
                        label.attachEvent('onclick', function (e) {
                            context.onShowMeasureAreaClick(e);
                        });
                    }
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowMeasureAreaOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                }
            };
            exports.default = MeasureAreaDOM;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var _ol = __webpack_require__(1);
            var _ol2 = _interopRequireDefault(_ol);
            var _LoggerByDefault = __webpack_require__(3);
            var _LoggerByDefault2 = _interopRequireDefault(_LoggerByDefault);
            var _Utils = __webpack_require__(0);
            var _Utils2 = _interopRequireDefault(_Utils);
            var _MeasureToolBox = __webpack_require__(14);
            var _MeasureToolBox2 = _interopRequireDefault(_MeasureToolBox);
            var _Measures = __webpack_require__(13);
            var _Measures2 = _interopRequireDefault(_Measures);
            var _MeasureAzimuthDOM = __webpack_require__(117);
            var _MeasureAzimuthDOM2 = _interopRequireDefault(_MeasureAzimuthDOM);
            var _SelectorID = __webpack_require__(2);
            var _SelectorID2 = _interopRequireDefault(_SelectorID);
            function _interopRequireDefault(obj) {
                return obj && obj.__esModule ? obj : { default: obj };
            }
            var logger = _LoggerByDefault2.default.getLogger('measureazimut');
            function MeasureAzimuth(options) {
                options = options || {};
                if (!(this instanceof MeasureAzimuth)) {
                    throw new TypeError('ERROR CLASS_CONSTRUCTOR');
                }
                this.CLASSNAME = 'MeasureAzimuth';
                this._uid = _SelectorID2.default.generate();
                this._showContainer = null;
                this._pictoContainer = null;
                this._initialize(options);
                var container = options.element ? options.element : this._initializeContainer();
                _ol2.default.control.Control.call(this, {
                    element: container,
                    target: options.target,
                    render: options.render
                });
            }
            _ol2.default.inherits(MeasureAzimuth, _ol2.default.control.Control);
            MeasureAzimuth.prototype = Object.create(_ol2.default.control.Control.prototype, {});
            _Utils2.default.assign(MeasureAzimuth.prototype, _Measures2.default);
            _Utils2.default.assign(MeasureAzimuth.prototype, _MeasureAzimuthDOM2.default);
            MeasureAzimuth.prototype.constructor = MeasureAzimuth;
            MeasureAzimuth.prototype.setMap = function (map) {
                logger.trace('setMap()');
                var className = this.CLASSNAME;
                if (map) {
                    if (!this.options.target) {
                        _MeasureToolBox2.default.add(map, this);
                    }
                } else {
                    this.clean();
                }
                this.tools[className].instance = map ? this : null;
                _ol2.default.control.Control.prototype.setMap.call(this, map);
            };
            MeasureAzimuth.prototype.setGeodesic = function (value) {
                this.options.geodesic = typeof value !== 'undefined' ? value : false;
            };
            MeasureAzimuth.prototype.isGeodesic = function () {
                return this.options.geodesic;
            };
            MeasureAzimuth.prototype._initialize = function (options) {
                logger.trace('call MeasureAzimuth::_initialize() : ', options);
                this.options = {};
                this.options.geodesic = typeof options.geodesic !== 'undefined' ? options.geodesic : false;
                this.options.target = typeof options.target !== 'undefined' ? options.target : null;
                this.options.render = typeof options.render !== 'undefined' ? options.render : null;
                this.createStylingMeasureInteraction(options.styles);
            };
            MeasureAzimuth.prototype._initializeContainer = function () {
                logger.trace('call MeasureAzimuth::_initializeContainer() : ', this._uid);
                var container = this._createMainContainerElement();
                var show = this._showContainer = this._createShowMeasureAzimuthElement();
                container.appendChild(show);
                this._showContainer.checked = false;
                var picto = this._pictoContainer = this._createShowMeasureAzimuthPictoElement();
                container.appendChild(picto);
                return container;
            };
            MeasureAzimuth.prototype.addMeasureEvents = function () {
                logger.trace('call MeasureAzimuth::addMeasureEvents()');
                var map = this.getMap();
                map.on('singleclick', this.onPointerMoveAzimutHandler, this);
                map.on('pointermove', this.onPointerMoveAzimutHandler, this);
            };
            MeasureAzimuth.prototype.removeMeasureEvents = function () {
                logger.trace('call MeasureAzimuth::removeMeasureEvents()');
                var map = this.getMap();
                map.un('singleclick', this.onPointerMoveAzimutHandler, this);
                map.un('pointermove', this.onPointerMoveAzimutHandler, this);
            };
            MeasureAzimuth.prototype.format = function (line) {
                logger.trace('call MeasureAzimuth::format()');
                var map = this.getMap();
                var sourceProj = map.getView().getProjection();
                var c1 = _ol2.default.proj.transform(line.getFirstCoordinate(), sourceProj, 'EPSG:4326');
                var c2 = _ol2.default.proj.transform(line.getLastCoordinate(), sourceProj, 'EPSG:4326');
                if (!this.options.geodesic) {
                    var wgs84Sphere = new _ol2.default.Sphere(6378137);
                    var lengthGeodesic = wgs84Sphere.haversineDistance(c1, c2);
                    logger.trace('measure between 2 points with geodesic method', lengthGeodesic);
                    if (lengthGeodesic > 500) {
                        var fraction = 500 / lengthGeodesic;
                        logger.trace('%', fraction);
                        c2 = _ol2.default.proj.transform(line.getCoordinateAt(fraction), sourceProj, 'EPSG:4326');
                    }
                }
                var degrees2radians = Math.PI / 180;
                var radians2degrees = 180 / Math.PI;
                var lon1 = degrees2radians * c1[0];
                var lon2 = degrees2radians * c2[0];
                var lat1 = degrees2radians * c1[1];
                var lat2 = degrees2radians * c2[1];
                var a = Math.sin(lon2 - lon1) * Math.cos(lat2);
                var b = Math.cos(lat1) * Math.sin(lat2) - Math.sin(lat1) * Math.cos(lat2) * Math.cos(lon2 - lon1);
                var atan = Math.atan2(a, b);
                var azimut = radians2degrees * atan;
                logger.trace('azimut', azimut);
                if (azimut < 0) {
                    azimut += 360;
                }
                var output = Math.round(azimut * 100) / 100 + ' \xB0';
                return output;
            };
            MeasureAzimuth.prototype.onShowMeasureAzimuthClick = function (e) {
                logger.trace('call MeasureAzimuth::onShowMeasureAzimuthClick()', e);
                this.onShowMeasureClick(e, 'LineString');
            };
            MeasureAzimuth.prototype.onPointerMoveAzimutHandler = function (e) {
                this.onPointerMoveHandler(e);
                if (this.sketch) {
                    var geom = this.sketch.getGeometry();
                    if (geom.getCoordinates().length > 2) {
                        this.measureDraw.finishDrawing();
                    }
                }
            };
            exports.default = MeasureAzimuth;
            return exports;
        },
        function (module, exports, __webpack_require__) {
            'use strict';
            Object.defineProperty(exports, '__esModule', { value: true });
            var MeasureAzimuthDOM = {
                _addUID: function _addUID(id) {
                    var uid = this._uid ? id + '-' + this._uid : id;
                    return uid;
                },
                _createMainContainerElement: function _createMainContainerElement() {
                    var container = document.createElement('div');
                    container.id = this._addUID('GPmeasureAzimuth');
                    container.className = 'GPwidget';
                    return container;
                },
                _createShowMeasureAzimuthElement: function _createShowMeasureAzimuthElement() {
                    var input = document.createElement('input');
                    input.id = this._addUID('GPshowMeasureAzimuth');
                    input.type = 'checkbox';
                    return input;
                },
                _createShowMeasureAzimuthPictoElement: function _createShowMeasureAzimuthPictoElement() {
                    var context = this;
                    var label = document.createElement('label');
                    label.id = this._addUID('GPshowMeasureAzimuthPicto');
                    label.className = 'GPshowAdvancedToolPicto';
                    label.htmlFor = this._addUID('GPshowMeasureAzimuth');
                    label.title = 'Mesurer un azimut';
                    if (label.addEventListener) {
                        label.addEventListener('click', function (e) {
                            context.onShowMeasureAzimuthClick(e);
                        });
                    } else if (label.attachEvent) {
                        label.attachEvent('onclick', function (e) {
                            context.onShowMeasureAzimuthClick(e);
                        });
                    }
                    var spanOpen = document.createElement('span');
                    spanOpen.id = this._addUID('GPshowMeasureAzimuthOpen');
                    spanOpen.className = 'GPshowAdvancedToolOpen';
                    label.appendChild(spanOpen);
                    return label;
                }
            };
            exports.default = MeasureAzimuthDOM;
            return exports;
        }
    ])['default'];
}));
IMap = function (Logger) {
    function IMap(opts) {
        var iMap = this;
        if (!(this instanceof IMap)) {
            throw new TypeError('IMap constructor cannot be called as a function.');
        }
        this._opts = opts;
        this.logger = Logger.getLogger('IMap');
        this.logger.trace('[Constructeur IMap (options)]');
        this._layers = [];
        this._layersRemoved = [];
        this._controls = [];
        this._events = {};
        if (this._opts.mapOptions) {
            this.apiKey = this._opts.mapOptions.apiKey;
        }
        this.div = this._opts.div;
        this.mapOptions = Object.create(IMap.DEFAULTOPTIONS);
        for (var opt in this._opts.mapOptions) {
            if (this._opts.mapOptions.hasOwnProperty(opt)) {
                this.mapOptions[opt] = this._opts.mapOptions[opt];
                this.logger.trace('option ' + opt + ' récupérée');
            }
        }
        this._initMap();
    }
    IMap.DEFAULTOPTIONS = {
        projection: 'EPSG:3857',
        center: {
            x: 0,
            y: 0,
            projection: 'EPSG:4326',
            geolocate: false,
            location: null,
            locationType: [
                'StreetAddress',
                'PositionOfInterest'
            ]
        },
        azimuth: 0,
        enableRotation: true,
        tilt: 0,
        zoom: 10,
        minZoom: 0,
        maxZoom: 21,
        reloadConfig: false,
        controlsOptions: {
            draggable: true,
            keyboard: true,
            selectable: true
        },
        mapEventsOptions: {},
        noProxyDomains: ['wxs.ign.fr']
    };
    IMap.DEFAULT_AUTOPAN_OPTIONS = {
        autoPan: true,
        duration: 250,
        margin: 5
    };
    IMap.DEFAULT_MEAS_STYLES = {
        pointer: {
            strokeColor: '#002A50',
            strokeWidth: 2,
            radius: 5,
            fillColor: 'rgba(255, 155, 0, 0.7)'
        },
        start: {
            strokeColor: '#002A50',
            strokeWidth: 2,
            strokeLineDash: '[10, 10]',
            fillColor: 'rgba(0, 183, 152, 0.2)'
        },
        finish: {
            strokeColor: '#002A50',
            strokeWidth: 3,
            fillColor: 'rgba(0, 183, 152, 0.3)'
        }
    };
    IMap.DEFAULT_VECTORLAYERS_STYLES = {
        markerSrc: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARDSURBVFiF3ZndaxxVGMZ/Z/YjX00Nadpo1qrFBgu56D9QbAtiLoRC7ywSNK1NURRREBKRFlSwFBW0gnSrJXY1CmISgyjFiyYSFC9ajE3MmpjdjWlMUtNos9lN9mteLzbRuCbZmTMTBB+Yi51znvd5n3nPnjnnjBIR/i/wuh4xpCpI0ojiENAA1AE1wCzwKzCE0EM5l2iShJvSyrXKnFVb8dOK4hmg3AIjifAmaU7ztMy7kYI7Zs6rQwjvka+AXcyiOMZx6XGahuE0AEHVitCFnhGAGoQugqrVaSrOKpNP4FWnSaxCGy1yWpesbyY/tLpwo7p/w0RxWHfI6Zk5q7ZSwhj6Q2sjzJLiXp1JQe+p+mllc4wA1CzHtw37lQmpCha5gbXpVxdJythh9z1kvzJJGrFixPBmOXixl+Z4mONmguZ4mIMXezG8WQsq5cs6tmDfTP7NXiSqN0vTzBD1TQfwbdmDUhX4tuyhvukATTNDlgxZ0SmUtUsgv0TZGPsv9FNSvXfNtpLqvey/0O+KTgF0zNQV7XHP4dsdtVvVKYCOmeqiPbwVOx21W9UpgI6ZWNEe2cSEo3arOgWwb0YYLp5G17Sjdqs6BdCZzYqL9B3dR2puYM221NwAfUf3uaJTAB0zaye5GmbWS6i2gdFQL5mFMCIJMgthRkO9hGobMLPFN4VWdAoptlcAQeUDRoG77YrZwDhQT4tk7JDsV6ZFMggv2+bZwyt2jYDuQnOa94GIFrc4IkzRrkPUM3NKsijatLjF0copsbJ++xec7TTPqw6EI/oB/glT+PC+13Y/aSQNv/Is+tNer09lMn7DMHwAYppp8fvTIpISkVQsFrslqww4M9OuqkgzANzl1MhCyrjZGAycm573pK1yFCyi5FoWvo/FYlPOT2fOqftRXMbB9lkEs+3zbe2f/FD5i3YMj2p3vn8/IV8DZ5yE+Gqkot+JEQCPada5dRhxEriiQ5ya90w+272916F+KpnJDLhjpkUy5HgESNqhZU2Vfr5ne+dSFtOBeso06J6cnEy6d0z0hPwEPGeH8sGVykvfjpfe1NZUci2+mHg7Go2G8z/d/goQVJ9B8S1veMYffujduo/thl+ZwUzDuBqJRGZWt7n/FcDH46lFNVLilar1uiTTxsJTnTssH/QpJVlMNQa5wbGJiWERya3Vz30zzfLb3OveY3dU5j5dp4e80Xdbd3TOu/H/yyAtpjnqgeGS8crRQRks+v5xf5gtY/KM/6NAVebhwvv90bLvHu2o/XId2pJSMmIaxo/RaHRMxN6yZtPM0K5K/7hl/FxVZgZWbs0mPDceeKcuGE95/kpSKUmaImHDNIfHrl+PiIj2zOb+MFvBY7IUOVl2ZG9g6bJH4ckJuRe/2NYZT3myKIkrGM4pNRyLjY+LW09URDb1+uaF0pfm3zJ+7zhRGdq1c9eDuwOBOzdLa/OG2X+APwE8DU64Y/5gfAAAAABJRU5ErkJggg==',
        markerXAnchor: 25.5,
        markerYAnchor: 38,
        strokeColor: '#002A50',
        strokeWidth: 4,
        strokeOpacity: 0.8,
        polyFillColor: '#00B798',
        polyFillOpacity: 0.5,
        textStrokeColor: '#000000',
        textColor: '#FFFFFF'
    };
    IMap.WMTSDEFAULTS = {
        'EPSG:3857': {
            resolutions: [
                156543.033928041,
                78271.51696402048,
                39135.758482010235,
                19567.87924100512,
                9783.93962050256,
                4891.96981025128,
                2445.98490512564,
                1222.99245256282,
                611.49622628141,
                305.7481131407048,
                152.8740565703525,
                76.43702828517624,
                38.21851414258813,
                19.10925707129406,
                9.554628535647032,
                4.777314267823516,
                2.388657133911758,
                1.194328566955879,
                0.5971642834779395,
                0.2985821417389697,
                0.1492910708694849,
                0.0746455354347424
            ],
            scales: {
                0: 559082264,
                1: 279541132,
                2: 139770566,
                3: 69885283,
                4: 34942642,
                5: 17471321,
                6: 8735660,
                7: 4367830,
                8: 2183915,
                9: 1091958,
                10: 545979,
                11: 272989,
                12: 136495,
                13: 68247,
                14: 34124,
                15: 17062,
                16: 8531,
                17: 4265,
                18: 2133,
                19: 1066,
                20: 533,
                21: 267
            },
            threshold: 1e-7,
            topLeftCorner: {
                x: -20037508,
                y: 20037508
            }
        },
        'EPSG:4326': {
            resolutions: [
                1.40625,
                0.703125,
                0.3515625,
                0.17578125,
                0.087890625,
                0.0439453125,
                0.02197265625,
                0.010986328125,
                0.0054931640625,
                0.00274658203125,
                0.001373291015625,
                0.0006866455078125,
                0.00034332275390625,
                0.000171661376953126,
                0.0000858306884765628,
                0.0000429153442382813,
                0.0000214576721191407,
                0.0000107288360595703,
                0.00000536441802978517,
                0.00000268220901489259,
                0.0000013411045074463,
                6.70552253723145e-7,
                3.3527612686157e-7
            ],
            threshold: 1e-10,
            topLeftCorner: {
                x: 90,
                y: -180
            }
        },
        'EPSG:2154': {
            resolutions: [
                104579.22454989408,
                52277.53235379051,
                26135.487078595408,
                13066.891381800004,
                6533.228604113456,
                3266.5595244626675,
                1633.2660045974187,
                816.6295549860224,
                408.31391467683596,
                204.15674151090204,
                102.07831678324082,
                51.0391448966112,
                25.519569074269395,
                12.759783693647506,
                6.379891635966491,
                3.18994576530532,
                1.5949728694977277,
                0.7974864315474559,
                0.398743214900604,
                0.19937160727567999,
                0.099685803696052,
                0.049842901818919996
            ],
            threshold: 1e-8,
            topLeftCorner: {
                x: 0,
                y: 12000000
            }
        }
    };
    IMap._hexToRgba = function (hex, opacity) {
        var shorthandRegex = /^#?([a-f\d])([a-f\d])([a-f\d])$/i;
        hex = hex.replace(shorthandRegex, function (m, r, g, b) {
            return r + r + g + g + b + b;
        });
        var rgb = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
        rgb = rgb ? {
            r: parseInt(rgb[1], 16),
            g: parseInt(rgb[2], 16),
            b: parseInt(rgb[3], 16)
        } : null;
        var result = rgb ? 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', ' + opacity + ')' : null;
        return result;
    };
    IMap.CustomEvent = function (eventId, eventObj) {
        if (typeof CustomEvent === 'function') {
            eventObj.bubbles = false;
            eventObj.cancelable = true;
            return new CustomEvent(eventId, eventObj);
        }
        var e = document.createEvent('CustomEvent');
        e.initCustomEvent(eventId, false, true, eventObj.detail);
        return e;
    };
    IMap.prototype = {
        constructor: IMap,
        _getDefaultControls: function () {
            return {
                draggable: true,
                keyboard: true,
                selectable: false,
                zoom: {},
                attributions: { maximised: false }
            };
        },
        _afterInitMap: function () {
            var meOptions = this.mapOptions.mapEventsOptions;
            if (meOptions) {
                for (var evtId in meOptions) {
                    this.listen(evtId, meOptions[evtId], this);
                }
            }
            this.listen('layerChanged', this._onLayerChanged, this);
            this.setXYCenter(this.mapOptions.center);
            var needsGetConfig = false;
            if (this.apiKey || this._opts.mapOptions.configUrl || this._opts.mapOptions.autoconfUrl) {
                needsGetConfig = this._opts.reloadConfig || !Gp.Config || !Gp.Config.isConfLoaded(Array.isArray(this.apiKey) ? this.apiKey[0] : this.apiKey);
            } else {
                if (Gp.Config) {
                    this.apiKey = Object.keys(Gp.Config.generalOptions.apiKeys);
                }
            }
            if (needsGetConfig) {
                var callbackSuffix = this._opts.mapOptions.callbackSuffix;
                if (this._opts.mapOptions.configUrl || this._opts.mapOptions.autoconfUrl) {
                    callbackSuffix = callbackSuffix || '';
                }
                var map = this;
                Gp.Services.getConfig({
                    apiKey: this.apiKey,
                    serverUrl: this._opts.mapOptions.configUrl || this._opts.mapOptions.autoconfUrl,
                    callbackSuffix: callbackSuffix,
                    onSuccess: function (configResponse) {
                        map._afterGetConfig(configResponse);
                    },
                    onFailure: function (error) {
                        console.log(error);
                        map._afterGetConfig(null);
                    }
                });
            } else {
                this._afterGetConfig(Gp.Config);
            }
        },
        _afterGetConfig: function (configResponse) {
            this.logger.trace('[IMap] : Autoconfiguration chargée ... ou pas');
            var e = IMap.CustomEvent('configured', { detail: { config: configResponse } });
            this.div.dispatchEvent(e);
            if (configResponse && !this.mapOptions.hasOwnProperty('layersOptions')) {
                this.mapOptions.layersOptions = { 'ORTHOIMAGERY.ORTHOPHOTOS': {} };
            }
            if (configResponse && (!this.mapOptions.center.hasOwnProperty('x') || this.mapOptions.center.x == 0) && (!this.mapOptions.center.hasOwnProperty('y') || this.mapOptions.center.y == 0)) {
                var autoconfCenter;
                var autoconfProj;
                var defaultCenter;
                var territories = configResponse.getTerritories();
                for (var terrCode in territories) {
                    if (territories[terrCode].isDefault) {
                        autoconfCenter = territories[terrCode].geoCenter;
                    }
                }
                this.logger.trace('[IMap] : _afterGetConfig : setting default map center to (' + autoconfCenter.lon + ',' + autoconfCenter.lat + ')');
                this.mapOptions.center.x = autoconfCenter.lon;
                this.mapOptions.center.y = autoconfCenter.lat;
                this.mapOptions.center.projection = 'EPSG:4326';
            }
            this.setCenter(this.mapOptions.center);
            if (this.mapOptions.hasOwnProperty('markersOptions')) {
                this._addMarkers(this.mapOptions.markersOptions);
            }
            this.addLayers(this.mapOptions.layersOptions);
            this.addControls(this._getDefaultControls());
            this.addControls(this.mapOptions.controlsOptions);
            var eMapLoaded = IMap.CustomEvent('mapLoaded', { detail: { map: this } });
            this.div.dispatchEvent(eMapLoaded);
            return;
        },
        _initMap: function () {
            this.logger.trace('[IMap] : _initMap');
        },
        _getZoomFromResolution: function (resolution, projCode) {
            this.logger.trace('[IMap] : _getZoomFromResolution');
            var mapProj = this.getProjection();
            var wmtsDefaults = IMap.WMTSDEFAULTS[projCode] || IMap.WMTSDEFAULTS[mapProj] || IMap.WMTSDEFAULTS['EPSG:3857'];
            var zoom = 0;
            var diffMin = Math.abs(wmtsDefaults.resolutions[0] - resolution);
            for (var i = 1; i < wmtsDefaults.resolutions.length; i++) {
                var diff = Math.abs(wmtsDefaults.resolutions[i] - resolution);
                if (diff >= diffMin) {
                    break;
                }
                zoom = i;
                diffMin = diff;
            }
            return zoom;
        },
        _getResolutionFromZoomLevel: function (zoom, projCode) {
            this.logger.trace('[IMap] : _getResolutionFromZoomLevel');
            var mapProj = this.getProjection();
            var wmtsDefaults = IMap.WMTSDEFAULTS[projCode] || IMap.WMTSDEFAULTS[mapProj] || IMap.WMTSDEFAULTS['EPSG:3857'];
            var res = -1;
            if (zoom >= 0 && zoom < wmtsDefaults.resolutions.length) {
                res = wmtsDefaults.resolutions[zoom];
            } else {
                console.log('unhandled zoom level : ' + zoom);
            }
            return res;
        },
        _getWMTSDefaultOpts: function () {
            this.logger.trace('[IMap] : _getWMTSDefaultOpts');
            var wmtsOpts = {
                version: '1.0.0',
                outputFormat: 'image/jpeg'
            };
            var matrixIds = [];
            for (var i = 0; i <= 20; i++) {
                matrixIds.push('' + i);
            }
            wmtsOpts.matrixIds = matrixIds;
            var resolutions = null;
            var topLeftCorner = null;
            var mapProj = this.getProjection();
            if (typeof mapProj != 'string' || ['EPSG:3857'].indexOf(mapProj.toUpperCase()) >= 0) {
                resolutions = IMap.WMTSDEFAULTS['EPSG:3857'].resolutions;
                topLeftCorner = IMap.WMTSDEFAULTS['EPSG:3857'].topLeftCorner;
            } else if ([
                    'EPSG:4326',
                    'CRS:84'
                ].indexOf(mapProj.toUpperCase()) >= 0) {
                resolutions = IMap.WMTSDEFAULTS['EPSG:4326'].resolution7s;
                topLeftCorner = IMap.WMTSDEFAULTS['EPSG:4326'].topLeftCorner;
            } else if (['EPSG:2154'].indexOf(mapProj.toUpperCase()) >= 0) {
                resolutions = IMap.WMTSDEFAULTS['EPSG:2154'].resolution7s;
                topLeftCorner = IMap.WMTSDEFAULTS['EPSG:2154'].topLeftCorner;
            }
            if (resolutions) {
                wmtsOpts.resolutions = resolutions;
                wmtsOpts.topLeftCorner = topLeftCorner;
            }
            return wmtsOpts;
        },
        centerGeocode: function (opts) {
            if (!Gp.Config || !this.apiKey) {
                console.log('no rights for geocoding services');
                return;
            }
            var layersIds = Gp.Config.getLayersId(this.apiKey);
            var locTypes = opts.locationType || [
                'StreetAddress',
                'PositionOfInterest'
            ];
            var fo = {};
            fo.type = [];
            while (locTypes.length > 0) {
                var lt = locTypes.pop();
                if (layersIds.indexOf(lt + '$OGC:OPENLS;Geocode') >= 0) {
                    this.logger.trace('[IMap] centerGeocode : found rights for ' + lt);
                    fo.type.push(lt);
                }
            }
            if (fo.type.length == 0) {
                console.log('no rights for geocoding services');
                return;
            }
            var map = this;
            Gp.Services.geocode({
                apiKey: this.apiKey,
                location: opts.location,
                filterOptions: fo,
                onSuccess: function (geocodeResponse) {
                    map.logger.trace('[IMap] found center by geocoding (' + geocodeResponse.locations[0].position.x + ',' + geocodeResponse.locations[0].position.y + ')');
                    var point = {
                        x: geocodeResponse.locations[0].position.y,
                        y: geocodeResponse.locations[0].position.x,
                        projection: 'EPSG:4326'
                    };
                    map.setAutoCenter(point);
                    var e = IMap.CustomEvent('located', { detail: { position: point } });
                    map.div.dispatchEvent(e);
                },
                onFailure: function (error) {
                    console.log('Erreur du service de géocodage !!!');
                }
            });
        },
        centerGeolocate: function () {
            var map = this;
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    map.logger.trace('[IMap] found center by geolocation (' + position.coords.longitude + ',' + position.coords.latitude + ')');
                    var point = {
                        x: position.coords.longitude,
                        y: position.coords.latitude,
                        projection: 'EPSG:4326'
                    };
                    map.setAutoCenter(point, 17);
                    var e = IMap.CustomEvent('geolocated', { detail: { position: point } });
                    map.div.dispatchEvent(e);
                }, function (error) {
                    var info = 'Erreur lors de la géolocalisation : ';
                    switch (error.code) {
                    case error.TIMEOUT:
                        info += 'Timeout !';
                        break;
                    case error.PERMISSION_DENIED:
                        info += 'Vous n\u2019avez pas donné la permission';
                        break;
                    case error.POSITION_UNAVAILABLE:
                        info += 'La position n\u2019a pu être déterminée';
                        break;
                    case error.UNKNOWN_ERROR:
                        info += 'Erreur inconnue';
                        break;
                    }
                    console.log(info);
                });
            } else {
                console.log('Geolocate impossible');
            }
        },
        setProxy: function (url) {
            return Gp.ProxyUtils.proxifyUrl(url, this.mapOptions);
        },
        getProjection: function () {
            return '';
        },
        getCenter: function () {
            return {};
        },
        getViewExtent: function () {
            return {};
        },
        getTilt: function () {
            return 0;
        },
        getAzimuth: function () {
            return 0;
        },
        getZoom: function () {
            return 0;
        },
        getResolution: function () {
            return 0;
        },
        getLib: function () {
            return this.mapOptions.library;
        },
        _getLayersObj: function (layerIds) {
            var _layerObjs = [];
            this._layers.forEach(function (layer, i, array) {
                if (layerIds.indexOf(layer.id) < 0) {
                    this.logger.trace('[IMap] _getLayersObj : ' + layer.id + ' not found.');
                    return;
                }
                this.logger.trace('[IMap] _getLayersObj : found obj for : ' + layer.id);
                _layerObjs.push(layer);
            }, this);
            return _layerObjs;
        },
        getLayersOptions: function (layerIds) {
            if (!layerIds || Array.isArray(layerIds) && layerIds.length == 0) {
                layerIds = [];
                this._layers.forEach(function (layer) {
                    layerIds.push(layer.id);
                }, this);
            }
            var layersOptions = {};
            this._layers.sort(function (l1, l2) {
                return l1.options.position - l2.options.position;
            });
            if (!Array.isArray(layerIds)) {
                layerIds = [layerIds];
            }
            this._layers.forEach(function (layer) {
                if (layerIds.indexOf(layer.id) < 0) {
                    return;
                }
                layersOptions[layer.id] = layer.options;
            }, this);
            return layersOptions;
        },
        getControlsOptions: function (controlIds) {
            if (!controlIds || Array.isArray(controlIds) && controlIds.length == 0) {
                controlIds = [];
                this._controls.forEach(function (control) {
                    controlIds.push(control.id);
                }, this);
            }
            var controlsOptions = {};
            if (!Array.isArray(controlIds)) {
                controlIds = [controlIds];
            }
            this._controls.forEach(function (control) {
                if (controlIds.indexOf(control.id) < 0) {
                    return;
                }
                controlsOptions[control.id] = control.options;
            }, this);
            return controlsOptions;
        },
        getLibMapControl: function (controlId) {
            var olControl = null;
            return olControl;
        },
        getLibMap: function () {
            return {};
        },
        setProjection: function (projection) {
        },
        setCenter: function (center) {
            this.logger.trace('[IMap] : setCenter');
            if (!center) {
                return;
            }
            if (center.hasOwnProperty('x') && center.hasOwnProperty('y')) {
                this.logger.trace('[IMap] : setCenter - x,y');
                this.setXYCenter(center);
            }
            if (center.geolocate) {
                this.logger.trace('[IMap] : setCenter - geolocate');
                this.centerGeolocate();
            }
            if (center.location && center.location.trim().length > 0) {
                this.logger.trace('[IMap] : setCenter - geocode');
                this.centerGeocode(center);
            }
        },
        setXYCenter: function (point) {
        },
        setAutoCenter: function (point) {
        },
        setTilt: function (tilt) {
        },
        setAzimuth: function (azimuth) {
        },
        setZoom: function (zoom) {
        },
        setResolution: function (resolution) {
        },
        zoomIn: function () {
        },
        zoomOut: function () {
        },
        switchToLibITOL3: function (library) {
            var oldMap = {};
            oldMap.projection = this.getProjection();
            oldMap.center = this.getCenter();
            oldMap.tilt = this.getTilt();
            oldMap.azimuth = this.getAzimuth();
            oldMap.zoom = this.getZoom();
            oldMap.layersOptions = this.getLayersOptions();
            oldMap.controlsOptions = this.getControlsOptions();
            oldMap.mapDiv = this.div.id;
            oldMap.apiKey = this.apiKey;
            oldMap.enginePath3d = this.mapOptions.enginePath3d || null;
            for (var controlId in oldMap.controlsOptions) {
                this.removeControls(controlId);
            }
            if (library === 'itowns') {
                if (this._3Dlayers) {
                    for (var l = 0; l < this._3Dlayers.length; l++) {
                        oldMap.layersOptions[this._3Dlayers[l].id] = this._3Dlayers[l].options;
                    }
                }
                oldMap.center = [
                    oldMap.center.x,
                    oldMap.center.y
                ];
                var lonlat = ol.proj.transform(oldMap.center, oldMap.projection, 'EPSG:4326');
                oldMap.center = {
                    x: lonlat[0],
                    y: lonlat[1]
                };
                oldMap.azimuth = this.getAzimuth();
                this.libMap.setTarget(null);
            } else if (library === 'ol3') {
                oldMap.center = [
                    oldMap.center.lon,
                    oldMap.center.lat
                ];
                var xy = ol.proj.transform(oldMap.center, 'EPSG:4326', 'EPSG:3857');
                oldMap.center = {
                    x: xy[0],
                    y: xy[1]
                };
                for (var listeners in this._events) {
                    var keyIdx = 0;
                    var eventName = Object.keys(this._events)[keyIdx];
                    for (var i = 0; i < this._events[listeners].length; i++) {
                        this.forget(eventName, this._events[listeners][i].action);
                    }
                    keyIdx++;
                }
                while (this.div.firstChild) {
                    this.div.removeChild(this.div.firstChild);
                }
            } else {
                console.log('Unknown Library');
                return;
            }
            var newMap = Gp.Map.load(oldMap.mapDiv, {
                apiKey: oldMap.apiKey,
                enginePath3d: oldMap.enginePath3d || null,
                projection: oldMap.projection,
                center: oldMap.center,
                azimuth: oldMap.azimuth,
                tilt: oldMap.tilt,
                zoom: oldMap.zoom,
                library: library,
                layersOptions: oldMap.layersOptions,
                controlsOptions: oldMap.controlsOptions
            });
            return newMap;
        },
        _addMarkers: function (markersOptions) {
            this.logger.trace('[IMap] _addMarkers : generic function');
        },
        addLayers: function (layersOptions) {
            if (!layersOptions) {
                this.logger.trace('[IMap] addLayers : no layers to add');
                return;
            }
            this.listen('layerChanged', this._onLayerChanged, this);
            var layerId = null;
            for (layerId in layersOptions) {
                if (this._getLayersObj([layerId]).length > 0) {
                    console.log('Layer [' + layerId + '] already added to map.');
                    return;
                }
                this.logger.trace('[IMap] addLayers : adding : [' + layerId + ']');
                var layerOpts = layersOptions[layerId];
                var addLayerParam = {};
                addLayerParam[layerId] = layerOpts;
                if (!layerOpts.hasOwnProperty('url') && Gp.Config) {
                    var format = null;
                    if (layerOpts && layerOpts.format) {
                        format = layerOpts.format;
                    }
                    var layerConf = null;
                    if (format == null || format.toUpperCase() == 'WMTS') {
                        layerConf = Gp.Config.getLayerConf(layerId + '$GEOPORTAIL:OGC:WMTS');
                        if (layerConf) {
                            format = 'WMTS';
                        }
                    }
                    if (format == null || format.toUpperCase() == 'WMS') {
                        layerConf = Gp.Config.getLayerConf(layerId + '$GEOPORTAIL:OGC:WMS');
                        if (layerConf) {
                            format = 'WMS';
                        } else {
                            layerConf = Gp.Config.getLayerConf(layerId + '$INSPIRE:OGC:WMS');
                            if (layerConf) {
                                format = 'WMS';
                            }
                        }
                    }
                    if (layerConf) {
                        this.logger.trace('[IMap] addLayers : [' + layerId + '] is a geoportalLayer. Adding inner properties.');
                        addLayerParam[layerId].format = format;
                        addLayerParam[layerId].originators = addLayerParam[layerId].originators || layerConf.originators;
                        addLayerParam[layerId] = this._layerOptions2layerConf(layerConf, addLayerParam[layerId]);
                    }
                    switch (format) {
                    case 'WMTS':
                    case 'WMS':
                        this._addGeoportalLayer(addLayerParam, layerConf);
                        continue;
                    default:
                        this.logger.trace('[IMap] addLayers : [' + layerId + '] is not a Geoportal Layer');
                    }
                }
                if (!layerOpts.hasOwnProperty('format') || typeof layerOpts.format != 'string') {
                    console.log('Impossible to add layer [' + layerId + '] : no format given');
                    continue;
                }
                if (!layerOpts.hasOwnProperty('url') || typeof layerOpts.url != 'string') {
                    console.log('Impossible to add layer [' + layerId + '] : no url given');
                    continue;
                }
                if (!this._checkLayerParams(layerOpts)) {
                    console.log('Impossible to add layer [' + layerId + '] : unsufficient or inadapted parameters given');
                    continue;
                }
                switch (layerOpts.format.toUpperCase()) {
                case 'georss':
                    break;
                case 'KML':
                case 'GPX':
                case 'GEOJSON':
                case 'WFS':
                case 'DRAWING':
                    this._addVectorLayer(addLayerParam);
                    break;
                case 'WMS':
                case 'WMTS':
                case 'OSM':
                    this._addRasterLayer(addLayerParam);
                    break;
                default:
                    console.log('Impossible to add layer [' + layerId + '] : unhandled format [' + layerOpts.format + ']');
                    break;
                }
            }
            this._resetLayerChangedEvent();
        },
        _checkLayerParams: function (layerOpts) {
            var missingParams = [];
            switch (layerOpts.format.toUpperCase()) {
            case 'WMS':
                if (!layerOpts.hasOwnProperty('layers') || !(layerOpts.layers instanceof Array)) {
                    missingParams.push('layers');
                }
                break;
            case 'WMTS':
                if (!layerOpts.hasOwnProperty('layer') || typeof layerOpts.layer != 'string') {
                    missingParams.push('layer');
                }
                if (!layerOpts.hasOwnProperty('tileMatrixSet') || typeof layerOpts.tileMatrixSet != 'string') {
                    missingParams.push('tileMatrixSet');
                }
                if (!layerOpts.hasOwnProperty('styleName') || typeof layerOpts.styleName != 'string') {
                    missingParams.push('styleName');
                }
                break;
            case 'WFS':
                if (!layerOpts.hasOwnProperty('typeNames') || typeof layerOpts.typeNames != 'string') {
                    missingParams.push('typeNames');
                }
                break;
            }
            if (missingParams.length > 0) {
                console.log('Impossible to add ' + layerOpts.format + ' layer : missing mandatory parameter(s) : ' + missingParams.toString());
                return false;
            }
            return true;
        },
        _addRasterLayer: function (layerObj) {
        },
        _addVectorLayer: function (layerObj) {
        },
        _addGeoportalLayer: function (layerObj) {
        },
        removeLayers: function (layerIds) {
            if (!layerIds || Array.isArray(layerIds) && layerIds.length == 0) {
                console.log('removeLayers : nothing to remove !');
                return false;
            }
            if (!Array.isArray(layerIds)) {
                layerIds = [layerIds];
            }
            return true;
        },
        _applyCommonLayerParams: function (layerOpts) {
            return {};
        },
        modifyLayers: function (layersOptions) {
            if (!layersOptions) {
                console.log('modifyLayers : nothing to modify !');
                return false;
            }
            var layerIds = Object.keys(layersOptions);
            if (!layerIds || !Array.isArray(layerIds)) {
                console.log('modifyLayers : wrong format for layersOptions !');
                return false;
            }
            return true;
        },
        _findRegisteredControl: function (controlId) {
            var regCtrl = -1;
            if (!controlId || typeof controlId != 'string') {
                this.logger.warn('[IMap] _findRegisteredControl : controlId is not a straight string');
                return regCtrl;
            }
            for (var i = 0; i < this._controls.length; i++) {
                if (this._controls[i].id.toLowerCase() == controlId.toLowerCase()) {
                    this.logger.trace('[IMap] _findRegisteredControl : found control ' + controlId + ' at index : ' + i);
                    return i;
                }
            }
            this.logger.trace('[IMap] _findRegisteredControl : control ' + controlId + ' not found.');
            return regCtrl;
        },
        addControls: function (controlsOptions) {
            this.logger.trace('[IMap] addControls');
            var controlId = null;
            for (controlId in controlsOptions) {
                var controlObj = null;
                var controlOpts = controlsOptions[controlId];
                var idx = -1;
                var libControl = this.getLibMapControl(controlId);
                idx = this._findRegisteredControl(controlId);
                if (idx >= 0 || libControl) {
                    this.logger.info('[IMap] addControls : [' + controlId + '] déjà présent.');
                    this.removeControls([controlId]);
                    if (controlOpts === null || controlOpts === undefined) {
                        continue;
                    }
                }
                this.logger.trace('[IMap] addControls : adding : [' + controlId + ']');
                switch (controlId.toLowerCase()) {
                case 'draggable':
                    controlObj = this.setDraggable(controlOpts);
                    break;
                case 'keyboard':
                    controlObj = this.setKeyboard(controlOpts);
                    break;
                case 'selectable':
                    controlObj = this.setSelectable(controlOpts);
                    break;
                case 'zoom':
                    controlObj = this.addZoomControl(controlOpts);
                    break;
                case 'zoombox':
                    controlObj = this._addZoomBoxControl(controlOpts);
                    break;
                case 'overview':
                    controlObj = this.addOverviewControl(controlOpts);
                    break;
                case 'orientation':
                    controlObj = this.addOrientationControl(controlOpts);
                    break;
                case 'graphicscale':
                    controlObj = this.addGraphicScaleControl(controlOpts);
                    break;
                case 'mouseposition':
                    controlObj = this.addMousePositionControl(controlOpts);
                    break;
                case 'route':
                    controlObj = this.addRouteControl(controlOpts);
                    break;
                case 'isocurve':
                    controlObj = this.addIsocurveControl(controlOpts);
                    break;
                case 'graticule':
                    controlObj = this.addGraticuleControl(controlOpts);
                    break;
                case 'layerswitcher':
                    controlObj = this.addLayerSwitcherControl(controlOpts);
                    break;
                case 'layerimport':
                    controlObj = this.addLayerImportControl(controlOpts);
                    break;
                case 'length':
                    controlObj = this.addLengthControl(controlOpts);
                    break;
                case 'area':
                    controlObj = this.addAreaControl(controlOpts);
                    break;
                case 'azimuth':
                    controlObj = this.addAzimuthControl(controlOpts);
                    break;
                case 'elevationpath':
                    controlObj = this.addElevationPathControl(controlOpts);
                    break;
                case 'search':
                    controlObj = this.addSearchControl(controlOpts);
                    break;
                case 'reversesearch':
                    controlObj = this.addReverseSearchControl(controlOpts);
                    break;
                case 'drawing':
                    controlObj = this.addDrawingControl(controlOpts);
                    break;
                case 'attributions':
                    controlObj = this.addAttributionsControl(controlOpts);
                    break;
                case 'camera':
                    controlObj = this.addCameraControl(controlOpts);
                    break;
                case 'getfeatureinfo':
                    controlObj = this.addGetFeatureInfoControl(controlOpts);
                    break;
                default:
                    console.log('Controle ' + controlId + 'inconnu.');
                    continue;
                }
                this.logger.trace('[IMap] addControls : registering : [' + controlId + ']');
                this._controls.push({
                    obj: controlObj || '2D-only-control',
                    id: controlId.toLowerCase(),
                    options: controlOpts
                });
            }
        },
        setDraggable: function (controlOpts) {
        },
        setKeyboard: function (controlOpts) {
        },
        setSelectable: function (controlOpts) {
        },
        addZoomControl: function (controlOpts) {
        },
        addZoomBoxControl: function (controlOpts) {
        },
        addOverviewControl: function (controlOpts) {
        },
        addOrientationControl: function (controlOpts) {
        },
        addGraphicScaleControl: function (controlOpts) {
        },
        addMousePositionControl: function (controlOpts) {
        },
        addRouteControl: function (controlOpts) {
        },
        addIsocurveControl: function (controlOpts) {
        },
        addGraticuleControl: function (controlOpts) {
        },
        addLayerSwitcherControl: function (controlOpts) {
        },
        addLayerImportControl: function (controlOpts) {
        },
        addLengthControl: function (controlOpts) {
        },
        addAreaControl: function (controlOpts) {
        },
        addAzimuthControl: function (controlOpts) {
        },
        addElevationPathControl: function (controlOpts) {
        },
        addSearchControl: function (controlOpts) {
        },
        addReverseSearchControl: function (controlOpts) {
        },
        addDrawingControl: function (controlOpts) {
        },
        addAttributionsControl: function (controlOpts) {
        },
        addCameraControl: function (controlOpts) {
        },
        addGetFeatureInfoControl: function (controlOpts) {
        },
        removeControls: function (controlIds) {
        },
        modifyControls: function (controlsOptions) {
            this.logger.trace('[IMap] : modifyControls ... ');
            var controlIds = Object.keys(controlsOptions);
            if (!controlIds || controlIds.length == 0) {
                console.log('No control to modify.');
                return;
            }
            var controlId = null;
            for (var i = 0; i < controlIds.length; i++) {
                controlId = controlIds[i];
                var controlObj = this.getLibMapControl(controlId);
                var idx = this._findRegisteredControl(controlId);
                if (idx >= 0) {
                    if (!controlObj) {
                        this.logger.trace('[IMap] : modifyControls : removing control : ' + controlId);
                        this.removeControls([controlId]);
                        delete controlsOptions[controlId];
                        continue;
                    }
                    var newCtrlOptions = this._controls[idx].options;
                    for (var opt in controlsOptions[controlId]) {
                        newCtrlOptions[opt] = controlsOptions[controlId][opt];
                    }
                    controlsOptions[controlId] = newCtrlOptions;
                } else if (!controlObj) {
                    delete controlsOptions[controlId];
                    continue;
                }
            }
            this.addControls(controlsOptions);
        },
        _getLayerIndexByLayerOpts: function (layerOpts) {
            if (!layerOpts) {
                return -1;
            }
            for (var i = 0; i < this._layers.length; i++) {
                var l = this._layers[i];
                if (layerOpts.hasOwnProperty(l.id)) {
                    return i;
                }
            }
            return -1;
        },
        _getLayerIndexByLayerId: function (layerId) {
            for (var i = 0; i < this._layers.length; i++) {
                var l = this._layers[i];
                if (layerId === l.id) {
                    return i;
                }
            }
            return -1;
        },
        _addLayerConfToLayerSwitcher: function (layerReg, layerConf) {
        },
        _onLayerChanged: function (evt) {
            var layerOpts = null;
            var idx = -1;
            var layerId = null;
            if (evt.hasOwnProperty('layerAdded')) {
                layerOpts = evt.layerAdded;
                idx = this._getLayerIndexByLayerOpts(layerOpts);
                this.logger.trace('[IMap] _onLayerChanged : layerAdded : ' + idx);
                if (idx >= 0 && idx < this._layers.length) {
                    layerId = this._layers[idx].id;
                    this._layers[idx].options.position = evt.position;
                    this.logger.trace('[IMap] _onLayerChanged : setting position value to ' + evt.position + ' for layer : ' + layerId);
                } else {
                    this.logger.warn('[IMap] _onLayerChanged : layerOpts (' + Object.keys(layerOpts)[0] + ') not found for layerAdded Event');
                }
            } else if (evt.hasOwnProperty('layerRemoved')) {
                layerOpts = evt.layerRemoved;
                idx = this._getLayerIndexByLayerOpts(layerOpts);
                if (idx >= 0 && idx < this._layers.length) {
                    this.logger.trace('[IMap] _onLayerChanged : removing layer at index ' + idx);
                    var layerRemoved = {};
                    layerRemoved['id'] = this._layers[idx].id;
                    layerRemoved['options'] = this._layers[idx].options;
                    layerRemoved['obj'] = this._layers[idx].obj;
                    this._layersRemoved.push(layerRemoved);
                    this._layers.splice(idx, 1);
                    this.logger.trace('[IMap] _onLayerChanged : #(layers) == ' + this._layers.length);
                } else {
                    this.logger.warn('[IMap] _onLayerChanged : layerOpts not found for layerRemoved Event');
                }
            } else if (evt.hasOwnProperty('layerChanged')) {
                layerOpts = evt.layerChanged;
                var idxx = this._getLayerIndexByLayerOpts(layerOpts);
                if (idxx >= 0 && idxx < this._layers.length) {
                    layerId = this._layers[idxx].id;
                    this._layers[idxx].options[evt.property] = evt.newValue;
                    this.logger.trace('[IMap] _onLayerChanged : setting ' + evt.property + ' value to ' + evt.newValue + ' for layer : ' + layerId);
                } else {
                    this.logger.warn('[IMap] _onLayerChanged : layerOpts (' + Object.keys(layerOpts)[0] + ') not found for layerChanged Event');
                }
            }
        },
        _filterEmptyMetadata: function (metadata) {
            if (!metadata || !Array.isArray(metadata)) {
                return metadata;
            }
            var fullMetadata = [];
            for (var i = 0; i < metadata.length; i++) {
                if (metadata[i].url && metadata[i].url.trim().length > 0) {
                    fullMetadata.push(metadata[i]);
                }
            }
            return fullMetadata;
        },
        _layerOptions2layerConf: function (layerOptions, layerConf) {
            var lConf = layerConf || {};
            lConf.title = lConf.title || layerOptions.title;
            lConf.description = lConf.description || layerOptions.description;
            lConf.quicklookUrl = lConf.quicklookUrl || layerOptions.quicklookUrl;
            lConf.legends = lConf.legends || layerOptions.legends;
            lConf.metadata = lConf.metadata || layerOptions.metadata;
            lConf.metadata = this._filterEmptyMetadata(lConf.metadata);
            return lConf;
        },
        getLSLayerContainerDivId: function (layerId) {
            var id = null;
            return id;
        },
        _registerEvent: function (eventKey, eventId, action, context) {
            this.logger.trace('[IMap] : listen registering : ' + eventKey);
            if (eventKey) {
                if (!this._events.hasOwnProperty(eventId)) {
                    this._events[eventId] = [];
                }
                this._events[eventId].push({
                    action: action,
                    key: eventKey,
                    context: context
                });
            }
            return this._events[eventId][this._events[eventId].length - 1];
        },
        listen: function (eventId, action, context) {
            if (typeof action != 'function') {
                console.log('no action provided for event : ' + eventId);
                return false;
            }
            context = context || this;
            var map = this;
            switch (eventId) {
            case 'mapFailure':
                break;
            case 'mapLoaded':
            case 'geolocated':
            case 'located':
            case 'configured':
                this.logger.trace('[IMap] listening event : [' + eventId + ']');
                var callBack = function (evt) {
                    action.call(context, evt.detail);
                };
                var registredEvent = map._registerEvent(callBack, eventId, action, context);
                registredEvent.eventOrigin = this.div;
                registredEvent.eventType = eventId;
                registredEvent.eventOrigin.addEventListener(registredEvent.eventType, callBack, this);
                break;
            case 'centerChanged':
            case 'zoomChanged':
            case 'azimuthChanged':
            case 'tiltChanged':
            case 'layerChanged':
                break;
            case 'projectionChanged':
            case 'controlChanged':
                break;
            default:
                console.log('unhandled event : ' + eventId);
                return false;
            }
            return true;
        },
        forget: function (eventId, action) {
            if (typeof action != 'function') {
                console.log('no action provided for event : ' + eventId);
                return false;
            }
            switch (eventId) {
            case 'mapLoaded':
            case 'geolocated':
            case 'located':
            case 'configured':
            case 'mapFailure':
            case 'centerChanged':
            case 'zoomChanged':
            case 'azimuthChanged':
            case 'tiltChanged':
            case 'projectionChanged':
            case 'layerChanged':
            case 'controlChanged':
            case 'pickFeature':
                var rEvents = this._events[eventId];
                if (!rEvents) {
                    console.log('nothing to forget for  : ' + eventId);
                    return false;
                }
                var itCallback = null;
                for (var i = rEvents.length - 1; i >= 0; i--) {
                    if (rEvents[i].action == action) {
                        if (!rEvents[i].eventOrigin) {
                            continue;
                        }
                        itCallback = rEvents[i].key;
                        var eventOrigin = rEvents[i].eventOrigin;
                        var eventType = rEvents[i].eventType;
                        if (!itCallback) {
                            console.log('action to forget not found for  : ' + eventId);
                            return false;
                        }
                        rEvents.splice(i, 1);
                        this.logger.trace('[IT]  : forgetting  : ' + eventId + ' (' + itCallback + ')');
                        eventOrigin.removeEventListener(eventType, itCallback);
                    }
                }
                if (!rEvents) {
                    console.log('action to forget not found for  : ' + eventId);
                    return false;
                }
                break;
            default:
                console.log('unhandled event : ' + eventId);
                return false;
            }
            return true;
        },
        _resetLayerChangedEvent: function () {
            if (this._events.hasOwnProperty('layerChanged')) {
                var actions = [];
                var contexts = [];
                this._events['layerChanged'].forEach(function (eventObj) {
                    if (actions.indexOf(eventObj.action) < 0) {
                        actions.push(eventObj.action);
                        contexts.push(eventObj.context);
                    }
                }, this);
                for (var i = 0; i < actions.length; ++i) {
                    this.forget('layerChanged', actions[i]);
                    this.listen('layerChanged', actions[i], contexts[i]);
                }
            }
        },
        _changeLayerColor: function (layerId, colorToGray) {
            return;
        }
    };
    return IMap;
}(UtilsLoggerByDefault);
it2IT = function (Logger, Loader, Plugins, Itowns, IMap) {
    function IT(opts) {
        if (!(this instanceof IT)) {
            throw new TypeError('IT constructor cannot be called as a function.');
        }
        this.CLASSNAME = 'IT';
        IMap.apply(this, arguments);
        this.logger = Logger.getLogger('IT');
        this.logger.trace('[Constructeur IT (options)]');
    }
    IT.LAYERPROPERTIES = {
        visible: 'visibility',
        opacity: 'opacity',
        sequence: 'position'
    };
    IT.CONTROLSCLASSES = {
        mouseposition: 'itowns.control.MousePosition',
        layerswitcher: 'itowns.control.LayerSwitcher',
        attributions: 'itowns.control.Attributions',
        overview: 'itowns.control.MiniGlobe',
        graphicscale: 'itowns.control.Scale'
    };
    IT.prototype = Object.create(IMap.prototype, {});
    IT.prototype.constructor = IT;
    IT.prototype._initMap = function () {
        this.logger.trace('[IT]  : _initMap');
        var _enginePath3d = Loader.getEnginePath(this.mapOptions.enginePath3d);
        Loader.loadEngine(_enginePath3d, function (itowns) {
            console.warn('Itowns engine, loaded...', itowns);
            for (var prop in Itowns) {
                if (Itowns.hasOwnProperty(prop)) {
                    itowns[prop] = Itowns[prop];
                }
            }
            Itowns = itowns;
            var positionOnGlobe = {
                longitude: this.mapOptions.center.x || 2,
                latitude: this.mapOptions.center.y || 48,
                altitude: 25000000
            };
            var viewerDiv = this.div;
            this.libMap = new Itowns.GlobeViewExtended(viewerDiv, positionOnGlobe, { maxSubdivisionLevel: 18 });
            var self = this;
            this.libMap.listen(Itowns.GlobeViewExtended.EVENTS.GLOBE_INITIALIZED, function () {
                window.setTimeout(function () {
                    self.div.style.visibility = '';
                }, 1);
                self.setZoom(parseFloat(self.mapOptions.zoom) || 10);
                self.setAzimuth(parseFloat(self.mapOptions.azimuth) || 0);
                self.setTilt(parseFloat(self.mapOptions.tilt) || 0);
                var isDragging = false;
                var mousedownHandler = function () {
                    isDragging = false;
                };
                var registredEvent = self._registerEvent(mousedownHandler, 'pickFeature', mousedownHandler, self);
                registredEvent.eventOrigin = self.div;
                registredEvent.eventType = 'mousedown';
                registredEvent.eventOrigin.addEventListener(registredEvent.eventType, mousedownHandler, self);
                var mousemoveHandler = function () {
                    isDragging = true;
                };
                var registredEvent = self._registerEvent(mousemoveHandler, 'pickFeature', mousemoveHandler, self);
                registredEvent.eventOrigin = self.div;
                registredEvent.eventType = 'mousemove';
                registredEvent.eventOrigin.addEventListener(registredEvent.eventType, mousemoveHandler, self);
                var mouseupHandler = function (evt) {
                    if (evt.which === 3 || isDragging) {
                        self._removeInfoDivs();
                    } else {
                        self._onMapClick(evt);
                    }
                };
                var registredEvent = self._registerEvent(mouseupHandler, 'pickFeature', mouseupHandler, self);
                registredEvent.eventOrigin = self.div;
                registredEvent.eventType = 'mouseup';
                registredEvent.eventOrigin.addEventListener(registredEvent.eventType, mouseupHandler, self);
                self._afterInitMap();
            });
        }, function (error) {
            console.warn('Itowns engine, failed...', error);
        }, this);
    };
    IT.prototype._onMapClick = function (evt) {
        this.logger.trace('[IT] : _onMapClick...');
        this._removeInfoDivs();
        var visibleFeatures = this.libMap.getFeaturesAtMousePosition(evt);
        if (visibleFeatures.length == 0) {
            return;
        }
        var content = this._features2html(visibleFeatures);
        var position = {
            x: evt.layerX,
            y: evt.layerY
        };
        this._displayInfo(position, content.innerHTML);
    };
    IT.prototype._removeInfoDivs = function () {
        var featureInfoDivs = document.getElementsByClassName('gp-feature-info-div-it');
        if (featureInfoDivs.length > 0) {
            for (var i = 0; i < featureInfoDivs.length; i++) {
                featureInfoDivs[i].parentNode.removeChild(featureInfoDivs[i]);
            }
        }
    };
    IT.prototype._features2html = function (features) {
        this.logger.trace('[IT] : _features2html...');
        var content = document.createElement('div');
        features.forEach(function (f) {
            var props = {};
            if (f.properties) {
                props = f.properties;
            }
            var nameDiv;
            nameDiv = document.createElement('div');
            nameDiv.className = 'gp-att-name-div';
            if (props.hasOwnProperty('name')) {
                nameDiv.innerHTML = props.name;
                content.appendChild(nameDiv);
            } else if (f.properties.description) {
                nameDiv.innerHTML = props.description;
                content.appendChild(nameDiv);
            } else {
                nameDiv.innerHTML = 'UNKNOWN FEATURE NAME';
                content.appendChild(nameDiv);
            }
            if (props.hasOwnProperty('description')) {
                var descDiv = document.createElement('div');
                descDiv.className = 'gp-att-description-div';
                descDiv.innerHTML = props['description'];
                content.appendChild(descDiv);
            }
            var p = null;
            var others = false;
            var oDiv = null;
            var ul = null;
            var li = null;
            for (p in props) {
                if (p == 'name' || p == 'description' || p == 'styleUrl' || p == 'styleHash') {
                    continue;
                }
                if (p == 'stroke' || p == 'stroke-opacity' || p == 'stroke-width' || p == 'fill' || p == 'fill-opacity' || p == '_idx' || p == '_meshIdx' || p == 'coordTimes') {
                    continue;
                }
                if (!others) {
                    oDiv = document.createElement('div');
                    oDiv.className = 'gp-att-others-div';
                    ul = document.createElement('ul');
                    others = true;
                }
                li = document.createElement('li');
                var span = document.createElement('span');
                span.className = 'gp-attname-others-span';
                span.innerHTML = p + ' : ';
                li.appendChild(span);
                li.appendChild(document.createTextNode(props[p]));
                ul.appendChild(li);
            }
            if (ul) {
                oDiv.appendChild(ul);
                content.appendChild(oDiv);
            }
        }, this);
        return content;
    };
    IT.prototype._displayInfo = function (position, content) {
        this.logger.trace('[IT] : _displayInfo...');
        var element = document.createElement('div');
        element.className = 'gp-feature-info-div-it';
        var closer = document.createElement('input');
        closer.type = 'button';
        closer.className = 'gp-styling-button closer';
        closer.onclick = function (evt) {
            element.parentNode.removeChild(element);
            return false;
        };
        closer.addEventListener('mouseup', function (evt) {
            evt.stopPropagation();
        }, false);
        var contentDiv = document.createElement('div');
        var mapDiv = document.getElementById(this.div.id);
        contentDiv.className = 'gp-features-content-div-it';
        contentDiv.innerHTML = content;
        element.appendChild(contentDiv);
        element.appendChild(closer);
        mapDiv.appendChild(element);
        var posX = mapDiv.offsetWidth / 2 - parseInt(element.offsetWidth, 10) / 2;
        var posY = mapDiv.offsetHeight / 2 - parseInt(element.offsetHeight, 10) / 2;
        element.style.left = posX + 'px';
        element.style.top = posY + 'px';
    };
    IT.prototype._addVectorLayer = function (layerObj) {
        var layerId = Object.keys(layerObj)[0];
        var layerOpts = layerObj[layerId];
        var layer;
        var layerStyleOptions = layerOpts.styleOptions || {};
        var defaultMapOptions = this.mapOptions.defaultFeaturesStyle || {};
        var defaultOptions = IMap.DEFAULT_VECTORLAYERS_STYLES;
        layerOpts.format = layerOpts.format.toLowerCase();
        switch (layerOpts.format.toUpperCase()) {
        case 'KML':
        case 'GEOJSON':
            this.logger.trace('ajout d\'une couche KML / GEOJSON');
            layer = {
                url: layerOpts.url,
                id: layerId,
                type: 'color',
                protocol: 'rasterizer',
                visible: layerOpts.visibility === undefined ? true : layerOpts.visibility,
                opacity: layerOpts.opacity === undefined ? 1 : layerOpts.opacity
            };
            if (this.mapOptions.extractStyles === true) {
                layer.style = {};
            } else {
                layer.style = {
                    stroke: layerStyleOptions.strokeColor || defaultMapOptions.strokeColor || defaultOptions.strokeColor,
                    strokeWidth: layerStyleOptions.strokeWidth || defaultMapOptions.strokeWidth || defaultOptions.strokeWidth,
                    strokeOpacity: layerStyleOptions.strokeOpacity || defaultMapOptions.strokeOpacity || defaultOptions.strokeOpacity,
                    fill: layerStyleOptions.polyFillColor || defaultMapOptions.polyFillColor || defaultOptions.polyFillColor,
                    fillOpacity: layerStyleOptions.polyFillOpacity || defaultMapOptions.polyFillOpacity || defaultOptions.polyFillOpacity
                };
            }
            break;
        case 'GPX':
            this.logger.trace('ajout d\'une couche GPX');
            layer = {
                url: layerOpts.url,
                id: layerId,
                type: 'color',
                protocol: 'rasterizer',
                visible: layerOpts.visibility === undefined ? true : layerOpts.visibility,
                opacity: layerOpts.opacity === undefined ? 1 : layerOpts.opacity,
                style: {
                    stroke: layerStyleOptions.strokeColor || defaultMapOptions.strokeColor || defaultOptions.strokeColor,
                    strokeWidth: layerStyleOptions.strokeWidth || defaultMapOptions.strokeWidth || defaultOptions.strokeWidth,
                    strokeOpacity: layerStyleOptions.strokeOpacity || defaultMapOptions.strokeOpacity || defaultOptions.strokeOpacity
                }
            };
            break;
        case 'GEORSS':
            break;
        case 'WFS':
            break;
        case 'drawing':
            break;
        default:
        }
        if (layer) {
            if (layerOpts.hasOwnProperty('originators')) {
                layer._originators = layerOpts.originators;
            }
            if (!layerOpts.hasOwnProperty('visibility') || typeof layerOpts.visibility === 'undefined') {
                layerOpts.visibility = true;
            }
            this._layers.push({
                id: layerId,
                obj: layer,
                options: layerOpts
            });
            var LSControl = this.getLibMapControl('layerswitcher');
            if (LSControl) {
                LSControl._addedLayerConf[layerId] = layerOpts;
            }
            this.libMap.addLayer(layer);
        }
    };
    IT.prototype._addRasterLayer = function (layerObj) {
        var layerId = Object.keys(layerObj)[0];
        var layerOpts = layerObj[layerId];
        var layerNames;
        var maxScaleDenominator;
        var minScaleDenominator;
        var boundingBox;
        layerOpts.format = layerOpts.format.toLowerCase();
        switch (layerOpts.format.toUpperCase()) {
        case 'WMS':
            this.logger.trace('ajout d\'une couche WMS');
            if (layerOpts.layers && Array.isArray(layerOpts.layers)) {
                layerNames = layerOpts.layers.toString();
            } else if (layerOpts.layers) {
                layerNames = layerOpts.layers;
                layerOpts.layers = [layerOpts.layers];
            } else {
                layerNames = layerId;
                layerOpts.layers = [layerId];
            }
            if (layerOpts.bbox) {
                boundingBox = {
                    west: layerOpts.bbox[0],
                    east: layerOpts.bbox[2],
                    south: layerOpts.bbox[1],
                    north: layerOpts.bbox[3]
                };
            } else if (!layerOpts.bbox && layerOpts.projection === 'EPSG:3857') {
                boundingBox = {
                    west: -20026376.39,
                    east: 20026376.39,
                    south: -20048966.1,
                    north: 20048966.1
                };
            } else {
                boundingBox = {
                    west: -180,
                    east: 180,
                    south: -90,
                    north: 90
                };
            }
            if (layerOpts.minZoom) {
                maxScaleDenominator = this._getResolutionFromZoomLevel(layerOpts.minZoom) / 0.00028;
            }
            if (layerOpts.maxZoom) {
                minScaleDenominator = this._getResolutionFromZoomLevel(layerOpts.maxZoom) / 0.00028;
            }
            var layer = {
                type: layerOpts.type || 'color',
                url: layerOpts.url,
                protocol: layerOpts.format,
                id: layerId,
                name: layerNames,
                style: layerOpts.styleName || '',
                title: layerOpts.title === undefined ? layerId : layerOpts.title,
                visible: layerOpts.visibility === undefined ? true : layerOpts.visibility,
                opacity: layerOpts.opacity === undefined ? 1 : layerOpts.opacity,
                projection: layerOpts.projection || 'EPSG:4326',
                extent: boundingBox,
                transparent: true,
                waterMask: false,
                featureInfoMimeType: '',
                dateTime: '',
                heightMapWidth: 256,
                options: {
                    mimetype: layerOpts.outputFormat,
                    zoom: {
                        min: layerOpts.minZoom || 1,
                        max: layerOpts.maxZoom || 21
                    }
                },
                networkOptions: { crossOrigin: 'omit' },
                updateStrategy: {
                    type: 0,
                    options: {}
                },
                version: layerOpts.version || '1.3.0'
            };
            break;
        case 'WMTS':
            this.logger.trace('ajout d\'une couche WMTS');
            var lOpts = this._getWMTSDefaultOpts();
            for (var opt in layerOpts) {
                lOpts[opt] = layerOpts[opt];
            }
            if (layerOpts.minZoom) {
                maxScaleDenominator = this._getResolutionFromZoomLevel(layerOpts.minZoom) / 0.00028;
            }
            if (layerOpts.maxZoom) {
                minScaleDenominator = this._getResolutionFromZoomLevel(layerOpts.maxZoom) / 0.00028;
            }
            layerOpts = lOpts;
            if (!layerOpts.tileMatrixSetLimits) {
                layerOpts.tileMatrixSetLimits = this._getTMSLimits(layerOpts.tileMatrixSet);
            }
            layer = {
                type: layerOpts.type || 'color',
                url: layerOpts.url,
                protocol: layerOpts.format.toLowerCase(),
                id: layerId,
                title: layerOpts.title === undefined ? layerId : layerOpts.title,
                visible: layerOpts.visibility === undefined ? true : layerOpts.visibility,
                opacity: layerOpts.opacity === undefined ? 1 : layerOpts.opacity,
                updateStrategy: {
                    type: '0',
                    options: {}
                },
                networkOptions: { crossOrigin: 'omit' },
                options: {
                    tileMatrixSet: layerOpts.tileMatrixSet,
                    tileMatrixSetLimits: layerOpts.tileMatrixSetLimits,
                    mimetype: layerOpts.outputFormat,
                    name: layerOpts.layer,
                    style: layerOpts.styleName
                },
                version: layerOpts.version,
                minScaleDenominator: minScaleDenominator || null,
                maxScaleDenominator: maxScaleDenominator || null,
                processingOptions: layerOpts.processingOptions
            };
            if (layerOpts.minZoom && layerOpts.maxZoom) {
                layer.options.zoom = {
                    min: layerOpts.minZoom,
                    max: layerOpts.maxZoom
                };
            } else if (layerOpts.minZoom && !layerOpts.maxZoom) {
                layer.options.zoom = {
                    min: layerOpts.minZoom,
                    max: Math.max.apply(null, Object.keys(layerOpts.tileMatrixSetLimits).map(Number))
                };
            } else if (!layerOpts.minZoom && layerOpts.maxZoom) {
                layer.options.zoom = {
                    min: Math.min.apply(null, Object.keys(layerOpts.tileMatrixSetLimits).map(Number)),
                    max: layerOpts.maxZoom
                };
            }
            if (layerOpts.levelsToLoad) {
                layer.updateStrategy = {
                    type: 1,
                    options: { groups: layerOpts.levelsToLoad }
                };
            }
            break;
        default:
        }
        if (layer) {
            if (layerOpts.hasOwnProperty('originators')) {
                layer.options.originators = layerOpts.originators;
            }
            if (!layerOpts.hasOwnProperty('opacity') || typeof layerOpts.opacity === 'undefined') {
                layerOpts.opacity = 1;
            }
            if (!layerOpts.hasOwnProperty('visibility') || typeof layerOpts.visibility === 'undefined') {
                layerOpts.visibility = true;
            }
            this._layers.push({
                id: layerId,
                options: layerOpts,
                obj: layer
            });
            if (layerOpts.isElevation === true) {
                layer.type = 'elevation';
                if (layerOpts.noDataValue) {
                    layer.noDataValue = layerOpts.noDataValue;
                }
            } else {
                var LSControl = this.getLibMapControl('layerswitcher');
                if (LSControl) {
                    LSControl._addedLayerConf[layerId] = layerOpts;
                }
            }
            this.libMap.addLayer(layer);
        }
    };
    IT.prototype._addGeoportalLayer = function (layerObj, layerConf) {
        var layerId = Object.keys(layerObj)[0];
        if (layerConf) {
            layerObj[layerId].url = layerConf.getServerUrl(layerConf.apiKeys[0]);
            layerObj[layerId].outputFormat = layerObj[layerId].outputFormat || layerConf.getDefaultFormat();
            if (layerObj[layerId].format === 'WMS') {
                layerObj[layerId].version = layerObj[layerId].version || layerConf.serviceParams.version;
                layerObj[layerId].stylesName = layerObj[layerId].stylesName || layerConf.styles;
            }
            if (layerObj[layerId].format === 'WMTS') {
                layerObj[layerId].tileMatrixSet = layerObj[layerId].tileMatrixSet || layerConf.getTMSID();
                layerObj[layerId].tileMatrixSetLimits = layerObj[layerId].tileMatrixSetLimits || layerConf.wmtsOptions.tileMatrixSetLimits;
                layerObj[layerId].layer = layerId || layerConf.getName();
                layerObj[layerId].styleName = layerObj[layerId].styleName || layerConf.getStyles()[0].name;
            }
        }
        this._addRasterLayer(layerObj);
    };
    IT.prototype.setXYCenter = function (point, zoom) {
        this.logger.trace('[IT] - setXYCenter');
        if (!point.hasOwnProperty('x') || !point.hasOwnProperty('y')) {
            console.log('no valid coordinates for map center');
            return;
        }
        if (point.location && point.location.trim().length > 0) {
            console.log('point object has location property to center on...');
            return;
        }
        if (point.hasOwnProperty('projection') && point.projection !== 'EPSG:4326' && Itowns.proj4.defs(point.projection)) {
            var wgs84Coords = Itowns.proj4(point.projection, 'EPSG:4326', [
                point.x,
                point.y
            ]);
            point = {
                x: wgs84Coords[0],
                y: wgs84Coords[1]
            };
        } else if (point.hasOwnProperty('projection') && Itowns.proj4.defs(point.projection) == undefined) {
            this.logger.trace('[IT] - setXYCenter(' + point.projection + ' not handled ! )');
            return;
        }
        var position = {
            longitude: point.x,
            latitude: point.y
        };
        if (zoom) {
            position.zoom = zoom;
        }
        this.libMap.setCameraTargetGeoPosition(position);
        this.logger.trace('[IT] - setXYCenter(' + point.x + ',' + point.y + ')');
    };
    IT.prototype.setAutoCenter = function (point, zoom) {
        this.logger.trace('[IT] - setAutoCenter');
        if (!point.hasOwnProperty('x') || !point.hasOwnProperty('y')) {
            console.log('no valid coordinates for map center');
            return;
        }
        if (point.hasOwnProperty('projection') && point.projection !== 'EPSG:4326' && Itowns.proj4.defs(point.projection)) {
            var wgs84Coords = Itowns.proj4(point.projection, 'EPSG:4326', [
                point.x,
                point.y
            ]);
            point = {
                x: wgs84Coords[0],
                y: wgs84Coords[1]
            };
        } else if (point.hasOwnProperty('projection') && Itowns.proj4.defs(point.projection) == undefined) {
            this.logger.trace('[IT] - setAutoCenter(' + point.projection + ' not handled ! )');
            return;
        }
        var position = {
            tilt: 45,
            heading: 0,
            longitude: point.x,
            latitude: point.y
        };
        if (zoom) {
            position.zoom = zoom;
        }
        this.libMap.onCameraMoveStop(function () {
            this.libMap.setCameraTargetGeoPosition(position);
        }.bind(this));
        this.logger.trace('[IT] - setAutoCenter(' + point.x + ',' + point.y + ')');
    };
    IT.prototype.getCenter = function () {
        return this.libMap.getCenter();
    };
    IT.prototype.getZoom = function () {
        var zoom = this.libMap.getZoom() - 1;
        return zoom;
    };
    IT.prototype.setZoom = function (zoom) {
        if (parseFloat(zoom) !== parseInt(zoom, 10) || isNaN(zoom)) {
            console.log('no valid zoomLevel');
            return;
        }
        zoom = parseInt(zoom, 10);
        this.libMap.setZoom(zoom + 1);
        this.logger.trace('[IT] - setZoom(' + zoom + ')');
    };
    IT.prototype.zoomIn = function () {
        var zoom = this.getZoom();
        if (zoom === 20) {
            return;
        }
        this.setZoom(zoom + 1);
    };
    IT.prototype.zoomOut = function () {
        var zoom = this.getZoom();
        if (zoom === -1) {
            return;
        }
        this.setZoom(zoom - 1);
    };
    IT.prototype.getAzimuth = function () {
        return this.libMap.getAzimuth();
    };
    IT.prototype.setAzimuth = function (azimuth) {
        if (isNaN(azimuth)) {
            console.log('Not a valid azimuth  : must be a float');
            return;
        }
        this.libMap.setAzimuth(azimuth);
        this.logger.trace('[IT] - setAzimuth(' + azimuth + ')');
    };
    IT.prototype.getTilt = function () {
        return this.libMap.getTilt();
    };
    IT.prototype.setTilt = function (tilt) {
        tilt = parseFloat(tilt);
        if (isNaN(tilt) || tilt < 0 || tilt > 90) {
            console.log('no valid tilt angle');
            return;
        }
        this.libMap.setTilt(tilt);
        this.logger.trace('[IT] - setTilt(' + tilt + ')');
    };
    IT.prototype.addMousePositionControl = function (controlOpts) {
        var mpOpts = {};
        if (controlOpts.div) {
            mpOpts.target = controlOpts.div;
        }
        mpOpts.collapsed = controlOpts.maximised ? false : true;
        if (controlOpts.systems && Array.isArray(controlOpts.systems) && controlOpts.systems.length > 0) {
            for (var i = 0; i < controlOpts.systems.length; i++) {
                if (!mpOpts.systems) {
                    mpOpts.systems = [];
                }
                mpOpts.systems.push(controlOpts.systems[i]);
            }
        }
        if (controlOpts.units && Array.isArray(controlOpts.units) && controlOpts.units.length > 0) {
            mpOpts.units = [];
            for (var j = 0; j < controlOpts.units.length; j++) {
                if (typeof controlOpts.units[j] == 'string') {
                    this.logger.trace('[IT] addMousePositionControl  : adding unit   [' + controlOpts.units[j].toUpperCase());
                    mpOpts.units.push(controlOpts.units[j]);
                }
            }
        }
        mpOpts.displayAltitude = controlOpts.displayAltitude;
        mpOpts.displayCoordinates = controlOpts.displayCoordinates;
        if (controlOpts.altitude) {
            mpOpts.altitude = controlOpts.altitude;
        }
        var control = new Itowns.control.MousePosition(mpOpts);
        this.libMap.addWidget(control);
        return control;
    };
    IT.prototype.addLayerSwitcherControl = function (controlOpts) {
        this.logger.trace('[IT]  : addLayerSwitcherControl ... ');
        var lsOpts = {
            layers: controlOpts.layers || [],
            options: { collapsed: !(controlOpts && controlOpts.maximised) }
        };
        if (controlOpts.div) {
            lsOpts.options.target = controlOpts.div;
        }
        for (var i = 0; i < this._layers.length; i++) {
            var layer = this._layers[i];
            if (layer.obj.type !== 'color') {
                continue;
            }
            this.logger.trace('[IT]  : layerSwitcher  : configuring layer  : ' + layer.id);
            var layerConf = {
                id: layer.id,
                layer: layer.obj,
                config: {}
            };
            if (layer.options.title) {
                this.logger.trace('[IT]  : layerSwitcher  : setting title to [' + layer.options.title + '] for layer ' + layer.id);
                layerConf.config.title = layer.options.title;
            }
            if (layer.options.description) {
                this.logger.trace('[IT  : layerSwitcher  : setting description to [' + layer.options.description + '] for layer ' + layer.id);
                layerConf.config.description = layer.options.description;
            }
            if (layer.options.quicklookUrl) {
                this.logger.trace('[IT]  : layerSwitcher  : setting quicklookUrl to [' + layer.options.quicklookUrl + '] for layer ' + layer.id);
                layerConf.config.quicklookUrl = layer.options.quicklookUrl;
            }
            if (layer.options.legends) {
                this.logger.trace('[IT]  : layerSwitcher  : setting legends to [' + layer.options.legends + '] for layer ' + layer.id);
                layerConf.config.legends = layer.options.legends;
            }
            if (layer.options.metadata) {
                this.logger.trace('[IT]  : layerSwitcher  : setting metadata to [' + layer.options.metadata + '] for layer ' + layer.id);
                layerConf.config.metadata = layer.options.metadata;
            }
            lsOpts.layers.push(layerConf);
        }
        this.logger.trace('[IT]  : layerSwitcher Opts  : ... ');
        var control = new Itowns.control.LayerSwitcher(lsOpts);
        this.libMap.addWidget(control);
        return control;
    };
    IT.prototype.addOverviewControl = function (controlOpts) {
        this.logger.trace('[IT] addOverviewControl : ... ');
        var ovControlOptions = {};
        if (controlOpts.position) {
            ovControlOptions.position = controlOpts.position;
        } else {
            ovControlOptions.position = 'absolute';
        }
        if (controlOpts.div) {
            ovControlOptions.target = controlOpts.div;
        }
        var control = new Itowns.control.MiniGlobe(ovControlOptions);
        this.libMap.addWidget(control);
        if (control.getElement()) {
            if (controlOpts.maximised == false) {
                control.getElement().style.display = 'none';
            } else {
                control.getElement().style.display = 'inline';
            }
            if (!isNaN(controlOpts.width)) {
                control.getElement().style.width = controlOpts.width + 'px';
                control.getElement().getElementsByTagName('canvas')[0].style.width = controlOpts.width + 'px';
            }
            if (!isNaN(controlOpts.height)) {
                control.getElement().style.height = controlOpts.height + 'px';
                control.getElement().getElementsByTagName('canvas')[0].style.height = controlOpts.height + 'px';
            }
            if (!isNaN(controlOpts.x)) {
                control.getElement().style.left = Number(controlOpts.x) + 'px';
            }
            if (!isNaN(controlOpts.y)) {
                control.getElement().style.bottom = Number(controlOpts.y) + 'px';
            }
            var elementSize = {};
            elementSize.width = parseFloat(control.getElement().style.width) || 100;
            elementSize.height = parseFloat(control.getElement().style.height) || 100;
            control._globeObj.resize(elementSize.width, elementSize.height);
        }
        return control;
    };
    IT.prototype.addGraphicScaleControl = function (controlOpts) {
        this.logger.trace('[IT] addGraphicScaleControl...');
        var scaleControlOptions = {};
        if (controlOpts.position) {
            scaleControlOptions.position = controlOpts.position;
        } else {
            scaleControlOptions.position = 'absolute';
        }
        if (controlOpts.div) {
            scaleControlOptions.target = controlOpts.div;
        }
        var control = new Itowns.control.Scale(scaleControlOptions);
        this.libMap.addWidget(control);
        if (control.getElement()) {
            if (controlOpts.maximised == false) {
                control.getElement().style.display = 'none';
            } else {
                control.getElement().style.display = 'inline';
            }
            if (!isNaN(controlOpts.x)) {
                control.getElement().style.left = Number(controlOpts.x) + 'px';
            }
            if (!isNaN(controlOpts.y)) {
                control.getElement().style.bottom = Number(controlOpts.y) + 'px';
            }
        }
        return control;
    };
    IT.prototype.addAttributionsControl = function (controlOpts) {
        var attOpts = {};
        attOpts.options = {};
        if (controlOpts.div) {
            attOpts.options.target = controlOpts.div;
        }
        attOpts.options.collapsed = controlOpts.maximised ? false : true;
        var control = new Itowns.control.Attributions(attOpts);
        this.libMap.addWidget(control);
        return control;
    };
    IT.prototype.removeControls = function (controlIds) {
        this.logger.trace('[IT]  : removeControls ... ');
        if (!controlIds || Array.isArray(controlIds) && controlIds.length == 0) {
            console.log('No control to remove.');
            return;
        }
        if (!Array.isArray(controlIds)) {
            controlIds = [controlIds];
        }
        var controlId = null;
        for (var i = 0; i < controlIds.length; i++) {
            controlId = controlIds[i];
            var idx = this._findRegisteredControl(controlId);
            if (idx >= 0) {
                this.logger.trace('[IT]  : removeControls  : removing [' + controlId + '] from register.');
                this._controls.splice(idx, 1);
            }
            var itownsControl = this.getLibMapControl(controlId);
            if (!itownsControl) {
                console.log('Impossible to remove control [' + controlId + ']  : not found or unhandled');
                continue;
            }
            this.logger.trace('[IT]  : removeControls  : removing [' + controlId + '] from Map.');
            this.libMap.removeWidget(itownsControl);
        }
    };
    IT.prototype.getLibMapControl = function (controlId) {
        var foundItControl = null;
        if (!IT.CONTROLSCLASSES.hasOwnProperty(controlId.toLowerCase()) || !IT.CONTROLSCLASSES[controlId.toLowerCase()]) {
            this.logger.trace('[IT] getLibMapControl  : control ' + controlId + ' non implémenté.');
            return foundItControl;
        }
        var itControls = this.libMap.getWidgets();
        if (!itControls || itControls.length == 0) {
            this.logger.trace('[IT] getLibMapControl  : no control found on map');
            return foundItControl;
        }
        for (var j = 0; j < itControls.length; j++) {
            this.logger.trace('[IT] getLibMapControl  : analyzing  : ' + controlId);
            if (itControls[j].name && itControls[j].name.toLowerCase() === controlId.toLowerCase()) {
                foundItControl = itControls[j];
                this.logger.trace('[IT] getLibMapControl  : found GP Plugin Control ! ');
                break;
            }
        }
        if (!foundItControl) {
            this.logger.trace('[IT] getLibMapControl  : control ' + controlId + ' not found ! ');
        }
        return foundItControl;
    };
    IT.prototype.removeLayers = function (layerIds) {
        if (!IMap.prototype.removeLayers.apply(this, arguments)) {
            return false;
        }
        if (!Array.isArray(layerIds)) {
            layerIds = [layerIds];
        }
        layerIds.forEach(function (_layerId) {
            if (this._getLayersObj(_layerId) && Array.isArray(this._getLayersObj(_layerId)) && this._getLayersObj(_layerId).length > 0) {
                this.libMap.removeLayer(_layerId);
            } else {
                console.log('[IT]  : Impossible to remove ' + _layerId + ' - not Found');
            }
        }, this);
    };
    IT.prototype.modifyLayers = function (layersOptions) {
        if (!IMap.prototype.modifyLayers.apply(this, arguments)) {
            return false;
        }
        var layerIds = Object.keys(layersOptions);
        var _layerObjs = this._getLayersObj(layerIds);
        _layerObjs.forEach(function (_layerObj) {
            this.logger.trace('[IMap] modifyLayers  : modifying  : [' + _layerObj.id + ']');
            var commonOpts = this._applyCommonLayerParams(layersOptions[_layerObj.id]);
            if (commonOpts.hasOwnProperty('opacity')) {
                this.logger.trace('[IMap] modifyLayers  : setting opacity of  : [' + _layerObj.id + '] to  : ' + commonOpts.opacity);
                this.libMap.setLayerOpacity(_layerObj.id, commonOpts.opacity);
            }
            if (commonOpts.hasOwnProperty('visible')) {
                this.logger.trace('[IMap] modifyLayers  : setting visible of  : [' + _layerObj.id + '] to  : ' + commonOpts.visible);
                this.libMap.setLayerVisibility(_layerObj.id, commonOpts.visible);
            }
            if (commonOpts.hasOwnProperty('zIndex')) {
                this.logger.trace('[IMap] modifyLayers  : setting zIndex of  : [' + _layerObj.id + '] to  : ' + commonOpts.zIndex);
                this.libMap.moveLayerToIndex(_layerObj.id, commonOpts.zIndex);
            }
        }, this);
    };
    IT.prototype._getCommonLayerParams = function (itlayerOpts) {
        var commonOpts = {};
        this.logger.trace('[IT] : _getCommonLayerParams ');
        if (itlayerOpts.hasOwnProperty('opacity')) {
            this.logger.trace('[IT] : _getCommonLayerParams - opacity : ' + itlayerOpts.opacity);
            commonOpts.opacity = itlayerOpts.opacity;
        }
        if (itlayerOpts.hasOwnProperty('visible')) {
            this.logger.trace('[IT] : _getCommonLayerParams - visibility : ' + itlayerOpts.visible);
            commonOpts.visibility = itlayerOpts.visible;
        }
        if (itlayerOpts.hasOwnProperty('sequence')) {
            this.logger.trace('[IT] : _getCommonLayerParams - position : ' + itlayerOpts.sequence);
            commonOpts.position = itlayerOpts.sequence;
        }
        return commonOpts;
    };
    IT.prototype._applyCommonLayerParams = function (layerOpts) {
        var commonOpts = {};
        this.logger.trace('[IT]  : _applyCommonLayerParams ');
        if (layerOpts.hasOwnProperty('opacity')) {
            this.logger.trace('[IT]  : _applyCommonLayerParams - opacity  : ' + layerOpts.opacity);
            commonOpts.opacity = layerOpts.opacity;
        }
        if (layerOpts.hasOwnProperty('visibility')) {
            this.logger.trace('[IT]  : _applyCommonLayerParams - visibility  : ' + layerOpts.visibility);
            commonOpts.visible = layerOpts.visibility;
        }
        if (layerOpts.hasOwnProperty('position')) {
            this.logger.trace('[IT]  : _applyCommonLayerParams - position  : ' + layerOpts.position);
            commonOpts.zIndex = layerOpts.position;
        }
        return commonOpts;
    };
    IT.prototype.listen = function (eventId, action, context) {
        this.logger.trace('[IT]  : listen...');
        if (!IMap.prototype.listen.apply(this, arguments)) {
            return false;
        }
        context = context || this;
        var map = this;
        var key = null;
        switch (eventId) {
        case 'mapFailure':
            break;
        case 'mapLoaded':
        case 'located':
        case 'geolocated':
        case 'configured':
            break;
        case 'centerChanged':
            var callBackCenterChanged = function (itEvent) {
                var centerChangedEvt = {};
                if (!itEvent) {
                    return;
                }
                if (itEvent.previous) {
                    var oldCoords = itEvent.previous.cameraTarget.as('EPSG:4326');
                    centerChangedEvt.oldCenter = {
                        x: oldCoords.longitude(),
                        y: oldCoords.latitude()
                    };
                }
                if (itEvent.new) {
                    var newCoords = itEvent.new.cameraTarget.as('EPSG:4326');
                    centerChangedEvt.newCenter = {
                        x: newCoords.longitude(),
                        y: newCoords.latitude()
                    };
                }
                action.call(context, centerChangedEvt);
            };
            key = map.libMap.listen(Itowns.GlobeViewExtended.EVENTS.CENTER_CHANGED, callBackCenterChanged);
            break;
        case 'zoomChanged':
            var oldZoom = context.getZoom();
            var callbackZoomchange = function (itEvent) {
                var newZoom = context.getZoom();
                if (newZoom === oldZoom) {
                    return;
                }
                action.call(context, {
                    oldZoom: oldZoom,
                    newZoom: newZoom
                });
                oldZoom = newZoom;
            };
            key = map.libMap.listen(Itowns.GlobeViewExtended.EVENTS.RANGE_CHANGED, callbackZoomchange);
            break;
        case 'azimuthChanged':
            var callbackAzimuthChange = function (itEvent) {
                if (itEvent.new.heading === itEvent.previous.heading) {
                    return;
                }
                action.call(context, {
                    oldAzimuth: itEvent.previous.heading,
                    newAzimuth: itEvent.new.heading
                });
            };
            key = map.libMap.listen(Itowns.GlobeViewExtended.EVENTS.ORIENTATION_CHANGED, callbackAzimuthChange);
            break;
        case 'tiltChanged':
            var callbackTiltChange = function (itEvent) {
                if (itEvent.new.tilt === itEvent.previous.tilt) {
                    return;
                }
                action.call(context, {
                    oldTilt: itEvent.previous.tilt,
                    newTilt: itEvent.new.tilt
                });
            };
            key = map.libMap.listen(Itowns.GlobeViewExtended.EVENTS.ORIENTATION_CHANGED, callbackTiltChange);
            break;
        case 'projectionChanged':
            break;
        case 'layerChanged':
            var callbackLayerAdded = function (itevt) {
                var ladded = itevt;
                var layerIndex;
                var layerOpts = map._getLayerOpts(ladded.layerId);
                var itColorLayer = map.libMap.getColorLayerById(Object.keys(layerOpts)[0]);
                if (itColorLayer && itColorLayer.sequence >= 0) {
                    layerIndex = itColorLayer.sequence;
                } else {
                    layerIndex = -1;
                }
                if (!layerOpts) {
                    map.logger.trace('[IT] listen  : enregistrement d\'une couche \'inconnue\'.');
                }
                action.call(context, {
                    layerAdded: layerOpts,
                    position: layerIndex
                });
            };
            key = map.libMap.listen(Itowns.GlobeViewExtended.EVENTS.LAYER_ADDED, callbackLayerAdded);
            map._registerEvent(key, eventId, action, context);
            var callbackLayerRemoved = function (itevt) {
                var lremoved = itevt;
                var layerOpts = map._getLayerOpts(lremoved.layerId) || map._getLayerOpts(lremoved.layerId, map._layersRemoved);
                action.call(context, { layerRemoved: layerOpts });
            };
            key = map.libMap.listen(Itowns.GlobeViewExtended.EVENTS.LAYER_REMOVED, callbackLayerRemoved);
            map._registerEvent(key, eventId, action, context);
            for (var obsProperty in IT.LAYERPROPERTIES) {
                map.libMap.getColorLayers().forEach(function (itLayer) {
                    var layerOpts = map._getLayerOpts(itLayer.id);
                    var callbackLayerChanged = function (itevt) {
                        var layerEvtinfos = map.libMap.getLayerEventInfos(itevt);
                        var key = layerEvtinfos.propertyName;
                        var oldItObj = {};
                        oldItObj[key] = layerEvtinfos.previousValue;
                        var oldCommonProp = map._getCommonLayerParams(oldItObj);
                        var newItObj = {};
                        newItObj[key] = layerEvtinfos.newValue;
                        var newCommonProp = map._getCommonLayerParams(newItObj);
                        action.call(context, {
                            property: IT.LAYERPROPERTIES[key],
                            oldValue: oldCommonProp[IT.LAYERPROPERTIES[key]],
                            newValue: newCommonProp[IT.LAYERPROPERTIES[key]],
                            layerChanged: layerOpts
                        });
                    };
                    var type = obsProperty === 'visible' ? Itowns.GlobeViewExtended.EVENTS.VISIBLE_PROPERTY_CHANGED : obsProperty === 'opacity' ? Itowns.GlobeViewExtended.EVENTS.OPACITY_PROPERTY_CHANGED : Itowns.GlobeViewExtended.EVENTS.SEQUENCE_PROPERTY_CHANGED;
                    key = map.libMap.addLayerListener(itLayer, type, callbackLayerChanged);
                    map._registerEvent(key, eventId, action, context);
                    key = null;
                });
            }
            ;
            break;
        case 'controlChanged':
            break;
        default:
            console.log('unhandled event  : ' + eventId);
        }
        if (key) {
            this._registerEvent(key, eventId, action, context);
        }
        return true;
    };
    IT.prototype.forget = function (eventId, action) {
        this.logger.trace('[IT]  : forget...');
        if (!IMap.prototype.forget.apply(this, arguments)) {
            return false;
        }
        var rEvents = this._events[eventId];
        if (!rEvents) {
            console.log('nothing to forget for : ' + eventId);
            return false;
        }
        var evKey = null;
        for (var i = rEvents.length - 1; i >= 0; i--) {
            if (rEvents[i].action == action) {
                evKey = rEvents[i].key;
                rEvents.splice(i, 1);
                this.logger.trace('[IT] : forgetting : ' + eventId + ' (' + evKey + ')');
                this.libMap.forgetByKey(evKey);
            }
        }
    };
    IT.prototype.getLibMap = function () {
        return this.libMap;
    };
    IT.prototype._getLayerOpts = function (layerId, layersStack) {
        var layerOpts = null;
        layersStack = layersStack || this._layers;
        for (var i = 0; i < layersStack.length; i++) {
            var l = layersStack[i];
            if (l.id === layerId) {
                this.logger.trace('[IT]  : found layer  : ' + l.id);
                layerOpts = {};
                layerOpts[l.id] = l.options;
                break;
            }
        }
        return layerOpts;
    };
    IT.prototype.getLSLayerContainerDivId = function (layerId) {
        var id = null;
        var idxLS = this._findRegisteredControl('layerswitcher');
        if (idxLS < 0) {
            this.logger.trace('[IT] : getLSLayerContainerDivId : no layerswitcher on map !');
            return id;
        }
        var itlayers = this._getLayersObj([layerId]);
        if (itlayers.length > 0) {
            var itLayerList = this._controls[idxLS].obj._layerListContainer;
            var divId = itLayerList.id;
            var uid = divId.substring(divId.indexOf('-'));
            if (itLayerList && itLayerList.childNodes) {
                for (var layerDivKey = 0; layerDivKey < itLayerList.childNodes.length; layerDivKey++) {
                    if (itLayerList.childNodes[layerDivKey].id === 'GPlayerSwitcher_ID_' + layerId + uid) {
                        var foundId = 'GPlayerSwitcher_ID_' + layerId + uid;
                        return foundId;
                    }
                }
            }
        }
        this.logger.trace('[IT] : getLSLayerContainerDivId : layer [' + layerId + '] not found on map !');
        return id;
    };
    IT.prototype._registerUnknownLayer = function (layerObj) {
        return {};
    };
    IT.prototype._getTMSLimits = function (TMSID) {
        var TMSlimits;
        if (TMSID === 'PM') {
            TMSlimits = {
                0: {
                    minTileRow: '0',
                    maxTileRow: '1',
                    minTileCol: '0',
                    maxTileCol: '1'
                },
                1: {
                    minTileRow: '0',
                    maxTileRow: '2',
                    minTileCol: '0',
                    maxTileCol: '2'
                },
                2: {
                    minTileRow: '0',
                    maxTileRow: '4',
                    minTileCol: '0',
                    maxTileCol: '4'
                },
                3: {
                    minTileRow: '0',
                    maxTileRow: '8',
                    minTileCol: '0',
                    maxTileCol: '8'
                },
                4: {
                    minTileRow: '0',
                    maxTileRow: '16',
                    minTileCol: '0',
                    maxTileCol: '16'
                },
                5: {
                    minTileRow: '0',
                    maxTileRow: '32',
                    minTileCol: '0',
                    maxTileCol: '32'
                },
                6: {
                    minTileRow: '0',
                    maxTileRow: '64',
                    minTileCol: '0',
                    maxTileCol: '64'
                },
                7: {
                    minTileRow: '0',
                    maxTileRow: '128',
                    minTileCol: '0',
                    maxTileCol: '128'
                },
                8: {
                    minTileRow: '0',
                    maxTileRow: '256',
                    minTileCol: '0',
                    maxTileCol: '256'
                },
                9: {
                    minTileRow: '0',
                    maxTileRow: '512',
                    minTileCol: '0',
                    maxTileCol: '512'
                },
                10: {
                    minTileRow: '0',
                    maxTileRow: '1024',
                    minTileCol: '0',
                    maxTileCol: '1024'
                },
                11: {
                    minTileRow: '0',
                    maxTileRow: '2048',
                    minTileCol: '0',
                    maxTileCol: '2048'
                },
                12: {
                    minTileRow: '0',
                    maxTileRow: '4096',
                    minTileCol: '0',
                    maxTileCol: '4096'
                },
                13: {
                    minTileRow: '0',
                    maxTileRow: '8192',
                    minTileCol: '0',
                    maxTileCol: '8192'
                },
                14: {
                    minTileRow: '0',
                    maxTileRow: '16384',
                    minTileCol: '0',
                    maxTileCol: '16384'
                },
                15: {
                    minTileRow: '0',
                    maxTileRow: '32768',
                    minTileCol: '0',
                    maxTileCol: '32768'
                },
                16: {
                    minTileRow: '0',
                    maxTileRow: '65536',
                    minTileCol: '0',
                    maxTileCol: '65536'
                },
                17: {
                    minTileRow: '0',
                    maxTileRow: '131072',
                    minTileCol: '0',
                    maxTileCol: '131072'
                },
                18: {
                    minTileRow: '0',
                    maxTileRow: '262144',
                    minTileCol: '0',
                    maxTileCol: '262144'
                },
                19: {
                    minTileRow: '0',
                    maxTileRow: '524288',
                    minTileCol: '0',
                    maxTileCol: '524288'
                },
                20: {
                    minTileRow: '0',
                    maxTileRow: '1048576',
                    minTileCol: '0',
                    maxTileCol: '1048576'
                },
                21: {
                    minTileRow: '0',
                    maxTileRow: '2097152',
                    minTileCol: '0',
                    maxTileCol: '2097152'
                }
            };
            return TMSlimits;
        }
        if (TMSID === 'WGS84G') {
            TMSlimits = {
                0: {
                    minTileRow: 0,
                    maxTileRow: 1,
                    minTileCol: 0,
                    maxTileCol: 2
                },
                1: {
                    minTileRow: 0,
                    maxTileRow: 2,
                    minTileCol: 0,
                    maxTileCol: 4
                },
                2: {
                    minTileRow: 0,
                    maxTileRow: 4,
                    minTileCol: 0,
                    maxTileCol: 8
                },
                3: {
                    minTileRow: 0,
                    maxTileRow: 8,
                    minTileCol: 0,
                    maxTileCol: 16
                },
                4: {
                    minTileRow: 0,
                    maxTileRow: 16,
                    minTileCol: 0,
                    maxTileCol: 32
                },
                5: {
                    minTileRow: 0,
                    maxTileRow: 32,
                    minTileCol: 0,
                    maxTileCol: 64
                },
                6: {
                    minTileRow: 0,
                    maxTileRow: 64,
                    minTileCol: 0,
                    maxTileCol: 128
                },
                7: {
                    minTileRow: 0,
                    maxTileRow: 128,
                    minTileCol: 0,
                    maxTileCol: 256
                },
                8: {
                    minTileRow: 0,
                    maxTileRow: 256,
                    minTileCol: 0,
                    maxTileCol: 512
                },
                9: {
                    minTileRow: 0,
                    maxTileRow: 512,
                    minTileCol: 0,
                    maxTileCol: 1024
                },
                10: {
                    minTileRow: 0,
                    maxTileRow: 1024,
                    minTileCol: 0,
                    maxTileCol: 2048
                },
                11: {
                    minTileRow: 0,
                    maxTileRow: 2048,
                    minTileCol: 0,
                    maxTileCol: 4096
                },
                12: {
                    minTileRow: 0,
                    maxTileRow: 4096,
                    minTileCol: 0,
                    maxTileCol: 8192
                },
                13: {
                    minTileRow: 0,
                    maxTileRow: 8192,
                    minTileCol: 0,
                    maxTileCol: 16384
                },
                14: {
                    minTileRow: 0,
                    maxTileRow: 16384,
                    minTileCol: 0,
                    maxTileCol: 32768
                },
                15: {
                    minTileRow: 0,
                    maxTileRow: 32768,
                    minTileCol: 0,
                    maxTileCol: 65536
                },
                16: {
                    minTileRow: 0,
                    maxTileRow: 65536,
                    minTileCol: 0,
                    maxTileCol: 131072
                },
                17: {
                    minTileRow: 0,
                    maxTileRow: 131072,
                    minTileCol: 0,
                    maxTileCol: 262144
                }
            };
            return TMSlimits;
        }
        this.logger.trace('[IT]  : no TMS Limits found for this TMS id');
        return;
    };
    return IT;
}(UtilsLoggerByDefault, UtilsLoader, Gp, itowns, IMap);
ol3OL3 = function (Logger, ol, plugins, IMap) {
    function OL3(opts) {
        if (!(this instanceof OL3)) {
            throw new TypeError('OL3 constructor cannot be called as a function.');
        }
        this.CLASSNAME = 'OL3';
        IMap.apply(this, arguments);
        this.logger = Logger.getLogger('OL3');
        this.logger.trace('[Constructeur OL3 (options)]');
    }
    OL3.LAYERPROPERTIES = {
        visible: 'visibility',
        opacity: 'opacity',
        zIndex: 'position',
        grayScaled: 'grayScaled',
        minResolution: 'maxZoom',
        maxResolution: 'minZoom'
    };
    OL3.CONTROLPROPERTIES = { maximised: 'collapsed' };
    OL3.CONTROLSCLASSES = {
        draggable: [
            ol.interaction.Pointer,
            ol.interaction.MouseWheelZoom,
            ol.interaction.DoubleClickZoom
        ],
        keyboard: [
            ol.interaction.KeyboardPan,
            ol.interaction.KeyboardZoom
        ],
        scrollwheel: null,
        selectable: [ol.interaction.Select],
        zoom: ol.control.Zoom,
        zoombox: null,
        overview: ol.control.OverviewMap,
        orientation: ol.control.Rotate,
        graphicscale: ol.control.ScaleLine,
        getfeatureinfo: ol.control.GetFeatureInfo,
        mouseposition: ol.control.GeoportalMousePosition,
        route: ol.control.Route,
        layerswitcher: ol.control.LayerSwitcher,
        layerimport: ol.control.LayerImport,
        isocurve: ol.control.Isocurve,
        length: ol.control.MeasureLength,
        area: ol.control.MeasureArea,
        azimuth: ol.control.MeasureAzimuth,
        elevationpath: ol.control.ElevationPath,
        graticule: ol.Graticule,
        search: ol.control.SearchEngine,
        reversesearch: ol.control.ReverseGeocode,
        drawing: ol.control.Drawing,
        attributions: ol.control.GeoportalAttribution,
        camera: null
    };
    OL3.prototype = Object.create(IMap.prototype, {});
    OL3.prototype.constructor = OL3;
    OL3.prototype._initMap = function () {
        this.logger.trace('[OL3] : _initMap');
        var view = new ol.View({
            enableRotation: this.mapOptions.enableRotation,
            zoom: this.mapOptions.zoom,
            minZoom: this.mapOptions.minZoom,
            maxZoom: this.mapOptions.maxZoom,
            projection: this.mapOptions.projection,
            rotation: this.mapOptions.azimuth * Math.PI / 180
        });
        this.libMap = new ol.Map({
            target: this.div,
            view: view
        });
        this._afterInitMap();
    };
    OL3.prototype._toggleInteractions = function (controlId, controlOpts) {
        var interactions = this.getLibMapControl(controlId);
        if (interactions == null) {
            interactions = [];
            for (var i = 0; i < OL3.CONTROLSCLASSES[controlId].length; i++) {
                this.logger.trace('[OL3] : adding interaction ' + OL3.CONTROLSCLASSES[controlId][i].name + ' to the map.');
                var interaction = new OL3.CONTROLSCLASSES[controlId][i]();
                this.libMap.addInteraction(interaction);
                interactions.push(interaction);
            }
        }
        for (var ii = 0; ii < interactions.length; ii++) {
            var _interaction = interactions[ii];
            this.logger.trace('[OL3] : setting interaction to ' + controlOpts + ' for control : ' + controlId);
            _interaction.setActive(controlOpts);
        }
        return interactions;
    };
    OL3.prototype.setDraggable = function (controlOpts) {
        return this._toggleInteractions('draggable', controlOpts);
    };
    OL3.prototype.setKeyboard = function (controlOpts) {
        return this._toggleInteractions('keyboard', controlOpts);
    };
    OL3.prototype.setSelectable = function (controlOpts) {
        return this._toggleInteractions('selectable', controlOpts);
    };
    OL3.prototype.addZoomControl = function (controlOpts) {
        var control = new ol.control.Zoom({ target: controlOpts.div });
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addZoomBoxControl = function (controlOpts) {
        return null;
    };
    OL3.prototype.addOverviewControl = function (controlOpts) {
        this.logger.trace('[OL3] addOverviewControl : ... ');
        var ovOpts = {};
        if (controlOpts.div) {
            ovOpts.target = controlOpts.div;
        }
        ovOpts.collapsed = controlOpts.maximised ? false : true;
        if (controlOpts.layers && Array.isArray(controlOpts.layers)) {
            var layerObjs = this._getLayersObj(controlOpts.layers);
            var olLayers = [];
            layerObjs.forEach(function (layerObj) {
                this.logger.trace('[OL3] addOverviewControl : adding ' + layerObj.id + ' to map');
                olLayers.push(layerObj.obj);
            }, this);
            if (olLayers.length == 0 && controlOpts.layers.length > 0) {
                for (var i = 0; i < controlOpts.layers.length; i++) {
                    this.logger.trace('[OL3] addOverviewControl : adding geoportal layer : ' + controlOpts.layers[i] + ' to map');
                    var gpLayer = new ol.layer.GeoportalWMTS({ layer: controlOpts.layers[i] });
                    if (gpLayer) {
                        olLayers.push(gpLayer);
                    }
                }
            }
            if (olLayers.length > 0) {
                ovOpts.layers = olLayers;
            }
        }
        var viewOpts = {};
        var needsView = false;
        if (controlOpts.hasOwnProperty('minZoom')) {
            viewOpts.minZoom = controlOpts.minZoom;
            needsView = true;
        }
        if (controlOpts.hasOwnProperty('maxZoom')) {
            viewOpts.maxZoom = controlOpts.maxZoom;
            needsView = true;
        }
        if (controlOpts.hasOwnProperty('projection')) {
            viewOpts.projection = controlOpts.projection;
            needsView = true;
        }
        if (needsView) {
            ovOpts.view = new ol.View(viewOpts);
        }
        var control = new ol.control.OverviewMap(ovOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addOrientationControl = function (controlOpts) {
        var control = new ol.control.Rotate({
            target: controlOpts.div,
            autoHide: controlOpts.autoHide || false
        });
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addGraphicScaleControl = function (controlOpts) {
        var ol3units = controlOpts.units;
        if (ol3units && controlOpts.units.toLowerCase() == 'deg') {
            ol3units = 'degrees';
        } else if (ol3units && controlOpts.units.toLowerCase() == 'm') {
            ol3units = 'metric';
        }
        this.logger.trace('[OL3] addGraphicScaleControl : setting graphicscale units to ' + ol3units);
        var control = new ol.control.ScaleLine({
            target: controlOpts.div,
            units: ol3units,
            minWidth: controlOpts.minWidth
        });
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addGraticuleControl = function (controlOpts) {
        var options = controlOpts || {};
        options.strokeColor = options.strokeColor || '#000000';
        options.strokeOpacity = options.strokeOpacity || 0.2;
        options.strokeWidth = options.strokeWidth || 1;
        var rgba = IMap._hexToRgba(options.strokeColor, options.strokeOpacity);
        var graticule = new ol.Graticule({
            strokeStyle: new ol.style.Stroke({
                color: rgba,
                width: options.strokeWidth
            })
        });
        graticule.setMap(this.libMap);
        this.libMap.graticule = graticule;
        return graticule;
    };
    OL3.prototype.addMousePositionControl = function (controlOpts) {
        var mpOpts = {};
        if (controlOpts.div) {
            mpOpts.target = controlOpts.div;
        }
        mpOpts.collapsed = controlOpts.maximised ? false : true;
        if (controlOpts.systems && Array.isArray(controlOpts.systems) && controlOpts.systems.length > 0) {
            for (var i = 0; i < controlOpts.systems.length; i++) {
                if (!ol.proj.get(controlOpts.systems[i].crs)) {
                    this.logger.trace('[OL3] addMousePositionControl : crs [' + controlOpts.systems[i].crs + '] not found.');
                    continue;
                }
                if (!mpOpts.systems) {
                    mpOpts.systems = [];
                }
                mpOpts.systems.push(controlOpts.systems[i]);
            }
        }
        if (controlOpts.units && Array.isArray(controlOpts.units) && controlOpts.units.length > 0) {
            mpOpts.units = [];
            for (var ii = 0; ii < controlOpts.units.length; ii++) {
                if (typeof controlOpts.units[ii] == 'string') {
                    this.logger.trace('[OL3] addMousePositionControl : adding unit   [' + controlOpts.units[ii].toUpperCase());
                    mpOpts.units.push(controlOpts.units[ii]);
                }
            }
        }
        mpOpts.displayAltitude = controlOpts.displayAltitude;
        mpOpts.displayCoordinates = controlOpts.displayCoordinates;
        if (controlOpts.altitude) {
            mpOpts.altitude = controlOpts.altitude;
        }
        mpOpts.editCoordinates = controlOpts.editCoordinates;
        mpOpts.positionMarker = controlOpts.positionMarker;
        var control = new ol.control.GeoportalMousePosition(mpOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addRouteControl = function (controlOpts) {
        var rteOpts = {};
        if (controlOpts.div) {
            rteOpts.target = controlOpts.div;
        }
        rteOpts.collapsed = controlOpts.maximised ? false : true;
        if (controlOpts.graphs) {
            rteOpts.graphs = controlOpts.graphs;
        }
        if (controlOpts.exclusions) {
            rteOpts.exclusions = controlOpts.exclusions;
        }
        if (controlOpts.markersOpts) {
            rteOpts.markersOpts = {};
            if (controlOpts.markersOpts.departure) {
                rteOpts.markersOpts.departure = controlOpts.markersOpts.departure;
            }
            if (controlOpts.markersOpts.stages) {
                rteOpts.markersOpts.stages = controlOpts.markersOpts.stages;
            }
            if (controlOpts.markersOpts.arrival) {
                rteOpts.markersOpts.arrival = controlOpts.markersOpts.arrival;
            }
        }
        if (controlOpts.routeOptions) {
            rteOpts.routeOptions = controlOpts.routeOptions;
        }
        if (controlOpts.autocompleteOptions) {
            rteOpts.autocompleteOptions = controlOpts.autocompleteOptions;
        }
        var control = new ol.control.Route(rteOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addIsocurveControl = function (controlOpts) {
        var isoOpts = {};
        if (controlOpts.div) {
            isoOpts.target = controlOpts.div;
        }
        isoOpts.collapsed = controlOpts.maximised ? false : true;
        if (controlOpts.graphs) {
            isoOpts.graphs = controlOpts.graphs;
        }
        if (controlOpts.exclusions) {
            isoOpts.exclusions = controlOpts.exclusions;
        }
        if (controlOpts.methods) {
            isoOpts.methods = controlOpts.methods;
        }
        if (controlOpts.directions) {
            isoOpts.directions = controlOpts.directions;
        }
        if (controlOpts.markerOpts) {
            isoOpts.markerOpts = controlOpts.markerOpts;
        }
        if (controlOpts.isocurveOptions) {
            isoOpts.isocurveOptions = controlOpts.isocurveOptions;
        }
        if (controlOpts.autocompleteOptions) {
            isoOpts.autocompleteOptions = controlOpts.autocompleteOptions;
        }
        var control = new ol.control.Isocurve(isoOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addLayerImportControl = function (controlOpts) {
        var importOpts = {};
        if (controlOpts.div) {
            importOpts.target = controlOpts.div;
        }
        importOpts.collapsed = controlOpts.maximised ? false : true;
        if (controlOpts.layerTypes) {
            importOpts.layerTypes = controlOpts.layerTypes;
        }
        importOpts.webServicesOptions = {};
        if (controlOpts.webServicesOptions) {
            importOpts.webServicesOptions = controlOpts.webServicesOptions;
        } else {
            if (this.mapOptions && this.mapOptions.proxyUrl) {
                importOpts.webServicesOptions.proxyUrl = this.mapOptions.proxyUrl;
            }
            if (this.mapOptions && this.mapOptions.noProxyDomains) {
                importOpts.webServicesOptions.noProxyDomains = this.mapOptions.noProxyDomains;
            }
        }
        if (controlOpts.defaultStyles) {
            importOpts.vectorStyleOptions = {};
            var defaultMarkerSrc = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAmCAYAAABpuqMCAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAARDSURBVFiF3ZndaxxVGMZ/Z/YjX00Nadpo1qrFBgu56D9QbAtiLoRC7ywSNK1NURRREBKRFlSwFBW0gnSrJXY1CmISgyjFiyYSFC9ajE3MmpjdjWlMUtNos9lN9mteLzbRuCbZmTMTBB+Yi51znvd5n3nPnjnnjBIR/i/wuh4xpCpI0ojiENAA1AE1wCzwKzCE0EM5l2iShJvSyrXKnFVb8dOK4hmg3AIjifAmaU7ztMy7kYI7Zs6rQwjvka+AXcyiOMZx6XGahuE0AEHVitCFnhGAGoQugqrVaSrOKpNP4FWnSaxCGy1yWpesbyY/tLpwo7p/w0RxWHfI6Zk5q7ZSwhj6Q2sjzJLiXp1JQe+p+mllc4wA1CzHtw37lQmpCha5gbXpVxdJythh9z1kvzJJGrFixPBmOXixl+Z4mONmguZ4mIMXezG8WQsq5cs6tmDfTP7NXiSqN0vTzBD1TQfwbdmDUhX4tuyhvukATTNDlgxZ0SmUtUsgv0TZGPsv9FNSvXfNtpLqvey/0O+KTgF0zNQV7XHP4dsdtVvVKYCOmeqiPbwVOx21W9UpgI6ZWNEe2cSEo3arOgWwb0YYLp5G17Sjdqs6BdCZzYqL9B3dR2puYM221NwAfUf3uaJTAB0zaye5GmbWS6i2gdFQL5mFMCIJMgthRkO9hGobMLPFN4VWdAoptlcAQeUDRoG77YrZwDhQT4tk7JDsV6ZFMggv2+bZwyt2jYDuQnOa94GIFrc4IkzRrkPUM3NKsijatLjF0copsbJ++xec7TTPqw6EI/oB/glT+PC+13Y/aSQNv/Is+tNer09lMn7DMHwAYppp8fvTIpISkVQsFrslqww4M9OuqkgzANzl1MhCyrjZGAycm573pK1yFCyi5FoWvo/FYlPOT2fOqftRXMbB9lkEs+3zbe2f/FD5i3YMj2p3vn8/IV8DZ5yE+Gqkot+JEQCPada5dRhxEriiQ5ya90w+272916F+KpnJDLhjpkUy5HgESNqhZU2Vfr5ne+dSFtOBeso06J6cnEy6d0z0hPwEPGeH8sGVykvfjpfe1NZUci2+mHg7Go2G8z/d/goQVJ9B8S1veMYffujduo/thl+ZwUzDuBqJRGZWt7n/FcDH46lFNVLilar1uiTTxsJTnTssH/QpJVlMNQa5wbGJiWERya3Vz30zzfLb3OveY3dU5j5dp4e80Xdbd3TOu/H/yyAtpjnqgeGS8crRQRks+v5xf5gtY/KM/6NAVebhwvv90bLvHu2o/XId2pJSMmIaxo/RaHRMxN6yZtPM0K5K/7hl/FxVZgZWbs0mPDceeKcuGE95/kpSKUmaImHDNIfHrl+PiIj2zOb+MFvBY7IUOVl2ZG9g6bJH4ckJuRe/2NYZT3myKIkrGM4pNRyLjY+LW09URDb1+uaF0pfm3zJ+7zhRGdq1c9eDuwOBOzdLa/OG2X+APwE8DU64Y/5gfAAAAABJRU5ErkJggg==';
            var strokeOpacity;
            var strokeColor;
            var fillOpacity;
            var fillColor;
            if (controlOpts.defaultStyles.KML) {
                var userKMLDefaultStyles = controlOpts.defaultStyles.KML;
                var kmldefaultStyleOptions = {};
                kmldefaultStyleOptions.image = new ol.style.Icon({
                    src: userKMLDefaultStyles.markerSrc || defaultMarkerSrc,
                    anchor: [
                        userKMLDefaultStyles.markerXAnchor || 25.5,
                        userKMLDefaultStyles.markerYAnchor || 38
                    ],
                    anchorOrigin: 'top-left',
                    anchorXUnits: 'pixels',
                    anchorYUnits: 'pixels'
                });
                strokeOpacity = userKMLDefaultStyles.strokeOpacity || 0.8;
                strokeColor = userKMLDefaultStyles.strokeColor || '#002A50';
                kmldefaultStyleOptions.stroke = new ol.style.Stroke({
                    color: IMap._hexToRgba(strokeColor, strokeOpacity),
                    width: userKMLDefaultStyles.strokeWidth || 4
                });
                fillOpacity = userKMLDefaultStyles.polyFillOpacity || 0.5;
                fillColor = userKMLDefaultStyles.polyFillColor || '#00B798';
                kmldefaultStyleOptions.fill = new ol.style.Fill({ color: IMap._hexToRgba(fillColor, fillOpacity) });
                var kmldefaultStyle = new ol.style.Style(kmldefaultStyleOptions);
                importOpts.vectorStyleOptions.KML = { defaultStyle: kmldefaultStyle };
            }
            if (controlOpts.defaultStyles.GPX) {
                var userGPXDefaultStyles = controlOpts.defaultStyles.GPX;
                var gpxdefaultStyleOptions = {};
                gpxdefaultStyleOptions.image = new ol.style.Icon({
                    src: userGPXDefaultStyles.markerSrc || defaultMarkerSrc,
                    anchor: [
                        userGPXDefaultStyles.markerXAnchor || 25.5,
                        userGPXDefaultStyles.markerYAnchor || 38
                    ],
                    anchorOrigin: 'top-left',
                    anchorXUnits: 'pixels',
                    anchorYUnits: 'pixels'
                });
                strokeOpacity = userGPXDefaultStyles.strokeOpacity || 0.8;
                strokeColor = userGPXDefaultStyles.strokeColor || '#002A50';
                gpxdefaultStyleOptions.stroke = new ol.style.Stroke({
                    color: IMap._hexToRgba(strokeColor, strokeOpacity),
                    width: userGPXDefaultStyles.strokeWidth || 4
                });
                var gpxdefaultStyle = new ol.style.Style(gpxdefaultStyleOptions);
                importOpts.vectorStyleOptions.GPX = { defaultStyle: gpxdefaultStyle };
            }
            if (controlOpts.defaultStyles.GeoJSON) {
                var userGeoJSONDefaultStyles = controlOpts.defaultStyles.GeoJSON;
                var geoJSONdefaultStyleOptions = {};
                geoJSONdefaultStyleOptions.image = new ol.style.Icon({
                    src: userGeoJSONDefaultStyles.markerSrc || defaultMarkerSrc,
                    anchor: [
                        userGeoJSONDefaultStyles.markerXAnchor || 25.5,
                        userGeoJSONDefaultStyles.markerYAnchor || 38
                    ],
                    anchorOrigin: 'top-left',
                    anchorXUnits: 'pixels',
                    anchorYUnits: 'pixels'
                });
                strokeOpacity = userGeoJSONDefaultStyles.strokeOpacity || 0.8;
                strokeColor = userGeoJSONDefaultStyles.strokeColor || '#002A50';
                geoJSONdefaultStyleOptions.stroke = new ol.style.Stroke({
                    color: IMap._hexToRgba(strokeColor, strokeOpacity),
                    width: userGeoJSONDefaultStyles.strokeWidth || 4
                });
                fillOpacity = userGeoJSONDefaultStyles.polyFillOpacity || 0.5;
                fillColor = userGeoJSONDefaultStyles.polyFillColor || '#00B798';
                geoJSONdefaultStyleOptions.fill = new ol.style.Fill({ color: IMap._hexToRgba(strokeColor, strokeOpacity) });
                var geoJSONdefaultStyle = new ol.style.Style(geoJSONdefaultStyleOptions);
                importOpts.vectorStyleOptions.GeoJSON = { defaultStyle: geoJSONdefaultStyle };
            }
        }
        var control = new ol.control.LayerImport(importOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype._addLayerConfToLayerSwitcher = function (implLayer, layerOptions) {
        this.logger.trace('[OL3] : _addLayerConfToLayerSwitcher ... ');
        var lsControl = this.getLibMapControl('layerswitcher');
        if (lsControl) {
            lsControl.addLayer(implLayer, this._layerOptions2layerConf(layerOptions));
        }
    };
    OL3.prototype.addLayerSwitcherControl = function (controlOpts) {
        this.logger.trace('[OL3] : addLayerSwitcherControl ... ');
        var lsOpts = {
            layers: [],
            options: { collapsed: !(controlOpts && controlOpts.maximised) }
        };
        if (controlOpts.div) {
            lsOpts.options.target = controlOpts.div;
        }
        for (var i = 0; i < this._layers.length; i++) {
            var layer = this._layers[i];
            this.logger.trace('[OL3] : layerSwitcher : configuring layer : ' + layer.id);
            var layerConf = {
                layer: layer.obj,
                config: {}
            };
            if (layer.options.title) {
                this.logger.trace('[OL3] : layerSwitcher : setting title to [' + layer.options.title + '] for layer ' + layer.id);
                layerConf.config.title = layer.options.title;
            }
            if (layer.options.description) {
                this.logger.trace('[OL3] : layerSwitcher : setting description to [' + layer.options.description + '] for layer ' + layer.id);
                layerConf.config.description = layer.options.description;
            }
            if (layer.options.quicklookUrl) {
                this.logger.trace('[OL3] : layerSwitcher : setting quicklookUrl to [' + layer.options.quicklookUrl + '] for layer ' + layer.id);
                layerConf.config.quicklookUrl = layer.options.quicklookUrl;
            }
            if (layer.options.legends) {
                this.logger.trace('[OL3] : layerSwitcher : setting legends to [' + layer.options.legends + '] for layer ' + layer.id);
                layerConf.config.legends = layer.options.legends;
            }
            if (layer.options.metadata) {
                this.logger.trace('[OL3] : layerSwitcher : setting metadata to [' + layer.options.metadata + '] for layer ' + layer.id);
                layerConf.config.metadata = this._filterEmptyMetadata(layer.options.metadata);
            }
            lsOpts.layers.push(layerConf);
        }
        this.logger.trace('[OL3] : layerSwitcher Opts : ... ');
        var control = new ol.control.LayerSwitcher(lsOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype._fillStrokeStyles = function (stylesProps) {
        var strokeOpts = {};
        var resultStyle = null;
        if (stylesProps.hasOwnProperty('strokeLineDash')) {
            strokeOpts.lineDash = stylesProps.strokeLineDash;
        }
        if (stylesProps.hasOwnProperty('strokeColor')) {
            strokeOpts.color = stylesProps.strokeColor;
        }
        if (stylesProps.hasOwnProperty('strokeWidth')) {
            strokeOpts.width = stylesProps.strokeWidth;
        }
        if (Object.keys(strokeOpts).length > 0) {
            resultStyle = new ol.style.Stroke(strokeOpts);
        }
        return resultStyle;
    };
    OL3.prototype._fillPointerStyles = function (stylesProps) {
        var pointerOpts = {};
        if (stylesProps.hasOwnProperty('radius')) {
            pointerOpts.radius = stylesProps.radius;
        }
        pointerOpts.stroke = this._fillStrokeStyles(stylesProps);
        if (stylesProps.hasOwnProperty('fillColor')) {
            pointerOpts.fill = new ol.style.Fill({ color: stylesProps.fillColor });
        }
        var pStyle = new ol.style.Circle(pointerOpts);
        return pStyle;
    };
    OL3.prototype.addLengthControl = function (controlOpts) {
        var lengthOpts = {};
        if (controlOpts.div) {
            lengthOpts.target = controlOpts.div;
        }
        if (controlOpts.hasOwnProperty('styles')) {
            lengthOpts.styles = {};
            if (controlOpts.styles.hasOwnProperty('pointer')) {
                lengthOpts.styles.pointer = this._fillPointerStyles(controlOpts.styles.pointer);
            }
            if (controlOpts.styles.hasOwnProperty('start')) {
                var startOpts = {};
                startOpts.stroke = this._fillStrokeStyles(controlOpts.styles.start);
                if (controlOpts.styles.start.hasOwnProperty('fillColor')) {
                    startOpts.fill = new ol.style.Fill({ color: controlOpts.styles.start.fillColor });
                }
                lengthOpts.styles.start = new ol.style.Style(startOpts);
            }
            if (controlOpts.styles.hasOwnProperty('finish')) {
                var finishOpts = {};
                finishOpts.stroke = this._fillStrokeStyles(controlOpts.styles.finish);
                if (controlOpts.styles.finish.hasOwnProperty('fillColor')) {
                    finishOpts.fill = new ol.style.Fill({ color: controlOpts.styles.finish.fillColor });
                }
                lengthOpts.styles.finish = new ol.style.Style(finishOpts);
            }
        }
        if (controlOpts.hasOwnProperty('geodesic')) {
            lengthOpts.geodesic = controlOpts.geodesic;
        }
        var control = new ol.control.MeasureLength(lengthOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addAreaControl = function (controlOpts) {
        this.logger.trace('[OL3] addAreaControl : ... ');
        var areaOpts = {};
        if (controlOpts.div) {
            areaOpts.target = controlOpts.div;
        }
        if (controlOpts.hasOwnProperty('styles')) {
            areaOpts.styles = {};
            if (controlOpts.styles.hasOwnProperty('pointer')) {
                areaOpts.styles.pointer = this._fillPointerStyles(controlOpts.styles.pointer);
            }
            if (controlOpts.styles.hasOwnProperty('start')) {
                var startOpts = {};
                startOpts.stroke = this._fillStrokeStyles(controlOpts.styles.start);
                if (controlOpts.styles.start.hasOwnProperty('fillColor')) {
                    startOpts.fill = new ol.style.Fill({ color: controlOpts.styles.start.fillColor });
                }
                areaOpts.styles.start = new ol.style.Style(startOpts);
            }
            if (controlOpts.styles.hasOwnProperty('finish')) {
                var finishOpts = {};
                finishOpts.stroke = this._fillStrokeStyles(controlOpts.styles.finish);
                if (controlOpts.styles.finish.hasOwnProperty('fillColor')) {
                    finishOpts.fill = new ol.style.Fill({ color: controlOpts.styles.finish.fillColor });
                }
                areaOpts.styles.finish = new ol.style.Style(finishOpts);
            }
        }
        if (controlOpts.hasOwnProperty('geodesic')) {
            areaOpts.geodesic = controlOpts.geodesic;
        }
        var control = new ol.control.MeasureArea(areaOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addAzimuthControl = function (controlOpts) {
        var azimuthOpts = {};
        if (controlOpts.div) {
            azimuthOpts.target = controlOpts.div;
        }
        if (controlOpts.hasOwnProperty('styles')) {
            azimuthOpts.styles = {};
            if (controlOpts.styles.hasOwnProperty('pointer')) {
                azimuthOpts.styles.pointer = this._fillPointerStyles(controlOpts.styles.pointer);
            }
            if (controlOpts.styles.hasOwnProperty('start')) {
                var startOpts = {};
                startOpts.stroke = this._fillStrokeStyles(controlOpts.styles.start);
                if (controlOpts.styles.start.hasOwnProperty('fillColor')) {
                    startOpts.fill = new ol.style.Fill({ color: controlOpts.styles.start.fillColor });
                }
                azimuthOpts.styles.start = new ol.style.Style(startOpts);
            }
            if (controlOpts.styles.hasOwnProperty('finish')) {
                var finishOpts = {};
                finishOpts.stroke = this._fillStrokeStyles(controlOpts.styles.finish);
                if (controlOpts.styles.finish.hasOwnProperty('fillColor')) {
                    finishOpts.fill = new ol.style.Fill({ color: controlOpts.styles.finish.fillColor });
                }
                azimuthOpts.styles.finish = new ol.style.Style(finishOpts);
            }
        }
        if (controlOpts.hasOwnProperty('geodesic')) {
            azimuthOpts.geodesic = controlOpts.geodesic;
        }
        var control = new ol.control.MeasureAzimuth(azimuthOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addElevationPathControl = function (controlOpts) {
        var elevOpts = {};
        this.logger.trace('[OL3] addElevationPathControl : ... ');
        if (controlOpts.div) {
            elevOpts.target = controlOpts.div;
        }
        if (controlOpts.styles) {
            elevOpts.stylesOptions = {};
            if (controlOpts.styles.hasOwnProperty('pointer')) {
                elevOpts.stylesOptions.draw = {};
                elevOpts.stylesOptions.draw.pointer = this._fillPointerStyles(controlOpts.styles.pointer);
            }
            if (controlOpts.styles.hasOwnProperty('start')) {
                if (!elevOpts.stylesOptions.draw) {
                    elevOpts.stylesOptions.draw = {};
                }
                elevOpts.stylesOptions.draw.start = this._fillStrokeStyles(controlOpts.styles.start);
            }
            if (controlOpts.styles.hasOwnProperty('finish')) {
                if (!elevOpts.stylesOptions.draw) {
                    elevOpts.stylesOptions.draw = {};
                }
                elevOpts.stylesOptions.draw.finish = this._fillStrokeStyles(controlOpts.styles.finish);
            }
            if (controlOpts.styles.hasOwnProperty('marker')) {
                var markerOpts = {};
                if (controlOpts.styles.marker.src) {
                    markerOpts.src = controlOpts.styles.marker.src;
                    markerOpts.anchor = [
                        controlOpts.styles.marker.xAnchor ? controlOpts.styles.marker.xAnchor : 0,
                        controlOpts.styles.marker.yAnchor ? controlOpts.styles.marker.yAnchor : 0
                    ];
                }
                if (Object.keys(markerOpts).length > 0) {
                    elevOpts.stylesOptions.marker = new ol.style.Icon(markerOpts);
                }
            }
        }
        if (controlOpts.elevationPathOptions) {
            elevOpts.elevationPathOptions = controlOpts.elevationPathOptions;
        }
        if (controlOpts.displayProfileOptions) {
            elevOpts.displayProfileOptions = controlOpts.displayProfileOptions;
        }
        var control = new ol.control.ElevationPath(elevOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addSearchControl = function (controlOpts) {
        var searchOpts = {};
        if (searchOpts.div) {
            searchOpts.target = controlOpts.div;
        }
        searchOpts.collapsed = controlOpts.maximised ? false : true;
        searchOpts.zoomTo = controlOpts.zoomTo || null;
        if (controlOpts.hasOwnProperty('resources')) {
            searchOpts.resources = {};
            if (controlOpts.resources.hasOwnProperty('geocode')) {
                searchOpts.resources.geocode = controlOpts.resources.geocode;
            }
            if (controlOpts.resources.hasOwnProperty('autocomplete')) {
                searchOpts.resources.autocomplete = controlOpts.resources.autocomplete;
            }
        }
        searchOpts.displayAdvancedSearch = controlOpts.hasOwnProperty('displayAdvancedSearch') && controlOpts.displayAdvancedSearch === true ? true : false;
        if (controlOpts.hasOwnProperty('advancedSearch')) {
            searchOpts.advancedSearch = controlOpts.advancedSearch;
        }
        if (controlOpts.hasOwnProperty('geocodeOptions')) {
            searchOpts.geocodeOptions = controlOpts.geocodeOptions;
        }
        if (controlOpts.hasOwnProperty('autocompleteOptions')) {
            searchOpts.autocompleteOptions = controlOpts.autocompleteOptions;
        }
        var control = new ol.control.SearchEngine(searchOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addReverseSearchControl = function (controlOpts) {
        var searchOpts = {};
        if (searchOpts.div) {
            searchOpts.target = controlOpts.div;
        }
        searchOpts.collapsed = controlOpts.maximised ? false : true;
        if (controlOpts.hasOwnProperty('resources')) {
            searchOpts.resources = controlOpts.resources;
        }
        if (controlOpts.hasOwnProperty('reverseGeocodeOptions')) {
            searchOpts.reverseGeocodeOptions = controlOpts.reverseGeocodeOptions;
        }
        if (controlOpts.hasOwnProperty('delimitations')) {
            searchOpts.delimitations = controlOpts.delimitations;
        }
        var control = new ol.control.ReverseGeocode(searchOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addDrawingControl = function (controlOpts) {
        var drawingOpts = {};
        if (controlOpts.div) {
            drawingOpts.target = controlOpts.div;
        }
        drawingOpts.collapsed = controlOpts.maximised ? false : true;
        if (controlOpts.hasOwnProperty('tools')) {
            drawingOpts.tools = controlOpts.tools;
        }
        if (controlOpts.hasOwnProperty('labels')) {
            drawingOpts.labels = controlOpts.labels;
        }
        if (controlOpts.hasOwnProperty('defaultStyles')) {
            drawingOpts.defaultStyles = controlOpts.defaultStyles;
        }
        if (controlOpts.hasOwnProperty('cursorStyle')) {
            drawingOpts.cursorStyle = controlOpts.cursorStyle;
        }
        if (controlOpts.hasOwnProperty('markersList') && Array.isArray(controlOpts.markersList) && controlOpts.markersList.length > 0) {
            drawingOpts.markersList = [];
            for (var i = 0; i < controlOpts.markersList.length; i++) {
                var mrk = controlOpts.markersList[i];
                if (!mrk.src) {
                    continue;
                }
                var ol3mrk = { src: mrk.src };
                if (mrk.xAnchor && mrk.yAnchor) {
                    ol3mrk.anchor = [
                        mrk.xAnchor,
                        mrk.yAnchor
                    ];
                }
                drawingOpts.markersList.push(ol3mrk);
            }
        }
        if (controlOpts.layer) {
            var ol3layers = this._getLayersObj([controlOpts.layer]);
            if (ol3layers && ol3layers.length > 0) {
                drawingOpts.layer = ol3layers[0];
            }
        }
        var control = new ol.control.Drawing(drawingOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addAttributionsControl = function (controlOpts) {
        var attOpts = {};
        if (controlOpts.div) {
            attOpts.target = controlOpts.div;
        }
        attOpts.collapsed = controlOpts.maximised ? false : true;
        var control = new ol.control.GeoportalAttribution(attOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.addCameraControl = function (controlOpts) {
        return null;
    };
    OL3.prototype.addGetFeatureInfoControl = function (controlOpts) {
        var gfiOpts = {};
        gfiOpts.options = {};
        if (controlOpts.hasOwnProperty('options')) {
            if (controlOpts.options.hasOwnProperty('auto')) {
                gfiOpts.options.auto = controlOpts.options.auto;
            }
            if (controlOpts.options.hasOwnProperty('active')) {
                gfiOpts.options.active = controlOpts.options.active;
            }
            if (controlOpts.options.hasOwnProperty('hidden')) {
                gfiOpts.options.hidden = controlOpts.options.hidden;
            }
            if (controlOpts.options.hasOwnProperty('defaultEvent')) {
                gfiOpts.options.defaultEvent = controlOpts.options.defaultEvent;
            }
            if (controlOpts.options.hasOwnProperty('defaultInfoFormat')) {
                gfiOpts.options.defaultInfoFormat = controlOpts.options.defaultInfoFormat;
            }
            if (controlOpts.options.hasOwnProperty('cursorStyle')) {
                gfiOpts.options.cursorStyle = controlOpts.options.cursorStyle;
            }
            if (!controlOpts.options.hasOwnProperty('autoPanOptions')) {
                controlOpts.options.autoPanOptions = IMap.DEFAULT_AUTOPAN_OPTIONS;
            }
            gfiOpts.options.autoPan = controlOpts.options.autoPanOptions.autoPan;
            gfiOpts.options.autoPanAnimation = { duration: controlOpts.options.autoPanOptions.duration };
            gfiOpts.options.autoPanMargin = controlOpts.options.autoPanOptions.margin;
        }
        if (this.mapOptions && this.mapOptions.proxyUrl) {
            gfiOpts.options.proxyUrl = this.mapOptions.proxyUrl;
        }
        if (this.mapOptions && this.mapOptions.noProxyDomains) {
            gfiOpts.options.noProxyDomains = this.mapOptions.noProxyDomains;
        }
        gfiOpts.layers = [];
        for (var gfiLayerId in controlOpts.layers) {
            var gfiLayer = controlOpts.layers[gfiLayerId];
            for (var i = 0; i < this._layers.length; ++i) {
                var mapLayer = this._layers[i];
                if (gfiLayerId === mapLayer.id) {
                    if (!mapLayer.options.queryable) {
                        console.log('GetFeatureInfo layer \'' + gfiLayerId + '\' has not been added to control because this layer is not queryable.');
                    } else {
                        var layerConf = { obj: mapLayer.obj };
                        if (gfiLayer.event) {
                            layerConf.event = gfiLayer.event;
                        }
                        if (mapLayer.options.gfiFormat) {
                            layerConf.infoFormat = mapLayer.options.gfiFormat;
                        }
                        gfiOpts.layers.push(layerConf);
                        break;
                    }
                }
            }
        }
        var control = new ol.control.GetFeatureInfo(gfiOpts);
        this.libMap.addControl(control);
        return control;
    };
    OL3.prototype.removeControls = function (controlIds) {
        this.logger.trace('[OL3] : removeControls ... ');
        if (!controlIds || Array.isArray(controlIds) && controlIds.length == 0) {
            console.log('No control to remove.');
            return;
        }
        if (!Array.isArray(controlIds)) {
            controlIds = [controlIds];
        }
        var controlId = null;
        for (var i = 0; i < controlIds.length; i++) {
            controlId = controlIds[i];
            var idx = this._findRegisteredControl(controlId);
            if (idx >= 0) {
                this.logger.trace('[OL3] : removeControls : removing [' + controlId + '] from register.');
                this._controls.splice(idx, 1);
            }
            var olControl = this.getLibMapControl(controlId);
            if (!olControl) {
                console.log('Impossible to remove control [' + controlId + '] : not found or unhandled');
                continue;
            }
            if (controlId.toLowerCase() == 'graticule') {
                olControl.setMap(null);
                delete this.getLibMap().graticule;
                continue;
            }
            if (Array.isArray(olControl)) {
                return;
            }
            this.logger.trace('[OL3] : removeControls : removing [' + controlId + '] from Map.');
            this.libMap.removeControl(olControl);
        }
    };
    OL3.prototype.getLibMapControl = function (controlId) {
        var foundOlControl = null;
        if (!OL3.CONTROLSCLASSES.hasOwnProperty(controlId.toLowerCase()) || !OL3.CONTROLSCLASSES[controlId.toLowerCase()]) {
            this.logger.trace('[OL3] getLibMapControl : control ' + controlId + ' non implémenté.');
            return foundOlControl;
        }
        var olControlClass = OL3.CONTROLSCLASSES[controlId.toLowerCase()];
        if (Array.isArray(olControlClass)) {
            this.logger.trace('[OL3] getLibMapControl : searching interactions.');
            var olInteractions = [];
            this.getLibMap().getInteractions().forEach(function (interaction) {
                for (var j = 0; j < olControlClass.length; j++) {
                    if (interaction instanceof olControlClass[j]) {
                        this.logger.trace('[OL3] getLibMapControl : found interaction : ' + olControlClass[j].name);
                        olInteractions.push(interaction);
                        break;
                    }
                }
            }, this);
            return olInteractions.length > 0 ? olInteractions : null;
        }
        if (controlId.toLowerCase() == 'graticule') {
            return this.getLibMap().hasOwnProperty('graticule') ? this.getLibMap().graticule : null;
        }
        this.logger.trace('[OL3] getLibMapControl : controlClass : ' + olControlClass.name);
        var olControls = this.getLibMap().getControls().getArray();
        if (olControls.length == 0) {
            this.logger.trace('[OL3] getLibMapControl : no control found on map');
            return foundOlControl;
        }
        for (var i = 0; i < olControls.length; i++) {
            var olControl = olControls[i];
            this.logger.trace('[OL3] getLibMapControl : analyzing : ' + typeof olControl);
            if (olControl instanceof olControlClass) {
                foundOlControl = olControl;
                this.logger.trace('[OL3] getLibMapControl : found ! ');
                break;
            }
        }
        return foundOlControl;
    };
    OL3.prototype._addMarkers = function (markersOptions) {
        this.logger.trace('[OL3] : _addMarkers');
        if (!Array.isArray(markersOptions)) {
            console.log('Can not process markersOptions. It is not an Array.');
            return;
        }
        var mrkSource = null;
        var mrkLayer = null;
        var mo = null;
        var context = this;
        var ii = 0;
        var fopenPopup = function (evt) {
            var evtPx = context.getLibMap().getEventPixel(evt);
            context.logger.trace('[OL3] : _addMarkers : display content : ' + mo.content);
            ol.gp.GfiUtils.displayInfo(context.getLibMap(), context.getLibMap().getCoordinateFromPixel([
                evtPx[0] + this.mo.ppoffset[0],
                evtPx[1] + this.mo.ppoffset[1]
            ]), this.mo.content, this.mo.contentType, this.mo.autoPanOptions);
        };
        for (ii = 0; ii < markersOptions.length; ii++) {
            mo = markersOptions[ii];
            if (!mo.hasOwnProperty('content')) {
                mo.content = '';
            }
            if (!mo.hasOwnProperty('url')) {
                mo.url = ol.control.DefaultMarkers['lightOrange'];
            }
            if (!mo.hasOwnProperty('offset')) {
                mo.offset = ol.control.DefaultMarkers['defaultOffset'];
            }
            this.logger.trace('[OL3] : _addMarkers : offset [' + mo.offset[0] + ',' + mo.offset[1] + ']');
            if (!mo.hasOwnProperty('ppoffset')) {
                mo.ppoffset = [
                    0,
                    -15
                ];
            }
            var needsLocated = false;
            if (!mo.hasOwnProperty('position')) {
                mo.position = {
                    x: this.libMap.getView().getCenter()[0],
                    y: this.libMap.getView().getCenter()[1]
                };
                needsLocated = true;
            }
            if (!mo.hasOwnProperty('contentType')) {
                mo.contentType = 'text/html';
            }
            if (!mo.hasOwnProperty('autoPanOptions')) {
                mo.autoPanOptions = {
                    autoPan: IMap.DEFAULT_AUTOPAN_OPTIONS.autoPan,
                    autoPanAnimation: { duration: IMap.DEFAULT_AUTOPAN_OPTIONS.duration },
                    autoPanMargin: IMap.DEFAULT_AUTOPAN_OPTIONS.margin
                };
            }
            var fcoords = [
                mo.position.x,
                mo.position.y
            ];
            if (mo.position.hasOwnProperty('projection')) {
                fcoords = ol.proj.transform(fcoords, mo.position.projection, this.getProjection());
            }
            this.logger.trace('[OL3] : _addMarkers : coords [' + fcoords[0] + ',' + fcoords[1] + ']');
            var mrkImg = document.createElement('img');
            mrkImg.src = mo.url;
            mrkImg.mo = mo;
            var mrk = new ol.Overlay({
                position: fcoords,
                offset: mo.offset,
                element: mrkImg
            });
            this.libMap.addOverlay(mrk);
            if (needsLocated === true) {
                var gpMap = this;
                var changeCenter = function (locEvt) {
                    var fcoords = [
                        locEvt.position.x,
                        locEvt.position.y
                    ];
                    if (locEvt.position.hasOwnProperty('projection')) {
                        fcoords = ol.proj.transform(fcoords, locEvt.position.projection, gpMap.getProjection());
                    }
                    this.setPosition(fcoords);
                };
                this.listen('located', changeCenter, mrk);
                this.listen('geolocated', changeCenter, mrk);
            }
            mrkImg.addEventListener('click', fopenPopup, true);
            mrkImg.addEventListener('touchend', fopenPopup, true);
        }
    };
    OL3.prototype._getCommonLayerParams = function (ol3layerOpts) {
        var commonOpts = {};
        this.logger.trace('[OL3] : _getCommonLayerParams ');
        if (ol3layerOpts.hasOwnProperty('opacity')) {
            this.logger.trace('[OL3] : _getCommonLayerParams - opacity : ' + ol3layerOpts.opacity);
            commonOpts.opacity = ol3layerOpts.opacity;
        }
        if (ol3layerOpts.hasOwnProperty('visible')) {
            this.logger.trace('[OL3] : _getCommonLayerParams - visibility : ' + ol3layerOpts.visible);
            commonOpts.visibility = ol3layerOpts.visible;
        }
        if (ol3layerOpts.hasOwnProperty('zIndex')) {
            this.logger.trace('[OL3] : _getCommonLayerParams - position : ' + ol3layerOpts.zIndex);
            commonOpts.position = ol3layerOpts.zIndex;
        }
        if (ol3layerOpts.hasOwnProperty('maxResolution')) {
            var minZoom = this._getZoomFromResolution(ol3layerOpts.maxResolution);
            this.logger.trace('[OL3] : _getCommonLayerParams - minZoom : ' + minZoom);
            commonOpts.minZoom = minZoom;
        }
        if (ol3layerOpts.hasOwnProperty('minResolution')) {
            var maxZoom = this._getZoomFromResolution(ol3layerOpts.minResolution);
            this.logger.trace('[OL3] : _getCommonLayerParams - maxZoom : ' + maxZoom);
            commonOpts.maxZoom = maxZoom;
        }
        return commonOpts;
    };
    OL3.prototype._applyCommonLayerParams = function (layerOpts) {
        var commonOpts = {};
        this.logger.trace('[OL3] : _applyCommonLayerParams ');
        if (layerOpts.hasOwnProperty('opacity')) {
            this.logger.trace('[OL3] : _applyCommonLayerParams - opacity : ' + layerOpts.opacity);
            commonOpts.opacity = layerOpts.opacity;
        }
        if (layerOpts.hasOwnProperty('visibility')) {
            this.logger.trace('[OL3] : _applyCommonLayerParams - visibility : ' + layerOpts.visibility);
            commonOpts.visible = layerOpts.visibility;
        }
        if (layerOpts.hasOwnProperty('position')) {
            this.logger.trace('[OL3] : _applyCommonLayerParams - position : ' + layerOpts.position);
            commonOpts.zIndex = layerOpts.position;
        }
        if (layerOpts.hasOwnProperty('maxZoom') && layerOpts.maxZoom >= 0 && layerOpts.maxZoom <= 20) {
            var minRes = this._getResolutionFromZoomLevel(layerOpts.maxZoom);
            this.logger.trace('[OL3] : _applyCommonLayerParams - minRes : ' + minRes);
            commonOpts.minResolution = minRes;
        }
        if (layerOpts.hasOwnProperty('minZoom') && layerOpts.minZoom >= 0 && layerOpts.minZoom <= 20) {
            var maxRes = this._getResolutionFromZoomLevel(layerOpts.minZoom);
            this.logger.trace('[OL3] : _applyCommonLayerParams - maxRes : ' + maxRes);
            commonOpts.maxResolution = maxRes;
        }
        if (layerOpts.hasOwnProperty('grayScaled')) {
            this.logger.trace('[OL3] : _applyCommonLayerParams - grayScaled : ' + layerOpts.grayScaled);
            commonOpts.grayScaled = layerOpts.grayScaled;
        }
        return commonOpts;
    };
    OL3.prototype._checkLayerParams = function (layerOpts) {
        if (!IMap.prototype._checkLayerParams.apply(this, arguments)) {
            return false;
        }
        return true;
    };
    OL3.prototype._addRasterLayer = function (layerObj) {
        var layerId = Object.keys(layerObj)[0];
        var layerOpts = layerObj[layerId];
        if (layerOpts.isElevation !== true) {
            var constructorOpts = this._applyCommonLayerParams(layerOpts);
            switch (layerOpts.format.toUpperCase()) {
            case 'WMS':
                this.logger.trace('ajout d\'une couche WMS');
                var params = {};
                params.LAYERS = layerOpts.layers.join(',');
                if (layerOpts.version) {
                    params.VERSION = layerOpts.version;
                }
                layerOpts.stylesNames = layerOpts.stylesNames || layerOpts.stylesName;
                if (layerOpts.stylesNames) {
                    if (Array.isArray(layerOpts.stylesNames)) {
                        params.STYLES = layerOpts.stylesNames.join();
                    } else {
                        console.log('\'stylesNames\' parameter should be an array of style names (string)');
                    }
                }
                if (layerOpts.outputFormat) {
                    params.FORMAT = layerOpts.outputFormat;
                }
                if (layerOpts.backgroundColor) {
                    params.BGCOLOR = layerOpts.backgroundColor;
                    params.TRANSPARENT = 'FALSE';
                } else {
                    params.TRANSPARENT = 'TRUE';
                }
                var sourceOpts = {
                    url: layerOpts.url,
                    params: params
                };
                if (layerOpts.hasOwnProperty('projection')) {
                    sourceOpts.projection = layerOpts.projection;
                }
                if (layerOpts.hasOwnProperty('tiled') && layerOpts.tiled === true) {
                    constructorOpts.source = new ol.source.TileWMS(sourceOpts);
                } else {
                    constructorOpts.source = new ol.source.ImageWMS(sourceOpts);
                }
                break;
            case 'WMTS':
                this.logger.trace('ajout d\'une couche WMTS');
                var lOpts = this._getWMTSDefaultOpts();
                for (var opt in layerOpts) {
                    lOpts[opt] = layerOpts[opt];
                }
                layerOpts = lOpts;
                var sourceOpts = {
                    url: layerOpts.url,
                    layer: layerOpts.layer,
                    matrixSet: layerOpts.tileMatrixSet,
                    format: layerOpts.outputFormat,
                    version: layerOpts.version,
                    style: layerOpts.styleName,
                    tileGrid: new ol.tilegrid.WMTS({
                        origin: [
                            layerOpts.topLeftCorner.x,
                            layerOpts.topLeftCorner.y
                        ],
                        resolutions: layerOpts.resolutions,
                        matrixIds: layerOpts.matrixIds
                    })
                };
                if (layerOpts.url.indexOf('{TileMatrixSet}') > 0 || layerOpts.url.indexOf('{TileRow}') > 0 || layerOpts.url.indexOf('{TileCol}') > 0) {
                    sourceOpts.requestEncoding = 'REST';
                } else {
                    sourceOpts.requestEncoding = 'KVP';
                }
                constructorOpts.source = new ol.source.WMTSExtended(sourceOpts);
                break;
            case 'OSM':
                this.logger.trace('ajout d\'une couche OSM');
                constructorOpts.source = new ol.source.OSM({ url: layerOpts.url });
                break;
            default:
            }
            if (constructorOpts.hasOwnProperty('source')) {
                if (layerOpts.hasOwnProperty('originators')) {
                    constructorOpts.source._originators = layerOpts.originators;
                }
                var layer = null;
                if (layerOpts.format.toUpperCase() == 'WMS' && (!layerOpts.hasOwnProperty('tiled') || layerOpts.tiled !== true)) {
                    layer = new ol.layer.Image(constructorOpts);
                } else {
                    layer = new ol.layer.Tile(constructorOpts);
                }
                if (constructorOpts.hasOwnProperty('zIndex') && constructorOpts.zIndex === 0) {
                    layer._forceNullzIndex = true;
                }
                var gpLayer = {
                    id: layerId,
                    obj: layer,
                    options: layerOpts
                };
                if (layerOpts.hasOwnProperty('grayScaled') && layerOpts.grayScaled) {
                    this._colorGrayscaleLayerSwitch(gpLayer, true);
                }
                this._layers.push(gpLayer);
                this.libMap.addLayer(gpLayer.obj);
                this._addLayerConfToLayerSwitcher(gpLayer.obj, layerOpts);
            }
        } else {
            var elevationLayer = {
                id: layerId,
                obj: '3D-only-layer',
                options: layerOpts
            };
            if (!this._3Dlayers) {
                this._3Dlayers = [];
            }
            this._3Dlayers.push(elevationLayer);
        }
    };
    OL3.prototype._addVectorLayer = function (layerObj) {
        var layerId = Object.keys(layerObj)[0];
        var layerOpts = layerObj[layerId];
        var constructorOpts = this._applyCommonLayerParams(layerOpts);
        var layerStyleOptions = layerOpts.styleOptions || {};
        var defaultMapOptions = this.mapOptions.defaultFeaturesStyle || {};
        var defaultOptions = IMap.DEFAULT_VECTORLAYERS_STYLES;
        var styleOptions = {};
        styleOptions.image = new ol.style.Icon({
            src: layerStyleOptions.markerSrc || defaultMapOptions.markerSrc || defaultOptions.markerSrc,
            anchor: [
                layerStyleOptions.markerXAnchor || defaultMapOptions.markerXAnchor || defaultOptions.markerXAnchor,
                layerStyleOptions.markerYAnchor || defaultMapOptions.markerYAnchor || defaultOptions.markerYAnchor
            ],
            anchorOrigin: 'top-left',
            anchorXUnits: 'pixels',
            anchorYUnits: 'pixels'
        });
        styleOptions.stroke = new ol.style.Stroke({
            color: IMap._hexToRgba(layerStyleOptions.strokeColor || defaultMapOptions.strokeColor || defaultOptions.strokeColor, layerStyleOptions.strokeOpacity || defaultMapOptions.strokeOpacity || defaultOptions.strokeOpacity),
            width: layerStyleOptions.strokeWidth || defaultMapOptions.strokeWidth || defaultOptions.strokeWidth
        });
        styleOptions.fill = new ol.style.Fill({ color: IMap._hexToRgba(layerStyleOptions.polyFillColor || defaultMapOptions.polyFillColor || defaultOptions.polyFillColor, layerStyleOptions.polyFillOpacity || defaultMapOptions.polyFillOpacity || defaultOptions.polyFillOpacity) });
        styleOptions.text = new ol.style.Text({
            font: '16px Sans',
            textAlign: 'left',
            fill: new ol.style.Fill({ color: IMap._hexToRgba(layerStyleOptions.textColor || defaultMapOptions.textColor || defaultOptions.textColor, 1) })
        });
        if (layerStyleOptions.textStrokeColor) {
            styleOptions.text.stroke = new ol.style.Stroke({
                color: IMap._hexToRgba(layerStyleOptions.textStrokeColor || defaultMapOptions.textStrokeColor || defaultOptions.textStrokeColor, 1),
                width: 1
            });
        }
        var vectorStyle = new ol.style.Style(styleOptions);
        switch (layerOpts.format.toUpperCase()) {
        case 'KML':
            this.logger.trace('ajout d\'une couche KML');
            var urlKml = this.setProxy(layerOpts.url);
            var formatKml = new ol.format.KMLExtended({
                extractStyles: layerOpts.extractStyles,
                showPointNames: layerOpts.showPointNames,
                defaultStyle: [vectorStyle]
            });
            constructorOpts.source = new ol.source.Vector({
                features: new ol.Collection(),
                loader: function (extent, resolution, projectionFeature) {
                    Gp.Protocols.XHR.call({
                        url: urlKml,
                        method: 'GET',
                        timeOut: 15000,
                        onResponse: function (response) {
                            var projectionData = formatKml.readProjection(response);
                            var features = formatKml.readFeatures(response, {
                                dataProjection: projectionData,
                                featureProjection: projectionFeature
                            });
                            if (features.length > 0) {
                                constructorOpts.source.addFeatures(features);
                            }
                        },
                        onFailure: function (error) {
                            console.log('[ol.control.LayerImport] Kml/Gpx request failed : ', error);
                        }
                    });
                }
            });
            break;
        case 'GPX':
            this.logger.trace('ajout d\'une couche GPX');
            constructorOpts.source = new ol.source.Vector({
                url: this.setProxy(layerOpts.url),
                format: new ol.format.GPX()
            });
            constructorOpts.style = vectorStyle;
            break;
        case 'GEORSS':
            break;
        case 'GEOJSON':
            this.logger.trace('ajout d\'une couche GeoJSON');
            constructorOpts.source = new ol.source.Vector({
                url: this.setProxy(layerOpts.url),
                format: new ol.format.GeoJSON()
            });
            constructorOpts.style = vectorStyle;
            break;
        case 'WFS':
            this.logger.trace('ajout d\'une couche WFS');
            var maxFeatures = '';
            var sld = '';
            if (!layerOpts.version) {
                layerOpts.version = '2.0.0';
            }
            if (!layerOpts.outputFormat) {
                layerOpts.outputFormat = 'application/json';
            }
            if (layerOpts.maxFeatures) {
                if (parseInt(layerOpts.version.charAt(0)) < 2) {
                    maxFeatures = '&maxFeatures=' + layerOpts.maxFeatures;
                } else {
                    maxFeatures = '&count=' + layerOpts.maxFeatures;
                }
            }
            if (layerOpts.sld) {
                sld = '&sld=' + layerOpts.sld;
            }
            var layerUrl = this.setProxy(layerOpts.url);
            var oflc = layerOpts.outputFormat.toLowerCase();
            var format = null;
            var formatOptions = {};
            if (layerOpts.projection) {
                formatOptions['defaultDataProjection'] = layerOpts.projection;
                formatOptions['srsName'] = layerOpts.projection;
            }
            if (oflc.indexOf('gml') > 0 || oflc.indexOf('xml') > 0) {
                if (oflc.indexOf('2.1') > 0 || oflc.indexOf('gml2') > 0) {
                    format = new ol.format.GML2(formatOptions);
                } else {
                    format = new ol.format.GML3(formatOptions);
                }
            } else {
                format = new ol.format.GeoJSON(formatOptions);
            }
            constructorOpts.source = new ol.source.Vector({
                format: format,
                url: function (extent, resolution, projection) {
                    return layerUrl + '?service=WFS&request=GetFeature' + '&version=' + layerOpts.version + '&typename=' + layerOpts.typeNames + '&outputFormat=' + layerOpts.outputFormat + '&srsname=' + projection.getCode() + '&bbox=' + extent.join(',') + ',' + projection.getCode() + maxFeatures + sld;
                },
                strategy: ol.loadingstrategy.bbox
            });
            break;
        case 'drawing':
            this.logger.trace('ajout d\'une couche de dessin');
            constructorOpts.source = new ol.source.Vector({});
            break;
        default:
        }
        if (constructorOpts.hasOwnProperty('source')) {
            if (layerOpts.hasOwnProperty('originators')) {
                constructorOpts.source._originators = layerOpts.originators;
            }
            var layer = new ol.layer.Vector(constructorOpts);
            this._layers.push({
                id: layerId,
                obj: layer,
                options: layerOpts
            });
            this.libMap.addLayer(layer);
            this._addLayerConfToLayerSwitcher(layer, layerOpts);
            var _map = this.libMap;
            var _vectorSource = constructorOpts.source;
            if (_map.getView() && _map.getSize() && _vectorSource.getExtent) {
                var _fit = layerOpts.zoomToExtent || false;
                if (_fit) {
                    var key = _vectorSource.on('change', function () {
                        var _sourceExtent = _vectorSource.getExtent();
                        var _stateExtent = _vectorSource.getState();
                        if (_stateExtent === 'ready' && _sourceExtent[0] !== Infinity) {
                            ol.Observable.unByKey(key);
                            _map.getView().fit(_sourceExtent, { maxZoom: 18 });
                        }
                    });
                    setTimeout(function () {
                        _vectorSource.dispatchEvent('change');
                    }, 100);
                }
            }
        }
    };
    OL3.prototype._addGeoportalLayer = function (layerObj) {
        var layerId = Object.keys(layerObj)[0];
        var layerOpts = layerObj[layerId];
        var olParams = {};
        if (layerOpts.hasOwnProperty('opacity')) {
            olParams.opacity = layerOpts.opacity;
        }
        if (layerOpts.hasOwnProperty('visibility')) {
            olParams.visible = layerOpts.visibility;
        }
        if (layerOpts.hasOwnProperty('position')) {
            olParams.zIndex = layerOpts.position;
        }
        if (layerOpts.hasOwnProperty('minZoom') && layerOpts.minZoom >= 0 && layerOpts.minZoom <= 28) {
            olParams.maxResolution = this._getResolutionFromZoomLevel(layerOpts.minZoom);
            this.logger.trace('[OL3] : apply MaxResolution : ' + olParams.maxResolution);
        }
        if (layerOpts.hasOwnProperty('maxZoom') && layerOpts.maxZoom >= 0 && layerOpts.maxZoom <= 28) {
            olParams.minResolution = this._getResolutionFromZoomLevel(layerOpts.maxZoom);
            this.logger.trace('[OL3] : apply minResolution : ' + olParams.minResolution);
        }
        var LayerClass = null;
        switch (layerOpts.format.toUpperCase()) {
        case 'WMTS':
            LayerClass = ol.layer.GeoportalWMTS;
            break;
        case 'WMS':
            LayerClass = ol.layer.GeoportalWMS;
            break;
        default:
            console.log('addGeoportalLayer : no class found for ' + layerOpts.format);
        }
        var olLayer = new LayerClass({
            layer: layerId,
            olParams: olParams
        });
        if (layerOpts.hasOwnProperty('originators')) {
            olLayer.getSource()._originators = layerOpts.originators;
        }
        if (olParams.hasOwnProperty('zIndex') && olParams.zIndex === 0) {
            olLayer._forceNullzIndex = true;
        }
        this._layers.push({
            id: layerId,
            obj: olLayer,
            options: layerOpts
        });
        this.libMap.addLayer(olLayer);
        this._addLayerConfToLayerSwitcher(olLayer, layerOpts);
    };
    OL3.prototype.removeLayers = function (layerIds) {
        if (!IMap.prototype.removeLayers.apply(this, arguments)) {
            return false;
        }
        var _layers = this._getLayersObj(layerIds);
        _layers.forEach(function (_layer, i, array) {
            this.libMap.removeLayer(_layer.obj);
        }, this);
    };
    OL3.prototype.modifyLayers = function (layersOptions) {
        if (!IMap.prototype.modifyLayers.apply(this, arguments)) {
            return false;
        }
        var layerIds = Object.keys(layersOptions);
        var _layerObjs = this._getLayersObj(layerIds);
        _layerObjs.forEach(function (_layerObj) {
            this.logger.trace('[IMap] modifyLayers : modifying : [' + _layerObj.id + ']');
            var commonOpts = this._applyCommonLayerParams(layersOptions[_layerObj.id]);
            if (commonOpts.hasOwnProperty('opacity')) {
                this.logger.trace('[IMap] modifyLayers : setting opacity of : [' + _layerObj.id + '] to : ' + commonOpts.opacity);
                _layerObj.obj.setOpacity(commonOpts.opacity);
            }
            if (commonOpts.hasOwnProperty('visible')) {
                this.logger.trace('[IMap] modifyLayers : setting visible of : [' + _layerObj.id + '] to : ' + commonOpts.visible);
                _layerObj.obj.setVisible(commonOpts.visible);
            }
            if (commonOpts.hasOwnProperty('zIndex')) {
                this.logger.trace('[IMap] modifyLayers : setting zIndex of : [' + _layerObj.id + '] to : ' + commonOpts.zIndex);
                _layerObj.obj.setZIndex(commonOpts.zIndex);
                if (commonOpts.zIndex === 0) {
                    _layerObj.obj._forceNullzIndex = true;
                }
                if (commonOpts.zIndex !== 0 && _layerObj.obj._forceNullzIndex) {
                    _layerObj.obj._forceNullzIndex = false;
                }
            }
            if (commonOpts.hasOwnProperty('minResolution')) {
                this.logger.trace('[IMap] modifyLayers : setting minResolution of : [' + _layerObj.id + '] to : ' + commonOpts.minResolution);
                _layerObj.obj.setMinResolution(commonOpts.minResolution);
            }
            if (commonOpts.hasOwnProperty('maxResolution')) {
                this.logger.trace('[IMap] modifyLayers : setting maxResolution of : [' + _layerObj.id + '] to : ' + commonOpts.maxResolution);
                _layerObj.obj.setMaxResolution(commonOpts.maxResolution);
            }
            if (commonOpts.hasOwnProperty('grayScaled')) {
                this.logger.trace('[IMap] modifyLayers : setting grayScaled of : [' + _layerObj.id + '] to : ' + commonOpts.grayScaled);
                this._changeLayerColor(_layerObj.id, commonOpts.grayScaled);
            }
        }, this);
    };
    OL3.prototype.getProjection = function () {
        return this.libMap.getView().getProjection().getCode();
    };
    OL3.prototype.getCenter = function () {
        var center = {
            x: this.libMap.getView().getCenter()[0],
            y: this.libMap.getView().getCenter()[1]
        };
        return center;
    };
    OL3.prototype.getViewExtent = function (projection) {
        var bbox = {};
        if (this.libMap && this.libMap.getView()) {
            var extent = this.libMap.getView().calculateExtent(this.libMap.getSize());
            var mapProj = this.libMap.getView().getProjection().getCode();
            if (projection && projection != mapProj) {
                extent = ol.proj.transformExtent(extent, mapProj, projection);
            }
            bbox.left = extent[0];
            bbox.right = extent[2];
            bbox.bottom = extent[1];
            bbox.top = extent[3];
        }
        return bbox;
    };
    OL3.prototype.getAzimuth = function () {
        return this.libMap.getView().getRotation() * 180 / Math.PI;
    };
    OL3.prototype.getZoom = function () {
        return this._getZoomFromResolution(this.getResolution());
    };
    OL3.prototype.getResolution = function () {
        return this.libMap.getView().getResolution();
    };
    OL3.prototype.getLibMap = function () {
        return this.libMap;
    };
    OL3.prototype.setProjection = function (projection) {
        var view = new ol.View({
            center: this.libMap.getView().getCenter(),
            projection: projection,
            rotation: this.libMap.getView().getRotation(),
            zoom: this.getZoom()
        });
        this.libMap.setView(view);
    };
    OL3.prototype.setXYCenter = function (point) {
        this.logger.trace('[OL3] - setXYCenter');
        if (!point.hasOwnProperty('x') || !point.hasOwnProperty('y')) {
            console.log('no valid coordinates for map center');
            return;
        }
        var center = [
            point.x,
            point.y
        ];
        var mapProj = this.libMap.getView().getProjection().getCode();
        if (point.projection && point.projection != mapProj) {
            center = ol.proj.transform(center, point.projection, mapProj);
        }
        this.libMap.getView().setCenter(center);
        this.logger.trace('[OL3] - setXYCenter(' + point.x + ',' + point.y + '), projection Map : ' + mapProj);
    };
    OL3.prototype.setAutoCenter = function (point, zoom) {
        this.logger.trace('[IT] - setAutoCenter');
        this.setXYCenter(point, zoom);
    };
    OL3.prototype.setAzimuth = function (azimuth) {
        this.libMap.getView().setRotation(azimuth * Math.PI / 180);
    };
    OL3.prototype.setZoom = function (zoom) {
        this.libMap.getView().setZoom(zoom);
    };
    OL3.prototype.setResolution = function (resolution) {
        this.libMap.getView().setResolution(resolution);
    };
    OL3.prototype.zoomIn = function () {
        this.libMap.getView().setZoom(this.getZoom() + 1);
    };
    OL3.prototype.zoomOut = function () {
        this.libMap.getView().setZoom(this.getZoom() - 1);
    };
    OL3.prototype._getLayerOpts = function (layerObj, layersStack) {
        var layerOpts = null;
        layersStack = layersStack || this._layers;
        for (var i = 0; i < layersStack.length; i++) {
            var l = layersStack[i];
            if (l.obj === layerObj) {
                layerOpts = {};
                layerOpts[l.id] = l.options;
                break;
            }
        }
        return layerOpts;
    };
    OL3.prototype._registerUnknownLayer = function (layerObj) {
        var layerId = 'unknownLayer';
        if (layerObj.hasOwnProperty('gpResultLayerId')) {
            layerId = layerObj.gpResultLayerId;
        }
        layerId += '-' + Date.now();
        var options = {};
        if (layerId.indexOf('drawing-') === 0) {
            options.format = 'drawing';
        } else if (layerId.indexOf('layerimport:KML') === 0) {
            options.format = 'KML';
        } else if (layerId.indexOf('layerimport:GPX') === 0) {
            options.format = 'GPX';
        } else if (layerId.indexOf('layerimport:GeoJSON') === 0) {
            options.format = 'GeoJSON';
        } else if (layerId.indexOf('layerimport:WMS') === 0) {
            options.format = 'WMS';
            if (layerObj.gpGFIparams) {
                if (layerObj.gpGFIparams.queryable) {
                    options.queryable = true;
                }
                if (Array.isArray(layerObj.gpGFIparams.formats)) {
                    options.gfiFormat = layerObj.gpGFIparams.formats[0];
                    for (var i = 0; i < layerObj.gpGFIparams.formats.length; i++) {
                        if (layerObj.gpGFIparams.formats[i] === 'text/html') {
                            options.gfiFormat = 'text/html';
                            break;
                        }
                    }
                }
            }
        } else if (layerId.indexOf('layerimport:WMTS') === 0) {
            options.format = 'WMTS';
        }
        this._layers.push({
            id: layerId,
            obj: layerObj,
            options: options
        });
        var layerOpts = {};
        layerOpts[layerId] = {};
        return layerOpts;
    };
    OL3.prototype.getLSLayerContainerDivId = function (layerId) {
        var id = null;
        var idxLS = this._findRegisteredControl('layerswitcher');
        if (idxLS < 0) {
            this.logger.trace('[OL3] : getLSLayerContainerDivId : no layerswitcher on map !');
            return id;
        }
        var ol3layers = this._getLayersObj([layerId]);
        if (ol3layers.length > 0) {
            var ol3ls = this._controls[idxLS].obj;
            return ol3ls.getLayerDOMId(ol3layers[0].obj);
        }
        this.logger.trace('[OL3] : getLSLayerContainerDivId : layer [' + layerId + '] not found on map !');
        return id;
    };
    OL3.prototype.listen = function (eventId, action, context) {
        this.logger.trace('[OL3] : listen...');
        if (!IMap.prototype.listen.apply(this, arguments)) {
            return false;
        }
        context = context || this;
        var map = this;
        var olEventKey = null;
        switch (eventId) {
        case 'mapLoaded':
            break;
        case 'mapFailure':
            break;
        case 'located':
            break;
        case 'geolocated':
            break;
        case 'configured':
            break;
        case 'centerChanged':
            olEventKey = this.libMap.getView().on('change:center', function (ol3evt) {
                var centerChangedEvt = {};
                if (ol3evt.oldValue) {
                    centerChangedEvt.oldCenter = {
                        x: ol3evt.oldValue[0],
                        y: ol3evt.oldValue[1]
                    };
                }
                centerChangedEvt.newCenter = {
                    x: this.libMap.getView().getCenter()[0],
                    y: this.libMap.getView().getCenter()[1]
                };
                action.call(context, centerChangedEvt);
            }, this);
            break;
        case 'zoomChanged':
            olEventKey = this.libMap.getView().on('change:resolution', function (ol3evt) {
                action.call(context, {
                    oldZoom: this._getZoomFromResolution(ol3evt.oldValue),
                    newZoom: this._getZoomFromResolution(this.libMap.getView().getResolution())
                });
            }, this);
            break;
        case 'azimuthChanged':
            olEventKey = this.libMap.getView().on('change:rotation', function (ol3evt) {
                action.call(context, {
                    oldAzimuth: ol3evt.oldValue * 180 / Math.PI,
                    newAzimuth: this.libMap.getView().getRotation() * 180 / Math.PI
                });
            }, this);
            break;
        case 'tiltChanged':
            break;
        case 'projectionChanged':
            break;
        case 'layerChanged':
            olEventKey = this.libMap.getLayers().on('add', function (ol3evt) {
                var ladded = ol3evt.element;
                var layerOpts = this._getLayerOpts(ladded);
                if (!layerOpts) {
                    map.logger.trace('[OL3] listen : enregistrement d\'une couche \'inconnue\'.');
                    layerOpts = this._registerUnknownLayer(ladded);
                }
                action.call(context, {
                    layerAdded: layerOpts,
                    position: ladded.getZIndex()
                });
            }, this);
            this._registerEvent(olEventKey, eventId, action, context);
            olEventKey = this.libMap.getLayers().on('remove', function (ol3evt) {
                var lremoved = ol3evt.element;
                var layerOpts = this._getLayerOpts(lremoved) || this._getLayerOpts(lremoved, this._layersRemoved);
                var self = context.getLibMap();
                if (self.featuresOverlay && layerOpts[self.featuresOverlay.getId()]) {
                    self.removeOverlay(self.featuresOverlay);
                    self.featuresOverlay = null;
                }
                action.call(context, { layerRemoved: layerOpts });
            }, this);
            this._registerEvent(olEventKey, eventId, action, context);
            olEventKey = null;
            for (var obsProperty in OL3.LAYERPROPERTIES) {
                map.logger.trace('[OL3] listen : abonnement layerProperty : ' + obsProperty);
                this.libMap.getLayers().forEach(function (olLayer, i, array) {
                    var layerOpts = this._getLayerOpts(olLayer);
                    if (obsProperty === 'grayScaled') {
                        var layerChangeGrayScaledCallBack = function (evt) {
                            action.call(context, {
                                property: 'grayScaled',
                                oldValue: evt.detail.oldValue,
                                newValue: evt.detail.newValue,
                                layerChanged: layerOpts
                            });
                        };
                        var registredEvent = map._registerEvent(layerChangeGrayScaledCallBack, eventId, action, context);
                        registredEvent.eventOrigin = olLayer;
                        registredEvent.eventType = 'change:' + obsProperty;
                        registredEvent.eventOrigin.addEventListener(registredEvent.eventType, layerChangeGrayScaledCallBack, this);
                    } else {
                        olEventKey = olLayer.on('change:' + obsProperty, function (ol3evt) {
                            var oldOl3obj = {};
                            oldOl3obj[ol3evt.key] = ol3evt.oldValue;
                            var oldCommonProp = map._getCommonLayerParams(oldOl3obj);
                            var newOl3obj = {};
                            newOl3obj[ol3evt.key] = this.get(ol3evt.key);
                            var newCommonProp = map._getCommonLayerParams(newOl3obj);
                            action.call(context, {
                                property: OL3.LAYERPROPERTIES[ol3evt.key],
                                oldValue: oldCommonProp[OL3.LAYERPROPERTIES[ol3evt.key]],
                                newValue: newCommonProp[OL3.LAYERPROPERTIES[ol3evt.key]],
                                layerChanged: layerOpts
                            });
                        }, olLayer);
                        this._registerEvent(olEventKey, eventId, action, context);
                        olEventKey = null;
                    }
                }, map);
            }
            break;
        case 'controlChanged':
            break;
        default:
            console.log('unhandled event : ' + eventId);
        }
        if (olEventKey) {
            this._registerEvent(olEventKey, eventId, action, context);
        }
        return true;
    };
    OL3.prototype.forget = function (eventId, action) {
        this.logger.trace('[OL3] : forget...');
        if (!IMap.prototype.forget.apply(this, arguments)) {
            return false;
        }
        var rEvents = this._events[eventId];
        if (!rEvents) {
            console.log('nothing to forget for : ' + eventId);
            return false;
        }
        var evKey = null;
        for (var i = rEvents.length - 1; i >= 0; i--) {
            if (rEvents[i].action == action) {
                evKey = rEvents[i].key;
                rEvents.splice(i, 1);
                this.logger.trace('[OL3] : forgetting : ' + eventId + ' (' + evKey + ')');
                ol.Observable.unByKey(evKey);
            }
        }
    };
    OL3.prototype._changeLayerColor = function (layerId, toGrayScale) {
        var layerIndex = this._getLayerIndexByLayerId(layerId);
        var gpLayer = this._layers[layerIndex];
        switch (gpLayer.options.format.toUpperCase()) {
        case 'KML':
        case 'GPX':
        case 'WFS':
        case 'drawing':
            console.log('[OL3.prototype._changeLayerColor] warning : _changeLayerColor not allowed on vector layers (layer id: ' + layerId + ')');
            return;
        }
        this._colorGrayscaleLayerSwitch(gpLayer, toGrayScale);
        var event = IMap.CustomEvent('change:grayScaled', {
            detail: {
                oldValue: !toGrayScale,
                newValue: toGrayScale
            }
        });
        gpLayer.obj.dispatchEvent(event);
    };
    OL3.prototype._colorGrayscaleLayerSwitch = function (gpLayer, toGrayScale) {
        function getGrayScaledDataUrl(img) {
            img.crossOrigin = null;
            var canvas = document.createElement('canvas');
            var ctx = canvas.getContext('2d');
            canvas.width = img.width;
            canvas.height = img.height;
            ctx.drawImage(img, 0, 0);
            var imageData = ctx.getImageData(0, 0, img.width, img.height);
            var data = imageData.data;
            for (var i = 0; i < data.length; i += 4) {
                var avg = (data[i] + data[i + 1] + data[i + 2]) / 3;
                data[i] = avg;
                data[i + 1] = avg;
                data[i + 2] = avg;
            }
            ctx.putImageData(imageData, 0, 0);
            return canvas.toDataURL();
        }
        function convertImagetoGrayScale(image, context) {
            var dataUrl = getGrayScaledDataUrl(image);
            image.src = '';
            image.onload = function () {
                context.changed();
            };
            image.src = dataUrl;
        }
        function imageloadstartHandler(evt) {
            evt.image.getImage().crossOrigin = 'Anonymous';
        }
        function tileloadstartHandler(evt) {
            evt.tile.getImage().crossOrigin = 'Anonymous';
        }
        function imageloadendHandler(evt) {
            convertImagetoGrayScale(evt.image.getImage(), evt.target);
        }
        function tileloadendHandler(evt) {
            convertImagetoGrayScale(evt.tile.getImage(), evt.target);
        }
        var source = gpLayer.obj.getSource();
        if (toGrayScale) {
            if (source instanceof ol.source.ImageWMS) {
                source.loadstartListenerKey = source.on('imageloadstart', imageloadstartHandler);
                source.loadendListenerKey = source.on('imageloadend', imageloadendHandler);
            } else {
                source.loadstartListenerKey = source.on('tileloadstart', tileloadstartHandler);
                source.loadendListenerKey = source.on('tileloadend', tileloadendHandler);
            }
        } else {
            ol.Observable.unByKey(source.loadstartListenerKey);
            ol.Observable.unByKey(source.loadendListenerKey);
            source.loadstartListenerKey = null;
            source.loadendListenerKey = null;
        }
        source.refresh();
    };
    return OL3;
}(UtilsLoggerByDefault, ol, Gp, IMap);
Map = function (Logger, require) {
    var Map = {
        load: function (div, mapOptions) {
            var logger = Logger.getLogger('Map.load');
            if (!div) {
                throw new Error('missing parameter div !');
            }
            if (typeof div == 'string') {
                div = document.getElementById(div);
            }
            if (!div) {
                throw new Error('HTML element with id [' + div + '] not found.');
            }
            if (!mapOptions) {
                mapOptions = {};
            }
            if (!mapOptions.hasOwnProperty('library')) {
                mapOptions.library = 'ol3';
            }
            var OL3 = null;
            var IT = null;
            if (this.__classOl !== null && typeof this.__classOl === 'function') {
                OL3 = this.__classOl;
            }
            if (this.__classItowns !== null && typeof this.__classItowns === 'function') {
                IT = this.__classItowns;
            }
            var objMap = null;
            var library = mapOptions.library;
            switch (library) {
            case 'ol3':
                logger.trace('construction de la carte OpenLayers3');
                if (OL3 === null || typeof OL3 !== 'function') {
                    throw new Error('library ol is not loaded !');
                }
                objMap = new OL3({
                    div: div,
                    mapOptions: mapOptions
                });
                break;
            case 'itowns':
                logger.trace('construction du globe iTowns 3D');
                if (IT === null || typeof IT !== 'function') {
                    throw new Error('library itowns is not loaded !');
                }
                objMap = new IT({
                    div: div,
                    mapOptions: mapOptions
                });
                break;
            default:
                throw new Error('not supported library');
            }
            this._prototype = Object.getPrototypeOf(objMap);
            return objMap;
        }
    };
    var center = {};
    var point = {};
    var centerChangedEvent = {};
    var zoomChangedEvent = {};
    var azimuthChangedEvent = {};
    var tiltChangedEvent = {};
    var layerChangedEvent = {};
    var geolocatedEvent = {};
    var locatedEvent = {};
    var configuredEvent = {};
    var mapLoadedEvent = {};
    var mapOptions = {};
    var markerOptions = {};
    var autoPanOptions = {};
    var layerOptions = {};
    var controlOptions = {};
    var styleOptions = {};
    return Map;
}(UtilsLoggerByDefault, {});
AHN = function (Map, require) {
    var scope = typeof window !== 'undefined' ? window : {};
    var Gp = scope.Gp || {};
    Gp.Map = Map;
    if (typeof ol3OL3 !== 'undefined' && typeof it2IT !== 'undefined') {
        console.log('Lib. ol3 et itowns détectées !');
        Gp.Map.__classOl = ol3OL3;
        Gp.Map.__classItowns = it2IT;
        Gp.Map._class = Gp.Map.__classOl.prototype;
    } else if (typeof ol3OL3 !== 'undefined') {
        console.log('Lib. ol3 détectée !');
        Gp.Map.__classOl = ol3OL3;
        Gp.Map._class = Gp.Map.__classOl.prototype;
    } else if (typeof it2IT !== 'undefined') {
        console.log('Lib. itowns détectée !');
        Gp.Map.__classItowns = it2IT;
        Gp.Map._class = Gp.Map.__classItowns.prototype;
    } else {
        console.log('Aucune lib. détectée !?');
    }
    Gp.sdkVersion = '1.2.0';
    Gp.sdkDate = '2018-05-14';
    scope.Gp = Gp;
    return scope.Gp;
}(Map, {});
window.ol = ol;
/* END CODE   */

return Gp;
}));
